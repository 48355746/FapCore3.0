function mxDictionary(){this.clear()}function mxPoint(n,t){this.x=n!=null?n:0;this.y=t!=null?t:0}function mxRectangle(n,t,i,r){mxPoint.call(this,n,t);this.width=i!=null?i:0;this.height=r!=null?r:0}function mxEventObject(n){this.name=n;this.properties=[];for(var t=1;t<arguments.length;t+=2)arguments[t+1]!=null&&(this.properties[arguments[t]]=arguments[t+1])}function mxMouseEvent(n,t){this.evt=n;this.state=t;this.sourceState=t}function mxEventSource(n){this.setEventSource(n)}function mxXmlRequest(n,t,i,r,u,f){this.url=n;this.params=t;this.method=i||"POST";this.async=r!=null?r:!0;this.username=u;this.password=f}function mxWindow(n,t,i,r,u,f,e,o,s,h){t!=null&&(e=e!=null?e:!0,this.content=t,this.init(i,r,u,f,h),this.installMaximizeHandler(),this.installMinimizeHandler(),this.installCloseHandler(),this.setMinimizable(e),this.setTitle(n),(o==null||o)&&this.installMoveHandler(),s!=null&&s.parentNode!=null?s.parentNode.replaceChild(this.div,s):document.body.appendChild(this.div))}function mxForm(n){this.table=document.createElement("table");this.table.className=n;this.body=document.createElement("tbody");this.table.appendChild(this.body)}function mxImage(n,t,i){this.src=n;this.width=t;this.height=i}function mxDivResizer(n,t){if(n.nodeName.toLowerCase()=="div"){t==null&&(t=window);this.div=n;var i=mxUtils.getCurrentStyle(n);i!=null&&(this.resizeWidth=i.width=="auto",this.resizeHeight=i.height=="auto");mxEvent.addListener(t,"resize",mxUtils.bind(this,function(){this.handlingResize||(this.handlingResize=!0,this.resize(),this.handlingResize=!1)}));this.resize()}}function mxDragSource(n,t){this.element=n;this.dropHandler=t;mxEvent.addGestureListeners(n,mxUtils.bind(this,function(n){this.mouseDown(n)}));mxEvent.addListener(n,"dragstart",function(n){mxEvent.consume(n)});this.eventConsumer=function(n,t){var i=t.getProperty("eventName"),r=t.getProperty("event");i!=mxEvent.MOUSE_DOWN&&r.consume()}}function mxToolbar(n){this.container=n}function mxUndoableEdit(n,t){this.source=n;this.changes=[];this.significant=t!=null?t:!0}function mxUndoManager(n){this.size=n!=null?n:100;this.clear()}function mxPanningManager(n){this.thread=null;this.active=!1;this.tdx=0;this.tdy=0;this.t0x=0;this.t0y=0;this.dx=0;this.dy=0;this.scrollbars=!1;this.scrollLeft=0;this.scrollTop=0;this.mouseListener={mouseDown:function(){},mouseMove:function(){},mouseUp:mxUtils.bind(this,function(){this.active&&this.stop()})};n.addMouseListener(this.mouseListener);this.mouseUpListener=mxUtils.bind(this,function(){this.active&&this.stop()});mxEvent.addListener(document,"mouseup",this.mouseUpListener);var t=mxUtils.bind(this,function(){return this.scrollbars=mxUtils.hasScrollbars(n.container),this.scrollLeft=n.container.scrollLeft,this.scrollTop=n.container.scrollTop,window.setInterval(mxUtils.bind(this,function(){if(this.tdx-=this.dx,this.tdy-=this.dy,this.scrollbars){var t=-n.container.scrollLeft-Math.ceil(this.dx),i=-n.container.scrollTop-Math.ceil(this.dy);n.panGraph(t,i);n.panDx=this.scrollLeft-n.container.scrollLeft;n.panDy=this.scrollTop-n.container.scrollTop;n.fireEvent(new mxEventObject(mxEvent.PAN))}else n.panGraph(this.getDx(),this.getDy())}),this.delay)});this.isActive=function(){return active};this.getDx=function(){return Math.round(this.tdx)};this.getDy=function(){return Math.round(this.tdy)};this.start=function(){this.t0x=n.view.translate.x;this.t0y=n.view.translate.y;this.active=!0};this.panTo=function(i,r,u,f){this.active||this.start();this.scrollLeft=n.container.scrollLeft;this.scrollTop=n.container.scrollTop;u=u!=null?u:0;f=f!=null?f:0;var e=n.container;this.dx=i+u-e.scrollLeft-e.clientWidth;this.dx=this.dx<0&&Math.abs(this.dx)<this.border?this.border+this.dx:this.handleMouseOut?Math.max(this.dx,0):0;this.dx==0&&(this.dx=i-e.scrollLeft,this.dx=this.dx>0&&this.dx<this.border?this.dx-this.border:this.handleMouseOut?Math.min(0,this.dx):0);this.dy=r+f-e.scrollTop-e.clientHeight;this.dy=this.dy<0&&Math.abs(this.dy)<this.border?this.border+this.dy:this.handleMouseOut?Math.max(this.dy,0):0;this.dy==0&&(this.dy=r-e.scrollTop,this.dy=this.dy>0&&this.dy<this.border?this.dy-this.border:this.handleMouseOut?Math.min(0,this.dy):0);this.dx!=0||this.dy!=0?(this.dx*=this.damper,this.dy*=this.damper,this.thread==null&&(this.thread=t())):this.thread!=null&&(window.clearInterval(this.thread),this.thread=null)};this.stop=function(){if(this.active)if(this.active=!1,this.thread!=null&&(window.clearInterval(this.thread),this.thread=null),this.tdx=0,this.tdy=0,this.scrollbars)n.panDx=0,n.panDy=0,n.fireEvent(new mxEventObject(mxEvent.PAN));else{var t=n.panDx,i=n.panDy;(t!=0||i!=0)&&(n.panGraph(0,0),n.view.setTranslate(this.t0x+t/n.view.scale,this.t0y+i/n.view.scale))}};this.destroy=function(){n.removeMouseListener(this.mouseListener);mxEvent.removeListener(document,"mouseup",this.mouseUpListener)}}function mxPopupMenu(n){this.factoryMethod=n;n!=null&&this.init()}function mxAutoSaveManager(n){this.changeHandler=mxUtils.bind(this,function(n,t){this.isEnabled()&&this.graphModelChanged(t.getProperty("edit").changes)});this.setGraph(n)}function mxAnimation(n){this.delay=n!=null?n:20}function mxMorphing(n,t,i,r){mxAnimation.call(this,r);this.graph=n;this.steps=t!=null?t:6;this.ease=i!=null?i:1.5}function mxImageBundle(n){this.images=[];this.alt=n!=null?n:!1}function mxImageExport(){}function mxAbstractCanvas2D(){this.converter=this.createUrlConverter();this.reset()}function mxXmlCanvas2D(n){mxAbstractCanvas2D.call(this);this.root=n;this.writeDefaults()}function mxSvgCanvas2D(n,t){var i,r,u;if(mxAbstractCanvas2D.call(this),this.root=n,this.gradients=[],this.defs=null,this.styleEnabled=t!=null?t:!1,i=null,n.ownerDocument!=document){for(r=n;r!=null&&r.nodeName!="svg";)r=r.parentNode;i=r}i!=null&&(u=i.getElementsByTagName("defs"),u.length>0&&(this.defs=i.getElementsByTagName("defs")[0]),this.defs==null&&(this.defs=this.createElement("defs"),i.firstChild!=null?i.insertBefore(this.defs,i.firstChild):i.appendChild(this.defs)),this.styleEnabled&&this.defs.appendChild(this.createStyle()))}function mxGuide(n,t){this.graph=n;this.setStates(t)}function mxStencil(n){this.desc=n;this.parseDescription();this.parseConstraints()}function mxShape(n){this.stencil=n;this.initStyles()}function mxActor(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxCloud(n,t,i,r){mxActor.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxRectangleShape(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxEllipse(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxDoubleEllipse(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxRhombus(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxPolyline(n,t,i){mxShape.call(this);this.points=n;this.stroke=t;this.strokewidth=i!=null?i:1}function mxArrow(n,t,i,r,u,f,e){mxShape.call(this);this.points=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1;this.arrowWidth=u!=null?u:mxConstants.ARROW_WIDTH;this.spacing=f!=null?f:mxConstants.ARROW_SPACING;this.endSize=e!=null?e:mxConstants.ARROW_SIZE}function mxArrowConnector(n,t,i,r,u,f){mxShape.call(this);this.points=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1;this.arrowWidth=u!=null?u:mxConstants.ARROW_WIDTH;this.arrowSpacing=f!=null?f:mxConstants.ARROW_SPACING;this.startSize=mxConstants.ARROW_SIZE/5;this.endSize=mxConstants.ARROW_SIZE/5}function mxText(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){mxShape.call(this);this.value=n;this.bounds=t;this.color=u!=null?u:"black";this.align=i!=null?i:mxConstants.ALIGN_CENTER;this.valign=r!=null?r:mxConstants.ALIGN_MIDDLE;this.family=f!=null?f:mxConstants.DEFAULT_FONTFAMILY;this.size=e!=null?e:mxConstants.DEFAULT_FONTSIZE;this.fontStyle=o!=null?o:mxConstants.DEFAULT_FONTSTYLE;this.spacing=parseInt(s||2);this.spacingTop=this.spacing+parseInt(h||0);this.spacingRight=this.spacing+parseInt(c||0);this.spacingBottom=this.spacing+parseInt(l||0);this.spacingLeft=this.spacing+parseInt(a||0);this.horizontal=v!=null?v:!0;this.background=y;this.border=p;this.wrap=w!=null?w:!1;this.clipped=b!=null?b:!1;this.overflow=k!=null?k:"visible";this.labelPadding=d!=null?d:0;this.textDirection=g;this.rotation=0;this.updateMargin()}function mxTriangle(){mxActor.call(this)}function mxHexagon(){mxActor.call(this)}function mxLine(n,t,i){mxShape.call(this);this.bounds=n;this.stroke=t;this.strokewidth=i!=null?i:1}function mxImageShape(n,t,i,r,u){mxShape.call(this);this.bounds=n;this.image=t;this.fill=i;this.stroke=r;this.strokewidth=u!=null?u:1;this.shadow=!1}function mxLabel(n,t,i,r){mxRectangleShape.call(this,n,t,i,r)}function mxCylinder(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxConnector(n,t,i){mxPolyline.call(this,n,t,i)}function mxSwimlane(n,t,i,r){mxShape.call(this);this.bounds=n;this.fill=t;this.stroke=i;this.strokewidth=r!=null?r:1}function mxGraphLayout(n){this.graph=n}function WeightedCellSorter(n,t){this.cell=n;this.weightedValue=t}function mxStackLayout(n,t,i,r,u,f){mxGraphLayout.call(this,n);this.horizontal=t!=null?t:!0;this.spacing=i!=null?i:0;this.x0=r!=null?r:0;this.y0=u!=null?u:0;this.border=f!=null?f:0}function mxPartitionLayout(n,t,i,r){mxGraphLayout.call(this,n);this.horizontal=t!=null?t:!0;this.spacing=i||0;this.border=r||0}function mxCompactTreeLayout(n,t,i){mxGraphLayout.call(this,n);this.horizontal=t!=null?t:!0;this.invert=i!=null?i:!1}function mxRadialTreeLayout(n){mxCompactTreeLayout.call(this,n,!1)}function mxFastOrganicLayout(n){mxGraphLayout.call(this,n)}function mxCircleLayout(n,t){mxGraphLayout.call(this,n);this.radius=t!=null?t:100}function mxParallelEdgeLayout(n){mxGraphLayout.call(this,n)}function mxCompositeLayout(n,t,i){mxGraphLayout.call(this,n);this.layouts=t;this.master=i}function mxEdgeLabelLayout(n){mxGraphLayout.call(this,n)}function mxGraphAbstractHierarchyCell(){this.x=[];this.y=[];this.temp=[]}function mxGraphHierarchyNode(n){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=n;this.id=mxObjectIdentity.get(n);this.connectsAsTarget=[];this.connectsAsSource=[]}function mxGraphHierarchyEdge(n){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=n;this.ids=[];for(var t=0;t<n.length;t++)this.ids.push(mxObjectIdentity.get(n[t]))}function mxGraphHierarchyModel(n,t,i,r,u){var y=n.getGraph(),o,e,l,h,s,c;for(this.tightenToSource=u,this.roots=i,this.parent=r,this.vertexMapper=new mxDictionary,this.edgeMapper=new mxDictionary,this.maxRank=0,o=[],t==null&&(t=this.graph.getChildVertices(r)),this.maxRank=this.SOURCESCANSTARTRANK,this.createInternalCells(n,t,o),e=0;e<t.length;e++){for(l=o[e].connectsAsSource,h=0;h<l.length;h++)if(s=l[h],c=s.edges,c!=null&&c.length>0){var v=c[0],a=n.getVisibleTerminal(v,!1),f=this.vertexMapper.get(a);o[e]==f&&(a=n.getVisibleTerminal(v,!0),f=this.vertexMapper.get(a));f!=null&&o[e]!=f&&(s.target=f,f.connectsAsTarget.length==0&&(f.connectsAsTarget=[]),mxUtils.indexOf(f.connectsAsTarget,s)<0&&f.connectsAsTarget.push(s))}o[e].temp[0]=1}}function mxSwimlaneModel(n,t,i,r,u){var y=n.getGraph(),o,e,l,h,s,c;for(this.tightenToSource=u,this.roots=i,this.parent=r,this.vertexMapper=new mxDictionary,this.edgeMapper=new mxDictionary,this.maxRank=0,o=[],t==null&&(t=this.graph.getChildVertices(r)),this.maxRank=this.SOURCESCANSTARTRANK,this.createInternalCells(n,t,o),e=0;e<t.length;e++){for(l=o[e].connectsAsSource,h=0;h<l.length;h++)if(s=l[h],c=s.edges,c!=null&&c.length>0){var v=c[0],a=n.getVisibleTerminal(v,!1),f=this.vertexMapper.get(a);o[e]==f&&(a=n.getVisibleTerminal(v,!0),f=this.vertexMapper.get(a));f!=null&&o[e]!=f&&(s.target=f,f.connectsAsTarget.length==0&&(f.connectsAsTarget=[]),mxUtils.indexOf(f.connectsAsTarget,s)<0&&f.connectsAsTarget.push(s))}o[e].temp[0]=1}}function mxHierarchicalLayoutStage(){}function mxMedianHybridCrossingReduction(n){this.layout=n}function MedianCellSorter(){}function mxMinimumCycleRemover(n){this.layout=n}function mxCoordinateAssignment(n,t,i,r,u,f){this.layout=n;this.intraCellSpacing=t;this.interRankCellSpacing=i;this.orientation=r;this.initialX=u;this.parallelEdgeSpacing=f}function mxSwimlaneOrdering(n){this.layout=n}function mxHierarchicalLayout(n,t,i){mxGraphLayout.call(this,n);this.orientation=t!=null?t:mxConstants.DIRECTION_NORTH;this.deterministic=i!=null?i:!0}function mxSwimlaneLayout(n,t,i){mxGraphLayout.call(this,n);this.orientation=t!=null?t:mxConstants.DIRECTION_NORTH;this.deterministic=i!=null?i:!0}function mxGraphModel(n){this.currentEdit=this.createUndoableEdit();n!=null?this.setRoot(n):this.clear()}function mxRootChange(n,t){this.model=n;this.root=t;this.previous=t}function mxChildChange(n,t,i,r){this.model=n;this.parent=t;this.previous=t;this.child=i;this.index=r;this.previousIndex=r}function mxTerminalChange(n,t,i,r){this.model=n;this.cell=t;this.terminal=i;this.previous=i;this.source=r}function mxValueChange(n,t,i){this.model=n;this.cell=t;this.value=i;this.previous=i}function mxStyleChange(n,t,i){this.model=n;this.cell=t;this.style=i;this.previous=i}function mxGeometryChange(n,t,i){this.model=n;this.cell=t;this.geometry=i;this.previous=i}function mxCollapseChange(n,t,i){this.model=n;this.cell=t;this.collapsed=i;this.previous=i}function mxVisibleChange(n,t,i){this.model=n;this.cell=t;this.visible=i;this.previous=i}function mxCellAttributeChange(n,t,i){this.cell=n;this.attribute=t;this.value=i;this.previous=i}function mxCell(n,t,i){this.value=n;this.setGeometry(t);this.setStyle(i);this.onInit!=null&&this.onInit()}function mxGeometry(n,t,i,r){mxRectangle.call(this,n,t,i,r)}function mxPrintPreview(n,t,i,r,u,f,e,o,s){this.graph=n;this.scale=t!=null?t:1/n.pageScale;this.border=r!=null?r:0;this.pageFormat=mxRectangle.fromRectangle(i!=null?i:n.pageFormat);this.title=o!=null?o:"Printer-friendly version";this.x0=u!=null?u:0;this.y0=f!=null?f:0;this.borderColor=e;this.pageSelector=s!=null?s:!0}function mxStylesheet(){this.styles={};this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle())}function mxCellState(n,t,i){this.view=n;this.cell=t;this.style=i;this.origin=new mxPoint;this.absoluteOffset=new mxPoint}function mxGraphSelectionModel(n){this.graph=n;this.cells=[]}function mxSelectionChange(n,t,i){this.selectionModel=n;this.added=t!=null?t.slice():null;this.removed=i!=null?i.slice():null}function mxCellEditor(n){this.graph=n;this.zoomHandler=mxUtils.bind(this,function(){this.graph.isEditing()&&this.resize()});this.graph.view.addListener(mxEvent.SCALE,this.zoomHandler);this.graph.view.addListener(mxEvent.SCALE_AND_TRANSLATE,this.zoomHandler);this.changeHandler=mxUtils.bind(this,function(){this.editingCell!=null&&this.graph.getView().getState(this.editingCell)==null&&this.stopEditing(!0)});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)}function mxCellRenderer(){}function mxGraphView(n){this.graph=n;this.translate=new mxPoint;this.graphBounds=new mxRectangle;this.states=new mxDictionary}function mxCurrentRootChange(n,t){if(this.view=n,this.root=t,this.previous=t,this.isUp=t==null,!this.isUp)for(var i=this.view.currentRoot,r=this.view.graph.getModel();i!=null;){if(i==t){this.isUp=!0;break}i=r.getParent(i)}}function mxGraph(n,t,i,r){this.mouseListeners=null;this.renderHint=i;this.dialect=mxClient.IS_SVG?mxConstants.DIALECT_SVG:i==mxConstants.RENDERING_HINT_EXACT&&mxClient.IS_VML?mxConstants.DIALECT_VML:i==mxConstants.RENDERING_HINT_FASTEST?mxConstants.DIALECT_STRICTHTML:i==mxConstants.RENDERING_HINT_FASTER?mxConstants.DIALECT_PREFERHTML:mxConstants.DIALECT_MIXEDHTML;this.model=t!=null?t:new mxGraphModel;this.multiplicities=[];this.imageBundles=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());this.setStylesheet(r!=null?r:this.createStylesheet());this.view=this.createGraphView();this.graphModelChangeListener=mxUtils.bind(this,function(n,t){this.graphModelChanged(t.getProperty("edit").changes)});this.model.addListener(mxEvent.CHANGE,this.graphModelChangeListener);this.createHandlers();n!=null&&this.init(n);this.view.revalidate()}function mxCellOverlay(n,t,i,r,u,f){this.image=n;this.tooltip=t;this.align=i!=null?i:this.align;this.verticalAlign=r!=null?r:this.verticalAlign;this.offset=u!=null?u:new mxPoint;this.cursor=f!=null?f:"help"}function mxOutline(n,t){this.source=n;t!=null&&this.init(t)}function mxMultiplicity(n,t,i,r,u,f,e,o,s,h){this.source=n;this.type=t;this.attr=i;this.value=r;this.min=u!=null?u:0;this.max=f!=null?f:"n";this.validNeighbors=e;this.countError=mxResources.get(o)||o;this.typeError=mxResources.get(s)||s;this.validNeighborsAllowed=h!=null?h:!0}function mxLayoutManager(n){this.undoHandler=mxUtils.bind(this,function(n,t){this.isEnabled()&&this.beforeUndo(t.getProperty("edit"))});this.moveHandler=mxUtils.bind(this,function(n,t){this.isEnabled()&&this.cellsMoved(t.getProperty("cells"),t.getProperty("event"))});this.setGraph(n)}function mxSwimlaneManager(n,t,i,r){this.horizontal=t!=null?t:!0;this.addEnabled=i!=null?i:!0;this.resizeEnabled=r!=null?r:!0;this.addHandler=mxUtils.bind(this,function(n,t){this.isEnabled()&&this.isAddEnabled()&&this.cellsAdded(t.getProperty("cells"))});this.resizeHandler=mxUtils.bind(this,function(n,t){this.isEnabled()&&this.isResizeEnabled()&&this.cellsResized(t.getProperty("cells"))});this.setGraph(n)}function mxTemporaryCellStates(n,t,i,r,u){var o,f,e,s;if(t=t!=null?t:1,this.view=n,this.oldValidateCellState=n.validateCellState,this.oldBounds=n.getGraphBounds(),this.oldStates=n.getStates(),this.oldScale=n.getScale(),this.oldDoRedrawShape=n.graph.cellRenderer.doRedrawShape,o=this,u!=null&&(n.graph.cellRenderer.doRedrawShape=function(t){var i=t.shape.paint;t.shape.paint=function(n){var r=u(t);r!=null&&n.setLink(r);i.apply(this,arguments);r!=null&&n.setLink(null)};o.oldDoRedrawShape.apply(n.graph.cellRenderer,arguments);t.shape.paint=i}),n.validateCellState=function(t){return t==null||r==null||r(t)?o.oldValidateCellState.apply(n,arguments):null},n.setStates(new mxDictionary),n.setScale(t),i!=null){for(n.resetValidationState(),f=null,e=0;e<i.length;e++)s=n.getBoundingBox(n.validateCellState(n.validateCell(i[e]))),f==null?f=s:f.add(s);n.setGraphBounds(f||new mxRectangle)}}function mxCellStatePreview(n){this.deltas=new mxDictionary;this.graph=n}function mxConnectionConstraint(n,t,i){this.point=n;this.perimeter=t!=null?t:!0;this.name=i}function mxGraphHandler(n){this.graph=n;this.graph.addMouseListener(this);this.panHandler=mxUtils.bind(this,function(){this.updatePreviewShape();this.updateHint()});this.graph.addListener(mxEvent.PAN,this.panHandler);this.escapeHandler=mxUtils.bind(this,function(){this.reset()});this.graph.addListener(mxEvent.ESCAPE,this.escapeHandler)}function mxPanningHandler(n){n!=null&&(this.graph=n,this.graph.addMouseListener(this),this.forcePanningHandler=mxUtils.bind(this,function(n,t){var r=t.getProperty("eventName"),i=t.getProperty("event");r==mxEvent.MOUSE_DOWN&&this.isForcePanningEvent(i)&&(this.start(i),this.active=!0,this.fireEvent(new mxEventObject(mxEvent.PAN_START,"event",i)),i.consume())}),this.graph.addListener(mxEvent.FIRE_MOUSE_EVENT,this.forcePanningHandler),this.gestureHandler=mxUtils.bind(this,function(n,t){var r,i;this.isPinchEnabled()&&(r=t.getProperty("event"),mxEvent.isConsumed(r)||r.type!="gesturestart"?r.type=="gestureend"&&this.initialScale!=null&&(this.initialScale=null):(this.initialScale=this.graph.view.scale,this.active||this.mouseDownEvent==null||(this.start(this.mouseDownEvent),this.mouseDownEvent=null)),this.initialScale!=null&&(i=Math.round(this.initialScale*r.scale*100)/100,this.minScale!=null&&(i=Math.max(this.minScale,i)),this.maxScale!=null&&(i=Math.min(this.maxScale,i)),this.graph.view.scale!=i&&(this.graph.zoomTo(i),mxEvent.consume(r))))}),this.graph.addListener(mxEvent.GESTURE,this.gestureHandler),this.mouseUpListener=mxUtils.bind(this,function(){this.active&&this.reset()}),mxEvent.addListener(document,"mouseup",this.mouseUpListener))}function mxPopupMenuHandler(n,t){n!=null&&(this.graph=n,this.factoryMethod=t,this.graph.addMouseListener(this),this.gestureHandler=mxUtils.bind(this,function(){this.inTolerance=!1}),this.graph.addListener(mxEvent.GESTURE,this.gestureHandler),this.init())}function mxCellMarker(n,t,i,r){mxEventSource.call(this);n!=null&&(this.graph=n,this.validColor=t!=null?t:mxConstants.DEFAULT_VALID_COLOR,this.invalidColor=t!=null?i:mxConstants.DEFAULT_INVALID_COLOR,this.hotspot=r!=null?r:mxConstants.DEFAULT_HOTSPOT,this.highlight=new mxCellHighlight(n))}function mxSelectionCellsHandler(n){mxEventSource.call(this);this.graph=n;this.handlers=new mxDictionary;this.graph.addMouseListener(this);this.refreshHandler=mxUtils.bind(this,function(){this.isEnabled()&&this.refresh()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler);this.graph.getView().addListener(mxEvent.UP,this.refreshHandler)}function mxConnectionHandler(n,t){mxEventSource.call(this);n!=null&&(this.graph=n,this.factoryMethod=t,this.init(),this.escapeHandler=mxUtils.bind(this,function(){this.reset()}),this.graph.addListener(mxEvent.ESCAPE,this.escapeHandler))}function mxConstraintHandler(n){this.graph=n;this.resetHandler=mxUtils.bind(this,function(){this.currentFocus!=null&&this.graph.view.getState(this.currentFocus.cell)==null?this.reset():this.redraw()});this.graph.model.addListener(mxEvent.CHANGE,this.resetHandler);this.graph.view.addListener(mxEvent.SCALE_AND_TRANSLATE,this.resetHandler);this.graph.view.addListener(mxEvent.TRANSLATE,this.resetHandler);this.graph.view.addListener(mxEvent.SCALE,this.resetHandler);this.graph.addListener(mxEvent.ROOT,this.resetHandler)}function mxRubberband(n){n!=null&&(this.graph=n,this.graph.addMouseListener(this),this.forceRubberbandHandler=mxUtils.bind(this,function(n,t){var f=t.getProperty("eventName"),r=t.getProperty("event"),u,i;f==mxEvent.MOUSE_DOWN&&this.isForceRubberbandEvent(r)&&(u=mxUtils.getOffset(this.graph.container),i=mxUtils.getScrollOrigin(this.graph.container),i.x-=u.x,i.y-=u.y,this.start(r.getX()+i.x,r.getY()+i.y),r.consume(!1))}),this.graph.addListener(mxEvent.FIRE_MOUSE_EVENT,this.forceRubberbandHandler),this.panHandler=mxUtils.bind(this,function(){this.repaint()}),this.graph.addListener(mxEvent.PAN,this.panHandler),this.gestureHandler=mxUtils.bind(this,function(){this.first!=null&&this.reset()}),this.graph.addListener(mxEvent.GESTURE,this.gestureHandler),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxHandle(n,t,i){this.graph=n.view.graph;this.state=n;this.cursor=t!=null?t:this.cursor;this.image=i!=null?i:this.image;this.init()}function mxVertexHandler(n){n!=null&&(this.state=n,this.init(),this.escapeHandler=mxUtils.bind(this,function(){this.livePreview&&this.index!=null&&(this.state.view.graph.cellRenderer.redraw(this.state,!0),this.state.view.invalidate(this.state.cell),this.state.invalid=!1,this.state.view.validate());this.reset()}),this.state.view.graph.addListener(mxEvent.ESCAPE,this.escapeHandler))}function mxEdgeHandler(n){n!=null&&(this.state=n,this.init(),this.escapeHandler=mxUtils.bind(this,function(){var t=this.index!=null;this.reset();t&&this.graph.cellRenderer.redraw(this.state,!1,n.view.isRendering())}),this.state.view.graph.addListener(mxEvent.ESCAPE,this.escapeHandler))}function mxElbowEdgeHandler(n){mxEdgeHandler.call(this,n)}function mxEdgeSegmentHandler(n){mxEdgeHandler.call(this,n)}function mxKeyHandler(n,t){n!=null&&(this.graph=n,this.target=t||document.documentElement,this.normalKeys=[],this.shiftKeys=[],this.controlKeys=[],this.controlShiftKeys=[],this.keydownHandler=mxUtils.bind(this,function(n){this.keyDown(n)}),mxEvent.addListener(this.target,"keydown",this.keydownHandler),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxTooltipHandler(n,t){n!=null&&(this.graph=n,this.delay=t||500,this.graph.addMouseListener(this))}function mxCellTracker(n,t,i){mxCellMarker.call(this,n,t);this.graph.addMouseListener(this);i!=null&&(this.getCell=i);mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()}))}function mxCellHighlight(n,t,i,r){n!=null&&(this.graph=n,this.highlightColor=t!=null?t:mxConstants.DEFAULT_VALID_COLOR,this.strokeWidth=i!=null?i:mxConstants.HIGHLIGHT_STROKEWIDTH,this.dashed=r!=null?r:!1,this.opacity=mxConstants.HIGHLIGHT_OPACITY,this.repaintHandler=mxUtils.bind(this,function(){if(this.state!=null){var n=this.graph.view.getState(this.state.cell);n==null?this.hide():(this.state=n,this.repaint())}}),this.graph.getView().addListener(mxEvent.SCALE,this.repaintHandler),this.graph.getView().addListener(mxEvent.TRANSLATE,this.repaintHandler),this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.repaintHandler),this.graph.getModel().addListener(mxEvent.CHANGE,this.repaintHandler),this.resetHandler=mxUtils.bind(this,function(){this.hide()}),this.graph.getView().addListener(mxEvent.DOWN,this.resetHandler),this.graph.getView().addListener(mxEvent.UP,this.resetHandler))}function mxDefaultKeyHandler(n){if(n!=null){this.editor=n;this.handler=new mxKeyHandler(n.graph);var t=this.handler.escape;this.handler.escape=function(i){t.apply(this,arguments);n.hideProperties();n.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",i))}}}function mxDefaultPopupMenu(n){this.config=n}function mxDefaultToolbar(n,t){this.editor=t;n!=null&&t!=null&&this.init(n)}function mxEditor(n){this.actions=[];this.addActions();document.body!=null&&(this.cycleAttributeValues=[],this.popupHandler=new mxDefaultPopupMenu,this.undoManager=new mxUndoManager,this.graph=this.createGraph(),this.toolbar=this.createToolbar(),this.keyHandler=new mxDefaultKeyHandler(this),this.configure(n),this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName,this.onInit!=null&&this.onInit(),mxClient.IS_IE&&mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})))}function mxCodec(n){this.document=n||mxUtils.createXmlDocument();this.objects=[]}function mxObjectCodec(n,t,i,r){this.template=n;this.exclude=t!=null?t:[];this.idrefs=i!=null?i:[];this.mapping=r!=null?r:[];this.reverse={};for(var u in this.mapping)this.reverse[this.mapping[u]]=u}function OpenPostWindow(n,t,i,r,u){var e=document.createElement("form"),f,o,s,h;if(e.id="tempForm1",e.method="post",e.target="newPage",e.action=n,t)if(typeof t=="string")f=document.createElement("input"),f.type="hidden",f.name="data",f.value=t,e.appendChild(f);else if(t instanceof Array)for(o=0;o<t.length;o++)f=document.createElement("input"),f.type="hidden",f.name="data"+o,f.value=t[o],e.appendChild(f);else if(t instanceof Object)for(s in t)f=document.createElement("input"),f.type="hidden",f.name=s,f.value=t[s],e.appendChild(f);h=$(e);h.submit(function(){if(i){r=r||"对话框";u||(u={});var t=u.width||720,f=u.height||720,e=(window.screen.availHeight-30-f)/2,o=(window.screen.availWidth-10-t)/2,n=window.open("about:blank","newPage","height="+f+"px, width="+t+"px, top="+e+", left="+o+", toolbar=no, menubar=no, scrollbars=yes, location=no, status=yes");n.focus()}else n=window.open("about:blank"),n.focus()});document.body.appendChild(e);h.trigger("submit");document.body.removeChild(e)}function ChangePageSetup(n,t,i,r){this.ui=n;this.color=t;this.previousColor=t;this.image=i;this.previousImage=i;this.format=r;this.previousFormat=r;this.ignoreColor=!1;this.ignoreImage=!1}function Dialog(n,t,i,r,u,f,e,o){var v=0,y,s,p,l;mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8)&&(v=80);i+=v;r+=v;var w=i,b=r,a=Math.max(document.body.clientHeight,document.documentElement.clientHeight),h=Math.max(1,Math.round((document.body.clientWidth-i-64)/2)),c=Math.max(1,Math.round((a-r-n.footerHeight)/3));mxClient.IS_QUIRKS||(t.style.maxHeight="100%");i=Math.min(i,document.body.scrollWidth-64);r=Math.min(r,a-64);n.dialogs.length>0&&(this.zIndex+=n.dialogs.length*2);this.bg==null&&(this.bg=n.createDiv("background"),this.bg.style.position="absolute",this.bg.style.background=Dialog.backdropColor,this.bg.style.height=a+"px",this.bg.style.right="0px",this.bg.style.zIndex=this.zIndex-2,mxUtils.setOpacity(this.bg,this.bgOpacity),mxClient.IS_QUIRKS&&new mxDivResizer(this.bg));y=mxUtils.getDocumentScrollOrigin(document);this.bg.style.left=y.x+"px";this.bg.style.top=y.y+"px";h+=y.x;c+=y.y;u&&document.body.appendChild(this.bg);s=n.createDiv("geDialog");p=this.getPosition(h,c,i,r);h=p.x;c=p.y;s.style.width=i+"px";s.style.height=r+"px";s.style.left=h+"px";s.style.top=c+"px";s.style.zIndex=this.zIndex;s.appendChild(t);document.body.appendChild(s);!o&&t.clientHeight>s.clientHeight-64&&(t.style.overflowY="auto");f&&(l=document.createElement("img"),l.setAttribute("src",Dialog.prototype.closeImage),l.setAttribute("title",mxResources.get("close")),l.className="geDialogClose",l.style.top=c+14+"px",l.style.left=h+i+38-v+"px",l.style.zIndex=this.zIndex,mxEvent.addListener(l,"click",mxUtils.bind(this,function(){n.hideDialog(!0)})),document.body.appendChild(l),this.dialogImg=l,mxEvent.addGestureListeners(this.bg,null,null,mxUtils.bind(this,function(){n.hideDialog(!0)})));this.resizeListener=mxUtils.bind(this,function(){a=Math.max(document.body.clientHeight,document.documentElement.clientHeight);this.bg.style.height=a+"px";h=Math.max(1,Math.round((document.body.clientWidth-i-64)/2));c=Math.max(1,Math.round((a-r-n.footerHeight)/3));i=Math.min(w,document.body.scrollWidth-64);r=Math.min(b,a-64);var u=this.getPosition(h,c,i,r);h=u.x;c=u.y;s.style.left=h+"px";s.style.top=c+"px";s.style.width=i+"px";s.style.height=r+"px";!o&&t.clientHeight>s.clientHeight-64&&(t.style.overflowY="auto");this.dialogImg!=null&&(this.dialogImg.style.top=c+14+"px",this.dialogImg.style.left=h+i+38-v+"px")});mxEvent.addListener(window,"resize",this.resizeListener);this.onDialogClose=e;this.container=s;n.editor.fireEvent(new mxEventObject("showDialog"))}function Sidebar(n,t){this.editorUi=n;this.container=t;this.palettes={};this.taglist={};this.showTooltips=!0;this.graph=n.createTemporaryGraph(this.editorUi.editor.graph.getStylesheet());this.graph.cellRenderer.antiAlias=!1;this.graph.foldingEnabled=!1;this.graph.container.style.visibility="hidden";document.body.appendChild(this.graph.container);this.pointerUpHandler=mxUtils.bind(this,function(){this.showTooltips=!0});mxEvent.addListener(document,mxClient.IS_POINTER?"pointerup":"mouseup",this.pointerUpHandler);this.pointerDownHandler=mxUtils.bind(this,function(){this.showTooltips=!1;this.hideTooltip()});mxEvent.addListener(document,mxClient.IS_POINTER?"pointerdown":"mousedown",this.pointerDownHandler);this.pointerMoveHandler=mxUtils.bind(this,function(n){for(var t=mxEvent.getSource(n);t!=null;){if(t==this.currentElt)return;t=t.parentNode}this.hideTooltip()});mxEvent.addListener(document,mxClient.IS_POINTER?"pointermove":"mousemove",this.pointerMoveHandler);this.pointerOutHandler=mxUtils.bind(this,function(n){n.toElement==null&&n.relatedTarget==null&&this.hideTooltip()});mxEvent.addListener(document,mxClient.IS_POINTER?"pointerout":"mouseout",this.pointerOutHandler);mxEvent.addListener(t,"scroll",mxUtils.bind(this,function(){this.showTooltips=!0}));this.init();mxClient.IS_SVG||((new Image).src=IMAGE_PATH+"/tooltip.png")}function Actions(n){this.editorUi=n;this.actions={};this.init()}function Action(n,t,i,r,u){mxEventSource.call(this);this.label=n;this.funct=this.createFunction(t);this.enabled=i!=null?i:!0;this.iconCls=r;this.shortcut=u;this.visible=!0}function Menubar(n,t){this.editorUi=n;this.container=t}function Menu(n,t){mxEventSource.call(this);this.funct=n;this.enabled=t!=null?t:!0}function Toolbar(n,t){this.editorUi=n;this.container=t;this.staticElements=[];this.init();this.gestureHandler=mxUtils.bind(this,function(n){this.editorUi.currentMenu!=null&&mxEvent.getSource(n)!=this.editorUi.currentMenu.div&&this.hideMenu()});mxEvent.addGestureListeners(document,this.gestureHandler)}var Base64,jscolor,mxClient,mxLog,mxObjectIdentity,mxResources,mxEvent,mxClipboard,mxUrlConverter,mxVmlCanvas2D,mxStencilRegistry,mxMarker,mxHierarchicalEdgeStyle,mxCellPath,mxPerimeter,mxEdgeStyle,mxStyleRegistry,mxCodecRegistry,mxGenericChangeCodec,mxStylesheetCodec,mxDefaultToolbarCodec,isMobile,HtmlUtil,PrintDialog,PageSetupDialog,OpenDialog,ColorDialog,ExportDialog,EditDataDialog;!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;t.pako=n()}}(function(){return function n(t,i,r){function u(f,o){var h,c,s;if(!i[f]){if(!t[f]){if(h="function"==typeof require&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c;}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e="function"==typeof require&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t,i){"use strict";function r(n){var t,i,o;if(!(this instanceof r))return new r(n);if(this.options=e.assign({level:k,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},n||{}),t=this.options,t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0,i=f.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy),i!==u)throw new Error(c[i]);if(t.header&&f.deflateSetHeader(this.strm,t.header),t.dictionary){if(o="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=f.deflateSetDictionary(this.strm,o),i!==u)throw new Error(c[i]);this._dict_set=!0}}function o(n,t){var i=new r(t);if(i.push(n,!0),i.err)throw i.msg;return i.result}function y(n,t){return t=t||{},t.raw=!0,o(n,t)}function p(n,t){return t=t||{},t.gzip=!0,o(n,t)}var f=n("./zlib/deflate"),e=n("./utils/common"),s=n("./utils/strings"),c=n("./zlib/messages"),w=n("./zlib/zstream"),l=Object.prototype.toString,b=0,h=4,u=0,a=1,v=2,k=-1,d=0,g=8;r.prototype.push=function(n,t){var r,o,i=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:t===!0?h:b;i.input="string"==typeof n?s.string2buf(n):"[object ArrayBuffer]"===l.call(n)?new Uint8Array(n):n;i.next_in=0;i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new e.Buf8(c),i.next_out=0,i.avail_out=c),r=f.deflate(i,o),r!==a&&r!==u)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||o!==h&&o!==v)||("string"===this.options.to?this.onData(s.buf2binstring(e.shrinkBuf(i.output,i.next_out))):this.onData(e.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&r!==a);return o===h?(r=f.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===u):o!==v||(this.onEnd(u),i.avail_out=0,!0)};r.prototype.onData=function(n){this.chunks.push(n)};r.prototype.onEnd=function(n){n===u&&(this.result="string"===this.options.to?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=n;this.msg=this.strm.msg};i.Deflate=r;i.deflate=o;i.deflateRaw=y;i.gzip=p},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(n,t,i){"use strict";function u(n){var t,i;if(!(this instanceof u))return new u(n);if(this.options=e.assign({chunkSize:16384,windowBits:0,to:""},n||{}),t=this.options,t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||n&&n.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0,i=f.inflateInit2(this.strm,t.windowBits),i!==r.Z_OK)throw new Error(l[i]);this.header=new v;f.inflateGetHeader(this.strm,this.header)}function s(n,t){var i=new u(t);if(i.push(n,!0),i.err)throw i.msg;return i.result}function c(n,t){return t=t||{},t.raw=!0,s(n,t)}var f=n("./zlib/inflate"),e=n("./utils/common"),o=n("./utils/strings"),r=n("./zlib/constants"),l=n("./zlib/messages"),a=n("./zlib/zstream"),v=n("./zlib/gzheader"),h=Object.prototype.toString;u.prototype.push=function(n,t){var u,s,a,l,p,w,i=this.strm,v=this.options.chunkSize,c=this.options.dictionary,y=!1;if(this.ended)return!1;s=t===~~t?t:t===!0?r.Z_FINISH:r.Z_NO_FLUSH;i.input="string"==typeof n?o.binstring2buf(n):"[object ArrayBuffer]"===h.call(n)?new Uint8Array(n):n;i.next_in=0;i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new e.Buf8(v),i.next_out=0,i.avail_out=v),u=f.inflate(i,r.Z_NO_FLUSH),u===r.Z_NEED_DICT&&c&&(w="string"==typeof c?o.string2buf(c):"[object ArrayBuffer]"===h.call(c)?new Uint8Array(c):c,u=f.inflateSetDictionary(this.strm,w)),u===r.Z_BUF_ERROR&&y===!0&&(u=r.Z_OK,y=!1),u!==r.Z_STREAM_END&&u!==r.Z_OK)return this.onEnd(u),this.ended=!0,!1;i.next_out&&(0!==i.avail_out&&u!==r.Z_STREAM_END&&(0!==i.avail_in||s!==r.Z_FINISH&&s!==r.Z_SYNC_FLUSH)||("string"===this.options.to?(a=o.utf8border(i.output,i.next_out),l=i.next_out-a,p=o.buf2string(i.output,a),i.next_out=l,i.avail_out=v-l,l&&e.arraySet(i.output,i.output,a,l,0),this.onData(p)):this.onData(e.shrinkBuf(i.output,i.next_out))));0===i.avail_in&&0===i.avail_out&&(y=!0)}while((i.avail_in>0||0===i.avail_out)&&u!==r.Z_STREAM_END);return u===r.Z_STREAM_END&&(s=r.Z_FINISH),s===r.Z_FINISH?(u=f.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===r.Z_OK):s!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),i.avail_out=0,!0)};u.prototype.onData=function(n){this.chunks.push(n)};u.prototype.onEnd=function(n){n===r.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):e.flattenChunks(this.chunks));this.chunks=[];this.err=n;this.msg=this.strm.msg};i.Inflate=u;i.inflate=s;i.inflateRaw=c;i.ungzip=s},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(n,t,i){"use strict";var f="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array,r,u;i.assign=function(n){for(var t,i,r=Array.prototype.slice.call(arguments,1);r.length;)if(t=r.shift(),t){if("object"!=typeof t)throw new TypeError(t+"must be non-object");for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i])}return n};i.shrinkBuf=function(n,t){return n.length===t?n:n.subarray?n.subarray(0,t):(n.length=t,n)};r={arraySet:function(n,t,i,r,u){if(t.subarray&&n.subarray)return void n.set(t.subarray(i,i+r),u);for(var f=0;f<r;f++)n[u+f]=t[i+f]},flattenChunks:function(n){var t,i,r,u,f,e;for(r=0,t=0,i=n.length;t<i;t++)r+=n[t].length;for(e=new Uint8Array(r),u=0,t=0,i=n.length;t<i;t++)f=n[t],e.set(f,u),u+=f.length;return e}};u={arraySet:function(n,t,i,r,u){for(var f=0;f<r;f++)n[u+f]=t[i+f]},flattenChunks:function(n){return[].concat.apply([],n)}};i.setTyped=function(n){n?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,u))};i.setTyped(f)},{}],4:[function(n,t,i){"use strict";function e(n,t){if(t<65537&&(n.subarray&&s||!n.subarray&&o))return String.fromCharCode.apply(null,f.shrinkBuf(n,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(n[i]);return r}var f=n("./common"),o=!0,s=!0,u,r;try{String.fromCharCode.apply(null,[0])}catch(n){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){s=!1}for(u=new f.Buf8(256),r=0;r<256;r++)u[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;u[254]=u[254]=1;i.string2buf=function(n){for(var r,t,e,u,o=n.length,s=0,i=0;i<o;i++)t=n.charCodeAt(i),55296==(64512&t)&&i+1<o&&(e=n.charCodeAt(i+1),56320==(64512&e)&&(t=65536+(t-55296<<10)+(e-56320),i++)),s+=t<128?1:t<2048?2:t<65536?3:4;for(r=new f.Buf8(s),u=0,i=0;u<s;i++)t=n.charCodeAt(i),55296==(64512&t)&&i+1<o&&(e=n.charCodeAt(i+1),56320==(64512&e)&&(t=65536+(t-55296<<10)+(e-56320),i++)),t<128?r[u++]=t:t<2048?(r[u++]=192|t>>>6,r[u++]=128|63&t):t<65536?(r[u++]=224|t>>>12,r[u++]=128|t>>>6&63,r[u++]=128|63&t):(r[u++]=240|t>>>18,r[u++]=128|t>>>12&63,r[u++]=128|t>>>6&63,r[u++]=128|63&t);return r};i.buf2binstring=function(n){return e(n,n.length)};i.binstring2buf=function(n){for(var i=new f.Buf8(n.length),t=0,r=i.length;t<r;t++)i[t]=n.charCodeAt(t);return i};i.buf2string=function(n,t){for(var i,f,h=t||n.length,o=new Array(2*h),r=0,s=0;s<h;)if(i=n[s++],i<128)o[r++]=i;else if(f=u[i],f>4)o[r++]=65533,s+=f-1;else{for(i&=2===f?31:3===f?15:7;f>1&&s<h;)i=i<<6|63&n[s++],f--;f>1?o[r++]=65533:i<65536?o[r++]=i:(i-=65536,o[r++]=55296|i>>10&1023,o[r++]=56320|1023&i)}return e(o,r)};i.utf8border=function(n,t){var i;for(t=t||n.length,t>n.length&&(t=n.length),i=t-1;i>=0&&128==(192&n[i]);)i--;return i<0?t:0===i?t:i+u[n[i]]>t?i:t}},{"./common":3}],5:[function(n,t){"use strict";function i(n,t,i,r){for(var u=65535&n|0,f=n>>>16&65535|0,e=0;0!==i;){e=i>2e3?2e3:i;i-=e;do u=u+t[r++]|0,f=f+u|0;while(--e);u%=65521;f%=65521}return u|f<<16|0}t.exports=i},{}],6:[function(n,t){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(n,t){"use strict";function i(){for(var n,r,i=[],t=0;t<256;t++){for(n=t,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;i[t]=n}return i}function r(n,t,i,r){var e=u,o=r+i,f;for(n^=-1,f=r;f<o;f++)n=n>>>8^e[255&(n^t[f])];return n^-1}var u=i();t.exports=r},{}],8:[function(n,t,i){"use strict";function v(n,t){return n.msg=wi[t],t}function kt(n){return(n<<1)-(n>4?9:0)}function y(n){for(var t=n.length;--t>=0;)n[t]=0}function p(n){var i=n.state,t=i.pending;t>n.avail_out&&(t=n.avail_out);0!==t&&(o.arraySet(n.output,i.pending_buf,i.pending_out,t,n.next_out),n.next_out+=t,i.pending_out+=t,n.total_out+=t,n.avail_out-=t,i.pending-=t,0===i.pending&&(i.pending_out=0))}function e(n,t){s._tr_flush_block(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t);n.block_start=n.strstart;p(n.strm)}function u(n,t){n.pending_buf[n.pending++]=t}function ft(n,t){n.pending_buf[n.pending++]=t>>>8&255;n.pending_buf[n.pending++]=255&t}function fi(n,t,i,r){var u=n.avail_in;return u>r&&(u=r),0===u?0:(n.avail_in-=u,o.arraySet(t,n.input,n.next_in,u,i),1===n.state.wrap?n.adler=ii(n.adler,t,u,i):2===n.state.wrap&&(n.adler=w(n.adler,t,u,i)),n.next_in+=u,n.total_in+=u,u)}function dt(n,t){var u,e,h=n.max_chain_length,r=n.strstart,f=n.prev_length,o=n.nice_match,v=n.strstart>n.w_size-c?n.strstart-(n.w_size-c):0,i=n.window,y=n.w_mask,p=n.prev,s=n.strstart+k,l=i[r+f-1],a=i[r+f];n.prev_length>=n.good_match&&(h>>=2);o>n.lookahead&&(o=n.lookahead);do if(u=t,i[u+f]===a&&i[u+f-1]===l&&i[u]===i[r]&&i[++u]===i[r+1]){r+=2;u++;do;while(i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&i[++r]===i[++u]&&r<s);if(e=k-(s-r),r=s-k,e>f){if(n.match_start=t,f=e,e>=o)break;l=i[r+f-1];a=i[r+f]}}while((t=p[t&y])>v&&0!=--h);return f<=n.lookahead?f:n.lookahead}function d(n){var f,i,e,s,u,t=n.w_size;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-c)){o.arraySet(n.window,n.window,t,t,0);n.match_start-=t;n.strstart-=t;n.block_start-=t;i=n.hash_size;f=i;do e=n.head[--f],n.head[f]=e>=t?e-t:0;while(--i);i=t;f=i;do e=n.prev[--f],n.prev[f]=e>=t?e-t:0;while(--i);s+=t}if(0===n.strm.avail_in)break;if(i=fi(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=i,n.lookahead+n.insert>=r)for(u=n.strstart-n.insert,n.ins_h=n.window[u],n.ins_h=(n.ins_h<<n.hash_shift^n.window[u+1])&n.hash_mask;n.insert&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[u+r-1])&n.hash_mask,n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++,n.insert--,!(n.lookahead+n.insert<r)););}while(n.lookahead<c&&0!==n.strm.avail_in)}function ei(n,t){var r=65535,i;for(r>n.pending_buf_size-5&&(r=n.pending_buf_size-5);;){if(n.lookahead<=1){if(d(n),0===n.lookahead&&t===g)return f;if(0===n.lookahead)break}if((n.strstart+=n.lookahead,n.lookahead=0,i=n.block_start+r,(0===n.strstart||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,e(n,!1),0===n.strm.avail_out))||n.strstart-n.block_start>=n.w_size-c&&(e(n,!1),0===n.strm.avail_out))return f}return n.insert=0,t===b?(e(n,!0),0===n.strm.avail_out?tt:ut):n.strstart>n.block_start&&(e(n,!1),0===n.strm.avail_out)?f:f}function yt(n,t){for(var i,u;;){if(n.lookahead<c){if(d(n),n.lookahead<c&&t===g)return f;if(0===n.lookahead)break}if(i=0,n.lookahead>=r&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),0!==i&&n.strstart-i<=n.w_size-c&&(n.match_length=dt(n,i)),n.match_length>=r)if(u=s._tr_tally(n,n.strstart-n.match_start,n.match_length-r),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=r){n.match_length--;do n.strstart++,n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(0!=--n.match_length);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+1])&n.hash_mask;else u=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(u&&(e(n,!1),0===n.strm.avail_out))return f}return n.insert=n.strstart<r-1?n.strstart:r-1,t===b?(e(n,!0),0===n.strm.avail_out?tt:ut):n.last_lit&&(e(n,!1),0===n.strm.avail_out)?f:ot}function it(n,t){for(var i,u,o;;){if(n.lookahead<c){if(d(n),n.lookahead<c&&t===g)return f;if(0===n.lookahead)break}if(i=0,n.lookahead>=r&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=r-1,0!==i&&n.prev_length<n.max_lazy_match&&n.strstart-i<=n.w_size-c&&(n.match_length=dt(n,i),n.match_length<=5&&(n.strategy===nr||n.match_length===r&&n.strstart-n.match_start>4096)&&(n.match_length=r-1)),n.prev_length>=r&&n.match_length<=n.prev_length){o=n.strstart+n.lookahead-r;u=s._tr_tally(n,n.strstart-1-n.prev_match,n.prev_length-r);n.lookahead-=n.prev_length-1;n.prev_length-=2;do++n.strstart<=o&&(n.ins_h=(n.ins_h<<n.hash_shift^n.window[n.strstart+r-1])&n.hash_mask,i=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(0!=--n.prev_length);if(n.match_available=0,n.match_length=r-1,n.strstart++,u&&(e(n,!1),0===n.strm.avail_out))return f}else if(n.match_available){if(u=s._tr_tally(n,0,n.window[n.strstart-1]),u&&e(n,!1),n.strstart++,n.lookahead--,0===n.strm.avail_out)return f}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(u=s._tr_tally(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<r-1?n.strstart:r-1,t===b?(e(n,!0),0===n.strm.avail_out?tt:ut):n.last_lit&&(e(n,!1),0===n.strm.avail_out)?f:ot}function oi(n,t){for(var h,u,i,c,o=n.window;;){if(n.lookahead<=k){if(d(n),n.lookahead<=k&&t===g)return f;if(0===n.lookahead)break}if(n.match_length=0,n.lookahead>=r&&n.strstart>0&&(i=n.strstart-1,u=o[i],u===o[++i]&&u===o[++i]&&u===o[++i])){c=n.strstart+k;do;while(u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&u===o[++i]&&i<c);n.match_length=k-(c-i);n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=r?(h=s._tr_tally(n,1,n.match_length-r),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(h=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),h&&(e(n,!1),0===n.strm.avail_out))return f}return n.insert=0,t===b?(e(n,!0),0===n.strm.avail_out?tt:ut):n.last_lit&&(e(n,!1),0===n.strm.avail_out)?f:ot}function si(n,t){for(var i;;){if(0===n.lookahead&&(d(n),0===n.lookahead)){if(t===g)return f;break}if(n.match_length=0,i=s._tr_tally(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,i&&(e(n,!1),0===n.strm.avail_out))return f}return n.insert=0,t===b?(e(n,!0),0===n.strm.avail_out?tt:ut):n.last_lit&&(e(n,!1),0===n.strm.avail_out)?f:ot}function l(n,t,i,r,u){this.good_length=n;this.max_lazy=t;this.nice_length=i;this.max_chain=r;this.func=u}function hi(n){n.window_size=2*n.w_size;y(n.head);n.max_lazy_match=rt[n.level].max_lazy;n.good_match=rt[n.level].good_length;n.nice_match=rt[n.level].nice_length;n.max_chain_length=rt[n.level].max_chain;n.strstart=0;n.block_start=0;n.lookahead=0;n.insert=0;n.match_length=n.prev_length=r-1;n.match_available=0;n.ins_h=0}function ci(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=ht;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new o.Buf16(2*cr);this.dyn_dtree=new o.Buf16(2*(2*sr+1));this.bl_tree=new o.Buf16(2*(2*hr+1));y(this.dyn_ltree);y(this.dyn_dtree);y(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new o.Buf16(lr+1);this.heap=new o.Buf16(2*wt+1);y(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new o.Buf16(2*wt+1);y(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function gt(n){var t;return n&&n.state?(n.total_in=n.total_out=0,n.data_type=ur,t=n.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ct:nt,n.adler=2===t.wrap?0:1,t.last_flush=g,s._tr_init(t),a):v(n,h)}function ni(n){var t=gt(n);return t===a&&hi(n.state),t}function li(n,t){return n&&n.state?2!==n.state.wrap?h:(n.state.gzhead=t,a):h}function ti(n,t,i,u,f,e){var c,s;return n?(c=1,t===gi&&(t=6),u<0?(c=0,u=-u):u>15&&(c=2,u-=16),f<1||f>fr||i!==ht||u<8||u>15||t<0||t>9||e<0||e>ir)?v(n,h):(8===u&&(u=9),s=new ci,n.state=s,s.strm=n,s.wrap=c,s.gzhead=null,s.w_bits=u,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=f+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+r-1)/r),s.window=new o.Buf8(2*s.w_size),s.head=new o.Buf16(s.hash_size),s.prev=new o.Buf16(s.w_size),s.lit_bufsize=1<<f+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new o.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=e,s.method=i,ni(n)):h}function ai(n,t){return ti(n,t,ht,er,or,rr)}function vi(n,t){var k,i,r,e,o,l,c;if(!n||!n.state||t>ri||t<0)return n?v(n,h):h;if(i=n.state,!n.output||!n.input&&0!==n.avail_in||i.status===et&&t!==b)return v(n,0===n.avail_out?pt:h);if((i.strm=n,k=i.last_flush,i.last_flush=t,i.status===ct)&&(2===i.wrap?(n.adler=0,u(i,31),u(i,139),u(i,8),i.gzhead?(u(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),u(i,255&i.gzhead.time),u(i,i.gzhead.time>>8&255),u(i,i.gzhead.time>>16&255),u(i,i.gzhead.time>>24&255),u(i,9===i.level?2:i.strategy>=st||i.level<2?4:0),u(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(u(i,255&i.gzhead.extra.length),u(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=w(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=bt):(u(i,0),u(i,0),u(i,0),u(i,0),u(i,0),u(i,9===i.level?2:i.strategy>=st||i.level<2?4:0),u(i,vr),i.status=nt)):(o=ht+(i.w_bits-8<<4)<<8,l=-1,l=i.strategy>=st||i.level<2?0:i.level<6?1:6===i.level?2:3,o|=l<<6,0!==i.strstart&&(o|=ar),o+=31-o%31,i.status=nt,ft(i,o),0!==i.strstart&&(ft(i,n.adler>>>16),ft(i,65535&n.adler)),n.adler=1)),i.status===bt)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r)),p(n),r=i.pending,i.pending!==i.pending_buf_size));)u(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r));i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=lt)}else i.status=lt;if(i.status===lt)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r)),p(n),r=i.pending,i.pending===i.pending_buf_size)){e=1;break}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0;u(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r));0===e&&(i.gzindex=0,i.status=at)}else i.status=at;if(i.status===at)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r)),p(n),r=i.pending,i.pending===i.pending_buf_size)){e=1;break}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0;u(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(n.adler=w(n.adler,i.pending_buf,i.pending-r,r));0===e&&(i.status=vt)}else i.status=vt;if(i.status===vt&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&p(n),i.pending+2<=i.pending_buf_size&&(u(i,255&n.adler),u(i,n.adler>>8&255),n.adler=0,i.status=nt)):i.status=nt),0!==i.pending){if(p(n),0===n.avail_out)return i.last_flush=-1,a}else if(0===n.avail_in&&kt(t)<=kt(k)&&t!==b)return v(n,pt);if(i.status===et&&0!==n.avail_in)return v(n,pt);if(0!==n.avail_in||0!==i.lookahead||t!==g&&i.status!==et){if(c=i.strategy===st?si(i,t):i.strategy===tr?oi(i,t):rt[i.level].func(i,t),c!==tt&&c!==ut||(i.status=et),c===f||c===tt)return 0===n.avail_out&&(i.last_flush=-1),a;if(c===ot&&(t===bi?s._tr_align(i):t!==ri&&(s._tr_stored_block(i,0,0,!1),t===ki&&(y(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),p(n),0===n.avail_out))return i.last_flush=-1,a}return t!==b?a:i.wrap<=0?ui:(2===i.wrap?(u(i,255&n.adler),u(i,n.adler>>8&255),u(i,n.adler>>16&255),u(i,n.adler>>24&255),u(i,255&n.total_in),u(i,n.total_in>>8&255),u(i,n.total_in>>16&255),u(i,n.total_in>>24&255)):(ft(i,n.adler>>>16),ft(i,65535&n.adler)),p(n),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?a:ui)}function yi(n){var t;return n&&n.state?(t=n.state.status,t!==ct&&t!==bt&&t!==lt&&t!==at&&t!==vt&&t!==nt&&t!==et?v(n,h):(n.state=null,t===nt?v(n,di):a)):h}function pi(n,t){var i,u,c,f,l,v,p,s,e=t.length;if(!n||!n.state||(i=n.state,f=i.wrap,2===f||1===f&&i.status!==ct||i.lookahead))return h;for(1===f&&(n.adler=ii(n.adler,t,e,0)),i.wrap=0,e>=i.w_size&&(0===f&&(y(i.head),i.strstart=0,i.block_start=0,i.insert=0),s=new o.Buf8(i.w_size),o.arraySet(s,t,e-i.w_size,i.w_size,0),t=s,e=i.w_size),l=n.avail_in,v=n.next_in,p=n.input,n.avail_in=e,n.next_in=0,n.input=t,d(i);i.lookahead>=r;){u=i.strstart;c=i.lookahead-(r-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[u+r-1])&i.hash_mask,i.prev[u&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=u,u++;while(--c);i.strstart=u;i.lookahead=r-1;d(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=r-1,i.match_available=0,n.next_in=v,n.input=p,n.avail_in=l,i.wrap=f,a}var rt,o=n("../utils/common"),s=n("./trees"),ii=n("./adler32"),w=n("./crc32"),wi=n("./messages"),g=0,bi=1,ki=3,b=4,ri=5,a=0,ui=1,h=-2,di=-3,pt=-5,gi=-1,nr=1,st=2,tr=3,ir=4,rr=0,ur=2,ht=8,fr=9,er=15,or=8,wt=286,sr=30,hr=19,cr=2*wt+1,lr=15,r=3,k=258,c=k+r+1,ar=32,ct=42,bt=69,lt=73,at=91,vt=103,nt=113,et=666,f=1,ot=2,tt=3,ut=4,vr=3;rt=[new l(0,0,0,0,ei),new l(4,4,8,4,yt),new l(4,5,16,8,yt),new l(4,6,32,32,yt),new l(4,4,16,16,it),new l(8,16,32,32,it),new l(8,16,128,128,it),new l(8,32,128,256,it),new l(32,128,258,1024,it),new l(32,258,258,4096,it)];i.deflateInit=ai;i.deflateInit2=ti;i.deflateReset=ni;i.deflateResetKeep=gt;i.deflateSetHeader=li;i.deflate=vi;i.deflateEnd=yi;i.deflateSetDictionary=pi;i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(n,t){"use strict";function i(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=!1}t.exports=i},{}],10:[function(n,t){"use strict";var i=30,r=12;t.exports=function(n,t){var c,a,d,f,rt,g,ut,nt,ft,w,k,l,e,tt,it,et,ot,v,u,h,y,s,p,b,o;c=n.state;a=n.next_in;b=n.input;d=a+(n.avail_in-5);f=n.next_out;o=n.output;rt=f-(t-n.avail_out);g=f+(n.avail_out-257);ut=c.dmax;nt=c.wsize;ft=c.whave;w=c.wnext;k=c.window;l=c.hold;e=c.bits;tt=c.lencode;it=c.distcode;et=(1<<c.lenbits)-1;ot=(1<<c.distbits)-1;n:do{e<15&&(l+=b[a++]<<e,e+=8,l+=b[a++]<<e,e+=8);v=tt[l&et];t:for(;;){if(u=v>>>24,l>>>=u,e-=u,u=v>>>16&255,0===u)o[f++]=65535&v;else{if(!(16&u)){if(0==(64&u)){v=tt[(65535&v)+(l&(1<<u)-1)];continue t}if(32&u){c.mode=r;break n}n.msg="invalid literal/length code";c.mode=i;break n}h=65535&v;u&=15;u&&(e<u&&(l+=b[a++]<<e,e+=8),h+=l&(1<<u)-1,l>>>=u,e-=u);e<15&&(l+=b[a++]<<e,e+=8,l+=b[a++]<<e,e+=8);v=it[l&ot];i:for(;;){if(u=v>>>24,l>>>=u,e-=u,u=v>>>16&255,!(16&u)){if(0==(64&u)){v=it[(65535&v)+(l&(1<<u)-1)];continue i}n.msg="invalid distance code";c.mode=i;break n}if(y=65535&v,u&=15,e<u&&(l+=b[a++]<<e,e+=8,e<u&&(l+=b[a++]<<e,e+=8)),y+=l&(1<<u)-1,y>ut){n.msg="invalid distance too far back";c.mode=i;break n}if(l>>>=u,e-=u,u=f-rt,y>u){if(u=y-u,u>ft&&c.sane){n.msg="invalid distance too far back";c.mode=i;break n}if(s=0,p=k,0===w){if(s+=nt-u,u<h){h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}}else if(w<u){if(s+=nt+w-u,u-=w,u<h){h-=u;do o[f++]=k[s++];while(--u);if(s=0,w<h){u=w;h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}}}else if(s+=w-u,u<h){h-=u;do o[f++]=k[s++];while(--u);s=f-y;p=o}for(;h>2;)o[f++]=p[s++],o[f++]=p[s++],o[f++]=p[s++],h-=3;h&&(o[f++]=p[s++],h>1&&(o[f++]=p[s++]))}else{s=f-y;do o[f++]=o[s++],o[f++]=o[s++],o[f++]=o[s++],h-=3;while(h>2);h&&(o[f++]=o[s++],h>1&&(o[f++]=o[s++]))}break}}break}}while(a<d&&f<g);h=e>>3;a-=h;e-=h<<3;l&=(1<<e)-1;n.next_in=a;n.next_out=f;n.avail_in=a<d?5+(d-a):5-(a-d);n.avail_out=f<g?257+(g-f):257-(f-g);c.hold=l;c.bits=e}},{}],11:[function(n,t,i){"use strict";function tt(n){return(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24)}function yi(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new u.Buf16(320);this.work=new u.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function it(n){var t;return n&&n.state?(t=n.state,n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=at,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new u.Buf32(or),t.distcode=t.distdyn=new u.Buf32(sr),t.sane=1,t.back=-1,s):f}function rt(n){var t;return n&&n.state?(t=n.state,t.wsize=0,t.whave=0,t.wnext=0,it(n)):f}function ut(n,t){var r,i;return n&&n.state?(i=n.state,t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?f:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,rt(n))):f}function ft(n,t){var i,r;return n?(r=new yi,n.state=r,r.window=null,i=ut(n,t),i!==s&&(n.state=null),i):f}function pi(n){return ft(n,hr)}function wi(n){if(vi){var t;for(y=new u.Buf32(512),p=new u.Buf32(32),t=0;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(h(ot,n.lens,0,288,y,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;h(st,n.lens,0,32,p,0,n.work,{bits:5});vi=!1}n.lencode=y;n.lenbits=9;n.distcode=p;n.distbits=5}function et(n,t,i,r){var e,f=n.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new u.Buf8(f.wsize)),r>=f.wsize?(u.arraySet(f.window,t,i-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>r&&(e=r),u.arraySet(f.window,t,i-r,e,f.wnext),r-=e,r?(u.arraySet(f.window,t,i-r,r,0),f.wnext=r,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function bi(n,t){var i,ft,lr,ut,hr,it,ki,p,y,yr,yi,rt,pr,kr,vi,gi,sr,or,wr,br,pi,cr,vr,ar,bi=0,di=new u.Buf8(4),dr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!n||!n.state||!n.output||!n.input&&0!==n.avail_in)return f;i=n.state;i.mode===o&&(i.mode=k);hr=n.next_out;lr=n.output;ki=n.avail_out;ut=n.next_in;ft=n.input;it=n.avail_in;p=i.hold;y=i.bits;yr=it;yi=ki;cr=s;n:for(;;)switch(i.mode){case at:if(0===i.wrap){i.mode=k;break}for(;y<16;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(2&i.wrap&&35615===p){i.check=0;di[0]=255&p;di[1]=p>>>8&255;i.check=e(i.check,di,2,0);p=0;y=0;i.mode=vt;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&p)<<8)+(p>>8))%31){n.msg="incorrect header check";i.mode=r;break}if((15&p)!==lt){n.msg="unknown compression method";i.mode=r;break}if(p>>>=4,y-=4,pi=(15&p)+8,0===i.wbits)i.wbits=pi;else if(pi>i.wbits){n.msg="invalid window size";i.mode=r;break}i.dmax=1<<pi;n.adler=i.check=1;i.mode=512&p?ni:o;p=0;y=0;break;case vt:for(;y<16;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(i.flags=p,(255&i.flags)!==lt){n.msg="unknown compression method";i.mode=r;break}if(57344&i.flags){n.msg="unknown header flags set";i.mode=r;break}i.head&&(i.head.text=p>>8&1);512&i.flags&&(di[0]=255&p,di[1]=p>>>8&255,i.check=e(i.check,di,2,0));p=0;y=0;i.mode=yt;case yt:for(;y<32;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.head&&(i.head.time=p);512&i.flags&&(di[0]=255&p,di[1]=p>>>8&255,di[2]=p>>>16&255,di[3]=p>>>24&255,i.check=e(i.check,di,4,0));p=0;y=0;i.mode=pt;case pt:for(;y<16;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.head&&(i.head.xflags=255&p,i.head.os=p>>8);512&i.flags&&(di[0]=255&p,di[1]=p>>>8&255,i.check=e(i.check,di,2,0));p=0;y=0;i.mode=wt;case wt:if(1024&i.flags){for(;y<16;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.length=p;i.head&&(i.head.extra_len=p);512&i.flags&&(di[0]=255&p,di[1]=p>>>8&255,i.check=e(i.check,di,2,0));p=0;y=0}else i.head&&(i.head.extra=null);i.mode=bt;case bt:if(1024&i.flags&&(rt=i.length,rt>it&&(rt=it),rt&&(i.head&&(pi=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),u.arraySet(i.head.extra,ft,ut,rt,pi)),512&i.flags&&(i.check=e(i.check,ft,rt,ut)),it-=rt,ut+=rt,i.length-=rt),i.length))break n;i.length=0;i.mode=kt;case kt:if(2048&i.flags){if(0===it)break n;rt=0;do pi=ft[ut+rt++],i.head&&pi&&i.length<65536&&(i.head.name+=String.fromCharCode(pi));while(pi&&rt<it);if(512&i.flags&&(i.check=e(i.check,ft,rt,ut)),it-=rt,ut+=rt,pi)break n}else i.head&&(i.head.name=null);i.length=0;i.mode=dt;case dt:if(4096&i.flags){if(0===it)break n;rt=0;do pi=ft[ut+rt++],i.head&&pi&&i.length<65536&&(i.head.comment+=String.fromCharCode(pi));while(pi&&rt<it);if(512&i.flags&&(i.check=e(i.check,ft,rt,ut)),it-=rt,ut+=rt,pi)break n}else i.head&&(i.head.comment=null);i.mode=gt;case gt:if(512&i.flags){for(;y<16;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(p!==(65535&i.check)){n.msg="header crc mismatch";i.mode=r;break}p=0;y=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0);n.adler=i.check=0;i.mode=o;break;case ni:for(;y<32;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}n.adler=i.check=tt(p);p=0;y=0;i.mode=l;case l:if(0===i.havedict)return n.next_out=hr,n.avail_out=ki,n.next_in=ut,n.avail_in=it,i.hold=p,i.bits=y,ur;n.adler=i.check=1;i.mode=o;case o:if(t===ir||t===c)break n;case k:if(i.last){p>>>=7&y;y-=7&y;i.mode=g;break}for(;y<3;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}switch(i.last=1&p,p>>>=1,y-=1,3&p){case 0:i.mode=ti;break;case 1:if(wi(i),i.mode=a,t===c){p>>>=2;y-=2;break n}break;case 2:i.mode=ri;break;case 3:n.msg="invalid block type";i.mode=r}p>>>=2;y-=2;break;case ti:for(p>>>=7&y,y-=7&y;y<32;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if((65535&p)!=(p>>>16^65535)){n.msg="invalid stored block lengths";i.mode=r;break}if(i.length=65535&p,p=0,y=0,i.mode=d,t===c)break n;case d:i.mode=ii;case ii:if(rt=i.length){if(rt>it&&(rt=it),rt>ki&&(rt=ki),0===rt)break n;u.arraySet(lr,ft,ut,rt,hr);it-=rt;ut+=rt;ki-=rt;hr+=rt;i.length-=rt;break}i.mode=o;break;case ri:for(;y<14;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(i.nlen=(31&p)+257,p>>>=5,y-=5,i.ndist=(31&p)+1,p>>>=5,y-=5,i.ncode=(15&p)+4,p>>>=4,y-=4,i.nlen>286||i.ndist>30){n.msg="too many length or distance symbols";i.mode=r;break}i.have=0;i.mode=ui;case ui:for(;i.have<i.ncode;){for(;y<3;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.lens[dr[i.have++]]=7&p;p>>>=3;y-=3}for(;i.have<19;)i.lens[dr[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,vr={bits:i.lenbits},cr=h(tr,i.lens,0,19,i.lencode,0,i.work,vr),i.lenbits=vr.bits,cr){n.msg="invalid code lengths set";i.mode=r;break}i.have=0;i.mode=fi;case fi:for(;i.have<i.nlen+i.ndist;){for(;bi=i.lencode[p&(1<<i.lenbits)-1],vi=bi>>>24,gi=bi>>>16&255,sr=65535&bi,!(vi<=y);){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(sr<16)p>>>=vi,y-=vi,i.lens[i.have++]=sr;else{if(16===sr){for(ar=vi+2;y<ar;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(p>>>=vi,y-=vi,0===i.have){n.msg="invalid bit length repeat";i.mode=r;break}pi=i.lens[i.have-1];rt=3+(3&p);p>>>=2;y-=2}else if(17===sr){for(ar=vi+3;y<ar;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}p>>>=vi;y-=vi;pi=0;rt=3+(7&p);p>>>=3;y-=3}else{for(ar=vi+7;y<ar;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}p>>>=vi;y-=vi;pi=0;rt=11+(127&p);p>>>=7;y-=7}if(i.have+rt>i.nlen+i.ndist){n.msg="invalid bit length repeat";i.mode=r;break}for(;rt--;)i.lens[i.have++]=pi}}if(i.mode===r)break;if(0===i.lens[256]){n.msg="invalid code -- missing end-of-block";i.mode=r;break}if(i.lenbits=9,vr={bits:i.lenbits},cr=h(ot,i.lens,0,i.nlen,i.lencode,0,i.work,vr),i.lenbits=vr.bits,cr){n.msg="invalid literal/lengths set";i.mode=r;break}if(i.distbits=6,i.distcode=i.distdyn,vr={bits:i.distbits},cr=h(st,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,vr),i.distbits=vr.bits,cr){n.msg="invalid distances set";i.mode=r;break}if(i.mode=a,t===c)break n;case a:i.mode=v;case v:if(it>=6&&ki>=258){n.next_out=hr;n.avail_out=ki;n.next_in=ut;n.avail_in=it;i.hold=p;i.bits=y;nr(n,yi);hr=n.next_out;lr=n.output;ki=n.avail_out;ut=n.next_in;ft=n.input;it=n.avail_in;p=i.hold;y=i.bits;i.mode===o&&(i.back=-1);break}for(i.back=0;bi=i.lencode[p&(1<<i.lenbits)-1],vi=bi>>>24,gi=bi>>>16&255,sr=65535&bi,!(vi<=y);){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(gi&&0==(240&gi)){for(or=vi,wr=gi,br=sr;bi=i.lencode[br+((p&(1<<or+wr)-1)>>or)],vi=bi>>>24,gi=bi>>>16&255,sr=65535&bi,!(or+vi<=y);){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}p>>>=or;y-=or;i.back+=or}if(p>>>=vi,y-=vi,i.back+=vi,i.length=sr,0===gi){i.mode=ci;break}if(32&gi){i.back=-1;i.mode=o;break}if(64&gi){n.msg="invalid literal/length code";i.mode=r;break}i.extra=15&gi;i.mode=ei;case ei:if(i.extra){for(ar=i.extra;y<ar;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.length+=p&(1<<i.extra)-1;p>>>=i.extra;y-=i.extra;i.back+=i.extra}i.was=i.length;i.mode=oi;case oi:for(;bi=i.distcode[p&(1<<i.distbits)-1],vi=bi>>>24,gi=bi>>>16&255,sr=65535&bi,!(vi<=y);){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(0==(240&gi)){for(or=vi,wr=gi,br=sr;bi=i.distcode[br+((p&(1<<or+wr)-1)>>or)],vi=bi>>>24,gi=bi>>>16&255,sr=65535&bi,!(or+vi<=y);){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}p>>>=or;y-=or;i.back+=or}if(p>>>=vi,y-=vi,i.back+=vi,64&gi){n.msg="invalid distance code";i.mode=r;break}i.offset=sr;i.extra=15&gi;i.mode=si;case si:if(i.extra){for(ar=i.extra;y<ar;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}i.offset+=p&(1<<i.extra)-1;p>>>=i.extra;y-=i.extra;i.back+=i.extra}if(i.offset>i.dmax){n.msg="invalid distance too far back";i.mode=r;break}i.mode=hi;case hi:if(0===ki)break n;if(rt=yi-ki,i.offset>rt){if(rt=i.offset-rt,rt>i.whave&&i.sane){n.msg="invalid distance too far back";i.mode=r;break}rt>i.wnext?(rt-=i.wnext,pr=i.wsize-rt):pr=i.wnext-rt;rt>i.length&&(rt=i.length);kr=i.window}else kr=lr,pr=hr-i.offset,rt=i.length;rt>ki&&(rt=ki);ki-=rt;i.length-=rt;do lr[hr++]=kr[pr++];while(--rt);0===i.length&&(i.mode=v);break;case ci:if(0===ki)break n;lr[hr++]=i.length;ki--;i.mode=v;break;case g:if(i.wrap){for(;y<32;){if(0===it)break n;it--;p|=ft[ut++]<<y;y+=8}if(yi-=ki,n.total_out+=yi,i.total+=yi,yi&&(n.adler=i.check=i.flags?e(i.check,lr,yi,hr-yi):w(i.check,lr,yi,hr-yi)),yi=ki,(i.flags?p:tt(p))!==i.check){n.msg="incorrect data check";i.mode=r;break}p=0;y=0}i.mode=li;case li:if(i.wrap&&i.flags){for(;y<32;){if(0===it)break n;it--;p+=ft[ut++]<<y;y+=8}if(p!==(4294967295&i.total)){n.msg="incorrect length check";i.mode=r;break}p=0;y=0}i.mode=ai;case ai:cr=rr;break n;case r:cr=ct;break n;case nt:return b;case er:default:return f}return n.next_out=hr,n.avail_out=ki,n.next_in=ut,n.avail_in=it,i.hold=p,i.bits=y,(i.wsize||yi!==n.avail_out&&i.mode<r&&(i.mode<g||t!==ht))&&et(n,n.output,n.next_out,yi-n.avail_out)?(i.mode=nt,b):(yr-=n.avail_in,yi-=n.avail_out,n.total_in+=yr,n.total_out+=yi,i.total+=yi,i.wrap&&yi&&(n.adler=i.check=i.flags?e(i.check,lr,yi,n.next_out-yi):w(i.check,lr,yi,n.next_out-yi)),n.data_type=i.bits+(i.last?64:0)+(i.mode===o?128:0)+(i.mode===a||i.mode===d?256:0),(0===yr&&0===yi||t===ht)&&cr===s&&(cr=fr),cr)}function ki(n){if(!n||!n.state)return f;var t=n.state;return t.window&&(t.window=null),n.state=null,s}function di(n,t){var i;return n&&n.state?(i=n.state,0==(2&i.wrap)?f:(i.head=t,t.done=!1,s)):f}function gi(n,t){var i,r,e,u=t.length;return n&&n.state?(i=n.state,0!==i.wrap&&i.mode!==l?f:i.mode===l&&(r=1,r=w(r,t,u,0),r!==i.check)?ct:(e=et(n,t,u,u))?(i.mode=nt,b):(i.havedict=1,s)):f}var y,p,u=n("../utils/common"),w=n("./adler32"),e=n("./crc32"),nr=n("./inffast"),h=n("./inftrees"),tr=0,ot=1,st=2,ht=4,ir=5,c=6,s=0,rr=1,ur=2,f=-2,ct=-3,b=-4,fr=-5,lt=8,at=1,vt=2,yt=3,pt=4,wt=5,bt=6,kt=7,dt=8,gt=9,ni=10,l=11,o=12,k=13,ti=14,d=15,ii=16,ri=17,ui=18,fi=19,a=20,v=21,ei=22,oi=23,si=24,hi=25,ci=26,g=27,li=28,ai=29,r=30,nt=31,er=32,or=852,sr=592,hr=15,vi=!0;i.inflateReset=rt;i.inflateReset2=ut;i.inflateResetKeep=it;i.inflateInit=pi;i.inflateInit2=ft;i.inflate=bi;i.inflateEnd=ki;i.inflateGetHeader=di;i.inflateSetDictionary=gi;i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(n,t){"use strict";var u=n("../utils/common"),i=15,f=852,e=592,o=0,r=1,s=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(n,t,v,y,p,w,b,k){for(var ot,ct,vt,dt,lt,at,gt,yt,pt,ri=k.bits,d=0,g=0,ut=0,nt=0,tt=0,ft=0,it=0,et=0,ht=0,rt=0,wt=null,ni=0,st=new u.Buf16(i+1),bt=new u.Buf16(i+1),kt=null,ti=0,ii,d=0;d<=i;d++)st[d]=0;for(g=0;g<y;g++)st[t[v+g]]++;for(tt=ri,nt=i;nt>=1&&0===st[nt];nt--);if(tt>nt&&(tt=nt),0===nt)return p[w++]=20971520,p[w++]=20971520,k.bits=1,0;for(ut=1;ut<nt&&0===st[ut];ut++);for(tt<ut&&(tt=ut),et=1,d=1;d<=i;d++)if(et<<=1,et-=st[d],et<0)return-1;if(et>0&&(n===o||1!==nt))return-1;for(bt[1]=0,d=1;d<i;d++)bt[d+1]=bt[d]+st[d];for(g=0;g<y;g++)0!==t[v+g]&&(b[bt[t[v+g]]++]=g);if(n===o?(wt=kt=b,at=19):n===r?(wt=h,ni-=257,kt=c,ti-=257,at=256):(wt=l,kt=a,at=-1),rt=0,g=0,d=ut,lt=w,ft=tt,it=0,vt=-1,ht=1<<tt,dt=ht-1,n===r&&ht>f||n===s&&ht>e)return 1;for(ii=0;;){ii++;gt=d-it;b[g]<at?(yt=0,pt=b[g]):b[g]>at?(yt=kt[ti+b[g]],pt=wt[ni+b[g]]):(yt=96,pt=0);ot=1<<d-it;ct=1<<ft;ut=ct;do ct-=ot,p[lt+(rt>>it)+ct]=gt<<24|yt<<16|pt|0;while(0!==ct);for(ot=1<<d-1;rt&ot;)ot>>=1;if(0!==ot?(rt&=ot-1,rt+=ot):rt=0,g++,0==--st[d]){if(d===nt)break;d=t[v+b[g]]}if(d>tt&&(rt&dt)!==vt){for(0===it&&(it=tt),lt+=ut,ft=d-it,et=1<<ft;ft+it<nt&&(et-=st[ft+it],!(et<=0));)ft++,et<<=1;if(ht+=1<<ft,n===r&&ht>f||n===s&&ht>e)return 1;vt=rt&dt;p[vt]=tt<<24|ft<<16|lt-w|0}}return 0!==rt&&(p[lt+rt]=d-it<<24|4194304),k.bits=tt,0}},{"../utils/common":3}],13:[function(n,t){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(n,t,i){"use strict";function o(n){for(var t=n.length;--t>=0;)n[t]=0}function k(n,t,i,r,u){this.static_tree=n;this.extra_bits=t;this.extra_base=i;this.elems=r;this.max_length=u;this.has_stree=n&&n.length}function d(n,t){this.dyn_tree=n;this.max_code=0;this.stat_desc=t}function ot(n){return n<256?c[n]:c[256+(n>>>7)]}function a(n,t){n.pending_buf[n.pending++]=255&t;n.pending_buf[n.pending++]=t>>>8&255}function r(n,t,i){n.bi_valid>rt-i?(n.bi_buf|=t<<n.bi_valid&65535,a(n,n.bi_buf),n.bi_buf=t>>rt-n.bi_valid,n.bi_valid+=i-rt):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=i)}function u(n,t,i){r(n,i[2*t],i[2*t+1])}function st(n,t){var i=0;do i|=1&n,n>>>=1,i<<=1;while(--t>0);return i>>>1}function oi(n){16===n.bi_valid?(a(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)}function si(n,t){for(var o,r,f,h,l,u=t.dyn_tree,a=t.max_code,y=t.stat_desc.static_tree,p=t.stat_desc.has_stree,w=t.stat_desc.extra_bits,v=t.stat_desc.extra_base,s=t.stat_desc.max_length,c=0,i=0;i<=e;i++)n.bl_count[i]=0;for(u[2*n.heap[n.heap_max]+1]=0,o=n.heap_max+1;o<gt;o++)r=n.heap[o],i=u[2*u[2*r+1]+1]+1,i>s&&(i=s,c++),u[2*r+1]=i,r>a||(n.bl_count[i]++,h=0,r>=v&&(h=w[r-v]),l=u[2*r],n.opt_len+=l*(i+h),p&&(n.static_len+=l*(y[2*r+1]+h)));if(0!==c){do{for(i=s-1;0===n.bl_count[i];)i--;n.bl_count[i]--;n.bl_count[i+1]+=2;n.bl_count[s]--;c-=2}while(c>0);for(i=s;0!==i;i--)for(r=n.bl_count[i];0!==r;)f=n.heap[--o],f>a||(u[2*f+1]!==i&&(n.opt_len+=(i-u[2*f+1])*u[2*f],u[2*f+1]=i),r--)}}function ht(n,t,i){for(var u,o=new Array(e+1),s=0,f,r=1;r<=e;r++)o[r]=s=s+i[r-1]<<1;for(u=0;u<=t;u++)f=n[2*u+1],0!==f&&(n[2*u]=st(o[f]++,f))}function hi(){for(var n,u,i,r=new Array(e+1),o=0,t=0;t<tt-1;t++)for(b[t]=o,n=0;n<1<<ft[t];n++)l[o++]=t;for(l[o-1]=t,i=0,t=0;t<16;t++)for(p[t]=i,n=0;n<1<<w[t];n++)c[i++]=t;for(i>>=7;t<s;t++)for(p[t]=i<<7,n=0;n<1<<w[t]-7;n++)c[256+i++]=t;for(u=0;u<=e;u++)r[u]=0;for(n=0;n<=143;)f[2*n+1]=8,n++,r[8]++;for(;n<=255;)f[2*n+1]=9,n++,r[9]++;for(;n<=279;)f[2*n+1]=7,n++,r[7]++;for(;n<=287;)f[2*n+1]=8,n++,r[8]++;for(ht(f,y+1,r),n=0;n<s;n++)h[2*n+1]=5,h[2*n]=st(n,5);ui=new k(f,ft,v+1,y,e);fi=new k(h,w,0,s,e);ei=new k(new Array(0),rr,0,it,ir)}function ct(n){for(var t=0;t<y;t++)n.dyn_ltree[2*t]=0;for(t=0;t<s;t++)n.dyn_dtree[2*t]=0;for(t=0;t<it;t++)n.bl_tree[2*t]=0;n.dyn_ltree[2*ut]=1;n.opt_len=n.static_len=0;n.last_lit=n.matches=0}function lt(n){n.bi_valid>8?a(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf);n.bi_buf=0;n.bi_valid=0}function ci(n,t,i,r){lt(n);r&&(a(n,i),a(n,~i));ki.arraySet(n.pending_buf,n.window,t,i,n.pending);n.pending+=i}function at(n,t,i,r){var u=2*t,f=2*i;return n[u]<n[f]||n[u]===n[f]&&r[t]<=r[i]}function g(n,t,i){for(var u=n.heap[i],r=i<<1;r<=n.heap_len&&(r<n.heap_len&&at(t,n.heap[r+1],n.heap[r],n.depth)&&r++,!at(t,u,n.heap[r],n.depth));)n.heap[i]=n.heap[r],i=r,r<<=1;n.heap[i]=u}function vt(n,t,i){var e,s,f,o,h=0;if(0!==n.last_lit)do e=n.pending_buf[n.d_buf+2*h]<<8|n.pending_buf[n.d_buf+2*h+1],s=n.pending_buf[n.l_buf+h],h++,0===e?u(n,s,t):(f=l[s],u(n,f+v+1,t),o=ft[f],0!==o&&(s-=b[f],r(n,s,o)),e--,f=ot(e),u(n,f,i),o=w[f],0!==o&&(e-=p[f],r(n,e,o)));while(h<n.last_lit);u(n,ut,t)}function nt(n,t){var i,f,u,r=t.dyn_tree,s=t.stat_desc.static_tree,h=t.stat_desc.has_stree,o=t.stat_desc.elems,e=-1;for(n.heap_len=0,n.heap_max=gt,i=0;i<o;i++)0!==r[2*i]?(n.heap[++n.heap_len]=e=i,n.depth[i]=0):r[2*i+1]=0;for(;n.heap_len<2;)u=n.heap[++n.heap_len]=e<2?++e:0,r[2*u]=1,n.depth[u]=0,n.opt_len--,h&&(n.static_len-=s[2*u+1]);for(t.max_code=e,i=n.heap_len>>1;i>=1;i--)g(n,r,i);u=o;do i=n.heap[1],n.heap[1]=n.heap[n.heap_len--],g(n,r,1),f=n.heap[1],n.heap[--n.heap_max]=i,n.heap[--n.heap_max]=f,r[2*u]=r[2*i]+r[2*f],n.depth[u]=(n.depth[i]>=n.depth[f]?n.depth[i]:n.depth[f])+1,r[2*i+1]=r[2*f+1]=u,n.heap[1]=u++,g(n,r,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1];si(n,t);ht(r,e,n.bl_count)}function yt(n,t,i){var s,r,h=-1,u=t[1],f=0,e=7,o=4;for(0===u&&(e=138,o=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)r=u,u=t[2*(s+1)+1],++f<e&&r===u||(f<o?n.bl_tree[2*r]+=f:0!==r?(r!==h&&n.bl_tree[2*r]++,n.bl_tree[2*ni]++):f<=10?n.bl_tree[2*ti]++:n.bl_tree[2*ii]++,f=0,h=r,0===u?(e=138,o=3):r===u?(e=6,o=3):(e=7,o=4))}function pt(n,t,i){var c,e,l=-1,o=t[1],f=0,s=7,h=4;for(0===o&&(s=138,h=3),c=0;c<=i;c++)if(e=o,o=t[2*(c+1)+1],!(++f<s&&e===o)){if(f<h){do u(n,e,n.bl_tree);while(0!=--f)}else 0!==e?(e!==l&&(u(n,e,n.bl_tree),f--),u(n,ni,n.bl_tree),r(n,f-3,2)):f<=10?(u(n,ti,n.bl_tree),r(n,f-3,3)):(u(n,ii,n.bl_tree),r(n,f-11,7));f=0;l=e;0===o?(s=138,h=3):e===o?(s=6,h=3):(s=7,h=4)}}function li(n){var t;for(yt(n,n.dyn_ltree,n.l_desc.max_code),yt(n,n.dyn_dtree,n.d_desc.max_code),nt(n,n.bl_desc),t=it-1;t>=3&&0===n.bl_tree[2*ri[t]+1];t--);return n.opt_len+=3*(t+1)+5+5+4,t}function ai(n,t,i,u){var f;for(r(n,t-257,5),r(n,i-1,5),r(n,u-4,4),f=0;f<u;f++)r(n,n.bl_tree[2*ri[f]+1],3);pt(n,n.dyn_ltree,t-1);pt(n,n.dyn_dtree,i-1)}function vi(n){for(var i=4093624447,t=0;t<=31;t++,i>>>=1)if(1&i&&0!==n.dyn_ltree[2*t])return bt;if(0!==n.dyn_ltree[18]||0!==n.dyn_ltree[20]||0!==n.dyn_ltree[26])return kt;for(t=32;t<v;t++)if(0!==n.dyn_ltree[2*t])return kt;return bt}function yi(n){et||(hi(),et=!0);n.l_desc=new d(n.dyn_ltree,ui);n.d_desc=new d(n.dyn_dtree,fi);n.bl_desc=new d(n.bl_tree,ei);n.bi_buf=0;n.bi_valid=0;ct(n)}function wt(n,t,i,u){r(n,(nr<<1)+(u?1:0),3);ci(n,t,i,!0)}function pi(n){r(n,dt<<1,3);u(n,ut,f);oi(n)}function wi(n,t,i,u){var e,o,s=0;n.level>0?(n.strm.data_type===gi&&(n.strm.data_type=vi(n)),nt(n,n.l_desc),nt(n,n.d_desc),s=li(n),e=n.opt_len+3+7>>>3,o=n.static_len+3+7>>>3,o<=e&&(e=o)):e=o=i+5;i+4<=e&&t!==-1?wt(n,t,i,u):n.strategy===di||o===e?(r(n,(dt<<1)+(u?1:0),3),vt(n,f,h)):(r(n,(tr<<1)+(u?1:0),3),ai(n,n.l_desc.max_code+1,n.d_desc.max_code+1,s+1),vt(n,n.dyn_ltree,n.dyn_dtree));ct(n);u&&lt(n)}function bi(n,t,i){return n.pending_buf[n.d_buf+2*n.last_lit]=t>>>8&255,n.pending_buf[n.d_buf+2*n.last_lit+1]=255&t,n.pending_buf[n.l_buf+n.last_lit]=255&i,n.last_lit++,0===t?n.dyn_ltree[2*i]++:(n.matches++,t--,n.dyn_ltree[2*(l[i]+v+1)]++,n.dyn_dtree[2*ot(t)]++),n.last_lit===n.lit_bufsize-1}var ki=n("../utils/common"),di=4,bt=0,kt=1,gi=2,nr=0,dt=1,tr=2,tt=29,v=256,y=v+1+tt,s=30,it=19,gt=2*y+1,e=15,rt=16,ir=7,ut=256,ni=16,ti=17,ii=18,ft=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],rr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ri=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(2*(y+2)),h,c,l,b,p,ui,fi,ei,et;o(f);h=new Array(2*s);o(h);c=new Array(512);o(c);l=new Array(256);o(l);b=new Array(tt);o(b);p=new Array(s);o(p);et=!1;i._tr_init=yi;i._tr_stored_block=wt;i._tr_flush_block=wi;i._tr_tally=bi;i._tr_align=pi},{"../utils/common":3}],15:[function(n,t){"use strict";function i(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}t.exports=i},{}],"/":[function(n,t){"use strict";var r=n("./lib/utils/common").assign,u=n("./lib/deflate"),f=n("./lib/inflate"),e=n("./lib/zlib/constants"),i={};r(i,u,f,e);t.exports=i},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")});Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(n,t){t=t!=null?t:!1;var e="",o,i,r,h,c,s,u,f=0;for(t||(n=Base64._utf8_encode(n));f<n.length;)o=n.charCodeAt(f++),i=n.charCodeAt(f++),r=n.charCodeAt(f++),h=o>>2,c=(o&3)<<4|i>>4,s=(i&15)<<2|r>>6,u=r&63,isNaN(i)?s=u=64:isNaN(r)&&(u=64),e=e+this._keyStr.charAt(h)+this._keyStr.charAt(c)+this._keyStr.charAt(s)+this._keyStr.charAt(u);return e},decode:function(n,t){t=t!=null?t:!1;var i="",o,s,h,c,f,u,e,r=0;for(n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<n.length;)c=this._keyStr.indexOf(n.charAt(r++)),f=this._keyStr.indexOf(n.charAt(r++)),u=this._keyStr.indexOf(n.charAt(r++)),e=this._keyStr.indexOf(n.charAt(r++)),o=c<<2|f>>4,s=(f&15)<<4|u>>2,h=(u&3)<<6|e,i=i+String.fromCharCode(o),u!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h));return t||(i=Base64._utf8_decode(i)),i},_utf8_encode:function(n){var i,r,t;for(n=n.replace(/\r\n/g,"\n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i},_utf8_decode:function(n){for(var r="",t=0,i=c1=c2=0;t<n.length;)i=n.charCodeAt(t),i<128?(r+=String.fromCharCode(i),t++):i>191&&i<224?(c2=n.charCodeAt(t+1),r+=String.fromCharCode((i&31)<<6|c2&63),t+=2):(c2=n.charCodeAt(t+1),c3=n.charCodeAt(t+2),r+=String.fromCharCode((i&15)<<12|(c2&63)<<6|c3&63),t+=3);return r}};
/**
 * jscolor, JavaScript Color Picker
 *
 * @version 1.3.13
 * @license GNU Lesser General Public License, http://www.gnu.org/copyleft/lesser.html
 * @author  Jan Odvarko, http://odvarko.cz
 * @created 2008-06-15
 * @updated 2012-01-19
 * @link    http://jscolor.com
 */
jscolor={dir:"",bindClass:"color",binding:!0,preloading:!0,install:function(){},init:function(){jscolor.preloading&&jscolor.preload()},getDir:function(){if(!jscolor.dir){var n=jscolor.detectDir();jscolor.dir=n!==!1?n:"jscolor/"}return jscolor.dir},detectDir:function(){for(var u,i,r=location.href,t=document.getElementsByTagName("base"),n=0;n<t.length;n+=1)t[n].href&&(r=t[n].href);for(t=document.getElementsByTagName("script"),n=0;n<t.length;n+=1)if(t[n].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(t[n].src))return u=new jscolor.URI(t[n].src),i=u.toAbsolute(r),i.path=i.path.replace(/[^\/]+$/,""),i.query=null,i.fragment=null,i.toString();return!1},preload:function(){for(var n in jscolor.imgRequire)jscolor.imgRequire.hasOwnProperty(n)&&jscolor.loadImage(n)},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(n){jscolor.imgRequire[n]=!0},loadImage:function(n){jscolor.imgLoaded[n]||(jscolor.imgLoaded[n]=new Image,jscolor.imgLoaded[n].src=jscolor.getDir()+n)},fetchElement:function(n){return typeof n=="string"?document.getElementById(n):n},addEvent:function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)},fireEvent:function(n,t){var i;n&&(document.createEvent?(i=document.createEvent("HTMLEvents"),i.initEvent(t,!0,!0),n.dispatchEvent(i)):document.createEventObject?(i=document.createEventObject(),n.fireEvent("on"+t,i)):n["on"+t]&&n["on"+t]())},getElementPos:function(n){var t=n,i=n,r=0,u=0;if(t.offsetParent)do r+=t.offsetLeft,u+=t.offsetTop;while(t=t.offsetParent);while((i=i.parentNode)&&i.nodeName.toUpperCase()!=="BODY")r-=i.scrollLeft,u-=i.scrollTop;return[r,u]},getElementSize:function(n){return[n.offsetWidth,n.offsetHeight]},getRelMousePos:function(n){var t=0,i=0;return n||(n=window.event),typeof n.offsetX=="number"?(t=n.offsetX,i=n.offsetY):typeof n.layerX=="number"&&(t=n.layerX,i=n.layerY),{x:t,y:i}},getViewPos:function(){return typeof pageYOffset=="number"?[window.pageXOffset,window.pageYOffset]:document.body&&(document.body.scrollLeft||document.body.scrollTop)?[document.body.scrollLeft,document.body.scrollTop]:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)?[document.documentElement.scrollLeft,document.documentElement.scrollTop]:[0,0]},getViewSize:function(){return typeof innerWidth=="number"?[window.innerWidth,window.innerHeight]:document.body&&(document.body.clientWidth||document.body.clientHeight)?[document.body.clientWidth,document.body.clientHeight]:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?[document.documentElement.clientWidth,document.documentElement.clientHeight]:[0,0]},URI:function(n){function t(n){for(var t="",i;n;)n.substr(0,3)==="../"||n.substr(0,2)==="./"?n=n.replace(/^\.+/,"").substr(1):n.substr(0,3)==="/./"||n==="/."?n="/"+n.substr(3):n.substr(0,4)==="/../"||n==="/.."?(n="/"+n.substr(4),t=t.replace(/\/?[^\/]*$/,"")):n==="."||n===".."?n="":(i=n.match(/^\/?[^\/]*/)[0],n=n.substr(i.length),t=t+i);return t}this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(n){var t=n.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);return this.scheme=t[3]?t[2]:null,this.authority=t[5]?t[6]:null,this.path=t[7],this.query=t[9]?t[10]:null,this.fragment=t[12]?t[13]:null,this};this.toString=function(){var n="";return this.scheme!==null&&(n=n+this.scheme+":"),this.authority!==null&&(n=n+"//"+this.authority),this.path!==null&&(n=n+this.path),this.query!==null&&(n=n+"?"+this.query),this.fragment!==null&&(n=n+"#"+this.fragment),n};this.toAbsolute=function(n){var n=new jscolor.URI(n),i=this,r=new jscolor.URI;return n.scheme===null?!1:(i.scheme!==null&&i.scheme.toLowerCase()===n.scheme.toLowerCase()&&(i.scheme=null),i.scheme!==null?(r.scheme=i.scheme,r.authority=i.authority,r.path=t(i.path),r.query=i.query):(i.authority!==null?(r.authority=i.authority,r.path=t(i.path),r.query=i.query):(i.path===""?(r.path=n.path,r.query=i.query!==null?i.query:n.query):(i.path.substr(0,1)==="/"?r.path=t(i.path):(r.path=n.authority!==null&&n.path===""?"/"+i.path:n.path.replace(/[^\/]+$/,"")+i.path,r.path=t(r.path)),r.query=i.query),r.authority=n.authority),r.scheme=n.scheme),r.fragment=i.fragment,r)};n&&this.parse(n)},color:function(n,t){function tt(n,t,i){var f=Math.min(Math.min(n,t),i),u=Math.max(Math.max(n,t),i),r=u-f,e;return r===0?[null,0,u]:(e=n===f?3+(i-t)/r:t===f?5+(n-i)/r:1+(t-n)/r,[e===6?0:e,r/u,u])}function w(n,t,i){if(n===null)return[i,i,i];var f=Math.floor(n),e=f%2?n-f:1-(n-f),r=i*(1-t),u=i*(1-t*e);switch(f){case 6:case 0:return[i,u,r];case 1:return[u,i,r];case 2:return[r,i,u];case 3:return[r,u,i];case 4:return[u,r,i];case 5:return[i,r,u]}}function it(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function rt(t,r){function p(){var n=i.pickerInsetColor.split(/\s+/),t=n.length<2?n[0]:n[1]+" "+n[0]+" "+n[0]+" "+n[1];s.btn.style.borderColor=t}var c,a,h,s,v,y;if(!jscolor.picker){for(jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(i.pickerCloseText)},c=0,a=4;c<jscolor.images.sld[1];c+=a)h=document.createElement("div"),h.style.height=a+"px",h.style.fontSize="1px",h.style.lineHeight="0",jscolor.picker.sld.appendChild(h);jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box)}s=jscolor.picker;s.box.onmouseup=s.box.onmouseout=function(){mxClient.IS_TOUCH||n.focus()};s.box.onmousedown=function(){ft=!0};s.box.onmousemove=function(n){(e||o)&&(e&&g(n),o&&nt(n),document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l())};s.padM.onmouseup=s.padM.onmouseout=function(){e&&(e=!1,jscolor.fireEvent(u,"change"))};s.padM.onmousedown=function(n){switch(f){case 0:i.hsv[2]===0&&i.fromHSV(null,null,1);break;case 1:i.hsv[1]===0&&i.fromHSV(null,1,null)}e=!0;g(n);l()};s.sldM.onmouseup=s.sldM.onmouseout=function(){o&&(o=!1,jscolor.fireEvent(u,"change"))};s.sldM.onmousedown=function(n){o=!0;nt(n);l()};v=b(i);s.box.style.width=v[0]+"px";s.box.style.height=v[1]+"px";s.boxB.style.position="absolute";s.boxB.style.clear="both";s.boxB.style.left=t+"px";s.boxB.style.top=r+"px";s.boxB.style.zIndex=i.pickerZIndex;s.boxB.style.border=i.pickerBorder+"px solid";s.boxB.style.borderColor=i.pickerBorderColor;s.boxB.style.background=i.pickerFaceColor;s.pad.style.width=jscolor.images.pad[0]+"px";s.pad.style.height=jscolor.images.pad[1]+"px";s.padB.style.position="absolute";s.padB.style.left=i.pickerFace+"px";s.padB.style.top=i.pickerFace+"px";s.padB.style.border=i.pickerInset+"px solid";s.padB.style.borderColor=i.pickerInsetColor;s.padM.style.position="absolute";s.padM.style.left="0";s.padM.style.top="0";s.padM.style.width=i.pickerFace+2*i.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";s.padM.style.height=s.box.style.height;s.padM.style.cursor="crosshair";s.sld.style.overflow="hidden";s.sld.style.width=jscolor.images.sld[0]+"px";s.sld.style.height=jscolor.images.sld[1]+"px";s.sldB.style.display=i.slider?"block":"none";s.sldB.style.position="absolute";s.sldB.style.right=i.pickerFace+"px";s.sldB.style.top=i.pickerFace+"px";s.sldB.style.border=i.pickerInset+"px solid";s.sldB.style.borderColor=i.pickerInsetColor;s.sldM.style.display=i.slider?"block":"none";s.sldM.style.position="absolute";s.sldM.style.right="0";s.sldM.style.top="0";s.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+i.pickerFace+2*i.pickerInset+"px";s.sldM.style.height=s.box.style.height;try{s.sldM.style.cursor="pointer"}catch(w){s.sldM.style.cursor="hand"}s.btn.style.display=i.pickerClosable?"block":"none";s.btn.style.position="absolute";s.btn.style.left=i.pickerFace+"px";s.btn.style.bottom=i.pickerFace+"px";s.btn.style.padding="0 15px";s.btn.style.height="18px";s.btn.style.border=i.pickerInset+"px solid";p();s.btn.style.color=i.pickerButtonColor;s.btn.style.font="12px sans-serif";s.btn.style.textAlign="center";try{s.btn.style.cursor="pointer"}catch(w){s.btn.style.cursor="hand"}s.btn.onmousedown=function(){i.hidePicker()};s.btnS.style.lineHeight=s.btn.style.height;switch(f){case 0:y="hs.png";break;case 1:y="hv.png"}s.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')";s.padM.style.backgroundRepeat="no-repeat";s.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')";s.sldM.style.backgroundRepeat="no-repeat";s.pad.style.backgroundImage="url('"+jscolor.getDir()+y+"')";s.pad.style.backgroundRepeat="no-repeat";s.pad.style.backgroundPosition="0 0";k();d();jscolor.picker.owner=i;document.getElementsByTagName("body")[0].appendChild(s.boxB)}function b(n){return[2*n.pickerInset+2*n.pickerFace+jscolor.images.pad[0]+(n.slider?2*n.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),n.pickerClosable?4*n.pickerInset+3*n.pickerFace+jscolor.images.pad[1]+n.pickerButtonHeight:2*n.pickerInset+2*n.pickerFace+jscolor.images.pad[1]]}function k(){var e,s,h,r,t,n;switch(f){case 0:e=1;break;case 1:e=2}s=Math.round(i.hsv[0]/6*(jscolor.images.pad[0]-1));h=Math.round((1-i.hsv[e])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=i.pickerFace+i.pickerInset+s-Math.floor(jscolor.images.cross[0]/2)+"px "+(i.pickerFace+i.pickerInset+h-Math.floor(jscolor.images.cross[1]/2))+"px";r=jscolor.picker.sld.childNodes;switch(f){case 0:for(t=w(i.hsv[0],i.hsv[1],1),n=0;n<r.length;n+=1)r[n].style.backgroundColor="rgb("+t[0]*(1-n/r.length)*100+"%,"+t[1]*(1-n/r.length)*100+"%,"+t[2]*(1-n/r.length)*100+"%)";break;case 1:var t,o,u=[i.hsv[2],0,0],n=Math.floor(i.hsv[0]),c=n%2?i.hsv[0]-n:1-(i.hsv[0]-n);switch(n){case 6:case 0:t=[0,1,2];break;case 1:t=[1,0,2];break;case 2:t=[2,0,1];break;case 3:t=[2,1,0];break;case 4:t=[1,2,0];break;case 5:t=[0,2,1]}for(n=0;n<r.length;n+=1)o=1-1/(r.length-1)*n,u[1]=u[0]*(1-o*c),u[2]=u[0]*(1-o),r[n].style.backgroundColor="rgb("+u[t[0]]*100+"%,"+u[t[1]]*100+"%,"+u[t[2]]*100+"%)"}}function d(){var n,t;switch(f){case 0:n=2;break;case 1:n=1}t=Math.round((1-i.hsv[n])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(i.pickerFace+i.pickerInset+t-Math.floor(jscolor.images.arrow[1]/2))+"px"}function c(){return jscolor.picker&&jscolor.picker.owner===i}function ut(){u!==n&&i.importColor()}function g(n){var t=jscolor.getRelMousePos(n),r=t.x-i.pickerFace-i.pickerInset,u=t.y-i.pickerFace-i.pickerInset;switch(f){case 0:i.fromHSV(r*(6/(jscolor.images.pad[0]-1)),1-u/(jscolor.images.pad[1]-1),null,y);break;case 1:i.fromHSV(r*(6/(jscolor.images.pad[0]-1)),null,1-u/(jscolor.images.pad[1]-1),y)}}function nt(n){var r=jscolor.getRelMousePos(n),t=r.y-i.pickerFace-i.pickerInset;switch(f){case 0:i.fromHSV(null,null,1-t/(jscolor.images.sld[1]-1),v);break;case 1:i.fromHSV(null,1-t/(jscolor.images.sld[1]-1),null,v)}}function l(){if(i.onImmediateChange)if(typeof i.onImmediateChange=="string")eval(i.onImmediateChange);else i.onImmediateChange(i)}var h,p;this.required=!0;this.adjust=!0;this.hash=!1;this.caps=!0;this.slider=!0;this.valueElement=n;this.styleElement=n;this.onImmediateChange=null;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=!0;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerSmartPosition=!0;this.pickerButtonHeight=20;this.pickerClosable=!1;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=0;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=1e4;for(h in t)t.hasOwnProperty(h)&&(this[h]=t[h]);this.hidePicker=function(){c()&&it()};this.showPicker=function(){var r,l;if(!c()){var u=jscolor.getElementPos(n),f=jscolor.getElementSize(n),s=jscolor.getViewPos(),h=jscolor.getViewSize(),o=b(this),i,t,e;switch(this.pickerPosition.toLowerCase()){case"left":i=1;t=0;e=-1;break;case"right":i=1;t=0;e=1;break;case"top":i=0;t=1;e=-1;break;default:i=0;t=1;e=1}r=(f[t]+o[t])/2;l=this.pickerSmartPosition?[-s[i]+u[i]+o[i]>h[i]?-s[i]+u[i]+f[i]/2>h[i]/2&&u[i]+f[i]-o[i]>=0?u[i]+f[i]-o[i]:u[i]:u[i],-s[t]+u[t]+f[t]+o[t]-r+r*e>h[t]?-s[t]+u[t]+f[t]/2>h[t]/2&&u[t]+f[t]-r-r*e>=0?u[t]+f[t]-r-r*e:u[t]+f[t]-r+r*e:u[t]+f[t]-r+r*e>=0?u[t]+f[t]-r+r*e:u[t]+f[t]-r-r*e]:[u[i],u[t]+f[t]-r+r*e];rt(0,0)}};this.importColor=function(){u?this.adjust?!this.required&&/^\s*$/.test(u.value)?(u.value="",r.style.backgroundImage=r.jscStyle.backgroundImage,r.style.backgroundColor=r.jscStyle.backgroundColor,r.style.color=r.jscStyle.color,this.exportColor(s|a)):this.fromString(u.value)||this.exportColor():this.fromString(u.value,s)||(r.style.backgroundImage=r.jscStyle.backgroundImage,r.style.backgroundColor=r.jscStyle.backgroundColor,r.style.color=r.jscStyle.color,this.exportColor(s|a)):this.exportColor()};this.exportColor=function(n){if(!(n&s)&&u){var t=this.toString();this.caps&&(t=t.toUpperCase());this.hash&&(t="#"+t);u.value=t}n&a||!r||(r.style.backgroundImage="none",r.style.backgroundColor="#"+this.toString(),r.style.color=.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]<.5?"#FFF":"#000");n&v||!c()||k();n&y||!c()||d()};this.fromHSV=function(n,t,i,r){n<0&&(n=0)||n>6&&(n=6);t<0&&(t=0)||t>1&&(t=1);i<0&&(i=0)||i>1&&(i=1);this.rgb=w(n===null?this.hsv[0]:this.hsv[0]=n,t===null?this.hsv[1]:this.hsv[1]=t,i===null?this.hsv[2]:this.hsv[2]=i);this.exportColor(r)};this.fromRGB=function(n,t,i,r){n<0&&(n=0)||n>1&&(n=1);t<0&&(t=0)||t>1&&(t=1);i<0&&(i=0)||i>1&&(i=1);var u=tt(n===null?this.rgb[0]:this.rgb[0]=n,t===null?this.rgb[1]:this.rgb[1]=t,i===null?this.rgb[2]:this.rgb[2]=i);u[0]!==null&&(this.hsv[0]=u[0]);u[2]!==0&&(this.hsv[1]=u[1]);this.hsv[2]=u[2];this.exportColor(r)};this.fromString=function(n,t){var i=n.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);return i?(i[1].length===6?this.fromRGB(parseInt(i[1].substr(0,2),16)/255,parseInt(i[1].substr(2,2),16)/255,parseInt(i[1].substr(4,2),16)/255,t):this.fromRGB(parseInt(i[1].charAt(0)+i[1].charAt(0),16)/255,parseInt(i[1].charAt(1)+i[1].charAt(1),16)/255,parseInt(i[1].charAt(2)+i[1].charAt(2),16)/255,t),!0):!1};this.toString=function(){return(256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1)};var i=this,f=this.pickerMode.toLowerCase()==="hvs"?1:0,ft=!1,u=jscolor.fetchElement(this.valueElement),r=jscolor.fetchElement(this.styleElement),e=!1,o=!1,s=1,a=2,v=4,y=8;u&&(p=function(){i.fromString(u.value,s);l()},jscolor.addEvent(u,"keyup",p),jscolor.addEvent(u,"input",p),jscolor.addEvent(u,"blur",ut),u.setAttribute("autocomplete","off"));r&&(r.jscStyle={backgroundImage:r.style.backgroundImage,backgroundColor:r.style.backgroundColor,color:r.style.color});switch(f){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png")}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install(),function(){var f=void 0,u=!0,t=null,r=!1,n=["aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,snow,springgreen,steelblue,tan,teal,thistle,tomato,transparent,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen".split(","),"all-scroll,col-resize,crosshair,default,e-resize,hand,help,move,n-resize,ne-resize,no-drop,not-allowed,nw-resize,pointer,progress,row-resize,s-resize,se-resize,sw-resize,text,vertical-text,w-resize,wait".split(","),"armenian,decimal,decimal-leading-zero,disc,georgian,lower-alpha,lower-greek,lower-latin,lower-roman,square,upper-alpha,upper-latin,upper-roman".split(","),"100,200,300,400,500,600,700,800,900,bold,bolder,lighter".split(","),"block-level,inline-level,table-caption,table-cell,table-column,table-column-group,table-footer-group,table-header-group,table-row,table-row-group".split(","),"condensed,expanded,extra-condensed,extra-expanded,narrower,semi-condensed,semi-expanded,ultra-condensed,ultra-expanded,wider".split(","),"inherit,inline,inline-block,inline-box,inline-flex,inline-grid,inline-list-item,inline-stack,inline-table,run-in".split(","),"behind,center-left,center-right,far-left,far-right,left-side,leftwards,right-side,rightwards".split(","),"large,larger,small,smaller,x-large,x-small,xx-large,xx-small".split(","),"dashed,dotted,double,groove,outset,ridge,solid".split(","),"ease,ease-in,ease-in-out,ease-out,linear,step-end,step-start".split(","),"at,closest-corner,closest-side,ellipse,farthest-corner,farthest-side".split(","),"baseline,middle,sub,super,text-bottom,text-top".split(","),"caption,icon,menu,message-box,small-caption,status-bar".split(","),"fast,faster,slow,slower,x-fast,x-slow".split(","),["above","below","higher","level","lower"],["cursive","fantasy","monospace","sans-serif","serif"],["loud","silent","soft","x-loud","x-soft"],["no-repeat","repeat-x","repeat-y","round","space"],["blink","line-through","overline","underline"],["block","flex","grid","table"],["high","low","x-high","x-low"],["nowrap","pre","pre-line","pre-wrap"],["absolute","relative","static"],["alternate","alternate-reverse","reverse"],["border-box","content-box","padding-box"],["capitalize","lowercase","uppercase"],["child","female","male"],["=","opacity"],["backwards","forwards"],["bidi-override","embed"],["bottom","top"],["break-all","keep-all"],["clip","ellipsis"],["contain","cover"],["continuous","digits"],["end","start"],["flat","preserve-3d"],["hide","show"],["horizontal","vertical"],["inside","outside"],["italic","oblique"],["left","right"],["ltr","rtl"],["no-content","no-display"],["paused","running"],["suppress","unrestricted"],["thick","thin"],[","],["/"],["all"],["always"],["auto"],["avoid"],["both"],["break-word"],["center"],["circle"],["code"],["collapse"],["contents"],["fixed"],["hidden"],["infinite"],["inset"],["invert"],["justify"],["list-item"],["local"],["medium"],["mix"],["none"],["normal"],["once"],["repeat"],["scroll"],["separate"],["small-caps"],["spell-out"],["to"],["visible"]],e={animation:{cssPropBits:517,cssLitGroup:[n[10],n[24],n[29],n[45],n[48],n[54],n[63],n[71],n[72]],cssFns:["cubic-bezier()","steps()"]},"animation-delay":{cssPropBits:5,cssLitGroup:[n[48]],cssFns:[]},"animation-direction":{cssPropBits:0,cssLitGroup:[n[24],n[48],n[72]],cssFns:[]},"animation-duration":"animation-delay","animation-fill-mode":{cssPropBits:0,cssLitGroup:[n[29],n[48],n[54],n[71]],cssFns:[]},"animation-iteration-count":{cssPropBits:5,cssLitGroup:[n[48],n[63]],cssFns:[]},"animation-name":{cssPropBits:512,cssLitGroup:[n[48],n[71]],cssFns:[]},"animation-play-state":{cssPropBits:0,cssLitGroup:[n[45],n[48]],cssFns:[]},"animation-timing-function":{cssPropBits:0,cssLitGroup:[n[10],n[48]],cssFns:["cubic-bezier()","steps()"]},appearance:{cssPropBits:0,cssLitGroup:[n[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[n[7],n[42],n[56]],cssFns:[]},"backface-visibility":{cssPropBits:0,cssLitGroup:[n[59],n[62],n[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[n[0],n[18],n[25],n[31],n[34],n[42],n[48],n[49],n[52],n[56],n[61],n[68],n[71],n[74],n[75]],cssFns:"image(),linear-gradient(),radial-gradient(),repeating-linear-gradient(),repeating-radial-gradient(),rgb(),rgba()".split(",")},"background-attachment":{cssPropBits:0,cssLitGroup:[n[48],n[61],n[68],n[75]],cssFns:[]},"background-color":{cssPropBits:2,cssLitGroup:[n[0]],cssFns:["rgb()","rgba()"]},"background-image":{cssPropBits:16,cssLitGroup:[n[48],n[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"background-position":{cssPropBits:5,cssLitGroup:[n[31],n[42],n[48],n[56]],cssFns:[]},"background-repeat":{cssPropBits:0,cssLitGroup:[n[18],n[48],n[74]],cssFns:[]},"background-size":{cssPropBits:5,cssLitGroup:[n[34],n[48],n[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[n[0],n[9],n[47],n[62],n[64],n[69],n[71]],cssFns:["rgb()","rgba()"]},"border-bottom":"border","border-bottom-color":"background-color","border-bottom-left-radius":{cssPropBits:5,cssFns:[]},"border-bottom-right-radius":"border-bottom-left-radius","border-bottom-style":{cssPropBits:0,cssLitGroup:[n[9],n[62],n[64],n[71]],cssFns:[]},"border-bottom-width":{cssPropBits:5,cssLitGroup:[n[47],n[69]],cssFns:[]},"border-collapse":{cssPropBits:0,cssLitGroup:[n[59],n[76]],cssFns:[]},"border-color":"background-color","border-left":"border","border-left-color":"background-color","border-left-style":"border-bottom-style","border-left-width":"border-bottom-width","border-radius":{cssPropBits:5,cssLitGroup:[n[49]],cssFns:[]},"border-right":"border","border-right-color":"background-color","border-right-style":"border-bottom-style","border-right-width":"border-bottom-width","border-spacing":"border-bottom-left-radius","border-style":"border-bottom-style","border-top":"border","border-top-color":"background-color","border-top-left-radius":"border-bottom-left-radius","border-top-right-radius":"border-bottom-left-radius","border-top-style":"border-bottom-style","border-top-width":"border-bottom-width","border-width":"border-bottom-width",bottom:{cssPropBits:5,cssLitGroup:[n[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[n[60],n[71],n[72]],cssFns:[]},"box-shadow":{cssPropBits:7,cssLitGroup:[n[0],n[48],n[64],n[71]],cssFns:["rgb()","rgba()"]},"box-sizing":{cssPropBits:0,cssLitGroup:[n[25]],cssFns:[]},"caption-side":{cssPropBits:0,cssLitGroup:[n[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[n[42],n[54],n[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[n[52]],cssFns:["rect()"]},color:"background-color",content:{cssPropBits:8,cssLitGroup:[n[71],n[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[n[71]],cssFns:[]},"cue-after":"cue","cue-before":"cue",cursor:{cssPropBits:16,cssLitGroup:[n[1],n[48],n[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[n[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[n[4],n[6],n[20],n[52],n[67],n[71]],cssFns:[]},"display-extras":{cssPropBits:0,cssLitGroup:[n[67],n[71]],cssFns:[]},"display-inside":{cssPropBits:0,cssLitGroup:[n[20],n[52]],cssFns:[]},"display-outside":{cssPropBits:0,cssLitGroup:[n[4],n[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[n[15]],cssFns:[]},"empty-cells":{cssPropBits:0,cssLitGroup:[n[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:["alpha()"]},float:{cssPropBits:0,cssLitGroup:[n[42],n[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[n[3],n[8],n[13],n[16],n[41],n[48],n[49],n[69],n[72],n[77]],cssFns:[]},"font-family":{cssPropBits:72,cssLitGroup:[n[16],n[48]],cssFns:[]},"font-size":{cssPropBits:1,cssLitGroup:[n[8],n[69]],cssFns:[]},"font-stretch":{cssPropBits:0,cssLitGroup:[n[5],n[72]],cssFns:[]},"font-style":{cssPropBits:0,cssLitGroup:[n[41],n[72]],cssFns:[]},"font-variant":{cssPropBits:0,cssLitGroup:[n[72],n[77]],cssFns:[]},"font-weight":{cssPropBits:0,cssLitGroup:[n[3],n[72]],cssFns:[]},height:"bottom",left:"bottom","letter-spacing":{cssPropBits:5,cssLitGroup:[n[72]],cssFns:[]},"line-height":{cssPropBits:1,cssLitGroup:[n[72]],cssFns:[]},"list-style":{cssPropBits:16,cssLitGroup:[n[2],n[40],n[57],n[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-image":{cssPropBits:16,cssLitGroup:[n[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-position":{cssPropBits:0,cssLitGroup:[n[40]],cssFns:[]},"list-style-type":{cssPropBits:0,cssLitGroup:[n[2],n[57],n[71]],cssFns:[]},margin:"bottom","margin-bottom":"bottom","margin-left":"bottom","margin-right":"bottom","margin-top":"bottom","max-height":{cssPropBits:1,cssLitGroup:[n[52],n[71]],cssFns:[]},"max-width":"max-height","min-height":{cssPropBits:1,cssLitGroup:[n[52]],cssFns:[]},"min-width":"min-height",opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[n[0],n[9],n[47],n[62],n[64],n[65],n[69],n[71]],cssFns:["rgb()","rgba()"]},"outline-color":{cssPropBits:2,cssLitGroup:[n[0],n[65]],cssFns:["rgb()","rgba()"]},"outline-style":"border-bottom-style","outline-width":"border-bottom-width",overflow:{cssPropBits:0,cssLitGroup:[n[52],n[62],n[75],n[80]],cssFns:[]},"overflow-wrap":{cssPropBits:0,cssLitGroup:[n[55],n[72]],cssFns:[]},"overflow-x":{cssPropBits:0,cssLitGroup:[n[44],n[52],n[62],n[75],n[80]],cssFns:[]},"overflow-y":"overflow-x",padding:"opacity","padding-bottom":"opacity","padding-left":"opacity","padding-right":"opacity","padding-top":"opacity","page-break-after":{cssPropBits:0,cssLitGroup:[n[42],n[51],n[52],n[53]],cssFns:[]},"page-break-before":"page-break-after","page-break-inside":{cssPropBits:0,cssLitGroup:[n[52],n[53]],cssFns:[]},pause:"border-bottom-left-radius","pause-after":"border-bottom-left-radius","pause-before":"border-bottom-left-radius",perspective:{cssPropBits:5,cssLitGroup:[n[71]],cssFns:[]},"perspective-origin":{cssPropBits:5,cssLitGroup:[n[31],n[42],n[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[n[21],n[69]],cssFns:[]},"pitch-range":"border-bottom-left-radius","play-during":{cssPropBits:16,cssLitGroup:[n[52],n[70],n[71],n[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[n[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[n[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[n[39],n[54],n[71]],cssFns:[]},richness:"border-bottom-left-radius",right:"bottom",speak:{cssPropBits:0,cssLitGroup:[n[71],n[72],n[78]],cssFns:[]},"speak-header":{cssPropBits:0,cssLitGroup:[n[51],n[73]],cssFns:[]},"speak-numeral":{cssPropBits:0,cssLitGroup:[n[35]],cssFns:[]},"speak-punctuation":{cssPropBits:0,cssLitGroup:[n[58],n[71]],cssFns:[]},"speech-rate":{cssPropBits:5,cssLitGroup:[n[14],n[69]],cssFns:[]},stress:"border-bottom-left-radius","table-layout":{cssPropBits:0,cssLitGroup:[n[52],n[61]],cssFns:[]},"text-align":{cssPropBits:0,cssLitGroup:[n[42],n[56],n[66]],cssFns:[]},"text-decoration":{cssPropBits:0,cssLitGroup:[n[19],n[71]],cssFns:[]},"text-indent":"border-bottom-left-radius","text-overflow":{cssPropBits:8,cssLitGroup:[n[33]],cssFns:[]},"text-shadow":"box-shadow","text-transform":{cssPropBits:0,cssLitGroup:[n[26],n[71]],cssFns:[]},"text-wrap":{cssPropBits:0,cssLitGroup:[n[46],n[71],n[72]],cssFns:[]},top:"bottom",transform:{cssPropBits:0,cssLitGroup:[n[71]],cssFns:"matrix(),perspective(),rotate(),rotate3d(),rotatex(),rotatey(),rotatez(),scale(),scale3d(),scalex(),scaley(),scalez(),skew(),skewx(),skewy(),translate(),translate3d(),translatex(),translatey(),translatez()".split(",")},"transform-origin":"perspective-origin","transform-style":{cssPropBits:0,cssLitGroup:[n[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[n[10],n[48],n[50],n[71]],cssFns:["cubic-bezier()","steps()"]},"transition-delay":"animation-delay","transition-duration":"animation-delay","transition-property":{cssPropBits:1024,cssLitGroup:[n[48],n[50]],cssFns:[]},"transition-timing-function":"animation-timing-function","unicode-bidi":{cssPropBits:0,cssLitGroup:[n[30],n[72]],cssFns:[]},"vertical-align":{cssPropBits:5,cssLitGroup:[n[12],n[31]],cssFns:[]},visibility:"backface-visibility","voice-family":{cssPropBits:8,cssLitGroup:[n[27],n[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[n[17],n[69]],cssFns:[]},"white-space":{cssPropBits:0,cssLitGroup:[n[22],n[72]],cssFns:[]},width:"min-height","word-break":{cssPropBits:0,cssLitGroup:[n[32],n[72]],cssFns:[]},"word-spacing":"letter-spacing","word-wrap":"overflow-wrap","z-index":"bottom",zoom:"line-height","cubic-bezier()":"animation-delay","steps()":{cssPropBits:5,cssLitGroup:[n[36],n[48]],cssFns:[]},"image()":{cssPropBits:18,cssLitGroup:[n[0],n[48]],cssFns:["rgb()","rgba()"]},"linear-gradient()":{cssPropBits:7,cssLitGroup:[n[0],n[31],n[42],n[48],n[79]],cssFns:["rgb()","rgba()"]},"radial-gradient()":{cssPropBits:7,cssLitGroup:[n[0],n[11],n[31],n[42],n[48],n[56],n[57]],cssFns:["rgb()","rgba()"]},"repeating-linear-gradient()":"linear-gradient()","repeating-radial-gradient()":"radial-gradient()","rgb()":{cssPropBits:1,cssLitGroup:[n[48]],cssFns:[]},"rgba()":"rgb()","rect()":{cssPropBits:5,cssLitGroup:[n[48],n[52]],cssFns:[]},"alpha()":{cssPropBits:1,cssLitGroup:[n[28]],cssFns:[]},"matrix()":"animation-delay","perspective()":"border-bottom-left-radius","rotate()":"border-bottom-left-radius","rotate3d()":"animation-delay","rotatex()":"border-bottom-left-radius","rotatey()":"border-bottom-left-radius","rotatez()":"border-bottom-left-radius","scale()":"animation-delay","scale3d()":"animation-delay","scalex()":"border-bottom-left-radius","scaley()":"border-bottom-left-radius","scalez()":"border-bottom-left-radius","skew()":"animation-delay","skewx()":"border-bottom-left-radius","skewy()":"border-bottom-left-radius","translate()":"animation-delay","translate3d()":"animation-delay","translatex()":"border-bottom-left-radius","translatey()":"border-bottom-left-radius","translatez()":"border-bottom-left-radius"},o,s,h,c,y,b,i,p,k;for(o in e)"string"==typeof e[o]&&Object.hasOwnProperty.call(e,o)&&(e[o]=e[e[o]]);"undefined"!=typeof window&&(window.cssSchema=e),function(){function r(n){var t=parseInt(n.substring(1),16);return 65535<t?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(t&1023))):t==t?String.fromCharCode(t):" ">n[1]?"":n[1]}function n(n,t){return'"'+n.replace(/[\u0000-\u001f\\\"<>]/g,t)+'"'}function u(n){return t[n]||(t[n]="\\"+n.charCodeAt(0).toString(16)+" ")}function f(n){return i[n]||(i[n]=("\x10">n?"%0":"%")+n.charCodeAt(0).toString(16))}var t={"\\":"\\\\"},i={"\\":"%5c"},e=RegExp("\\uFEFF|U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?|url[(][\\t\\n\\f ]*(?:\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)[\\t\\n\\f ]*[)]|(?!url[(])-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*[(]|(?:@?-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))|#)(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*|\"(?:'|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*\"|'(?:\"|[^'\"\\n\\f\\\\]|\\\\[\\s\\S])*'|[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)(?:%|-?(?:[a-zA-Z_]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))(?:[a-zA-Z0-9_-]|[\\u0080-\\ud7ff\\ue000-\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]|\\\\(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff]))*)?|<!--|-->|[\\t\\n\\f ]+|/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)|[~|^$*]=|[^\"'\\\\/]|/(?![/*])","gi"),o=RegExp("\\\\(?:(?:[0-9a-fA-F]{1,6}[\\t\\n\\f ]?|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|[\\ud800-\\udbff][\\udc00-\\udfff])|[\\n\\f])","g"),c=RegExp("^url\\([\\t\\n\\f ]*[\"']?|[\"']?[\\t\\n\\f ]*\\)$","gi");h=function(n){return n.replace(o,r)};s=function(t){for(var t=(""+t).replace(/\r\n?/g,"\n").match(e)||[],s=0,l=" ",o=0,v=t.length;o<v;++o){var i=h(t[o]),a=i.length,r=i.charCodeAt(0),i=34==r||39==r?n(i.substring(1,a-1),u):47==r&&1<a||"\\"==i||"-->"==i||"<!--"==i||"﻿"==i||32>=r?" ":/url\(/i.test(i)?"url("+n(i.replace(c,""),f)+")":i;(l!=i||" "!=i)&&(t[s++]=l=i)}return t.length=s,t}}();"undefined"!=typeof window&&(window.lexCss=s,window.decodeCss=h);c=function(){function u(r){return r=(""+r).match(l),r?new n(i(r[1]),i(r[2]),i(r[3]),i(r[4]),i(r[5]),i(r[6]),i(r[7])):t}function e(n,i){return"string"==typeof n?encodeURI(n).replace(i,o):t}function o(n){return n=n.charCodeAt(0),"%"+"0123456789ABCDEF".charAt(n>>4&15)+"0123456789ABCDEF".charAt(n&15)}function r(n){if(n===t)return t;for(var n=n.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/"),r=c,i;(i=n.replace(r,"$1"))!=n;n=i);return n}function s(n,t){var e=n.T(),i=t.K(),o,u;if(i?e.ga(t.j):i=t.X(),i?e.da(t.n):i=t.Y(),i?e.ea(t.k):i=t.$(),o=t.g,u=r(o),i)e.ca(t.V()),u=u&&u.replace(f,"");else if(i=!!o){if(47!==u.charCodeAt(0))var u=r(e.g||"").replace(f,""),s=u.lastIndexOf("/")+1,u=r((s?u.substring(0,s):"")+r(o)).replace(f,"")}else u=u&&u.replace(f,""),u!==o&&e.G(u);return i?e.G(u):i=t.aa(),i?e.O(t.l):i=t.Z(),i&&e.fa(t.o),e}function n(n,t,i,r,u,f,e){this.j=n;this.n=t;this.k=i;this.h=r;this.g=u;this.l=f;this.o=e}function i(n){return"string"==typeof n&&0<n.length?n:t}var c=RegExp(/(\/|^)(?:[^./][^/]*|\.{2,}(?:[^./][^/]*)|\.{3,}[^/]*)\/\.\.(?:\/|$)/),f=/^(?:\.\.\/)*(?:\.\.$)?/;n.prototype.toString=function(){var n=[];return t!==this.j&&n.push(this.j,":"),t!==this.k&&(n.push("//"),t!==this.n&&n.push(this.n,"@"),n.push(this.k),t!==this.h&&n.push(":",this.h.toString())),t!==this.g&&n.push(this.g),t!==this.l&&n.push("?",this.l),t!==this.o&&n.push("#",this.o),n.join("")};n.prototype.T=function(){return new n(this.j,this.n,this.k,this.h,this.g,this.l,this.o)};n.prototype.W=function(){return this.j&&decodeURIComponent(this.j).toLowerCase()};n.prototype.ga=function(n){this.j=n?n:t};n.prototype.K=function(){return t!==this.j};n.prototype.da=function(n){this.n=n?n:t};n.prototype.X=function(){return t!==this.n};n.prototype.ea=function(n){this.k=n?n:t;this.G(this.g)};n.prototype.Y=function(){return t!==this.k};n.prototype.V=function(){return this.h&&decodeURIComponent(this.h)};n.prototype.ca=function(n){if(n){if(n=Number(n),n!==(n&65535))throw Error("Bad port number "+n);this.h=""+n}else this.h=t};n.prototype.$=function(){return t!==this.h};n.prototype.U=function(){return this.g&&decodeURIComponent(this.g)};n.prototype.G=function(n){n?(n=""+n,this.g=!this.k||/^\//.test(n)?n:"/"+n):this.g=t};n.prototype.O=function(n){this.l=n?n:t};n.prototype.aa=function(){return t!==this.l};n.prototype.ba=function(n){var t,r,u,i;if("object"==typeof n&&!(n instanceof Array)&&(n instanceof Object||"[object Array]"!==Object.prototype.toString.call(n))){t=[];r=-1;for(u in n)i=n[u],"string"==typeof i&&(t[++r]=u,t[++r]=i);n=t}for(var t=[],r="",f=0;f<n.length;)u=n[f++],i=n[f++],t.push(r,encodeURIComponent(u.toString())),r="&",i&&t.push("=",encodeURIComponent(i.toString()));this.l=t.join("")};n.prototype.fa=function(n){this.o=n?n:t};n.prototype.Z=function(){return t!==this.o};var l=/^(?:([^:/?#]+):)?(?:\/\/(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,h=/[#\/\?@]/g,a=/[\#\?]/g;return n.parse=u,n.create=function(i,r,u,f,s,c,l){return i=new n(e(i,h),e(r,h),"string"==typeof u?encodeURIComponent(u):t,0<f?f.toString():t,e(s,a),t,"string"==typeof l?encodeURIComponent(l):t),c&&("string"==typeof c?i.O(c.replace(/[^?&=0-9A-Za-z_\-~.%]/g,o)):i.ba(c)),i},n.N=s,n.ma=r,n.ha={ua:function(n){return/\.html$/.test(u(n).U())?"text/html":"application/javascript"},N:function(n,t){return n?s(u(n),u(t)).toString():""+t}},n}();"undefined"!=typeof window&&(window.URI=c);var a=f,v=f,w=f,l=f;(function(){function b(n){return"string"==typeof n?'url("'+n.replace(g,d)+'")':'url("about:blank")'}function d(n){return nt[n]}function o(n,t){return n?c.ha.N(n,t):t}function s(n,i,r){if(!r)return t;var u=(""+n).match(tt);return u&&(!u[1]||it.test(u[1]))?r(n,i):t}function p(n){return n.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,"")}var g=/[\n\f\r\"\'()*<>]/g,nt={"\n":"%0a","\f":"%0c","\r":"%0d",'"':"%22","'":"%27","(":"%28",")":"%29","*":"%2a","<":"%3c",">":"%3e"},tt=/^(?:([^:/?# ]+):)?/,it=/^(?:https?|mailto|data)$/i,k,n;a=function(){var n={};return function t(i,r,u,f,c){var i=p(i),g=e[i],l,y,ut,ot,it,st,a,ct,v,w,d,ht;if(g&&"object"==typeof g){for(var k=g.cssPropBits,ft=k&80,et=k&1536,rt=NaN,nt=0,tt=0;nt<r.length;++nt){if(l=r[nt].toLowerCase(),y=l.charCodeAt(0),32===y)l="";else if(34===y)l=16===ft?u?b(s(o(f,h(r[nt].substring(1,l.length-1))),i,u)):"":k&8&&!(ft&ft-1)?l:"";else if("inherit"!==l){if(a=g.cssLitGroup){if(!(v=g.cssLitMap)){for(v={},w=a.length;0<=--w;)for(d=a[w],ht=d.length;0<=--ht;)v[d[ht]]=n;v=g.cssLitMap=v}a=v}else a=n;if(!(ct=a,ct[p(l)]===n))if(35===y&&/^#(?:[0-9a-f]{3}){1,2}$/.test(l))l=k&2?l:"";else if(48<=y&&57>=y)l=k&1?l:"";else if(ut=l.charCodeAt(1),ot=l.charCodeAt(2),it=48<=ut&&57>=ut,st=48<=ot&&57>=ot,43===y&&(it||46===ut&&st))l=k&1?(it?"":"0")+l.substring(1):"";else if(45===y&&(it||46===ut&&st))l=k&4?(it?"-":"-0")+l.substring(1):k&1?"0":"";else if(46===y&&it)l=k&1?"0"+l:"";else if('url("'===l.substring(0,5))l=u&&k&16?b(s(o(f,r[nt].substring(5,l.length-2)),i,u)):"";else if("("===l.charAt(l.length-1))n:{for(a=r,v=nt,l=1,w=v+1,y=a.length;w<y&&l;)d=a[w++],l+=")"===d?-1:/^[^"']*\($/.test(d);if(!l)for(l=a[v].toLowerCase(),y=p(l),a=a.splice(v,w-v,""),v=g.cssFns,w=0,d=v.length;w<d;++w)if(v[w].substring(0,y.length)==y){a[0]=a[a.length-1]="";t(v[w],a,u,f);l=l+a.join(" ")+")";break n}l=""}else l=et&&/^-?[a-z_][\w\-]*$/.test(l)&&!/__$/.test(l)?c&&512===et?r[nt]+c:1024===et&&e[l]&&"number"==typeof e[l].oa?l:"":/^\w+$/.test(l)&&64===ft&&k&8?rt+1===tt?(r[rt]=r[rt].substring(0,r[rt].length-1)+" "+l+'"',""):(rt=tt,'"'+l+'"'):""}l&&(r[tt++]=l)}1===tt&&'url("about:blank")'===r[0]&&(tt=0);r.length=tt}else r.length=0}}();k=RegExp("^(active|after|before|blank|checked|default|disabled|drop|empty|enabled|first|first-child|first-letter|first-line|first-of-type|fullscreen|focus|hover|in-range|indeterminate|invalid|last-child|last-of-type|left|link|only-child|only-of-type|optional|out-of-range|placeholder-shown|read-only|read-write|required|right|root|scope|user-error|valid|visited)$");n={};n[">"]=n["+"]=n["~"]=n;v=function(f,e,o){function a(s,h){function g(n,t,o){var v,a,g,nt,s,h=u,c,p,l,b;for(v="",n<t&&((s=f[n],"*"===s)?(++n,v=s):/^[a-zA-Z]/.test(s)&&(a=w(s.toLowerCase(),[]))&&("tagName"in a&&(s=a.tagName),++n,v=s)),nt=g=a="";h&&n<t;++n)if(s=f[n],"#"===s.charAt(0))/^#_|__$|[^\w#:\-]/.test(s)?h=r:a+=s+y;else if("."===s)++n<t&&/^[0-9A-Za-z:_\-]+$/.test(s=f[n])&&!/^_|__$/.test(s)?a+="."+s:h=r;else if(n+1<t&&"["===f[n]){++n;c=f[n++].toLowerCase();s=i.m[v+"::"+c];s!==+s&&(s=i.m["*::"+c]);e.ia?(p=e.ia(v,c),"string"!=typeof p&&(h=r,p=c),h&&s!==+s&&(s=i.d.NONE)):(p=c,s!==+s&&(h=r));l=c="";b=r;/^[~^$*|]?=$/.test(f[n])&&(c=f[n++],l=f[n++],/^[0-9A-Za-z:_\-]+$/.test(l)?l='"'+l+'"':"]"===l&&(l='""',--n),/^"([^\"\\]|\\.)*"$/.test(l)||(h=r),(b="i"===f[n])&&++n);"]"!==f[n]&&(++n,h=r);switch(s){case i.d.CLASSES:case i.d.LOCAL_NAME:case i.d.NONE:break;case i.d.GLOBAL_NAME:case i.d.ID:case i.d.IDREF:("="===c||"~="===c||"$="===c)&&'""'!=l&&!b?l='"'+l.substring(1,l.length-1)+y+'"':"|="===c||""===c||(h=r);break;case i.d.URI:case i.d.URI_FRAGMENT:""!==c&&(h=r);break;default:h=r}h&&(g+="["+p.replace(/[^\w-]/g,"\\$&")+c+l+(b?" i]":"]"))}else if(n<t&&":"===f[n])if(s=f[++n],k.test(s))nt+=":"+s;else break;else break;return n!==t&&(h=r),h&&(n=(v+a).replace(/[^ .*#\w-]/g,"\\$&")+g+nt+o)&&d.push(n),h}var b;" "===f[s]&&++s;h-1!==s&&" "===f[h]&&--h;for(var d=[],c=s,a=u,l=s;a&&l<h;++l)b=f[l],(n[b]===n||" "===b)&&(g(c,l,b)?c=l+1:a=r);return g(c,h,"")||(a=r),a?(d.length&&(c=d.join(""),v!==t&&(c="."+v+" "+c),p.push(c)),u):!o||o(f.slice(s,h))}for(var v=e.na,y=e.L,w=e.Aa,p=[],c=0,h=0,l,s=0;s<f.length;++s)(l=f[s],"("==l||"["==l?(++h,!u):")"==l||"]"==l?(h&&--h,!u):" "==f[s]&&(h||n[f[s-1]]===n||n[f[s+1]]===n))||(f[c++]=f[s]);for(f.length=c,c=f.length,s=h=0;s<c;++s)if(","===f[s]){if(!a(h,s))return t;h=s+1}return a(h,c)?p:t},function(){var n=/^\w/,t=RegExp("^(?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*)(?: , (?:(?:(?:(?:only|not) )?(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)|\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))(?: and ?\\( (?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script) (?:: -?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)?)) )?\\))*))*$","i");l=function(i){for(var u,i=i.slice(),e=i.length,f=0,r=0;r<e;++r)u=i[r]," "!=u&&(i[f++]=u);return i.length=f,i=i.join(" "),i.length?t.test(i)?n.test(i)?i:"not all , "+i:"not all":""}}(),function(){function i(n){var i;return(i=/^\s*["]([^"]*)["]\s*$/.exec(n))||(i=/^\s*[']([^']*)[']\s*$/.exec(n))||(i=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/.exec(n))||(i=/^\s*url\s*[(][']([^']*)['][)]\s*$/.exec(n))||(i=/^\s*url\s*[(]([^)]*)[)]\s*$/.exec(n))?i[1]:t}function n(e,h,c,p,w,b,k){function it(){d=nt.length&&nt[nt.length-1]===t}var g=f,tt=k||[0],nt=[],d=r;return y(h,{startStylesheet:function(){g=[]},endStylesheet:function(){},startAtrule:function(r,u){var h,f,a,v;d?r=t:"@media"===r?g.push("@media"," ",l(u)):"@keyframes"===r||"@-webkit-keyframes"===r?(h=u[0],1===u.length&&!/__$|[^\w\-]/.test(h)?(g.push(r," ",h+c.L),r="@keyframes"):r=t):"@import"===r&&0<u.length&&((r=t,"function"==typeof b)?(f=l(u.slice(1)),"not all"!==f&&(++tt[0],a=[],g.push(a),v=s(o(e,i(u[0])),function(t){var i=n(v,t.qa,c,p,w,b,tt);--tt[0];t=f?{toString:function(){return"@media "+f+" {"+i.result+"}"}}:i.result;a[0]=t;b(t,!!tt[0])},w))):window.console&&window.console.log("@import "+u.join(" ")+" elided"));d=!r;nt.push(r)},endAtrule:function(){nt.pop();d||g.push(";");it()},startBlock:function(){d||g.push("{")},endBlock:function(){d||(g.push("}"),d=u)},startRuleset:function(n){if(!d){var i=f;"@keyframes"===nt[nt.length-1]?(i=n.join(" ").match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i),d=!i,i&&(i=i[0].replace(/ +/g,""))):(n=v(n,c),!n||!n.length?d=u:i=n.join(", "));d||g.push(i,"{")}nt.push(t)},endRuleset:function(){nt.pop();d||g.push("}");it()},declaration:function(n,t){if(!d){var f=r,i=t.length;2<=i&&"!"===t[i-2]&&"important"===t[i-1].toLowerCase()&&(f=u,t.length-=2);a(n,t,p,e,c.L);t.length&&g.push(n,":",t.join(" "),f?" !important;":";")}}}),{result:{toString:function(){return g.join("")}},va:!!tt[0]}}w=function(t,i,r,u){return n(t,i,r,u,f,f).result.toString()}}()})();"undefined"!=typeof window&&(window.sanitizeCssProperty=a,window.sanitizeCssSelectorList=v,window.sanitizeStylesheet=w,window.sanitizeMediaQuery=l),function(){function n(n,i,r,u,f){for(var f,e,o=i++;i<r&&"{"!==n[i]&&";"!==n[i];)++i;return i<r&&(f||";"===n[i])&&(f=o+1,e=i,f<r&&" "===n[f]&&++f,e>f&&" "===n[e-1]&&--e,u.startAtrule&&u.startAtrule(n[o].toLowerCase(),n.slice(f,e)),i="{"===n[i]?t(n,i,r,u):i+1,u.endAtrule&&u.endAtrule()),i}function t(u,f,e,o){for(++f,o.startBlock&&o.startBlock();f<e;){var s=u[f].charAt(0);if("}"==s){++f;break}f=" "===s||";"===s?f+1:"@"===s?n(u,f,e,o,r):"{"===s?t(u,f,e,o):i(u,f,e,o)}return o.endBlock&&o.endBlock(),f}function i(n,t,i,r){var h=t,e=f(n,t,i,u),s;if(0>e)return e=~e,e===h?e+1:e;if(s=n[e],"{"!==s)return e===h?e+1:e;for(t=e+1,e>h&&" "===n[e-1]&&--e,r.startRuleset&&r.startRuleset(n.slice(h,e));t<i;){if(s=n[t],"}"===s){++t;break}t=" "===s?t+1:o(n,t,i,r)}return r.endRuleset&&r.endRuleset(),t}function f(n,t,i,r){for(var u,e=[],f=-1;t<i;++t)if(u=n[t].charAt(0),"["===u||"("===u)e[++f]=u;else if("]"===u&&"["===e[f]||")"===u&&"("===e[f])--f;else if("{"===u||"}"===u||";"===u||"@"===u||":"===u&&!r)break;return 0<=f&&(t=~(t+1)),t}function e(n,t,i){for(;t<i&&";"!==n[t]&&"}"!==n[t];)++t;return t<i&&";"===n[t]?t+1:t}function o(n,t,i,u){var l=n[t++],o;if(!h.test(l)||(t<i&&" "===n[t]&&++t,t==i||":"!==n[t]))return e(n,t,i);if(++t,t<i&&" "===n[t]&&++t,o=f(n,t,i,r),0>o)o=~o;else{for(var a=[],s=0,c=t;c<o;++c)t=n[c]," "!==t&&(a[s++]=t);if(o<i){do{if(t=n[o],";"===t||"}"===t)break;s=0}while(++o<i);";"===t&&++o}s&&u.declaration&&u.declaration(l.toLowerCase(),a)}return o}y=function(t,r){var e=s(t),f,o;for(r.startStylesheet&&r.startStylesheet(),f=0,o=e.length;f<o;)f=" "===e[f]?f+1:f<o?"@"===e[f].charAt(0)?n(e,f,o,r,u):i(e,f,o,r):f;r.endStylesheet&&r.endStylesheet()};var h=/^-?[a-z]/i;b=function(n,t){for(var r=s(n),i=0,u=r.length;i<u;)i=" "!==r[i]?o(r,i,u,t):i+1}}();"undefined"!=typeof window&&(window.parseCssStylesheet=y,window.parseCssDeclarations=b);i={d:{NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13}};i.atype=i.d;i.m={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onerror":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::ontouchcancel":2,"*::ontouchend":2,"*::ontouchenter":2,"*::ontouchleave":2,"*::ontouchmove":2,"*::ontouchstart":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::tabindex":0,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"audio::src":1,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::pattern":0,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::src":1,"video::width":0};i.ATTRIBS=i.m;i.c={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};i.eflags=i.c;i.f={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2};i.ELEMENTS=i.f;i.Q={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"};i.ELEMENT_DOM_INTERFACES=i.Q;i.P={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};i.ueffects=i.P;i.J={"a::href":2,"area::href":2,"audio::src":1,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1,"video::src":1};i.URIEFFECTS=i.J;i.M={UNSANDBOXED:2,SANDBOXED:1,DATA:0};i.ltypes=i.M;i.I={"a::href":2,"area::href":2,"audio::src":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1,"video::src":2};i.LOADERTYPES=i.I;"undefined"!=typeof window&&(window.html4=i);p=function(n){function ct(n){if(l.hasOwnProperty(n))return l[n];var t=n.match(at);return t?String.fromCharCode(parseInt(t[1],10)):(t=n.match(vt))?String.fromCharCode(parseInt(t[1],16)):a&&yt.test(n)?(a.innerHTML="&"+n+";",t=a.textContent,l[n]=t):"&"+n+";"}function lt(n,t){return ct(t)}function y(n){return n.replace(wt,lt)}function p(n){return(""+n).replace(kt,"&amp;").replace(ot,"&lt;").replace(st,"&gt;").replace(gt,"&#34;")}function w(n){return n.replace(dt,"&amp;$1").replace(ot,"&lt;").replace(st,"&gt;")}function b(n){var i={z:n.z||n.cdata,A:n.A||n.comment,B:n.B||n.endDoc,t:n.t||n.endTag,e:n.e||n.pcdata,F:n.F||n.rcdata,H:n.H||n.startDoc,w:n.w||n.startTag};return function(n,u){var f,h=/(<\/|<\!--|<[!?]|[&<>])/g,e,s,o;if(f=n+"",ti)f=f.split(h);else{for(e=[],s=0;(o=h.exec(f))!==t;)e.push(f.substring(s,o.index)),e.push(o[0]),s=o.index+o[0].length;e.push(f.substring(s));f=e}k(i,f,0,{r:r,C:r},u)}}function e(n,t,i,r,u){return function(){k(n,t,i,r,u)}}function k(t,i,r,f,s){var y,h,p,c,nt,l,rt,ut;try{for(t.H&&0==r&&t.H(s),c=i.length;r<c;){nt=i[r++];l=i[r];switch(nt){case"&":bt.test(l)?(t.e&&t.e("&"+l,s,o,e(t,i,r,f,s)),r++):t.e&&t.e("&amp;",s,o,e(t,i,r,f,s));break;case"<\/":if(y=/^([-\w:]+)[^\'\"]*/.exec(l))if(y[0].length===l.length&&">"===i[r+1])r+=2,p=y[1].toLowerCase(),t.t&&t.t(p,s,o,e(t,i,r,f,s));else{var a=i,w=r,b=t,k=s,tt=o,et=f,it=g(a,w);it?(b.t&&b.t(it.name,k,tt,e(b,a,w,et,k)),r=it.next):r=a.length}else t.e&&t.e("&lt;/",s,o,e(t,i,r,f,s));break;case"<":if(y=/^([-\w:]+)\s*\/?/.exec(l))if(y[0].length===l.length&&">"===i[r+1])r+=2,p=y[1].toLowerCase(),t.w&&t.w(p,[],s,o,e(t,i,r,f,s)),rt=n.f[p],rt&ht&&(r=d(i,{name:p,next:r,c:rt},t,s,o,f));else{var a=i,w=t,b=s,k=o,tt=f,v=g(a,r);v?(w.w&&w.w(v.name,v.R,b,k,e(w,a,v.next,tt,b)),r=v.c&ht?d(a,v,w,b,k,tt):v.next):r=a.length}else t.e&&t.e("&lt;",s,o,e(t,i,r,f,s));break;case"<!--":if(!f.C){for(h=r+1;h<c&&!(">"===i[h]&&/--$/.test(i[h-1]));h++);h<c?(t.A&&(ut=i.slice(r,h).join(""),t.A(ut.substr(0,ut.length-2),s,o,e(t,i,h+1,f,s))),r=h+1):f.C=u}f.C&&t.e&&t.e("&lt;!--",s,o,e(t,i,r,f,s));break;case"<!":if(/^\w/.test(l)){if(!f.r){for(h=r+1;h<c&&">"!==i[h];h++);h<c?r=h+1:f.r=u}f.r&&t.e&&t.e("&lt;!",s,o,e(t,i,r,f,s))}else t.e&&t.e("&lt;!",s,o,e(t,i,r,f,s));break;case"<?":if(!f.r){for(h=r+1;h<c&&">"!==i[h];h++);h<c?r=h+1:f.r=u}f.r&&t.e&&t.e("&lt;?",s,o,e(t,i,r,f,s));break;case">":t.e&&t.e("&gt;",s,o,e(t,i,r,f,s));break;case"":break;default:t.e&&t.e(nt,s,o,e(t,i,r,f,s))}}t.B&&t.B(s)}catch(ft){if(ft!==o)throw ft;}}function d(t,i,r,u,f,o){var h=t.length;v.hasOwnProperty(i.name)||(v[i.name]=RegExp("^"+i.name+"(?:[\\s\\/]|$)","i"));for(var c=v[i.name],l=i.next,s=i.next+1;s<h&&!("<\/"===t[s-1]&&c.test(t[s]));s++);if(s<h&&(s-=1),h=t.slice(l,s).join(""),i.c&n.c.CDATA)r.z&&r.z(h,u,f,e(r,t,s,o,u));else if(i.c&n.c.RCDATA)r.F&&r.F(w(h),u,f,e(r,t,s,o,u));else throw Error("bug");return s}function g(t,i){var f=/^([-\w:]+)/.exec(t[i]),h={},a,l,s,v;h.name=f[1].toLowerCase();h.c=n.f[h.name];for(var o=t[i].substr(f[0].length),e=i+1,c=t.length;e<c&&">"!==t[e];e++)o+=t[e];if(!(c<=e)){for(a=[];""!==o;)if(f=ni.exec(o))if(f[4]&&!f[5]||f[6]&&!f[7]){for(var f=f[4]||f[6],l=r,o=[o,t[e++]];e<c;e++){if(l){if(">"===t[e])break}else 0<=t[e].indexOf(f)&&(l=u);o.push(t[e])}if(c<=e)break;o=o.join("")}else l=f[1].toLowerCase(),f[2]?(s=f[3],v=s.charCodeAt(0),(34===v||39===v)&&(s=s.substr(1,s.length-2)),s=y(s.replace(pt,""))):s="",a.push(l,s),o=o.substr(f[0].length);else o=o.replace(/^[\s\S][^a-z\s]*/,"");return h.R=a,h.next=e+1,h}}function nt(i){function o(n,t){e||t.push(n)}var u,e;return b({startDoc:function(){u=[];e=r},startTag:function(r,o,s){var l,h,c,a,y,v;if(!e&&n.f.hasOwnProperty(r)&&(l=n.f[r],!(l&n.c.FOLDABLE)))if(h=i(r,o),h){if("object"!=typeof h)throw Error("tagPolicy did not return object (old API?)");if("attribs"in h)o=h.attribs;else throw Error("tagPolicy gave no attribs");for(("tagName"in h)?(c=h.tagName,h=n.f[c]):(c=r,h=l),l&n.c.OPTIONAL_ENDTAG&&(a=u[u.length-1],a&&a.D===r&&(a.v!==c||r!==c)&&s.push("<\/",a.v,">")),l&n.c.EMPTY||u.push({D:r,v:c}),s.push("<",c),r=0,a=o.length;r<a;r+=2)y=o[r],v=o[r+1],v!==t&&v!==f&&s.push(" ",y,'="',p(v),'"');s.push(">");l&n.c.EMPTY&&!(h&n.c.EMPTY)&&s.push("<\/",c,">")}else e=!(l&n.c.EMPTY)},endTag:function(t,i){var f,o,s;if(e)e=r;else if(n.f.hasOwnProperty(t)&&(f=n.f[t],!(f&(n.c.EMPTY|n.c.FOLDABLE)))){if(f&n.c.OPTIONAL_ENDTAG)for(f=u.length;0<=--f;){if(o=u[f].D,o===t)break;if(!(n.f[o]&n.c.OPTIONAL_ENDTAG))return}else for(f=u.length;0<=--f&&u[f].D!==t;);if(!(0>f)){for(o=u.length;--o>f;)s=u[o].v,n.f[s]&n.c.OPTIONAL_ENDTAG||i.push("<\/",s,">");f<u.length&&(t=u[f].v);u.length=f;i.push("<\/",t,">")}}},pcdata:o,rcdata:o,cdata:o,endDoc:function(n){for(;u.length;u.length--)n.push("<\/",u[u.length-1].v,">")}})}function tt(n,i,r,u,f){var e,o;if(!f)return t;try{if(e=c.parse(""+n),e&&(!e.K()||ii.test(e.W())))return o=f(e,i,r,u),o?o.toString():t}catch(s){}return t}function s(n,t,i,r,u){if(i||n(t+" removed",{S:"removed",tagName:t}),r!==u){var f="changed";r&&!u?f="removed":!r&&u&&(f="added");n(t+"."+i+" "+f,{S:f,tagName:t,la:i,oldValue:r,newValue:u})}}function it(n,t,i){return(t=t+"::"+i,n.hasOwnProperty(t))?n[t]:(t="*::"+i,n.hasOwnProperty(t)?n[t]:void 0)}function rt(i,r,u,e,o){for(var p,v=0;v<r.length;v+=2){var l=r[v],c=r[v+1],a=c,w=t,y;if(((y=i+"::"+l,n.m.hasOwnProperty(y))||(y="*::"+l,n.m.hasOwnProperty(y)))&&(w=n.m[y]),w!==t)switch(w){case n.d.NONE:break;case n.d.SCRIPT:c=t;o&&s(o,i,l,a,c);break;case n.d.STYLE:if("undefined"==typeof h){c=t;o&&s(o,i,l,a,c);break}p=[];h(c,{declaration:function(i,r){var f=i.toLowerCase();et(f,r,u?function(t){return tt(t,n.P.ja,n.M.ka,{TYPE:"CSS",CSS_PROP:f},u)}:t);r.length&&p.push(f+": "+r.join(" "))}});c=0<p.length?p.join(" ; "):t;o&&s(o,i,l,a,c);break;case n.d.ID:case n.d.IDREF:case n.d.IDREFS:case n.d.GLOBAL_NAME:case n.d.LOCAL_NAME:case n.d.CLASSES:c=e?e(c):c;o&&s(o,i,l,a,c);break;case n.d.URI:c=tt(c,it(n.J,i,l),it(n.I,i,l),{TYPE:"MARKUP",XML_ATTR:l,XML_TAG:i},u);o&&s(o,i,l,a,c);break;case n.d.URI_FRAGMENT:c&&"#"===c.charAt(0)?(c=c.substring(1),c=e?e(c):c,c!==t&&c!==f&&(c="#"+c)):c=t;o&&s(o,i,l,a,c);break;default:c=t;o&&s(o,i,l,a,c)}else c=t,o&&s(o,i,l,a,c);r[v+1]=c}return r}function ut(t,i,r){return function(u,e){if(n.f[u]&n.c.UNSAFE)r&&s(r,u,f,f,f);else return{attribs:rt(u,e,t,i,r)}}}function ft(n,t){var i=[];return nt(t)(n,i),i.join("")}var h,et;"undefined"!=typeof window&&(h=window.parseCssDeclarations,et=window.sanitizeCssProperty);var l={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:" "},at=/^#(\d+)$/,vt=/^#x([0-9A-Fa-f]+)$/,yt=/^[A-Za-z][A-za-z0-9]+$/,a="undefined"!=typeof window&&window.document?window.document.createElement("textarea"):t,pt=/\0/g,wt=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,bt=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,kt=/&/g,dt=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,ot=/[<]/g,st=/>/g,gt=/\"/g,ni=/^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i,ti=3==="a,b".split(/(,)/).length,ht=n.c.CDATA|n.c.RCDATA,o={},v={},ii=/^(?:https?|mailto|data)$/i,i={};return i.pa=i.escapeAttrib=p,i.ra=i.makeHtmlSanitizer=nt,i.sa=i.makeSaxParser=b,i.ta=i.makeTagPolicy=ut,i.wa=i.normalizeRCData=w,i.xa=i.sanitize=function(n,t,i,r){return ft(n,ut(t,i,r))},i.ya=i.sanitizeAttribs=rt,i.za=i.sanitizeWithPolicy=ft,i.Ba=i.unescapeEntities=y,i}(i);k=p.sanitize;"undefined"!=typeof window&&(window.html=p,window.html_sanitize=k)}();mxClient={VERSION:"3.9.3",IS_IE:navigator.userAgent.indexOf("MSIE")>=0,IS_IE6:navigator.userAgent.indexOf("MSIE 6")>=0,IS_IE11:!!navigator.userAgent.match(/Trident\/7\./),IS_EDGE:!!navigator.userAgent.match(/Edge\//),IS_QUIRKS:navigator.userAgent.indexOf("MSIE")>=0&&(document.documentMode==null||document.documentMode==5),IS_EM:"spellcheck"in document.createElement("textarea")&&document.documentMode==8,VML_PREFIX:"v",OFFICE_PREFIX:"o",IS_NS:navigator.userAgent.indexOf("Mozilla/")>=0&&navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("Edge/")<0,IS_OP:navigator.userAgent.indexOf("Opera/")>=0||navigator.userAgent.indexOf("OPR/")>=0,IS_OT:navigator.userAgent.indexOf("Presto/")>=0&&navigator.userAgent.indexOf("Presto/2.4.")<0&&navigator.userAgent.indexOf("Presto/2.3.")<0&&navigator.userAgent.indexOf("Presto/2.2.")<0&&navigator.userAgent.indexOf("Presto/2.1.")<0&&navigator.userAgent.indexOf("Presto/2.0.")<0&&navigator.userAgent.indexOf("Presto/1.")<0,IS_SF:navigator.userAgent.indexOf("AppleWebKit/")>=0&&navigator.userAgent.indexOf("Chrome/")<0&&navigator.userAgent.indexOf("Edge/")<0,IS_IOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,IS_GC:navigator.userAgent.indexOf("Chrome/")>=0&&navigator.userAgent.indexOf("Edge/")<0,IS_CHROMEAPP:window.chrome!=null&&chrome.app!=null&&chrome.app.runtime!=null,IS_FF:navigator.userAgent.indexOf("Firefox/")>=0,IS_MT:navigator.userAgent.indexOf("Firefox/")>=0&&navigator.userAgent.indexOf("Firefox/1.")<0&&navigator.userAgent.indexOf("Firefox/2.")<0||navigator.userAgent.indexOf("Iceweasel/")>=0&&navigator.userAgent.indexOf("Iceweasel/1.")<0&&navigator.userAgent.indexOf("Iceweasel/2.")<0||navigator.userAgent.indexOf("SeaMonkey/")>=0&&navigator.userAgent.indexOf("SeaMonkey/1.")<0||navigator.userAgent.indexOf("Iceape/")>=0&&navigator.userAgent.indexOf("Iceape/1.")<0,IS_SVG:navigator.userAgent.indexOf("Firefox/")>=0||navigator.userAgent.indexOf("Iceweasel/")>=0||navigator.userAgent.indexOf("Seamonkey/")>=0||navigator.userAgent.indexOf("Iceape/")>=0||navigator.userAgent.indexOf("Galeon/")>=0||navigator.userAgent.indexOf("Epiphany/")>=0||navigator.userAgent.indexOf("AppleWebKit/")>=0||navigator.userAgent.indexOf("Gecko/")>=0||navigator.userAgent.indexOf("Opera/")>=0||document.documentMode!=null&&document.documentMode>=9,NO_FO:!document.createElementNS||document.createElementNS("http://www.w3.org/2000/svg","foreignObject")!="[object SVGForeignObjectElement]"||navigator.userAgent.indexOf("Opera/")>=0,IS_VML:navigator.appName.toUpperCase()=="MICROSOFT INTERNET EXPLORER",IS_WIN:navigator.appVersion.indexOf("Win")>0,IS_MAC:navigator.appVersion.indexOf("Mac")>0,IS_TOUCH:"ontouchstart"in document.documentElement,IS_POINTER:window.PointerEvent!=null&&!(navigator.appVersion.indexOf("Mac")>0),IS_LOCAL:document.location.href.indexOf("http://")<0&&document.location.href.indexOf("https://")<0,defaultBundles:[],isBrowserSupported:function(){return mxClient.IS_VML||mxClient.IS_SVG},link:function(n,t,i){var r,u;i=i||document;mxClient.IS_IE6?i.write('<link rel="'+n+'" href="'+t+'" charset="UTF-8" type="text/css"/>'):(r=i.createElement("link"),r.setAttribute("rel",n),r.setAttribute("href",t),r.setAttribute("charset","UTF-8"),r.setAttribute("type","text/css"),u=i.getElementsByTagName("head")[0],u.appendChild(r))},loadResources:function(n,t){function u(){--r==0&&n()}for(var r=mxClient.defaultBundles.length,i=0;i<mxClient.defaultBundles.length;i++)mxResources.add(mxClient.defaultBundles[i],t,u)},include:function(n){document.write('<script src="'+n+'"><\/script>')},dispose:function(){for(var n=0;n<mxEvent.objects.length;n++)mxEvent.objects[n].mxListenerList!=null&&mxEvent.removeAllListeners(mxEvent.objects[n])}};typeof mxLoadResources=="undefined"&&(mxLoadResources=!0);typeof mxForceIncludes=="undefined"&&(mxForceIncludes=!1);typeof mxResourceExtension=="undefined"&&(mxResourceExtension=".txt");typeof mxLoadStylesheets=="undefined"&&(mxLoadStylesheets=!0);typeof mxBasePath!="undefined"&&mxBasePath.length>0?(mxBasePath.substring(mxBasePath.length-1)=="/"&&(mxBasePath=mxBasePath.substring(0,mxBasePath.length-1)),mxClient.basePath=mxBasePath):mxClient.basePath=".";typeof mxImageBasePath!="undefined"&&mxImageBasePath.length>0?(mxImageBasePath.substring(mxImageBasePath.length-1)=="/"&&(mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1)),mxClient.imageBasePath=mxImageBasePath):mxClient.imageBasePath=mxClient.basePath+"/images";mxClient.language=typeof mxLanguage!="undefined"&&mxLanguage!=null?mxLanguage:mxClient.IS_IE?navigator.userLanguage:navigator.language;mxClient.defaultLanguage=typeof mxDefaultLanguage!="undefined"&&mxDefaultLanguage!=null?mxDefaultLanguage:"en";mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/common.css");typeof mxLanguages!="undefined"&&mxLanguages!=null&&(mxClient.languages=mxLanguages);mxClient.IS_VML&&(mxClient.IS_SVG?mxClient.IS_VML=!1:(document.documentMode==8?(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml","#default#VML"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office","#default#VML")):(document.namespaces.add(mxClient.VML_PREFIX,"urn:schemas-microsoft-com:vml"),document.namespaces.add(mxClient.OFFICE_PREFIX,"urn:schemas-microsoft-com:office:office")),mxClient.IS_QUIRKS&&document.styleSheets.length>=30?function(){var n=document.createElement("style");n.type="text/css";n.styleSheet.cssText=mxClient.VML_PREFIX+"\\:*{behavior:url(#default#VML)}"+mxClient.OFFICE_PREFIX+"\\:*{behavior:url(#default#VML)}";document.getElementsByTagName("head")[0].appendChild(n)}():document.createStyleSheet().cssText=mxClient.VML_PREFIX+"\\:*{behavior:url(#default#VML)}"+mxClient.OFFICE_PREFIX+"\\:*{behavior:url(#default#VML)}",mxLoadStylesheets&&mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css"),window.attachEvent("onunload",mxClient.dispose)));mxLog={consoleName:"Console",TRACE:!1,DEBUG:!0,WARN:!0,buffer:"",init:function(){var o,n,i,r,s,u;if(mxLog.window==null&&document.body!=null){o=mxLog.consoleName+" - mxGraph "+mxClient.VERSION;n=document.createElement("table");n.setAttribute("width","100%");n.setAttribute("height","100%");var f=document.createElement("tbody"),t=document.createElement("tr"),e=document.createElement("td");e.style.verticalAlign="top";mxLog.textarea=document.createElement("textarea");mxLog.textarea.setAttribute("wrap","off");mxLog.textarea.setAttribute("readOnly","true");mxLog.textarea.style.height="100%";mxLog.textarea.style.resize="none";mxLog.textarea.value=mxLog.buffer;mxLog.textarea.style.width=mxClient.IS_NS&&document.compatMode!="BackCompat"?"99%":"100%";e.appendChild(mxLog.textarea);t.appendChild(e);f.appendChild(t);t=document.createElement("tr");mxLog.td=document.createElement("td");mxLog.td.style.verticalAlign="top";mxLog.td.setAttribute("height","30px");t.appendChild(mxLog.td);f.appendChild(t);n.appendChild(f);mxLog.addButton("Info",function(){mxLog.info()});mxLog.addButton("DOM",function(){var n=mxUtils.getInnerHtml(document.body);mxLog.debug(n)});mxLog.addButton("Trace",function(){mxLog.TRACE=!mxLog.TRACE;mxLog.TRACE?mxLog.debug("Tracing enabled"):mxLog.debug("Tracing disabled")});mxLog.addButton("Copy",function(){try{mxUtils.copy(mxLog.textarea.value)}catch(n){mxUtils.alert(n)}});mxLog.addButton("Show",function(){try{mxUtils.popup(mxLog.textarea.value)}catch(n){mxUtils.alert(n)}});mxLog.addButton("Clear",function(){mxLog.textarea.value=""});i=0;r=0;typeof innerWidth=="number"?(i=window.innerHeight,r=window.innerWidth):(i=document.documentElement.clientHeight||document.body.clientHeight,r=document.body.clientWidth);mxLog.window=new mxWindow(o,n,Math.max(0,r-320),Math.max(0,i-210),300,160);mxLog.window.setMaximizable(!0);mxLog.window.setScrollable(!1);mxLog.window.setResizable(!0);mxLog.window.setClosable(!0);mxLog.window.destroyOnClose=!1;(!(mxClient.IS_NS||mxClient.IS_IE)||mxClient.IS_GC||mxClient.IS_SF||document.compatMode=="BackCompat")&&document.documentMode!=11||(s=mxLog.window.getElement(),u=function(){mxLog.textarea.style.height=Math.max(0,s.offsetHeight-70)+"px"},mxLog.window.addListener(mxEvent.RESIZE_END,u),mxLog.window.addListener(mxEvent.MAXIMIZE,u),mxLog.window.addListener(mxEvent.NORMALIZE,u),mxLog.textarea.style.height="92px")}},info:function(){mxLog.writeln(mxUtils.toString(navigator))},addButton:function(n,t){var i=document.createElement("button");mxUtils.write(i,n);mxEvent.addListener(i,"click",t);mxLog.td.appendChild(i)},isVisible:function(){return mxLog.window!=null?mxLog.window.isVisible():!1},show:function(){mxLog.setVisible(!0)},setVisible:function(n){mxLog.window==null&&mxLog.init();mxLog.window!=null&&mxLog.window.setVisible(n)},enter:function(n){if(mxLog.TRACE)return mxLog.writeln("Entering "+n),(new Date).getTime()},leave:function(n,t){if(mxLog.TRACE){var i=t!=0?" ("+((new Date).getTime()-t)+" ms)":"";mxLog.writeln("Leaving "+n+i)}},debug:function(){mxLog.DEBUG&&mxLog.writeln.apply(this,arguments)},warn:function(){mxLog.WARN&&mxLog.writeln.apply(this,arguments)},write:function(){for(var n="",t=0;t<arguments.length;t++)n+=arguments[t],t<arguments.length-1&&(n+=" ");mxLog.textarea!=null?(mxLog.textarea.value=mxLog.textarea.value+n,navigator.userAgent.indexOf("Presto/2.5")>=0&&(mxLog.textarea.style.visibility="hidden",mxLog.textarea.style.visibility="visible"),mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight):mxLog.buffer+=n},writeln:function(){for(var t="",n=0;n<arguments.length;n++)t+=arguments[n],n<arguments.length-1&&(t+=" ");mxLog.write(t+"\n")}};mxObjectIdentity={FIELD_NAME:"mxObjectId",counter:0,get:function(n){if(n!=null){if(n[mxObjectIdentity.FIELD_NAME]==null)if(typeof n=="object"){var t=mxUtils.getFunctionName(n.constructor);n[mxObjectIdentity.FIELD_NAME]=t+"#"+mxObjectIdentity.counter++}else typeof n=="function"&&(n[mxObjectIdentity.FIELD_NAME]="Function#"+mxObjectIdentity.counter++);return n[mxObjectIdentity.FIELD_NAME]}return null},clear:function(n){(typeof n=="object"||typeof n=="function")&&delete n[mxObjectIdentity.FIELD_NAME]}};mxDictionary.prototype.map=null;mxDictionary.prototype.clear=function(){this.map={}};mxDictionary.prototype.get=function(n){var t=mxObjectIdentity.get(n);return this.map[t]};mxDictionary.prototype.put=function(n,t){var i=mxObjectIdentity.get(n),r=this.map[i];return this.map[i]=t,r};mxDictionary.prototype.remove=function(n){var t=mxObjectIdentity.get(n),i=this.map[t];return delete this.map[t],i};mxDictionary.prototype.getKeys=function(){var n=[];for(var t in this.map)n.push(t);return n};mxDictionary.prototype.getValues=function(){var n=[];for(var t in this.map)n.push(this.map[t]);return n};mxDictionary.prototype.visit=function(n){for(var t in this.map)n(t,this.map[t])};mxResources={resources:[],extension:mxResourceExtension,resourcesEncoded:!1,loadDefaultBundle:!0,loadSpecialBundle:!0,isLanguageSupported:function(n){return mxClient.languages!=null?mxUtils.indexOf(mxClient.languages,n)>=0:!0},getDefaultBundle:function(n,t){return mxResources.loadDefaultBundle||!mxResources.isLanguageSupported(t)?n+mxResources.extension:null},getSpecialBundle:function(n,t){if(mxClient.languages==null||!this.isLanguageSupported(t)){var i=t.indexOf("-");i>0&&(t=t.substring(0,i))}return mxResources.loadSpecialBundle&&mxResources.isLanguageSupported(t)&&t!=mxClient.defaultLanguage?n+"_"+t+mxResources.extension:null},add:function(n,t,i){var e;if(t=t!=null?t:mxClient.language!=null?mxClient.language.toLowerCase():mxConstants.NONE,t!=mxConstants.NONE){var u=mxResources.getDefaultBundle(n,t),f=mxResources.getSpecialBundle(n,t),r=function(){if(f!=null)if(i)mxUtils.get(f,function(n){mxResources.parse(n.getText());i()},function(){i()});else try{var n=mxUtils.load(f);n.isReady()&&mxResources.parse(n.getText())}catch(t){}else i!=null&&i()};if(u!=null)if(i)mxUtils.get(u,function(n){mxResources.parse(n.getText());r()},function(){r()});else try{e=mxUtils.load(u);e.isReady()&&mxResources.parse(e.getText());r()}catch(o){}else r()}},parse:function(n){var i,t,u,e,f,r;if(n!=null)for(i=n.split("\n"),t=0;t<i.length;t++)i[t].charAt(0)!="#"&&(u=i[t].indexOf("="),u>0&&(e=i[t].substring(0,u),f=i[t].length,i[t].charCodeAt(f-1)==13&&f--,r=i[t].substring(u+1,f),this.resourcesEncoded?(r=r.replace(/\\(?=u[a-fA-F\d]{4})/g,"%"),mxResources.resources[e]=unescape(r)):mxResources.resources[e]=r))},get:function(n,t,i){var r=mxResources.resources[n];return r==null&&(r=i),r!=null&&t!=null&&(r=mxResources.replacePlaceholders(r,t)),r},replacePlaceholders:function(n,t){for(var r,u=[],i=null,f=0;f<n.length;f++)r=n.charAt(f),r=="{"?i="":i!=null&&r=="}"?(i=parseInt(i)-1,i>=0&&i<t.length&&u.push(t[i]),i=null):i!=null?i+=r:u.push(r);return u.join("")},loadResources:function(n){mxResources.add(mxClient.basePath+"/resources/editor",null,function(){mxResources.add(mxClient.basePath+"/resources/graph",null,n)})}};mxPoint.prototype.x=null;mxPoint.prototype.y=null;mxPoint.prototype.equals=function(n){return n!=null&&n.x==this.x&&n.y==this.y};mxPoint.prototype.clone=function(){return mxUtils.clone(this)};mxRectangle.prototype=new mxPoint;mxRectangle.prototype.constructor=mxRectangle;mxRectangle.prototype.width=null;mxRectangle.prototype.height=null;mxRectangle.prototype.setRect=function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r};mxRectangle.prototype.getCenterX=function(){return this.x+this.width/2};mxRectangle.prototype.getCenterY=function(){return this.y+this.height/2};mxRectangle.prototype.add=function(n){if(n!=null){var t=Math.min(this.x,n.x),i=Math.min(this.y,n.y),r=Math.max(this.x+this.width,n.x+n.width),u=Math.max(this.y+this.height,n.y+n.height);this.x=t;this.y=i;this.width=r-t;this.height=u-i}};mxRectangle.prototype.intersect=function(n){if(n!=null){var t=this.x+this.width,i=n.x+n.width,r=this.y+this.height,u=n.y+n.height;this.x=Math.max(this.x,n.x);this.y=Math.max(this.y,n.y);this.width=Math.min(t,i)-this.x;this.height=Math.min(r,u)-this.y}};mxRectangle.prototype.grow=function(n){this.x-=n;this.y-=n;this.width+=2*n;this.height+=2*n};mxRectangle.prototype.getPoint=function(){return new mxPoint(this.x,this.y)};mxRectangle.prototype.rotate90=function(){var n=(this.width-this.height)/2,t;this.x+=n;this.y-=n;t=this.width;this.width=this.height;this.height=t};mxRectangle.prototype.equals=function(n){return n!=null&&n.x==this.x&&n.y==this.y&&n.width==this.width&&n.height==this.height};mxRectangle.fromRectangle=function(n){return new mxRectangle(n.x,n.y,n.width,n.height)};var mxEffects={animateChanges:function(n,t,i){var r=10,u=0,f=function(){for(var o,s,l=!1,c=0;c<t.length;c++)if(o=t[c],(o instanceof mxGeometryChange||o instanceof mxTerminalChange||o instanceof mxValueChange||o instanceof mxChildChange||o instanceof mxStyleChange)&&(s=n.getView().getState(o.cell||o.child,!1),s!=null))if(l=!0,o.constructor!=mxGeometryChange||n.model.isEdge(o.cell))mxUtils.setOpacity(s.shape.node,100*u/r);else{var h=n.getView().scale,a=(o.geometry.x-o.previous.x)*h,v=(o.geometry.y-o.previous.y)*h,y=(o.geometry.width-o.previous.width)*h,p=(o.geometry.height-o.previous.height)*h;u==0?(s.x-=a,s.y-=v,s.width-=y,s.height-=p):(s.x+=a/r,s.y+=v/r,s.width+=y/r,s.height+=p/r);n.cellRenderer.redraw(s);mxEffects.cascadeOpacity(n,o.cell,100*u/r)}u<r&&l?(u++,window.setTimeout(f,e)):i!=null&&i()},e=30;f()},cascadeOpacity:function(n,t,i){for(var f,e,u,o,s=n.model.getChildCount(t),r=0;r<s;r++)f=n.model.getChildAt(t,r),e=n.getView().getState(f),e!=null&&(mxUtils.setOpacity(e.shape.node,i),mxEffects.cascadeOpacity(n,f,i));if(u=n.model.getEdges(t),u!=null)for(r=0;r<u.length;r++)o=n.getView().getState(u[r]),o!=null&&mxUtils.setOpacity(o.shape.node,i)},fadeOut:function(n,t,i,r,u,f){var e,o;r=r||40;u=u||30;e=t||100;mxUtils.setOpacity(n,e);f||f==null?(o=function(){e=Math.max(e-r,0);mxUtils.setOpacity(n,e);e>0?window.setTimeout(o,u):(n.style.visibility="hidden",i&&n.parentNode&&n.parentNode.removeChild(n))},window.setTimeout(o,u)):(n.style.visibility="hidden",i&&n.parentNode&&n.parentNode.removeChild(n))}},mxUtils={errorResource:mxClient.language!="none"?"error":"",closeResource:mxClient.language!="none"?"close":"",errorImage:mxClient.imageBasePath+"/error.gif",removeCursors:function(n){var t,r,i;if(n.style!=null&&(n.style.cursor=""),t=n.childNodes,t!=null)for(r=t.length,i=0;i<r;i+=1)mxUtils.removeCursors(t[i])},getCurrentStyle:function(){return mxClient.IS_IE&&(document.documentMode==null||document.documentMode<9)?function(n){return n!=null?n.currentStyle:null}:function(n){return n!=null?window.getComputedStyle(n,""):null}}(),parseCssNumber:function(n){return n=="thin"?n="2":n=="medium"?n="4":n=="thick"&&(n="6"),n=parseFloat(n),isNaN(n)&&(n=0),n},setPrefixedStyle:function(){var n=null;return mxClient.IS_OT?n="O":mxClient.IS_SF||mxClient.IS_GC?n="Webkit":mxClient.IS_MT?n="Moz":mxClient.IS_IE&&document.documentMode>=9&&document.documentMode<10&&(n="ms"),function(t,i,r){t[i]=r;n!=null&&i.length>0&&(i=n+i.substring(0,1).toUpperCase()+i.substring(1),t[i]=r)}}(),hasScrollbars:function(n){var t=mxUtils.getCurrentStyle(n);return t!=null&&(t.overflow=="scroll"||t.overflow=="auto")},bind:function(n,t){return function(){return t.apply(n,arguments)}},eval:function(n){var t=null;if(n.indexOf("function")>=0)try{eval("var _mxJavaScriptExpression="+n);t=_mxJavaScriptExpression;_mxJavaScriptExpression=null}catch(i){mxLog.warn(i.message+" while evaluating "+n)}else try{t=eval(n)}catch(i){mxLog.warn(i.message+" while evaluating "+n)}return t},findNode:function(n,t,i){var r,u;if(n.nodeType==mxConstants.NODETYPE_ELEMENT&&(r=n.getAttribute(t),r!=null&&r==i))return n;for(n=n.firstChild;n!=null;){if(u=mxUtils.findNode(n,t,i),u!=null)return u;n=n.nextSibling}return null},getFunctionName:function(n){var t=null,i;return n!=null&&(n.name!=null?t=n.name:(t=mxUtils.trim(n.toString()),/^function\s/.test(t)&&(t=mxUtils.ltrim(t.substring(9)),i=t.indexOf("("),i>0&&(t=t.substring(0,i))))),t},indexOf:function(n,t){if(n!=null&&t!=null)for(var i=0;i<n.length;i++)if(n[i]==t)return i;return-1},forEach:function(n,t){if(n!=null&&t!=null)for(var i=0;i<n.length;i++)t(n[i]);return n},remove:function(n,t){var r=null,i,u;if(typeof t=="object")for(i=mxUtils.indexOf(t,n);i>=0;)t.splice(i,1),r=n,i=mxUtils.indexOf(t,n);for(u in t)t[u]==n&&(delete t[u],r=n);return r},isNode:function(n,t,i,r){return n!=null&&!isNaN(n.nodeType)&&(t==null||n.nodeName.toLowerCase()==t.toLowerCase())?i==null||n.getAttribute(i)==r:!1},isAncestorNode:function(n,t){for(var i=t;i!=null;){if(i==n)return!0;i=i.parentNode}return!1},getChildNodes:function(n,t){t=t||mxConstants.NODETYPE_ELEMENT;for(var r=[],i=n.firstChild;i!=null;)i.nodeType==t&&r.push(i),i=i.nextSibling;return r},importNode:function(n,t,i){var u,r;if(mxClient.IS_IE&&(document.documentMode==null||document.documentMode<10))switch(t.nodeType){case 1:if(u=n.createElement(t.nodeName),t.attributes&&t.attributes.length>0){for(r=0;r<t.attributes.length;r++)u.setAttribute(t.attributes[r].nodeName,t.getAttribute(t.attributes[r].nodeName));if(i&&t.childNodes&&t.childNodes.length>0)for(r=0;r<t.childNodes.length;r++)u.appendChild(mxUtils.importNode(n,t.childNodes[r],i))}return u;case 3:case 4:case 8:return n.createTextNode(t.value)}else return n.importNode(t,i)},createXmlDocument:function(){var n=null;return document.implementation&&document.implementation.createDocument?n=document.implementation.createDocument("","",null):window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLDOM")),n},parseXml:function(){return window.DOMParser?function(n){var t=new DOMParser;return t.parseFromString(n,"text/xml")}:function(n){var t=mxUtils.createXmlDocument();return t.async=!1,t.validateOnParse=!1,t.resolveExternals=!1,t.loadXML(n),t}}(),clearSelection:function(){return document.selection?function(){document.selection.empty()}:window.getSelection?function(){window.getSelection().removeAllRanges()}:function(){}}(),getPrettyXml:function(n,t,i){var r=[],o,f,e,s,u;if(n!=null)if(t=t||"  ",i=i||"",n.nodeType==mxConstants.NODETYPE_TEXT)o=mxUtils.trim(mxUtils.getTextContent(n)),o.length>0&&r.push(i+mxUtils.htmlEntities(o)+"\n");else{if(r.push(i+"<"+n.nodeName),f=n.attributes,f!=null)for(e=0;e<f.length;e++)s=mxUtils.htmlEntities(f[e].value),r.push(" "+f[e].nodeName+'="'+s+'"');if(u=n.firstChild,u!=null){for(r.push(">\n");u!=null;)r.push(mxUtils.getPrettyXml(u,t,i+t)),u=u.nextSibling;r.push(i+"<\/"+n.nodeName+">\n")}else r.push("/>\n")}return r.join("")},removeWhitespace:function(n,t){for(var i=t?n.previousSibling:n.nextSibling,r,u;i!=null&&i.nodeType==mxConstants.NODETYPE_TEXT;)r=t?i.previousSibling:i.nextSibling,u=mxUtils.getTextContent(i),mxUtils.trim(u).length==0&&i.parentNode.removeChild(i),i=r},htmlEntities:function(n,t){return n=String(n||""),n=n.replace(/&/g,"&amp;"),n=n.replace(/"/g,"&quot;"),n=n.replace(/\'/g,"&#39;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),(t==null||t)&&(n=n.replace(/\n/g,"&#xa;")),n},isVml:function(n){return n!=null&&n.tagUrn=="urn:schemas-microsoft-com:vml"},getXml:function(n,t){var i="",r;return window.XMLSerializer!=null?(r=new XMLSerializer,i=r.serializeToString(n)):n.xml!=null&&(i=n.xml.replace(/\r\n\t[\t]*/g,"").replace(/>\r\n/g,">").replace(/\r\n/g,"\n")),t=t||"&#xa;",i.replace(/\n/g,t)},extractTextWithWhitespace:function(n){function i(n){var f,u;if(n.length!=1||n[0].nodeName!="BR"&&n[0].innerHTML!="\n")for(f=0;f<n.length;f++)u=n[f],u.nodeName=="BR"||u.innerHTML=="\n"||(n.length==1||f==0)&&u.nodeName=="DIV"&&u.innerHTML.toLowerCase()=="<br>"?t.push("\n"):(u.nodeType===3||u.nodeType===4?u.nodeValue.length>0&&t.push(u.nodeValue):u.nodeType!==8&&u.childNodes.length>0&&i(u.childNodes),f<n.length-1&&mxUtils.indexOf(r,n[f+1].nodeName)>=0&&t.push("\n"))}var r=["BLOCKQUOTE","DIV","H1","H2","H3","H4","H5","H6","OL","P","PRE","TABLE","UL"],t=[];return i(n),t.join("")},replaceTrailingNewlines:function(n,t){for(var i="";n.length>0&&n.charAt(n.length-1)=="\n";)n=n.substring(0,n.length-1),i+=t;return n+i},getTextContent:function(n){return n.innerText!==undefined?n.innerText:n!=null?n[n.textContent===undefined?"text":"textContent"]:""},setTextContent:function(n,t){n.innerText!==undefined?n.innerText=t:n[n.textContent===undefined?"text":"textContent"]=t},getInnerHtml:function(){return mxClient.IS_IE?function(n){return n!=null?n.innerHTML:""}:function(n){if(n!=null){var t=new XMLSerializer;return t.serializeToString(n)}return""}}(),getOuterHtml:function(){return mxClient.IS_IE?function(n){var t,i,r,u;if(n!=null){if(n.outerHTML!=null)return n.outerHTML;if(t=[],t.push("<"+n.nodeName),i=n.attributes,i!=null)for(r=0;r<i.length;r++)u=i[r].value,u!=null&&u.length>0&&(t.push(" "),t.push(i[r].nodeName),t.push('="'),t.push(u),t.push('"'));return n.innerHTML.length==0?t.push("/>"):(t.push(">"),t.push(n.innerHTML),t.push("<\/"+n.nodeName+">")),t.join("")}return""}:function(n){if(n!=null){var t=new XMLSerializer;return t.serializeToString(n)}return""}}(),write:function(n,t){var r=n.ownerDocument,i=r.createTextNode(t);return n!=null&&n.appendChild(i),i},writeln:function(n,t){var r=n.ownerDocument,i=r.createTextNode(t);return n!=null&&(n.appendChild(i),n.appendChild(document.createElement("br"))),i},br:function(n,t){var i,r;for(t=t||1,i=null,r=0;r<t;r++)n!=null&&(i=n.ownerDocument.createElement("br"),n.appendChild(i));return i},button:function(n,t,i){i=i!=null?i:document;var r=i.createElement("button");return mxUtils.write(r,n),mxEvent.addListener(r,"click",function(n){t(n)}),r},para:function(n,t){var i=document.createElement("p");return mxUtils.write(i,t),n!=null&&n.appendChild(i),i},addTransparentBackgroundFilter:function(n){n.style.filter+="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+mxClient.imageBasePath+"/transparent.gif', sizingMethod='scale')"},linkAction:function(n,t,i,r,u){return mxUtils.link(n,t,function(){i.execute(r)},u)},linkInvoke:function(n,t,i,r,u,f){return mxUtils.link(n,t,function(){i[r](u)},f)},link:function(n,t,i,r){var u=document.createElement("span");return u.style.color="blue",u.style.textDecoration="underline",u.style.cursor="pointer",r!=null&&(u.style.paddingLeft=r+"px"),mxEvent.addListener(u,"click",i),mxUtils.write(u,t),n!=null&&n.appendChild(u),u},fit:function(n){var c=parseInt(n.offsetLeft),t=parseInt(n.offsetWidth),i=mxUtils.getDocumentScrollOrigin(n.ownerDocument),r=i.x,u=i.y,f=document.body,e=document.documentElement,o=r+(f.clientWidth||e.clientWidth);c+t>o&&(n.style.left=Math.max(r,o-t)+"px");var l=parseInt(n.offsetTop),s=parseInt(n.offsetHeight),h=u+Math.max(f.clientHeight||0,e.clientHeight);l+s>h&&(n.style.top=Math.max(u,h-s)+"px")},load:function(n){var t=new mxXmlRequest(n,null,"GET",!1);return t.send(),t},get:function(n,t,i,r,u,f){var e=new mxXmlRequest(n,null,"GET");return r!=null&&e.setBinary(r),e.send(t,i,u,f),e},getAll:function(n,t,i){for(var u=n.length,f=[],e=0,o=function(){e==0&&i!=null&&i();e++},r=0;r<n.length;r++)(function(n,i){mxUtils.get(n,function(n){var r=n.getStatus();r<200||r>299?o():(f[i]=n,u--,u==0&&t(f))},o)})(n[r],r);u==0&&t(f)},post:function(n,t,i,r){return new mxXmlRequest(n,t).send(i,r)},submit:function(n,t,i,r){return new mxXmlRequest(n,t).simulate(i,r)},loadInto:function(n,t,i){mxClient.IS_IE?t.onreadystatechange=function(){t.readyState==4&&i()}:t.addEventListener("load",i,!1);t.load(n)},getValue:function(n,t,i){var r=n!=null?n[t]:null;return r==null&&(r=i),r},getNumber:function(n,t,i){var r=n!=null?n[t]:null;return r==null&&(r=i||0),Number(r)},getColor:function(n,t,i){var r=n!=null?n[t]:null;return r==null?r=i:r==mxConstants.NONE&&(r=null),r},clone:function(n,t,i){var u,r;if(i=i!=null?i:!1,u=null,n!=null&&typeof n.constructor=="function"){u=new n.constructor;for(r in n)r!=mxObjectIdentity.FIELD_NAME&&(t==null||mxUtils.indexOf(t,r)<0)&&(u[r]=i||typeof n[r]!="object"?n[r]:mxUtils.clone(n[r]))}return u},equalPoints:function(n,t){if(n==null&&t!=null||n!=null&&t==null||n!=null&&t!=null&&n.length!=t.length)return!1;if(n!=null&&t!=null)for(var i=0;i<n.length;i++)if(n[i]==t[i]||n[i]!=null&&!n[i].equals(t[i]))return!1;return!0},equalEntries:function(n,t){var r,i;if(n==null&&t!=null||n!=null&&t==null||n!=null&&t!=null&&n.length!=t.length)return!1;if(n!=null&&t!=null){r=0;for(i in t)r++;for(i in n)if(r--,(!mxUtils.isNaN(n[i])||!mxUtils.isNaN(t[i]))&&n[i]!=t[i])return!1}return r==0},removeDuplicates:function(n){for(var i=new mxDictionary,r=[],t=0;t<n.length;t++)i.get(n[t])||(r.push(n[t]),i.put(n[t],!0));return r},isNaN:function(n){return typeof n=="number"&&isNaN(n)},extend:function(n,t){var i=function(){};i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n},toString:function(n){var i="",t,r;for(t in n)try{n[t]==null?i+=t+" = [null]\n":typeof n[t]=="function"?i+=t+" => [Function]\n":typeof n[t]=="object"?(r=mxUtils.getFunctionName(n[t].constructor),i+=t+" => ["+r+"]\n"):i+=t+" = "+n[t]+"\n"}catch(u){i+=t+"="+u.message}return i},toRadians:function(n){return Math.PI*n/180},toDegree:function(n){return n*180/Math.PI},arcToCurves:function(n,t,i,r,u,f,e,o,s){var tt,ct,yt,l,ht;if(o-=n,s-=t,i===0||r===0)return h;tt=e;ct=u;i=Math.abs(i);r=Math.abs(r);var gt=-o/2,ni=-s/2,y=Math.cos(ct*Math.PI/180),p=Math.sin(ct*Math.PI/180),w=y*gt+p*ni,b=-1*p*gt+y*ni,lt=w*w,at=b*b,it=i*i,rt=r*r,vt=lt/it+at/rt,ut;vt>1?(i=Math.sqrt(vt)*i,r=Math.sqrt(vt)*r,ut=0):(yt=1,f===tt&&(yt=-1),ut=yt*Math.sqrt((it*rt-it*at-rt*lt)/(it*at+rt*lt)));var d=ut*i*b/r,g=-1*ut*r*w/i,ei=y*d-p*g+o/2,oi=p*d+y*g+s/2,c=Math.atan2((b-g)/r,(w-d)/i)-Math.atan2(0,1),nt=c>=0?c:2*Math.PI+c;c=Math.atan2((-b-g)/r,(-w-d)/i)-Math.atan2((b-g)/r,(w-d)/i);l=c>=0?c:2*Math.PI+c;tt==0&&l>0?l-=2*Math.PI:tt!=0&&l<0&&(l+=2*Math.PI);var pt=l*2/Math.PI,ti=Math.ceil(pt<0?-1*pt:pt),ft=l/ti,et=8/3*Math.sin(ft/4)*Math.sin(ft/4)/Math.sin(ft/2),wt=y*i,bt=y*r,kt=p*i,dt=p*r,a=Math.cos(nt),v=Math.sin(nt),ii=-et*(wt*v+dt*a),ri=-et*(kt*v-bt*a),ot=0,st=0,h=[];for(ht=0;ht<ti;++ht){nt+=ft;a=Math.cos(nt);v=Math.sin(nt);ot=wt*a-dt*v+ei;st=kt*a+bt*v+oi;var ui=-et*(wt*v+dt*a),fi=-et*(kt*v-bt*a),k=ht*6;h[k]=Number(ii+n);h[k+1]=Number(ri+t);h[k+2]=Number(ot-ui+n);h[k+3]=Number(st-fi+t);h[k+4]=Number(ot+n);h[k+5]=Number(st+t);ii=ot+ui;ri=st+fi}return h},getBoundingBox:function(n,t,i){var r=null;if(n!=null&&t!=null&&t!=0){var c=mxUtils.toRadians(t),e=Math.cos(c),o=Math.sin(c);i=i!=null?i:new mxPoint(n.x+n.width/2,n.y+n.height/2);var s=new mxPoint(n.x,n.y),u=new mxPoint(n.x+n.width,n.y),f=new mxPoint(u.x,n.y+n.height),h=new mxPoint(n.x,f.y);s=mxUtils.getRotatedPoint(s,e,o,i);u=mxUtils.getRotatedPoint(u,e,o,i);f=mxUtils.getRotatedPoint(f,e,o,i);h=mxUtils.getRotatedPoint(h,e,o,i);r=new mxRectangle(s.x,s.y,0,0);r.add(new mxRectangle(u.x,u.y,0,0));r.add(new mxRectangle(f.x,f.y,0,0));r.add(new mxRectangle(h.x,h.y,0,0))}return r},getRotatedPoint:function(n,t,i,r){r=r!=null?r:new mxPoint;var u=n.x-r.x,f=n.y-r.y,e=u*t-f*i,o=f*t+u*i;return new mxPoint(e+r.x,o+r.y)},getPortConstraints:function(n,t,i,r){var s=mxUtils.getValue(n.style,mxConstants.STYLE_PORT_CONSTRAINT,mxUtils.getValue(t.style,i?mxConstants.STYLE_SOURCE_PORT_CONSTRAINT:mxConstants.STYLE_TARGET_PORT_CONSTRAINT,null)),f;if(s==null)return r;var o=s.toString(),u=mxConstants.DIRECTION_MASK_NONE,h=mxUtils.getValue(n.style,mxConstants.STYLE_PORT_CONSTRAINT_ROTATION,0),e=0;if(h==1&&(e=mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION,0)),f=0,e>45?(f=1,e>=135&&(f=2)):e<-45&&(f=3,e<=-135&&(f=2)),o.indexOf(mxConstants.DIRECTION_NORTH)>=0)switch(f){case 0:u|=mxConstants.DIRECTION_MASK_NORTH;break;case 1:u|=mxConstants.DIRECTION_MASK_EAST;break;case 2:u|=mxConstants.DIRECTION_MASK_SOUTH;break;case 3:u|=mxConstants.DIRECTION_MASK_WEST}if(o.indexOf(mxConstants.DIRECTION_WEST)>=0)switch(f){case 0:u|=mxConstants.DIRECTION_MASK_WEST;break;case 1:u|=mxConstants.DIRECTION_MASK_NORTH;break;case 2:u|=mxConstants.DIRECTION_MASK_EAST;break;case 3:u|=mxConstants.DIRECTION_MASK_SOUTH}if(o.indexOf(mxConstants.DIRECTION_SOUTH)>=0)switch(f){case 0:u|=mxConstants.DIRECTION_MASK_SOUTH;break;case 1:u|=mxConstants.DIRECTION_MASK_WEST;break;case 2:u|=mxConstants.DIRECTION_MASK_NORTH;break;case 3:u|=mxConstants.DIRECTION_MASK_EAST}if(o.indexOf(mxConstants.DIRECTION_EAST)>=0)switch(f){case 0:u|=mxConstants.DIRECTION_MASK_EAST;break;case 1:u|=mxConstants.DIRECTION_MASK_SOUTH;break;case 2:u|=mxConstants.DIRECTION_MASK_WEST;break;case 3:u|=mxConstants.DIRECTION_MASK_NORTH}return u},reversePortConstraints:function(n){var t=0;return t=(n&mxConstants.DIRECTION_MASK_WEST)<<3,t|=(n&mxConstants.DIRECTION_MASK_NORTH)<<1,t|=(n&mxConstants.DIRECTION_MASK_SOUTH)>>1,t|(n&mxConstants.DIRECTION_MASK_EAST)>>3},findNearestSegment:function(n,t,i){var s=-1,u,f,r,e,o;if(n.absolutePoints.length>0)for(u=n.absolutePoints[0],f=null,r=1;r<n.absolutePoints.length;r++)e=n.absolutePoints[r],o=mxUtils.ptSegDistSq(u.x,u.y,e.x,e.y,t,i),(f==null||o<f)&&(f=o,s=r-1),u=e;return s},getDirectedBounds:function(n,t,i,r,u){var e=mxUtils.getValue(i,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),o,f;return r=r!=null?r:mxUtils.getValue(i,mxConstants.STYLE_FLIPH,!1),u=u!=null?u:mxUtils.getValue(i,mxConstants.STYLE_FLIPV,!1),t.x=Math.round(Math.max(0,Math.min(n.width,t.x))),t.y=Math.round(Math.max(0,Math.min(n.height,t.y))),t.width=Math.round(Math.max(0,Math.min(n.width,t.width))),t.height=Math.round(Math.max(0,Math.min(n.height,t.height))),(u&&(e==mxConstants.DIRECTION_SOUTH||e==mxConstants.DIRECTION_NORTH)||r&&(e==mxConstants.DIRECTION_EAST||e==mxConstants.DIRECTION_WEST))&&(o=t.x,t.x=t.width,t.width=o),(r&&(e==mxConstants.DIRECTION_SOUTH||e==mxConstants.DIRECTION_NORTH)||u&&(e==mxConstants.DIRECTION_EAST||e==mxConstants.DIRECTION_WEST))&&(o=t.y,t.y=t.height,t.height=o),f=mxRectangle.fromRectangle(t),e==mxConstants.DIRECTION_SOUTH?(f.y=t.x,f.x=t.height,f.width=t.y,f.height=t.width):e==mxConstants.DIRECTION_WEST?(f.y=t.height,f.x=t.width,f.width=t.x,f.height=t.y):e==mxConstants.DIRECTION_NORTH&&(f.y=t.width,f.x=t.y,f.width=t.height,f.height=t.x),new mxRectangle(n.x+f.x,n.y+f.y,n.width-f.width-f.x,n.height-f.height-f.y)},getPerimeterPoint:function(n,t,i){for(var f,u=null,r=0;r<n.length-1;r++)if(f=mxUtils.intersection(n[r].x,n[r].y,n[r+1].x,n[r+1].y,t.x,t.y,i.x,i.y),f!=null){var o=i.x-f.x,s=i.y-f.y,e={p:f,distSq:s*s+o*o};e!=null&&(u==null||u.distSq>e.distSq)&&(u=e)}return u!=null?u.p:null},rectangleIntersectsSegment:function(n,t,i){var s=n.y,h=n.x,l=s+n.height,a=h+n.width,f=t.x,e=i.x,o,c,y;if(t.x>i.x&&(f=i.x,e=t.x),e>a&&(e=a),f<h&&(f=h),f>e)return!1;var r=t.y,u=i.y,v=i.x-t.x;return(Math.abs(v)>1e-7&&(o=(i.y-t.y)/v,c=t.y-o*t.x,r=o*f+c,u=o*e+c),r>u&&(y=u,u=r,r=y),u>l&&(u=l),r<s&&(r=s),r>u)?!1:!0},contains:function(n,t,i){return n.x<=t&&n.x+n.width>=t&&n.y<=i&&n.y+n.height>=i},intersects:function(n,t){var i=n.width,r=n.height,u=t.width,f=t.height;if(u<=0||f<=0||i<=0||r<=0)return!1;var e=n.x,o=n.y,s=t.x,h=t.y;return u+=s,f+=h,i+=e,r+=o,(u<s||u>e)&&(f<h||f>o)&&(i<e||i>s)&&(r<o||r>h)},intersectsHotspot:function(n,t,i,r,u,f){var a,h;if(r=r!=null?r:1,u=u!=null?u:0,f=f!=null?f:0,r>0){var c=n.getCenterX(),l=n.getCenterY(),e=n.width,o=n.height,s=mxUtils.getValue(n.style,mxConstants.STYLE_STARTSIZE)*n.view.scale;if(s>0&&(mxUtils.getValue(n.style,mxConstants.STYLE_HORIZONTAL,!0)?(l=n.y+s/2,o=s):(c=n.x+s/2,e=s)),e=Math.max(u,e*r),o=Math.max(u,o*r),f>0&&(e=Math.min(e,f),o=Math.min(o,f)),a=new mxRectangle(c-e/2,l-o/2,e,o),h=mxUtils.toRadians(mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION)||0),h!=0){var y=Math.cos(-h),p=Math.sin(-h),c=new mxPoint(n.getCenterX(),n.getCenterY()),v=mxUtils.getRotatedPoint(new mxPoint(t,i),y,p,c);t=v.x;i=v.y}return mxUtils.contains(a,t,i)}return!0},getOffset:function(n,t){for(var f=0,e=0,r=!1,i=n,h=document.body,c=document.documentElement,o,s,u;i!=null&&i!=h&&i!=c&&!r;)o=mxUtils.getCurrentStyle(i),o!=null&&(r=r||o.position=="fixed"),i=i.parentNode;return t||r||(s=mxUtils.getDocumentScrollOrigin(n.ownerDocument),f+=s.x,e+=s.y),u=n.getBoundingClientRect(),u!=null&&(f+=u.left,e+=u.top),new mxPoint(f,e)},getDocumentScrollOrigin:function(n){if(mxClient.IS_QUIRKS)return new mxPoint(n.body.scrollLeft,n.body.scrollTop);var t=n.defaultView||n.parentWindow,i=t!=null&&window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,r=t!=null&&window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return new mxPoint(i,r)},getScrollOrigin:function(n,t,i){var e,o;t=t!=null?t:!1;i=i!=null?i:!0;for(var u=n!=null?n.ownerDocument:document,s=u.body,h=u.documentElement,r=new mxPoint,f=!1;n!=null&&n!=s&&n!=h;)isNaN(n.scrollLeft)||isNaN(n.scrollTop)||(r.x+=n.scrollLeft,r.y+=n.scrollTop),e=mxUtils.getCurrentStyle(n),e!=null&&(f=f||e.position=="fixed"),n=t?n.parentNode:null;return!f&&i&&(o=mxUtils.getDocumentScrollOrigin(u),r.x+=o.x,r.y+=o.y),r},convertPoint:function(n,t,i){var u=mxUtils.getScrollOrigin(n,!1),r=mxUtils.getOffset(n);return r.x-=u.x,r.y-=u.y,new mxPoint(t-r.x,i-r.y)},ltrim:function(n,t){return t=t||"\\s",n!=null?n.replace(new RegExp("^["+t+"]+","g"),""):null},rtrim:function(n,t){return t=t||"\\s",n!=null?n.replace(new RegExp("["+t+"]+$","g"),""):null},trim:function(n,t){return mxUtils.ltrim(mxUtils.rtrim(n,t),t)},isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)&&(typeof n!="string"||n.toLowerCase().indexOf("0x")<0)},isInteger:function(n){return String(parseInt(n))===String(n)},mod:function(n,t){return(n%t+t)%t},intersection:function(n,t,i,r,u,f,e,o){var h=(o-f)*(i-n)-(e-u)*(r-t),v=(e-u)*(t-f)-(o-f)*(n-u),y=(i-n)*(t-f)-(r-t)*(n-u),s=v/h,c=y/h,l,a;return s>=0&&s<=1&&c>=0&&c<=1?(l=n+s*(i-n),a=t+s*(r-t),new mxPoint(l,a)):null},ptSegDistSq:function(n,t,i,r,u,f){var e,s,o;return i-=n,r-=t,u-=n,f-=t,e=u*i+f*r,e<=0?s=0:(u=i-u,f=r-f,e=u*i+f*r,s=e<=0?0:e*e/(i*i+r*r)),o=u*u+f*f-s,o<0&&(o=0),o},ptLineDist:function(n,t,i,r,u,f){return Math.abs((r-t)*u-(i-n)*f+i*t-r*n)/Math.sqrt((r-t)*(r-t)+(i-n)*(i-n))},relativeCcw:function(n,t,i,r,u,f){i-=n;r-=t;u-=n;f-=t;var e=u*r-f*i;return e==0&&(e=u*i+f*r,e>0&&(u-=i,f-=r,e=u*i+f*r,e<0&&(e=0))),e<0?-1:e>0?1:0},animateChanges:function(){mxEffects.animateChanges.apply(this,arguments)},cascadeOpacity:function(){mxEffects.cascadeOpacity.apply(this,arguments)},fadeOut:function(){mxEffects.fadeOut.apply(this,arguments)},setOpacity:function(n,t){mxUtils.isVml(n)?n.style.filter=t>=100?"":"alpha(opacity="+t/5+")":mxClient.IS_IE&&(typeof document.documentMode=="undefined"||document.documentMode<9)?n.style.filter=t>=100?"":"alpha(opacity="+t+")":n.style.opacity=t/100},createImage:function(n){var t=null;return mxClient.IS_IE6&&document.compatMode!="CSS1Compat"?(t=document.createElement(mxClient.VML_PREFIX+":image"),t.setAttribute("src",n),t.style.borderStyle="none"):(t=document.createElement("img"),t.setAttribute("src",n),t.setAttribute("border","0")),t},sortCells:function(n,t){t=t!=null?t:!0;var i=new mxDictionary;return n.sort(function(n,r){var f=i.get(n),u,e;return f==null&&(f=mxCellPath.create(n).split(mxCellPath.PATH_SEPARATOR),i.put(n,f)),u=i.get(r),u==null&&(u=mxCellPath.create(r).split(mxCellPath.PATH_SEPARATOR),i.put(r,u)),e=mxCellPath.compare(f,u),e==0?0:e>0==t?1:-1}),n},getStylename:function(n){if(n!=null){var i=n.split(";"),t=i[0];if(t.indexOf("=")<0)return t}return""},getStylenames:function(n){var r=[],i,t;if(n!=null)for(i=n.split(";"),t=0;t<i.length;t++)i[t].indexOf("=")<0&&r.push(i[t]);return r},indexOfStylename:function(n,t){var r,u,i;if(n!=null&&t!=null)for(r=n.split(";"),u=0,i=0;i<r.length;i++){if(r[i]==t)return u;u+=r[i].length+1}return-1},addStylename:function(n,t){return mxUtils.indexOfStylename(n,t)<0&&(n==null?n="":n.length>0&&n.charAt(n.length-1)!=";"&&(n+=";"),n+=t),n},removeStylename:function(n,t){var u=[],r,i;if(n!=null)for(r=n.split(";"),i=0;i<r.length;i++)r[i]!=t&&u.push(r[i]);return u.join(";")},removeAllStylenames:function(n){var r=[],i,t;if(n!=null)for(i=n.split(";"),t=0;t<i.length;t++)i[t].indexOf("=")>=0&&r.push(i[t]);return r.join(";")},setCellStyles:function(n,t,i,r){var u,f;if(t!=null&&t.length>0){n.beginUpdate();try{for(u=0;u<t.length;u++)t[u]!=null&&(f=mxUtils.setStyle(n.getStyle(t[u]),i,r),n.setStyle(t[u],f))}finally{n.endUpdate()}}},setStyle:function(n,t,i){var f=i!=null&&(typeof i.length=="undefined"||i.length>0),u,e,r;return n==null||n.length==0?f&&(n=t+"="+i+";"):n.substring(0,t.length+1)==t+"="?(r=n.indexOf(";"),n=f?t+"="+i+(r<0?";":n.substring(r)):r<0||r==n.length-1?"":n.substring(r+1)):(u=n.indexOf(";"+t+"="),u<0?f&&(e=n.charAt(n.length-1)==";"?"":";",n=n+e+t+"="+i+";"):(r=n.indexOf(";",u+1),n=f?n.substring(0,u+1)+t+"="+i+(r<0?";":n.substring(r)):n.substring(0,u)+(r<0?";":n.substring(r)))),n},setCellStyleFlags:function(n,t,i,r,u){var f,e;if(t!=null&&t.length>0){n.beginUpdate();try{for(f=0;f<t.length;f++)t[f]!=null&&(e=mxUtils.setStyleFlag(n.getStyle(t[f]),i,r,u),n.setStyle(t[f],e))}finally{n.endUpdate()}}},setStyleFlag:function(n,t,i,r){var f,o,e,u;return n==null||n.length==0?n=r||r==null?t+"="+i:t+"=0":(f=n.indexOf(t+"="),f<0?(o=n.charAt(n.length-1)==";"?"":";",n=r||r==null?n+o+t+"="+i:n+o+t+"=0"):(e=n.indexOf(";",f),u="",u=e<0?n.substring(f+t.length+1):n.substring(f+t.length+1,e),u=r==null?parseInt(u)^i:r?parseInt(u)|i:parseInt(u)&~i,n=n.substring(0,f)+t+"="+u+(e>=0?n.substring(e):""))),n},getAlignmentAsPoint:function(n,t){var i=0,r=0;return n==mxConstants.ALIGN_CENTER?i=-.5:n==mxConstants.ALIGN_RIGHT&&(i=-1),t==mxConstants.ALIGN_MIDDLE?r=-.5:t==mxConstants.ALIGN_BOTTOM&&(r=-1),new mxPoint(i,r)},getSizeForString:function(n,t,i,r){var u,f;return t=t!=null?t:mxConstants.DEFAULT_FONTSIZE,i=i!=null?i:mxConstants.DEFAULT_FONTFAMILY,u=document.createElement("div"),u.style.fontFamily=i,u.style.fontSize=Math.round(t)+"px",u.style.lineHeight=Math.round(t*mxConstants.LINE_HEIGHT)+"px",u.style.position="absolute",u.style.visibility="hidden",u.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",u.style.zoom="1",r!=null?(u.style.width=r+"px",u.style.whiteSpace="normal"):u.style.whiteSpace="nowrap",u.innerHTML=n,document.body.appendChild(u),f=new mxRectangle(0,0,u.offsetWidth,u.offsetHeight),document.body.removeChild(u),f},getViewXml:function(n,t,i,r,u){var e,s,h,c,l,a;r=r!=null?r:0;u=u!=null?u:0;t=t!=null?t:1;i==null&&(e=n.getModel(),i=[e.getRoot()]);var f=n.getView(),o=null,v=f.isEventsEnabled();f.setEventsEnabled(!1);s=f.drawPane;h=f.overlayPane;n.dialect==mxConstants.DIALECT_SVG?(f.drawPane=document.createElementNS(mxConstants.NS_SVG,"g"),f.canvas.appendChild(f.drawPane),f.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g"),f.canvas.appendChild(f.overlayPane)):(f.drawPane=f.drawPane.cloneNode(!1),f.canvas.appendChild(f.drawPane),f.overlayPane=f.overlayPane.cloneNode(!1),f.canvas.appendChild(f.overlayPane));c=f.getTranslate();f.translate=new mxPoint(r,u);l=new mxTemporaryCellStates(n.getView(),t,i);try{a=new mxCodec;o=a.encode(n.getView())}finally{l.destroy();f.translate=c;f.canvas.removeChild(f.drawPane);f.canvas.removeChild(f.overlayPane);f.drawPane=s;f.overlayPane=h;f.setEventsEnabled(v)}return o},getScaleForPageCount:function(n,t,i,r){var c,l,o,s,e,k;if(n<1)return 1;i=i!=null?i:mxConstants.PAGE_FORMAT_A4_PORTRAIT;r=r!=null?r:0;var a=i.width-r*2,d=i.height-r*2,h=t.getGraphBounds().clone(),v=t.getView().getScale();h.width/=v;h.height/=v;var y=h.width,g=h.height,p=1,nt=a/d,tt=y/g,it=tt/nt,w=Math.sqrt(n),b=Math.sqrt(it),u=w*b,f=w/b;for(u<1&&f>n&&(e=f/n,f=n,u/=e),f<1&&u>n&&(e=u/n,u=n,f/=e),c=Math.ceil(u)*Math.ceil(f),l=0;c>n;)if(o=Math.floor(u)/u,s=Math.floor(f)/f,o==1&&(o=Math.floor(u-1)/u),s==1&&(s=Math.floor(f-1)/f),e=1,e=o>s?o:s,u=u*e,f=f*e,c=Math.ceil(u)*Math.ceil(f),l++,l>10)break;return k=a*u,p=k/y,p*.99999},show:function(n,t,i,r,u,f){var d,o,l,b,k,e,h,c,a,v,y;i=i!=null?i:0;r=r!=null?r:0;t==null?(d=window.open(),t=d.document):t.open();document.documentMode==9&&t.writeln('<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=9"><![endif]-->');var s=n.getGraphBounds(),p=Math.ceil(i-s.x),w=Math.ceil(r-s.y);if(u==null&&(u=Math.ceil(s.width+i)+Math.ceil(Math.ceil(s.x)-s.x)),f==null&&(f=Math.ceil(s.height+r)+Math.ceil(Math.ceil(s.y)-s.y)),mxClient.IS_IE||document.documentMode==11){for(o="<html><head>",l=document.getElementsByTagName("base"),e=0;e<l.length;e++)o+=l[e].outerHTML;for(o+="<style>",e=0;e<document.styleSheets.length;e++)try{o+=document.styleSheets[e].cssText}catch(g){}o+='<\/style><\/head><body style="margin:0px;">';o+='<div style="position:absolute;overflow:hidden;width:'+u+"px;height:"+f+'px;"><div style="position:relative;left:'+p+"px;top:"+w+'px;">';o+=n.container.innerHTML;o+="<\/div><\/div><\/body><html>";t.writeln(o);t.close()}else{for(t.writeln("<html><head>"),l=document.getElementsByTagName("base"),e=0;e<l.length;e++)t.writeln(mxUtils.getOuterHtml(l[e]));for(b=document.getElementsByTagName("link"),e=0;e<b.length;e++)t.writeln(mxUtils.getOuterHtml(b[e]));for(k=document.getElementsByTagName("style"),e=0;e<k.length;e++)t.writeln(mxUtils.getOuterHtml(k[e]));for(t.writeln('<\/head><body style="margin:0px;"><\/body><\/html>'),t.close(),h=t.createElement("div"),h.position="absolute",h.overflow="hidden",h.style.width=u+"px",h.style.height=f+"px",c=t.createElement("div"),c.style.position="absolute",c.style.left=p+"px",c.style.top=w+"px",a=n.container.firstChild,v=null;a!=null;)y=a.cloneNode(!0),a==n.view.drawPane.ownerSVGElement?(h.appendChild(y),v=y):c.appendChild(y),a=a.nextSibling;t.body.appendChild(h);c.firstChild!=null&&t.body.appendChild(c);v!=null&&(v.style.minWidth="",v.style.minHeight="",v.firstChild.setAttribute("transform","translate("+p+","+w+")"))}return mxUtils.removeCursors(t.body),t},printScreen:function(n){var t=window.open(),r=n.getGraphBounds(),i;mxUtils.show(n,t.document);i=function(){t.focus();t.print();t.close()};mxClient.IS_GC?t.setTimeout(i,500):i()},popup:function(n,t){var r,i,u;if(t){r=document.createElement("div");r.style.overflow="scroll";r.style.width="636px";r.style.height="460px";u=document.createElement("pre");u.innerHTML=mxUtils.htmlEntities(n,!1).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");r.appendChild(u);var f=document.body.clientWidth,e=Math.max(document.body.clientHeight||0,document.documentElement.clientHeight),i=new mxWindow("Popup Window",r,f/2-320,e/2-240,640,480,!1,!0);i.setClosable(!0);i.setVisible(!0)}else mxClient.IS_NS?(i=window.open(),i.document.writeln("<pre>"+mxUtils.htmlEntities(n)+"<\/pre"),i.document.close()):(i=window.open(),u=i.document.createElement("pre"),u.innerHTML=mxUtils.htmlEntities(n,!1).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),i.document.body.appendChild(u))},alert:function(n){alert(n)},prompt:function(n,t){return prompt(n,t!=null?t:"")},confirm:function(n){return confirm(n)},error:function(n,t,i,r){var u=document.createElement("div"),e,s,f;u.style.padding="20px";e=document.createElement("img");e.setAttribute("src",r||mxUtils.errorImage);e.setAttribute("valign","bottom");e.style.verticalAlign="middle";u.appendChild(e);u.appendChild(document.createTextNode(" "));u.appendChild(document.createTextNode(" "));u.appendChild(document.createTextNode(" "));mxUtils.write(u,n);var h=document.body.clientWidth,c=document.body.clientHeight||document.documentElement.clientHeight,o=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,u,(h-t)/2,c/4,t,null,!1,!0);return i&&(mxUtils.br(u),s=document.createElement("p"),f=document.createElement("button"),mxClient.IS_IE?f.style.cssText="float:right":f.setAttribute("style","float:right"),mxEvent.addListener(f,"click",function(){o.destroy()}),mxUtils.write(f,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource),s.appendChild(f),u.appendChild(s),mxUtils.br(u),o.setClosable(!0)),o.setVisible(!0),o},makeDraggable:function(n,t,i,r,u,f,e,o,s,h){var c=new mxDragSource(n,i);return c.dragOffset=new mxPoint(u!=null?u:0,f!=null?f:mxConstants.TOOLTIP_VERTICAL_OFFSET),c.autoscroll=e,c.setGuidesEnabled(!1),s!=null&&(c.highlightDropTargets=s),h!=null&&(c.getDropTarget=h),c.getGraphForEvent=function(n){return typeof t=="function"?t(n):t},r!=null&&(c.createDragElement=function(){return r.cloneNode(!0)},o&&(c.createPreviewElement=function(n){var t=r.cloneNode(!0),i=parseInt(t.style.width),u=parseInt(t.style.height);return t.style.width=Math.round(i*n.view.scale)+"px",t.style.height=Math.round(u*n.view.scale)+"px",t})),c}},mxConstants={DEFAULT_HOTSPOT:.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,RENDERING_HINT_EXACT:"exact",RENDERING_HINT_FASTER:"faster",RENDERING_HINT_FASTEST:"fastest",DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SHADOWCOLOR:"gray",VML_SHADOWCOLOR:"gray",SHADOW_OFFSET_X:2,SHADOW_OFFSET_Y:3,SHADOW_OPACITY:1,NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",OUTLINE_HIGHLIGHT_COLOR:"#00FF00",OUTLINE_HIGHLIGHT_STROKEWIDTH:5,HIGHLIGHT_STROKEWIDTH:3,HIGHLIGHT_SIZE:2,HIGHLIGHT_OPACITY:100,CURSOR_MOVABLE_VERTEX:"move",CURSOR_MOVABLE_EDGE:"move",CURSOR_LABEL_HANDLE:"default",CURSOR_TERMINAL_HANDLE:"pointer",CURSOR_BEND_HANDLE:"crosshair",CURSOR_VIRTUAL_BEND_HANDLE:"crosshair",CURSOR_CONNECT:"pointer",HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",EDGE_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:!0,EDGE_SELECTION_DASHED:!0,GUIDE_COLOR:"#FF0000",GUIDE_STROKEWIDTH:1,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:mxClient.IS_IE?2:3,HANDLE_SIZE:6,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",LOCKED_HANDLE_FILLCOLOR:"#FF0000",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,DEFAULT_TEXT_DIRECTION:"",LINE_HEIGHT:1.2,WORD_WRAP:"normal",ABSOLUTE_LINE_HEIGHT:!1,DEFAULT_FONTSTYLE:0,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:.15,LINE_ARCSIZE:20,ARROW_SPACING:0,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,827,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,0,1169,827),PAGE_FORMAT_LETTER_PORTRAIT:new mxRectangle(0,0,850,1100),PAGE_FORMAT_LETTER_LANDSCAPE:new mxRectangle(0,0,1100,850),NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_SOURCE_PORT:"sourcePort",STYLE_TARGET_PORT:"targetPort",STYLE_PORT_CONSTRAINT:"portConstraint",STYLE_PORT_CONSTRAINT_ROTATION:"portConstraintRotation",STYLE_SOURCE_PORT_CONSTRAINT:"sourcePortConstraint",STYLE_TARGET_PORT_CONSTRAINT:"targetPortConstraint",STYLE_OPACITY:"opacity",STYLE_FILL_OPACITY:"fillOpacity",STYLE_STROKE_OPACITY:"strokeOpacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_TEXT_DIRECTION:"textDirection",STYLE_OVERFLOW:"overflow",STYLE_ORTHOGONAL:"orthogonal",STYLE_EXIT_X:"exitX",STYLE_EXIT_Y:"exitY",STYLE_EXIT_PERIMETER:"exitPerimeter",STYLE_ENTRY_X:"entryX",STYLE_ENTRY_Y:"entryY",STYLE_ENTRY_PERIMETER:"entryPerimeter",STYLE_WHITE_SPACE:"whiteSpace",STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_POINTER_EVENTS:"pointerEvents",STYLE_SWIMLANE_FILLCOLOR:"swimlaneFillColor",STYLE_MARGIN:"margin",STYLE_GRADIENTCOLOR:"gradientColor",STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_WIDTH:"labelWidth",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ASPECT:"imageAspect",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",STYLE_GLASS:"glass",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_IMAGE_BACKGROUND:"imageBackground",STYLE_IMAGE_BORDER:"imageBorder",STYLE_FLIPH:"flipH",STYLE_FLIPV:"flipV",STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_LABEL_PADDING:"labelPadding",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_INDICATOR_DIRECTION:"indicatorDirection",STYLE_SHADOW:"shadow",STYLE_SEGMENT:"segment",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_SWIMLANE_LINE:"swimlaneLine",STYLE_ENDFILL:"endFill",STYLE_STARTFILL:"startFill",STYLE_DASHED:"dashed",STYLE_DASH_PATTERN:"dashPattern",STYLE_FIX_DASH:"fixDash",STYLE_ROUNDED:"rounded",STYLE_CURVED:"curved",STYLE_ARCSIZE:"arcSize",STYLE_ABSOLUTE_ARCSIZE:"absoluteArcSize",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_ASPECT:"aspect",STYLE_AUTOSIZE:"autosize",STYLE_FOLDABLE:"foldable",STYLE_EDITABLE:"editable",STYLE_BENDABLE:"bendable",STYLE_MOVABLE:"movable",STYLE_RESIZABLE:"resizable",STYLE_RESIZE_WIDTH:"resizeWidth",STYLE_RESIZE_HEIGHT:"resizeHeight",STYLE_ROTATABLE:"rotatable",STYLE_CLONEABLE:"cloneable",STYLE_DELETABLE:"deletable",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_JETTY_SIZE:"jettySize",STYLE_SOURCE_JETTY_SIZE:"sourceJettySize",STYLE_TARGET_JETTY_SIZE:"targetJettySize",STYLE_LOOP:"loopStyle",STYLE_ORTHOGONAL_LOOP:"orthogonalLoop",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_ARROW_CONNECTOR:"arrowConnector",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_CLASSIC_THIN:"classicThin",ARROW_BLOCK:"block",ARROW_BLOCK_THIN:"blockThin",ARROW_OPEN:"open",ARROW_OPEN_THIN:"openThin",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",ARROW_DIAMOND_THIN:"diamondThin",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",TEXT_DIRECTION_DEFAULT:"",TEXT_DIRECTION_AUTO:"auto",TEXT_DIRECTION_LTR:"ltr",TEXT_DIRECTION_RTL:"rtl",DIRECTION_MASK_NONE:0,DIRECTION_MASK_WEST:1,DIRECTION_MASK_NORTH:2,DIRECTION_MASK_SOUTH:4,DIRECTION_MASK_EAST:8,DIRECTION_MASK_ALL:15,ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal",EDGESTYLE_ELBOW:"elbowEdgeStyle",EDGESTYLE_ENTITY_RELATION:"entityRelationEdgeStyle",EDGESTYLE_LOOP:"loopEdgeStyle",EDGESTYLE_SIDETOSIDE:"sideToSideEdgeStyle",EDGESTYLE_TOPTOBOTTOM:"topToBottomEdgeStyle",EDGESTYLE_ORTHOGONAL:"orthogonalEdgeStyle",EDGESTYLE_SEGMENT:"segmentEdgeStyle",PERIMETER_ELLIPSE:"ellipsePerimeter",PERIMETER_RECTANGLE:"rectanglePerimeter",PERIMETER_RHOMBUS:"rhombusPerimeter",PERIMETER_HEXAGON:"hexagonPerimeter",PERIMETER_TRIANGLE:"trianglePerimeter"};mxEventObject.prototype.name=null;mxEventObject.prototype.properties=null;mxEventObject.prototype.consumed=!1;mxEventObject.prototype.getName=function(){return this.name};mxEventObject.prototype.getProperties=function(){return this.properties};mxEventObject.prototype.getProperty=function(n){return this.properties[n]};mxEventObject.prototype.isConsumed=function(){return this.consumed};mxEventObject.prototype.consume=function(){this.consumed=!0};mxMouseEvent.prototype.consumed=!1;mxMouseEvent.prototype.evt=null;mxMouseEvent.prototype.graphX=null;mxMouseEvent.prototype.graphY=null;mxMouseEvent.prototype.state=null;mxMouseEvent.prototype.sourceState=null;mxMouseEvent.prototype.getEvent=function(){return this.evt};mxMouseEvent.prototype.getSource=function(){return mxEvent.getSource(this.evt)};mxMouseEvent.prototype.isSource=function(n){return n!=null?mxUtils.isAncestorNode(n.node,this.getSource()):!1};mxMouseEvent.prototype.getX=function(){return mxEvent.getClientX(this.getEvent())};mxMouseEvent.prototype.getY=function(){return mxEvent.getClientY(this.getEvent())};mxMouseEvent.prototype.getGraphX=function(){return this.graphX};mxMouseEvent.prototype.getGraphY=function(){return this.graphY};mxMouseEvent.prototype.getState=function(){return this.state};mxMouseEvent.prototype.getCell=function(){var n=this.getState();return n!=null?n.cell:null};mxMouseEvent.prototype.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent())};mxMouseEvent.prototype.isConsumed=function(){return this.consumed};mxMouseEvent.prototype.consume=function(n){n=n!=null?n:!0;n&&this.evt.preventDefault&&this.evt.preventDefault();mxClient.IS_IE&&(this.evt.returnValue=!0);this.consumed=!0};mxEventSource.prototype.eventListeners=null;mxEventSource.prototype.eventsEnabled=!0;mxEventSource.prototype.eventSource=null;mxEventSource.prototype.isEventsEnabled=function(){return this.eventsEnabled};mxEventSource.prototype.setEventsEnabled=function(n){this.eventsEnabled=n};mxEventSource.prototype.getEventSource=function(){return this.eventSource};mxEventSource.prototype.setEventSource=function(n){this.eventSource=n};mxEventSource.prototype.addListener=function(n,t){this.eventListeners==null&&(this.eventListeners=[]);this.eventListeners.push(n);this.eventListeners.push(t)};mxEventSource.prototype.removeListener=function(n){if(this.eventListeners!=null)for(var t=0;t<this.eventListeners.length;)this.eventListeners[t+1]==n?this.eventListeners.splice(t,2):t+=2};mxEventSource.prototype.fireEvent=function(n,t){var u,i,r;if(this.eventListeners!=null&&this.isEventsEnabled())for(n==null&&(n=new mxEventObject),t==null&&(t=this.getEventSource()),t==null&&(t=this),u=[t,n],i=0;i<this.eventListeners.length;i+=2)r=this.eventListeners[i],(r==null||r==n.getName())&&this.eventListeners[i+1].apply(this,u)};mxEvent={objects:[],addListener:function(){var n=function(n,t,i){n.mxListenerList==null&&(n.mxListenerList=[],mxEvent.objects.push(n));var r={name:t,f:i};n.mxListenerList.push(r)};return window.addEventListener?function(t,i,r){t.addEventListener(i,r,!1);n(t,i,r)}:function(t,i,r){t.attachEvent("on"+i,r);n(t,i,r)}}(),removeListener:function(){var n=function(n,t,i){var f,r,e,u;if(n.mxListenerList!=null){for(f=n.mxListenerList.length,r=0;r<f;r++)if(e=n.mxListenerList[r],e.f==i){n.mxListenerList.splice(r,1);break}n.mxListenerList.length==0&&(n.mxListenerList=null,u=mxUtils.indexOf(mxEvent.objects,n),u>=0&&mxEvent.objects.splice(u,1))}};return window.removeEventListener?function(t,i,r){t.removeEventListener(i,r,!1);n(t,i,r)}:function(t,i,r){t.detachEvent("on"+i,r);n(t,i,r)}}(),removeAllListeners:function(n){var t=n.mxListenerList,i;if(t!=null)while(t.length>0)i=t[0],mxEvent.removeListener(n,i.name,i.f)},addGestureListeners:function(n,t,i,r){t!=null&&mxEvent.addListener(n,mxClient.IS_POINTER?"pointerdown":"mousedown",t);i!=null&&mxEvent.addListener(n,mxClient.IS_POINTER?"pointermove":"mousemove",i);r!=null&&mxEvent.addListener(n,mxClient.IS_POINTER?"pointerup":"mouseup",r);!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(t!=null&&mxEvent.addListener(n,"touchstart",t),i!=null&&mxEvent.addListener(n,"touchmove",i),r!=null&&mxEvent.addListener(n,"touchend",r))},removeGestureListeners:function(n,t,i,r){t!=null&&mxEvent.removeListener(n,mxClient.IS_POINTER?"pointerdown":"mousedown",t);i!=null&&mxEvent.removeListener(n,mxClient.IS_POINTER?"pointermove":"mousemove",i);r!=null&&mxEvent.removeListener(n,mxClient.IS_POINTER?"pointerup":"mouseup",r);!mxClient.IS_POINTER&&mxClient.IS_TOUCH&&(t!=null&&mxEvent.removeListener(n,"touchstart",t),i!=null&&mxEvent.removeListener(n,"touchmove",i),r!=null&&mxEvent.removeListener(n,"touchend",r))},redirectMouseEvents:function(n,t,i,r,u,f,e){var o=function(n){return typeof i=="function"?i(n):i};mxEvent.addGestureListeners(n,function(n){r!=null?r(n):mxEvent.isConsumed(n)||t.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n,o(n)))},function(n){u!=null?u(n):mxEvent.isConsumed(n)||t.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n,o(n)))},function(n){f!=null?f(n):mxEvent.isConsumed(n)||t.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n,o(n)))});mxEvent.addListener(n,"dblclick",function(n){if(e!=null)e(n);else if(!mxEvent.isConsumed(n)){var i=o(n);t.dblClick(n,i!=null?i.cell:null)}})},release:function(n){var t,r,i;if(n!=null&&(mxEvent.removeAllListeners(n),t=n.childNodes,t!=null))for(r=t.length,i=0;i<r;i+=1)mxEvent.release(t[i])},addMouseWheelListener:function(n){var t,i;n!=null&&(t=function(t){t==null&&(t=window.event);var i=0;i=mxClient.IS_FF?-t.detail/2:t.wheelDelta/120;i!=0&&n(t,i>0)},mxClient.IS_NS&&document.documentMode==null?(i=mxClient.IS_SF||mxClient.IS_GC?"mousewheel":"DOMMouseScroll",mxEvent.addListener(window,i,t)):mxEvent.addListener(document,"mousewheel",t))},disableContextMenu:function(n){mxEvent.addListener(n,"contextmenu",function(n){return n.preventDefault&&n.preventDefault(),!1})},getSource:function(n){return n.srcElement!=null?n.srcElement:n.target},isConsumed:function(n){return n.isConsumed!=null&&n.isConsumed},isTouchEvent:function(n){return n.pointerType!=null?n.pointerType=="touch"||n.pointerType===n.MSPOINTER_TYPE_TOUCH:n.mozInputSource!=null?n.mozInputSource==5:n.type.indexOf("touch")==0},isPenEvent:function(n){return n.pointerType!=null?n.pointerType=="pen"||n.pointerType===n.MSPOINTER_TYPE_PEN:n.mozInputSource!=null?n.mozInputSource==2:n.type.indexOf("pen")==0},isMultiTouchEvent:function(n){return n.type!=null&&n.type.indexOf("touch")==0&&n.touches!=null&&n.touches.length>1},isMouseEvent:function(n){return n.pointerType!=null?n.pointerType=="mouse"||n.pointerType===n.MSPOINTER_TYPE_MOUSE:n.mozInputSource!=null?n.mozInputSource==1:n.type.indexOf("mouse")==0},isLeftMouseButton:function(n){return"buttons"in n&&(n.type=="mousedown"||n.type=="mousemove")?n.buttons==1:"which"in n?n.which===1:n.button===1},isMiddleMouseButton:function(n){return"which"in n?n.which===2:n.button===4},isRightMouseButton:function(n){return"which"in n?n.which===3:n.button===2},isPopupTrigger:function(n){return mxEvent.isRightMouseButton(n)||mxClient.IS_MAC&&mxEvent.isControlDown(n)&&!mxEvent.isShiftDown(n)&&!mxEvent.isMetaDown(n)&&!mxEvent.isAltDown(n)},isShiftDown:function(n){return n!=null?n.shiftKey:!1},isAltDown:function(n){return n!=null?n.altKey:!1},isControlDown:function(n){return n!=null?n.ctrlKey:!1},isMetaDown:function(n){return n!=null?n.metaKey:!1},getMainEvent:function(n){return(n.type=="touchstart"||n.type=="touchmove")&&n.touches!=null&&n.touches[0]!=null?n=n.touches[0]:n.type=="touchend"&&n.changedTouches!=null&&n.changedTouches[0]!=null&&(n=n.changedTouches[0]),n},getClientX:function(n){return mxEvent.getMainEvent(n).clientX},getClientY:function(n){return mxEvent.getMainEvent(n).clientY},consume:function(n,t,i){t=t!=null?t:!0;i=i!=null?i:!0;t&&(n.preventDefault?(i&&n.stopPropagation(),n.preventDefault()):i&&(n.cancelBubble=!0));n.isConsumed=!0;n.preventDefault||(n.returnValue=!1)},LABEL_HANDLE:-1,ROTATION_HANDLE:-2,CUSTOM_HANDLE:-100,VIRTUAL_HANDLE:-1e5,MOUSE_DOWN:"mouseDown",MOUSE_MOVE:"mouseMove",MOUSE_UP:"mouseUp",ACTIVATE:"activate",RESIZE_START:"resizeStart",RESIZE:"resize",RESIZE_END:"resizeEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",PAN_START:"panStart",PAN:"pan",PAN_END:"panEnd",MINIMIZE:"minimize",NORMALIZE:"normalize",MAXIMIZE:"maximize",HIDE:"hide",SHOW:"show",CLOSE:"close",DESTROY:"destroy",REFRESH:"refresh",SIZE:"size",SELECT:"select",FIRED:"fired",FIRE_MOUSE_EVENT:"fireMouseEvent",GESTURE:"gesture",TAP_AND_HOLD:"tapAndHold",GET:"get",RECEIVE:"receive",CONNECT:"connect",DISCONNECT:"disconnect",SUSPEND:"suspend",RESUME:"resume",MARK:"mark",ROOT:"root",POST:"post",OPEN:"open",SAVE:"save",BEFORE_ADD_VERTEX:"beforeAddVertex",ADD_VERTEX:"addVertex",AFTER_ADD_VERTEX:"afterAddVertex",DONE:"done",EXECUTE:"execute",EXECUTED:"executed",BEGIN_UPDATE:"beginUpdate",START_EDIT:"startEdit",END_UPDATE:"endUpdate",END_EDIT:"endEdit",BEFORE_UNDO:"beforeUndo",UNDO:"undo",REDO:"redo",CHANGE:"change",NOTIFY:"notify",LAYOUT_CELLS:"layoutCells",CLICK:"click",SCALE:"scale",TRANSLATE:"translate",SCALE_AND_TRANSLATE:"scaleAndTranslate",UP:"up",DOWN:"down",ADD:"add",REMOVE:"remove",CLEAR:"clear",ADD_CELLS:"addCells",CELLS_ADDED:"cellsAdded",MOVE_CELLS:"moveCells",CELLS_MOVED:"cellsMoved",RESIZE_CELLS:"resizeCells",CELLS_RESIZED:"cellsResized",TOGGLE_CELLS:"toggleCells",CELLS_TOGGLED:"cellsToggled",ORDER_CELLS:"orderCells",CELLS_ORDERED:"cellsOrdered",REMOVE_CELLS:"removeCells",CELLS_REMOVED:"cellsRemoved",GROUP_CELLS:"groupCells",UNGROUP_CELLS:"ungroupCells",REMOVE_CELLS_FROM_PARENT:"removeCellsFromParent",FOLD_CELLS:"foldCells",CELLS_FOLDED:"cellsFolded",ALIGN_CELLS:"alignCells",LABEL_CHANGED:"labelChanged",CONNECT_CELL:"connectCell",CELL_CONNECTED:"cellConnected",SPLIT_EDGE:"splitEdge",FLIP_EDGE:"flipEdge",START_EDITING:"startEditing",EDITING_STARTED:"editingStarted",EDITING_STOPPED:"editingStopped",ADD_OVERLAY:"addOverlay",REMOVE_OVERLAY:"removeOverlay",UPDATE_CELL_SIZE:"updateCellSize",ESCAPE:"escape",DOUBLE_CLICK:"doubleClick",START:"start",RESET:"reset"};mxXmlRequest.prototype.url=null;mxXmlRequest.prototype.params=null;mxXmlRequest.prototype.method=null;mxXmlRequest.prototype.async=null;mxXmlRequest.prototype.binary=!1;mxXmlRequest.prototype.withCredentials=!1;mxXmlRequest.prototype.username=null;mxXmlRequest.prototype.password=null;mxXmlRequest.prototype.request=null;mxXmlRequest.prototype.decodeSimulateValues=!1;mxXmlRequest.prototype.isBinary=function(){return this.binary};mxXmlRequest.prototype.setBinary=function(n){this.binary=n};mxXmlRequest.prototype.getText=function(){return this.request.responseText};mxXmlRequest.prototype.isReady=function(){return this.request.readyState==4};mxXmlRequest.prototype.getDocumentElement=function(){var n=this.getXml();return n!=null?n.documentElement:null};mxXmlRequest.prototype.getXml=function(){var n=this.request.responseXML;return(document.documentMode>=9||n==null||n.documentElement==null)&&(n=mxUtils.parseXml(this.request.responseText)),n};mxXmlRequest.prototype.getText=function(){return this.request.responseText};mxXmlRequest.prototype.getStatus=function(){return this.request.status};mxXmlRequest.prototype.create=function(){return window.XMLHttpRequest?function(){var n=new XMLHttpRequest;return this.isBinary()&&n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n}:typeof ActiveXObject!="undefined"?function(){return new ActiveXObject("Microsoft.XMLHTTP")}:void 0}();mxXmlRequest.prototype.send=function(n,t,i,r){this.request=this.create();this.request!=null&&(n!=null&&(this.request.onreadystatechange=mxUtils.bind(this,function(){this.isReady()&&(n(this),this.onreadystatechaange=null)})),this.request.open(this.method,this.url,this.async,this.username,this.password),this.setRequestHeaders(this.request,this.params),window.XMLHttpRequest&&this.withCredentials&&(this.request.withCredentials="true"),!mxClient.IS_QUIRKS&&(document.documentMode==null||document.documentMode>9)&&window.XMLHttpRequest&&i!=null&&r!=null&&(this.request.timeout=i,this.request.ontimeout=r),this.request.send(this.params))};mxXmlRequest.prototype.setRequestHeaders=function(n,t){t!=null&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded")};mxXmlRequest.prototype.simulate=function(n,t){var e,i,u,r,o,h,s,f;for(n=n||document,e=null,n==document&&(e=window.onbeforeunload,window.onbeforeunload=null),i=n.createElement("form"),i.setAttribute("method",this.method),i.setAttribute("action",this.url),t!=null&&i.setAttribute("target",t),i.style.display="none",i.style.visibility="hidden",u=this.params.indexOf("&")>0?this.params.split("&"):this.params.split(),r=0;r<u.length;r++)o=u[r].indexOf("="),o>0&&(h=u[r].substring(0,o),s=u[r].substring(o+1),this.decodeSimulateValues&&(s=decodeURIComponent(s)),f=n.createElement("textarea"),f.setAttribute("wrap","off"),f.setAttribute("name",h),mxUtils.write(f,s),i.appendChild(f));n.body.appendChild(i);i.submit();i.parentNode!=null&&i.parentNode.removeChild(i);e!=null&&(window.onbeforeunload=e)};mxClipboard={STEPSIZE:10,insertCount:1,cells:null,setCells:function(n){mxClipboard.cells=n},getCells:function(){return mxClipboard.cells},isEmpty:function(){return mxClipboard.getCells()==null},cut:function(n,t){return t=mxClipboard.copy(n,t),mxClipboard.insertCount=0,mxClipboard.removeCells(n,t),t},removeCells:function(n,t){n.removeCells(t)},copy:function(n,t){t=t||n.getSelectionCells();var i=n.getExportableCells(n.model.getTopmostCells(t));return mxClipboard.insertCount=1,mxClipboard.setCells(n.cloneCells(i)),i},paste:function(n){var t=null,i,r;return mxClipboard.isEmpty()||(t=n.getImportableCells(mxClipboard.getCells()),i=mxClipboard.insertCount*mxClipboard.STEPSIZE,r=n.getDefaultParent(),t=n.importCells(t,i,i,r),mxClipboard.insertCount++,n.setSelectionCells(t)),t}};mxWindow.prototype=new mxEventSource;mxWindow.prototype.constructor=mxWindow;mxWindow.prototype.closeImage=mxClient.imageBasePath+"/close.gif";mxWindow.prototype.minimizeImage=mxClient.imageBasePath+"/minimize.gif";mxWindow.prototype.normalizeImage=mxClient.imageBasePath+"/normalize.gif";mxWindow.prototype.maximizeImage=mxClient.imageBasePath+"/maximize.gif";mxWindow.prototype.resizeImage=mxClient.imageBasePath+"/resize.gif";mxWindow.prototype.visible=!1;mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40);mxWindow.prototype.destroyOnClose=!0;mxWindow.prototype.contentHeightCorrection=document.documentMode==8||document.documentMode==7?6:2;mxWindow.prototype.title=null;mxWindow.prototype.content=null;mxWindow.prototype.init=function(n,t,i,r,u){var e,f,o;u=u!=null?u:"mxWindow";this.div=document.createElement("div");this.div.className=u;this.div.style.left=n+"px";this.div.style.top=t+"px";this.table=document.createElement("table");this.table.className=u;mxClient.IS_POINTER&&(this.div.style.touchAction="none");i!=null&&(mxClient.IS_QUIRKS||(this.div.style.width=i+"px"),this.table.style.width=i+"px");r!=null&&(mxClient.IS_QUIRKS||(this.div.style.height=r+"px"),this.table.style.height=r+"px");e=document.createElement("tbody");f=document.createElement("tr");this.title=document.createElement("td");this.title.className=u+"Title";this.buttons=document.createElement("div");this.buttons.style.position="absolute";this.buttons.style.display="inline-block";this.buttons.style.right="4px";this.buttons.style.top="5px";this.title.appendChild(this.buttons);f.appendChild(this.title);e.appendChild(f);f=document.createElement("tr");this.td=document.createElement("td");this.td.className=u+"Pane";document.documentMode==7&&(this.td.style.height="100%");this.contentWrapper=document.createElement("div");this.contentWrapper.className=u+"Pane";this.contentWrapper.style.width="100%";this.contentWrapper.appendChild(this.content);(mxClient.IS_QUIRKS||this.content.nodeName.toUpperCase()!="DIV")&&(this.contentWrapper.style.height="100%");this.td.appendChild(this.contentWrapper);f.appendChild(this.td);e.appendChild(f);this.table.appendChild(e);this.div.appendChild(this.table);o=mxUtils.bind(this,function(){this.activate()});mxEvent.addGestureListeners(this.title,o);mxEvent.addGestureListeners(this.table,o);this.hide()};mxWindow.prototype.setTitle=function(n){for(var t=this.title.firstChild,i;t!=null;)i=t.nextSibling,t.nodeType==mxConstants.NODETYPE_TEXT&&t.parentNode.removeChild(t),t=i;mxUtils.write(this.title,n||"");this.title.appendChild(this.buttons)};mxWindow.prototype.setScrollable=function(n){navigator.userAgent.indexOf("Presto/2.5")<0&&(this.contentWrapper.style.overflow=n?"auto":"hidden")};mxWindow.prototype.activate=function(){var t,i,n,r;mxWindow.activeWindow!=this&&(t=mxUtils.getCurrentStyle(this.getElement()),i=t!=null?t.zIndex:3,mxWindow.activeWindow&&(n=mxWindow.activeWindow.getElement(),n!=null&&n.style!=null&&(n.style.zIndex=i)),r=mxWindow.activeWindow,this.getElement().style.zIndex=parseInt(i)+1,mxWindow.activeWindow=this,this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,"previousWindow",r)))};mxWindow.prototype.getElement=function(){return this.div};mxWindow.prototype.fit=function(){mxUtils.fit(this.div)};mxWindow.prototype.isResizable=function(){return this.resize!=null?this.resize.style.display!="none":!1};mxWindow.prototype.setResizable=function(n){if(n)if(this.resize==null){this.resize=document.createElement("img");this.resize.style.position="absolute";this.resize.style.bottom="2px";this.resize.style.right="2px";this.resize.setAttribute("src",this.resizeImage);this.resize.style.cursor="nw-resize";var t=null,i=null,f=null,e=null,o=mxUtils.bind(this,function(n){this.activate();t=mxEvent.getClientX(n);i=mxEvent.getClientY(n);f=this.div.offsetWidth;e=this.div.offsetHeight;mxEvent.addGestureListeners(document,null,r,u);this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,"event",n));mxEvent.consume(n)}),r=mxUtils.bind(this,function(n){if(t!=null&&i!=null){var r=mxEvent.getClientX(n)-t,u=mxEvent.getClientY(n)-i;this.setSize(f+r,e+u);this.fireEvent(new mxEventObject(mxEvent.RESIZE,"event",n));mxEvent.consume(n)}}),u=mxUtils.bind(this,function(n){t!=null&&i!=null&&(t=null,i=null,mxEvent.removeGestureListeners(document,null,r,u),this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,"event",n)),mxEvent.consume(n))});mxEvent.addGestureListeners(this.resize,o,r,u);this.div.appendChild(this.resize)}else this.resize.style.display="inline";else this.resize!=null&&(this.resize.style.display="none")};mxWindow.prototype.setSize=function(n,t){n=Math.max(this.minimumSize.width,n);t=Math.max(this.minimumSize.height,t);mxClient.IS_QUIRKS||(this.div.style.width=n+"px",this.div.style.height=t+"px");this.table.style.width=n+"px";this.table.style.height=t+"px";mxClient.IS_QUIRKS||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-this.contentHeightCorrection+"px")};mxWindow.prototype.setMinimizable=function(n){this.minimize.style.display=n?"":"none"};mxWindow.prototype.getMinimumSize=function(){return new mxRectangle(0,0,0,this.title.offsetHeight)};mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement("img");this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("title","Minimize");this.minimize.style.cursor="pointer";this.minimize.style.marginLeft="2px";this.minimize.style.display="none";this.buttons.appendChild(this.minimize);var n=!1,i=null,t=null,r=mxUtils.bind(this,function(r){if(this.activate(),n)n=!1,this.minimize.setAttribute("src",this.minimizeImage),this.minimize.setAttribute("title","Minimize"),this.contentWrapper.style.display="",this.maximize.style.display=i,mxClient.IS_QUIRKS||(this.div.style.height=t),this.table.style.height=t,this.resize!=null&&(this.resize.style.visibility=""),this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",r));else{n=!0;this.minimize.setAttribute("src",this.normalizeImage);this.minimize.setAttribute("title","Normalize");this.contentWrapper.style.display="none";i=this.maximize.style.display;this.maximize.style.display="none";t=this.table.style.height;var u=this.getMinimumSize();u.height>0&&(mxClient.IS_QUIRKS||(this.div.style.height=u.height+"px"),this.table.style.height=u.height+"px");u.width>0&&(mxClient.IS_QUIRKS||(this.div.style.width=u.width+"px"),this.table.style.width=u.width+"px");this.resize!=null&&(this.resize.style.visibility="hidden");this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,"event",r))}mxEvent.consume(r)});mxEvent.addGestureListeners(this.minimize,r)};mxWindow.prototype.setMaximizable=function(n){this.maximize.style.display=n?"":"none"};mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement("img");this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("title","Maximize");this.maximize.style.cursor="default";this.maximize.style.marginLeft="2px";this.maximize.style.cursor="pointer";this.maximize.style.display="none";this.buttons.appendChild(this.maximize);var n=!1,r=null,u=null,t=null,i=null,f=null,e=mxUtils.bind(this,function(e){var s,o;this.activate();this.maximize.style.display!="none"&&(n?(n=!1,this.maximize.setAttribute("src",this.maximizeImage),this.maximize.setAttribute("title","Maximize"),this.contentWrapper.style.display="",this.minimize.style.display=f,this.div.style.left=r+"px",this.div.style.top=u+"px",mxClient.IS_QUIRKS||(this.div.style.height=t,this.div.style.width=i,o=mxUtils.getCurrentStyle(this.contentWrapper),(o.overflow=="auto"||this.resize!=null)&&(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-this.contentHeightCorrection+"px")),this.table.style.height=t,this.table.style.width=i,this.resize!=null&&(this.resize.style.visibility=""),this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",e))):(n=!0,this.maximize.setAttribute("src",this.normalizeImage),this.maximize.setAttribute("title","Normalize"),this.contentWrapper.style.display="",f=this.minimize.style.display,this.minimize.style.display="none",r=parseInt(this.div.style.left),u=parseInt(this.div.style.top),t=this.table.style.height,i=this.table.style.width,this.div.style.left="0px",this.div.style.top="0px",s=Math.max(document.body.clientHeight||0,document.documentElement.clientHeight||0),mxClient.IS_QUIRKS||(this.div.style.width=document.body.clientWidth-2+"px",this.div.style.height=s-2+"px"),this.table.style.width=document.body.clientWidth-2+"px",this.table.style.height=s-2+"px",this.resize!=null&&(this.resize.style.visibility="hidden"),mxClient.IS_QUIRKS||(o=mxUtils.getCurrentStyle(this.contentWrapper),(o.overflow=="auto"||this.resize!=null)&&(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-this.contentHeightCorrection+"px")),this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,"event",e))),mxEvent.consume(e))});mxEvent.addGestureListeners(this.maximize,e);mxEvent.addListener(this.title,"dblclick",e)};mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor="move";mxEvent.addGestureListeners(this.title,mxUtils.bind(this,function(n){var r=mxEvent.getClientX(n),u=mxEvent.getClientY(n),f=this.getX(),e=this.getY(),t=mxUtils.bind(this,function(n){var t=mxEvent.getClientX(n)-r,i=mxEvent.getClientY(n)-u;this.setLocation(f+t,e+i);this.fireEvent(new mxEventObject(mxEvent.MOVE,"event",n));mxEvent.consume(n)}),i=mxUtils.bind(this,function(n){mxEvent.removeGestureListeners(document,null,t,i);this.fireEvent(new mxEventObject(mxEvent.MOVE_END,"event",n));mxEvent.consume(n)});mxEvent.addGestureListeners(document,null,t,i);this.fireEvent(new mxEventObject(mxEvent.MOVE_START,"event",n));mxEvent.consume(n)}));mxClient.IS_POINTER&&(this.title.style.touchAction="none")};mxWindow.prototype.setLocation=function(n,t){this.div.style.left=n+"px";this.div.style.top=t+"px"};mxWindow.prototype.getX=function(){return parseInt(this.div.style.left)};mxWindow.prototype.getY=function(){return parseInt(this.div.style.top)};mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement("img");this.closeImg.setAttribute("src",this.closeImage);this.closeImg.setAttribute("title","Close");this.closeImg.style.marginLeft="2px";this.closeImg.style.cursor="pointer";this.closeImg.style.display="none";this.buttons.appendChild(this.closeImg);mxEvent.addGestureListeners(this.closeImg,mxUtils.bind(this,function(n){this.fireEvent(new mxEventObject(mxEvent.CLOSE,"event",n));this.destroyOnClose?this.destroy():this.setVisible(!1);mxEvent.consume(n)}))};mxWindow.prototype.setImage=function(n){this.image=document.createElement("img");this.image.setAttribute("src",n);this.image.setAttribute("align","left");this.image.style.marginRight="4px";this.image.style.marginLeft="0px";this.image.style.marginTop="-2px";this.title.insertBefore(this.image,this.title.firstChild)};mxWindow.prototype.setClosable=function(n){this.closeImg.style.display=n?"":"none"};mxWindow.prototype.isVisible=function(){return this.div!=null?this.div.style.display!="none":!1};mxWindow.prototype.setVisible=function(n){this.div!=null&&this.isVisible()!=n&&(n?this.show():this.hide())};mxWindow.prototype.show=function(){this.div.style.display="";this.activate();var n=mxUtils.getCurrentStyle(this.contentWrapper);mxClient.IS_QUIRKS||n.overflow!="auto"&&this.resize==null||(this.contentWrapper.style.height=this.div.offsetHeight-this.title.offsetHeight-this.contentHeightCorrection+"px");this.fireEvent(new mxEventObject(mxEvent.SHOW))};mxWindow.prototype.hide=function(){this.div.style.display="none";this.fireEvent(new mxEventObject(mxEvent.HIDE))};mxWindow.prototype.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY));this.div!=null&&(mxEvent.release(this.div),this.div.parentNode.removeChild(this.div),this.div=null);this.title=null;this.content=null;this.contentWrapper=null};mxForm.prototype.table=null;mxForm.prototype.body=!1;mxForm.prototype.getTable=function(){return this.table};mxForm.prototype.addButtons=function(n,t){var u=document.createElement("tr"),r=document.createElement("td"),i;u.appendChild(r);r=document.createElement("td");i=document.createElement("button");mxUtils.write(i,mxResources.get("ok")||"OK");r.appendChild(i);mxEvent.addListener(i,"click",function(){n()});i=document.createElement("button");mxUtils.write(i,mxResources.get("cancel")||"Cancel");r.appendChild(i);mxEvent.addListener(i,"click",function(){t()});u.appendChild(r);this.body.appendChild(u)};mxForm.prototype.addText=function(n,t,i){var r=document.createElement("input");return r.setAttribute("type",i||"text"),r.value=t,this.addField(n,r)};mxForm.prototype.addCheckbox=function(n,t){var i=document.createElement("input");return i.setAttribute("type","checkbox"),this.addField(n,i),t&&(i.checked=!0),i};mxForm.prototype.addTextarea=function(n,t,i){var r=document.createElement("textarea");return mxClient.IS_NS&&i--,r.setAttribute("rows",i||2),r.value=t,this.addField(n,r)};mxForm.prototype.addCombo=function(n,t,i){var r=document.createElement("select");return i!=null&&r.setAttribute("size",i),t&&r.setAttribute("multiple","true"),this.addField(n,r)};mxForm.prototype.addOption=function(n,t,i,r){var u=document.createElement("option");mxUtils.writeln(u,t);u.setAttribute("value",i);r&&u.setAttribute("selected",r);n.appendChild(u)};mxForm.prototype.addField=function(n,t){var r=document.createElement("tr"),i=document.createElement("td");return mxUtils.write(i,n),r.appendChild(i),i=document.createElement("td"),i.appendChild(t),r.appendChild(i),this.body.appendChild(r),t};mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;mxDivResizer.prototype.resizeWidth=!0;mxDivResizer.prototype.resizeHeight=!0;mxDivResizer.prototype.handlingResize=!1;mxDivResizer.prototype.resize=function(){var u=this.getDocumentWidth(),f=this.getDocumentHeight(),n=parseInt(this.div.style.left),t=parseInt(this.div.style.right),i=parseInt(this.div.style.top),r=parseInt(this.div.style.bottom);this.resizeWidth&&!isNaN(n)&&!isNaN(t)&&n>=0&&t>=0&&u-t-n>0&&(this.div.style.width=u-t-n+"px");this.resizeHeight&&!isNaN(i)&&!isNaN(r)&&i>=0&&r>=0&&f-i-r>0&&(this.div.style.height=f-i-r+"px")};mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth};mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight};mxDragSource.prototype.element=null;mxDragSource.prototype.dropHandler=null;mxDragSource.prototype.dragOffset=null;mxDragSource.prototype.dragElement=null;mxDragSource.prototype.previewElement=null;mxDragSource.prototype.enabled=!0;mxDragSource.prototype.currentGraph=null;mxDragSource.prototype.currentDropTarget=null;mxDragSource.prototype.currentPoint=null;mxDragSource.prototype.currentGuide=null;mxDragSource.prototype.currentHighlight=null;mxDragSource.prototype.autoscroll=!0;mxDragSource.prototype.guidesEnabled=!0;mxDragSource.prototype.gridEnabled=!0;mxDragSource.prototype.highlightDropTargets=!0;mxDragSource.prototype.dragElementZIndex=100;mxDragSource.prototype.dragElementOpacity=70;mxDragSource.prototype.isEnabled=function(){return this.enabled};mxDragSource.prototype.setEnabled=function(n){this.enabled=n};mxDragSource.prototype.isGuidesEnabled=function(){return this.guidesEnabled};mxDragSource.prototype.setGuidesEnabled=function(n){this.guidesEnabled=n};mxDragSource.prototype.isGridEnabled=function(){return this.gridEnabled};mxDragSource.prototype.setGridEnabled=function(n){this.gridEnabled=n};mxDragSource.prototype.getGraphForEvent=function(){return null};mxDragSource.prototype.getDropTarget=function(n,t,i){return n.getCellAt(t,i)};mxDragSource.prototype.createDragElement=function(){return this.element.cloneNode(!0)};mxDragSource.prototype.createPreviewElement=function(){return null};mxDragSource.prototype.isActive=function(){return this.mouseMoveHandler!=null};mxDragSource.prototype.reset=function(){this.currentGraph!=null&&(this.dragExit(this.currentGraph),this.currentGraph=null);this.removeDragElement();this.removeListeners();this.stopDrag()};mxDragSource.prototype.mouseDown=function(n){this.enabled&&!mxEvent.isConsumed(n)&&this.mouseMoveHandler==null&&(this.startDrag(n),this.mouseMoveHandler=mxUtils.bind(this,this.mouseMove),this.mouseUpHandler=mxUtils.bind(this,this.mouseUp),mxEvent.addGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler),mxClient.IS_TOUCH&&!mxEvent.isMouseEvent(n)&&(this.eventSource=mxEvent.getSource(n),mxEvent.addGestureListeners(this.eventSource,null,this.mouseMoveHandler,this.mouseUpHandler)))};mxDragSource.prototype.startDrag=function(n){this.dragElement=this.createDragElement(n);this.dragElement.style.position="absolute";this.dragElement.style.zIndex=this.dragElementZIndex;mxUtils.setOpacity(this.dragElement,this.dragElementOpacity)};mxDragSource.prototype.stopDrag=function(){this.removeDragElement()};mxDragSource.prototype.removeDragElement=function(){this.dragElement!=null&&(this.dragElement.parentNode!=null&&this.dragElement.parentNode.removeChild(this.dragElement),this.dragElement=null)};mxDragSource.prototype.graphContainsEvent=function(n,t){var u=mxEvent.getClientX(t),f=mxEvent.getClientY(t),i=mxUtils.getOffset(n.container),r=mxUtils.getScrollOrigin();return u>=i.x-r.x&&f>=i.y-r.y&&u<=i.x-r.x+n.container.offsetWidth&&f<=i.y-r.y+n.container.offsetHeight};mxDragSource.prototype.mouseMove=function(n){var t=this.getGraphForEvent(n),i,r,u;t==null||this.graphContainsEvent(t,n)||(t=null);t!=this.currentGraph&&(this.currentGraph!=null&&this.dragExit(this.currentGraph,n),this.currentGraph=t,this.currentGraph!=null&&this.dragEnter(this.currentGraph,n));this.currentGraph!=null&&this.dragOver(this.currentGraph,n);this.dragElement!=null&&(this.previewElement==null||this.previewElement.style.visibility!="visible")?(i=mxEvent.getClientX(n),r=mxEvent.getClientY(n),this.dragElement.parentNode==null&&document.body.appendChild(this.dragElement),this.dragElement.style.visibility="visible",this.dragOffset!=null&&(i+=this.dragOffset.x,r+=this.dragOffset.y),u=mxUtils.getDocumentScrollOrigin(document),this.dragElement.style.left=i+u.x+"px",this.dragElement.style.top=r+u.y+"px"):this.dragElement!=null&&(this.dragElement.style.visibility="hidden");mxEvent.consume(n)};mxDragSource.prototype.mouseUp=function(n){if(this.currentGraph!=null){if(this.currentPoint!=null&&(this.previewElement==null||this.previewElement.style.visibility!="hidden")){var t=this.currentGraph.view.scale,i=this.currentGraph.view.translate,r=this.currentPoint.x/t-i.x,u=this.currentPoint.y/t-i.y;this.drop(this.currentGraph,n,this.currentDropTarget,r,u)}this.dragExit(this.currentGraph);this.currentGraph=null}this.stopDrag();this.removeListeners();mxEvent.consume(n)};mxDragSource.prototype.removeListeners=function(){this.eventSource!=null&&(mxEvent.removeGestureListeners(this.eventSource,null,this.mouseMoveHandler,this.mouseUpHandler),this.eventSource=null);mxEvent.removeGestureListeners(document,null,this.mouseMoveHandler,this.mouseUpHandler);this.mouseMoveHandler=null;this.mouseUpHandler=null};mxDragSource.prototype.dragEnter=function(n,t){n.isMouseDown=!0;n.isMouseTrigger=mxEvent.isMouseEvent(t);this.previewElement=this.createPreviewElement(n);this.isGuidesEnabled()&&this.previewElement!=null&&(this.currentGuide=new mxGuide(n,n.graphHandler.getGuideStates()));this.highlightDropTargets&&(this.currentHighlight=new mxCellHighlight(n,mxConstants.DROP_TARGET_COLOR));n.addListener(mxEvent.FIRE_MOUSE_EVENT,this.eventConsumer)};mxDragSource.prototype.dragExit=function(n){this.currentDropTarget=null;this.currentPoint=null;n.isMouseDown=!1;n.removeListener(this.eventConsumer);this.previewElement!=null&&(this.previewElement.parentNode!=null&&this.previewElement.parentNode.removeChild(this.previewElement),this.previewElement=null);this.currentGuide!=null&&(this.currentGuide.destroy(),this.currentGuide=null);this.currentHighlight!=null&&(this.currentHighlight.destroy(),this.currentHighlight=null)};mxDragSource.prototype.dragOver=function(n,t){var h=mxUtils.getOffset(n.container),c=mxUtils.getScrollOrigin(n.container),i=mxEvent.getClientX(t)-h.x+c.x-n.panDx,r=mxEvent.getClientY(t)-h.y+c.y-n.panDy,l,o,s;if(n.autoScroll&&(this.autoscroll==null||this.autoscroll)&&n.scrollPointToVisible(i,r,n.autoExtend),this.currentHighlight!=null&&n.isDropEnabled()&&(this.currentDropTarget=this.getDropTarget(n,i,r,t),l=n.getView().getState(this.currentDropTarget),this.currentHighlight.highlight(l)),this.previewElement!=null){if(this.previewElement.parentNode==null&&(n.container.appendChild(this.previewElement),this.previewElement.style.zIndex="3",this.previewElement.style.position="absolute"),o=this.isGridEnabled()&&n.isGridEnabledEvent(t),s=!0,this.currentGuide!=null&&this.currentGuide.isEnabledForEvent(t)){var v=parseInt(this.previewElement.style.width),y=parseInt(this.previewElement.style.height),p=new mxRectangle(0,0,v,y),u=new mxPoint(i,r);u=this.currentGuide.move(p,u,o);s=!1;i=u.x;r=u.y}else if(o){var f=n.view.scale,e=n.view.translate,a=n.gridSize/2;i=(n.snap(i/f-e.x-a)+e.x)*f;r=(n.snap(r/f-e.y-a)+e.y)*f}this.currentGuide!=null&&s&&this.currentGuide.hide();this.previewOffset!=null&&(i+=this.previewOffset.x,r+=this.previewOffset.y);this.previewElement.style.left=Math.round(i)+"px";this.previewElement.style.top=Math.round(r)+"px";this.previewElement.style.visibility="visible"}this.currentPoint=new mxPoint(i,r)};mxDragSource.prototype.drop=function(n,t,i,r,u){this.dropHandler(n,t,i,r,u);n.container.style.visibility!="hidden"&&n.container.focus()};mxToolbar.prototype=new mxEventSource;mxToolbar.prototype.constructor=mxToolbar;mxToolbar.prototype.container=null;mxToolbar.prototype.enabled=!0;mxToolbar.prototype.noReset=!1;mxToolbar.prototype.updateDefaultMode=!0;mxToolbar.prototype.addItem=function(n,t,i,r,u,f){var e=document.createElement(t!=null?"img":"button"),o=u||(f!=null?"mxToolbarMode":"mxToolbarItem"),s;return e.className=o,e.setAttribute("src",t),n!=null&&(t!=null?e.setAttribute("title",n):mxUtils.write(e,n)),this.container.appendChild(e),i!=null&&(mxEvent.addListener(e,"click",i),mxClient.IS_TOUCH&&mxEvent.addListener(e,"touchend",i)),s=mxUtils.bind(this,function(){r!=null?e.setAttribute("src",t):e.style.backgroundColor=""}),mxEvent.addGestureListeners(e,mxUtils.bind(this,function(n){var i,t;r!=null?e.setAttribute("src",r):e.style.backgroundColor="gray";f!=null&&(this.menu==null&&(this.menu=new mxPopupMenu,this.menu.init()),i=this.currentImg,this.menu.isMenuShowing()&&this.menu.hideMenu(),i!=e&&(this.currentImg=e,this.menu.factoryMethod=f,t=new mxPoint(e.offsetLeft,e.offsetTop+e.offsetHeight),this.menu.popup(t.x,t.y,null,n),this.menu.isMenuShowing()&&(e.className=o+"Selected",this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);e.className=o;this.currentImg=null})))}),null,s),mxEvent.addListener(e,"mouseout",s),e};mxToolbar.prototype.addCombo=function(n){var t=document.createElement("div"),i;return t.style.display="inline",t.className="mxToolbarComboContainer",i=document.createElement("select"),i.className=n||"mxToolbarCombo",t.appendChild(i),this.container.appendChild(t),i};mxToolbar.prototype.addActionCombo=function(n,t){var i=document.createElement("select");return i.className=t||"mxToolbarCombo",this.addOption(i,n,null),mxEvent.addListener(i,"change",function(n){var t=i.options[i.selectedIndex];i.selectedIndex=0;t.funct!=null&&t.funct(n)}),this.container.appendChild(i),i};mxToolbar.prototype.addOption=function(n,t,i){var r=document.createElement("option");return mxUtils.writeln(r,t),typeof i=="function"?r.funct=i:r.setAttribute("value",i),n.appendChild(r),r};mxToolbar.prototype.addSwitchMode=function(n,t,i,r,u){var f=document.createElement("img");return f.initialClassName=u||"mxToolbarMode",f.className=f.initialClassName,f.setAttribute("src",t),f.altIcon=r,n!=null&&f.setAttribute("title",n),mxEvent.addListener(f,"click",mxUtils.bind(this,function(){var n=this.selectedMode.altIcon;n!=null?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",n)):this.selectedMode.className=this.selectedMode.initialClassName;this.updateDefaultMode&&(this.defaultMode=f);this.selectedMode=f;n=f.altIcon;n!=null?(f.altIcon=f.getAttribute("src"),f.setAttribute("src",n)):f.className=f.initialClassName+"Selected";this.fireEvent(new mxEventObject(mxEvent.SELECT));i()})),this.container.appendChild(f),this.defaultMode==null&&(this.defaultMode=f,this.selectMode(f),i()),f};mxToolbar.prototype.addMode=function(n,t,i,r,u,f){f=f!=null?f:!0;var e=document.createElement(t!=null?"img":"button");return e.initialClassName=u||"mxToolbarMode",e.className=e.initialClassName,e.setAttribute("src",t),e.altIcon=r,n!=null&&e.setAttribute("title",n),this.enabled&&f&&(mxEvent.addListener(e,"click",mxUtils.bind(this,function(){this.selectMode(e,i);this.noReset=!1})),mxEvent.addListener(e,"dblclick",mxUtils.bind(this,function(){this.selectMode(e,i);this.noReset=!0})),this.defaultMode==null&&(this.defaultMode=e,this.defaultFunction=i,this.selectMode(e,i))),this.container.appendChild(e),e};mxToolbar.prototype.selectMode=function(n,t){var i;this.selectedMode!=n&&(this.selectedMode!=null&&(i=this.selectedMode.altIcon,i!=null?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",i)):this.selectedMode.className=this.selectedMode.initialClassName),this.selectedMode=n,i=this.selectedMode.altIcon,i!=null?(this.selectedMode.altIcon=this.selectedMode.getAttribute("src"),this.selectedMode.setAttribute("src",i)):this.selectedMode.className=this.selectedMode.initialClassName+"Selected",this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",t)))};mxToolbar.prototype.resetMode=function(n){(n||!this.noReset)&&this.selectedMode!=this.defaultMode&&this.selectMode(this.defaultMode,this.defaultFunction)};mxToolbar.prototype.addSeparator=function(n){return this.addItem(null,n,null)};mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container)};mxToolbar.prototype.addLine=function(){var n=document.createElement("hr");n.style.marginRight="6px";n.setAttribute("size","1");this.container.appendChild(n)};mxToolbar.prototype.destroy=function(){mxEvent.release(this.container);this.container=null;this.defaultMode=null;this.defaultFunction=null;this.selectedMode=null;this.menu!=null&&this.menu.destroy()};mxUndoableEdit.prototype.source=null;mxUndoableEdit.prototype.changes=null;mxUndoableEdit.prototype.significant=null;mxUndoableEdit.prototype.undone=!1;mxUndoableEdit.prototype.redone=!1;mxUndoableEdit.prototype.isEmpty=function(){return this.changes.length==0};mxUndoableEdit.prototype.isSignificant=function(){return this.significant};mxUndoableEdit.prototype.add=function(n){this.changes.push(n)};mxUndoableEdit.prototype.notify=function(){};mxUndoableEdit.prototype.die=function(){};mxUndoableEdit.prototype.undo=function(){var i,t,n;if(!this.undone){for(this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT)),i=this.changes.length,t=i-1;t>=0;t--)n=this.changes[t],n.execute!=null?n.execute():n.undo!=null&&n.undo(),this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",n));this.undone=!0;this.redone=!1;this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()};mxUndoableEdit.prototype.redo=function(){var i,t,n;if(!this.redone){for(this.source.fireEvent(new mxEventObject(mxEvent.START_EDIT)),i=this.changes.length,t=0;t<i;t++)n=this.changes[t],n.execute!=null?n.execute():n.redo!=null&&n.redo(),this.source.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",n));this.undone=!1;this.redone=!0;this.source.fireEvent(new mxEventObject(mxEvent.END_EDIT))}this.notify()};mxUndoManager.prototype=new mxEventSource;mxUndoManager.prototype.constructor=mxUndoManager;mxUndoManager.prototype.size=null;mxUndoManager.prototype.history=null;mxUndoManager.prototype.indexOfNextAdd=0;mxUndoManager.prototype.isEmpty=function(){return this.history.length==0};mxUndoManager.prototype.clear=function(){this.history=[];this.indexOfNextAdd=0;this.fireEvent(new mxEventObject(mxEvent.CLEAR))};mxUndoManager.prototype.canUndo=function(){return this.indexOfNextAdd>0};mxUndoManager.prototype.undo=function(){while(this.indexOfNextAdd>0){var n=this.history[--this.indexOfNextAdd];if(n.undo(),n.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",n));break}}};mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length};mxUndoManager.prototype.redo=function(){for(var t=this.history.length,n;this.indexOfNextAdd<t;)if(n=this.history[this.indexOfNextAdd++],n.redo(),n.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,"edit",n));break}};mxUndoManager.prototype.undoableEditHappened=function(n){this.trim();this.size>0&&this.size==this.history.length&&this.history.shift();this.history.push(n);this.indexOfNextAdd=this.history.length;this.fireEvent(new mxEventObject(mxEvent.ADD,"edit",n))};mxUndoManager.prototype.trim=function(){var t,n;if(this.history.length>this.indexOfNextAdd)for(t=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd),n=0;n<t.length;n++)t[n].die()};mxUrlConverter=function(){};mxUrlConverter.prototype.enabled=!0;mxUrlConverter.prototype.baseUrl=null;mxUrlConverter.prototype.baseDomain=null;mxUrlConverter.prototype.updateBaseUrl=function(){this.baseDomain=location.protocol+"//"+location.host;this.baseUrl=this.baseDomain+location.pathname;var n=this.baseUrl.lastIndexOf("/");n>0&&(this.baseUrl=this.baseUrl.substring(0,n+1))};mxUrlConverter.prototype.isEnabled=function(){return this.enabled};mxUrlConverter.prototype.setEnabled=function(n){this.enabled=n};mxUrlConverter.prototype.getBaseUrl=function(){return this.baseUrl};mxUrlConverter.prototype.setBaseUrl=function(n){this.baseUrl=n};mxUrlConverter.prototype.getBaseDomain=function(){return this.baseDomain};mxUrlConverter.prototype.setBaseDomain=function(n){this.baseDomain=n};mxUrlConverter.prototype.isRelativeUrl=function(n){return n.substring(0,2)!="//"&&n.substring(0,7)!="http://"&&n.substring(0,8)!="https://"&&n.substring(0,10)!="data:image"&&n.substring(0,7)!="file://"};mxUrlConverter.prototype.convert=function(n){return this.isEnabled()&&this.isRelativeUrl(n)&&(this.getBaseUrl()==null&&this.updateBaseUrl(),n=n.charAt(0)=="/"?this.getBaseDomain()+n:this.getBaseUrl()+n),n};mxPanningManager.prototype.damper=1/6;mxPanningManager.prototype.delay=10;mxPanningManager.prototype.handleMouseOut=!0;mxPanningManager.prototype.border=0;mxPopupMenu.prototype=new mxEventSource;mxPopupMenu.prototype.constructor=mxPopupMenu;mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"/submenu.gif";mxPopupMenu.prototype.zIndex=10006;mxPopupMenu.prototype.factoryMethod=null;mxPopupMenu.prototype.useLeftButtonForPopup=!1;mxPopupMenu.prototype.enabled=!0;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.autoExpand=!1;mxPopupMenu.prototype.smartSeparators=!1;mxPopupMenu.prototype.labels=!0;mxPopupMenu.prototype.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);mxEvent.disableContextMenu(this.div)};mxPopupMenu.prototype.isEnabled=function(){return this.enabled};mxPopupMenu.prototype.setEnabled=function(n){this.enabled=n};mxPopupMenu.prototype.isPopupTrigger=function(n){return n.isPopupTrigger()||this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(n.getEvent())};mxPopupMenu.prototype.addItem=function(n,t,i,r,u,f,e){var o,s,a,v,h,c,l;return r=r||this,this.itemCount++,r.willAddSeparator&&(r.containsItems&&this.addSeparator(r,!0),r.willAddSeparator=!1),r.containsItems=!0,o=document.createElement("tr"),o.className="mxPopupMenuItem",s=document.createElement("td"),s.className="mxPopupMenuIcon",t!=null?(a=document.createElement("img"),a.src=t,s.appendChild(a)):u!=null&&(v=document.createElement("div"),v.className=u,s.appendChild(v)),o.appendChild(s),this.labels&&(h=document.createElement("td"),h.className="mxPopupMenuItem"+(f!=null&&!f?" mxDisabled":""),mxUtils.write(h,n),h.align="left",o.appendChild(h),c=document.createElement("td"),c.className="mxPopupMenuItem"+(f!=null&&!f?" mxDisabled":""),c.style.paddingRight="6px",c.style.textAlign="right",o.appendChild(c),r.div==null&&this.createSubmenu(r)),r.tbody.appendChild(o),e!=!1&&f!=!1&&(l=null,mxEvent.addGestureListeners(o,mxUtils.bind(this,function(n){this.eventReceiver=o;r.activeRow!=o&&r.activeRow!=r&&(r.activeRow!=null&&r.activeRow.div.parentNode!=null&&this.hideSubmenu(r),o.div!=null&&(this.showSubmenu(r,o),r.activeRow=o));(mxClient.IS_QUIRKS||document.documentMode==8)&&(l=document.selection.createRange());mxEvent.consume(n)}),mxUtils.bind(this,function(){r.activeRow!=o&&r.activeRow!=r&&(r.activeRow!=null&&r.activeRow.div.parentNode!=null&&this.hideSubmenu(r),this.autoExpand&&o.div!=null&&(this.showSubmenu(r,o),r.activeRow=o));o.className="mxPopupMenuItemHover"}),mxUtils.bind(this,function(n){if(this.eventReceiver==o){if(r.activeRow!=o&&this.hideMenu(),l!=null){try{l.select()}catch(t){}l=null}i!=null&&i(n)}this.eventReceiver=null;mxEvent.consume(n)})),mxEvent.addListener(o,"mouseout",mxUtils.bind(this,function(){o.className="mxPopupMenuItem"}))),o};mxPopupMenu.prototype.addCheckmark=function(n,t){var i=n.firstChild.nextSibling;i.style.backgroundImage="url('"+t+"')";i.style.backgroundRepeat="no-repeat";i.style.backgroundPosition="2px 50%"};mxPopupMenu.prototype.createSubmenu=function(n){n.table=document.createElement("table");n.table.className="mxPopupMenu";n.tbody=document.createElement("tbody");n.table.appendChild(n.tbody);n.div=document.createElement("div");n.div.className="mxPopupMenu";n.div.style.position="absolute";n.div.style.display="inline";n.div.style.zIndex=this.zIndex;n.div.appendChild(n.table);var t=document.createElement("img");t.setAttribute("src",this.submenuImage);td=n.firstChild.nextSibling.nextSibling;td.appendChild(t)};mxPopupMenu.prototype.showSubmenu=function(n,t){if(t.div!=null){t.div.style.left=n.div.offsetLeft+t.offsetLeft+t.offsetWidth-1+"px";t.div.style.top=n.div.offsetTop+t.offsetTop+"px";document.body.appendChild(t.div);var r=parseInt(t.div.offsetLeft),i=parseInt(t.div.offsetWidth),u=mxUtils.getDocumentScrollOrigin(document),f=document.body,e=document.documentElement,o=u.x+(f.clientWidth||e.clientWidth);r+i>o&&(t.div.style.left=Math.max(0,n.div.offsetLeft-i+(mxClient.IS_IE?6:-6))+"px");mxUtils.fit(t.div)}};mxPopupMenu.prototype.addSeparator=function(n,t){var r,u,i,f;n=n||this;this.smartSeparators&&!t?n.willAddSeparator=!0:n.tbody!=null&&(n.willAddSeparator=!1,r=document.createElement("tr"),u=document.createElement("td"),u.className="mxPopupMenuIcon",u.style.padding="0 0 0 0px",r.appendChild(u),i=document.createElement("td"),i.style.padding="0 0 0 0px",i.setAttribute("colSpan","2"),f=document.createElement("hr"),f.setAttribute("size","1"),i.appendChild(f),r.appendChild(i),n.tbody.appendChild(r))};mxPopupMenu.prototype.popup=function(n,t,i,r){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){for(this.div.style.left=n+"px",this.div.style.top=t+"px";this.tbody.firstChild!=null;)mxEvent.release(this.tbody.firstChild),this.tbody.removeChild(this.tbody.firstChild);this.itemCount=0;this.factoryMethod(this,i,r);this.itemCount>0&&(this.showMenu(),this.fireEvent(new mxEventObject(mxEvent.SHOW)))}};mxPopupMenu.prototype.isMenuShowing=function(){return this.div!=null&&this.div.parentNode==document.body};mxPopupMenu.prototype.showMenu=function(){document.documentMode>=9&&(this.div.style.filter="none");document.body.appendChild(this.div);mxUtils.fit(this.div)};mxPopupMenu.prototype.hideMenu=function(){this.div!=null&&(this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div),this.hideSubmenu(this),this.containsItems=!1,this.fireEvent(new mxEventObject(mxEvent.HIDE)))};mxPopupMenu.prototype.hideSubmenu=function(n){n.activeRow!=null&&(this.hideSubmenu(n.activeRow),n.activeRow.div.parentNode!=null&&n.activeRow.div.parentNode.removeChild(n.activeRow.div),n.activeRow=null)};mxPopupMenu.prototype.destroy=function(){this.div!=null&&(mxEvent.release(this.div),this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div),this.div=null)};mxAutoSaveManager.prototype=new mxEventSource;mxAutoSaveManager.prototype.constructor=mxAutoSaveManager;mxAutoSaveManager.prototype.graph=null;mxAutoSaveManager.prototype.autoSaveDelay=10;mxAutoSaveManager.prototype.autoSaveThrottle=2;mxAutoSaveManager.prototype.autoSaveThreshold=5;mxAutoSaveManager.prototype.ignoredChanges=0;mxAutoSaveManager.prototype.lastSnapshot=0;mxAutoSaveManager.prototype.enabled=!0;mxAutoSaveManager.prototype.changeHandler=null;mxAutoSaveManager.prototype.isEnabled=function(){return this.enabled};mxAutoSaveManager.prototype.setEnabled=function(n){this.enabled=n};mxAutoSaveManager.prototype.setGraph=function(n){this.graph!=null&&this.graph.getModel().removeListener(this.changeHandler);this.graph=n;this.graph!=null&&this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler)};mxAutoSaveManager.prototype.save=function(){};mxAutoSaveManager.prototype.graphModelChanged=function(){var t=(new Date).getTime(),n=(t-this.lastSnapshot)/1e3;n>this.autoSaveDelay||this.ignoredChanges>=this.autoSaveThreshold&&n>this.autoSaveThrottle?(this.save(),this.reset()):this.ignoredChanges++};mxAutoSaveManager.prototype.reset=function(){this.lastSnapshot=(new Date).getTime();this.ignoredChanges=0};mxAutoSaveManager.prototype.destroy=function(){this.setGraph(null)};mxAnimation.prototype=new mxEventSource;mxAnimation.prototype.constructor=mxAnimation;mxAnimation.prototype.delay=null;mxAnimation.prototype.thread=null;mxAnimation.prototype.isRunning=function(){return this.thread!=null};mxAnimation.prototype.startAnimation=function(){this.thread==null&&(this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay))};mxAnimation.prototype.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE))};mxAnimation.prototype.stopAnimation=function(){this.thread!=null&&(window.clearInterval(this.thread),this.thread=null,this.fireEvent(new mxEventObject(mxEvent.DONE)))};mxMorphing.prototype=new mxAnimation;mxMorphing.prototype.constructor=mxMorphing;mxMorphing.prototype.graph=null;mxMorphing.prototype.steps=null;mxMorphing.prototype.step=0;mxMorphing.prototype.ease=null;mxMorphing.prototype.cells=null;mxMorphing.prototype.updateAnimation=function(){var n,t;if(mxAnimation.prototype.updateAnimation.apply(this,arguments),n=new mxCellStatePreview(this.graph),this.cells!=null)for(t=0;t<this.cells.length;t++)this.animateCell(this.cells[t],n,!1);else this.animateCell(this.graph.getModel().getRoot(),n,!0);this.show(n);(n.isEmpty()||this.step++>=this.steps)&&this.stopAnimation()};mxMorphing.prototype.show=function(n){n.show()};mxMorphing.prototype.animateCell=function(n,t,i){var u=this.graph.getView().getState(n),r=null,e,o,s,f;if(u!=null&&(r=this.getDelta(u),this.graph.getModel().isVertex(n)&&(r.x!=0||r.y!=0)&&(e=this.graph.view.getTranslate(),o=this.graph.view.getScale(),r.x+=e.x*o,r.y+=e.y*o,t.moveState(u,-r.x/this.ease,-r.y/this.ease))),i&&!this.stopRecursion(u,r))for(s=this.graph.getModel().getChildCount(n),f=0;f<s;f++)this.animateCell(this.graph.getModel().getChildAt(n,f),t,i)};mxMorphing.prototype.stopRecursion=function(n,t){return t!=null&&(t.x!=0||t.y!=0)};mxMorphing.prototype.getDelta=function(n){var i=this.getOriginForCell(n.cell),r=this.graph.getView().getTranslate(),t=this.graph.getView().getScale(),u=n.x/t-r.x,f=n.y/t-r.y;return new mxPoint((i.x-u)*t,(i.y-f)*t)};mxMorphing.prototype.getOriginForCell=function(n){var t=null,u,i,r,f;return n!=null&&(u=this.graph.getModel().getParent(n),i=this.graph.getCellGeometry(n),t=this.getOriginForCell(u),i!=null&&(i.relative?(r=this.graph.getCellGeometry(u),r!=null&&(t.x+=i.x*r.width,t.y+=i.y*r.height)):(t.x+=i.x,t.y+=i.y))),t==null&&(f=this.graph.view.getTranslate(),t=new mxPoint(-f.x,-f.y)),t};mxImageBundle.prototype.images=null;mxImageBundle.prototype.images=null;mxImageBundle.prototype.putImage=function(n,t,i){this.images[n]={value:t,fallback:i}};mxImageBundle.prototype.getImage=function(n){var i=null,t;return n!=null&&(t=this.images[n],t!=null&&(i=this.alt?t.fallback:t.value)),i};mxImageExport.prototype.includeOverlays=!1;mxImageExport.prototype.drawState=function(n,t){n!=null&&(this.visitStatesRecursive(n,t,mxUtils.bind(this,function(){this.drawCellState.apply(this,arguments)})),this.includeOverlays&&this.visitStatesRecursive(n,t,mxUtils.bind(this,function(){this.drawOverlays.apply(this,arguments)})))};mxImageExport.prototype.visitStatesRecursive=function(n,t,i){var r,f,u,e;if(n!=null)for(i(n,t),r=n.view.graph,f=r.model.getChildCount(n.cell),u=0;u<f;u++)e=r.view.getState(r.model.getChildAt(n.cell,u)),this.visitStatesRecursive(e,t,i)};mxImageExport.prototype.getLinkForCellState=function(){return null};mxImageExport.prototype.drawCellState=function(n,t){var i=this.getLinkForCellState(n,t);i!=null&&t.setLink(i);this.drawShape(n,t);this.drawText(n,t);i!=null&&t.setLink(null)};mxImageExport.prototype.drawShape=function(n,t){n.shape instanceof mxShape&&n.shape.checkBounds()&&(t.save(),n.shape.paint(t),t.restore())};mxImageExport.prototype.drawText=function(n,t){n.text!=null&&n.text.checkBounds()&&(t.save(),n.text.paint(t),t.restore())};mxImageExport.prototype.drawOverlays=function(n,t){n.overlays!=null&&n.overlays.visit(function(n,i){i instanceof mxShape&&i.paint(t)})};mxAbstractCanvas2D.prototype.state=null;mxAbstractCanvas2D.prototype.states=null;mxAbstractCanvas2D.prototype.path=null;mxAbstractCanvas2D.prototype.rotateHtml=!0;mxAbstractCanvas2D.prototype.lastX=0;mxAbstractCanvas2D.prototype.lastY=0;mxAbstractCanvas2D.prototype.moveOp="M";mxAbstractCanvas2D.prototype.lineOp="L";mxAbstractCanvas2D.prototype.quadOp="Q";mxAbstractCanvas2D.prototype.curveOp="C";mxAbstractCanvas2D.prototype.closeOp="Z";mxAbstractCanvas2D.prototype.pointerEvents=!1;mxAbstractCanvas2D.prototype.createUrlConverter=function(){return new mxUrlConverter};mxAbstractCanvas2D.prototype.reset=function(){this.state=this.createState();this.states=[]};mxAbstractCanvas2D.prototype.createState=function(){return{dx:0,dy:0,scale:1,alpha:1,fillAlpha:1,strokeAlpha:1,fillColor:null,gradientFillAlpha:1,gradientColor:null,gradientAlpha:1,gradientDirection:null,strokeColor:null,strokeWidth:1,dashed:!1,dashPattern:"3 3",fixDash:!1,lineCap:"flat",lineJoin:"miter",miterLimit:10,fontColor:"#000000",fontBackgroundColor:null,fontBorderColor:null,fontSize:mxConstants.DEFAULT_FONTSIZE,fontFamily:mxConstants.DEFAULT_FONTFAMILY,fontStyle:0,shadow:!1,shadowColor:mxConstants.SHADOWCOLOR,shadowAlpha:mxConstants.SHADOW_OPACITY,shadowDx:mxConstants.SHADOW_OFFSET_X,shadowDy:mxConstants.SHADOW_OFFSET_Y,rotation:0,rotationCx:0,rotationCy:0}};mxAbstractCanvas2D.prototype.format=function(n){return Math.round(parseFloat(n))};mxAbstractCanvas2D.prototype.addOp=function(){var n,t;if(this.path!=null&&(this.path.push(arguments[0]),arguments.length>2))for(n=this.state,t=2;t<arguments.length;t+=2)this.lastX=arguments[t-1],this.lastY=arguments[t],this.path.push(this.format((this.lastX+n.dx)*n.scale)),this.path.push(this.format((this.lastY+n.dy)*n.scale))};mxAbstractCanvas2D.prototype.rotatePoint=function(n,t,i,r,u){var f=i*(Math.PI/180);return mxUtils.getRotatedPoint(new mxPoint(n,t),Math.cos(f),Math.sin(f),new mxPoint(r,u))};mxAbstractCanvas2D.prototype.save=function(){this.states.push(this.state);this.state=mxUtils.clone(this.state)};mxAbstractCanvas2D.prototype.restore=function(){this.states.length>0&&(this.state=this.states.pop())};mxAbstractCanvas2D.prototype.setLink=function(){};mxAbstractCanvas2D.prototype.scale=function(n){this.state.scale*=n;this.state.strokeWidth*=n};mxAbstractCanvas2D.prototype.translate=function(n,t){this.state.dx+=n;this.state.dy+=t};mxAbstractCanvas2D.prototype.rotate=function(){};mxAbstractCanvas2D.prototype.setAlpha=function(n){this.state.alpha=n};mxAbstractCanvas2D.prototype.setFillAlpha=function(n){this.state.fillAlpha=n};mxAbstractCanvas2D.prototype.setStrokeAlpha=function(n){this.state.strokeAlpha=n};mxAbstractCanvas2D.prototype.setFillColor=function(n){n==mxConstants.NONE&&(n=null);this.state.fillColor=n;this.state.gradientColor=null};mxAbstractCanvas2D.prototype.setGradient=function(n,t,i,r,u,f,e,o,s){var h=this.state;h.fillColor=n;h.gradientFillAlpha=o!=null?o:1;h.gradientColor=t;h.gradientAlpha=s!=null?s:1;h.gradientDirection=e};mxAbstractCanvas2D.prototype.setStrokeColor=function(n){n==mxConstants.NONE&&(n=null);this.state.strokeColor=n};mxAbstractCanvas2D.prototype.setStrokeWidth=function(n){this.state.strokeWidth=n};mxAbstractCanvas2D.prototype.setDashed=function(n,t){this.state.dashed=n;this.state.fixDash=t};mxAbstractCanvas2D.prototype.setDashPattern=function(n){this.state.dashPattern=n};mxAbstractCanvas2D.prototype.setLineCap=function(n){this.state.lineCap=n};mxAbstractCanvas2D.prototype.setLineJoin=function(n){this.state.lineJoin=n};mxAbstractCanvas2D.prototype.setMiterLimit=function(n){this.state.miterLimit=n};mxAbstractCanvas2D.prototype.setFontColor=function(n){n==mxConstants.NONE&&(n=null);this.state.fontColor=n};mxAbstractCanvas2D.prototype.setFontBackgroundColor=function(n){n==mxConstants.NONE&&(n=null);this.state.fontBackgroundColor=n};mxAbstractCanvas2D.prototype.setFontBorderColor=function(n){n==mxConstants.NONE&&(n=null);this.state.fontBorderColor=n};mxAbstractCanvas2D.prototype.setFontSize=function(n){this.state.fontSize=parseFloat(n)};mxAbstractCanvas2D.prototype.setFontFamily=function(n){this.state.fontFamily=n};mxAbstractCanvas2D.prototype.setFontStyle=function(n){n==null&&(n=0);this.state.fontStyle=n};mxAbstractCanvas2D.prototype.setShadow=function(n){this.state.shadow=n};mxAbstractCanvas2D.prototype.setShadowColor=function(n){n==mxConstants.NONE&&(n=null);this.state.shadowColor=n};mxAbstractCanvas2D.prototype.setShadowAlpha=function(n){this.state.shadowAlpha=n};mxAbstractCanvas2D.prototype.setShadowOffset=function(n,t){this.state.shadowDx=n;this.state.shadowDy=t};mxAbstractCanvas2D.prototype.begin=function(){this.lastX=0;this.lastY=0;this.path=[]};mxAbstractCanvas2D.prototype.moveTo=function(n,t){this.addOp(this.moveOp,n,t)};mxAbstractCanvas2D.prototype.lineTo=function(n,t){this.addOp(this.lineOp,n,t)};mxAbstractCanvas2D.prototype.quadTo=function(n,t,i,r){this.addOp(this.quadOp,n,t,i,r)};mxAbstractCanvas2D.prototype.curveTo=function(n,t,i,r,u,f){this.addOp(this.curveOp,n,t,i,r,u,f)};mxAbstractCanvas2D.prototype.arcTo=function(n,t,i,r,u,f,e){var s=mxUtils.arcToCurves(this.lastX,this.lastY,n,t,i,r,u,f,e),o;if(s!=null)for(o=0;o<s.length;o+=6)this.curveTo(s[o],s[o+1],s[o+2],s[o+3],s[o+4],s[o+5])};mxAbstractCanvas2D.prototype.close=function(){this.addOp(this.closeOp)};mxAbstractCanvas2D.prototype.end=function(){};mxUtils.extend(mxXmlCanvas2D,mxAbstractCanvas2D);mxXmlCanvas2D.prototype.textEnabled=!0;mxXmlCanvas2D.prototype.compressed=!0;mxXmlCanvas2D.prototype.writeDefaults=function(){var n;n=this.createElement("fontfamily");n.setAttribute("family",mxConstants.DEFAULT_FONTFAMILY);this.root.appendChild(n);n=this.createElement("fontsize");n.setAttribute("size",mxConstants.DEFAULT_FONTSIZE);this.root.appendChild(n);n=this.createElement("shadowcolor");n.setAttribute("color",mxConstants.SHADOWCOLOR);this.root.appendChild(n);n=this.createElement("shadowalpha");n.setAttribute("alpha",mxConstants.SHADOW_OPACITY);this.root.appendChild(n);n=this.createElement("shadowoffset");n.setAttribute("dx",mxConstants.SHADOW_OFFSET_X);n.setAttribute("dy",mxConstants.SHADOW_OFFSET_Y);this.root.appendChild(n)};mxXmlCanvas2D.prototype.format=function(n){return parseFloat(parseFloat(n).toFixed(2))};mxXmlCanvas2D.prototype.createElement=function(n){return this.root.ownerDocument.createElement(n)};mxXmlCanvas2D.prototype.save=function(){this.compressed&&mxAbstractCanvas2D.prototype.save.apply(this,arguments);this.root.appendChild(this.createElement("save"))};mxXmlCanvas2D.prototype.restore=function(){this.compressed&&mxAbstractCanvas2D.prototype.restore.apply(this,arguments);this.root.appendChild(this.createElement("restore"))};mxXmlCanvas2D.prototype.scale=function(n){var t=this.createElement("scale");t.setAttribute("scale",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.translate=function(n,t){var i=this.createElement("translate");i.setAttribute("dx",this.format(n));i.setAttribute("dy",this.format(t));this.root.appendChild(i)};mxXmlCanvas2D.prototype.rotate=function(n,t,i,r,u){var f=this.createElement("rotate");(n!=0||t||i)&&(f.setAttribute("theta",this.format(n)),f.setAttribute("flipH",t?"1":"0"),f.setAttribute("flipV",i?"1":"0"),f.setAttribute("cx",this.format(r)),f.setAttribute("cy",this.format(u)),this.root.appendChild(f))};mxXmlCanvas2D.prototype.setAlpha=function(n){if(this.compressed){if(this.state.alpha==n)return;mxAbstractCanvas2D.prototype.setAlpha.apply(this,arguments)}var t=this.createElement("alpha");t.setAttribute("alpha",this.format(n));this.root.appendChild(t)};mxXmlCanvas2D.prototype.setFillAlpha=function(n){if(this.compressed){if(this.state.fillAlpha==n)return;mxAbstractCanvas2D.prototype.setFillAlpha.apply(this,arguments)}var t=this.createElement("fillalpha");t.setAttribute("alpha",this.format(n));this.root.appendChild(t)};mxXmlCanvas2D.prototype.setStrokeAlpha=function(n){if(this.compressed){if(this.state.strokeAlpha==n)return;mxAbstractCanvas2D.prototype.setStrokeAlpha.apply(this,arguments)}var t=this.createElement("strokealpha");t.setAttribute("alpha",this.format(n));this.root.appendChild(t)};mxXmlCanvas2D.prototype.setFillColor=function(n){if(n==mxConstants.NONE&&(n=null),this.compressed){if(this.state.fillColor==n)return;mxAbstractCanvas2D.prototype.setFillColor.apply(this,arguments)}var t=this.createElement("fillcolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setGradient=function(n,t,i,r,u,f,e,o,s){if(n!=null&&t!=null){mxAbstractCanvas2D.prototype.setGradient.apply(this,arguments);var h=this.createElement("gradient");h.setAttribute("c1",n);h.setAttribute("c2",t);h.setAttribute("x",this.format(i));h.setAttribute("y",this.format(r));h.setAttribute("w",this.format(u));h.setAttribute("h",this.format(f));e!=null&&h.setAttribute("direction",e);o!=null&&h.setAttribute("alpha1",o);s!=null&&h.setAttribute("alpha2",s);this.root.appendChild(h)}};mxXmlCanvas2D.prototype.setStrokeColor=function(n){if(n==mxConstants.NONE&&(n=null),this.compressed){if(this.state.strokeColor==n)return;mxAbstractCanvas2D.prototype.setStrokeColor.apply(this,arguments)}var t=this.createElement("strokecolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setStrokeWidth=function(n){if(this.compressed){if(this.state.strokeWidth==n)return;mxAbstractCanvas2D.prototype.setStrokeWidth.apply(this,arguments)}var t=this.createElement("strokewidth");t.setAttribute("width",this.format(n));this.root.appendChild(t)};mxXmlCanvas2D.prototype.setDashed=function(n,t){if(this.compressed){if(this.state.dashed==n)return;mxAbstractCanvas2D.prototype.setDashed.apply(this,arguments)}var i=this.createElement("dashed");i.setAttribute("dashed",n?"1":"0");t!=null&&i.setAttribute("fixDash",t?"1":"0");this.root.appendChild(i)};mxXmlCanvas2D.prototype.setDashPattern=function(n){if(this.compressed){if(this.state.dashPattern==n)return;mxAbstractCanvas2D.prototype.setDashPattern.apply(this,arguments)}var t=this.createElement("dashpattern");t.setAttribute("pattern",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setLineCap=function(n){if(this.compressed){if(this.state.lineCap==n)return;mxAbstractCanvas2D.prototype.setLineCap.apply(this,arguments)}var t=this.createElement("linecap");t.setAttribute("cap",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setLineJoin=function(n){if(this.compressed){if(this.state.lineJoin==n)return;mxAbstractCanvas2D.prototype.setLineJoin.apply(this,arguments)}var t=this.createElement("linejoin");t.setAttribute("join",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setMiterLimit=function(n){if(this.compressed){if(this.state.miterLimit==n)return;mxAbstractCanvas2D.prototype.setMiterLimit.apply(this,arguments)}var t=this.createElement("miterlimit");t.setAttribute("limit",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setFontColor=function(n){if(this.textEnabled){if(n==mxConstants.NONE&&(n=null),this.compressed){if(this.state.fontColor==n)return;mxAbstractCanvas2D.prototype.setFontColor.apply(this,arguments)}var t=this.createElement("fontcolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setFontBackgroundColor=function(n){if(this.textEnabled){if(n==mxConstants.NONE&&(n=null),this.compressed){if(this.state.fontBackgroundColor==n)return;mxAbstractCanvas2D.prototype.setFontBackgroundColor.apply(this,arguments)}var t=this.createElement("fontbackgroundcolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setFontBorderColor=function(n){if(this.textEnabled){if(n==mxConstants.NONE&&(n=null),this.compressed){if(this.state.fontBorderColor==n)return;mxAbstractCanvas2D.prototype.setFontBorderColor.apply(this,arguments)}var t=this.createElement("fontbordercolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setFontSize=function(n){if(this.textEnabled){if(this.compressed){if(this.state.fontSize==n)return;mxAbstractCanvas2D.prototype.setFontSize.apply(this,arguments)}var t=this.createElement("fontsize");t.setAttribute("size",n);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setFontFamily=function(n){if(this.textEnabled){if(this.compressed){if(this.state.fontFamily==n)return;mxAbstractCanvas2D.prototype.setFontFamily.apply(this,arguments)}var t=this.createElement("fontfamily");t.setAttribute("family",n);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setFontStyle=function(n){if(this.textEnabled){if(n==null&&(n=0),this.compressed){if(this.state.fontStyle==n)return;mxAbstractCanvas2D.prototype.setFontStyle.apply(this,arguments)}var t=this.createElement("fontstyle");t.setAttribute("style",n);this.root.appendChild(t)}};mxXmlCanvas2D.prototype.setShadow=function(n){if(this.compressed){if(this.state.shadow==n)return;mxAbstractCanvas2D.prototype.setShadow.apply(this,arguments)}var t=this.createElement("shadow");t.setAttribute("enabled",n?"1":"0");this.root.appendChild(t)};mxXmlCanvas2D.prototype.setShadowColor=function(n){if(this.compressed){if(n==mxConstants.NONE&&(n=null),this.state.shadowColor==n)return;mxAbstractCanvas2D.prototype.setShadowColor.apply(this,arguments)}var t=this.createElement("shadowcolor");t.setAttribute("color",n!=null?n:mxConstants.NONE);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setShadowAlpha=function(n){if(this.compressed){if(this.state.shadowAlpha==n)return;mxAbstractCanvas2D.prototype.setShadowAlpha.apply(this,arguments)}var t=this.createElement("shadowalpha");t.setAttribute("alpha",n);this.root.appendChild(t)};mxXmlCanvas2D.prototype.setShadowOffset=function(n,t){if(this.compressed){if(this.state.shadowDx==n&&this.state.shadowDy==t)return;mxAbstractCanvas2D.prototype.setShadowOffset.apply(this,arguments)}var i=this.createElement("shadowoffset");i.setAttribute("dx",n);i.setAttribute("dy",t);this.root.appendChild(i)};mxXmlCanvas2D.prototype.rect=function(n,t,i,r){var u=this.createElement("rect");u.setAttribute("x",this.format(n));u.setAttribute("y",this.format(t));u.setAttribute("w",this.format(i));u.setAttribute("h",this.format(r));this.root.appendChild(u)};mxXmlCanvas2D.prototype.roundrect=function(n,t,i,r,u,f){var e=this.createElement("roundrect");e.setAttribute("x",this.format(n));e.setAttribute("y",this.format(t));e.setAttribute("w",this.format(i));e.setAttribute("h",this.format(r));e.setAttribute("dx",this.format(u));e.setAttribute("dy",this.format(f));this.root.appendChild(e)};mxXmlCanvas2D.prototype.ellipse=function(n,t,i,r){var u=this.createElement("ellipse");u.setAttribute("x",this.format(n));u.setAttribute("y",this.format(t));u.setAttribute("w",this.format(i));u.setAttribute("h",this.format(r));this.root.appendChild(u)};mxXmlCanvas2D.prototype.image=function(n,t,i,r,u,f,e,o){u=this.converter.convert(u);var s=this.createElement("image");s.setAttribute("x",this.format(n));s.setAttribute("y",this.format(t));s.setAttribute("w",this.format(i));s.setAttribute("h",this.format(r));s.setAttribute("src",u);s.setAttribute("aspect",f?"1":"0");s.setAttribute("flipH",e?"1":"0");s.setAttribute("flipV",o?"1":"0");this.root.appendChild(s)};mxXmlCanvas2D.prototype.begin=function(){this.root.appendChild(this.createElement("begin"));this.lastX=0;this.lastY=0};mxXmlCanvas2D.prototype.moveTo=function(n,t){var i=this.createElement("move");i.setAttribute("x",this.format(n));i.setAttribute("y",this.format(t));this.root.appendChild(i);this.lastX=n;this.lastY=t};mxXmlCanvas2D.prototype.lineTo=function(n,t){var i=this.createElement("line");i.setAttribute("x",this.format(n));i.setAttribute("y",this.format(t));this.root.appendChild(i);this.lastX=n;this.lastY=t};mxXmlCanvas2D.prototype.quadTo=function(n,t,i,r){var u=this.createElement("quad");u.setAttribute("x1",this.format(n));u.setAttribute("y1",this.format(t));u.setAttribute("x2",this.format(i));u.setAttribute("y2",this.format(r));this.root.appendChild(u);this.lastX=i;this.lastY=r};mxXmlCanvas2D.prototype.curveTo=function(n,t,i,r,u,f){var e=this.createElement("curve");e.setAttribute("x1",this.format(n));e.setAttribute("y1",this.format(t));e.setAttribute("x2",this.format(i));e.setAttribute("y2",this.format(r));e.setAttribute("x3",this.format(u));e.setAttribute("y3",this.format(f));this.root.appendChild(e);this.lastX=u;this.lastY=f};mxXmlCanvas2D.prototype.close=function(){this.root.appendChild(this.createElement("close"))};mxXmlCanvas2D.prototype.text=function(n,t,i,r,u,f,e,o,s,h,c,l,a){if(this.textEnabled&&u!=null){mxUtils.isNode(u)&&(u=mxUtils.getOuterHtml(u));var v=this.createElement("text");v.setAttribute("x",this.format(n));v.setAttribute("y",this.format(t));v.setAttribute("w",this.format(i));v.setAttribute("h",this.format(r));v.setAttribute("str",u);f!=null&&v.setAttribute("align",f);e!=null&&v.setAttribute("valign",e);v.setAttribute("wrap",o?"1":"0");s==null&&(s="");v.setAttribute("format",s);h!=null&&v.setAttribute("overflow",h);c!=null&&v.setAttribute("clip",c?"1":"0");l!=null&&v.setAttribute("rotation",l);a!=null&&v.setAttribute("dir",a);this.root.appendChild(v)}};mxXmlCanvas2D.prototype.stroke=function(){this.root.appendChild(this.createElement("stroke"))};mxXmlCanvas2D.prototype.fill=function(){this.root.appendChild(this.createElement("fill"))};mxXmlCanvas2D.prototype.fillAndStroke=function(){this.root.appendChild(this.createElement("fillstroke"))};mxUtils.extend(mxSvgCanvas2D,mxAbstractCanvas2D),function(){if(mxSvgCanvas2D.prototype.useDomParser=!mxClient.IS_IE&&typeof DOMParser=="function"&&typeof XMLSerializer=="function",mxSvgCanvas2D.prototype.useDomParser)try{var n=(new DOMParser).parseFromString("test text","text/html");mxSvgCanvas2D.prototype.useDomParser=n!=null}catch(t){mxSvgCanvas2D.prototype.useDomParser=!1}}();mxSvgCanvas2D.prototype.node=null;mxSvgCanvas2D.prototype.matchHtmlAlignment=!0;mxSvgCanvas2D.prototype.textEnabled=!0;mxSvgCanvas2D.prototype.foEnabled=!0;mxSvgCanvas2D.prototype.foAltText="[Object]";mxSvgCanvas2D.prototype.foOffset=0;mxSvgCanvas2D.prototype.textOffset=0;mxSvgCanvas2D.prototype.imageOffset=0;mxSvgCanvas2D.prototype.strokeTolerance=0;mxSvgCanvas2D.prototype.refCount=0;mxSvgCanvas2D.prototype.blockImagePointerEvents=!1;mxSvgCanvas2D.prototype.lineHeightCorrection=1;mxSvgCanvas2D.prototype.pointerEventsValue="all";mxSvgCanvas2D.prototype.fontMetricsPadding=10;mxSvgCanvas2D.prototype.cacheOffsetSize=!0;mxSvgCanvas2D.prototype.format=function(n){return parseFloat(parseFloat(n).toFixed(2))};mxSvgCanvas2D.prototype.getBaseUrl=function(){var n=window.location.href,t=n.lastIndexOf("#");return t>0&&(n=n.substring(0,t)),n};mxSvgCanvas2D.prototype.reset=function(){mxAbstractCanvas2D.prototype.reset.apply(this,arguments);this.gradients=[]};mxSvgCanvas2D.prototype.createStyle=function(){var n=this.createElement("style");return n.setAttribute("type","text/css"),mxUtils.write(n,"svg{font-family:"+mxConstants.DEFAULT_FONTFAMILY+";font-size:"+mxConstants.DEFAULT_FONTSIZE+";fill:none;stroke-miterlimit:10}"),n};mxSvgCanvas2D.prototype.createElement=function(n,t){if(this.root.ownerDocument.createElementNS!=null)return this.root.ownerDocument.createElementNS(t||mxConstants.NS_SVG,n);var i=this.root.ownerDocument.createElement(n);return t!=null&&i.setAttribute("xmlns",t),i};mxSvgCanvas2D.prototype.createAlternateContent=function(n,t,i,r,u){if(this.foAltText!=null){var e=this.state,f=this.createElement("text");return f.setAttribute("x",Math.round(r/2)),f.setAttribute("y",Math.round((u+e.fontSize)/2)),f.setAttribute("fill",e.fontColor||"black"),f.setAttribute("text-anchor","middle"),f.setAttribute("font-size",e.fontSize+"px"),f.setAttribute("font-family",e.fontFamily),(e.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&f.setAttribute("font-weight","bold"),(e.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&f.setAttribute("font-style","italic"),(e.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&f.setAttribute("text-decoration","underline"),mxUtils.write(f,this.foAltText),f}return null};mxSvgCanvas2D.prototype.createGradientId=function(n,t,i,r,u){var f,e;return n.charAt(0)=="#"&&(n=n.substring(1)),t.charAt(0)=="#"&&(t=t.substring(1)),n=n.toLowerCase()+"-"+i,t=t.toLowerCase()+"-"+r,f=null,u==null||u==mxConstants.DIRECTION_SOUTH?f="s":u==mxConstants.DIRECTION_EAST?f="e":(e=n,n=t,t=e,u==mxConstants.DIRECTION_NORTH?f="s":u==mxConstants.DIRECTION_WEST&&(f="e")),"mx-gradient-"+n+"-"+t+"-"+f};mxSvgCanvas2D.prototype.getSvgGradient=function(n,t,i,r,u){var s=this.createGradientId(n,t,i,r,u),f=this.gradients[s];if(f==null){var e=this.root.ownerSVGElement,h=0,o=s+"-"+h;if(e!=null)for(f=e.ownerDocument.getElementById(o);f!=null&&f.ownerSVGElement!=e;)o=s+"-"+h++,f=e.ownerDocument.getElementById(o);else o="id"+ ++this.refCount;f==null&&(f=this.createSvgGradient(n,t,i,r,u),f.setAttribute("id",o),this.defs!=null?this.defs.appendChild(f):e.appendChild(f));this.gradients[s]=f}return f.getAttribute("id")};mxSvgCanvas2D.prototype.createSvgGradient=function(n,t,i,r,u){var f=this.createElement("linearGradient"),o,e;return f.setAttribute("x1","0%"),f.setAttribute("y1","0%"),f.setAttribute("x2","0%"),f.setAttribute("y2","0%"),u==null||u==mxConstants.DIRECTION_SOUTH?f.setAttribute("y2","100%"):u==mxConstants.DIRECTION_EAST?f.setAttribute("x2","100%"):u==mxConstants.DIRECTION_NORTH?f.setAttribute("y1","100%"):u==mxConstants.DIRECTION_WEST&&f.setAttribute("x1","100%"),o=i<1?";stop-opacity:"+i:"",e=this.createElement("stop"),e.setAttribute("offset","0%"),e.setAttribute("style","stop-color:"+n+o),f.appendChild(e),o=r<1?";stop-opacity:"+r:"",e=this.createElement("stop"),e.setAttribute("offset","100%"),e.setAttribute("style","stop-color:"+t+o),f.appendChild(e),f};mxSvgCanvas2D.prototype.addNode=function(n,t){var i=this.node,r=this.state;if(i!=null){if(i.nodeName=="path")if(this.path!=null&&this.path.length>0)i.setAttribute("d",this.path.join(" "));else return;n&&r.fillColor!=null?this.updateFill():this.styleEnabled||(i.nodeName=="ellipse"&&mxClient.IS_FF?i.setAttribute("fill","transparent"):i.setAttribute("fill","none"),n=!1);t&&r.strokeColor!=null?this.updateStroke():this.styleEnabled||i.setAttribute("stroke","none");r.transform!=null&&r.transform.length>0&&i.setAttribute("transform",r.transform);r.shadow&&this.root.appendChild(this.createShadow(i));this.strokeTolerance>0&&!n&&this.root.appendChild(this.createTolerance(i));this.pointerEvents&&(i.nodeName!="path"||this.path[this.path.length-1]==this.closeOp)?i.setAttribute("pointer-events",this.pointerEventsValue):this.pointerEvents||this.originalRoot!=null||i.setAttribute("pointer-events","none");(i.nodeName!="rect"&&i.nodeName!="path"&&i.nodeName!="ellipse"||i.getAttribute("fill")!="none"&&i.getAttribute("fill")!="transparent"||i.getAttribute("stroke")!="none"||i.getAttribute("pointer-events")!="none")&&this.root.appendChild(i);this.node=null}};mxSvgCanvas2D.prototype.updateFill=function(){var n=this.state,t,i;(n.alpha<1||n.fillAlpha<1)&&this.node.setAttribute("fill-opacity",n.alpha*n.fillAlpha);n.fillColor!=null&&(n.gradientColor!=null?(t=this.getSvgGradient(n.fillColor,n.gradientColor,n.gradientFillAlpha,n.gradientAlpha,n.gradientDirection),mxClient.IS_CHROME_APP||mxClient.IS_IE||mxClient.IS_IE11||mxClient.IS_EDGE||this.root.ownerDocument!=document?this.node.setAttribute("fill","url(#"+t+")"):(i=this.getBaseUrl().replace(/([\(\)])/g,"\\$1"),this.node.setAttribute("fill","url("+i+"#"+t+")"))):this.node.setAttribute("fill",n.fillColor.toLowerCase()))};mxSvgCanvas2D.prototype.getCurrentStrokeWidth=function(){return Math.max(1,this.format(this.state.strokeWidth*this.state.scale))};mxSvgCanvas2D.prototype.updateStroke=function(){var n=this.state,t;this.node.setAttribute("stroke",n.strokeColor.toLowerCase());(n.alpha<1||n.strokeAlpha<1)&&this.node.setAttribute("stroke-opacity",n.alpha*n.strokeAlpha);t=this.getCurrentStrokeWidth();t!=1&&this.node.setAttribute("stroke-width",t);this.node.nodeName=="path"&&this.updateStrokeAttributes();n.dashed&&this.node.setAttribute("stroke-dasharray",this.createDashPattern((n.fixDash?1:n.strokeWidth)*n.scale))};mxSvgCanvas2D.prototype.updateStrokeAttributes=function(){var n=this.state,t;n.lineJoin!=null&&n.lineJoin!="miter"&&this.node.setAttribute("stroke-linejoin",n.lineJoin);n.lineCap!=null&&(t=n.lineCap,t=="flat"&&(t="butt"),t!="butt"&&this.node.setAttribute("stroke-linecap",t));n.miterLimit==null||this.styleEnabled&&n.miterLimit==10||this.node.setAttribute("stroke-miterlimit",n.miterLimit)};mxSvgCanvas2D.prototype.createDashPattern=function(n){var r=[],i,t;if(typeof this.state.dashPattern=="string"&&(i=this.state.dashPattern.split(" "),i.length>0))for(t=0;t<i.length;t++)r[t]=Number(i[t])*n;return r.join(" ")};mxSvgCanvas2D.prototype.createTolerance=function(n){var t=n.cloneNode(!0),i=parseFloat(t.getAttribute("stroke-width")||1)+this.strokeTolerance;return t.setAttribute("pointer-events","stroke"),t.setAttribute("visibility","hidden"),t.removeAttribute("stroke-dasharray"),t.setAttribute("stroke-width",i),t.setAttribute("fill","none"),t.setAttribute("stroke",mxClient.IS_OT?"none":"white"),t};mxSvgCanvas2D.prototype.createShadow=function(n){var t=n.cloneNode(!0),i=this.state;return t.getAttribute("fill")=="none"||mxClient.IS_FF&&t.getAttribute("fill")=="transparent"||t.setAttribute("fill",i.shadowColor),t.getAttribute("stroke")!="none"&&t.setAttribute("stroke",i.shadowColor),t.setAttribute("transform","translate("+this.format(i.shadowDx*i.scale)+","+this.format(i.shadowDy*i.scale)+")"+(i.transform||"")),t.setAttribute("opacity",i.shadowAlpha),t};mxSvgCanvas2D.prototype.setLink=function(n){if(n==null)this.root=this.originalRoot;else{this.originalRoot=this.root;var t=this.createElement("a");t.setAttributeNS==null||this.root.ownerDocument!=document&&document.documentMode==null?t.setAttribute("xlink:href",n):t.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",n);this.root.appendChild(t);this.root=t}};mxSvgCanvas2D.prototype.rotate=function(n,t,i,r,u){var f;if(n!=0||t||i){if(f=this.state,r+=f.dx,u+=f.dy,r*=f.scale,u*=f.scale,f.transform=f.transform||"",t&&i)n+=180;else if(t!=i){var e=t?r:0,s=t?-1:1,o=i?u:0,h=i?-1:1;f.transform+="translate("+this.format(e)+","+this.format(o)+")scale("+this.format(s)+","+this.format(h)+")translate("+this.format(-e)+","+this.format(-o)+")"}(t?!i:i)&&(n*=-1);n!=0&&(f.transform+="rotate("+this.format(n)+","+this.format(r)+","+this.format(u)+")");f.rotation=f.rotation+n;f.rotationCx=r;f.rotationCy=u}};mxSvgCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments);this.node=this.createElement("path")};mxSvgCanvas2D.prototype.rect=function(n,t,i,r){var u=this.state,f=this.createElement("rect");f.setAttribute("x",this.format((n+u.dx)*u.scale));f.setAttribute("y",this.format((t+u.dy)*u.scale));f.setAttribute("width",this.format(i*u.scale));f.setAttribute("height",this.format(r*u.scale));this.node=f};mxSvgCanvas2D.prototype.roundrect=function(n,t,i,r,u,f){this.rect(n,t,i,r);u>0&&this.node.setAttribute("rx",this.format(u*this.state.scale));f>0&&this.node.setAttribute("ry",this.format(f*this.state.scale))};mxSvgCanvas2D.prototype.ellipse=function(n,t,i,r){var u=this.state,f=this.createElement("ellipse");f.setAttribute("cx",Math.round((n+i/2+u.dx)*u.scale));f.setAttribute("cy",Math.round((t+r/2+u.dy)*u.scale));f.setAttribute("rx",i/2*u.scale);f.setAttribute("ry",r/2*u.scale);this.node=f};mxSvgCanvas2D.prototype.image=function(n,t,i,r,u,f,e,o){var h,s,c;if(u=this.converter.convert(u),f=f!=null?f:!0,e=e!=null?e:!1,o=o!=null?o:!1,h=this.state,n+=h.dx,t+=h.dy,s=this.createElement("image"),s.setAttribute("x",this.format(n*h.scale)+this.imageOffset),s.setAttribute("y",this.format(t*h.scale)+this.imageOffset),s.setAttribute("width",this.format(i*h.scale)),s.setAttribute("height",this.format(r*h.scale)),s.setAttributeNS==null?s.setAttribute("xlink:href",u):s.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",u),f||s.setAttribute("preserveAspectRatio","none"),(h.alpha<1||h.fillAlpha<1)&&s.setAttribute("opacity",h.alpha*h.fillAlpha),c=this.state.transform||"",e||o){var l=1,a=1,v=0,y=0;e&&(l=-1,v=-i-2*n);o&&(a=-1,y=-r-2*t);c+="scale("+l+","+a+")translate("+v*h.scale+","+y*h.scale+")"}c.length>0&&s.setAttribute("transform",c);this.pointerEvents||s.setAttribute("pointer-events","none");this.root.appendChild(s);this.blockImagePointerEvents&&(s.setAttribute("style","pointer-events:none"),s=this.createElement("rect"),s.setAttribute("visibility","hidden"),s.setAttribute("pointer-events","fill"),s.setAttribute("x",this.format(n*h.scale)),s.setAttribute("y",this.format(t*h.scale)),s.setAttribute("width",this.format(i*h.scale)),s.setAttribute("height",this.format(r*h.scale)),this.root.appendChild(s))};mxSvgCanvas2D.prototype.convertHtml=function(n){var u,i,r,f,t,o,e;if(this.useDomParser)u=(new DOMParser).parseFromString(n,"text/html"),u!=null&&(n=(new XMLSerializer).serializeToString(u.body),n.substring(0,5)=="<body"&&(n=n.substring(n.indexOf(">",5)+1)),n.substring(n.length-7,n.length)=="<\/body>"&&(n=n.substring(0,n.length-7)));else{if(document.implementation!=null&&document.implementation.createDocument!=null){for(i=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),r=i.createElement("body"),i.documentElement.appendChild(r),f=document.createElement("div"),f.innerHTML=n,t=f.firstChild;t!=null;)o=t.nextSibling,r.appendChild(i.adoptNode(t)),t=o;return r.innerHTML}e=document.createElement("textarea");e.innerHTML=n.replace(/&amp;/g,"&amp;amp;").replace(/&#60;/g,"&amp;lt;").replace(/&#62;/g,"&amp;gt;").replace(/&lt;/g,"&amp;lt;").replace(/&gt;/g,"&amp;gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n=e.value.replace(/&/g,"&amp;").replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;").replace(/&amp;amp;/g,"&amp;").replace(/<br>/g,"<br />").replace(/<hr>/g,"<hr />").replace(/(<img[^>]+)>/gm,"$1 />")}return n};mxSvgCanvas2D.prototype.createDiv=function(n,t,i,r,u){var e=this.state,h=mxConstants.ABSOLUTE_LINE_HEIGHT?e.fontSize*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT*this.lineHeightCorrection,s,f,o;return r="display:inline-block;font-size:"+e.fontSize+"px;font-family:"+e.fontFamily+";color:"+e.fontColor+";line-height:"+h+";"+r,(e.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(r+="font-weight:bold;"),(e.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(r+="font-style:italic;"),(e.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(r+="text-decoration:underline;"),t==mxConstants.ALIGN_CENTER?r+="text-align:center;":t==mxConstants.ALIGN_RIGHT&&(r+="text-align:right;"),s="",e.fontBackgroundColor!=null&&(s+="background-color:"+e.fontBackgroundColor+";"),e.fontBorderColor!=null&&(s+="border:1px solid "+e.fontBorderColor+";"),f=n,mxUtils.isNode(f)||(f=this.convertHtml(f),u!="fill"&&u!="width"?f='<div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;'+s+'">'+f+"<\/div>":r+=s),!mxClient.IS_IE&&document.createElementNS?(o=document.createElementNS("http://www.w3.org/1999/xhtml","div"),o.setAttribute("style",r),mxUtils.isNode(f)?this.root.ownerDocument!=document?o.appendChild(f.cloneNode(!0)):o.appendChild(f):o.innerHTML=f,o):(mxUtils.isNode(f)&&this.root.ownerDocument!=document&&(f=f.outerHTML),mxUtils.parseXml('<div xmlns="http://www.w3.org/1999/xhtml" style="'+r+'">'+f+"<\/div>").documentElement)};mxSvgCanvas2D.prototype.invalidateCachedOffsetSize=function(n){delete n.firstChild.mxCachedOffsetWidth;delete n.firstChild.mxCachedFinalOffsetWidth;delete n.firstChild.mxCachedFinalOffsetHeight};mxSvgCanvas2D.prototype.updateText=function(n,t,i,r,u,f,e,o,s,h,c){var l,nt,k,b,d,tt;if(c!=null&&c.firstChild!=null&&c.firstChild.firstChild!=null&&c.firstChild.firstChild.firstChild!=null){var a=c.firstChild,g=a.firstChild,y=g.firstChild;h=h!=null?h:0;l=this.state;n+=l.dx;t+=l.dy;s?(y.style.maxHeight=Math.round(r)+"px",y.style.maxWidth=Math.round(i)+"px"):o=="fill"?(y.style.width=Math.round(i+1)+"px",y.style.height=Math.round(r+1)+"px"):o=="width"&&(y.style.width=Math.round(i+1)+"px",r>0&&(y.style.maxHeight=Math.round(r)+"px"));e&&i>0&&(y.style.width=Math.round(i+1)+"px");var v=0,p=0,it=0,w=y;w.firstChild!=null&&w.firstChild.nodeName=="DIV"&&(w=w.firstChild);nt=a.mxCachedOffsetWidth!=null?a.mxCachedOffsetWidth:w.offsetWidth;v=nt+it;e&&o!="fill"&&(s&&(v=Math.min(v,i)),y.style.width=Math.round(v+1)+"px");v=a.mxCachedFinalOffsetWidth!=null?a.mxCachedFinalOffsetWidth:w.offsetWidth;p=a.mxCachedFinalOffsetHeight!=null?a.mxCachedFinalOffsetHeight:w.offsetHeight;this.cacheOffsetSize&&(a.mxCachedOffsetWidth=nt,a.mxCachedFinalOffsetWidth=v,a.mxCachedFinalOffsetHeight=p);v+=it;p-=2;s&&(p=Math.min(p,r),v=Math.min(v,i));o=="width"?r=p:o!="fill"&&(i=v,r=p);k=0;b=0;u==mxConstants.ALIGN_CENTER?k-=i/2:u==mxConstants.ALIGN_RIGHT&&(k-=i);n+=k;f==mxConstants.ALIGN_MIDDLE?b-=r/2:f==mxConstants.ALIGN_BOTTOM&&(b-=r);o!="fill"&&mxClient.IS_FF&&mxClient.IS_WIN&&(b-=2);t+=b;d=l.scale!=1?"scale("+l.scale+")":"";l.rotation!=0&&this.rotateHtml?(d+="rotate("+l.rotation+","+i/2+","+r/2+")",tt=this.rotatePoint((n+i/2)*l.scale,(t+r/2)*l.scale,l.rotation,l.rotationCx,l.rotationCy),n=tt.x-i*l.scale/2,t=tt.y-r*l.scale/2):(n*=l.scale,t*=l.scale);h!=0&&(d+="rotate("+h+","+-k+","+-b+")");a.setAttribute("transform","translate("+Math.round(n)+","+Math.round(t)+")"+d);g.setAttribute("width",Math.round(Math.max(1,i)));g.setAttribute("height",Math.round(Math.max(1,r)))}};mxSvgCanvas2D.prototype.text=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v,it,nt,w,y,p,k,g,d,ot,ut,rt,st,ct,lt,ht;if(this.textEnabled&&u!=null)if(l=l!=null?l:0,v=this.state,n+=v.dx,t+=v.dy,this.foEnabled&&s=="html"){if(it="vertical-align:top;",c?it+="overflow:hidden;max-height:"+Math.round(r)+"px;max-width:"+Math.round(i)+"px;":h=="fill"?it+="width:"+Math.round(i+1)+"px;height:"+Math.round(r+1)+"px;overflow:hidden;":h=="width"&&(it+="width:"+Math.round(i+1)+"px;",r>0&&(it+="max-height:"+Math.round(r)+"px;overflow:hidden;")),it+=o&&i>0?"width:"+Math.round(i+1)+"px;white-space:normal;word-wrap:"+mxConstants.WORD_WRAP+";":"white-space:nowrap;",nt=this.createElement("g"),v.alpha<1&&nt.setAttribute("opacity",v.alpha),w=this.createElement("foreignObject"),w.setAttribute("style","overflow:visible;"),w.setAttribute("pointer-events","all"),y=this.createDiv(u,f,e,it,h),y==null)return;a!=null&&y.setAttribute("dir",a);nt.appendChild(w);this.root.appendChild(nt);var b=0,tt=0,ft=2,et=2;mxClient.IS_IE&&(document.documentMode==9||!mxClient.IS_SVG)?(p=document.createElement("div"),p.style.cssText=y.getAttribute("style"),p.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",p.style.position="absolute",p.style.visibility="hidden",k=document.createElement("div"),k.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",k.style.wordWrap=mxConstants.WORD_WRAP,k.innerHTML=mxUtils.isNode(u)?u.outerHTML:u,p.appendChild(k),document.body.appendChild(p),document.documentMode!=8&&document.documentMode!=9&&v.fontBorderColor!=null&&(ft+=2,et+=2),o&&i>0?(d=k.offsetWidth,padDx=0,!c&&o&&i>0&&this.root.ownerDocument!=document&&h!="fill"&&(ot=p.style.whiteSpace,k.style.whiteSpace="nowrap",d<k.offsetWidth&&(p.style.whiteSpace=ot)),c&&(d=Math.min(d,i)),p.style.width=d+"px",b=k.offsetWidth+ft+padDx,tt=k.offsetHeight+et,p.style.display="inline-block",p.style.position="",p.style.visibility="",p.style.width=b+"px",y.setAttribute("style",p.style.cssText)):(b=k.offsetWidth+ft,tt=k.offsetHeight+et),p.parentNode.removeChild(p),w.appendChild(y)):(this.root.ownerDocument!=document?(y.style.visibility="hidden",document.body.appendChild(y)):w.appendChild(y),g=y,g.firstChild!=null&&g.firstChild.nodeName=="DIV"&&(g=g.firstChild,o&&y.style.wordWrap=="break-word"&&(g.style.width="100%")),d=g.offsetWidth,d==0&&y.parentNode==w&&(y.style.visibility="hidden",document.body.appendChild(y),d=g.offsetWidth),this.cacheOffsetSize&&(nt.mxCachedOffsetWidth=d),!c&&o&&i>0&&this.root.ownerDocument!=document&&h!="fill"&&h!="width"&&(ot=y.style.whiteSpace,y.style.whiteSpace="nowrap",d<g.offsetWidth&&(y.style.whiteSpace=ot)),b=d+ft-1,o&&h!="fill"&&h!="width"&&(c&&(b=Math.min(b,i)),y.style.width=b+"px"),b=g.offsetWidth,tt=g.offsetHeight,this.cacheOffsetSize&&(nt.mxCachedFinalOffsetWidth=b,nt.mxCachedFinalOffsetHeight=tt),tt-=et,y.parentNode!=w&&(w.appendChild(y),y.style.visibility=""));c&&(tt=Math.min(tt,r),b=Math.min(b,i));h=="width"?r=tt:h!="fill"&&(i=b,r=tt);v.alpha<1&&nt.setAttribute("opacity",v.alpha);ut=0;rt=0;f==mxConstants.ALIGN_CENTER?ut-=i/2:f==mxConstants.ALIGN_RIGHT&&(ut-=i);n+=ut;e==mxConstants.ALIGN_MIDDLE?rt-=r/2:e==mxConstants.ALIGN_BOTTOM&&(rt-=r);h!="fill"&&mxClient.IS_FF&&mxClient.IS_WIN&&(rt-=2);t+=rt;st=v.scale!=1?"scale("+v.scale+")":"";v.rotation!=0&&this.rotateHtml?(st+="rotate("+v.rotation+","+i/2+","+r/2+")",ct=this.rotatePoint((n+i/2)*v.scale,(t+r/2)*v.scale,v.rotation,v.rotationCx,v.rotationCy),n=ct.x-i*v.scale/2,t=ct.y-r*v.scale/2):(n*=v.scale,t*=v.scale);l!=0&&(st+="rotate("+l+","+-ut+","+-rt+")");nt.setAttribute("transform","translate("+(Math.round(n)+this.foOffset)+","+(Math.round(t)+this.foOffset)+")"+st);w.setAttribute("width",Math.round(Math.max(1,i)));w.setAttribute("height",Math.round(Math.max(1,r)));this.root.ownerDocument!=document&&(lt=this.createAlternateContent(w,n,t,i,r,u,f,e,o,s,h,c,l),lt!=null&&(w.setAttribute("requiredFeatures","http://www.w3.org/TR/SVG11/feature#Extensibility"),ht=this.createElement("switch"),ht.appendChild(w),ht.appendChild(lt),nt.appendChild(ht)))}else this.plainText(n,t,i,r,u,f,e,o,h,c,l,a)};mxSvgCanvas2D.prototype.createClip=function(n,t,i,r){var u;n=Math.round(n);t=Math.round(t);i=Math.round(i);r=Math.round(r);for(var e="mx-clip-"+n+"-"+t+"-"+i+"-"+r,o=0,f=e+"-"+o;document.getElementById(f)!=null;)f=e+"-"+ ++o;return clip=this.createElement("clipPath"),clip.setAttribute("id",f),u=this.createElement("rect"),u.setAttribute("x",n),u.setAttribute("y",t),u.setAttribute("width",i),u.setAttribute("height",r),clip.appendChild(u),clip};mxSvgCanvas2D.prototype.plainText=function(n,t,i,r,u,f,e,o,s,h,c,l){var nt,y,b,ut,rt,tt,p,g;c=c!=null?c:0;var a=this.state,w=a.fontSize,v=this.createElement("g"),it=a.transform||"";this.updateFont(v);c!=0&&(it+="rotate("+c+","+this.format(n*a.scale)+","+this.format(t*a.scale)+")");l!=null&&v.setAttribute("direction",l);h&&i>0&&r>0&&(nt=n,y=t,f==mxConstants.ALIGN_CENTER?nt-=i/2:f==mxConstants.ALIGN_RIGHT&&(nt-=i),s!="fill"&&(e==mxConstants.ALIGN_MIDDLE?y-=r/2:e==mxConstants.ALIGN_BOTTOM&&(y-=r)),b=this.createClip(nt*a.scale-2,y*a.scale-2,i*a.scale+4,r*a.scale+4),this.defs!=null?this.defs.appendChild(b):this.root.appendChild(b),mxClient.IS_CHROME_APP||mxClient.IS_IE||mxClient.IS_IE11||mxClient.IS_EDGE||this.root.ownerDocument!=document?v.setAttribute("clip-path","url(#"+b.getAttribute("id")+")"):(ut=this.getBaseUrl().replace(/([\(\)])/g,"\\$1"),v.setAttribute("clip-path","url("+ut+"#"+b.getAttribute("id")+")")));rt=f==mxConstants.ALIGN_RIGHT?"end":f==mxConstants.ALIGN_CENTER?"middle":"start";rt!="start"&&v.setAttribute("text-anchor",rt);this.styleEnabled&&w==mxConstants.DEFAULT_FONTSIZE||v.setAttribute("font-size",w*a.scale+"px");it.length>0&&v.setAttribute("transform",it);a.alpha<1&&v.setAttribute("opacity",a.alpha);var k=u.split("\n"),ft=Math.round(w*mxConstants.LINE_HEIGHT),d=w+(k.length-1)*ft,y=t+w-1;for(e==mxConstants.ALIGN_MIDDLE?s=="fill"?y-=r/2:(tt=(this.matchHtmlAlignment&&h&&r>0?Math.min(d,r):d)/2,y-=tt+1):e==mxConstants.ALIGN_BOTTOM&&(s=="fill"?y-=r:(tt=this.matchHtmlAlignment&&h&&r>0?Math.min(d,r):d,y-=tt+2)),p=0;p<k.length;p++)k[p].length>0&&mxUtils.trim(k[p]).length>0&&(g=this.createElement("text"),g.setAttribute("x",this.format(n*a.scale)+this.textOffset),g.setAttribute("y",this.format(y*a.scale)+this.textOffset),mxUtils.write(g,k[p]),v.appendChild(g)),y+=ft;this.root.appendChild(v);this.addTextBackground(v,u,n,t,i,s=="fill"?r:d,f,e,s)};mxSvgCanvas2D.prototype.updateFont=function(n){var t=this.state;n.setAttribute("fill",t.fontColor);this.styleEnabled&&t.fontFamily==mxConstants.DEFAULT_FONTFAMILY||n.setAttribute("font-family",t.fontFamily);(t.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&n.setAttribute("font-weight","bold");(t.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&n.setAttribute("font-style","italic");(t.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&n.setAttribute("text-decoration","underline")};mxSvgCanvas2D.prototype.addTextBackground=function(n,t,i,r,u,f,e,o,s){var h=this.state,l,v,c,u,f,a,y;if(h.fontBackgroundColor!=null||h.fontBorderColor!=null){if(l=null,s=="fill"||s=="width")e==mxConstants.ALIGN_CENTER?i-=u/2:e==mxConstants.ALIGN_RIGHT&&(i-=u),o==mxConstants.ALIGN_MIDDLE?r-=f/2:o==mxConstants.ALIGN_BOTTOM&&(r-=f),l=new mxRectangle((i+1)*h.scale,r*h.scale,(u-2)*h.scale,(f+2)*h.scale);else if(n.getBBox!=null&&this.root.ownerDocument==document)try{l=n.getBBox();v=mxClient.IS_IE&&mxClient.IS_SVG;l=new mxRectangle(l.x,l.y+(v?0:1),l.width,l.height+(v?1:0))}catch(p){}else c=document.createElement("div"),c.style.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?h.fontSize*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT,c.style.fontSize=h.fontSize+"px",c.style.fontFamily=h.fontFamily,c.style.whiteSpace="nowrap",c.style.position="absolute",c.style.visibility="hidden",c.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",c.style.zoom="1",(h.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(c.style.fontWeight="bold"),(h.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(c.style.fontStyle="italic"),t=mxUtils.htmlEntities(t,!1),c.innerHTML=t.replace(/\n/g,"<br/>"),document.body.appendChild(c),u=c.offsetWidth,f=c.offsetHeight,c.parentNode.removeChild(c),e==mxConstants.ALIGN_CENTER?i-=u/2:e==mxConstants.ALIGN_RIGHT&&(i-=u),o==mxConstants.ALIGN_MIDDLE?r-=f/2:o==mxConstants.ALIGN_BOTTOM&&(r-=f),l=new mxRectangle((i+1)*h.scale,(r+2)*h.scale,u*h.scale,(f+1)*h.scale);l!=null&&(a=this.createElement("rect"),a.setAttribute("fill",h.fontBackgroundColor||"none"),a.setAttribute("stroke",h.fontBorderColor||"none"),a.setAttribute("x",Math.floor(l.x-1)),a.setAttribute("y",Math.floor(l.y-1)),a.setAttribute("width",Math.ceil(l.width+2)),a.setAttribute("height",Math.ceil(l.height)),y=h.fontBorderColor!=null?Math.max(1,this.format(h.scale)):0,a.setAttribute("stroke-width",y),this.root.ownerDocument==document&&mxUtils.mod(y,2)==1&&a.setAttribute("transform","translate(0.5, 0.5)"),n.insertBefore(a,n.firstChild))}};mxSvgCanvas2D.prototype.stroke=function(){this.addNode(!1,!0)};mxSvgCanvas2D.prototype.fill=function(){this.addNode(!0,!1)};mxSvgCanvas2D.prototype.fillAndStroke=function(){this.addNode(!0,!0)};mxVmlCanvas2D=function(n){mxAbstractCanvas2D.call(this);this.root=n};mxUtils.extend(mxVmlCanvas2D,mxAbstractCanvas2D);mxVmlCanvas2D.prototype.node=null;mxVmlCanvas2D.prototype.textEnabled=!0;mxVmlCanvas2D.prototype.moveOp="m";mxVmlCanvas2D.prototype.lineOp="l";mxVmlCanvas2D.prototype.curveOp="c";mxVmlCanvas2D.prototype.closeOp="x";mxVmlCanvas2D.prototype.rotatedHtmlBackground="";mxVmlCanvas2D.prototype.vmlScale=1;mxVmlCanvas2D.prototype.createElement=function(n){return document.createElement(n)};mxVmlCanvas2D.prototype.createVmlElement=function(n){return this.createElement(mxClient.VML_PREFIX+":"+n)};mxVmlCanvas2D.prototype.addNode=function(n,t){var i=this.node,r=this.state;if(i!=null){if(i.nodeName=="shape")if(this.path!=null&&this.path.length>0)i.path=this.path.join(" ")+" e",i.style.width=this.root.style.width,i.style.height=this.root.style.height,i.coordsize=parseInt(i.style.width)+" "+parseInt(i.style.height);else return;i.strokeweight=this.format(Math.max(1,r.strokeWidth*r.scale/this.vmlScale))+"px";r.shadow&&this.root.appendChild(this.createShadow(i,n&&r.fillColor!=null,t&&r.strokeColor!=null));t&&r.strokeColor!=null?(i.stroked="true",i.strokecolor=r.strokeColor):i.stroked="false";i.appendChild(this.createStroke());n&&r.fillColor!=null?i.appendChild(this.createFill()):this.pointerEvents&&(i.nodeName!="shape"||this.path[this.path.length-1]==this.closeOp)?i.appendChild(this.createTransparentFill()):i.filled="false";this.root.appendChild(i)}};mxVmlCanvas2D.prototype.createTransparentFill=function(){var n=this.createVmlElement("fill");return n.src=mxClient.imageBasePath+"/transparent.gif",n.type="tile",n};mxVmlCanvas2D.prototype.createFill=function(){var n=this.state,t=this.createVmlElement("fill"),i;return t.color=n.fillColor,n.gradientColor!=null?(t.type="gradient",t.method="none",t.color2=n.gradientColor,i=180-n.rotation,n.gradientDirection==mxConstants.DIRECTION_WEST?i-=90+(this.root.style.flip=="x"?180:0):n.gradientDirection==mxConstants.DIRECTION_EAST?i+=90+(this.root.style.flip=="x"?180:0):n.gradientDirection==mxConstants.DIRECTION_NORTH?i-=180+(this.root.style.flip=="y"?-180:0):i+=this.root.style.flip=="y"?-180:0,(this.root.style.flip=="x"||this.root.style.flip=="y")&&(i*=-1),t.angle=mxUtils.mod(i,360),t.opacity=n.alpha*n.gradientFillAlpha*100+"%",t.setAttribute(mxClient.OFFICE_PREFIX+":opacity2",n.alpha*n.gradientAlpha*100+"%")):(n.alpha<1||n.fillAlpha<1)&&(t.opacity=n.alpha*n.fillAlpha*100+"%"),t};mxVmlCanvas2D.prototype.createStroke=function(){var n=this.state,t=this.createVmlElement("stroke");return t.endcap=n.lineCap||"flat",t.joinstyle=n.lineJoin||"miter",t.miterlimit=n.miterLimit||"10",(n.alpha<1||n.strokeAlpha<1)&&(t.opacity=n.alpha*n.strokeAlpha*100+"%"),n.dashed&&(t.dashstyle=this.getVmlDashStyle()),t};mxVmlCanvas2D.prototype.getVmlDashStyle=function(){var t="dash",n;return typeof this.state.dashPattern=="string"&&(n=this.state.dashPattern.split(" "),n.length>0&&n[0]==1&&(t="0 2")),t};mxVmlCanvas2D.prototype.createShadow=function(n,t,i){var u=this.state,o=-u.rotation*(Math.PI/180),s=Math.cos(o),h=Math.sin(o),f=u.shadowDx*u.scale,e=u.shadowDy*u.scale,r;return this.root.style.flip=="x"?f*=-1:this.root.style.flip=="y"&&(e*=-1),r=n.cloneNode(!0),r.style.marginLeft=Math.round(f*s-e*h)+"px",r.style.marginTop=Math.round(f*h+e*s)+"px",document.documentMode==8&&(r.strokeweight=n.strokeweight,n.nodeName=="shape"&&(r.path=this.path.join(" ")+" e",r.style.width=this.root.style.width,r.style.height=this.root.style.height,r.coordsize=parseInt(n.style.width)+" "+parseInt(n.style.height))),i?(r.strokecolor=u.shadowColor,r.appendChild(this.createShadowStroke())):r.stroked="false",t?r.appendChild(this.createShadowFill()):r.filled="false",r};mxVmlCanvas2D.prototype.createShadowFill=function(){var n=this.createVmlElement("fill");return n.color=this.state.shadowColor,n.opacity=this.state.alpha*this.state.shadowAlpha*100+"%",n};mxVmlCanvas2D.prototype.createShadowStroke=function(){var n=this.createStroke();return n.opacity=this.state.alpha*this.state.shadowAlpha*100+"%",n};mxVmlCanvas2D.prototype.rotate=function(n,t,i,r,u){t&&i?n+=180:t?this.root.style.flip="x":i&&(this.root.style.flip="y");(t?!i:i)&&(n*=-1);this.root.style.rotation=n;this.state.rotation=this.state.rotation+n;this.state.rotationCx=r;this.state.rotationCy=u};mxVmlCanvas2D.prototype.begin=function(){mxAbstractCanvas2D.prototype.begin.apply(this,arguments);this.node=this.createVmlElement("shape");this.node.style.position="absolute"};mxVmlCanvas2D.prototype.quadTo=function(n,t,i,r){var u=this.state,o=(this.lastX+u.dx)*u.scale,s=(this.lastY+u.dy)*u.scale,h=(n+u.dx)*u.scale,c=(t+u.dy)*u.scale,f=(i+u.dx)*u.scale,e=(r+u.dy)*u.scale,l=o+2/3*(h-o),a=s+2/3*(c-s),v=f+2/3*(h-f),y=e+2/3*(c-e);this.path.push("c "+this.format(l)+" "+this.format(a)+" "+this.format(v)+" "+this.format(y)+" "+this.format(f)+" "+this.format(e));this.lastX=f/u.scale-u.dx;this.lastY=e/u.scale-u.dy};mxVmlCanvas2D.prototype.createRect=function(n,t,i,r,u){var f=this.state,e=this.createVmlElement(n);return e.style.position="absolute",e.style.left=this.format((t+f.dx)*f.scale)+"px",e.style.top=this.format((i+f.dy)*f.scale)+"px",e.style.width=this.format(r*f.scale)+"px",e.style.height=this.format(u*f.scale)+"px",e};mxVmlCanvas2D.prototype.rect=function(n,t,i,r){this.node=this.createRect("rect",n,t,i,r)};mxVmlCanvas2D.prototype.roundrect=function(n,t,i,r,u,f){this.node=this.createRect("roundrect",n,t,i,r);this.node.setAttribute("arcsize",Math.max(u*100/i,f*100/r)+"%")};mxVmlCanvas2D.prototype.ellipse=function(n,t,i,r){this.node=this.createRect("oval",n,t,i,r)};mxVmlCanvas2D.prototype.image=function(n,t,i,r,u,f,e,o){var s=null,h;f?(s=this.createRect("rect",n,t,i,r),s.stroked="false",h=this.createVmlElement("fill"),h.aspect=f?"atmost":"ignore",h.rotate="true",h.type="frame",h.src=u,s.appendChild(h)):(s=this.createRect("image",n,t,i,r),s.src=u);e&&o?s.style.rotation="180":e?s.style.flip="x":o&&(s.style.flip="y");(this.state.alpha<1||this.state.fillAlpha<1)&&(s.style.filter+="alpha(opacity="+this.state.alpha*this.state.fillAlpha*100+")");this.root.appendChild(s)};mxVmlCanvas2D.prototype.createDiv=function(n,t,i,r){var o=this.createElement("div"),u=this.state,s="",e,f;return u.fontBackgroundColor!=null&&(s+="background-color:"+u.fontBackgroundColor+";"),u.fontBorderColor!=null&&(s+="border:1px solid "+u.fontBorderColor+";"),mxUtils.isNode(n)?o.appendChild(n):r!="fill"&&r!="width"?(e=this.createElement("div"),e.style.cssText=s,e.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",e.style.zoom="1",e.style.textDecoration="inherit",e.innerHTML=n,o.appendChild(e)):(o.style.cssText=s,o.innerHTML=n),f=o.style,f.fontSize=u.fontSize/this.vmlScale+"px",f.fontFamily=u.fontFamily,f.color=u.fontColor,f.verticalAlign="top",f.textAlign=t||"left",f.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?u.fontSize*mxConstants.LINE_HEIGHT/this.vmlScale+"px":mxConstants.LINE_HEIGHT,(u.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(f.fontWeight="bold"),(u.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(f.fontStyle="italic"),(u.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(f.textDecoration="underline"),o};mxVmlCanvas2D.prototype.text=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var p,st,y,k,ft,it,ht,ct,nt,g,lt,at,tt,vt,pt,w;if(this.textEnabled&&u!=null)if(p=this.state,s=="html"){p.rotation!=null&&(st=this.rotatePoint(n,t,p.rotation,p.rotationCx,p.rotationCy),n=st.x,t=st.y);document.documentMode!=8||mxClient.IS_EM?(n*=p.scale,t*=p.scale):(n+=p.dx,t+=p.dy,h!="fill"&&e==mxConstants.ALIGN_TOP&&(t-=1));y=document.documentMode==8&&!mxClient.IS_EM?this.createVmlElement("group"):this.createElement("div");y.style.position="absolute";y.style.display="inline";y.style.left=this.format(n)+"px";y.style.top=this.format(t)+"px";y.style.zoom=p.scale;k=this.createElement("div");k.style.position="relative";k.style.display="inline";var yt=mxUtils.getAlignmentAsPoint(f,e),rt=yt.x,ut=yt.y,v=this.createDiv(u,f,e,h),d=this.createElement("div");if(a!=null&&v.setAttribute("dir",a),o&&i>0?(c||(v.style.width=Math.round(i)+"px"),v.style.wordWrap=mxConstants.WORD_WRAP,v.style.whiteSpace="normal",v.style.wordWrap=="break-word"&&(g=v,g.firstChild!=null&&g.firstChild.nodeName=="DIV"&&(g.firstChild.style.width="100%"))):v.style.whiteSpace="nowrap",ft=p.rotation+(l||0),this.rotateHtml&&ft!=0?(d.style.display="inline",d.style.zoom="1",d.appendChild(v),document.documentMode!=8||mxClient.IS_EM||this.root.nodeName=="DIV"?y.appendChild(d):(k.appendChild(d),y.appendChild(k))):document.documentMode!=8||mxClient.IS_EM?(v.style.display="inline",y.appendChild(v)):(k.appendChild(v),y.appendChild(k)),this.root.nodeName!="DIV"?(it=this.createVmlElement("rect"),it.stroked="false",it.filled="false",it.appendChild(y),this.root.appendChild(it)):this.root.appendChild(y),c?(v.style.overflow="hidden",v.style.width=Math.round(i)+"px",mxClient.IS_QUIRKS||(v.style.maxHeight=Math.round(r)+"px")):h=="fill"?(v.style.overflow="hidden",v.style.width=Math.max(0,i)+1+"px",v.style.height=Math.max(0,r)+1+"px"):h=="width"&&(v.style.overflow="hidden",v.style.width=Math.max(0,i)+1+"px",v.style.maxHeight=Math.max(0,r)+1+"px"),this.rotateHtml&&ft!=0){var b=ft*(Math.PI/180),et=parseFloat(parseFloat(Math.cos(b)).toFixed(8)),ot=parseFloat(parseFloat(Math.sin(-b)).toFixed(8));b%=2*Math.PI;b<0&&(b+=2*Math.PI);b%=Math.PI;b>Math.PI/2&&(b=Math.PI-b);ht=Math.cos(b);ct=Math.sin(b);document.documentMode!=8||mxClient.IS_EM||(v.style.display="inline-block",d.style.display="inline-block",k.style.display="inline-block");v.style.visibility="hidden";v.style.position="absolute";document.body.appendChild(v);nt=v;nt.firstChild!=null&&nt.firstChild.nodeName=="DIV"&&(nt=nt.firstChild);g=nt.offsetWidth+3;w=nt.offsetHeight;c?(i=Math.min(i,g),w=Math.min(w,r)):i=g;o&&(v.style.width=i+"px");mxClient.IS_QUIRKS&&(c||h=="width")&&w>r&&(w=r,v.style.height=w+"px");r=w;lt=(r-r*ht+i*-ct)/2-ot*i*(rt+.5)+et*r*(ut+.5);at=(i-i*ht+r*-ct)/2+et*i*(rt+.5)+ot*r*(ut+.5);y.nodeName=="group"&&this.root.nodeName=="DIV"?(tt=this.createElement("div"),tt.style.display="inline-block",tt.style.position="absolute",tt.style.left=this.format(n+(at-i/2)*p.scale)+"px",tt.style.top=this.format(t+(lt-r/2)*p.scale)+"px",y.parentNode.appendChild(tt),tt.appendChild(y)):(vt=document.documentMode==8&&!mxClient.IS_EM?1:p.scale,y.style.left=this.format(n+(at-i/2)*vt)+"px",y.style.top=this.format(t+(lt-r/2)*vt)+"px");d.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+et+", M12="+ot+", M21="+-ot+", M22="+et+", sizingMethod='auto expand')";d.style.backgroundColor=this.rotatedHtmlBackground;this.state.alpha<1&&(d.style.filter+="alpha(opacity="+this.state.alpha*100+")");d.appendChild(v);v.style.position="";v.style.visibility=""}else document.documentMode!=8||mxClient.IS_EM?(v.style.verticalAlign="top",this.state.alpha<1&&(y.style.filter="alpha(opacity="+this.state.alpha*100+")"),pt=v.parentNode,v.style.visibility="hidden",document.body.appendChild(v),i=v.offsetWidth,w=v.offsetHeight,mxClient.IS_QUIRKS&&c&&w>r&&(w=r,v.style.height=w+"px"),r=w,v.style.visibility="",pt.appendChild(v),y.style.left=this.format(n+i*rt*this.state.scale)+"px",y.style.top=this.format(t+r*ut*this.state.scale)+"px"):(this.state.alpha<1&&(v.style.filter="alpha(opacity="+this.state.alpha*100+")"),k.style.left=rt*100+"%",k.style.top=ut*100+"%")}else this.plainText(n,t,i,r,mxUtils.htmlEntities(u,!1),f,e,o,s,h,c,l,a)};mxVmlCanvas2D.prototype.plainText=function(n,t,i,r,u,f,e,o,s,h,c,l){var a=this.state,v,w,b,y,k,d;n=(n+a.dx)*a.scale;t=(t+a.dy)*a.scale;v=this.createVmlElement("shape");v.style.width="1px";v.style.height="1px";v.stroked="false";w=this.createVmlElement("fill");w.color=a.fontColor;w.opacity=a.alpha*100+"%";v.appendChild(w);b=this.createVmlElement("path");b.textpathok="true";b.v="m "+this.format(0)+" "+this.format(0)+" l "+this.format(1)+" "+this.format(0);v.appendChild(b);y=this.createVmlElement("textpath");y.style.cssText="v-text-align:"+f;y.style.align=f;y.style.fontFamily=a.fontFamily;y.string=u;y.on="true";k=a.fontSize*a.scale/this.vmlScale;y.style.fontSize=k+"px";(a.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&(y.style.fontWeight="bold");(a.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&(y.style.fontStyle="italic");(a.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&(y.style.textDecoration="underline");var tt=u.split("\n"),g=k+(tt.length-1)*k*mxConstants.LINE_HEIGHT,nt=0,p=0;e==mxConstants.ALIGN_BOTTOM?p=-g/2:e!=mxConstants.ALIGN_MIDDLE&&(p=g/2);l!=null&&(v.style.rotation=l,d=l*(Math.PI/180),nt=Math.sin(d)*p,p=Math.cos(d)*p);v.appendChild(y);v.style.left=this.format(n-nt)+"px";v.style.top=this.format(t+p)+"px";this.root.appendChild(v)};mxVmlCanvas2D.prototype.stroke=function(){this.addNode(!1,!0)};mxVmlCanvas2D.prototype.fill=function(){this.addNode(!0,!1)};mxVmlCanvas2D.prototype.fillAndStroke=function(){this.addNode(!0,!0)};mxGuide.prototype.graph=null;mxGuide.prototype.states=null;mxGuide.prototype.horizontal=!0;mxGuide.prototype.vertical=!0;mxGuide.prototype.guideX=null;mxGuide.prototype.guideY=null;mxGuide.prototype.setStates=function(n){this.states=n};mxGuide.prototype.isEnabledForEvent=function(){return!0};mxGuide.prototype.getGuideTolerance=function(){return this.graph.gridSize/2};mxGuide.prototype.createGuideShape=function(){var n=new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH);return n.isDashed=!0,n};mxGuide.prototype.move=function(n,t,i){var b,r,ft,et,k;if(this.states!=null&&(this.horizontal||this.vertical)&&n!=null&&t!=null){var y=this.graph.getView().translate,f=this.graph.getView().scale,e=t.x,o=t.y,p=!1,s=null,a=null,w=!1,h=null,v=null,d=this.getGuideTolerance(),c=d,l=d,u=n.clone();u.x+=t.x;u.y+=t.y;var g=u.x,nt=u.x+u.width,tt=u.getCenterX(),it=u.y,rt=u.y+u.height,ut=u.getCenterY();function ot(t,i){t+=this.graph.panDx;var r=!1;Math.abs(t-tt)<c?(e=t-n.getCenterX(),c=Math.abs(t-tt),r=!0):Math.abs(t-g)<c?(e=t-n.x,c=Math.abs(t-g),r=!0):Math.abs(t-nt)<c&&(e=t-n.x-n.width,c=Math.abs(t-nt),r=!0);r&&(s=i,a=Math.round(t-this.graph.panDx),this.guideX==null&&(this.guideX=this.createGuideShape(!0),this.guideX.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideX.pointerEvents=!1,this.guideX.init(this.graph.getView().getOverlayPane())));p=p||r}function st(t){t+=this.graph.panDy;var i=!1;Math.abs(t-ut)<l?(o=t-n.getCenterY(),l=Math.abs(t-ut),i=!0):Math.abs(t-it)<l?(o=t-n.y,l=Math.abs(t-it),i=!0):Math.abs(t-rt)<l&&(o=t-n.y-n.height,l=Math.abs(t-rt),i=!0);i&&(h=r,v=Math.round(t-this.graph.panDy),this.guideY==null&&(this.guideY=this.createGuideShape(!1),this.guideY.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.guideY.pointerEvents=!1,this.guideY.init(this.graph.getView().getOverlayPane())));w=w||i}for(b=0;b<this.states.length;b++)r=this.states[b],r!=null&&(this.horizontal&&(ot.call(this,r.getCenterX(),r),ot.call(this,r.x,r),ot.call(this,r.x+r.width,r)),this.vertical&&(st.call(this,r.getCenterY(),r),st.call(this,r.y,r),st.call(this,r.y+r.height,r)));i&&(p||(ft=n.x-(this.graph.snap(n.x/f-y.x)+y.x)*f,e=this.graph.snap(e/f)*f-ft),w||(et=n.y-(this.graph.snap(n.y/f-y.y)+y.y)*f,o=this.graph.snap(o/f)*f-et));k=this.graph.container;p||this.guideX==null?this.guideX!=null&&(s!=null&&n!=null&&(minY=Math.min(n.y+o-this.graph.panDy,s.y),maxY=Math.max(n.y+n.height+o-this.graph.panDy,s.y+s.height)),this.guideX.points=minY!=null&&maxY!=null?[new mxPoint(a,minY),new mxPoint(a,maxY)]:[new mxPoint(a,-this.graph.panDy),new mxPoint(a,k.scrollHeight-3-this.graph.panDy)],this.guideX.stroke=this.getGuideColor(s,!0),this.guideX.node.style.visibility="visible",this.guideX.redraw()):this.guideX.node.style.visibility="hidden";w||this.guideY==null?this.guideY!=null&&(h!=null&&n!=null&&(minX=Math.min(n.x+e-this.graph.panDx,h.x),maxX=Math.max(n.x+n.width+e-this.graph.panDx,h.x+h.width)),this.guideY.points=minX!=null&&maxX!=null?[new mxPoint(minX,v),new mxPoint(maxX,v)]:[new mxPoint(-this.graph.panDx,v),new mxPoint(k.scrollWidth-3-this.graph.panDx,v)],this.guideY.stroke=this.getGuideColor(h,!1),this.guideY.node.style.visibility="visible",this.guideY.redraw()):this.guideY.node.style.visibility="hidden";t=new mxPoint(e,o)}return t};mxGuide.prototype.getGuideColor=function(){return mxConstants.GUIDE_COLOR};mxGuide.prototype.hide=function(){this.setVisible(!1)};mxGuide.prototype.setVisible=function(n){this.guideX!=null&&(this.guideX.node.style.visibility=n?"visible":"hidden");this.guideY!=null&&(this.guideY.node.style.visibility=n?"visible":"hidden")};mxGuide.prototype.destroy=function(){this.guideX!=null&&(this.guideX.destroy(),this.guideX=null);this.guideY!=null&&(this.guideY.destroy(),this.guideY=null)};mxStencil.defaultLocalized=!1;mxStencil.allowEval=!1;mxStencil.prototype.desc=null;mxStencil.prototype.constraints=null;mxStencil.prototype.aspect=null;mxStencil.prototype.w0=null;mxStencil.prototype.h0=null;mxStencil.prototype.bgNode=null;mxStencil.prototype.fgNode=null;mxStencil.prototype.strokewidth=null;mxStencil.prototype.parseDescription=function(){var n,t;this.fgNode=this.desc.getElementsByTagName("foreground")[0];this.bgNode=this.desc.getElementsByTagName("background")[0];this.w0=Number(this.desc.getAttribute("w")||100);this.h0=Number(this.desc.getAttribute("h")||100);n=this.desc.getAttribute("aspect");this.aspect=n!=null?n:"variable";t=this.desc.getAttribute("strokewidth");this.strokewidth=t!=null?t:"1"};mxStencil.prototype.parseConstraints=function(){var i=this.desc.getElementsByTagName("connections")[0],n,t;if(i!=null&&(n=mxUtils.getChildNodes(i),n!=null&&n.length>0))for(this.constraints=[],t=0;t<n.length;t++)this.constraints.push(this.parseConstraint(n[t]))};mxStencil.prototype.parseConstraint=function(n){var t=Number(n.getAttribute("x")),i=Number(n.getAttribute("y")),r=n.getAttribute("perimeter")=="1",u=n.getAttribute("name");return new mxConnectionConstraint(new mxPoint(t,i),r,u)};mxStencil.prototype.evaluateTextAttribute=function(n,t,i){var r=this.evaluateAttribute(n,t,i),u=n.getAttribute("localized");return(mxStencil.defaultLocalized&&u==null||u=="1")&&(r=mxResources.get(r)),r};mxStencil.prototype.evaluateAttribute=function(n,t,i){var r=n.getAttribute(t),u,f;return r==null&&(u=mxUtils.getTextContent(n),u!=null&&mxStencil.allowEval&&(f=mxUtils.eval(u),typeof f=="function"&&(r=f(i)))),r};mxStencil.prototype.drawShape=function(n,t,i,r,u,f){var o=mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,null),e=this.computeAspect(t.style,i,r,u,f,o),s=Math.min(e.width,e.height),h=this.strokewidth=="inherit"?Number(mxUtils.getNumber(t.style,mxConstants.STYLE_STROKEWIDTH,1)):Number(this.strokewidth)*s;n.setStrokeWidth(h);this.drawChildren(n,t,i,r,u,f,this.bgNode,e,!1);this.drawChildren(n,t,i,r,u,f,this.fgNode,e,!0)};mxStencil.prototype.drawChildren=function(n,t,i,r,u,f,e,o,s){if(e!=null&&u>0&&f>0)for(var h=e.firstChild;h!=null;)h.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(n,t,h,o,s),h=h.nextSibling};mxStencil.prototype.computeAspect=function(n,t,i,r,u,f){var s=t,h=i,o=r/this.w0,e=u/this.h0,l=f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH,c;return l&&(e=r/this.h0,o=u/this.w0,c=(r-u)/2,s+=c,h-=c),this.aspect=="fixed"&&(e=Math.min(o,e),o=e,l?(s+=(u-this.w0*o)/2,h+=(r-this.h0*e)/2):(s+=(r-this.w0*o)/2,h+=(u-this.h0*e)/2)),new mxRectangle(s,h,o,e)};mxStencil.prototype.drawNode=function(n,t,i,r,u){var f=i.nodeName,s=r.x,h=r.y,e=r.width,o=r.height,w=Math.min(e,o),c,y,rt,ut,l,g,ot,a,p,nt,v;if(f=="save")n.save();else if(f=="restore")n.restore();else if(f=="path")for(n.begin(),c=i.firstChild;c!=null;)c.nodeType==mxConstants.NODETYPE_ELEMENT&&this.drawNode(n,t,c,r,u),c=c.nextSibling;else if(f=="close")n.close();else if(f=="move")n.moveTo(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o);else if(f=="line")n.lineTo(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o);else if(f=="quad")n.quadTo(s+Number(i.getAttribute("x1"))*e,h+Number(i.getAttribute("y1"))*o,s+Number(i.getAttribute("x2"))*e,h+Number(i.getAttribute("y2"))*o);else if(f=="curve")n.curveTo(s+Number(i.getAttribute("x1"))*e,h+Number(i.getAttribute("y1"))*o,s+Number(i.getAttribute("x2"))*e,h+Number(i.getAttribute("y2"))*o,s+Number(i.getAttribute("x3"))*e,h+Number(i.getAttribute("y3"))*o);else if(f=="arc")n.arcTo(Number(i.getAttribute("rx"))*e,Number(i.getAttribute("ry"))*o,Number(i.getAttribute("x-axis-rotation")),Number(i.getAttribute("large-arc-flag")),Number(i.getAttribute("sweep-flag")),s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o);else if(f=="rect")n.rect(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o,Number(i.getAttribute("w"))*e,Number(i.getAttribute("h"))*o);else if(f=="roundrect"){y=Number(i.getAttribute("arcsize"));y==0&&(y=mxConstants.RECTANGLE_ROUNDING_FACTOR*100);var b=Number(i.getAttribute("w"))*e,k=Number(i.getAttribute("h"))*o,tt=Number(y)/100,it=Math.min(b*tt,k*tt);n.roundrect(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o,b,k,it,it)}else if(f=="ellipse")n.ellipse(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o,Number(i.getAttribute("w"))*e,Number(i.getAttribute("h"))*o);else if(f=="image")t.outline||(rt=this.evaluateAttribute(i,"src",t),n.image(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o,Number(i.getAttribute("w"))*e,Number(i.getAttribute("h"))*o,rt,!1,i.getAttribute("flipH")=="1",i.getAttribute("flipV")=="1"));else if(f=="text"){if(!t.outline){if(ut=this.evaluateTextAttribute(i,"str",t),l=i.getAttribute("vertical")=="1"?-90:0,i.getAttribute("align-shape")=="0"){var d=t.rotation,ft=mxUtils.getValue(t.style,mxConstants.STYLE_FLIPH,0)==1,et=mxUtils.getValue(t.style,mxConstants.STYLE_FLIPV,0)==1;ft&&et?l-=d:ft||et?l+=d:l-=d}l-=i.getAttribute("rotation");n.text(s+Number(i.getAttribute("x"))*e,h+Number(i.getAttribute("y"))*o,0,0,ut,i.getAttribute("align")||"left",i.getAttribute("valign")||"top",!1,"",null,!1,l)}}else if(f=="include-shape"){if(g=mxStencilRegistry.getStencil(i.getAttribute("name")),g!=null){var st=s+Number(i.getAttribute("x"))*e,ht=h+Number(i.getAttribute("y"))*o,b=Number(i.getAttribute("w"))*e,k=Number(i.getAttribute("h"))*o;g.drawShape(n,t,st,ht,b,k)}}else if(f=="fillstroke")n.fillAndStroke();else if(f=="fill")n.fill();else if(f=="stroke")n.stroke();else if(f=="strokewidth")ot=i.getAttribute("fixed")=="1"?1:w,n.setStrokeWidth(Number(i.getAttribute("width"))*ot);else if(f=="dashed")n.setDashed(i.getAttribute("dashed")=="1");else if(f=="dashpattern"){if(a=i.getAttribute("pattern"),a!=null){for(p=a.split(" "),nt=[],v=0;v<p.length;v++)p[v].length>0&&nt.push(Number(p[v])*w);a=nt.join(" ");n.setDashPattern(a)}}else f=="strokecolor"?n.setStrokeColor(i.getAttribute("color")):f=="linecap"?n.setLineCap(i.getAttribute("cap")):f=="linejoin"?n.setLineJoin(i.getAttribute("join")):f=="miterlimit"?n.setMiterLimit(Number(i.getAttribute("limit"))):f=="fillcolor"?n.setFillColor(i.getAttribute("color")):f=="alpha"?n.setAlpha(i.getAttribute("alpha")):f=="fontcolor"?n.setFontColor(i.getAttribute("color")):f=="fontstyle"?n.setFontStyle(i.getAttribute("style")):f=="fontfamily"?n.setFontFamily(i.getAttribute("family")):f=="fontsize"&&n.setFontSize(Number(i.getAttribute("size"))*w);u&&(f=="fillstroke"||f=="fill"||f=="stroke")&&(u=!1,n.setShadow(!1))};mxShape.prototype.dialect=null;mxShape.prototype.scale=1;mxShape.prototype.antiAlias=!0;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.state=null;mxShape.prototype.style=null;mxShape.prototype.boundingBox=null;mxShape.prototype.stencil=null;mxShape.prototype.svgStrokeTolerance=8;mxShape.prototype.pointerEvents=!0;mxShape.prototype.svgPointerEvents="all";mxShape.prototype.shapePointerEvents=!1;mxShape.prototype.stencilPointerEvents=!1;mxShape.prototype.vmlScale=1;mxShape.prototype.outline=!1;mxShape.prototype.visible=!0;mxShape.prototype.useSvgBoundingBox=!1;mxShape.prototype.init=function(n){this.node==null&&(this.node=this.create(n),n!=null&&n.appendChild(this.node))};mxShape.prototype.initStyles=function(){this.strokewidth=1;this.rotation=0;this.opacity=100;this.fillOpacity=100;this.strokeOpacity=100;this.flipH=!1;this.flipV=!1};mxShape.prototype.isParseVml=function(){return!0};mxShape.prototype.isHtmlAllowed=function(){return!1};mxShape.prototype.getSvgScreenOffset=function(){var n=this.stencil&&this.stencil.strokewidth!="inherit"?Number(this.stencil.strokewidth):this.strokewidth;return mxUtils.mod(Math.max(1,Math.round(n*this.scale)),2)==1?.5:0};mxShape.prototype.create=function(n){return n!=null&&n.ownerSVGElement!=null?this.createSvg(n):document.documentMode==8||!mxClient.IS_VML||this.dialect!=mxConstants.DIALECT_VML&&this.isHtmlAllowed()?this.createHtml(n):this.createVml(n)};mxShape.prototype.createSvg=function(){return document.createElementNS(mxConstants.NS_SVG,"g")};mxShape.prototype.createVml=function(){var n=document.createElement(mxClient.VML_PREFIX+":group");return n.style.position="absolute",n};mxShape.prototype.createHtml=function(){var n=document.createElement("div");return n.style.position="absolute",n};mxShape.prototype.reconfigure=function(){this.redraw()};mxShape.prototype.redraw=function(){this.updateBoundsFromPoints();this.visible&&this.checkBounds()?(this.node.style.visibility="visible",this.clear(),this.node.nodeName=="DIV"&&(this.isHtmlAllowed()||!mxClient.IS_VML)?this.redrawHtmlShape():this.redrawShape(),this.updateBoundingBox()):(this.node.style.visibility="hidden",this.boundingBox=null)};mxShape.prototype.clear=function(){if(this.node.ownerSVGElement!=null)while(this.node.lastChild!=null)this.node.removeChild(this.node.lastChild);else this.node.style.cssText="position:absolute;"+(this.cursor!=null?"cursor:"+this.cursor+";":""),this.node.innerHTML=""};mxShape.prototype.updateBoundsFromPoints=function(){var n=this.points,t;if(n!=null&&n.length>0&&n[0]!=null)for(this.bounds=new mxRectangle(Number(n[0].x),Number(n[0].y),1,1),t=1;t<this.points.length;t++)n[t]!=null&&this.bounds.add(new mxRectangle(Number(n[t].x),Number(n[t].y),1,1))};mxShape.prototype.getLabelBounds=function(n){var e=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),i=n,t,u,f,r;return(e!=mxConstants.DIRECTION_SOUTH&&e!=mxConstants.DIRECTION_NORTH&&this.state!=null&&this.state.text!=null&&this.state.text.isPaintBoundsInverted()&&(i=i.clone(),r=i.width,i.width=i.height,i.height=r),t=this.getLabelMargins(i),t!=null)?(u=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,!1)=="1",f=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,!1)=="1",this.state!=null&&this.state.text!=null&&this.state.text.isPaintBoundsInverted()&&(r=t.x,t.x=t.height,t.height=t.width,t.width=t.y,t.y=r,r=u,u=f,f=r),mxUtils.getDirectedBounds(n,t,this.style,u,f)):n};mxShape.prototype.getLabelMargins=function(){return null};mxShape.prototype.checkBounds=function(){return!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)&&this.bounds.width>0&&this.bounds.height>0};mxShape.prototype.createVmlGroup=function(){var n=document.createElement(mxClient.VML_PREFIX+":group");return n.style.position="absolute",n.style.width=this.node.style.width,n.style.height=this.node.style.height,n};mxShape.prototype.redrawShape=function(){var n=this.createCanvas();n!=null&&(n.pointerEvents=this.pointerEvents,this.paint(n),this.node!=n.root&&this.node.insertAdjacentHTML("beforeend",n.root.outerHTML),this.node.nodeName=="DIV"&&document.documentMode==8&&(this.node.style.filter="",mxUtils.addTransparentBackgroundFilter(this.node)),this.destroyCanvas(n))};mxShape.prototype.createCanvas=function(){var n=null;return this.node.ownerSVGElement!=null?n=this.createSvgCanvas():mxClient.IS_VML&&(this.updateVmlContainer(),n=this.createVmlCanvas()),n!=null&&this.outline&&(n.setStrokeWidth(this.strokewidth),n.setStrokeColor(this.stroke),this.isDashed!=null&&n.setDashed(this.isDashed),n.setStrokeWidth=function(){},n.setStrokeColor=function(){},n.setFillColor=function(){},n.setGradient=function(){},n.setDashed=function(){}),n};mxShape.prototype.createSvgCanvas=function(){var n=new mxSvgCanvas2D(this.node,!1),t;return n.strokeTolerance=this.pointerEvents?this.svgStrokeTolerance:0,n.pointerEventsValue=this.svgPointerEvents,n.blockImagePointerEvents=mxClient.IS_FF,t=this.getSvgScreenOffset(),t!=0?this.node.setAttribute("transform","translate("+t+","+t+")"):this.node.removeAttribute("transform"),this.antiAlias||(n.format=function(n){return Math.round(parseFloat(n))}),n};mxShape.prototype.createVmlCanvas=function(){var t=document.documentMode==8&&this.isParseVml()?this.createVmlGroup():this.node,n=new mxVmlCanvas2D(t,!1),r,u,i;return t.tagUrn!=""&&(r=Math.max(1,Math.round(this.bounds.width)),u=Math.max(1,Math.round(this.bounds.height)),t.coordsize=r*this.vmlScale+","+u*this.vmlScale,n.scale(this.vmlScale),n.vmlScale=this.vmlScale),i=this.scale,n.translate(-Math.round(this.bounds.x/i),-Math.round(this.bounds.y/i)),n};mxShape.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";var n=Math.max(1,Math.round(this.bounds.width)),t=Math.max(1,Math.round(this.bounds.height));this.node.style.width=n+"px";this.node.style.height=t+"px";this.node.style.overflow="visible"};mxShape.prototype.redrawHtmlShape=function(){this.updateHtmlBounds(this.node);this.updateHtmlFilters(this.node);this.updateHtmlColors(this.node)};mxShape.prototype.updateHtmlFilters=function(n){var u="",f;if(this.opacity<100&&(u+="alpha(opacity="+this.opacity+")"),this.isShadow&&(u+="progid:DXImageTransform.Microsoft.dropShadow (OffX='"+Math.round(mxConstants.SHADOW_OFFSET_X*this.scale)+"', OffY='"+Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale)+"', Color='"+mxConstants.VML_SHADOWCOLOR+"')"),this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE){var t=this.fill,i=this.gradient,e="0",o={east:0,south:1,west:2,north:3},r=this.direction!=null?o[this.direction]:0;this.gradientDirection!=null&&(r=mxUtils.mod(r+o[this.gradientDirection]-1,4));r==1?(e="1",f=t,t=i,i=f):r==2?(f=t,t=i,i=f):r==3&&(e="1");u+="progid:DXImageTransform.Microsoft.gradient(startColorStr='"+t+"', endColorStr='"+i+"', gradientType='"+e+"')"}n.style.filter=u};mxShape.prototype.updateHtmlColors=function(n){var t=this.stroke;t!=null&&t!=mxConstants.NONE?(n.style.borderColor=t,this.isDashed?n.style.borderStyle="dashed":this.strokewidth>0&&(n.style.borderStyle="solid"),n.style.borderWidth=Math.max(1,Math.ceil(this.strokewidth*this.scale))+"px"):n.style.borderWidth="0px";t=this.outline?null:this.fill;t!=null&&t!=mxConstants.NONE?(n.style.backgroundColor=t,n.style.backgroundImage="none"):this.pointerEvents?n.style.backgroundColor="transparent":document.documentMode==8?mxUtils.addTransparentBackgroundFilter(n):this.setTransparentBackgroundImage(n)};mxShape.prototype.updateHtmlBounds=function(n){var t=document.documentMode>=9?0:Math.ceil(this.strokewidth*this.scale);n.style.borderWidth=Math.max(1,t)+"px";n.style.overflow="hidden";n.style.left=Math.round(this.bounds.x-t/2)+"px";n.style.top=Math.round(this.bounds.y-t/2)+"px";document.compatMode=="CSS1Compat"&&(t=-t);n.style.width=Math.round(Math.max(0,this.bounds.width+t))+"px";n.style.height=Math.round(Math.max(0,this.bounds.height+t))+"px"};mxShape.prototype.destroyCanvas=function(n){var i,t;if(n instanceof mxSvgCanvas2D){for(i in n.gradients)t=n.gradients[i],t!=null&&(t.mxRefCount=(t.mxRefCount||0)+1);this.releaseSvgGradients(this.oldGradients);this.oldGradients=n.gradients}};mxShape.prototype.paint=function(n){var t=this.scale,e=this.bounds.x/t,o=this.bounds.y/t,r=this.bounds.width/t,u=this.bounds.height/t,c,a,s,i,h,l,f;if(this.isPaintBoundsInverted()&&(c=(r-u)/2,e+=c,o-=c,a=r,r=u,u=a),this.updateTransform(n,e,o,r,u),this.configureCanvas(n,e,o,r,u),s=null,(this.stencil==null&&this.points==null&&this.shapePointerEvents||this.stencil!=null&&this.stencilPointerEvents)&&(i=this.createBoundingBox(),this.dialect==mxConstants.DIALECT_SVG?(s=this.createTransparentSvgRectangle(i.x,i.y,i.width,i.height),this.node.appendChild(s)):(h=n.createRect("rect",i.x/t,i.y/t,i.width/t,i.height/t),h.appendChild(n.createTransparentFill()),h.stroked="false",n.root.appendChild(h))),this.stencil!=null)this.stencil.drawShape(n,this,e,o,r,u);else if(n.setStrokeWidth(this.strokewidth),this.points!=null){for(l=[],f=0;f<this.points.length;f++)this.points[f]!=null&&l.push(new mxPoint(this.points[f].x/t,this.points[f].y/t));this.paintEdgeShape(n,l)}else this.paintVertexShape(n,e,o,r,u);s!=null&&n.state!=null&&n.state.transform!=null&&s.setAttribute("transform",n.state.transform)};mxShape.prototype.configureCanvas=function(n,t,i,r,u){var e=null,f;this.style!=null&&(e=this.style.dashPattern);n.setAlpha(this.opacity/100);n.setFillAlpha(this.fillOpacity/100);n.setStrokeAlpha(this.strokeOpacity/100);this.isShadow!=null&&n.setShadow(this.isShadow);this.isDashed!=null&&n.setDashed(this.isDashed,this.style!=null?mxUtils.getValue(this.style,mxConstants.STYLE_FIX_DASH,!1)==1:!1);e!=null&&n.setDashPattern(e);this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE?(f=this.getGradientBounds(n,t,i,r,u),n.setGradient(this.fill,this.gradient,f.x,f.y,f.width,f.height,this.gradientDirection)):n.setFillColor(this.fill);n.setStrokeColor(this.stroke)};mxShape.prototype.getGradientBounds=function(n,t,i,r,u){return new mxRectangle(t,i,r,u)};mxShape.prototype.updateTransform=function(n,t,i,r,u){n.scale(this.scale);n.rotate(this.getShapeRotation(),this.flipH,this.flipV,t+r/2,i+u/2)};mxShape.prototype.paintVertexShape=function(n,t,i,r,u){this.paintBackground(n,t,i,r,u);n.setShadow(!1);this.paintForeground(n,t,i,r,u)};mxShape.prototype.paintBackground=function(){};mxShape.prototype.paintForeground=function(){};mxShape.prototype.paintEdgeShape=function(){};mxShape.prototype.getArcSize=function(n,t){var i=0,r;return mxUtils.getValue(this.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0)=="1"?i=Math.min(n/2,Math.min(t/2,mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2)):(r=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,i=Math.min(n*r,t*r)),i};mxShape.prototype.paintGlassEffect=function(n,t,i,r,u,f){var e=Math.ceil(this.strokewidth/2),o=.4;n.setGradient("#ffffff","#ffffff",t,i,r,u*.6,"south",.9,.1);n.begin();f+=2*e;this.isRounded?(n.moveTo(t-e+f,i-e),n.quadTo(t-e,i-e,t-e,i-e+f),n.lineTo(t-e,i+u*o),n.quadTo(t+r*.5,i+u*.7,t+r+e,i+u*o),n.lineTo(t+r+e,i-e+f),n.quadTo(t+r+e,i-e,t+r+e-f,i-e)):(n.moveTo(t-e,i-e),n.lineTo(t-e,i+u*o),n.quadTo(t+r*.5,i+u*.7,t+r+e,i+u*o),n.lineTo(t+r+e,i-e));n.close();n.fill()};mxShape.prototype.addPoints=function(n,t,i,r,u,f,e){var v,p,w,c,s,y;if(t!=null&&t.length>0){for(e=e!=null?e:!0,v=t[t.length-1],u&&i&&(t=t.slice(),p=t[0],w=new mxPoint(v.x+(p.x-v.x)/2,v.y+(p.y-v.y)/2),t.splice(0,0,w)),c=t[0],s=1,e?n.moveTo(c.x,c.y):n.lineTo(c.x,c.y);s<(u?t.length:t.length-1);){var o=t[mxUtils.mod(s,t.length)],l=c.x-o.x,a=c.y-o.y;if(i&&(l!=0||a!=0)&&(f==null||mxUtils.indexOf(f,s-1)<0)){var h=Math.sqrt(l*l+a*a),d=l*Math.min(r,h/2)/h,g=a*Math.min(r,h/2)/h,nt=o.x+d,tt=o.y+g;for(n.lineTo(nt,tt),y=t[mxUtils.mod(s+1,t.length)];s<t.length-2&&Math.round(y.x-o.x)==0&&Math.round(y.y-o.y)==0;)y=t[mxUtils.mod(s+2,t.length)],s++;l=y.x-o.x;a=y.y-o.y;h=Math.max(1,Math.sqrt(l*l+a*a));var it=l*Math.min(r,h/2)/h,rt=a*Math.min(r,h/2)/h,b=o.x+it,k=o.y+rt;n.quadTo(o.x,o.y,b,k);o=new mxPoint(b,k)}else n.lineTo(o.x,o.y);c=o;s++}u?n.close():n.lineTo(v.x,v.y)}};mxShape.prototype.resetStyles=function(){this.initStyles();this.spacing=0;delete this.fill;delete this.gradient;delete this.gradientDirection;delete this.stroke;delete this.startSize;delete this.endSize;delete this.startArrow;delete this.endArrow;delete this.direction;delete this.isShadow;delete this.isDashed;delete this.isRounded;delete this.glass};mxShape.prototype.apply=function(n){if(this.state=n,this.style=n.style,this.style!=null){if(this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_FILLCOLOR,this.fill),this.gradient=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient),this.gradientDirection=mxUtils.getValue(this.style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection),this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_OPACITY,this.opacity),this.fillOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_FILL_OPACITY,this.fillOpacity),this.strokeOpacity=mxUtils.getValue(this.style,mxConstants.STYLE_STROKE_OPACITY,this.strokeOpacity),this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_STROKECOLOR,this.stroke),this.strokewidth=mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth),this.spacing=mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing),this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,this.startSize),this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,this.endSize),this.startArrow=mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,this.startArrow),this.endArrow=mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,this.endArrow),this.rotation=mxUtils.getValue(this.style,mxConstants.STYLE_ROTATION,this.rotation),this.direction=mxUtils.getValue(this.style,mxConstants.STYLE_DIRECTION,this.direction),this.flipH=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0)==1,this.flipV=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0)==1,this.stencil!=null&&(this.flipH=mxUtils.getValue(this.style,"stencilFlipH",0)==1||this.flipH,this.flipV=mxUtils.getValue(this.style,"stencilFlipV",0)==1||this.flipV),this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){var t=this.flipH;this.flipH=this.flipV;this.flipV=t}this.isShadow=mxUtils.getValue(this.style,mxConstants.STYLE_SHADOW,this.isShadow)==1;this.isDashed=mxUtils.getValue(this.style,mxConstants.STYLE_DASHED,this.isDashed)==1;this.isRounded=mxUtils.getValue(this.style,mxConstants.STYLE_ROUNDED,this.isRounded)==1;this.glass=mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,this.glass)==1;this.fill==mxConstants.NONE&&(this.fill=null);this.gradient==mxConstants.NONE&&(this.gradient=null);this.stroke==mxConstants.NONE&&(this.stroke=null)}};mxShape.prototype.setCursor=function(n){n==null&&(n="");this.cursor=n;this.node!=null&&(this.node.style.cursor=n)};mxShape.prototype.getCursor=function(){return this.cursor};mxShape.prototype.updateBoundingBox=function(){var n,t,i;if(this.useSvgBoundingBox&&this.node!=null&&this.node.ownerSVGElement!=null)try{if(n=this.node.getBBox(),n.width>0&&n.height>0){this.boundingBox=new mxRectangle(n.x,n.y,n.width,n.height);this.boundingBox.grow(this.strokewidth*this.scale/2);return}}catch(r){}this.bounds!=null&&(t=this.createBoundingBox(),t!=null&&(this.augmentBoundingBox(t),i=this.getShapeRotation(),i!=0&&(t=mxUtils.getBoundingBox(t,i))),this.boundingBox=t)};mxShape.prototype.createBoundingBox=function(){var n=this.bounds.clone();return(this.stencil!=null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)||this.isPaintBoundsInverted())&&n.rotate90(),n};mxShape.prototype.augmentBoundingBox=function(n){this.isShadow&&(n.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale),n.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale));n.grow(this.strokewidth*this.scale/2)};mxShape.prototype.isPaintBoundsInverted=function(){return this.stencil==null&&(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH)};mxShape.prototype.getRotation=function(){return this.rotation!=null?this.rotation:0};mxShape.prototype.getTextRotation=function(){var n=this.getRotation();return mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)!=1&&(n+=mxText.prototype.verticalTextRotation),n};mxShape.prototype.getShapeRotation=function(){var n=this.getRotation();return this.direction!=null&&(this.direction==mxConstants.DIRECTION_NORTH?n+=270:this.direction==mxConstants.DIRECTION_WEST?n+=180:this.direction==mxConstants.DIRECTION_SOUTH&&(n+=90)),n};mxShape.prototype.createTransparentSvgRectangle=function(n,t,i,r){var u=document.createElementNS(mxConstants.NS_SVG,"rect");return u.setAttribute("x",n),u.setAttribute("y",t),u.setAttribute("width",i),u.setAttribute("height",r),u.setAttribute("fill","none"),u.setAttribute("stroke","none"),u.setAttribute("pointer-events","all"),u};mxShape.prototype.setTransparentBackgroundImage=function(n){n.style.backgroundImage="url('"+mxClient.imageBasePath+"/transparent.gif')"};mxShape.prototype.releaseSvgGradients=function(n){var i,t;if(n!=null)for(i in n)t=n[i],t!=null&&(t.mxRefCount=(t.mxRefCount||0)-1,t.mxRefCount==0&&t.parentNode!=null&&t.parentNode.removeChild(t))};mxShape.prototype.destroy=function(){this.node!=null&&(mxEvent.release(this.node),this.node.parentNode!=null&&this.node.parentNode.removeChild(this.node),this.node=null);this.releaseSvgGradients(this.oldGradients);this.oldGradients=null};mxStencilRegistry={stencils:{},addStencil:function(n,t){mxStencilRegistry.stencils[n]=t},getStencil:function(n){return mxStencilRegistry.stencils[n]}};mxMarker={markers:[],addMarker:function(n,t){mxMarker.markers[n]=t},createMarker:function(n,t,i,r,u,f,e,o,s,h){var c=mxMarker.markers[i];return c!=null?c(n,t,i,r,u,f,e,o,s,h):null}},function(){function n(n){return n=n!=null?n:2,function(t,i,r,u,f,e,o,s,h,c){var v=f*h*1.118,y=e*h*1.118,l,a;return f=f*(o+h),e=e*(o+h),l=u.clone(),l.x-=v,l.y-=y,a=r!=mxConstants.ARROW_CLASSIC&&r!=mxConstants.ARROW_CLASSIC_THIN?1:3/4,u.x+=-f*a-v,u.y+=-e*a-y,function(){t.begin();t.moveTo(l.x,l.y);t.lineTo(l.x-f-e/n,l.y-e+f/n);(r==mxConstants.ARROW_CLASSIC||r==mxConstants.ARROW_CLASSIC_THIN)&&t.lineTo(l.x-f*3/4,l.y-e*3/4);t.lineTo(l.x+e/n-f,l.y-e-f/n);t.close();c?t.fillAndStroke():t.stroke()}}}function t(n){return n=n!=null?n:2,function(t,i,r,u,f,e,o,s,h){var l=f*h*1.118,a=e*h*1.118,c;return f=f*(o+h),e=e*(o+h),c=u.clone(),c.x-=l,c.y-=a,u.x+=-l*2,u.y+=-a*2,function(){t.begin();t.moveTo(c.x-f-e/n,c.y-e+f/n);t.lineTo(c.x,c.y);t.lineTo(c.x+e/n-f,c.y-e-f/n);t.stroke()}}}function i(n,t,i,r,u,f,e,o,s,h){var a=i==mxConstants.ARROW_DIAMOND?.7071:.9862,v=u*s*a,y=f*s*a,c,l;return u=u*(e+s),f=f*(e+s),c=r.clone(),c.x-=v,c.y-=y,r.x+=-u-v,r.y+=-f-y,l=i==mxConstants.ARROW_DIAMOND?2:3.4,function(){n.begin();n.moveTo(c.x,c.y);n.lineTo(c.x-u/2-f/l,c.y+u/l-f/2);n.lineTo(c.x-u,c.y-f);n.lineTo(c.x-u/2+f/l,c.y-f/2-u/l);n.close();h?n.fillAndStroke():n.stroke()}}mxMarker.addMarker("classic",n(2));mxMarker.addMarker("classicThin",n(3));mxMarker.addMarker("block",n(2));mxMarker.addMarker("blockThin",n(3));mxMarker.addMarker("open",t(2));mxMarker.addMarker("openThin",t(3));mxMarker.addMarker("oval",function(n,t,i,r,u,f,e,o,s,h){var c=e/2,l=r.clone();return r.x-=u*c,r.y-=f*c,function(){n.ellipse(l.x-c,l.y-c,e,e);h?n.fillAndStroke():n.stroke()}});mxMarker.addMarker("diamond",i);mxMarker.addMarker("diamondThin",i)}();mxUtils.extend(mxActor,mxShape);mxActor.prototype.paintVertexShape=function(n,t,i,r,u){n.translate(t,i);n.begin();this.redrawPath(n,t,i,r,u);n.fillAndStroke()};mxActor.prototype.redrawPath=function(n,t,i,r,u){var f=r/3;n.moveTo(0,u);n.curveTo(0,3*u/5,0,2*u/5,r/2,2*u/5);n.curveTo(r/2-f,2*u/5,r/2-f,0,r/2,0);n.curveTo(r/2+f,0,r/2+f,2*u/5,r/2,2*u/5);n.curveTo(r,2*u/5,r,3*u/5,r,u);n.close()};mxUtils.extend(mxCloud,mxActor);mxCloud.prototype.redrawPath=function(n,t,i,r,u){n.moveTo(.25*r,.25*u);n.curveTo(.05*r,.25*u,0,.5*u,.16*r,.55*u);n.curveTo(0,.66*u,.18*r,.9*u,.31*r,.8*u);n.curveTo(.4*r,u,.7*r,u,.8*r,.8*u);n.curveTo(r,.8*u,r,.6*u,.875*r,.5*u);n.curveTo(r,.3*u,.8*r,.1*u,.625*r,.2*u);n.curveTo(.5*r,.05*u,.3*r,.05*u,.25*r,.25*u);n.close()};mxUtils.extend(mxRectangleShape,mxShape);mxRectangleShape.prototype.isHtmlAllowed=function(){var n=!0;return this.style!=null&&(n=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"),!this.isRounded&&!this.glass&&this.rotation==0&&(n||this.fill!=null&&this.fill!=mxConstants.NONE)};mxRectangleShape.prototype.paintBackground=function(n,t,i,r,u){var e=!0,f,o;this.style!=null&&(e=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1");(e||this.fill!=null&&this.fill!=mxConstants.NONE||this.stroke!=null&&this.stroke!=mxConstants.NONE)&&(e||this.fill!=null&&this.fill!=mxConstants.NONE||(n.pointerEvents=!1),this.isRounded?(f=0,mxUtils.getValue(this.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0)=="1"?f=Math.min(r/2,Math.min(u/2,mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2)):(o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,f=Math.min(r*o,u*o)),n.roundrect(t,i,r,u,f,f)):n.rect(t,i,r,u),n.fillAndStroke())};mxRectangleShape.prototype.paintForeground=function(n,t,i,r,u){this.glass&&!this.outline&&this.fill!=null&&this.fill!=mxConstants.NONE&&this.paintGlassEffect(n,t,i,r,u,this.getArcSize(r+this.strokewidth,u+this.strokewidth))};mxUtils.extend(mxEllipse,mxShape);mxEllipse.prototype.paintVertexShape=function(n,t,i,r,u){n.ellipse(t,i,r,u);n.fillAndStroke()};mxUtils.extend(mxDoubleEllipse,mxShape);mxDoubleEllipse.prototype.vmlScale=10;mxDoubleEllipse.prototype.paintBackground=function(n,t,i,r,u){n.ellipse(t,i,r,u);n.fillAndStroke()};mxDoubleEllipse.prototype.paintForeground=function(n,t,i,r,u){if(!this.outline){var f=mxUtils.getValue(this.style,mxConstants.STYLE_MARGIN,Math.min(3+this.strokewidth,Math.min(r/5,u/5)));t+=f;i+=f;r-=2*f;u-=2*f;r>0&&u>0&&n.ellipse(t,i,r,u);n.stroke()}};mxDoubleEllipse.prototype.getLabelBounds=function(n){var t=mxUtils.getValue(this.style,mxConstants.STYLE_MARGIN,Math.min(3+this.strokewidth,Math.min(n.width/5/this.scale,n.height/5/this.scale)))*this.scale;return new mxRectangle(n.x+t,n.y+t,n.width-2*t,n.height-2*t)};mxUtils.extend(mxRhombus,mxShape);mxRhombus.prototype.paintVertexShape=function(n,t,i,r,u){var f=r/2,e=u/2,o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;n.begin();this.addPoints(n,[new mxPoint(t+f,i),new mxPoint(t+r,i+e),new mxPoint(t+f,i+u),new mxPoint(t,i+e)],this.isRounded,o,!0);n.fillAndStroke()};mxUtils.extend(mxPolyline,mxShape);mxPolyline.prototype.getRotation=function(){return 0};mxPolyline.prototype.getShapeRotation=function(){return 0};mxPolyline.prototype.isPaintBoundsInverted=function(){return!1};mxPolyline.prototype.paintEdgeShape=function(n,t){this.style==null||this.style[mxConstants.STYLE_CURVED]!=1?this.paintLine(n,t,this.isRounded):this.paintCurvedLine(n,t)};mxPolyline.prototype.paintLine=function(n,t,i){var r=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;n.begin();this.addPoints(n,t,i,r,!1);n.stroke()};mxPolyline.prototype.paintCurvedLine=function(n,t){var e,f,r,i,u;for(n.begin(),e=t[0],f=t.length,n.moveTo(e.x,e.y),r=1;r<f-2;r++){var i=t[r],u=t[r+1],o=(i.x+u.x)/2,s=(i.y+u.y)/2;n.quadTo(i.x,i.y,o,s)}i=t[f-2];u=t[f-1];n.quadTo(i.x,i.y,u.x,u.y);n.stroke()};mxUtils.extend(mxArrow,mxShape);mxArrow.prototype.augmentBoundingBox=function(n){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var t=Math.max(this.arrowWidth,this.endSize);n.grow((t/2+this.strokewidth)*this.scale)};mxArrow.prototype.paintEdgeShape=function(n,t){var i=mxConstants.ARROW_SPACING,a=mxConstants.ARROW_WIDTH,rt=mxConstants.ARROW_SIZE,f=t[0],e=t[t.length-1],h=e.x-f.x,c=e.y-f.y,l=Math.sqrt(h*h+c*c),v=l-2*i-rt,o=h/l,s=c/l,ut=v*o,ft=v*s,r=a*s/3,u=-a*o/3,y=f.x-r/2+i*o,p=f.y-u/2+i*s,w=y+r,b=p+u,k=w+ut,d=b+ft,g=k+r,nt=d+u,tt=g-3*r,it=nt-3*u;n.begin();n.moveTo(y,p);n.lineTo(w,b);n.lineTo(k,d);n.lineTo(g,nt);n.lineTo(e.x-i*o,e.y-i*s);n.lineTo(tt,it);n.lineTo(tt+r,it+u);n.close();n.fillAndStroke()};mxUtils.extend(mxArrowConnector,mxShape);mxArrowConnector.prototype.useSvgBoundingBox=!0;mxArrowConnector.prototype.resetStyles=function(){mxShape.prototype.resetStyles.apply(this,arguments);this.arrowSpacing=mxConstants.ARROW_SPACING};mxArrowConnector.prototype.apply=function(){mxShape.prototype.apply.apply(this,arguments);this.style!=null&&(this.startSize=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3,this.endSize=mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3)};mxArrowConnector.prototype.augmentBoundingBox=function(n){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var t=this.getEdgeWidth();this.isMarkerStart()&&(t=Math.max(t,this.getStartArrowWidth()));this.isMarkerEnd()&&(t=Math.max(t,this.getEndArrowWidth()));n.grow((t/2+this.strokewidth)*this.scale)};mxArrowConnector.prototype.paintEdgeShape=function(n,t){var a=this.strokewidth,dt,gt,ft,ui,et,st,ht,i;this.outline&&(a=Math.max(1,mxUtils.getNumber(this.style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth)));for(var vt=this.getStartArrowWidth()+a,yt=this.getEndArrowWidth()+a,r=this.outline?this.getEdgeWidth()+a:this.getEdgeWidth(),h=this.isOpenEnded(),pt=this.isMarkerStart(),wt=this.isMarkerEnd(),e=h?0:this.arrowSpacing+a/2,bt=this.startSize+a,kt=this.endSize+a,tt=this.isArrowRounded(),c=t[t.length-1],p=1;p<t.length-1&&t[p].x==t[0].x&&t[p].y==t[0].y;)p++;var ct=t[p].x-t[0].x,lt=t[p].y-t[0].y,at=Math.sqrt(ct*ct+lt*lt);if(at!=0){var u=ct/at,v,o=u,f=lt/at,y,s=f,w=r*f,b=-r*u,l=[];if(tt?n.setLineJoin("round"):t.length>2&&n.setMiterLimit(1.42),n.begin(),dt=u,gt=f,pt&&!h)this.paintMarker(n,t[0].x,t[0].y,u,f,bt,vt,r,e,!0);else{var ni=t[0].x+w/2+e*u,ti=t[0].y+b/2+e*f,ii=t[0].x-w/2+e*u,ri=t[0].y-b/2+e*f;h?(n.moveTo(ni,ti),l.push(function(){n.lineTo(ii,ri)})):(n.moveTo(ii,ri),n.lineTo(ni,ti))}var it=0,rt=0,ut=0;for(i=0;i<t.length-2;i++)if(ft=mxUtils.relativeCcw(t[i].x,t[i].y,t[i+1].x,t[i+1].y,t[i+2].x,t[i+2].y),it=t[i+2].x-t[i+1].x,rt=t[i+2].y-t[i+1].y,ut=Math.sqrt(it*it+rt*rt),ut!=0&&(o=it/ut,s=rt/ut,ui=u*o+f*s,tmp=Math.max(Math.sqrt((ui+1)/2),.04),v=u+o,y=f+s,et=Math.sqrt(v*v+y*y),et!=0)){v=v/et;y=y/et;var fi=Math.max(tmp,Math.min(this.strokewidth/200+.04,.35)),ot=ft!=0&&tt?Math.max(.1,fi):Math.max(tmp,.06),k=t[i+1].x+y*r/2/ot,d=t[i+1].y-v*r/2/ot,g=t[i+1].x-y*r/2/ot,nt=t[i+1].y+v*r/2/ot;if(ft!=0&&tt)if(ft==-1){var ei=g+f*r,oi=nt-u*r,si=g+s*r,hi=nt-o*r;n.lineTo(ei,oi);n.quadTo(k,d,si,hi),function(t,i){l.push(function(){n.lineTo(t,i)})}(g,nt)}else n.lineTo(k,d),function(t,i){var e=k-f*r,h=d+u*r,c=k-s*r,a=d+o*r;l.push(function(){n.quadTo(t,i,e,h)});l.push(function(){n.lineTo(c,a)})}(g,nt);else n.lineTo(k,d),function(t,i){l.push(function(){n.lineTo(t,i)})}(g,nt);u=o;f=s}for(w=r*s,b=-r*o,wt&&!h?this.paintMarker(n,c.x,c.y,-u,-f,kt,yt,r,e,!1):(n.lineTo(c.x-e*o+w/2,c.y-e*s+b/2),st=c.x-e*o-w/2,ht=c.y-e*s-b/2,h?(n.moveTo(st,ht),l.splice(0,0,function(){n.moveTo(st,ht)})):n.lineTo(st,ht)),i=l.length-1;i>=0;i--)l[i]();h?(n.end(),n.stroke()):(n.close(),n.fillAndStroke());n.setShadow(!1);n.setMiterLimit(4);tt&&n.setLineJoin("flat");t.length>2&&(n.setMiterLimit(4),pt&&!h&&(n.begin(),this.paintMarker(n,t[0].x,t[0].y,dt,gt,bt,vt,r,e,!0),n.stroke(),n.end()),wt&&!h&&(n.begin(),this.paintMarker(n,c.x,c.y,-u,-f,kt,yt,r,e,!0),n.stroke(),n.end()))}};mxArrowConnector.prototype.paintMarker=function(n,t,i,r,u,f,e,o,s,h){var y=o/e,c=o*u/2,l=-o*r/2,a=(s+f)*r,v=(s+f)*u;h?n.moveTo(t-c+a,i-l+v):n.lineTo(t-c+a,i-l+v);n.lineTo(t-c/y+a,i-l/y+v);n.lineTo(t+s*r,i+s*u);n.lineTo(t+c/y+a,i+l/y+v);n.lineTo(t+c+a,i+l+v)};mxArrowConnector.prototype.isArrowRounded=function(){return this.isRounded};mxArrowConnector.prototype.getStartArrowWidth=function(){return mxConstants.ARROW_WIDTH};mxArrowConnector.prototype.getEndArrowWidth=function(){return mxConstants.ARROW_WIDTH};mxArrowConnector.prototype.getEdgeWidth=function(){return mxConstants.ARROW_WIDTH/3};mxArrowConnector.prototype.isOpenEnded=function(){return!1};mxArrowConnector.prototype.isMarkerStart=function(){return mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE};mxArrowConnector.prototype.isMarkerEnd=function(){return mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE};mxUtils.extend(mxText,mxShape);mxText.prototype.baseSpacingTop=0;mxText.prototype.baseSpacingBottom=0;mxText.prototype.baseSpacingLeft=0;mxText.prototype.baseSpacingRight=0;mxText.prototype.replaceLinefeeds=!0;mxText.prototype.verticalTextRotation=-90;mxText.prototype.ignoreClippedStringSize=!0;mxText.prototype.ignoreStringSize=!1;mxText.prototype.textWidthPadding=document.documentMode==8&&!mxClient.IS_EM?4:3;mxText.prototype.lastValue=null;mxText.prototype.cacheEnabled=!0;mxText.prototype.isParseVml=function(){return!1};mxText.prototype.isHtmlAllowed=function(){return document.documentMode!=8||mxClient.IS_EM};mxText.prototype.getSvgScreenOffset=function(){return 0};mxText.prototype.checkBounds=function(){return!isNaN(this.scale)&&isFinite(this.scale)&&this.scale>0&&this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)};mxText.prototype.paint=function(n,t){var u=this.scale,f=this.bounds.x/u,e=this.bounds.y/u,o=this.bounds.width/u,s=this.bounds.height/u,h,r;if(this.updateTransform(n,f,e,o,s),this.configureCanvas(n,f,e,o,s),h=this.state!=null?this.state.unscaledWidth:null,t)this.node.firstChild!=null&&(h==null||this.lastUnscaledWidth!=h)&&n.invalidateCachedOffsetSize(this.node),n.updateText(f,e,o,s,this.align,this.valign,this.wrap,this.overflow,this.clipped,this.getTextRotation(),this.node);else{var l=mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML,c=l||n instanceof mxVmlCanvas2D?"html":"",i=this.value;l||c!="html"||(i=mxUtils.htmlEntities(i,!1));c!="html"||mxUtils.isNode(this.value)||(i=mxUtils.replaceTrailingNewlines(i,"<div><br><\/div>"));i=!mxUtils.isNode(this.value)&&this.replaceLinefeeds&&c=="html"?i.replace(/\n/g,"<br/>"):i;r=this.textDirection;r!=mxConstants.TEXT_DIRECTION_AUTO||l||(r=this.getAutoDirection());r!=mxConstants.TEXT_DIRECTION_LTR&&r!=mxConstants.TEXT_DIRECTION_RTL&&(r=null);n.text(f,e,o,s,i,this.align,this.valign,this.wrap,c,this.overflow,this.clipped,this.getTextRotation(),r)}this.lastUnscaledWidth=h};mxText.prototype.redraw=function(){if(this.visible&&this.checkBounds()&&this.cacheEnabled&&this.lastValue==this.value&&(mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML))if(this.node.nodeName=="DIV"&&(this.isHtmlAllowed()||!mxClient.IS_VML))this.updateSize(this.node,this.state==null||this.state.view.textDiv==null),mxClient.IS_IE&&(document.documentMode==null||document.documentMode<=8)?this.updateHtmlFilter():this.updateHtmlTransform(),this.updateBoundingBox();else{var n=this.createCanvas();n!=null&&n.updateText!=null&&n.invalidateCachedOffsetSize!=null?(this.paint(n,!0),this.destroyCanvas(n),this.updateBoundingBox()):mxShape.prototype.redraw.apply(this,arguments)}else mxShape.prototype.redraw.apply(this,arguments),this.lastValue=mxUtils.isNode(this.value)||this.dialect==mxConstants.DIALECT_STRICTHTML?this.value:null};mxText.prototype.resetStyles=function(){mxShape.prototype.resetStyles.apply(this,arguments);this.color="black";this.align=mxConstants.ALIGN_CENTER;this.valign=mxConstants.ALIGN_MIDDLE;this.family=mxConstants.DEFAULT_FONTFAMILY;this.size=mxConstants.DEFAULT_FONTSIZE;this.fontStyle=mxConstants.DEFAULT_FONTSTYLE;this.spacing=2;this.spacingTop=2;this.spacingRight=2;this.spacingBottom=2;this.spacingLeft=2;this.horizontal=!0;delete this.background;delete this.border;this.textDirection=mxConstants.DEFAULT_TEXT_DIRECTION;delete this.margin};mxText.prototype.apply=function(){var n=this.spacing;mxShape.prototype.apply.apply(this,arguments);this.style!=null&&(this.fontStyle=mxUtils.getValue(this.style,mxConstants.STYLE_FONTSTYLE,this.fontStyle),this.family=mxUtils.getValue(this.style,mxConstants.STYLE_FONTFAMILY,this.family),this.size=mxUtils.getValue(this.style,mxConstants.STYLE_FONTSIZE,this.size),this.color=mxUtils.getValue(this.style,mxConstants.STYLE_FONTCOLOR,this.color),this.align=mxUtils.getValue(this.style,mxConstants.STYLE_ALIGN,this.align),this.valign=mxUtils.getValue(this.style,mxConstants.STYLE_VERTICAL_ALIGN,this.valign),this.spacing=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_SPACING,this.spacing)),this.spacingTop=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_TOP,this.spacingTop-n))+this.spacing,this.spacingRight=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_RIGHT,this.spacingRight-n))+this.spacing,this.spacingBottom=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_BOTTOM,this.spacingBottom-n))+this.spacing,this.spacingLeft=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_SPACING_LEFT,this.spacingLeft-n))+this.spacing,this.horizontal=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,this.horizontal),this.background=mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,this.background),this.border=mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_BORDERCOLOR,this.border),this.textDirection=mxUtils.getValue(this.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION),this.opacity=mxUtils.getValue(this.style,mxConstants.STYLE_TEXT_OPACITY,100),this.updateMargin());this.flipV=null;this.flipH=null};mxText.prototype.getAutoDirection=function(){var n=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(this.value);return n!=null&&n.length>0&&n[0]>"z"?mxConstants.TEXT_DIRECTION_RTL:mxConstants.TEXT_DIRECTION_LTR};mxText.prototype.updateBoundingBox=function(){var n=this.node,t,f,u,e,i,s,r,o;this.boundingBox=this.bounds.clone();var h=this.getTextRotation(),c=this.style!=null?mxUtils.getValue(this.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER):null,l=this.style!=null?mxUtils.getValue(this.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE):null;if(!this.ignoreStringSize&&n!=null&&this.overflow!="fill"&&(!this.clipped||!this.ignoreClippedStringSize||c!=mxConstants.ALIGN_CENTER||l!=mxConstants.ALIGN_MIDDLE)){if(t=null,f=null,n.ownerSVGElement!=null)if(n.firstChild!=null&&n.firstChild.firstChild!=null&&n.firstChild.firstChild.nodeName=="foreignObject")n=n.firstChild.firstChild,t=parseInt(n.getAttribute("width"))*this.scale,f=parseInt(n.getAttribute("height"))*this.scale;else try{u=n.getBBox();this.boundingBox=typeof this.value=="string"&&mxUtils.trim(this.value)==0?null:u.width==0&&u.height==0?null:new mxRectangle(u.x,u.y,u.width,u.height);return}catch(a){}else e=this.state!=null?this.state.view.textDiv:null,this.offsetWidth!=null&&this.offsetHeight!=null?(t=this.offsetWidth*this.scale,f=this.offsetHeight*this.scale):(e!=null&&(this.updateFont(e),this.updateSize(e,!1),this.updateInnerHtml(e),n=e),i=n,document.documentMode!=8||mxClient.IS_EM?i.firstChild!=null&&i.firstChild.nodeName=="DIV"&&(i=i.firstChild):(s=Math.round(this.bounds.width/this.scale),this.wrap&&s>0?(n.style.wordWrap=mxConstants.WORD_WRAP,n.style.whiteSpace="normal",n.style.wordWrap!="break-word"&&(r=i.getElementsByTagName("div"),r.length>0&&(i=r[r.length-1]),t=i.offsetWidth+2,r=this.node.getElementsByTagName("div"),this.clipped&&(t=Math.min(s,t)),r.length>1&&(r[r.length-2].style.width=t+"px"))):n.style.whiteSpace="nowrap"),this.offsetWidth=i.offsetWidth+this.textWidthPadding,this.offsetHeight=i.offsetHeight,t=this.offsetWidth*this.scale,f=this.offsetHeight*this.scale);t!=null&&f!=null&&(this.boundingBox=new mxRectangle(this.bounds.x,this.bounds.y,t,f))}this.boundingBox!=null&&(h!=0?(o=mxUtils.getBoundingBox(new mxRectangle(this.margin.x*this.boundingBox.width,this.margin.y*this.boundingBox.height,this.boundingBox.width,this.boundingBox.height),h,new mxPoint(0,0)),this.unrotatedBoundingBox=mxRectangle.fromRectangle(this.boundingBox),this.unrotatedBoundingBox.x+=this.margin.x*this.unrotatedBoundingBox.width,this.unrotatedBoundingBox.y+=this.margin.y*this.unrotatedBoundingBox.height,this.boundingBox.x+=o.x,this.boundingBox.y+=o.y,this.boundingBox.width=o.width,this.boundingBox.height=o.height):(this.boundingBox.x+=this.margin.x*this.boundingBox.width,this.boundingBox.y+=this.margin.y*this.boundingBox.height,this.unrotatedBoundingBox=null))};mxText.prototype.getShapeRotation=function(){return 0};mxText.prototype.getTextRotation=function(){return this.state!=null&&this.state.shape!=null?this.state.shape.getTextRotation():0};mxText.prototype.isPaintBoundsInverted=function(){return!this.horizontal&&this.state!=null&&this.state.view.graph.model.isVertex(this.state.cell)};mxText.prototype.configureCanvas=function(n){mxShape.prototype.configureCanvas.apply(this,arguments);n.setFontColor(this.color);n.setFontBackgroundColor(this.background);n.setFontBorderColor(this.border);n.setFontFamily(this.family);n.setFontSize(this.size);n.setFontStyle(this.fontStyle)};mxText.prototype.updateVmlContainer=function(){this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width="1px";this.node.style.height="1px";this.node.style.overflow="visible"};mxText.prototype.redrawHtmlShape=function(){var n=this.node.style;n.whiteSpace="normal";n.overflow="";n.width="";n.height="";this.updateValue();this.updateFont(this.node);this.updateSize(this.node,this.state==null||this.state.view.textDiv==null);this.offsetWidth=null;this.offsetHeight=null;mxClient.IS_IE&&(document.documentMode==null||document.documentMode<=8)?this.updateHtmlFilter():this.updateHtmlTransform()};mxText.prototype.updateHtmlTransform=function(){var r=this.getTextRotation(),n=this.node.style,t=this.margin.x,i=this.margin.y;r!=0?(mxUtils.setPrefixedStyle(n,"transformOrigin",-t*100+"% "+-i*100+"%"),mxUtils.setPrefixedStyle(n,"transform","translate("+t*100+"%,"+i*100+"%)scale("+this.scale+") rotate("+r+"deg)")):(mxUtils.setPrefixedStyle(n,"transformOrigin","0% 0%"),mxUtils.setPrefixedStyle(n,"transform","scale("+this.scale+")translate("+t*100+"%,"+i*100+"%)"));n.left=Math.round(this.bounds.x-Math.ceil(t*(this.overflow!="fill"&&this.overflow!="width"?3:1)))+"px";n.top=Math.round(this.bounds.y-i*(this.overflow!="fill"?3:1))+"px";n.opacity=this.opacity<100?this.opacity/100:""};mxText.prototype.updateInnerHtml=function(n){if(mxUtils.isNode(this.value))n.innerHTML=this.value.outerHTML;else{var t=this.value;this.dialect!=mxConstants.DIALECT_STRICTHTML&&(t=mxUtils.htmlEntities(t,!1));t=mxUtils.replaceTrailingNewlines(t,"<div>&nbsp;<\/div>");t=this.replaceLinefeeds?t.replace(/\n/g,"<br/>"):t;t='<div style="display:inline-block;_display:inline;">'+t+"<\/div>";n.innerHTML=t}};mxText.prototype.updateHtmlFilter=function(){var o=this.node.style,b=this.margin.x,s=this.margin.y,h=this.scale,n,u,a;mxUtils.setOpacity(this.node,this.opacity);var r=0,e=0,i=this.state!=null?this.state.view.textDiv:null,t=this.node;i!=null?(i.style.overflow="",i.style.height="",i.style.width="",this.updateFont(i),this.updateSize(i,!1),this.updateInnerHtml(i),n=Math.round(this.bounds.width/this.scale),this.wrap&&n>0?(i.style.whiteSpace="normal",i.style.wordWrap=mxConstants.WORD_WRAP,r=n,this.clipped&&(r=Math.min(r,this.bounds.width)),i.style.width=r+"px"):i.style.whiteSpace="nowrap",t=i,t.firstChild!=null&&t.firstChild.nodeName=="DIV"&&(t=t.firstChild,this.wrap&&i.style.wordWrap=="break-word"&&(t.style.width="100%")),!this.clipped&&this.wrap&&n>0&&(r=t.offsetWidth+this.textWidthPadding,i.style.width=r+"px"),e=t.offsetHeight+2,mxClient.IS_QUIRKS&&this.border!=null&&this.border!=mxConstants.NONE&&(e+=3)):t.firstChild!=null&&t.firstChild.nodeName=="DIV"&&(t=t.firstChild,e=t.offsetHeight);r=t.offsetWidth+this.textWidthPadding;this.clipped&&(e=Math.min(e,this.bounds.height));n=this.bounds.width/h;u=this.bounds.height/h;this.overflow=="fill"?(e=u,r=n):this.overflow=="width"&&(e=t.scrollHeight,r=n);this.offsetWidth=r;this.offsetHeight=e;mxClient.IS_QUIRKS&&(this.clipped||this.overflow=="width"&&u>0)?(u=Math.min(u,e),o.height=Math.round(u)+"px"):u=e;this.overflow!="fill"&&this.overflow!="width"&&(this.clipped&&(r=Math.min(n,r)),n=r,(mxClient.IS_QUIRKS&&this.clipped||this.wrap)&&(o.width=Math.round(n)+"px"));u*=h;n*=h;var f=this.getTextRotation()*(Math.PI/180),c=parseFloat(parseFloat(Math.cos(f)).toFixed(8)),l=parseFloat(parseFloat(Math.sin(-f)).toFixed(8));f%=2*Math.PI;f<0&&(f+=2*Math.PI);f%=Math.PI;f>Math.PI/2&&(f=Math.PI-f);var v=Math.cos(f),y=Math.sin(-f),p=n*-(b+.5),w=u*-(s+.5),k=(u-u*v+n*y)/2+l*p-c*w,d=(n-n*v+u*y)/2-c*p-l*w;f!=0&&(a="progid:DXImageTransform.Microsoft.Matrix(M11="+c+", M12="+l+", M21="+-l+", M22="+c+", sizingMethod='auto expand')",o.filter!=null&&o.filter.length>0?o.filter+=" "+a:o.filter=a);s=0;this.overflow!="fill"&&mxClient.IS_QUIRKS&&(this.valign==mxConstants.ALIGN_TOP?s-=1:s+=this.valign==mxConstants.ALIGN_BOTTOM?2:1);o.zoom=h;o.left=Math.round(this.bounds.x+d-n/2)+"px";o.top=Math.round(this.bounds.y+k-u/2+s)+"px"};mxText.prototype.updateValue=function(){var n,r,u,f,e,t,i;mxUtils.isNode(this.value)?(this.node.innerHTML="",this.node.appendChild(this.value)):(n=this.value,this.dialect!=mxConstants.DIALECT_STRICTHTML&&(n=mxUtils.htmlEntities(n,!1)),n=mxUtils.replaceTrailingNewlines(n,"<div><br><\/div>"),n=this.replaceLinefeeds?n.replace(/\n/g,"<br/>"):n,r=this.background!=null&&this.background!=mxConstants.NONE?this.background:null,u=this.border!=null&&this.border!=mxConstants.NONE?this.border:null,this.overflow=="fill"||this.overflow=="width"?(r!=null&&(this.node.style.backgroundColor=r),u!=null&&(this.node.style.border="1px solid "+u)):(f="",r!=null&&(f+="background-color:"+r+";"),u!=null&&(f+="border:1px solid "+u+";"),e=mxConstants.ABSOLUTE_LINE_HEIGHT?this.size*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT,n='<div style="zoom:1;'+f+"display:inline-block;_display:inline;text-decoration:inherit;padding-bottom:1px;padding-right:1px;line-height:"+e+'">'+n+"<\/div>"),this.node.innerHTML=n,t=this.node.getElementsByTagName("div"),t.length>0&&(i=this.textDirection,i==mxConstants.TEXT_DIRECTION_AUTO&&this.dialect!=mxConstants.DIALECT_STRICTHTML&&(i=this.getAutoDirection()),i==mxConstants.TEXT_DIRECTION_LTR||i==mxConstants.TEXT_DIRECTION_RTL?t[t.length-1].setAttribute("dir",i):t[t.length-1].removeAttribute("dir")))};mxText.prototype.updateFont=function(n){var t=n.style;t.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?this.size*mxConstants.LINE_HEIGHT+"px":mxConstants.LINE_HEIGHT;t.fontSize=this.size+"px";t.fontFamily=this.family;t.verticalAlign="top";t.color=this.color;t.fontWeight=(this.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?"bold":"";t.fontStyle=(this.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?"italic":"";t.textDecoration=(this.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE?"underline":"";t.textAlign=this.align==mxConstants.ALIGN_CENTER?"center":this.align==mxConstants.ALIGN_RIGHT?"right":"left"};mxText.prototype.updateSize=function(n,t){var u=Math.max(0,Math.round(this.bounds.width/this.scale)),e=Math.max(0,Math.round(this.bounds.height/this.scale)),i=n.style,r,f,o;this.clipped?(i.overflow="hidden",mxClient.IS_QUIRKS?i.width=u+"px":(i.maxHeight=e+"px",i.maxWidth=u+"px")):this.overflow=="fill"?(i.width=u+1+"px",i.height=e+1+"px",i.overflow="hidden"):this.overflow=="width"&&(i.width=u+1+"px",i.maxHeight=e+1+"px",i.overflow="hidden");this.wrap&&u>0?(i.wordWrap=mxConstants.WORD_WRAP,i.whiteSpace="normal",i.width=u+"px",t&&this.overflow!="fill"&&this.overflow!="width"&&(r=n,r.firstChild!=null&&r.firstChild.nodeName=="DIV"&&(r=r.firstChild,n.style.wordWrap=="break-word"&&(r.style.width="100%")),f=r.offsetWidth,f==0&&(o=n.parentNode,n.style.visibility="hidden",document.body.appendChild(n),f=r.offsetWidth,n.style.visibility="",o.appendChild(n)),f+=3,this.clipped&&(f=Math.min(f,u)),i.width=f+"px")):i.whiteSpace="nowrap"};mxText.prototype.updateMargin=function(){this.margin=mxUtils.getAlignmentAsPoint(this.align,this.valign)};mxText.prototype.getSpacing=function(){var n=0,t=0;return n=this.align==mxConstants.ALIGN_CENTER?(this.spacingLeft-this.spacingRight)/2:this.align==mxConstants.ALIGN_RIGHT?-this.spacingRight-this.baseSpacingRight:this.spacingLeft+this.baseSpacingLeft,t=this.valign==mxConstants.ALIGN_MIDDLE?(this.spacingTop-this.spacingBottom)/2:this.valign==mxConstants.ALIGN_BOTTOM?-this.spacingBottom-this.baseSpacingBottom:this.spacingTop+this.baseSpacingTop,new mxPoint(n,t)};mxUtils.extend(mxTriangle,mxActor);mxTriangle.prototype.redrawPath=function(n,t,i,r,u){var f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,0),new mxPoint(r,.5*u),new mxPoint(0,u)],this.isRounded,f,!0)};mxUtils.extend(mxHexagon,mxActor);mxHexagon.prototype.redrawPath=function(n,t,i,r,u){var f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(.25*r,0),new mxPoint(.75*r,0),new mxPoint(r,.5*u),new mxPoint(.75*r,u),new mxPoint(.25*r,u),new mxPoint(0,.5*u)],this.isRounded,f,!0)};mxUtils.extend(mxLine,mxShape);mxLine.prototype.paintVertexShape=function(n,t,i,r,u){var f=i+u/2;n.begin();n.moveTo(t,f);n.lineTo(t+r,f);n.stroke()};mxUtils.extend(mxImageShape,mxRectangleShape);mxImageShape.prototype.preserveImageAspect=!0;mxImageShape.prototype.getSvgScreenOffset=function(){return 0};mxImageShape.prototype.apply=function(){mxShape.prototype.apply.apply(this,arguments);this.fill=null;this.stroke=null;this.gradient=null;this.style!=null&&(this.preserveImageAspect=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_ASPECT,1)==1,this.flipH=this.flipH||mxUtils.getValue(this.style,"imageFlipH",0)==1,this.flipV=this.flipV||mxUtils.getValue(this.style,"imageFlipV",0)==1)};mxImageShape.prototype.isHtmlAllowed=function(){return!this.preserveImageAspect};mxImageShape.prototype.createHtml=function(){var n=document.createElement("div");return n.style.position="absolute",n};mxImageShape.prototype.paintVertexShape=function(n,t,i,r,u){var e,f;this.image!=null?(e=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,null),f=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null),e!=null&&(n.setFillColor(e),n.setStrokeColor(f),n.rect(t,i,r,u),n.fillAndStroke()),n.image(t,i,r,u,this.image,this.preserveImageAspect,!1,!1),f=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,null),f!=null&&(n.setShadow(!1),n.setStrokeColor(f),n.rect(t,i,r,u),n.stroke())):mxRectangleShape.prototype.paintBackground.apply(this,arguments)};mxImageShape.prototype.redrawHtmlShape=function(){var i,r,u,n,t;this.node.style.left=Math.round(this.bounds.x)+"px";this.node.style.top=Math.round(this.bounds.y)+"px";this.node.style.width=Math.max(0,Math.round(this.bounds.width))+"px";this.node.style.height=Math.max(0,Math.round(this.bounds.height))+"px";this.node.innerHTML="";this.image!=null?(i=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND,""),r=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER,""),this.node.style.backgroundColor=i,this.node.style.borderColor=r,u=mxClient.IS_IE6||(document.documentMode==null||document.documentMode<=8)&&this.rotation!=0,n=document.createElement(u?mxClient.VML_PREFIX+":image":"img"),n.setAttribute("border","0"),n.style.position="absolute",n.src=this.image,t=this.opacity<100?"alpha(opacity="+this.opacity+")":"",this.node.style.filter=t,this.flipH&&this.flipV?t+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2)":this.flipH?t+="progid:DXImageTransform.Microsoft.BasicImage(mirror=1)":this.flipV&&(t+="progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"),n.style.filter!=t&&(n.style.filter=t),n.nodeName=="image"?n.style.rotation=this.rotation:this.rotation!=0?mxUtils.setPrefixedStyle(n.style,"transform","rotate("+this.rotation+"deg)"):mxUtils.setPrefixedStyle(n.style,"transform",""),n.style.width=this.node.style.width,n.style.height=this.node.style.height,this.node.style.backgroundImage="",this.node.appendChild(n)):this.setTransparentBackgroundImage(this.node)};mxUtils.extend(mxLabel,mxRectangleShape);mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE;mxLabel.prototype.spacing=2;mxLabel.prototype.indicatorSize=10;mxLabel.prototype.indicatorSpacing=2;mxLabel.prototype.init=function(){mxShape.prototype.init.apply(this,arguments);this.indicatorShape!=null&&(this.indicator=new this.indicatorShape,this.indicator.dialect=this.dialect,this.indicator.init(this.node))};mxLabel.prototype.redraw=function(){this.indicator!=null&&(this.indicator.fill=this.indicatorColor,this.indicator.stroke=this.indicatorStrokeColor,this.indicator.gradient=this.indicatorGradientColor,this.indicator.direction=this.indicatorDirection);mxShape.prototype.redraw.apply(this,arguments)};mxLabel.prototype.isHtmlAllowed=function(){return mxRectangleShape.prototype.isHtmlAllowed.apply(this,arguments)&&this.indicatorColor==null&&this.indicatorShape==null};mxLabel.prototype.paintForeground=function(n,t,i,r,u){this.paintImage(n,t,i,r,u);this.paintIndicator(n,t,i,r,u);mxRectangleShape.prototype.paintForeground.apply(this,arguments)};mxLabel.prototype.paintImage=function(n,t,i,r,u){if(this.image!=null){var f=this.getImageBounds(t,i,r,u);n.image(f.x,f.y,f.width,f.height,this.image,!1,!1,!1)}};mxLabel.prototype.getImageBounds=function(n,t,i,r){var o=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),s=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),f=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_WIDTH,mxConstants.DEFAULT_IMAGESIZE),e=mxUtils.getNumber(this.style,mxConstants.STYLE_IMAGE_HEIGHT,mxConstants.DEFAULT_IMAGESIZE),u=mxUtils.getNumber(this.style,mxConstants.STYLE_SPACING,this.spacing)+5;return n+=o==mxConstants.ALIGN_CENTER?(i-f)/2:o==mxConstants.ALIGN_RIGHT?i-f-u:u,t+=s==mxConstants.ALIGN_TOP?u:s==mxConstants.ALIGN_BOTTOM?r-e-u:(r-e)/2,new mxRectangle(n,t,f,e)};mxLabel.prototype.paintIndicator=function(n,t,i,r,u){if(this.indicator!=null)this.indicator.bounds=this.getIndicatorBounds(t,i,r,u),this.indicator.paint(n);else if(this.indicatorImage!=null){var f=this.getIndicatorBounds(t,i,r,u);n.image(f.x,f.y,f.width,f.height,this.indicatorImage,!1,!1,!1)}};mxLabel.prototype.getIndicatorBounds=function(n,t,i,r){var o=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT),s=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE),f=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_WIDTH,this.indicatorSize),e=mxUtils.getNumber(this.style,mxConstants.STYLE_INDICATOR_HEIGHT,this.indicatorSize),u=this.spacing+5;return n+=o==mxConstants.ALIGN_RIGHT?i-f-u:o==mxConstants.ALIGN_CENTER?(i-f)/2:u,t+=s==mxConstants.ALIGN_BOTTOM?r-e-u:s==mxConstants.ALIGN_TOP?u:(r-e)/2,new mxRectangle(n,t,f,e)};mxLabel.prototype.redrawHtmlShape=function(){var n,t;for(mxRectangleShape.prototype.redrawHtmlShape.apply(this,arguments);this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);this.image!=null&&(n=document.createElement("img"),n.style.position="relative",n.setAttribute("border","0"),t=this.getImageBounds(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),t.x-=this.bounds.x,t.y-=this.bounds.y,n.style.left=Math.round(t.x)+"px",n.style.top=Math.round(t.y)+"px",n.style.width=Math.round(t.width)+"px",n.style.height=Math.round(t.height)+"px",n.src=this.image,this.node.appendChild(n))};mxUtils.extend(mxCylinder,mxShape);mxCylinder.prototype.maxHeight=40;mxCylinder.prototype.svgStrokeTolerance=0;mxCylinder.prototype.paintVertexShape=function(n,t,i,r,u){n.translate(t,i);n.begin();this.redrawPath(n,t,i,r,u,!1);n.fillAndStroke();n.setShadow(!1);n.begin();this.redrawPath(n,t,i,r,u,!0);n.stroke()};mxCylinder.prototype.redrawPath=function(n,t,i,r,u,f){var e=Math.min(this.maxHeight,Math.round(u/5));(f&&this.fill!=null||!f&&this.fill==null)&&(n.moveTo(0,e),n.curveTo(0,2*e,r,2*e,r,e),f||(n.stroke(),n.begin()));f||(n.moveTo(0,e),n.curveTo(0,-e/3,r,-e/3,r,e),n.lineTo(r,u-e),n.curveTo(r,u+e/3,0,u+e/3,0,u-e),n.close())};mxUtils.extend(mxConnector,mxPolyline);mxConnector.prototype.updateBoundingBox=function(){this.useSvgBoundingBox=this.style!=null&&this.style[mxConstants.STYLE_CURVED]==1;mxShape.prototype.updateBoundingBox.apply(this,arguments)};mxConnector.prototype.paintEdgeShape=function(n,t){var i=this.createMarker(n,t,!0),r=this.createMarker(n,t,!1);mxPolyline.prototype.paintEdgeShape.apply(this,arguments);n.setFillColor(this.stroke);n.setShadow(!1);n.setDashed(!1);i!=null&&i();r!=null&&r()};mxConnector.prototype.createMarker=function(n,t,i){var h=null,e=t.length,c=mxUtils.getValue(this.style,i?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW),r=i?t[1]:t[e-2],u=i?t[0]:t[e-1],f;if(c!=null&&r!=null&&u!=null){for(f=1;f<e-1&&Math.round(r.x-u.x)==0&&Math.round(r.y-u.y)==0;)r=i?t[1+f]:t[e-2-f],f++;var o=u.x-r.x,s=u.y-r.y,l=Math.max(1,Math.sqrt(o*o+s*s)),a=o/l,v=s/l,y=mxUtils.getNumber(this.style,i?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE),p=this.style[i?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL]!=0;h=mxMarker.createMarker(n,this,c,u,a,v,y,i,this.strokewidth,p)}return h};mxConnector.prototype.augmentBoundingBox=function(n){mxShape.prototype.augmentBoundingBox.apply(this,arguments);var t=0;mxUtils.getValue(this.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE&&(t=mxUtils.getNumber(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)+1);mxUtils.getValue(this.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE&&(t=Math.max(t,mxUtils.getNumber(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE))+1);n.grow(t*this.scale)};mxUtils.extend(mxSwimlane,mxShape);mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.getTitleSize=function(){return Math.max(0,mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE))};mxSwimlane.prototype.getLabelBounds=function(n){var r=this.getTitleSize(),t=new mxRectangle(n.x,n.y,n.width,n.height),s=this.isHorizontal(),h=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPH,0)==1,c=mxUtils.getValue(this.style,mxConstants.STYLE_FLIPV,0)==1,u=this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH,f=s==!u,e=!f&&h!=(this.direction==mxConstants.DIRECTION_SOUTH||this.direction==mxConstants.DIRECTION_WEST),o=f&&c!=(this.direction==mxConstants.DIRECTION_SOUTH||this.direction==mxConstants.DIRECTION_WEST),i;return u?(i=Math.min(t.width,r*this.scale),(e||o)&&(t.x+=t.width-i),t.width=i):(i=Math.min(t.height,r*this.scale),(e||o)&&(t.y+=t.height-i),t.height=i),t};mxSwimlane.prototype.getGradientBounds=function(n,t,i,r,u){var f=this.getTitleSize();return this.isHorizontal()?(f=Math.min(f,u),new mxRectangle(t,i,r,f)):(f=Math.min(f,r),new mxRectangle(t,i,f,u))};mxSwimlane.prototype.getArcSize=function(n,t,i){var r=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;return i*r*3};mxSwimlane.prototype.isHorizontal=function(){return mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,1)==1};mxSwimlane.prototype.paintVertexShape=function(n,t,i,r,u){var f=this.getTitleSize(),s=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_FILLCOLOR,mxConstants.NONE),h=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_LINE,1)==1,o=0,c,e;f=this.isHorizontal()?Math.min(f,u):Math.min(f,r);n.translate(t,i);this.isRounded?(o=this.getArcSize(r,u,f),this.paintRoundedSwimlane(n,t,i,r,u,f,o,s,h)):this.paintSwimlane(n,t,i,r,u,f,s,h);c=mxUtils.getValue(this.style,mxConstants.STYLE_SEPARATORCOLOR,mxConstants.NONE);this.paintSeparator(n,t,i,r,u,f,c);this.image!=null&&(e=this.getImageBounds(t,i,r,u),n.image(e.x-t,e.y-i,e.width,e.height,this.image,!1,!1,!1));this.glass&&(n.setShadow(!1),this.paintGlassEffect(n,0,0,r,f,o))};mxSwimlane.prototype.paintSwimlane=function(n,t,i,r,u,f,e,o){e!=mxConstants.NONE&&(n.save(),n.setFillColor(e),n.rect(0,0,r,u),n.fillAndStroke(),n.restore(),n.setShadow(!1));n.begin();f==0&&(f=u);this.isHorizontal()?(n.moveTo(0,f),n.lineTo(0,0),n.lineTo(r,0),n.lineTo(r,f),(o||f>=u)&&n.close(),n.fillAndStroke(),f<u&&e==mxConstants.NONE&&(n.pointerEvents=!1,n.begin(),n.moveTo(0,f),n.lineTo(0,u),n.lineTo(r,u),n.lineTo(r,f),n.stroke())):(n.moveTo(f,0),n.lineTo(0,0),n.lineTo(0,u),n.lineTo(f,u),(o||f>=r)&&n.close(),n.fillAndStroke(),f<r&&e==mxConstants.NONE&&(n.pointerEvents=!1,n.begin(),n.moveTo(f,0),n.lineTo(r,0),n.lineTo(r,u),n.lineTo(f,u),n.stroke()))};mxSwimlane.prototype.paintRoundedSwimlane=function(n,t,i,r,u,f,e,o,s){e=Math.min(u-f,Math.min(f,e));o!=mxConstants.NONE&&(n.save(),n.setFillColor(o),n.roundrect(0,0,r,u,e,e),n.fillAndStroke(),n.restore(),n.setShadow(!1));n.begin();this.isHorizontal()?(n.moveTo(r,f),n.lineTo(r,e),n.quadTo(r,0,r-Math.min(r/2,e),0),n.lineTo(Math.min(r/2,e),0),n.quadTo(0,0,0,e),n.lineTo(0,f),(s||f>=u)&&n.close(),n.fillAndStroke(),f<u&&o==mxConstants.NONE&&(n.pointerEvents=!1,n.begin(),n.moveTo(0,f),n.lineTo(0,u-e),n.quadTo(0,u,Math.min(r/2,e),u),n.lineTo(r-Math.min(r/2,e),u),n.quadTo(r,u,r,u-e),n.lineTo(r,f),n.stroke())):(n.moveTo(f,0),n.lineTo(e,0),n.quadTo(0,0,0,Math.min(u/2,e)),n.lineTo(0,u-Math.min(u/2,e)),n.quadTo(0,u,e,u),n.lineTo(f,u),(s||f>=r)&&n.close(),n.fillAndStroke(),f<r&&o==mxConstants.NONE&&(n.pointerEvents=!1,n.begin(),n.moveTo(f,u),n.lineTo(r-e,u),n.quadTo(r,u,r,u-Math.min(u/2,e)),n.lineTo(r,Math.min(u/2,e)),n.quadTo(r,0,r-e,0),n.lineTo(f,0),n.stroke()))};mxSwimlane.prototype.paintSeparator=function(n,t,i,r,u,f,e){e!=mxConstants.NONE&&(n.setStrokeColor(e),n.setDashed(!0),n.begin(),this.isHorizontal()?(n.moveTo(r,f),n.lineTo(r,u)):(n.moveTo(f,0),n.lineTo(r,0)),n.stroke(),n.setDashed(!1))};mxSwimlane.prototype.getImageBounds=function(n,t,i){return this.isHorizontal()?new mxRectangle(n+i-this.imageSize,t,this.imageSize,this.imageSize):new mxRectangle(n,t,this.imageSize,this.imageSize)};mxGraphLayout.prototype.graph=null;mxGraphLayout.prototype.useBoundingBox=!0;mxGraphLayout.prototype.parent=null;mxGraphLayout.prototype.moveCell=function(){};mxGraphLayout.prototype.execute=function(){};mxGraphLayout.prototype.getGraph=function(){return this.graph};mxGraphLayout.prototype.getConstraint=function(n,t){var i=this.graph.view.getState(t),r=i!=null?i.style:this.graph.getCellStyle(t);return r!=null?r[n]:null};mxGraphLayout.traverse=function(n,t,i,r,u){var o,s,f,e,h,c;if(i!=null&&n!=null&&(t=t!=null?t:!0,u=u||new mxDictionary,!u.get(n)&&(u.put(n,!0),o=i(n,r),(o==null||o)&&(s=this.graph.model.getEdgeCount(n),s>0))))for(f=0;f<s;f++)e=this.graph.model.getEdgeAt(n,f),h=this.graph.model.getTerminal(e,!0)==n,(!t||h)&&(c=this.graph.view.getVisibleTerminal(e,!h),this.traverse(c,t,i,e,u))};mxGraphLayout.prototype.isAncestor=function(n,t,i){if(!i)return this.graph.model.getParent(cell)==n;if(t==n)return!1;while(t!=null&&t!=n)t=this.graph.model.getParent(t);return t==n};mxGraphLayout.prototype.isVertexMovable=function(n){return this.graph.isCellMovable(n)};mxGraphLayout.prototype.isVertexIgnored=function(n){return!this.graph.getModel().isVertex(n)||!this.graph.isCellVisible(n)};mxGraphLayout.prototype.isEdgeIgnored=function(n){var t=this.graph.getModel();return!t.isEdge(n)||!this.graph.isCellVisible(n)||t.getTerminal(n,!0)==null||t.getTerminal(n,!1)==null};mxGraphLayout.prototype.setEdgeStyleEnabled=function(n,t){this.graph.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,t?"0":"1",[n])};mxGraphLayout.prototype.setOrthogonalEdge=function(n,t){this.graph.setCellStyles(mxConstants.STYLE_ORTHOGONAL,t?"1":"0",[n])};mxGraphLayout.prototype.getParentOffset=function(n){var t=new mxPoint,i,r;if(n!=null&&n!=this.parent&&(i=this.graph.getModel(),i.isAncestor(this.parent,n)))for(r=i.getGeometry(n);n!=this.parent;)t.x=t.x+r.x,t.y=t.y+r.y,n=i.getParent(n),r=i.getGeometry(n);return t};mxGraphLayout.prototype.setEdgePoints=function(n,t){var u,i,e,f,r;if(n!=null){if(u=this.graph.model,i=u.getGeometry(n),i==null?(i=new mxGeometry,i.setRelative(!0)):i=i.clone(),this.parent!=null&&t!=null)for(e=u.getParent(n),f=this.getParentOffset(e),r=0;r<t.length;r++)t[r].x=t[r].x-f.x,t[r].y=t[r].y-f.y;i.points=t;u.setGeometry(n,i)}};mxGraphLayout.prototype.setVertexLocation=function(n,t,i){var s=this.graph.getModel(),u=s.getGeometry(n),e=null,r,h,f,o,c;return u!=null&&(e=new mxRectangle(t,i,u.width,u.height),this.useBoundingBox&&(r=this.graph.getView().getState(n),r!=null&&r.text!=null&&r.text.boundingBox!=null&&(h=this.graph.getView().scale,f=r.text.boundingBox,r.text.boundingBox.x<r.x&&(t+=(r.x-f.x)/h,e.width=f.width),r.text.boundingBox.y<r.y&&(i+=(r.y-f.y)/h,e.height=f.height))),this.parent!=null&&(o=s.getParent(n),o!=null&&o!=this.parent&&(c=this.getParentOffset(o),t=t-c.x,i=i-c.y)),(u.x!=t||u.y!=i)&&(u=u.clone(),u.x=t,u.y=i,s.setGeometry(n,u))),e};mxGraphLayout.prototype.getVertexBounds=function(n){var t=this.graph.getModel().getGeometry(n),i,f,e;if(this.useBoundingBox&&(i=this.graph.getView().getState(n),i!=null&&i.text!=null&&i.text.boundingBox!=null)){var u=this.graph.getView().scale,r=i.text.boundingBox,o=Math.max(i.x-r.x,0)/u,s=Math.max(i.y-r.y,0)/u,h=Math.max(r.x+r.width-(i.x+i.width),0)/u,c=Math.max(r.y+r.height-(i.y+i.height),0)/u;t=new mxRectangle(t.x-o,t.y-s,t.width+o+h,t.height+s+c)}return this.parent!=null&&(f=this.graph.getModel().getParent(n),t=t.clone(),f!=null&&f!=this.parent&&(e=this.getParentOffset(f),t.x=t.x+e.x,t.y=t.y+e.y)),new mxRectangle(t.x,t.y,t.width,t.height)};mxGraphLayout.prototype.arrangeGroups=function(n,t,i,r,u,f){return this.graph.updateGroupBounds(n,t,!0,i,r,u,f)};WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=!1;WeightedCellSorter.prototype.visited=!1;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(n,t){return n!=null&&t!=null?t.weightedValue>n.weightedValue?-1:t.weightedValue<n.weightedValue?1:t.nudge?-1:1:0};mxStackLayout.prototype=new mxGraphLayout;mxStackLayout.prototype.constructor=mxStackLayout;mxStackLayout.prototype.horizontal=null;mxStackLayout.prototype.spacing=null;mxStackLayout.prototype.x0=null;mxStackLayout.prototype.y0=null;mxStackLayout.prototype.border=0;mxStackLayout.prototype.marginTop=0;mxStackLayout.prototype.marginLeft=0;mxStackLayout.prototype.marginRight=0;mxStackLayout.prototype.marginBottom=0;mxStackLayout.prototype.keepFirstLocation=!1;mxStackLayout.prototype.fill=!1;mxStackLayout.prototype.resizeParent=!1;mxStackLayout.prototype.resizeParentMax=!1;mxStackLayout.prototype.resizeLast=!1;mxStackLayout.prototype.wrap=null;mxStackLayout.prototype.borderCollapse=!0;mxStackLayout.prototype.isHorizontal=function(){return this.horizontal};mxStackLayout.prototype.moveCell=function(n,t,i){var e=this.graph.getModel(),r=e.getParent(n),h=this.isHorizontal(),l,f,a,s;if(n!=null&&r!=null){var u=0,v=0,y=e.getChildCount(r),o=h?t:i,c=this.graph.getView().getState(r);for(c!=null&&(o-=h?c.x:c.y),o/=this.graph.view.scale,u=0;u<y;u++)if(l=e.getChildAt(r,u),l!=n&&(f=e.getGeometry(l),f!=null)){if(a=h?f.x+f.width/2:f.y+f.height/2,v<=o&&a>o)break;v=a}s=r.getIndex(n);s=Math.max(0,u-(u>s?1:0));e.add(r,n,s)}};mxStackLayout.prototype.getParentSize=function(n){var i=this.graph.getModel(),t=i.getGeometry(n),r,u;return this.graph.container!=null&&(t==null&&i.isLayer(n)||n==this.graph.getView().currentRoot)&&(r=this.graph.container.offsetWidth-1,u=this.graph.container.offsetHeight-1,t=new mxRectangle(0,0,r,u)),t};mxStackLayout.prototype.execute=function(n){var c,l,v,f,i,s,k;if(n!=null){var u=this.getParentSize(n),r=this.isHorizontal(),h=this.graph.getModel(),e=null;if(u!=null&&(e=r?u.height-this.marginTop-this.marginBottom:u.width-this.marginLeft-this.marginRight),e-=2*this.border,c=this.x0+this.border+this.marginLeft,l=this.y0+this.border+this.marginTop,this.graph.isSwimlane(n)){var b=this.graph.getCellStyle(n),o=mxUtils.getNumber(b,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE),y=mxUtils.getValue(b,mxConstants.STYLE_HORIZONTAL,!0)==1;u!=null&&(o=y?Math.min(o,u.height):Math.min(o,u.width));r==y&&(e-=o);y?l+=o:c+=o}h.beginUpdate();try{var a=0,t=null,p=0,w=null,d=h.getChildCount(n);for(v=0;v<d;v++)f=h.getChildAt(n,v),!this.isVertexIgnored(f)&&this.isVertexMovable(f)&&(i=h.getGeometry(f),i!=null&&(i=i.clone(),this.wrap!=null&&t!=null&&(r&&t.x+t.width+i.width+2*this.spacing>this.wrap||!r&&t.y+t.height+i.height+2*this.spacing>this.wrap)&&(t=null,r?l+=a+this.spacing:c+=a+this.spacing,a=0),a=Math.max(a,r?i.height:i.width),s=0,this.borderCollapse||(k=this.graph.getCellStyle(f),s=mxUtils.getNumber(k,mxConstants.STYLE_STROKEWIDTH,1)),t!=null?r?i.x=p+this.spacing+Math.floor(s/2):i.y=p+this.spacing+Math.floor(s/2):this.keepFirstLocation||(r?i.x=c:i.y=l),r?i.y=l:i.x=c,this.fill&&e!=null&&(r?i.height=e:i.width=e),this.setChildGeometry(f,i),w=f,t=i,p=r?t.x+t.width+Math.floor(s/2):t.y+t.height+Math.floor(s/2)));this.resizeParent&&u!=null&&t!=null&&!this.graph.isCellCollapsed(n)?this.updateParentGeometry(n,u,t):this.resizeLast&&u!=null&&t!=null&&w!=null&&(r?t.width=u.width-t.x-this.spacing-this.marginRight-this.marginLeft:t.height=u.height-t.y-this.spacing-this.marginBottom,this.setChildGeometry(w,t))}finally{h.endUpdate()}}};mxStackLayout.prototype.setChildGeometry=function(n,t){var i=this.graph.getCellGeometry(n);(i==null||t.x!=i.x||t.y!=i.y||t.width!=i.width||t.height!=i.height)&&this.graph.getModel().setGeometry(n,t)};mxStackLayout.prototype.updateParentGeometry=function(n,t,i){var f=this.isHorizontal(),e=this.graph.getModel(),r=t.clone(),u;f?(u=i.x+i.width+this.marginRight+this.border,r.width=this.resizeParentMax?Math.max(r.width,u):u):(u=i.y+i.height+this.marginBottom+this.border,r.height=this.resizeParentMax?Math.max(r.height,u):u);(t.x!=r.x||t.y!=r.y||t.width!=r.width||t.height!=r.height)&&e.setGeometry(n,r)};mxPartitionLayout.prototype=new mxGraphLayout;mxPartitionLayout.prototype.constructor=mxPartitionLayout;mxPartitionLayout.prototype.horizontal=null;mxPartitionLayout.prototype.spacing=null;mxPartitionLayout.prototype.border=null;mxPartitionLayout.prototype.resizeVertices=!0;mxPartitionLayout.prototype.isHorizontal=function(){return this.horizontal};mxPartitionLayout.prototype.moveCell=function(n,t){var u=this.graph.getModel(),r=u.getParent(n),h,f,o,e;if(n!=null&&r!=null){for(var i=0,s=0,c=u.getChildCount(r),i=0;i<c;i++)if(h=u.getChildAt(r,i),f=this.getVertexBounds(h),f!=null){if(o=f.x+f.width/2,s<t&&o>t)break;s=o}e=r.getIndex(n);e=Math.max(0,i-(i>e?1:0));u.add(r,n,e)}};mxPartitionLayout.prototype.execute=function(n){var l=this.isHorizontal(),i=this.graph.getModel(),u=i.getGeometry(n),p,w,a,b,e,c,y,o,r,f,t;if(this.graph.container!=null&&(u==null&&i.isLayer(n)||n==this.graph.getView().currentRoot)&&(p=this.graph.container.offsetWidth-1,w=this.graph.container.offsetHeight-1,u=new mxRectangle(0,0,p,w)),u!=null){for(a=[],b=i.getChildCount(n),r=0;r<b;r++)f=i.getChildAt(n,r),!this.isVertexIgnored(f)&&this.isVertexMovable(f)&&a.push(f);if(e=a.length,e>0){var s=this.border,h=this.border,v=l?u.height:u.width;if(v-=2*this.border,c=this.graph.isSwimlane(n)?this.graph.getStartSize(n):new mxRectangle,v-=l?c.height:c.width,s=s+c.width,h=h+c.height,y=this.border+(e-1)*this.spacing,o=l?(u.width-s-y)/e:(u.height-h-y)/e,o>0){i.beginUpdate();try{for(r=0;r<e;r++)f=a[r],t=i.getGeometry(f),t!=null&&(t=t.clone(),t.x=s,t.y=h,l?(this.resizeVertices&&(t.width=o,t.height=v),s+=o+this.spacing):(this.resizeVertices&&(t.height=o,t.width=v),h+=o+this.spacing),i.setGeometry(f,t))}finally{i.endUpdate()}}}}};mxCompactTreeLayout.prototype=new mxGraphLayout;mxCompactTreeLayout.prototype.constructor=mxCompactTreeLayout;mxCompactTreeLayout.prototype.horizontal=null;mxCompactTreeLayout.prototype.invert=null;mxCompactTreeLayout.prototype.resizeParent=!0;mxCompactTreeLayout.prototype.maintainParentLocation=!1;mxCompactTreeLayout.prototype.groupPadding=10;mxCompactTreeLayout.prototype.groupPaddingTop=0;mxCompactTreeLayout.prototype.groupPaddingRight=0;mxCompactTreeLayout.prototype.groupPaddingBottom=0;mxCompactTreeLayout.prototype.groupPaddingLeft=0;mxCompactTreeLayout.prototype.parentsChanged=null;mxCompactTreeLayout.prototype.moveTree=!1;mxCompactTreeLayout.prototype.visited=null;mxCompactTreeLayout.prototype.levelDistance=10;mxCompactTreeLayout.prototype.nodeDistance=20;mxCompactTreeLayout.prototype.resetEdges=!0;mxCompactTreeLayout.prototype.prefHozEdgeSep=5;mxCompactTreeLayout.prototype.prefVertEdgeOff=4;mxCompactTreeLayout.prototype.minEdgeJetty=8;mxCompactTreeLayout.prototype.channelBuffer=4;mxCompactTreeLayout.prototype.edgeRouting=!0;mxCompactTreeLayout.prototype.sortEdges=!1;mxCompactTreeLayout.prototype.alignRanks=!1;mxCompactTreeLayout.prototype.maxRankHeight=null;mxCompactTreeLayout.prototype.root=null;mxCompactTreeLayout.prototype.node=null;mxCompactTreeLayout.prototype.isVertexIgnored=function(n){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(n).length==0};mxCompactTreeLayout.prototype.isHorizontal=function(){return this.horizontal};mxCompactTreeLayout.prototype.execute=function(n,t){var u,f,e,o,s,h,r,c,l,i;if(this.parent=n,u=this.graph.getModel(),t==null){if(this.graph.getEdges(n,u.getParent(n),this.invert,!this.invert,!1).length>0)this.root=n;else if(f=this.graph.findTreeRoots(n,!0,this.invert),f.length>0)for(e=0;e<f.length;e++)if(!this.isVertexIgnored(f[e])&&this.graph.getEdges(f[e],null,this.invert,!this.invert,!1).length>0){this.root=f[e];break}}else this.root=t;if(this.root!=null){this.parentsChanged=this.resizeParent?{}:null;this.parentX=null;this.parentY=null;n!=this.root&&u.isVertex(n)!=null&&this.maintainParentLocation&&(i=this.graph.getCellGeometry(n),i!=null&&(this.parentX=i.x,this.parentY=i.y));u.beginUpdate();try{this.visited={};this.node=this.dfs(this.root,n);this.alignRanks&&(this.maxRankHeight=[],this.findRankHeights(this.node,0),this.setCellHeights(this.node,0));this.node!=null&&(this.layout(this.node),o=this.graph.gridSize,s=o,this.moveTree||(h=this.getVertexBounds(this.root),h!=null&&(o=h.x,s=h.y)),r=null,r=this.isHorizontal()?this.horizontalLayout(this.node,o,s):this.verticalLayout(this.node,null,o,s),r!=null&&(c=0,l=0,r.x<0&&(c=Math.abs(o-r.x)),r.y<0&&(l=Math.abs(s-r.y)),(c!=0||l!=0)&&this.moveNode(this.node,c,l),this.resizeParent&&this.adjustParents(),this.edgeRouting&&this.localEdgeProcessing(this.node)),this.parentX!=null&&this.parentY!=null&&(i=this.graph.getCellGeometry(n),i!=null&&(i=i.clone(),i.x=this.parentX,i.y=this.parentY,u.setGeometry(n,i))))}finally{u.endUpdate()}}};mxCompactTreeLayout.prototype.moveNode=function(n,t,i){n.x+=t;n.y+=i;this.apply(n);for(var r=n.child;r!=null;)this.moveNode(r,t,i),r=r.next};mxCompactTreeLayout.prototype.sortOutgoingEdges=function(n,t){var i=new mxDictionary;t.sort(function(t,r){var o=t.getTerminal(t.getTerminal(!1)==n),f=i.get(o),e,u;return f==null&&(f=mxCellPath.create(o).split(mxCellPath.PATH_SEPARATOR),i.put(o,f)),e=r.getTerminal(r.getTerminal(!1)==n),u=i.get(e),u==null&&(u=mxCellPath.create(e).split(mxCellPath.PATH_SEPARATOR),i.put(e,u)),mxCellPath.compare(f,u)})};mxCompactTreeLayout.prototype.findRankHeights=function(n,t){(this.maxRankHeight[t]==null||this.maxRankHeight[t]<n.height)&&(this.maxRankHeight[t]=n.height);for(var i=n.child;i!=null;)this.findRankHeights(i,t+1),i=i.next};mxCompactTreeLayout.prototype.setCellHeights=function(n,t){this.maxRankHeight[t]!=null&&this.maxRankHeight[t]>n.height&&(n.height=this.maxRankHeight[t]);for(var i=n.child;i!=null;)this.setCellHeights(i,t+1),i=i.next};mxCompactTreeLayout.prototype.dfs=function(n,t){var s=mxCellPath.create(n),f=null,r,i;if(n!=null&&this.visited[s]==null&&!this.isVertexIgnored(n)){this.visited[s]=n;f=this.createNode(n);var a=this.graph.getModel(),e=null,o=this.graph.getEdges(n,t,this.invert,!this.invert,!1,!0),h=this.graph.getView();for(this.sortEdges&&this.sortOutgoingEdges(n,o),r=0;r<o.length;r++)if(i=o[r],!this.isEdgeIgnored(i)){this.resetEdges&&this.setEdgePoints(i,null);this.edgeRouting&&(this.setEdgeStyleEnabled(i,!1),this.setEdgePoints(i,null));var c=h.getState(i),l=c!=null?c.getVisibleTerminal(this.invert):h.getVisibleTerminal(i,this.invert),u=this.dfs(l,t);u!=null&&a.getGeometry(l)!=null&&(e==null?f.child=u:e.next=u,e=u)}}return f};mxCompactTreeLayout.prototype.layout=function(n){if(n!=null){for(var t=n.child;t!=null;)this.layout(t),t=t.next;n.child!=null?this.attachParent(n,this.join(n)):this.layoutLeaf(n)}};mxCompactTreeLayout.prototype.horizontalLayout=function(n,t,i,r){var u,e,f;if(n.x+=t+n.offsetX,n.y+=i+n.offsetY,r=this.apply(n,r),u=n.child,u!=null)for(r=this.horizontalLayout(u,n.x,n.y,r),e=n.y+u.offsetY,f=u.next;f!=null;)r=this.horizontalLayout(f,n.x+u.offsetX,e,r),e+=f.offsetY,f=f.next;return r};mxCompactTreeLayout.prototype.verticalLayout=function(n,t,i,r,u){var f,o,e;if(n.x+=i+n.offsetY,n.y+=r+n.offsetX,u=this.apply(n,u),f=n.child,f!=null)for(u=this.verticalLayout(f,n,n.x,n.y,u),o=n.x+f.offsetY,e=f.next;e!=null;)u=this.verticalLayout(e,n,o,n.y+f.offsetX,u),o+=e.offsetY,e=e.next;return u};mxCompactTreeLayout.prototype.attachParent=function(n,t){var i=this.nodeDistance+this.levelDistance,r=(t-n.width)/2-this.nodeDistance,u=r+n.width+2*this.nodeDistance-t;n.child.offsetX=i+n.height;n.child.offsetY=u;n.contour.upperHead=this.createLine(n.height,0,this.createLine(i,u,n.contour.upperHead));n.contour.lowerHead=this.createLine(n.height,0,this.createLine(i,r,n.contour.lowerHead))};mxCompactTreeLayout.prototype.layoutLeaf=function(n){var t=2*this.nodeDistance;n.contour.upperTail=this.createLine(n.height+t,0);n.contour.upperHead=n.contour.upperTail;n.contour.lowerTail=this.createLine(0,-n.width-t);n.contour.lowerHead=this.createLine(n.height+t,0,n.contour.lowerTail)};mxCompactTreeLayout.prototype.join=function(n){var f=2*this.nodeDistance,t=n.child,i,r,u;for(n.contour=t.contour,i=t.width+f,r=i,t=t.next;t!=null;)u=this.merge(n.contour,t.contour),t.offsetY=u+i,t.offsetX=0,i=t.width+f,r+=u+i,t=t.next;return r};mxCompactTreeLayout.prototype.merge=function(n,t){for(var u=0,f=0,s=0,r=n.lowerHead,i=t.upperHead,o,e;i!=null&&r!=null;)o=this.offset(u,f,i.dx,i.dy,r.dx,r.dy),f+=o,s+=o,u+i.dx<=r.dx?(u+=i.dx,f+=i.dy,i=i.next):(u-=r.dx,f-=r.dy,r=r.next);return i!=null?(e=this.bridge(n.upperTail,0,0,i,u,f),n.upperTail=e.next!=null?t.upperTail:e,n.lowerTail=t.lowerTail):(e=this.bridge(t.lowerTail,u,f,r,0,0),e.next==null&&(n.lowerTail=e)),n.lowerHead=t.lowerHead,s};mxCompactTreeLayout.prototype.offset=function(n,t,i,r,u,f){var e=0,s,o;return u<=n||n+i<=0?0:(s=u*r-i*f,s>0?n<0?(o=n*r,e=o/i-t):n>0?(o=n*f,e=o/u-t):e=-t:u<n+i?(o=(u-n)*r,e=f-(t+o/i)):u>n+i?(o=(i+n)*f,e=o/u-(t+r)):e=f-(t+r),e>0?e:0)};mxCompactTreeLayout.prototype.bridge=function(n,t,i,r,u,f){var s=u+r.dx-t,e=0,h=0,o;return r.dx==0?e=r.dy:(h=s*r.dy,e=h/r.dx),o=this.createLine(s,e,r.next),n.next=this.createLine(0,f+r.dy-e-i,o),o};mxCompactTreeLayout.prototype.createNode=function(n){var t={},i;return t.cell=n,t.x=0,t.y=0,t.width=0,t.height=0,i=this.getVertexBounds(n),i!=null&&(this.isHorizontal()?(t.width=i.height,t.height=i.width):(t.width=i.width,t.height=i.height)),t.offsetX=0,t.offsetY=0,t.contour={},t};mxCompactTreeLayout.prototype.apply=function(n,t){var e=this.graph.getModel(),r=n.cell,i=e.getGeometry(r),u,f;return r!=null&&i!=null&&(this.isVertexMovable(r)&&(i=this.setVertexLocation(r,n.x,n.y),this.resizeParent&&(u=e.getParent(r),f=mxCellPath.create(u),this.parentsChanged[f]==null&&(this.parentsChanged[f]=u))),t=t==null?new mxRectangle(i.x,i.y,i.width,i.height):new mxRectangle(Math.min(t.x,i.x),Math.min(t.y,i.y),Math.max(t.x+t.width,i.x+i.width),Math.max(t.y+t.height,i.y+i.height))),t};mxCompactTreeLayout.prototype.createLine=function(n,t,i){var r={};return r.dx=n,r.dy=t,r.next=i,r};mxCompactTreeLayout.prototype.adjustParents=function(){var n=[];for(var t in this.parentsChanged)n.push(this.parentsChanged[t]);this.arrangeGroups(mxUtils.sortCells(n,!0),this.groupPadding,this.groupPaddingTop,this.groupPaddingRight,this.groupPaddingBottom,this.groupPaddingLeft)};mxCompactTreeLayout.prototype.localEdgeProcessing=function(n){this.processNodeOutgoing(n);for(var t=n.child;t!=null;)this.localEdgeProcessing(t),t=t.next};mxCompactTreeLayout.prototype.processNodeOutgoing=function(n){for(var f=n.child,k=n.cell,o=0,a=[],y,s,p,w,h,e,l;f!=null;)o++,y=f.x,this.horizontal&&(y=f.y),a.push(new WeightedCellSorter(f,y)),f=f.next;a.sort(WeightedCellSorter.prototype.compare);s=n.width;p=(o+1)*this.prefHozEdgeSep;s>p+2*this.prefHozEdgeSep&&(s-=2*this.prefHozEdgeSep);w=s/o;h=w/2;s>p+2*this.prefHozEdgeSep&&(h+=this.prefHozEdgeSep);var c=this.minEdgeJetty-this.prefVertEdgeOff,d=0,t=this.getVertexBounds(k);for(f=n.child,e=0;e<a.length;e++){var g=a[e].cell.cell,v=this.getVertexBounds(g),b=this.graph.getEdgesBetween(k,g,!1),u=[],i=0,r=0;for(l=0;l<b.length;l++)this.horizontal?(i=t.x+t.width,r=t.y+h,u.push(new mxPoint(i,r)),i=t.x+t.width+c,u.push(new mxPoint(i,r)),r=v.y+v.height/2,u.push(new mxPoint(i,r)),this.setEdgePoints(b[l],u)):(i=t.x+h,r=t.y+t.height,u.push(new mxPoint(i,r)),r=t.y+t.height+c,u.push(new mxPoint(i,r)),i=v.x+v.width/2,u.push(new mxPoint(i,r)),this.setEdgePoints(b[l],u));e<o/2?c+=this.prefVertEdgeOff:e>o/2&&(c-=this.prefVertEdgeOff);h+=w;d=Math.max(d,c)}};mxUtils.extend(mxRadialTreeLayout,mxCompactTreeLayout);mxRadialTreeLayout.prototype.angleOffset=.5;mxRadialTreeLayout.prototype.rootx=0;mxRadialTreeLayout.prototype.rooty=0;mxRadialTreeLayout.prototype.levelDistance=120;mxRadialTreeLayout.prototype.nodeDistance=10;mxRadialTreeLayout.prototype.autoRadius=!1;mxRadialTreeLayout.prototype.sortEdges=!1;mxRadialTreeLayout.prototype.rowMinX=[];mxRadialTreeLayout.prototype.rowMaxX=[];mxRadialTreeLayout.prototype.rowMinCenX=[];mxRadialTreeLayout.prototype.rowMaxCenX=[];mxRadialTreeLayout.prototype.rowRadi=[];mxRadialTreeLayout.prototype.row=[];mxRadialTreeLayout.prototype.isVertexIgnored=function(n){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(n).length==0};mxRadialTreeLayout.prototype.execute=function(n){var e,o,v,f,h,c,y,p,u,s,k,d,t,i;this.parent=n;this.useBoundingBox=!1;this.edgeRouting=!1;mxCompactTreeLayout.prototype.execute.apply(this,arguments);e=null;o=this.getVertexBounds(this.root);this.centerX=o.x+o.width/2;this.centerY=o.y+o.height/2;for(v in this.visited)f=this.getVertexBounds(this.visited[v]),e=e!=null?e:f.clone(),e.add(f);for(this.calcRowDims([this.node],0),h=0,c=0,t=0;t<this.row.length;t++)y=(this.centerX-this.rowMinX[t]-this.nodeDistance)/this.rowRadi[t],p=(this.rowMaxX[t]-this.centerX-this.nodeDistance)/this.rowRadi[t],h=Math.max(h,y),c=Math.max(c,p);for(t=0;t<this.row.length;t++){var w=this.centerX-this.nodeDistance-h*this.rowRadi[t],g=this.centerX+this.nodeDistance+c*this.rowRadi[t],nt=g-w;for(i=0;i<this.row[t].length;i++){var u=this.row[t],r=u[i],f=this.getVertexBounds(r.cell),tt=(f.x+f.width/2-w)/nt,it=2*Math.PI*tt;r.theta=it}}for(t=this.row.length-2;t>=0;t--)for(u=this.row[t],i=0;i<u.length;i++){for(var r=u[i],l=r.child,a=0,b=0;l!=null;)b+=l.theta,a++,l=l.next;a>0&&(s=b/a,s>r.theta&&i<u.length-1?(k=u[i+1].theta,r.theta=Math.min(s,k-Math.PI/10)):s<r.theta&&i>0&&(d=u[i-1].theta,r.theta=Math.max(s,d+Math.PI/10)))}for(t=0;t<this.row.length;t++)for(i=0;i<this.row[t].length;i++){var u=this.row[t],r=u[i],f=this.getVertexBounds(r.cell);this.setVertexLocation(r.cell,this.centerX-f.width/2+this.rowRadi[t]*Math.cos(r.theta),this.centerY-f.height/2+this.rowRadi[t]*Math.sin(r.theta))}};mxRadialTreeLayout.prototype.calcRowDims=function(n,t){var f,u,r,e,i;if(n!=null&&n.length!=0){for(this.rowMinX[t]=this.centerX,this.rowMaxX[t]=this.centerX,this.rowMinCenX[t]=this.centerX,this.rowMaxCenX[t]=this.centerX,this.row[t]=[],f=!1,u=0;u<n.length;u++)for(r=n[u]!=null?n[u].child:null;r!=null;)e=r.cell,i=this.getVertexBounds(e),this.rowMinX[t]=Math.min(i.x,this.rowMinX[t]),this.rowMaxX[t]=Math.max(i.x+i.width,this.rowMaxX[t]),this.rowMinCenX[t]=Math.min(i.x+i.width/2,this.rowMinCenX[t]),this.rowMaxCenX[t]=Math.max(i.x+i.width/2,this.rowMaxCenX[t]),this.rowRadi[t]=i.y-this.getVertexBounds(this.root).y,r.child!=null&&(f=!0),this.row[t].push(r),r=r.next;f&&this.calcRowDims(this.row[t],t+1)}};mxFastOrganicLayout.prototype=new mxGraphLayout;mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout;mxFastOrganicLayout.prototype.useInputOrigin=!0;mxFastOrganicLayout.prototype.resetEdges=!0;mxFastOrganicLayout.prototype.disableEdgeStyle=!0;mxFastOrganicLayout.prototype.forceConstant=50;mxFastOrganicLayout.prototype.forceConstantSquared=0;mxFastOrganicLayout.prototype.minDistanceLimit=2;mxFastOrganicLayout.prototype.maxDistanceLimit=500;mxFastOrganicLayout.prototype.minDistanceLimitSquared=4;mxFastOrganicLayout.prototype.initialTemp=200;mxFastOrganicLayout.prototype.temperature=0;mxFastOrganicLayout.prototype.maxIterations=0;mxFastOrganicLayout.prototype.iteration=0;mxFastOrganicLayout.prototype.vertexArray;mxFastOrganicLayout.prototype.dispX;mxFastOrganicLayout.prototype.dispY;mxFastOrganicLayout.prototype.cellLocation;mxFastOrganicLayout.prototype.radius;mxFastOrganicLayout.prototype.radiusSquared;mxFastOrganicLayout.prototype.isMoveable;mxFastOrganicLayout.prototype.neighbours;mxFastOrganicLayout.prototype.indices;mxFastOrganicLayout.prototype.allowedToRun=!0;mxFastOrganicLayout.prototype.isVertexIgnored=function(n){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(n).length==0};mxFastOrganicLayout.prototype.execute=function(n){var b=this.graph.getModel(),c,v,a,r,f,l,y,s,h,t,u,i,e,o,p,w;for(this.vertexArray=[],r=this.graph.getChildVertices(n),t=0;t<r.length;t++)this.isVertexIgnored(r[t])||this.vertexArray.push(r[t]);for(c=this.useInputOrigin?this.graph.getBoundingBoxFromGeometry(this.vertexArray):null,v=this.vertexArray.length,this.indices=[],this.dispX=[],this.dispY=[],this.cellLocation=[],this.isMoveable=[],this.neighbours=[],this.radius=[],this.radiusSquared=[],this.forceConstant<.001&&(this.forceConstant=.001),this.forceConstantSquared=this.forceConstant*this.forceConstant,t=0;t<this.vertexArray.length;t++){u=this.vertexArray[t];this.cellLocation[t]=[];l=mxObjectIdentity.get(u);this.indices[l]=t;var i=this.getVertexBounds(u),k=i.width,d=i.height,e=i.x,o=i.y;this.cellLocation[t][0]=e+k/2;this.cellLocation[t][1]=o+d/2;this.radius[t]=Math.min(k,d);this.radiusSquared[t]=this.radius[t]*this.radius[t]}b.beginUpdate();try{for(t=0;t<v;t++)for(this.dispX[t]=0,this.dispY[t]=0,this.isMoveable[t]=this.isVertexMovable(this.vertexArray[t]),a=this.graph.getConnections(this.vertexArray[t],n),r=this.graph.getOpposites(a,this.vertexArray[t]),this.neighbours[t]=[],f=0;f<r.length;f++)this.resetEdges&&this.graph.resetEdge(a[f]),this.disableEdgeStyle&&this.setEdgeStyleEnabled(a[f],!1),l=mxObjectIdentity.get(r[f]),y=this.indices[l],this.neighbours[t][f]=y!=null?y:t;for(this.temperature=this.initialTemp,this.maxIterations==0&&(this.maxIterations=20*Math.sqrt(v)),this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun)return;this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature()}for(s=null,h=null,t=0;t<this.vertexArray.length;t++)u=this.vertexArray[t],this.isVertexMovable(u)&&(i=this.getVertexBounds(u),i!=null&&(this.cellLocation[t][0]-=i.width/2,this.cellLocation[t][1]-=i.height/2,e=this.graph.snap(Math.round(this.cellLocation[t][0])),o=this.graph.snap(Math.round(this.cellLocation[t][1])),this.setVertexLocation(u,e,o),s=s==null?e:Math.min(s,e),h=h==null?o:Math.min(h,o)));p=-(s||0)+1;w=-(h||0)+1;c!=null&&(p+=c.x,w+=c.y);this.graph.moveCells(this.vertexArray,p,w)}finally{b.endUpdate()}};mxFastOrganicLayout.prototype.calcPositions=function(){for(var t,i,r,n=0;n<this.vertexArray.length;n++)this.isMoveable[n]&&(t=Math.sqrt(this.dispX[n]*this.dispX[n]+this.dispY[n]*this.dispY[n]),t<.001&&(t=.001),i=this.dispX[n]/t*Math.min(t,this.temperature),r=this.dispY[n]/t*Math.min(t,this.temperature),this.dispX[n]=0,this.dispY[n]=0,this.cellLocation[n][0]+=i,this.cellLocation[n][1]+=r)};mxFastOrganicLayout.prototype.calcAttraction=function(){for(var i,t,n=0;n<this.vertexArray.length;n++)for(i=0;i<this.neighbours[n].length;i++)if(t=this.neighbours[n][i],n!=t&&this.isMoveable[n]&&this.isMoveable[t]){var u=this.cellLocation[n][0]-this.cellLocation[t][0],f=this.cellLocation[n][1]-this.cellLocation[t][1],r=u*u+f*f-this.radiusSquared[n]-this.radiusSquared[t];r<this.minDistanceLimitSquared&&(r=this.minDistanceLimitSquared);var e=Math.sqrt(r),o=r/this.forceConstant,s=u/e*o,h=f/e*o;this.dispX[n]-=s;this.dispY[n]-=h;this.dispX[t]+=s;this.dispY[t]+=h}};mxFastOrganicLayout.prototype.calcRepulsion=function(){for(var t,i,r,f,u,e=this.vertexArray.length,n=0;n<e;n++)for(t=n;t<e;t++){if(!this.allowedToRun)return;if(t!=n&&this.isMoveable[n]&&this.isMoveable[t]){if(i=this.cellLocation[n][0]-this.cellLocation[t][0],r=this.cellLocation[n][1]-this.cellLocation[t][1],i==0&&(i=.01+Math.random()),r==0&&(r=.01+Math.random()),f=Math.sqrt(i*i+r*r),u=f-this.radius[n]-this.radius[t],u>this.maxDistanceLimit)continue;u<this.minDistanceLimit&&(u=this.minDistanceLimit);var o=this.forceConstantSquared/u,s=i/f*o,h=r/f*o;this.dispX[n]+=s;this.dispY[n]+=h;this.dispX[t]-=s;this.dispY[t]-=h}}};mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations)};mxCircleLayout.prototype=new mxGraphLayout;mxCircleLayout.prototype.constructor=mxCircleLayout;mxCircleLayout.prototype.radius=null;mxCircleLayout.prototype.moveCircle=!1;mxCircleLayout.prototype.x0=0;mxCircleLayout.prototype.y0=0;mxCircleLayout.prototype.resetEdges=!0;mxCircleLayout.prototype.disableEdgeStyle=!0;mxCircleLayout.prototype.execute=function(n){var f=this.graph.getModel(),e,t,i,h;f.beginUpdate();try{var o=0,r=null,u=null,s=[],c=f.getChildCount(n);for(e=0;e<c;e++)t=f.getChildAt(n,e),this.isVertexIgnored(t)?this.isEdgeIgnored(t)||(this.resetEdges&&this.graph.resetEdge(t),this.disableEdgeStyle&&this.setEdgeStyleEnabled(t,!1)):(s.push(t),i=this.getVertexBounds(t),r=r==null?i.y:Math.min(r,i.y),u=u==null?i.x:Math.min(u,i.x),o=Math.max(o,Math.max(i.width,i.height)));h=this.getRadius(s.length,o);this.moveCircle&&(u=this.x0,r=this.y0);this.circle(s,h,u,r)}finally{f.endUpdate()}};mxCircleLayout.prototype.getRadius=function(n,t){return Math.max(n*t/Math.PI,this.radius)};mxCircleLayout.prototype.circle=function(n,t,i,r){for(var f=n.length,e=2*Math.PI/f,u=0;u<f;u++)this.isVertexMovable(n[u])&&this.setVertexLocation(n[u],Math.round(i+t+t*Math.sin(u*e)),Math.round(r+t+t*Math.cos(u*e)))};mxParallelEdgeLayout.prototype=new mxGraphLayout;mxParallelEdgeLayout.prototype.constructor=mxParallelEdgeLayout;mxParallelEdgeLayout.prototype.spacing=20;mxParallelEdgeLayout.prototype.execute=function(n){var i=this.findParallels(n),r,t;this.graph.model.beginUpdate();try{for(r in i)t=i[r],t.length>1&&this.layout(t)}finally{this.graph.model.endUpdate()}};mxParallelEdgeLayout.prototype.findParallels=function(n){for(var r,t,f=this.graph.getModel(),i=[],e=f.getChildCount(n),u=0;u<e;u++)r=f.getChildAt(n,u),this.isEdgeIgnored(r)||(t=this.getEdgeId(r),t!=null&&(i[t]==null&&(i[t]=[]),i[t].push(r)));return i};mxParallelEdgeLayout.prototype.getEdgeId=function(n){var r=this.graph.getView(),t=r.getVisibleTerminal(n,!0),i=r.getVisibleTerminal(n,!1);return t!=null&&i!=null?(t=mxObjectIdentity.get(t),i=mxObjectIdentity.get(i),t>i?i+"-"+t:t+"-"+i):null};mxParallelEdgeLayout.prototype.layout=function(n){var h=n[0],c=this.graph.getView(),l=this.graph.getModel(),t=l.getGeometry(c.getVisibleTerminal(h,!0)),r=l.getGeometry(c.getVisibleTerminal(h,!1)),u,f,i;if(t==r)for(u=t.x+t.width+this.spacing,f=t.y+t.height/2,i=0;i<n.length;i++)this.route(n[i],u,f),u+=this.spacing;else if(t!=null&&r!=null){var a=t.x+t.width/2,v=t.y+t.height/2,w=r.x+r.width/2,b=r.y+r.height/2,e=w-a,o=b-v,s=Math.sqrt(e*e+o*o);if(s>0){var u=a+e/2,f=v+o/2,y=o*this.spacing/s,p=e*this.spacing/s;for(u+=y*(n.length-1)/2,f-=p*(n.length-1)/2,i=0;i<n.length;i++)this.route(n[i],u,f),u-=y,f+=p}}};mxParallelEdgeLayout.prototype.route=function(n,t,i){this.graph.isCellMovable(n)&&this.setEdgePoints(n,[new mxPoint(t,i)])};mxCompositeLayout.prototype=new mxGraphLayout;mxCompositeLayout.prototype.constructor=mxCompositeLayout;mxCompositeLayout.prototype.layouts=null;mxCompositeLayout.prototype.master=null;mxCompositeLayout.prototype.moveCell=function(){this.master!=null?this.master.move.apply(this.master,arguments):this.layouts[0].move.apply(this.layouts[0],arguments)};mxCompositeLayout.prototype.execute=function(){var t=this.graph.getModel(),n;t.beginUpdate();try{for(n=0;n<this.layouts.length;n++)this.layouts[n].execute.apply(this.layouts[n],arguments)}finally{t.endUpdate()}};mxEdgeLabelLayout.prototype=new mxGraphLayout;mxEdgeLabelLayout.prototype.constructor=mxEdgeLabelLayout;mxEdgeLabelLayout.prototype.execute=function(n){for(var t,i,o=this.graph.view,u=this.graph.getModel(),f=[],e=[],s=u.getChildCount(n),r=0;r<s;r++)t=u.getChildAt(n,r),i=o.getState(t),i!=null&&(this.isVertexIgnored(t)?this.isEdgeIgnored(t)||f.push(i):e.push(i));this.placeLabels(e,f)};mxEdgeLabelLayout.prototype.placeLabels=function(n,t){var e=this.graph.getModel(),r,i,u,f;e.beginUpdate();try{for(r=0;r<t.length;r++)if(i=t[r],i!=null&&i.text!=null&&i.text.boundingBox!=null)for(u=0;u<n.length;u++)f=n[u],f!=null&&this.avoid(i,f)}finally{e.endUpdate()}};mxEdgeLabelLayout.prototype.avoid=function(n,t){var e=this.graph.getModel(),r=n.text.boundingBox,i;if(mxUtils.intersects(r,t)){var o=-r.y-r.height+t.y,s=-r.y+t.y+t.height,u=Math.abs(o)<Math.abs(s)?o:s,h=-r.x-r.width+t.x,c=-r.x+t.x+t.width,f=Math.abs(h)<Math.abs(c)?h:c;Math.abs(f)<Math.abs(u)?u=0:f=0;i=e.getGeometry(n.cell);i!=null&&(i=i.clone(),i.offset!=null?(i.offset.x+=f,i.offset.y+=u):i.offset=new mxPoint(f,u),e.setGeometry(n.cell,i))}};mxGraphAbstractHierarchyCell.prototype.maxRank=-1;mxGraphAbstractHierarchyCell.prototype.minRank=-1;mxGraphAbstractHierarchyCell.prototype.x=null;mxGraphAbstractHierarchyCell.prototype.y=null;mxGraphAbstractHierarchyCell.prototype.width=0;mxGraphAbstractHierarchyCell.prototype.height=0;mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.temp=null;mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(){return null};mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(){return null};mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return!1};mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return!1};mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(){return null};mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(){return null};mxGraphAbstractHierarchyCell.prototype.setX=function(n,t){this.isVertex()?this.x[0]=t:this.isEdge()&&(this.x[n-this.minRank-1]=t)};mxGraphAbstractHierarchyCell.prototype.getX=function(n){return this.isVertex()?this.x[0]:this.isEdge()?this.x[n-this.minRank-1]:0};mxGraphAbstractHierarchyCell.prototype.setY=function(n,t){this.isVertex()?this.y[0]=t:this.isEdge()&&(this.y[n-this.minRank-1]=t)};mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell;mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode;mxGraphHierarchyNode.prototype.cell=null;mxGraphHierarchyNode.prototype.id=null;mxGraphHierarchyNode.prototype.connectsAsTarget=null;mxGraphHierarchyNode.prototype.connectsAsSource=null;mxGraphHierarchyNode.prototype.hashCode=!1;mxGraphHierarchyNode.prototype.getRankValue=function(){return this.maxRank};mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(n){var i,t;if(this.nextLayerConnectedCells==null)for(this.nextLayerConnectedCells=[],this.nextLayerConnectedCells[0]=[],i=0;i<this.connectsAsTarget.length;i++)t=this.connectsAsTarget[i],t.maxRank==-1||t.maxRank==n+1?this.nextLayerConnectedCells[0].push(t.source):this.nextLayerConnectedCells[0].push(t);return this.nextLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(n){var i,t;if(this.previousLayerConnectedCells==null)for(this.previousLayerConnectedCells=[],this.previousLayerConnectedCells[0]=[],i=0;i<this.connectsAsSource.length;i++)t=this.connectsAsSource[i],t.minRank==-1||t.minRank==n-1?this.previousLayerConnectedCells[0].push(t.target):this.previousLayerConnectedCells[0].push(t);return this.previousLayerConnectedCells[0]};mxGraphHierarchyNode.prototype.isVertex=function(){return!0};mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(){return this.temp[0]};mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(n,t){this.temp[0]=t};mxGraphHierarchyNode.prototype.isAncestor=function(n){if(n!=null&&this.hashCode!=null&&n.hashCode!=null&&this.hashCode.length<n.hashCode.length){if(this.hashCode==n.hashCode)return!0;if(this.hashCode==null||this.hashCode==null)return!1;for(var t=0;t<this.hashCode.length;t++)if(this.hashCode[t]!=n.hashCode[t])return!1;return!0}return!1};mxGraphHierarchyNode.prototype.getCoreCell=function(){return this.cell};mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell;mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge;mxGraphHierarchyEdge.prototype.edges=null;mxGraphHierarchyEdge.prototype.ids=null;mxGraphHierarchyEdge.prototype.source=null;mxGraphHierarchyEdge.prototype.target=null;mxGraphHierarchyEdge.prototype.isReversed=!1;mxGraphHierarchyEdge.prototype.invert=function(){var n=this.source;this.source=this.target;this.target=n;this.isReversed=!this.isReversed};mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(n){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];for(var t=0;t<this.temp.length;t++)this.nextLayerConnectedCells[t]=[],t==this.temp.length-1?this.nextLayerConnectedCells[t].push(this.source):this.nextLayerConnectedCells[t].push(this)}return this.nextLayerConnectedCells[n-this.minRank-1]};mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(n){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];for(var t=0;t<this.temp.length;t++)this.previousLayerConnectedCells[t]=[],t==0?this.previousLayerConnectedCells[t].push(this.target):this.previousLayerConnectedCells[t].push(this)}return this.previousLayerConnectedCells[n-this.minRank-1]};mxGraphHierarchyEdge.prototype.isEdge=function(){return!0};mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(n){return this.temp[n-this.minRank-1]};mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(n,t){this.temp[n-this.minRank-1]=t};mxGraphHierarchyEdge.prototype.getCoreCell=function(){return this.edges!=null&&this.edges.length>0?this.edges[0]:null};mxGraphHierarchyModel.prototype.maxRank=null;mxGraphHierarchyModel.prototype.vertexMapper=null;mxGraphHierarchyModel.prototype.edgeMapper=null;mxGraphHierarchyModel.prototype.ranks=null;mxGraphHierarchyModel.prototype.roots=null;mxGraphHierarchyModel.prototype.parent=null;mxGraphHierarchyModel.prototype.dfsCount=0;mxGraphHierarchyModel.prototype.SOURCESCANSTARTRANK=1e8;mxGraphHierarchyModel.prototype.tightenToSource=!1;mxGraphHierarchyModel.prototype.createInternalCells=function(n,t,i){for(var c,s,f,u,l,e,h,o,a=n.getGraph(),r=0;r<t.length;r++){for(i[r]=new mxGraphHierarchyNode(t[r]),this.vertexMapper.put(t[r],i[r]),c=n.getEdges(t[r]),i[r].connectsAsSource=[],s=0;s<c.length;s++)if(f=n.getVisibleTerminal(c[s],!1),f!=t[r]&&n.graph.model.isVertex(f)&&!n.isVertexIgnored(f)&&(u=n.getEdgesBetween(t[r],f,!1),l=n.getEdgesBetween(t[r],f,!0),u!=null&&u.length>0&&this.edgeMapper.get(u[0])==null&&l.length*2>=u.length)){for(e=new mxGraphHierarchyEdge(u),h=0;h<u.length;h++)o=u[h],this.edgeMapper.put(o,e),a.resetEdge(o),n.disableEdgeStyle&&(n.setEdgeStyleEnabled(o,!1),n.setOrthogonalEdge(o,!0));e.source=i[r];mxUtils.indexOf(i[r].connectsAsSource,e)<0&&i[r].connectsAsSource.push(e)}i[r].temp[0]=0}};mxGraphHierarchyModel.prototype.initialRank=function(){var i=[],f,c,t,e,s,l,o,a,n,h,r,u;if(this.roots!=null)for(n=0;n<this.roots.length;n++)t=this.vertexMapper.get(this.roots[n]),t!=null&&i.push(t);for(f=this.vertexMapper.getValues(),n=0;n<f.length;n++)f[n].temp[0]=-1;for(c=i.slice();i.length>0;){for(t=i[0],e=t.connectsAsTarget,s=t.connectsAsSource,l=!0,o=this.SOURCESCANSTARTRANK,n=0;n<e.length;n++)if(r=e[n],r.temp[0]==5270620)u=r.source,o=Math.min(o,u.temp[0]-1);else{l=!1;break}if(l){if(t.temp[0]=o,this.maxRank=Math.min(this.maxRank,o),s!=null)for(n=0;n<s.length;n++)r=s[n],r.temp[0]=5270620,u=r.target,u.temp[0]==-1&&(i.push(u),u.temp[0]=-2);i.shift()}else if(a=i.shift(),i.push(t),a==t&&i.length==1)break}for(n=0;n<f.length;n++)f[n].temp[0]-=this.maxRank;for(n=0;n<c.length;n++){var t=c[n],v=0,e=t.connectsAsSource;for(h=0;h<e.length;h++)r=e[h],u=r.target,t.temp[0]=Math.max(v,u.temp[0]+1),v=t.temp[0]}this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank};mxGraphHierarchyModel.prototype.fixRanks=function(){var t=[],i,r,n,u,f;for(this.ranks=[],n=0;n<this.maxRank+1;n++)t[n]=[],this.ranks[n]=t[n];if(i=null,this.roots!=null)for(r=this.roots,i=[],n=0;n<r.length;n++)u=r[n],f=this.vertexMapper.get(u),i[n]=f;this.visit(function(n,i,r,u,f){var o,e;if(f==0&&i.maxRank<0&&i.minRank<0&&(t[i.temp[0]].push(i),i.maxRank=i.temp[0],i.minRank=i.temp[0],i.temp[0]=t[i.maxRank].length-1),n!=null&&r!=null&&(o=n.maxRank-i.maxRank,o>1))for(r.maxRank=n.maxRank,r.minRank=i.maxRank,r.temp=[],r.x=[],r.y=[],e=r.minRank+1;e<r.maxRank;e++)t[e].push(r),r.setGeneralPurposeVariable(e,t[e].length-1)},i,!1,null)};mxGraphHierarchyModel.prototype.visit=function(n,t,i,r){var f,u;if(t!=null){for(f=0;f<t.length;f++)u=t[f],u!=null&&(r==null&&(r={}),i?(u.hashCode=[],u.hashCode[0]=this.dfsCount,u.hashCode[1]=f,this.extendedDfs(null,u,null,n,r,u.hashCode,f,0)):this.dfs(null,u,null,n,r,0));this.dfsCount++}};mxGraphHierarchyModel.prototype.dfs=function(n,t,i,r,u,f){var o,s,e,h,c;if(t!=null)if(o=t.id,u[o]==null)for(u[o]=t,r(n,t,i,f,0),s=t.connectsAsSource.slice(),e=0;e<s.length;e++)h=s[e],c=h.target,this.dfs(t,c,h,r,u,f+1);else r(n,t,i,f,1)};mxGraphHierarchyModel.prototype.extendedDfs=function(n,t,i,r,u,f,e,o){var a,h,c,s,l,v;if(t!=null)if(n!=null&&(t.hashCode==null||t.hashCode[0]!=n.hashCode[0])&&(a=n.hashCode.length+1,t.hashCode=n.hashCode.slice(),t.hashCode[a-1]=e),h=t.id,u[h]==null)for(u[h]=t,r(n,t,i,o,0),c=t.connectsAsSource.slice(),s=0;s<c.length;s++)l=c[s],v=l.target,this.extendedDfs(t,v,l,r,u,t.hashCode,s,o+1);else r(n,t,i,o,1)};mxSwimlaneModel.prototype.maxRank=null;mxSwimlaneModel.prototype.vertexMapper=null;mxSwimlaneModel.prototype.edgeMapper=null;mxSwimlaneModel.prototype.ranks=null;mxSwimlaneModel.prototype.roots=null;mxSwimlaneModel.prototype.parent=null;mxSwimlaneModel.prototype.dfsCount=0;mxSwimlaneModel.prototype.SOURCESCANSTARTRANK=1e8;mxSwimlaneModel.prototype.tightenToSource=!1;mxSwimlaneModel.prototype.ranksPerGroup=null;mxSwimlaneModel.prototype.createInternalCells=function(n,t,i){for(var e,l,h,f,u,y,o,c,s,a=n.getGraph(),v=n.swimlanes,r=0;r<t.length;r++){for(i[r]=new mxGraphHierarchyNode(t[r]),this.vertexMapper.put(t[r],i[r]),i[r].swimlaneIndex=-1,e=0;e<v.length;e++)if(a.model.getParent(t[r])==v[e]){i[r].swimlaneIndex=e;break}for(l=n.getEdges(t[r]),i[r].connectsAsSource=[],h=0;h<l.length;h++)if(f=n.getVisibleTerminal(l[h],!1),f!=t[r]&&n.graph.model.isVertex(f)&&!n.isVertexIgnored(f)&&(u=n.getEdgesBetween(t[r],f,!1),y=n.getEdgesBetween(t[r],f,!0),u!=null&&u.length>0&&this.edgeMapper.get(u[0])==null&&y.length*2>=u.length)){for(o=new mxGraphHierarchyEdge(u),c=0;c<u.length;c++)s=u[c],this.edgeMapper.put(s,o),a.resetEdge(s),n.disableEdgeStyle&&(n.setEdgeStyleEnabled(s,!1),n.setOrthogonalEdge(s,!0));o.source=i[r];mxUtils.indexOf(i[r].connectsAsSource,o)<0&&i[r].connectsAsSource.push(o)}i[r].temp[0]=0}};mxSwimlaneModel.prototype.initialRank=function(){var i,a,s,r,h,y,t,c,o,l,u,n,f,e,v;if(this.ranksPerGroup=[],i=[],a={},this.roots!=null)for(n=0;n<this.roots.length;n++)t=this.vertexMapper.get(this.roots[n]),this.maxChainDfs(null,t,null,a,0),t!=null&&i.push(t);for(s=[],r=[],n=this.ranksPerGroup.length-1;n>=0;n--)s[n]=n==this.ranksPerGroup.length-1?0:r[n+1]+1,r[n]=s[n]+this.ranksPerGroup[n];for(this.maxRank=r[0],h=this.vertexMapper.getValues(),n=0;n<h.length;n++)h[n].temp[0]=-1;for(y=i.slice();i.length>0;){for(t=i[0],c=t.connectsAsTarget,o=t.connectsAsSource,l=!0,u=r[0],n=0;n<c.length;n++)if(f=c[n],f.temp[0]==5270620)e=f.source,u=Math.min(u,e.temp[0]-1);else{l=!1;break}if(l){if(u>r[t.swimlaneIndex]&&(u=r[t.swimlaneIndex]),t.temp[0]=u,o!=null)for(n=0;n<o.length;n++)f=o[n],f.temp[0]=5270620,e=f.target,e.temp[0]==-1&&(i.push(e),e.temp[0]=-2);i.shift()}else if(v=i.shift(),i.push(t),v==t&&i.length==1)break}};mxSwimlaneModel.prototype.maxChainDfs=function(n,t,i,r,u){var h,e,c,o,s,f;if(t!=null&&(h=mxCellPath.create(t.cell),r[h]==null))for(r[h]=t,e=t.swimlaneIndex,(this.ranksPerGroup[e]==null||this.ranksPerGroup[e]<u)&&(this.ranksPerGroup[e]=u),c=t.connectsAsSource.slice(),o=0;o<c.length;o++)s=c[o],f=s.target,t.swimlaneIndex<f.swimlaneIndex?this.maxChainDfs(t,f,s,mxUtils.clone(r,null,!0),0):t.swimlaneIndex==f.swimlaneIndex&&this.maxChainDfs(t,f,s,mxUtils.clone(r,null,!0),u+1)};mxSwimlaneModel.prototype.fixRanks=function(){var t=[],i,r,n,u,f;for(this.ranks=[],n=0;n<this.maxRank+1;n++)t[n]=[],this.ranks[n]=t[n];if(i=null,this.roots!=null)for(r=this.roots,i=[],n=0;n<r.length;n++)u=r[n],f=this.vertexMapper.get(u),i[n]=f;this.visit(function(n,i,r,u,f){var o,e;if(f==0&&i.maxRank<0&&i.minRank<0&&(t[i.temp[0]].push(i),i.maxRank=i.temp[0],i.minRank=i.temp[0],i.temp[0]=t[i.maxRank].length-1),n!=null&&r!=null&&(o=n.maxRank-i.maxRank,o>1))for(r.maxRank=n.maxRank,r.minRank=i.maxRank,r.temp=[],r.x=[],r.y=[],e=r.minRank+1;e<r.maxRank;e++)t[e].push(r),r.setGeneralPurposeVariable(e,t[e].length-1)},i,!1,null)};mxSwimlaneModel.prototype.visit=function(n,t,i,r){var f,u;if(t!=null){for(f=0;f<t.length;f++)u=t[f],u!=null&&(r==null&&(r={}),i?(u.hashCode=[],u.hashCode[0]=this.dfsCount,u.hashCode[1]=f,this.extendedDfs(null,u,null,n,r,u.hashCode,f,0)):this.dfs(null,u,null,n,r,0));this.dfsCount++}};mxSwimlaneModel.prototype.dfs=function(n,t,i,r,u,f){var o,s,e,h,c;if(t!=null)if(o=t.id,u[o]==null)for(u[o]=t,r(n,t,i,f,0),s=t.connectsAsSource.slice(),e=0;e<s.length;e++)h=s[e],c=h.target,this.dfs(t,c,h,r,u,f+1);else r(n,t,i,f,1)};mxSwimlaneModel.prototype.extendedDfs=function(n,t,i,r,u,f,e,o){var y,l,a,v,s,h,c;if(t!=null)if(n!=null&&(t.hashCode==null||t.hashCode[0]!=n.hashCode[0])&&(y=n.hashCode.length+1,t.hashCode=n.hashCode.slice(),t.hashCode[y-1]=e),l=t.id,u[l]==null){for(u[l]=t,r(n,t,i,o,0),a=t.connectsAsSource.slice(),v=t.connectsAsTarget.slice(),s=0;s<a.length;s++)h=a[s],c=h.target,t.swimlaneIndex<=c.swimlaneIndex&&this.extendedDfs(t,c,h,r,u,t.hashCode,s,o+1);for(s=0;s<v.length;s++)h=v[s],c=h.source,t.swimlaneIndex<c.swimlaneIndex&&this.extendedDfs(t,c,h,r,u,t.hashCode,s,o+1)}else r(n,t,i,o,1)};mxHierarchicalLayoutStage.prototype.execute=function(){};mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage;mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;mxMedianHybridCrossingReduction.prototype.execute=function(){var i=this.layout.getModel(),e,o,h,u,r,f,c,s,n,t;for(this.nestedBestRanks=[],n=0;n<i.ranks.length;n++)this.nestedBestRanks[n]=i.ranks[n].slice();for(e=0,o=this.calculateCrossings(i),n=0;n<this.maxIterations&&e<this.maxNoImprovementIterations;n++){if(this.weightedMedian(n,i),this.transpose(n,i),h=this.calculateCrossings(i),h<o)for(o=h,e=0,t=0;t<this.nestedBestRanks.length;t++)for(u=i.ranks[t],r=0;r<u.length;r++)f=u[r],this.nestedBestRanks[t][f.getGeneralPurposeVariable(t)]=f;else for(e++,t=0;t<this.nestedBestRanks.length;t++)for(u=i.ranks[t],r=0;r<u.length;r++)f=u[r],f.setGeneralPurposeVariable(t,r);if(o==0)break}for(c=[],s=[],n=0;n<i.maxRank+1;n++)s[n]=[],c[n]=s[n];for(n=0;n<this.nestedBestRanks.length;n++)for(t=0;t<this.nestedBestRanks[n].length;t++)s[n].push(this.nestedBestRanks[n][t]);i.ranks=c};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(n){for(var r=n.ranks.length,i=0,t=1;t<r;t++)i+=this.calculateRankCrossing(t,n);return i};mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(n,t){for(var o,y,p,f,u,w,e,b,r,c=0,l=t.ranks[n],k=t.ranks[n-1],s=[],i=0;i<l.length;i++){var a=l[i],d=a.getGeneralPurposeVariable(n),v=a.getPreviousLayerConnectedCells(n),h=[];for(o=0;o<v.length;o++)y=v[o],p=y.getGeneralPurposeVariable(n-1),h.push(p);h.sort(function(n,t){return n-t});s[d]=h}for(f=[],i=0;i<s.length;i++)f=f.concat(s[i]);for(u=1;u<k.length;)u<<=1;for(w=2*u-1,u-=1,e=[],i=0;i<w;++i)e[i]=0;for(i=0;i<f.length;i++)for(b=f[i],r=b+u,++e[r];r>0;)r%2&&(c+=e[r+1]),r=r-1>>1,++e[r];return c};mxMedianHybridCrossingReduction.prototype.transpose=function(n,t){for(var nt=!0,rt=0,tt,r,k,d,it,g,u,w,b,i,f,ut;nt&&rt++<10;)for(tt=n%2==1&&rt%2==1,nt=!1,r=0;r<t.ranks.length;r++){for(k=t.ranks[r],d=[],u=0;u<k.length;u++)it=k[u],g=it.getGeneralPurposeVariable(r),g<0&&(g=u),d[g]=it;var a=null,v=null,y=null,p=null,e=null,o=null,s=null,h=null,c=null,l=null;for(u=0;u<k.length-1;u++){if(u==0){for(c=d[u],a=c.getNextLayerConnectedCells(r),v=c.getPreviousLayerConnectedCells(r),e=[],o=[],i=0;i<a.length;i++)e[i]=a[i].getGeneralPurposeVariable(r+1);for(i=0;i<v.length;i++)o[i]=v[i].getGeneralPurposeVariable(r-1)}else a=y,v=p,e=s,o=h,c=l;for(l=d[u+1],y=l.getNextLayerConnectedCells(r),p=l.getPreviousLayerConnectedCells(r),s=[],h=[],i=0;i<y.length;i++)s[i]=y[i].getGeneralPurposeVariable(r+1);for(i=0;i<p.length;i++)h[i]=p[i].getGeneralPurposeVariable(r-1);for(w=0,b=0,i=0;i<e.length;i++)for(f=0;f<s.length;f++)e[i]>s[f]&&w++,e[i]<s[f]&&b++;for(i=0;i<o.length;i++)for(f=0;f<h.length;f++)o[i]>h[f]&&w++,o[i]<h[f]&&b++;(b<w||b==w&&tt)&&(ut=c.getGeneralPurposeVariable(r),c.setGeneralPurposeVariable(r,l.getGeneralPurposeVariable(r)),l.setGeneralPurposeVariable(r,ut),y=a,p=v,s=e,h=o,l=c,tt||(nt=!0))}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(n,t){var r=n%2==0,i;if(r)for(i=t.maxRank-1;i>=0;i--)this.medianRank(i,r);else for(i=1;i<t.maxRank;i++)this.medianRank(i,r)};mxMedianHybridCrossingReduction.prototype.medianRank=function(n,t){for(var u,f,h,r,o=this.nestedBestRanks[n].length,e=[],s=[],i=0;i<o;i++)r=this.nestedBestRanks[n][i],u=new MedianCellSorter,u.cell=r,f=t?r.getNextLayerConnectedCells(n):r.getPreviousLayerConnectedCells(n),h=t?n+1:n-1,f!=null&&f.length!=0?(u.medianValue=this.medianValue(f,h),e.push(u)):s[r.getGeneralPurposeVariable(n)]=!0;for(e.sort(MedianCellSorter.prototype.compare),i=0;i<o;i++)s[i]==null&&(r=e.shift().cell,r.setGeneralPurposeVariable(n,i))};mxMedianHybridCrossingReduction.prototype.medianValue=function(n,t){for(var e,i=[],r=0,f=0;f<n.length;f++)e=n[f],i[r++]=e.getGeneralPurposeVariable(t);if(i.sort(function(n,t){return n-t}),r%2==1)return i[Math.floor(r/2)];if(r==2)return(i[0]+i[1])/2;var u=r/2,o=i[u-1]-i[0],s=i[r-1]-i[u];return(i[u-1]*s+i[u]*o)/(o+s)};MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.cell=!1;MedianCellSorter.prototype.compare=function(n,t){return n!=null&&t!=null?t.medianValue>n.medianValue?-1:t.medianValue<n.medianValue?1:0:0};mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage;mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;mxMinimumCycleRemover.prototype.execute=function(){for(var r,e,o,t=this.layout.getModel(),u={},f=t.vertexMapper.getValues(),i={},n=0;n<f.length;n++)i[f[n].id]=f[n];if(r=null,t.roots!=null)for(e=t.roots,r=[],n=0;n<e.length;n++)r[n]=t.vertexMapper.get(e[n]);t.visit(function(n,t,r){t.isAncestor(n)&&(r.invert(),mxUtils.remove(r,n.connectsAsSource),n.connectsAsTarget.push(r),mxUtils.remove(r,t.connectsAsTarget),t.connectsAsSource.push(r));u[t.id]=t;delete i[t.id]},r,!0,null);o=mxUtils.clone(u,null,!0);t.visit(function(n,t,r){t.isAncestor(n)&&(r.invert(),mxUtils.remove(r,n.connectsAsSource),t.connectsAsSource.push(r),n.connectsAsTarget.push(r),mxUtils.remove(r,t.connectsAsTarget));u[t.id]=t;delete i[t.id]},i,!0,o)};mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage;mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;mxCoordinateAssignment.prototype.interRankCellSpacing=100;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.prefHozEdgeSep=5;mxCoordinateAssignment.prototype.prefVertEdgeOff=2;mxCoordinateAssignment.prototype.minEdgeJetty=12;mxCoordinateAssignment.prototype.channelBuffer=4;mxCoordinateAssignment.prototype.jettyPositions=null;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.rankTopY=null;mxCoordinateAssignment.prototype.rankBottomY=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=!0;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.groupPadding=10;mxCoordinateAssignment.prototype.printStatus=function(){var r=this.layout.getModel(),n,i,t,u;for(mxLog.show(),mxLog.writeln("======Coord assignment debug======="),n=0;n<r.ranks.length;n++){for(mxLog.write("Rank ",n," : "),i=r.ranks[n],t=0;t<i.length;t++)u=i[t],mxLog.write(u.getGeneralPurposeVariable(n),"  ");mxLog.writeln()}mxLog.writeln("====================================")};mxCoordinateAssignment.prototype.execute=function(){var t,e,f,n,r,i,u;if(this.jettyPositions=Object(),t=this.layout.getModel(),this.currentXDelta=0,this.initialCoords(this.layout.getGraph(),t),this.fineTuning&&this.minNode(t),e=1e8,this.fineTuning)for(f=0;f<this.maxIterations;f++){if(f!=0&&(this.medianPos(f,t),this.minNode(t)),this.currentXDelta<e){for(n=0;n<t.ranks.length;n++)for(r=t.ranks[n],i=0;i<r.length;i++)u=r[i],u.setX(n,u.getGeneralPurposeVariable(n));e=this.currentXDelta}else for(n=0;n<t.ranks.length;n++)for(r=t.ranks[n],i=0;i<r.length;i++)u=r[i],u.setGeneralPurposeVariable(n,u.getX(n));this.minPath(this.layout.getGraph(),t);this.currentXDelta=0}this.setCellLocations(this.layout.getGraph(),t)};mxCoordinateAssignment.prototype.minNode=function(n){for(var l,g,a,e,tt,h,ot,it,c,k,u,o=[],d=new mxDictionary,s=[],i=0;i<=n.maxRank;i++)for(s[i]=n.ranks[i],l=0;l<s[i].length;l++)g=s[i][l],a=new WeightedCellSorter(g,i),a.rankIndex=l,a.visited=!0,o.push(a),d.put(g,a);for(var st=o.length*10,rt=0,v=1;o.length>0&&rt<=st;){var y=o.shift(),r=y.cell,t=y.weightedValue,p=parseInt(y.rankIndex),w=r.getNextLayerConnectedCells(t),b=r.getPreviousLayerConnectedCells(t),ut=w.length,ft=b.length,ht=this.medianXValue(w,t+1),ct=this.medianXValue(b,t-1),et=ut+ft,nt=r.getGeneralPurposeVariable(t),f=nt;if(et>0&&(f=(ht*ut+ct*ft)/et),e=!1,f<nt-v?p==0?(r.setGeneralPurposeVariable(t,f),e=!0):(tt=s[t][p-1],h=tt.getGeneralPurposeVariable(t),h=h+tt.width/2+this.intraCellSpacing+r.width/2,h<f?(r.setGeneralPurposeVariable(t,f),e=!0):h<r.getGeneralPurposeVariable(t)-v&&(r.setGeneralPurposeVariable(t,h),e=!0)):f>nt+v&&(ot=s[t].length,p==ot-1?(r.setGeneralPurposeVariable(t,f),e=!0):(it=s[t][p+1],c=it.getGeneralPurposeVariable(t),c=c-it.width/2-this.intraCellSpacing-r.width/2,c>f?(r.setGeneralPurposeVariable(t,f),e=!0):c>r.getGeneralPurposeVariable(t)+v&&(r.setGeneralPurposeVariable(t,c),e=!0))),e){for(i=0;i<w.length;i++)k=w[i],u=d.get(k),u!=null&&u.visited==!1&&(u.visited=!0,o.push(u));for(i=0;i<b.length;i++)k=b[i],u=d.get(k),u!=null&&u.visited==!1&&(u.visited=!0,o.push(u))}y.visited=!1;rt++}};mxCoordinateAssignment.prototype.medianPos=function(n,t){var r=n%2==0,i;if(r)for(i=t.maxRank;i>0;i--)this.rankMedianPosition(i-1,t,i);else for(i=0;i<t.maxRank-1;i++)this.rankMedianPosition(i+1,t,i)};mxCoordinateAssignment.prototype.rankMedianPosition=function(n,t,i){for(var c,h,b,l,y,k,a,f,s,p,v=t.ranks[n],u=[],w={},r=0;r<v.length;r++)c=v[r],u[r]=new WeightedCellSorter,u[r].cell=c,u[r].rankIndex=r,w[c.id]=u[r],h=null,h=i<n?c.getPreviousLayerConnectedCells(n):c.getNextLayerConnectedCells(n),u[r].weightedValue=this.calculatedWeightedValue(c,h);for(u.sort(WeightedCellSorter.prototype.compare),r=0;r<u.length;r++){var d=0,e=u[r].cell,h=null,o=0;for(h=i<n?e.getPreviousLayerConnectedCells(n).slice():e.getNextLayerConnectedCells(n).slice(),h!=null&&(d=h.length,o=d>0?this.medianXValue(h,i):e.getGeneralPurposeVariable(n)),b=0,l=-1e8,f=u[r].rankIndex-1;f>=0;)s=w[v[f].id],s!=null&&(y=s.cell,s.visited?(l=y.getGeneralPurposeVariable(n)+y.width/2+this.intraCellSpacing+b+e.width/2,f=-1):(b+=y.width+this.intraCellSpacing,f--));for(k=0,a=1e8,f=u[r].rankIndex+1;f<u.length;)s=w[v[f].id],s!=null&&(p=s.cell,s.visited?(a=p.getGeneralPurposeVariable(n)-p.width/2-this.intraCellSpacing-k-e.width/2,f=u.length):(k+=p.width+this.intraCellSpacing,f++));o>=l&&o<=a?e.setGeneralPurposeVariable(n,o):o<l?(e.setGeneralPurposeVariable(n,l),this.currentXDelta+=l-o):o>a&&(e.setGeneralPurposeVariable(n,a),this.currentXDelta+=o-a);u[r].visited=!0}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(n,t){for(var u,i=0,r=0;r<t.length;r++)u=t[r],n.isVertex()&&u.isVertex()?i++:i+=n.isEdge()&&u.isEdge()?8:2;return i};mxCoordinateAssignment.prototype.medianXValue=function(n,t){var i,r;if(n.length==0)return 0;for(i=[],r=0;r<n.length;r++)i[r]=n[r].getGeneralPurposeVariable(t);if(i.sort(function(n,t){return n-t}),n.length%2==1)return i[Math.floor(n.length/2)];var u=n.length/2,f=i[u-1],e=i[u];return(f+e)/2};mxCoordinateAssignment.prototype.initialCoords=function(n,t){var i;for(this.calculateWidestRank(n,t),i=this.widestRank;i>=0;i--)i<t.maxRank&&this.rankCoordinates(i,n,t);for(i=this.widestRank+1;i<=t.maxRank;i++)i>0&&this.rankCoordinates(i,n,t)};mxCoordinateAssignment.prototype.rankCoordinates=function(n,t,i){for(var r,u,o,s=i.ranks[n],h=0,f=this.initialX+(this.widestRankValue-this.rankWidths[n])/2,c=!1,e=0;e<s.length;e++)r=s[e],r.isVertex()?(u=this.layout.getVertexBounds(r.cell),u!=null?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(r.width=u.width,r.height=u.height):(r.width=u.height,r.height=u.width):c=!0,h=Math.max(h,r.height)):r.isEdge()&&(o=1,r.edges!=null?o=r.edges.length:mxLog.warn("edge.edges is null"),r.width=(o-1)*this.parallelEdgeSpacing),f+=r.width/2,r.setX(n,f),r.setGeneralPurposeVariable(n,f),f+=r.width/2,f+=this.intraCellSpacing;c==!0&&mxLog.warn("At least one cell has no bounds")};mxCoordinateAssignment.prototype.calculateWidestRank=function(n,t){var o=-this.interRankCellSpacing,a=0,r,i,e,c,l,f,y;for(this.rankWidths=[],this.rankY=[],r=t.maxRank;r>=0;r--){var s=0,h=t.ranks[r],u=this.initialX,v=!1;for(f=0;f<h.length;f++)i=h[f],i.isVertex()?(e=this.layout.getVertexBounds(i.cell),e!=null?this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(i.width=e.width,i.height=e.height):(i.width=e.height,i.height=e.width):v=!0,s=Math.max(s,i.height)):i.isEdge()&&(c=1,i.edges!=null?c=i.edges.length:mxLog.warn("edge.edges is null"),i.width=(c-1)*this.parallelEdgeSpacing),u+=i.width/2,i.setX(r,u),i.setGeneralPurposeVariable(r,u),u+=i.width/2,u+=this.intraCellSpacing,u>this.widestRankValue&&(this.widestRankValue=u,this.widestRank=r),this.rankWidths[r]=u;for(v==!0&&mxLog.warn("At least one cell has no bounds"),this.rankY[r]=o,l=s/2+a/2+this.interRankCellSpacing,a=s,this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST?o+=l:o-=l,f=0;f<h.length;f++)y=h[f],y.setY(r,o)}};mxCoordinateAssignment.prototype.minPath=function(n,t){for(var i,a,f,r,v=t.edgeMapper.getValues(),c=0;c<v.length;c++)if(i=v[c],!(i.maxRank-i.minRank-1<1)){var y=i.getGeneralPurposeVariable(i.minRank+1),p=!0,l=0;for(r=i.minRank+2;r<i.maxRank;r++)a=i.getGeneralPurposeVariable(r),y!=a?(p=!1,y=a):l++;if(!p){var e=0,o=0,s=[],h=[],u=i.getGeneralPurposeVariable(i.minRank+1);for(r=i.minRank+1;r<i.maxRank-1;r++)f=i.getX(r+1),u==f?(s[r-i.minRank-1]=u,e++):this.repositionValid(t,i,r+1,u)?(s[r-i.minRank-1]=u,e++):(s[r-i.minRank-1]=f,u=f);for(u=i.getX(r),r=i.maxRank-1;r>i.minRank+1;r--)f=i.getX(r-1),u==f?(h[r-i.minRank-2]=u,o++):this.repositionValid(t,i,r-1,u)?(h[r-i.minRank-2]=u,o++):(h[r-i.minRank-2]=i.getX(r-1),u=f);if(o>l||e>l)if(o>=e)for(r=i.maxRank-2;r>i.minRank;r--)i.setX(r,h[r-i.minRank-1]);else if(e>o)for(r=i.minRank+2;r<i.maxRank;r++)i.setX(r,s[r-i.minRank-2])}}};mxCoordinateAssignment.prototype.repositionValid=function(n,t,i,r){for(var h,c,o,l,s,f=n.ranks[i],u=-1,e=0;e<f.length;e++)if(t==f[e]){u=e;break}return u<0?!1:(h=t.getGeneralPurposeVariable(i),r<h)?u==0?!0:(c=f[u-1],o=c.getGeneralPurposeVariable(i),o=o+c.width/2+this.intraCellSpacing+t.width/2,o<=r?!0:!1):r>h?u==f.length-1?!0:(l=f[u+1],s=l.getGeneralPurposeVariable(i),s=s-l.width/2-this.intraCellSpacing-t.width/2,s>=r?!0:!1):!0};mxCoordinateAssignment.prototype.setCellLocations=function(n,t){var r,u,i;for(this.rankTopY=[],this.rankBottomY=[],i=0;i<t.ranks.length;i++)this.rankTopY[i]=Number.MAX_VALUE,this.rankBottomY[i]=-Number.MAX_VALUE;for(r=t.vertexMapper.getValues(),i=0;i<r.length;i++)this.setVertexLocation(r[i]);for((this.layout.edgeStyle==mxHierarchicalEdgeStyle.ORTHOGONAL||this.layout.edgeStyle==mxHierarchicalEdgeStyle.POLYLINE||this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE)&&this.localEdgeProcessing(t),u=t.edgeMapper.getValues(),i=0;i<u.length;i++)this.setEdgePosition(u[i])};mxCoordinateAssignment.prototype.localEdgeProcessing=function(n){for(var k,p,i,u,a,e,v,d,h,c,f,tt,t,ft,l,y,r=0;r<n.ranks.length;r++)for(k=n.ranks[r],p=0;p<k.length;p++)if(i=k[p],i.isVertex())for(u=i.getPreviousLayerConnectedCells(r),a=r-1,e=0;e<2;e++){if(a>-1&&a<n.ranks.length&&u!=null&&u.length>0){for(v=[],t=0;t<u.length;t++)d=new WeightedCellSorter(u[t],u[t].getX(a)),v.push(d);v.sort(WeightedCellSorter.prototype.compare);var w=i.x[0]-i.width/2,g=w+i.width,o=0,nt=0,s=[];for(t=0;t<v.length;t++)if(h=v[t].cell,h.isVertex())for(c=e==0?i.connectsAsSource:i.connectsAsTarget,f=0;f<c.length;f++)(c[f].source==h||c[f].target==h)&&(o+=c[f].edges.length,nt++,s.push(c[f]));else o+=h.edges.length,nt++,s.push(h);tt=(o+1)*this.prefHozEdgeSep;i.width>tt+2*this.prefHozEdgeSep&&(w+=this.prefHozEdgeSep,g-=this.prefHozEdgeSep);var et=g-w,it=et/o,rt=w+it/2,b=this.minEdgeJetty-this.prefVertEdgeOff,ut=0;for(t=0;t<s.length;t++){for(ft=s[t].edges.length,l=this.jettyPositions[s[t].ids[0]],l==null&&(l=[],this.jettyPositions[s[t].ids[0]]=l),t<o/2?b+=this.prefVertEdgeOff:t>o/2&&(b-=this.prefVertEdgeOff),y=0;y<ft;y++)l[y*4+e*2]=rt,rt+=it,l[y*4+e*2+1]=b;ut=Math.max(ut,b)}}u=i.getNextLayerConnectedCells(r);a=r+1}};mxCoordinateAssignment.prototype.setEdgePosition=function(n){var s=0,e,o,k,i,w,g,ot,v;if(n.temp[0]!=101207){e=n.maxRank;o=n.minRank;e==o&&(e=n.source.maxRank,o=n.target.minRank);var p=0,h=this.jettyPositions[n.ids[0]],ht=n.isReversed?n.target.cell:n.source.cell,c=this.layout.graph,l=this.orientation==mxConstants.DIRECTION_EAST||this.orientation==mxConstants.DIRECTION_SOUTH;for(k=0;k<n.edges.length;k++){var a=n.edges[k],rt=this.layout.getVisibleTerminal(a,!0),t=[],r=n.isReversed;if(rt!=ht&&(r=!r),h!=null){var d=r?2:0,f=r?l?this.rankBottomY[o]:this.rankTopY[o]:l?this.rankTopY[e]:this.rankBottomY[e],u=h[p*4+1+d];r!=l&&(u=-u);f+=u;i=h[p*4+d];w=c.model.getTerminal(a,!0);this.layout.isPort(w)&&c.model.getParent(w)==rt&&(v=c.view.getState(w),i=v!=null?v.x:rt.geometry.x+n.source.width*w.geometry.x);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(t.push(new mxPoint(i,f)),this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&t.push(new mxPoint(i,f+u))):(t.push(new mxPoint(f,i)),this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&t.push(new mxPoint(f+u,i)))}var ft=n.x.length-1,et=-1,ut=-1,y=n.maxRank-1;for(r&&(ft=0,et=n.x.length,ut=1,y=n.minRank+1),g=ft;n.maxRank!=n.minRank&&g!=et;g+=ut){var b=n.x[g]+s,nt=(this.rankTopY[y]+this.rankBottomY[y+1])/2,tt=(this.rankTopY[y-1]+this.rankBottomY[y])/2;r&&(ot=nt,nt=tt,tt=ot);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(t.push(new mxPoint(b,nt)),t.push(new mxPoint(b,tt))):(t.push(new mxPoint(nt,b)),t.push(new mxPoint(tt,b)));this.limitX=Math.max(this.limitX,b);y+=ut}if(h!=null){var d=r?2:0,ct=r?l?this.rankTopY[e]:this.rankBottomY[e]:l?this.rankBottomY[o]:this.rankTopY[o],u=h[p*4+3-d];r!=l&&(u=-u);var f=ct-u,i=h[p*4+2-d],it=c.model.getTerminal(a,!1),st=this.layout.getVisibleTerminal(a,!1);this.layout.isPort(it)&&c.model.getParent(it)==st&&(v=c.view.getState(it),i=v!=null?v.x:st.geometry.x+n.target.width*it.geometry.x);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&t.push(new mxPoint(i,f-u)),t.push(new mxPoint(i,f))):(this.layout.edgeStyle==mxHierarchicalEdgeStyle.CURVE&&t.push(new mxPoint(f-u,i)),t.push(new mxPoint(f,i)))}n.isReversed&&this.processReversedEdge(n,a);this.layout.setEdgePoints(a,t);s=s==0?this.parallelEdgeSpacing:s>0?-s:-s+this.parallelEdgeSpacing;p++}n.temp[0]=101207}};mxCoordinateAssignment.prototype.setVertexLocation=function(n){var r=n.cell,i=n.x[0]-n.width/2,t=n.y[0]-n.height/2;this.rankTopY[n.minRank]=Math.min(this.rankTopY[n.minRank],t);this.rankBottomY[n.minRank]=Math.max(this.rankBottomY[n.minRank],t+n.height);this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH?this.layout.setVertexLocation(r,i,t):this.layout.setVertexLocation(r,t,i);this.limitX=Math.max(this.limitX,i+n.width)};mxCoordinateAssignment.prototype.processReversedEdge=function(){};mxSwimlaneOrdering.prototype=new mxHierarchicalLayoutStage;mxSwimlaneOrdering.prototype.constructor=mxSwimlaneOrdering;mxSwimlaneOrdering.prototype.layout=null;mxSwimlaneOrdering.prototype.execute=function(){var t=this.layout.getModel(),u={},f=mxUtils.clone(t.vertexMapper,null,!0),r=null,i,n,e;if(t.roots!=null)for(i=t.roots,r=[],n=0;n<i.length;n++)e=mxCellPath.create(i[n]),r[n]=t.vertexMapper.get(i[n]);t.visit(function(n,t,i){var e=n!=null&&n.swimlaneIndex==t.swimlaneIndex&&t.isAncestor(n),o=n!=null&&i!=null&&n.swimlaneIndex<t.swimlaneIndex&&i.source==t,r;e?(i.invert(),mxUtils.remove(i,n.connectsAsSource),t.connectsAsSource.push(i),n.connectsAsTarget.push(i),mxUtils.remove(i,t.connectsAsTarget)):o&&(i.invert(),mxUtils.remove(i,n.connectsAsTarget),t.connectsAsTarget.push(i),n.connectsAsSource.push(i),mxUtils.remove(i,t.connectsAsSource));r=mxCellPath.create(t.cell);u[r]=t;delete f[r]},r,!0,null)};mxHierarchicalEdgeStyle={ORTHOGONAL:1,POLYLINE:2,STRAIGHT:3,CURVE:4};mxHierarchicalLayout.prototype=new mxGraphLayout;mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout;mxHierarchicalLayout.prototype.roots=null;mxHierarchicalLayout.prototype.resizeParent=!1;mxHierarchicalLayout.prototype.maintainParentLocation=!1;mxHierarchicalLayout.prototype.moveParent=!1;mxHierarchicalLayout.prototype.parentBorder=0;mxHierarchicalLayout.prototype.intraCellSpacing=30;mxHierarchicalLayout.prototype.interRankCellSpacing=100;mxHierarchicalLayout.prototype.interHierarchySpacing=60;mxHierarchicalLayout.prototype.parallelEdgeSpacing=10;mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxHierarchicalLayout.prototype.fineTuning=!0;mxHierarchicalLayout.prototype.tightenToSource=!0;mxHierarchicalLayout.prototype.disableEdgeStyle=!0;mxHierarchicalLayout.prototype.traverseAncestors=!0;mxHierarchicalLayout.prototype.model=null;mxHierarchicalLayout.prototype.edgesCache=null;mxHierarchicalLayout.prototype.edgeSourceTermCache=null;mxHierarchicalLayout.prototype.edgesTargetTermCache=null;mxHierarchicalLayout.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE;mxHierarchicalLayout.prototype.getModel=function(){return this.model};mxHierarchicalLayout.prototype.execute=function(n,t){var r,f,u,e,i;if(this.parent=n,r=this.graph.model,this.edgesCache=new mxDictionary,this.edgeSourceTermCache=new mxDictionary,this.edgesTargetTermCache=new mxDictionary,t==null||t instanceof Array||(t=[t]),t!=null||n!=null){if(this.parentX=null,this.parentY=null,n!=this.root&&r.isVertex(n)!=null&&this.maintainParentLocation&&(i=this.graph.getCellGeometry(n),i!=null&&(this.parentX=i.x,this.parentY=i.y)),t!=null){for(f=[],u=0;u<t.length;u++)e=n!=null?r.isAncestor(n,t[u]):!0,e&&r.isVertex(t[u])&&f.push(t[u]);this.roots=f}r.beginUpdate();try{this.run(n);this.resizeParent&&!this.graph.isCellCollapsed(n)&&this.graph.updateGroupBounds([n],this.parentBorder,this.moveParent);this.parentX!=null&&this.parentY!=null&&(i=this.graph.getCellGeometry(n),i!=null&&(i=i.clone(),i.x=this.parentX,i.y=this.parentY,r.setGeometry(n,i)))}finally{r.endUpdate()}}};mxHierarchicalLayout.prototype.findRoots=function(n,t){var r=[],c,i,u,a,s;if(n!=null&&t!=null){var v=this.graph.model,f=null,h=-1e5;for(c in t)if(i=t[c],v.isVertex(i)&&this.graph.isCellVisible(i)){var l=this.getEdges(i),e=0,o=0;for(u=0;u<l.length;u++)a=this.getVisibleTerminal(l[u],!0),a==i?e++:o++;o==0&&e>0&&r.push(i);s=e-o;s>h&&(h=s,f=i)}r.length==0&&f!=null&&r.push(f)}return r};mxHierarchicalLayout.prototype.getEdges=function(n){var s=this.edgesCache.get(n),u,o,i,f,e;if(s!=null)return s;var r=this.graph.model,t=[],h=this.graph.isCellCollapsed(n),c=r.getChildCount(n);for(i=0;i<c;i++)u=r.getChildAt(n,i),this.isPort(u)?t=t.concat(r.getEdges(u,!0,!0)):(h||!this.graph.isCellVisible(u))&&(t=t.concat(r.getEdges(u,!0,!0)));for(t=t.concat(r.getEdges(n,!0,!0)),o=[],i=0;i<t.length;i++)f=this.getVisibleTerminal(t[i],!0),e=this.getVisibleTerminal(t[i],!1),(f==e||f!=e&&(e==n&&(this.parent==null||this.isAncestor(this.parent,f,this.traverseAncestors))||f==n&&(this.parent==null||this.isAncestor(this.parent,e,this.traverseAncestors))))&&o.push(t[i]);return this.edgesCache.put(n,o),o};mxHierarchicalLayout.prototype.getVisibleTerminal=function(n,t){var u=this.edgesTargetTermCache,f,r,i;return(t&&(u=this.edgeSourceTermCache),f=u.get(n),f!=null)?f:(r=this.graph.view.getState(n),i=r!=null?r.getVisibleTerminal(t):this.graph.view.getVisibleTerminal(n,t),i==null&&(i=r!=null?r.getVisibleTerminal(t):this.graph.view.getVisibleTerminal(n,t)),i!=null&&(this.isPort(i)&&(i=this.graph.model.getParent(i)),u.put(n,i)),i)};mxHierarchicalLayout.prototype.run=function(n){var u=[],c=[],r,e,o,s,t,i,h,f;if(this.roots==null&&n!=null){r=Object();this.filterDescendants(n,r);this.roots=[];e=!0;for(f in r)if(r[f]!=null){e=!1;break}while(!e){for(o=this.findRoots(n,r),t=0;t<o.length;t++)i=Object(),u.push(i),this.traverse(o[t],!0,null,c,i,u,r);for(t=0;t<o.length;t++)this.roots.push(o[t]);e=!0;for(f in r)if(r[f]!=null){e=!1;break}}}else for(t=0;t<this.roots.length;t++)i=Object(),u.push(i),this.traverse(this.roots[t],!0,null,c,i,u,null);for(s=0,t=0;t<u.length;t++){i=u[t];h=[];for(f in i)h.push(i[f]);this.model=new mxGraphHierarchyModel(this,h,this.roots,n,this.tightenToSource);this.cycleStage(n);this.layeringStage();this.crossingStage(n);s=this.placementStage(s,n)}};mxHierarchicalLayout.prototype.filterDescendants=function(n,t){var r=this.graph.model,f,i,u;if(r.isVertex(n)&&n!=this.parent&&this.graph.isCellVisible(n)&&(t[mxObjectIdentity.get(n)]=n),this.traverseAncestors||n==this.parent&&this.graph.isCellVisible(n))for(f=r.getChildCount(n),i=0;i<f;i++)u=r.getChildAt(n,i),this.isPort(u)||this.filterDescendants(u,t)};mxHierarchicalLayout.prototype.isPort=function(n){return n.geometry.relative?!0:!1};mxHierarchicalLayout.prototype.getEdgesBetween=function(n,t,i){var u,f,r,e,o;for(i=i!=null?i:!1,u=this.getEdges(n),f=[],r=0;r<u.length;r++)e=this.getVisibleTerminal(u[r],!0),o=this.getVisibleTerminal(u[r],!1),(e!=n||o!=t)&&(i||e!=t||o!=n)||f.push(u[r]);return f};mxHierarchicalLayout.prototype.traverse=function(n,t,i,r,u,f,e){var s,h,l,y,a,c,p,b,o,v,w;if(n!=null&&r!=null)if(s=mxObjectIdentity.get(n),r[s]==null&&(e==null?!0:e[s]!=null)){for(u[s]==null&&(u[s]=n),r[s]==null&&(r[s]=n),e!==null&&delete e[s],h=this.getEdges(n),l=[],o=0;o<h.length;o++)l[o]=this.getVisibleTerminal(h[o],!0)==n;for(o=0;o<h.length;o++)if(!t||l[o]){for(y=this.getVisibleTerminal(h[o],!l[o]),a=1,c=0;c<h.length;c++)if(c==o)continue;else p=l[c],b=this.getVisibleTerminal(h[c],!p),b==y&&(p?a++:a--);a>=0&&(u=this.traverse(y,t,h[o],r,u,f,e))}}else if(u[s]==null)for(o=0;o<f.length;o++)if(v=f[o],v[s]!=null){for(w in v)u[w]=v[w];return f.splice(o,1),u}return u};mxHierarchicalLayout.prototype.cycleStage=function(n){var t=new mxMinimumCycleRemover(this);t.execute(n)};mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};mxHierarchicalLayout.prototype.crossingStage=function(n){var t=new mxMedianHybridCrossingReduction(this);t.execute(n)};mxHierarchicalLayout.prototype.placementStage=function(n,t){var i=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,n,this.parallelEdgeSpacing);return i.fineTuning=this.fineTuning,i.execute(t),i.limitX+this.interHierarchySpacing};mxSwimlaneLayout.prototype=new mxGraphLayout;mxSwimlaneLayout.prototype.constructor=mxSwimlaneLayout;mxSwimlaneLayout.prototype.roots=null;mxSwimlaneLayout.prototype.swimlanes=null;mxSwimlaneLayout.prototype.dummyVertices=null;mxSwimlaneLayout.prototype.dummyVertexWidth=50;mxSwimlaneLayout.prototype.resizeParent=!1;mxSwimlaneLayout.prototype.maintainParentLocation=!1;mxSwimlaneLayout.prototype.moveParent=!1;mxSwimlaneLayout.prototype.parentBorder=30;mxSwimlaneLayout.prototype.intraCellSpacing=30;mxSwimlaneLayout.prototype.interRankCellSpacing=100;mxSwimlaneLayout.prototype.interHierarchySpacing=60;mxSwimlaneLayout.prototype.parallelEdgeSpacing=10;mxSwimlaneLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxSwimlaneLayout.prototype.fineTuning=!0;mxSwimlaneLayout.prototype.tightenToSource=!0;mxSwimlaneLayout.prototype.disableEdgeStyle=!0;mxSwimlaneLayout.prototype.traverseAncestors=!0;mxSwimlaneLayout.prototype.model=null;mxSwimlaneLayout.prototype.edgesCache=null;mxHierarchicalLayout.prototype.edgeSourceTermCache=null;mxHierarchicalLayout.prototype.edgesTargetTermCache=null;mxHierarchicalLayout.prototype.edgeStyle=mxHierarchicalEdgeStyle.POLYLINE;mxSwimlaneLayout.prototype.getModel=function(){return this.model};mxSwimlaneLayout.prototype.execute=function(n,t){var r,u,f,e,i;if(this.parent=n,r=this.graph.model,this.edgesCache=new mxDictionary,this.edgeSourceTermCache=new mxDictionary,this.edgesTargetTermCache=new mxDictionary,t!=null&&!(t.length<1)){for(n==null&&(n=r.getParent(t[0])),this.parentX=null,this.parentY=null,n!=this.root&&r.isVertex(n)!=null&&this.maintainParentLocation&&(i=this.graph.getCellGeometry(n),i!=null&&(this.parentX=i.x,this.parentY=i.y)),this.swimlanes=t,this.dummyVertices=[],u=0;u<t.length;u++)f=this.graph.getChildCells(t[u]),(f==null||f.length==0)&&(e=this.graph.insertVertex(t[u],null,null,0,0,this.dummyVertexWidth,0),this.dummyVertices.push(e));r.beginUpdate();try{this.run(n);this.resizeParent&&!this.graph.isCellCollapsed(n)&&this.graph.updateGroupBounds([n],this.parentBorder,this.moveParent);this.parentX!=null&&this.parentY!=null&&(i=this.graph.getCellGeometry(n),i!=null&&(i=i.clone(),i.x=this.parentX,i.y=this.parentY,r.setGeometry(n,i)));this.graph.removeCells(this.dummyVertices)}finally{r.endUpdate()}}};mxSwimlaneLayout.prototype.updateGroupBounds=function(){var a=[],v=this.model,y,h,t,f,s,c,w,n,i,r;for(y in v.edgeMapper)for(h=v.edgeMapper[y],n=0;n<h.edges.length;n++)a.push(h.edges[n]);for(t=this.graph.getBoundingBoxFromGeometry(a,!0),f=[],n=0;n<this.swimlanes.length;n++)if(i=this.swimlanes[n],r=this.graph.getCellGeometry(i),r!=null){var p=this.graph.getChildCells(i),e=this.graph.isSwimlane(i)?this.graph.getStartSize(i):new mxRectangle,o=this.graph.getBoundingBoxFromGeometry(p);f[n]=o;s=o.y+r.y-e.height-this.parentBorder;c=o.y+r.y+o.height;t==null?t=new mxRectangle(0,s,0,c-s):(t.y=Math.min(t.y,s),w=Math.max(t.y+t.height,c),t.height=w-t.y)}for(n=0;n<this.swimlanes.length;n++)if(i=this.swimlanes[n],r=this.graph.getCellGeometry(i),r!=null){var p=this.graph.getChildCells(i),e=this.graph.isSwimlane(i)?this.graph.getStartSize(i):new mxRectangle,u=r.clone(),l=n==0?this.parentBorder:this.interRankCellSpacing/2;u.x+=f[n].x-e.width-l;u.y=u.y+t.y-r.y-this.parentBorder;u.width=f[n].width+e.width+this.interRankCellSpacing/2+l;u.height=t.height+e.height+2*this.parentBorder;this.graph.model.setGeometry(i,u);this.graph.moveCells(p,-f[n].x+e.width+l,r.y-t.y+this.parentBorder)}};mxSwimlaneLayout.prototype.findRoots=function(n,t){var u=[],v,i,r,c,y,l;if(n!=null&&t!=null){var f=this.graph.model,e=null,a=-1e5;for(v in t)if(i=t[v],i!=null&&f.isVertex(i)&&this.graph.isCellVisible(i)&&f.isAncestor(n,i)){var o=this.getEdges(i),s=0,h=0;for(r=0;r<o.length;r++)c=this.getVisibleTerminal(o[r],!0),c==i?(y=this.getVisibleTerminal(o[r],!1),f.isAncestor(n,y)&&s++):f.isAncestor(n,c)&&h++;h==0&&s>0&&u.push(i);l=s-h;l>a&&(a=l,e=i)}u.length==0&&e!=null&&u.push(e)}return u};mxSwimlaneLayout.prototype.getEdges=function(n){var s=this.edgesCache.get(n),u,o,i,f,e;if(s!=null)return s;var r=this.graph.model,t=[],h=this.graph.isCellCollapsed(n),c=r.getChildCount(n);for(i=0;i<c;i++)u=r.getChildAt(n,i),this.isPort(u)?t=t.concat(r.getEdges(u,!0,!0)):(h||!this.graph.isCellVisible(u))&&(t=t.concat(r.getEdges(u,!0,!0)));for(t=t.concat(r.getEdges(n,!0,!0)),o=[],i=0;i<t.length;i++)f=this.getVisibleTerminal(t[i],!0),e=this.getVisibleTerminal(t[i],!1),(f==e||f!=e&&(e==n&&(this.parent==null||this.graph.isValidAncestor(f,this.parent,this.traverseAncestors))||f==n&&(this.parent==null||this.graph.isValidAncestor(e,this.parent,this.traverseAncestors))))&&o.push(t[i]);return this.edgesCache.put(n,o),o};mxSwimlaneLayout.prototype.getVisibleTerminal=function(n,t){var u=this.edgesTargetTermCache,f,r,i;return(t&&(u=this.edgeSourceTermCache),f=u.get(n),f!=null)?f:(r=this.graph.view.getState(n),i=r!=null?r.getVisibleTerminal(t):this.graph.view.getVisibleTerminal(n,t),i==null&&(i=r!=null?r.getVisibleTerminal(t):this.graph.view.getVisibleTerminal(n,t)),i!=null&&(this.isPort(i)&&(i=this.graph.model.getParent(i)),u.put(n,i)),i)};mxSwimlaneLayout.prototype.run=function(n){var s=[],h=[],i,e,o,u,t,f,c,r;if(this.swimlanes!=null&&this.swimlanes.length>0&&n!=null){for(i=Object(),t=0;t<this.swimlanes.length;t++)this.filterDescendants(this.swimlanes[t],i);this.roots=[];e=!0;for(r in i)if(i[r]!=null){e=!1;break}for(o=0;!e&&o<this.swimlanes.length;){if(u=this.findRoots(this.swimlanes[o],i),u.length==0){o++;continue}for(t=0;t<u.length;t++)f=Object(),s.push(f),this.traverse(u[t],!0,null,h,f,s,i,o);for(t=0;t<u.length;t++)this.roots.push(u[t]);e=!0;for(r in i)if(i[r]!=null){e=!1;break}}}else for(t=0;t<this.roots.length;t++)f=Object(),s.push(f),this.traverse(this.roots[t],!0,null,h,f,s,null);c=[];for(r in h)c.push(h[r]);this.model=new mxSwimlaneModel(this,c,this.roots,n,this.tightenToSource);this.cycleStage(n);this.layeringStage();this.crossingStage(n);initialX=this.placementStage(0,n)};mxSwimlaneLayout.prototype.filterDescendants=function(n,t){var i=this.graph.model,f,r,u;if(i.isVertex(n)&&n!=this.parent&&i.getParent(n)!=this.parent&&this.graph.isCellVisible(n)&&(t[mxObjectIdentity.get(n)]=n),this.traverseAncestors||n==this.parent&&this.graph.isCellVisible(n))for(f=i.getChildCount(n),r=0;r<f;r++)u=i.getChildAt(n,r),this.isPort(u)||this.filterDescendants(u,t)};mxSwimlaneLayout.prototype.isPort=function(n){return n.geometry.relative?!0:!1};mxSwimlaneLayout.prototype.getEdgesBetween=function(n,t,i){var u,f,r,e,o;for(i=i!=null?i:!1,u=this.getEdges(n),f=[],r=0;r<u.length;r++)e=this.getVisibleTerminal(u[r],!0),o=this.getVisibleTerminal(u[r],!1),(e!=n||o!=t)&&(i||e!=t||o!=n)||f.push(u[r]);return f};mxSwimlaneLayout.prototype.traverse=function(n,t,i,r,u,f,e,o){var h,l,w,a,y,c,s,v,p;if(n!=null&&r!=null)if(h=mxObjectIdentity.get(n),r[h]==null&&(e==null?!0:e[h]!=null))for(u[h]==null&&(u[h]=n),r[h]==null&&(r[h]=n),e!==null&&delete e[h],l=this.getEdges(n),w=this.graph.model,s=0;s<l.length;s++){for(a=this.getVisibleTerminal(l[s],!0),y=a==n,y&&(a=this.getVisibleTerminal(l[s],!1)),c=0,c=0;c<this.swimlanes.length;c++)if(w.isAncestor(this.swimlanes[c],a))break;c>=this.swimlanes.length||(c>o||(!t||y)&&c==o)&&(u=this.traverse(a,t,l[s],r,u,f,e,c))}else if(u[h]==null)for(s=0;s<f.length;s++)if(v=f[s],v[h]!=null){for(p in v)u[p]=v[p];return f.splice(s,1),u}return u};mxSwimlaneLayout.prototype.cycleStage=function(n){var t=new mxSwimlaneOrdering(this);t.execute(n)};mxSwimlaneLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks()};mxSwimlaneLayout.prototype.crossingStage=function(n){var t=new mxMedianHybridCrossingReduction(this);t.execute(n)};mxSwimlaneLayout.prototype.placementStage=function(n,t){var i=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,n,this.parallelEdgeSpacing);return i.fineTuning=this.fineTuning,i.execute(t),i.limitX+this.interHierarchySpacing};mxGraphModel.prototype=new mxEventSource;mxGraphModel.prototype.constructor=mxGraphModel;mxGraphModel.prototype.root=null;mxGraphModel.prototype.cells=null;mxGraphModel.prototype.maintainEdgeParent=!0;mxGraphModel.prototype.ignoreRelativeEdgeParent=!0;mxGraphModel.prototype.createIds=!0;mxGraphModel.prototype.prefix="";mxGraphModel.prototype.postfix="";mxGraphModel.prototype.nextId=0;mxGraphModel.prototype.currentEdit=null;mxGraphModel.prototype.updateLevel=0;mxGraphModel.prototype.endingUpdate=!1;mxGraphModel.prototype.clear=function(){this.setRoot(this.createRoot())};mxGraphModel.prototype.isCreateIds=function(){return this.createIds};mxGraphModel.prototype.setCreateIds=function(n){this.createIds=n};mxGraphModel.prototype.createRoot=function(){var n=new mxCell;return n.insert(new mxCell),n};mxGraphModel.prototype.getCell=function(n){return this.cells!=null?this.cells[n]:null};mxGraphModel.prototype.filterCells=function(n,t){var r=null,i;if(n!=null)for(r=[],i=0;i<n.length;i++)t(n[i])&&r.push(n[i]);return r};mxGraphModel.prototype.getDescendants=function(n){return this.filterDescendants(null,n)};mxGraphModel.prototype.filterDescendants=function(n,t){var i=[],u,r,f;for(t=t||this.getRoot(),(n==null||n(t))&&i.push(t),u=this.getChildCount(t),r=0;r<u;r++)f=this.getChildAt(t,r),i=i.concat(this.filterDescendants(n,f));return i};mxGraphModel.prototype.getRoot=function(n){var t=n||this.root;if(n!=null)while(n!=null)t=n,n=this.getParent(n);return t};mxGraphModel.prototype.setRoot=function(n){return this.execute(new mxRootChange(this,n)),n};mxGraphModel.prototype.rootChanged=function(n){var t=this.root;return this.root=n,this.nextId=0,this.cells=null,this.cellAdded(n),t};mxGraphModel.prototype.isRoot=function(n){return n!=null&&this.root==n};mxGraphModel.prototype.isLayer=function(n){return this.isRoot(this.getParent(n))};mxGraphModel.prototype.isAncestor=function(n,t){while(t!=null&&t!=n)t=this.getParent(t);return t==n};mxGraphModel.prototype.contains=function(n){return this.isAncestor(this.root,n)};mxGraphModel.prototype.getParent=function(n){return n!=null?n.getParent():null};mxGraphModel.prototype.add=function(n,t,i){if(t!=n&&n!=null&&t!=null){i==null&&(i=this.getChildCount(n));var r=n!=this.getParent(t);this.execute(new mxChildChange(this,n,t,i));this.maintainEdgeParent&&r&&this.updateEdgeParents(t)}return t};mxGraphModel.prototype.cellAdded=function(n){var t,r,i;if(n!=null){if(n.getId()==null&&this.createIds&&n.setId(this.createId(n)),n.getId()!=null&&(t=this.getCell(n.getId()),t!=n)){while(t!=null)n.setId(this.createId(n)),t=this.getCell(n.getId());this.cells==null&&(this.cells={});this.cells[n.getId()]=n}for(mxUtils.isNumeric(n.getId())&&(this.nextId=Math.max(this.nextId,n.getId())),r=this.getChildCount(n),i=0;i<r;i++)this.cellAdded(this.getChildAt(n,i))}};mxGraphModel.prototype.createId=function(){var n=this.nextId;return this.nextId++,this.prefix+n+this.postfix};mxGraphModel.prototype.updateEdgeParents=function(n,t){var f,e,o,r,i,u;for(t=t||this.getRoot(n),f=this.getChildCount(n),i=0;i<f;i++)e=this.getChildAt(n,i),this.updateEdgeParents(e,t);for(o=this.getEdgeCount(n),r=[],i=0;i<o;i++)r.push(this.getEdgeAt(n,i));for(i=0;i<r.length;i++)u=r[i],this.isAncestor(t,u)&&this.updateEdgeParent(u,t)};mxGraphModel.prototype.updateEdgeParent=function(n,t){for(var i=this.getTerminal(n,!0),r=this.getTerminal(n,!1),u=null,f;i!=null&&!this.isEdge(i)&&i.geometry!=null&&i.geometry.relative;)i=this.getParent(i);while(r!=null&&this.ignoreRelativeEdgeParent&&!this.isEdge(r)&&r.geometry!=null&&r.geometry.relative)r=this.getParent(r);if(this.isAncestor(t,i)&&this.isAncestor(t,r)&&(u=i==r?this.getParent(i):this.getNearestCommonAncestor(i,r),u!=null&&(this.getParent(u)!=this.root||this.isAncestor(u,n))&&this.getParent(n)!=u)){if(f=this.getGeometry(n),f!=null){var e=this.getOrigin(this.getParent(n)),o=this.getOrigin(u),s=o.x-e.x,h=o.y-e.y;f=f.clone();f.translate(-s,-h);this.setGeometry(n,f)}this.add(u,n,this.getChildCount(u))}};mxGraphModel.prototype.getOrigin=function(n){var t=null,i;return n!=null?(t=this.getOrigin(this.getParent(n)),this.isEdge(n)||(i=this.getGeometry(n),i!=null&&(t.x+=i.x,t.y+=i.y))):t=new mxPoint,t};mxGraphModel.prototype.getNearestCommonAncestor=function(n,t){var i,r,u,e,f;if(n!=null&&t!=null&&(i=mxCellPath.create(t),i!=null&&i.length>0))for(r=n,u=mxCellPath.create(r),i.length<u.length&&(r=t,e=u,u=i,i=e);r!=null;){if(f=this.getParent(r),i.indexOf(u+mxCellPath.PATH_SEPARATOR)==0&&f!=null)return r;u=mxCellPath.getParentPath(u);r=f}return null};mxGraphModel.prototype.remove=function(n){return n==this.root?this.setRoot(null):this.getParent(n)!=null&&this.execute(new mxChildChange(this,null,n)),n};mxGraphModel.prototype.cellRemoved=function(n){var i,t;if(n!=null&&this.cells!=null){for(i=this.getChildCount(n),t=i-1;t>=0;t--)this.cellRemoved(this.getChildAt(n,t));this.cells!=null&&n.getId()!=null&&delete this.cells[n.getId()]}};mxGraphModel.prototype.parentForCellChanged=function(n,t,i){var r=this.getParent(n),u;return t!=null?(t!=r||r.getIndex(n)!=i)&&t.insert(n,i):r!=null&&(u=r.getIndex(n),r.remove(u)),this.contains(r)||t==null?t==null&&this.cellRemoved(n):this.cellAdded(n),r};mxGraphModel.prototype.getChildCount=function(n){return n!=null?n.getChildCount():0};mxGraphModel.prototype.getChildAt=function(n,t){return n!=null?n.getChildAt(t):null};mxGraphModel.prototype.getChildren=function(n){return n!=null?n.children:null};mxGraphModel.prototype.getChildVertices=function(n){return this.getChildCells(n,!0,!1)};mxGraphModel.prototype.getChildEdges=function(n){return this.getChildCells(n,!1,!0)};mxGraphModel.prototype.getChildCells=function(n,t,i){var e,f,r,u;for(t=t!=null?t:!1,i=i!=null?i:!1,e=this.getChildCount(n),f=[],r=0;r<e;r++)u=this.getChildAt(n,r),(!i&&!t||i&&this.isEdge(u)||t&&this.isVertex(u))&&f.push(u);return f};mxGraphModel.prototype.getTerminal=function(n,t){return n!=null?n.getTerminal(t):null};mxGraphModel.prototype.setTerminal=function(n,t,i){var r=t!=this.getTerminal(n,i);return this.execute(new mxTerminalChange(this,n,t,i)),this.maintainEdgeParent&&r&&this.updateEdgeParent(n,this.getRoot()),t};mxGraphModel.prototype.setTerminals=function(n,t,i){this.beginUpdate();try{this.setTerminal(n,t,!0);this.setTerminal(n,i,!1)}finally{this.endUpdate()}};mxGraphModel.prototype.terminalForCellChanged=function(n,t,i){var r=this.getTerminal(n,i);return t!=null?t.insertEdge(n,i):r!=null&&r.removeEdge(n,i),r};mxGraphModel.prototype.getEdgeCount=function(n){return n!=null?n.getEdgeCount():0};mxGraphModel.prototype.getEdgeAt=function(n,t){return n!=null?n.getEdgeAt(t):null};mxGraphModel.prototype.getDirectedEdgeCount=function(n,t,i){for(var u,f=0,e=this.getEdgeCount(n),r=0;r<e;r++)u=this.getEdgeAt(n,r),u!=i&&this.getTerminal(u,t)==n&&f++;return f};mxGraphModel.prototype.getConnections=function(n){return this.getEdges(n,!0,!0,!1)};mxGraphModel.prototype.getIncomingEdges=function(n){return this.getEdges(n,!0,!1,!1)};mxGraphModel.prototype.getOutgoingEdges=function(n){return this.getEdges(n,!1,!0,!1)};mxGraphModel.prototype.getEdges=function(n,t,i,r){var h,f,u;for(t=t!=null?t:!0,i=i!=null?i:!0,r=r!=null?r:!0,h=this.getEdgeCount(n),f=[],u=0;u<h;u++){var e=this.getEdgeAt(n,u),o=this.getTerminal(e,!0),s=this.getTerminal(e,!1);(r&&o==s||o!=s&&(t&&s==n||i&&o==n))&&f.push(e)}return f};mxGraphModel.prototype.getEdgesBetween=function(n,t,i){var u,r;i=i!=null?i:!1;var e=this.getEdgeCount(n),o=this.getEdgeCount(t),s=n,h=e;for(o<e&&(h=o,s=t),u=[],r=0;r<h;r++){var f=this.getEdgeAt(s,r),c=this.getTerminal(f,!0),l=this.getTerminal(f,!1),a=c==n&&l==t,v=l==n&&c==t;(a||!i&&v)&&u.push(f)}return u};mxGraphModel.prototype.getOpposites=function(n,t,i,r){var o,u,f,e;if(i=i!=null?i:!0,r=r!=null?r:!0,o=[],n!=null)for(u=0;u<n.length;u++)f=this.getTerminal(n[u],!0),e=this.getTerminal(n[u],!1),f==t&&e!=null&&e!=t&&r?o.push(e):e==t&&f!=null&&f!=t&&i&&o.push(f);return o};mxGraphModel.prototype.getTopmostCells=function(n){for(var r=new mxDictionary,u=[],t=0;t<n.length;t++)r.put(n[t],!0);for(t=0;t<n.length;t++){for(var f=n[t],e=!0,i=this.getParent(f);i!=null;){if(r.get(i)){e=!1;break}i=this.getParent(i)}e&&u.push(f)}return u};mxGraphModel.prototype.isVertex=function(n){return n!=null?n.isVertex():!1};mxGraphModel.prototype.isEdge=function(n){return n!=null?n.isEdge():!1};mxGraphModel.prototype.isConnectable=function(n){return n!=null?n.isConnectable():!1};mxGraphModel.prototype.getValue=function(n){return n!=null?n.getValue():null};mxGraphModel.prototype.setValue=function(n,t){return this.execute(new mxValueChange(this,n,t)),t};mxGraphModel.prototype.valueForCellChanged=function(n,t){return n.valueChanged(t)};mxGraphModel.prototype.getGeometry=function(n){return n!=null?n.getGeometry():null};mxGraphModel.prototype.setGeometry=function(n,t){return t!=this.getGeometry(n)&&this.execute(new mxGeometryChange(this,n,t)),t};mxGraphModel.prototype.geometryForCellChanged=function(n,t){var i=this.getGeometry(n);return n.setGeometry(t),i};mxGraphModel.prototype.getStyle=function(n){return n!=null?n.getStyle():null};mxGraphModel.prototype.setStyle=function(n,t){return t!=this.getStyle(n)&&this.execute(new mxStyleChange(this,n,t)),t};mxGraphModel.prototype.styleForCellChanged=function(n,t){var i=this.getStyle(n);return n.setStyle(t),i};mxGraphModel.prototype.isCollapsed=function(n){return n!=null?n.isCollapsed():!1};mxGraphModel.prototype.setCollapsed=function(n,t){return t!=this.isCollapsed(n)&&this.execute(new mxCollapseChange(this,n,t)),t};mxGraphModel.prototype.collapsedStateForCellChanged=function(n,t){var i=this.isCollapsed(n);return n.setCollapsed(t),i};mxGraphModel.prototype.isVisible=function(n){return n!=null?n.isVisible():!1};mxGraphModel.prototype.setVisible=function(n,t){return t!=this.isVisible(n)&&this.execute(new mxVisibleChange(this,n,t)),t};mxGraphModel.prototype.visibleStateForCellChanged=function(n,t){var i=this.isVisible(n);return n.setVisible(t),i};mxGraphModel.prototype.execute=function(n){n.execute();this.beginUpdate();this.currentEdit.add(n);this.fireEvent(new mxEventObject(mxEvent.EXECUTE,"change",n));this.fireEvent(new mxEventObject(mxEvent.EXECUTED,"change",n));this.endUpdate()};mxGraphModel.prototype.beginUpdate=function(){this.updateLevel++;this.fireEvent(new mxEventObject(mxEvent.BEGIN_UPDATE));this.updateLevel==1&&this.fireEvent(new mxEventObject(mxEvent.START_EDIT))};mxGraphModel.prototype.endUpdate=function(){if(this.updateLevel--,this.updateLevel==0&&this.fireEvent(new mxEventObject(mxEvent.END_EDIT)),!this.endingUpdate){this.endingUpdate=this.updateLevel==0;this.fireEvent(new mxEventObject(mxEvent.END_UPDATE,"edit",this.currentEdit));try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){this.fireEvent(new mxEventObject(mxEvent.BEFORE_UNDO,"edit",this.currentEdit));var n=this.currentEdit;this.currentEdit=this.createUndoableEdit();n.notify();this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",n))}}finally{this.endingUpdate=!1}}};mxGraphModel.prototype.createUndoableEdit=function(n){var t=new mxUndoableEdit(this,n!=null?n:!0);return t.notify=function(){t.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"edit",t,"changes",t.changes));t.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"edit",t,"changes",t.changes))},t};mxGraphModel.prototype.mergeChildren=function(n,t,i){var u,e,f,r;i=i!=null?i:!0;this.beginUpdate();try{u={};this.mergeChildrenImpl(n,t,i,u);for(e in u)f=u[e],r=this.getTerminal(f,!0),r!=null&&(r=u[mxCellPath.create(r)],this.setTerminal(f,r,!0)),r=this.getTerminal(f,!1),r!=null&&(r=u[mxCellPath.create(r)],this.setTerminal(f,r,!1))}finally{this.endUpdate()}};mxGraphModel.prototype.mergeChildrenImpl=function(n,t,i,r){var h,o,u,s,f,e;this.beginUpdate();try{for(h=n.getChildCount(),o=0;o<h;o++)u=n.getChildAt(o),typeof u.getId=="function"&&(s=u.getId(),f=s!=null&&(!this.isEdge(u)||!i)?this.getCell(s):null,f==null&&(e=u.clone(),e.setId(s),e.setTerminal(u.getTerminal(!0),!0),e.setTerminal(u.getTerminal(!1),!1),f=t.insert(e),this.cellAdded(f)),r[mxCellPath.create(u)]=f,this.mergeChildrenImpl(u,f,i,r))}finally{this.endUpdate()}};mxGraphModel.prototype.getParents=function(n){var u=[],r,i,t;if(n!=null)for(r=new mxDictionary,i=0;i<n.length;i++)t=this.getParent(n[i]),t==null||r.get(t)||(r.put(t,!0),u.push(t));return u};mxGraphModel.prototype.cloneCell=function(n){return n!=null?this.cloneCells([n],!0)[0]:null};mxGraphModel.prototype.cloneCells=function(n,t,i){var u,r;for(i=i!=null?i:{},u=[],r=0;r<n.length;r++)n[r]!=null?u.push(this.cloneCellImpl(n[r],i,t)):u.push(null);for(r=0;r<u.length;r++)u[r]!=null&&this.restoreClone(u[r],n[r],i);return u};mxGraphModel.prototype.cloneCellImpl=function(n,t,i){var u=this.cellCloned(n),f,r,e;if(t[mxObjectIdentity.get(n)]=u,i)for(f=this.getChildCount(n),r=0;r<f;r++)e=this.cloneCellImpl(this.getChildAt(n,r),t,!0),u.insert(e);return u};mxGraphModel.prototype.cellCloned=function(n){return n.clone()};mxGraphModel.prototype.restoreClone=function(n,t,i){var e=this.getTerminal(t,!0),f,r,o,u;for(e!=null&&(r=i[mxObjectIdentity.get(e)],r!=null&&r.insertEdge(n,!0)),f=this.getTerminal(t,!1),f!=null&&(r=i[mxObjectIdentity.get(f)],r!=null&&r.insertEdge(n,!1)),o=this.getChildCount(n),u=0;u<o;u++)this.restoreClone(this.getChildAt(n,u),this.getChildAt(t,u),i)};mxRootChange.prototype.execute=function(){this.root=this.previous;this.previous=this.model.rootChanged(this.previous)};mxChildChange.prototype.execute=function(){if(this.child!=null){var n=this.model.getParent(this.child),t=n!=null?n.getIndex(this.child):0;this.previous==null&&this.connect(this.child,!1);n=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex);this.previous!=null&&this.connect(this.child,!0);this.parent=this.previous;this.previous=n;this.index=this.previousIndex;this.previousIndex=t}};mxChildChange.prototype.connect=function(n,t){var i,r,f,u;for(t=t!=null?t:!0,i=n.getTerminal(!0),r=n.getTerminal(!1),i!=null&&(t?this.model.terminalForCellChanged(n,i,!0):this.model.terminalForCellChanged(n,null,!0)),r!=null&&(t?this.model.terminalForCellChanged(n,r,!1):this.model.terminalForCellChanged(n,null,!1)),n.setTerminal(i,!0),n.setTerminal(r,!1),f=this.model.getChildCount(n),u=0;u<f;u++)this.connect(this.model.getChildAt(n,u),t)};mxTerminalChange.prototype.execute=function(){this.cell!=null&&(this.terminal=this.previous,this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.source))};mxValueChange.prototype.execute=function(){this.cell!=null&&(this.value=this.previous,this.previous=this.model.valueForCellChanged(this.cell,this.previous))};mxStyleChange.prototype.execute=function(){this.cell!=null&&(this.style=this.previous,this.previous=this.model.styleForCellChanged(this.cell,this.previous))};mxGeometryChange.prototype.execute=function(){this.cell!=null&&(this.geometry=this.previous,this.previous=this.model.geometryForCellChanged(this.cell,this.previous))};mxCollapseChange.prototype.execute=function(){this.cell!=null&&(this.collapsed=this.previous,this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous))};mxVisibleChange.prototype.execute=function(){this.cell!=null&&(this.visible=this.previous,this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous))};mxCellAttributeChange.prototype.execute=function(){if(this.cell!=null){var n=this.cell.getAttribute(this.attribute);this.previous==null?this.cell.value.removeAttribute(this.attribute):this.cell.setAttribute(this.attribute,this.previous);this.previous=n}};mxCell.prototype.id=null;mxCell.prototype.value=null;mxCell.prototype.geometry=null;mxCell.prototype.style=null;mxCell.prototype.vertex=!1;mxCell.prototype.edge=!1;mxCell.prototype.connectable=!0;mxCell.prototype.visible=!0;mxCell.prototype.collapsed=!1;mxCell.prototype.parent=null;mxCell.prototype.source=null;mxCell.prototype.target=null;mxCell.prototype.children=null;mxCell.prototype.edges=null;mxCell.prototype.mxTransient=["id","value","parent","source","target","children","edges"];mxCell.prototype.getId=function(){return this.id};mxCell.prototype.setId=function(n){this.id=n};mxCell.prototype.getValue=function(){return this.value};mxCell.prototype.setValue=function(n){this.value=n};mxCell.prototype.valueChanged=function(n){var t=this.getValue();return this.setValue(n),t};mxCell.prototype.getGeometry=function(){return this.geometry};mxCell.prototype.setGeometry=function(n){this.geometry=n};mxCell.prototype.getStyle=function(){return this.style};mxCell.prototype.setStyle=function(n){this.style=n};mxCell.prototype.isVertex=function(){return this.vertex!=0};mxCell.prototype.setVertex=function(n){this.vertex=n};mxCell.prototype.isEdge=function(){return this.edge!=0};mxCell.prototype.setEdge=function(n){this.edge=n};mxCell.prototype.isConnectable=function(){return this.connectable!=0};mxCell.prototype.setConnectable=function(n){this.connectable=n};mxCell.prototype.isVisible=function(){return this.visible!=0};mxCell.prototype.setVisible=function(n){this.visible=n};mxCell.prototype.isCollapsed=function(){return this.collapsed!=0};mxCell.prototype.setCollapsed=function(n){this.collapsed=n};mxCell.prototype.getParent=function(){return this.parent};mxCell.prototype.setParent=function(n){this.parent=n};mxCell.prototype.getTerminal=function(n){return n?this.source:this.target};mxCell.prototype.setTerminal=function(n,t){return t?this.source=n:this.target=n,n};mxCell.prototype.getChildCount=function(){return this.children==null?0:this.children.length};mxCell.prototype.getIndex=function(n){return mxUtils.indexOf(this.children,n)};mxCell.prototype.getChildAt=function(n){return this.children==null?null:this.children[n]};mxCell.prototype.insert=function(n,t){return n!=null&&(t==null&&(t=this.getChildCount(),n.getParent()==this&&t--),n.removeFromParent(),n.setParent(this),this.children==null?(this.children=[],this.children.push(n)):this.children.splice(t,0,n)),n};mxCell.prototype.remove=function(n){var t=null;return this.children!=null&&n>=0&&(t=this.getChildAt(n),t!=null&&(this.children.splice(n,1),t.setParent(null))),t};mxCell.prototype.removeFromParent=function(){if(this.parent!=null){var n=this.parent.getIndex(this);this.parent.remove(n)}};mxCell.prototype.getEdgeCount=function(){return this.edges==null?0:this.edges.length};mxCell.prototype.getEdgeIndex=function(n){return mxUtils.indexOf(this.edges,n)};mxCell.prototype.getEdgeAt=function(n){return this.edges==null?null:this.edges[n]};mxCell.prototype.insertEdge=function(n,t){return n!=null&&(n.removeFromTerminal(t),n.setTerminal(this,t),(this.edges==null||n.getTerminal(!t)!=this||mxUtils.indexOf(this.edges,n)<0)&&(this.edges==null&&(this.edges=[]),this.edges.push(n))),n};mxCell.prototype.removeEdge=function(n,t){if(n!=null){if(n.getTerminal(!t)!=this&&this.edges!=null){var i=this.getEdgeIndex(n);i>=0&&this.edges.splice(i,1)}n.setTerminal(null,t)}return n};mxCell.prototype.removeFromTerminal=function(n){var t=this.getTerminal(n);t!=null&&t.removeEdge(this,n)};mxCell.prototype.hasAttribute=function(n){var t=this.getValue();return t!=null&&t.nodeType==mxConstants.NODETYPE_ELEMENT&&t.hasAttribute?t.hasAttribute(n):t.getAttribute(n)!=null};mxCell.prototype.getAttribute=function(n,t){var i=this.getValue(),r=i!=null&&i.nodeType==mxConstants.NODETYPE_ELEMENT?i.getAttribute(n):null;return r||t};mxCell.prototype.setAttribute=function(n,t){var i=this.getValue();i!=null&&i.nodeType==mxConstants.NODETYPE_ELEMENT&&i.setAttribute(n,t)};mxCell.prototype.clone=function(){var n=mxUtils.clone(this,this.mxTransient);return n.setValue(this.cloneValue()),n};mxCell.prototype.cloneValue=function(){var n=this.getValue();return n!=null&&(typeof n.clone=="function"?n=n.clone():isNaN(n.nodeType)||(n=n.cloneNode(!0))),n};mxGeometry.prototype=new mxRectangle;mxGeometry.prototype.constructor=mxGeometry;mxGeometry.prototype.TRANSLATE_CONTROL_POINTS=!0;mxGeometry.prototype.alternateBounds=null;mxGeometry.prototype.sourcePoint=null;mxGeometry.prototype.targetPoint=null;mxGeometry.prototype.points=null;mxGeometry.prototype.offset=null;mxGeometry.prototype.relative=!1;mxGeometry.prototype.swap=function(){if(this.alternateBounds!=null){var n=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x;this.y=this.alternateBounds.y;this.width=this.alternateBounds.width;this.height=this.alternateBounds.height;this.alternateBounds=n}};mxGeometry.prototype.getTerminalPoint=function(n){return n?this.sourcePoint:this.targetPoint};mxGeometry.prototype.setTerminalPoint=function(n,t){return t?this.sourcePoint=n:this.targetPoint=n,n};mxGeometry.prototype.rotate=function(n,t){var e=mxUtils.toRadians(n),u=Math.cos(e),f=Math.sin(e),o,r,i;if(this.relative||(o=new mxPoint(this.getCenterX(),this.getCenterY()),i=mxUtils.getRotatedPoint(o,u,f,t),this.x=Math.round(i.x-this.width/2),this.y=Math.round(i.y-this.height/2)),this.sourcePoint!=null&&(i=mxUtils.getRotatedPoint(this.sourcePoint,u,f,t),this.sourcePoint.x=Math.round(i.x),this.sourcePoint.y=Math.round(i.y)),this.targetPoint!=null&&(i=mxUtils.getRotatedPoint(this.targetPoint,u,f,t),this.targetPoint.x=Math.round(i.x),this.targetPoint.y=Math.round(i.y)),this.points!=null)for(r=0;r<this.points.length;r++)this.points[r]!=null&&(i=mxUtils.getRotatedPoint(this.points[r],u,f,t),this.points[r].x=Math.round(i.x),this.points[r].y=Math.round(i.y))};mxGeometry.prototype.translate=function(n,t){if(n=parseFloat(n),t=parseFloat(t),this.relative||(this.x=parseFloat(this.x)+n,this.y=parseFloat(this.y)+t),this.sourcePoint!=null&&(this.sourcePoint.x=parseFloat(this.sourcePoint.x)+n,this.sourcePoint.y=parseFloat(this.sourcePoint.y)+t),this.targetPoint!=null&&(this.targetPoint.x=parseFloat(this.targetPoint.x)+n,this.targetPoint.y=parseFloat(this.targetPoint.y)+t),this.TRANSLATE_CONTROL_POINTS&&this.points!=null)for(var i=0;i<this.points.length;i++)this.points[i]!=null&&(this.points[i].x=parseFloat(this.points[i].x)+n,this.points[i].y=parseFloat(this.points[i].y)+t)};mxGeometry.prototype.scale=function(n,t,i){if(n=parseFloat(n),t=parseFloat(t),this.sourcePoint!=null&&(this.sourcePoint.x=parseFloat(this.sourcePoint.x)*n,this.sourcePoint.y=parseFloat(this.sourcePoint.y)*t),this.targetPoint!=null&&(this.targetPoint.x=parseFloat(this.targetPoint.x)*n,this.targetPoint.y=parseFloat(this.targetPoint.y)*t),this.points!=null)for(var r=0;r<this.points.length;r++)this.points[r]!=null&&(this.points[r].x=parseFloat(this.points[r].x)*n,this.points[r].y=parseFloat(this.points[r].y)*t);this.relative||(this.x=parseFloat(this.x)*n,this.y=parseFloat(this.y)*t,i&&(t=n=Math.min(n,t)),this.width=parseFloat(this.width)*n,this.height=parseFloat(this.height)*t)};mxGeometry.prototype.equals=function(n){return mxRectangle.prototype.equals.apply(this,arguments)&&this.relative==n.relative&&(this.sourcePoint==null&&n.sourcePoint==null||this.sourcePoint!=null&&this.sourcePoint.equals(n.sourcePoint))&&(this.targetPoint==null&&n.targetPoint==null||this.targetPoint!=null&&this.targetPoint.equals(n.targetPoint))&&(this.points==null&&n.points==null||this.points!=null&&mxUtils.equalPoints(this.points,n.points))&&(this.alternateBounds==null&&n.alternateBounds==null||this.alternateBounds!=null&&this.alternateBounds.equals(n.alternateBounds))&&(this.offset==null&&n.offset==null||this.offset!=null&&this.offset.equals(n.offset))};mxCellPath={PATH_SEPARATOR:".",create:function(n){var t="",i,u,r;if(n!=null)for(i=n.getParent();i!=null;)u=i.getIndex(n),t=u+mxCellPath.PATH_SEPARATOR+t,n=i,i=n.getParent();return r=t.length,r>1&&(t=t.substring(0,r-1)),t},getParentPath:function(n){if(n!=null){var t=n.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(t>=0)return n.substring(0,t);if(n.length>0)return""}return null},resolve:function(n,t){var r=n,u,i;if(t!=null)for(u=t.split(mxCellPath.PATH_SEPARATOR),i=0;i<u.length;i++)r=r.getChildAt(parseInt(u[i]));return r},compare:function(n,t){for(var r,u,e=Math.min(n.length,t.length),f=0,i=0;i<e;i++)if(n[i]!=t[i]){n[i].length==0||t[i].length==0?f=n[i]==t[i]?0:n[i]>t[i]?1:-1:(r=parseInt(n[i]),u=parseInt(t[i]),f=r==u?0:r>u?1:-1);break}return f==0&&(r=n.length,u=t.length,r!=u&&(f=r>u?1:-1)),f}};mxPerimeter={RectanglePerimeter:function(n,t,i,r){var o=n.getCenterX(),s=n.getCenterY(),l=i.x-o,a=i.y-s,f=Math.atan2(a,l),u=new mxPoint(0,0),h=Math.PI,v=Math.PI/2,c=v-f,e=Math.atan2(n.height,n.width);return f<-h+e||f>h-e?(u.x=n.x,u.y=s-n.width*Math.tan(f)/2):f<-e?(u.y=n.y,u.x=o-n.height*Math.tan(c)/2):f<e?(u.x=n.x+n.width,u.y=s+n.width*Math.tan(f)/2):(u.y=n.y+n.height,u.x=o+n.height*Math.tan(c)/2),r&&(i.x>=n.x&&i.x<=n.x+n.width?u.x=i.x:i.y>=n.y&&i.y<=n.y+n.height&&(u.y=i.y),i.x<n.x?u.x=n.x:i.x>n.x+n.width&&(u.x=n.x+n.width),i.y<n.y?u.y=n.y:i.y>n.y+n.height&&(u.y=n.y+n.height)),u},EllipsePerimeter:function(n,t,i,r){var y=n.x,p=n.y,f=n.width/2,u=n.height/2,e=y+f,a=p+u,o=i.x,s=i.y,k=parseInt(o-e),v=parseInt(s-a),c,h;if(k==0&&v!=0)return new mxPoint(e,a+u*v/Math.abs(v));if(k==0&&v==0)return new mxPoint(o,s);if(r){if(s>=p&&s<=p+n.height)return h=s-a,c=Math.sqrt(f*f*(1-h*h/(u*u)))||0,o<=y&&(c=-c),new mxPoint(e+c,s);if(o>=y&&o<=y+n.width)return c=o-e,h=Math.sqrt(u*u*(1-c*c/(f*f)))||0,s<=p&&(h=-h),new mxPoint(o,a+h)}var l=v/k,it=a-l*e,w=f*f*l*l+u*u,b=-2*e*w,et=f*f*l*l*e*e+u*u*e*e-f*f*u*u,rt=Math.sqrt(b*b-4*w*et),d=(-b+rt)/(2*w),g=(-b-rt)/(2*w),ut=l*d+it,ft=l*g+it,ot=Math.sqrt(Math.pow(d-o,2)+Math.pow(ut-s,2)),st=Math.sqrt(Math.pow(g-o,2)+Math.pow(ft-s,2)),nt=0,tt=0;return ot<st?(nt=d,tt=ut):(nt=g,tt=ft),new mxPoint(nt,tt)},RhombusPerimeter:function(n,t,i,r){var s=n.x,h=n.y,a=n.width,v=n.height,e=s+a/2,u=h+v/2,o=i.x,f=i.y,c,l;return e==o?u>f?new mxPoint(e,h):new mxPoint(e,h+v):u==f?e>o?new mxPoint(s,u):new mxPoint(s+a,u):(c=e,l=u,r&&(o>=s&&o<=s+a?c=o:f>=h&&f<=h+v&&(l=f)),o<e?f<u?mxUtils.intersection(o,f,c,l,e,h,s,u):mxUtils.intersection(o,f,c,l,e,h+v,s,u):f<u?mxUtils.intersection(o,f,c,l,e,h,s+a,u):mxUtils.intersection(o,f,c,l,e,h+v,s+a,u))},TrianglePerimeter:function(n,t,i,r){var s=t!=null?t.style[mxConstants.STYLE_DIRECTION]:null,h=s==mxConstants.DIRECTION_NORTH||s==mxConstants.DIRECTION_SOUTH,u=n.x,f=n.y,e=n.width,o=n.height,c=u+e/2,l=f+o/2,v=new mxPoint(u,f),w=new mxPoint(u+e,l),y=new mxPoint(u,f+o),b,a;s==mxConstants.DIRECTION_NORTH?(v=y,w=new mxPoint(c,f),y=new mxPoint(u+e,f+o)):s==mxConstants.DIRECTION_SOUTH?(w=new mxPoint(c,f+o),y=new mxPoint(u+e,f)):s==mxConstants.DIRECTION_WEST&&(v=new mxPoint(u+e,f),w=new mxPoint(u,l),y=new mxPoint(u+e,f+o));var d=i.x-c,g=i.y-l,p=h?Math.atan2(d,g):Math.atan2(g,d),k=h?Math.atan2(e,o):Math.atan2(o,e),nt=!1;return nt=s==mxConstants.DIRECTION_NORTH||s==mxConstants.DIRECTION_WEST?p>-k&&p<k:p<-Math.PI+k||p>Math.PI-k,b=null,nt?b=r&&(h&&i.x>=v.x&&i.x<=y.x||!h&&i.y>=v.y&&i.y<=y.y)?h?new mxPoint(i.x,v.y):new mxPoint(v.x,i.y):s==mxConstants.DIRECTION_NORTH?new mxPoint(u+e/2+o*Math.tan(p)/2,f+o):s==mxConstants.DIRECTION_SOUTH?new mxPoint(u+e/2-o*Math.tan(p)/2,f):s==mxConstants.DIRECTION_WEST?new mxPoint(u+e,f+o/2+e*Math.tan(p)/2):new mxPoint(u,f+o/2-e*Math.tan(p)/2):(r&&(a=new mxPoint(c,l),i.y>=f&&i.y<=f+o?(a.x=h?c:s==mxConstants.DIRECTION_WEST?u+e:u,a.y=i.y):i.x>=u&&i.x<=u+e&&(a.x=i.x,a.y=h?s==mxConstants.DIRECTION_NORTH?f+o:f:l),d=i.x-a.x,g=i.y-a.y,c=a.x,l=a.y),b=h&&i.x<=u+e/2||!h&&i.y<=f+o/2?mxUtils.intersection(i.x,i.y,c,l,v.x,v.y,w.x,w.y):mxUtils.intersection(i.x,i.y,c,l,w.x,w.y,y.x,y.y)),b==null&&(b=new mxPoint(c,l)),b},HexagonPerimeter:function(n,t,i,r){var f=n.x,u=n.y,o=n.width,e=n.height,p=n.getCenterX(),w=n.getCenterY(),c=i.x,h=i.y,it=c-p,rt=h-w,s=-Math.atan2(rt,it),y=Math.PI,b=Math.PI/2,k=new mxPoint(p,w),nt=t!=null?mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST,tt=nt==mxConstants.DIRECTION_NORTH||nt==mxConstants.DIRECTION_SOUTH,l=new mxPoint,a=new mxPoint,d,g,v;if((c<f&&h<u||c<f&&h>u+e||c>f+o&&h<u||c>f+o&&h>u+e)&&(r=!1),r){if(tt){if(c==p){if(h<=u)return new mxPoint(p,u);if(h>=u+e)return new mxPoint(p,u+e)}else if(c<f){if(h==u+e/4)return new mxPoint(f,u+e/4);if(h==u+3*e/4)return new mxPoint(f,u+3*e/4)}else if(c>f+o){if(h==u+e/4)return new mxPoint(f+o,u+e/4);if(h==u+3*e/4)return new mxPoint(f+o,u+3*e/4)}else if(c==f){if(h<w)return new mxPoint(f,u+e/4);if(h>w)return new mxPoint(f,u+3*e/4)}else if(c==f+o){if(h<w)return new mxPoint(f+o,u+e/4);if(h>w)return new mxPoint(f+o,u+3*e/4)}if(h==u)return new mxPoint(p,u);if(h==u+e)return new mxPoint(p,u+e);c<p?h>u+e/4&&h<u+3*e/4?(l=new mxPoint(f,u),a=new mxPoint(f,u+e)):h<u+e/4?(l=new mxPoint(f-Math.floor(.5*o),u+Math.floor(.5*e)),a=new mxPoint(f+o,u-Math.floor(.25*e))):h>u+3*e/4&&(l=new mxPoint(f-Math.floor(.5*o),u+Math.floor(.5*e)),a=new mxPoint(f+o,u+Math.floor(1.25*e))):c>p&&(h>u+e/4&&h<u+3*e/4?(l=new mxPoint(f+o,u),a=new mxPoint(f+o,u+e)):h<u+e/4?(l=new mxPoint(f,u-Math.floor(.25*e)),a=new mxPoint(f+Math.floor(1.5*o),u+Math.floor(.5*e))):h>u+3*e/4&&(l=new mxPoint(f+Math.floor(1.5*o),u+Math.floor(.5*e)),a=new mxPoint(f,u+Math.floor(1.25*e))))}else{if(h==w){if(c<=f)return new mxPoint(f,u+e/2);if(c>=f+o)return new mxPoint(f+o,u+e/2)}else if(h<u){if(c==f+o/4)return new mxPoint(f+o/4,u);if(c==f+3*o/4)return new mxPoint(f+3*o/4,u)}else if(h>u+e){if(c==f+o/4)return new mxPoint(f+o/4,u+e);if(c==f+3*o/4)return new mxPoint(f+3*o/4,u+e)}else if(h==u){if(c<p)return new mxPoint(f+o/4,u);if(c>p)return new mxPoint(f+3*o/4,u)}else if(h==u+e){if(c<p)return new mxPoint(f+o/4,u+e);if(h>w)return new mxPoint(f+3*o/4,u+e)}if(c==f)return new mxPoint(f,w);if(c==f+o)return new mxPoint(f+o,w);h<w?c>f+o/4&&c<f+3*o/4?(l=new mxPoint(f,u),a=new mxPoint(f+o,u)):c<f+o/4?(l=new mxPoint(f-Math.floor(.25*o),u+e),a=new mxPoint(f+Math.floor(.5*o),u-Math.floor(.5*e))):c>f+3*o/4&&(l=new mxPoint(f+Math.floor(.5*o),u-Math.floor(.5*e)),a=new mxPoint(f+Math.floor(1.25*o),u+e)):h>w&&(c>f+o/4&&c<f+3*o/4?(l=new mxPoint(f,u+e),a=new mxPoint(f+o,u+e)):c<f+o/4?(l=new mxPoint(f-Math.floor(.25*o),u),a=new mxPoint(f+Math.floor(.5*o),u+Math.floor(1.5*e))):c>f+3*o/4&&(l=new mxPoint(f+Math.floor(.5*o),u+Math.floor(1.5*e)),a=new mxPoint(f+Math.floor(1.25*o),u)))}d=p;g=w;c>=f&&c<=f+o?(d=c,g=h<w?u+e:u):h>=u&&h<=u+e&&(g=h,d=c<p?f+o:f);k=mxUtils.intersection(d,g,i.x,i.y,l.x,l.y,a.x,a.y)}else{if(tt){if(v=Math.atan2(e/4,o/2),s==v)return new mxPoint(f+o,u+Math.floor(.25*e));if(s==b)return new mxPoint(f+Math.floor(.5*o),u);if(s==y-v)return new mxPoint(f,u+Math.floor(.25*e));if(s==-v)return new mxPoint(f+o,u+Math.floor(.75*e));if(s==-b)return new mxPoint(f+Math.floor(.5*o),u+e);if(s==-y+v)return new mxPoint(f,u+Math.floor(.75*e));s<v&&s>-v?(l=new mxPoint(f+o,u),a=new mxPoint(f+o,u+e)):s>v&&s<b?(l=new mxPoint(f,u-Math.floor(.25*e)),a=new mxPoint(f+Math.floor(1.5*o),u+Math.floor(.5*e))):s>b&&s<y-v?(l=new mxPoint(f-Math.floor(.5*o),u+Math.floor(.5*e)),a=new mxPoint(f+o,u-Math.floor(.25*e))):s>y-v&&s<=y||s<-y+v&&s>=-y?(l=new mxPoint(f,u),a=new mxPoint(f,u+e)):s<-v&&s>-b?(l=new mxPoint(f+Math.floor(1.5*o),u+Math.floor(.5*e)),a=new mxPoint(f,u+Math.floor(1.25*e))):s<-b&&s>-y+v&&(l=new mxPoint(f-Math.floor(.5*o),u+Math.floor(.5*e)),a=new mxPoint(f+o,u+Math.floor(1.25*e)))}else{if(v=Math.atan2(e/2,o/4),s==v)return new mxPoint(f+Math.floor(.75*o),u);if(s==y-v)return new mxPoint(f+Math.floor(.25*o),u);if(s==y||s==-y)return new mxPoint(f,u+Math.floor(.5*e));if(s==0)return new mxPoint(f+o,u+Math.floor(.5*e));if(s==-v)return new mxPoint(f+Math.floor(.75*o),u+e);if(s==-y+v)return new mxPoint(f+Math.floor(.25*o),u+e);s>0&&s<v?(l=new mxPoint(f+Math.floor(.5*o),u-Math.floor(.5*e)),a=new mxPoint(f+Math.floor(1.25*o),u+e)):s>v&&s<y-v?(l=new mxPoint(f,u),a=new mxPoint(f+o,u)):s>y-v&&s<y?(l=new mxPoint(f-Math.floor(.25*o),u+e),a=new mxPoint(f+Math.floor(.5*o),u-Math.floor(.5*e))):s<0&&s>-v?(l=new mxPoint(f+Math.floor(.5*o),u+Math.floor(1.5*e)),a=new mxPoint(f+Math.floor(1.25*o),u)):s<-v&&s>-y+v?(l=new mxPoint(f,u+e),a=new mxPoint(f+o,u+e)):s<-y+v&&s>-y&&(l=new mxPoint(f-Math.floor(.25*o),u),a=new mxPoint(f+Math.floor(.5*o),u+Math.floor(1.5*e)))}k=mxUtils.intersection(p,w,i.x,i.y,l.x,l.y,a.x,a.y)}return k==null?new mxPoint(p,w):k}};mxPrintPreview.prototype.graph=null;mxPrintPreview.prototype.pageFormat=null;mxPrintPreview.prototype.scale=null;mxPrintPreview.prototype.border=0;mxPrintPreview.prototype.marginTop=0;mxPrintPreview.prototype.marginBottom=0;mxPrintPreview.prototype.x0=0;mxPrintPreview.prototype.y0=0;mxPrintPreview.prototype.autoOrigin=!0;mxPrintPreview.prototype.printOverlays=!1;mxPrintPreview.prototype.printControls=!1;mxPrintPreview.prototype.printBackgroundImage=!1;mxPrintPreview.prototype.backgroundColor="#ffffff";mxPrintPreview.prototype.borderColor=null;mxPrintPreview.prototype.title=null;mxPrintPreview.prototype.pageSelector=null;mxPrintPreview.prototype.wnd=null;mxPrintPreview.prototype.targetWindow=null;mxPrintPreview.prototype.pageCount=0;mxPrintPreview.prototype.clipping=!0;mxPrintPreview.prototype.getWindow=function(){return this.wnd};mxPrintPreview.prototype.getDoctype=function(){var n="";return document.documentMode==5?n='<meta http-equiv="X-UA-Compatible" content="IE=5">':document.documentMode==8?n='<meta http-equiv="X-UA-Compatible" content="IE=8">':document.documentMode>8&&(n='<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->'),n};mxPrintPreview.prototype.appendGraph=function(n,t,i,r,u,f){this.graph=n;this.scale=t!=null?t:1/n.pageScale;this.x0=i;this.y0=r;this.open(null,null,u,f)};mxPrintPreview.prototype.open=function(n,t,i,r){var rt=this.graph.cellRenderer.initializeOverlay,o=null,a,u,y,w,b,s,h,c,k,l,f;try{this.printOverlays&&(this.graph.cellRenderer.initializeOverlay=function(n,t){t.init(n.view.getDrawPane())});this.printControls&&(this.graph.cellRenderer.initControl=function(n,t){t.dialect=n.view.graph.dialect;t.init(n.view.getDrawPane())});this.wnd=t!=null?t:this.wnd;a=!1;this.wnd==null&&(a=!0,this.wnd=window.open());u=this.wnd.document;a&&(y=this.getDoctype(),y!=null&&y.length>0&&u.writeln(y),mxClient.IS_VML?u.writeln('<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">'):(document.compatMode==="CSS1Compat"&&u.writeln("<!DOCTYPE html>"),u.writeln("<html>")),u.writeln("<head>"),this.writeHead(u,n),u.writeln("<\/head>"),u.writeln('<body class="mxPage">'));var e=this.graph.getGraphBounds().clone(),v=this.graph.getView().getScale(),it=v/this.scale,p=this.graph.getView().getTranslate();this.autoOrigin||(this.x0-=p.x*this.scale,this.y0-=p.y*this.scale,e.width+=e.x,e.height+=e.y,e.x=0,e.y=0,this.border=0);w=this.pageFormat.width-this.border*2;b=this.pageFormat.height-this.border*2;this.pageFormat.height+=this.marginTop+this.marginBottom;e.width/=it;e.height/=it;s=Math.max(1,Math.ceil((e.width+this.x0)/w));h=Math.max(1,Math.ceil((e.height+this.y0)/b));this.pageCount=s*h;var ut=mxUtils.bind(this,function(){var n,t;this.pageSelector&&(h>1||s>1)&&(n=this.createPageSelector(h,s),u.body.appendChild(n),(mxClient.IS_IE&&u.documentMode==null||u.documentMode==5||u.documentMode==8||u.documentMode==7)&&(n.style.position="absolute",t=function(){n.style.top=(u.body.scrollTop||u.documentElement.scrollTop)+10+"px"},mxEvent.addListener(this.wnd,"scroll",function(){t()}),mxEvent.addListener(this.wnd,"resize",function(){t()})))}),d=mxUtils.bind(this,function(n,t){this.borderColor!=null&&(n.style.borderColor=this.borderColor,n.style.borderStyle="solid",n.style.borderWidth="1px");n.style.background=this.backgroundColor;(i||t)&&(n.style.pageBreakAfter="always");a&&(mxClient.IS_IE||document.documentMode>=11||mxClient.IS_EDGE)?(u.writeln(n.outerHTML),n.parentNode.removeChild(n)):(n.parentNode.removeChild(n),u.body.appendChild(n));(i||t)&&this.addPageBreak(u)}),g=this.getCoverPages(this.pageFormat.width,this.pageFormat.height);if(g!=null)for(f=0;f<g.length;f++)d(g[f],!0);for(c=this.getAppendices(this.pageFormat.width,this.pageFormat.height),f=0;f<h;f++)for(k=f*b/this.scale-this.y0/this.scale+(e.y-p.y*v)/v,l=0;l<s;l++){if(this.wnd==null)return null;var nt=l*w/this.scale-this.x0/this.scale+(e.x-p.x*v)/v,tt=f*s+l+1,ft=new mxRectangle(nt,k,w,b);o=this.renderPage(this.pageFormat.width,this.pageFormat.height,0,0,mxUtils.bind(this,function(n){this.addGraphFragment(-nt,-k,this.scale,tt,n,ft);this.printBackgroundImage&&this.insertBackgroundImage(n,-nt,-k)}),tt);o.setAttribute("id","mxPage-"+tt);d(o,c!=null||f<h-1||l<s-1)}if(c!=null)for(f=0;f<c.length;f++)d(c[f],f<c.length-1);a&&!r&&(this.closeDocument(),ut());this.wnd.focus()}catch(et){o!=null&&o.parentNode!=null&&o.parentNode.removeChild(o)}finally{this.graph.cellRenderer.initializeOverlay=rt}return this.wnd};mxPrintPreview.prototype.addPageBreak=function(n){var t=n.createElement("hr");t.className="mxPageBreak";n.body.appendChild(t)};mxPrintPreview.prototype.closeDocument=function(){if(this.wnd!=null&&this.wnd.document!=null){var n=this.wnd.document;this.writePostfix(n);n.writeln("<\/body>");n.writeln("<\/html>");n.close();mxEvent.release(n.body)}};mxPrintPreview.prototype.writeHead=function(n,t){this.title!=null&&n.writeln("<title>"+this.title+"<\/title>");mxClient.IS_VML&&n.writeln('<style type="text/css">v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}<\/style>');mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",n);n.writeln('<style type="text/css">');n.writeln("@media print {");n.writeln("  table.mxPageSelector { display: none; }");n.writeln("  hr.mxPageBreak { display: none; }");n.writeln("}");n.writeln("@media screen {");n.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white; border-collapse:collapse; }");n.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");n.writeln("  body.mxPage { background: gray; }");n.writeln("}");t!=null&&n.writeln(t);n.writeln("<\/style>")};mxPrintPreview.prototype.writePostfix=function(){};mxPrintPreview.prototype.createPageSelector=function(n,t){var i=this.wnd.document,r=i.createElement("table"),o,u,s,f,l;for(r.className="mxPageSelector",r.setAttribute("border","0"),o=i.createElement("tbody"),u=0;u<n;u++){for(s=i.createElement("tr"),f=0;f<t;f++){var h=u*t+f+1,c=i.createElement("td"),e=i.createElement("a");e.setAttribute("href","#mxPage-"+h);!mxClient.IS_NS||mxClient.IS_SF||mxClient.IS_GC||(l="var page = document.getElementById('mxPage-"+h+"');page.scrollIntoView(true);event.preventDefault();",e.setAttribute("onclick",l));mxUtils.write(e,h,i);c.appendChild(e);s.appendChild(c)}o.appendChild(s)}return r.appendChild(o),r};mxPrintPreview.prototype.renderPage=function(n,t,i,r,u){var s=this.wnd.document,e=document.createElement("div"),h=null,o,f;try{i!=0||r!=0?(e.style.position="relative",e.style.width=n+"px",e.style.height=t+"px",e.style.pageBreakInside="avoid",f=document.createElement("div"),f.style.position="relative",f.style.top=this.border+"px",f.style.left=this.border+"px",f.style.width=n-2*this.border+"px",f.style.height=t-2*this.border+"px",f.style.overflow="hidden",o=document.createElement("div"),o.style.position="relative",o.style.marginLeft=i+"px",o.style.marginTop=r+"px",s.documentMode==8&&(f.style.position="absolute",o.style.position="absolute"),s.documentMode==10&&(o.style.width="100%",o.style.height="100%"),f.appendChild(o),e.appendChild(f),document.body.appendChild(e),h=o):(e.style.width=n+"px",e.style.height=t+"px",e.style.overflow="hidden",e.style.pageBreakInside="avoid",s.documentMode==8&&(e.style.position="relative"),f=document.createElement("div"),f.style.width=n-2*this.border+"px",f.style.height=t-2*this.border+"px",f.style.overflow="hidden",mxClient.IS_IE&&(s.documentMode==null||s.documentMode==5||s.documentMode==8||s.documentMode==7)?(f.style.marginTop=this.border+"px",f.style.marginLeft=this.border+"px"):(f.style.top=this.border+"px",f.style.left=this.border+"px"),this.graph.dialect==mxConstants.DIALECT_VML&&(f.style.position="absolute"),e.appendChild(f),document.body.appendChild(e),h=f)}catch(c){e.parentNode.removeChild(e);e=null;throw c;}return u(h),e};mxPrintPreview.prototype.getRoot=function(){var n=this.graph.view.currentRoot;return n==null&&(n=this.graph.getModel().getRoot()),n};mxPrintPreview.prototype.addGraphFragment=function(n,t,i,r,u,f){var e=this.graph.getView(),d=this.graph.container,v,y,s,w,c,b,o,k,l,a;this.graph.container=u;var g=e.getCanvas(),nt=e.getBackgroundPane(),tt=e.getDrawPane(),it=e.getOverlayPane();this.graph.dialect==mxConstants.DIALECT_SVG?e.createSvg():this.graph.dialect==mxConstants.DIALECT_VML?e.createVml():e.createHtml();v=e.isEventsEnabled();e.setEventsEnabled(!1);y=this.graph.isEnabled();this.graph.setEnabled(!1);s=e.getTranslate();e.translate=new mxPoint(n,t);var p=this.graph.cellRenderer.redraw,rt=e.states,h=e.scale;this.clipping&&(w=new mxRectangle((f.x+s.x)*h,(f.y+s.y)*h,f.width*h/i,f.height*h/i),this.graph.cellRenderer.redraw=function(n){var t,i;(n==null||(t=rt.get(n.cell),t==null||(i=e.getBoundingBox(t,!1),i==null||mxUtils.intersects(w,i))))&&p.apply(this,arguments)});c=null;try{b=[this.getRoot()];c=new mxTemporaryCellStates(e,i,b,null,mxUtils.bind(this,function(n){return this.getLinkForCellState(n)}))}finally{if(mxClient.IS_IE)e.overlayPane.innerHTML="",e.canvas.style.overflow="hidden",e.canvas.style.position="relative",e.canvas.style.top=this.marginTop+"px",e.canvas.style.width=f.width+"px",e.canvas.style.height=f.height+"px";else for(o=u.firstChild;o!=null;)k=o.nextSibling,l=o.nodeName.toLowerCase(),l=="svg"?(o.style.overflow="hidden",o.style.position="relative",o.style.top=this.marginTop+"px",o.setAttribute("width",f.width),o.setAttribute("height",f.height),o.style.width="",o.style.height=""):o.style.cursor!="default"&&l!="div"&&o.parentNode.removeChild(o),o=k;this.printBackgroundImage&&(a=u.getElementsByTagName("svg"),a.length>0&&(a[0].style.position="absolute"));e.overlayPane.parentNode.removeChild(e.overlayPane);this.graph.setEnabled(y);this.graph.container=d;this.graph.cellRenderer.redraw=p;e.canvas=g;e.backgroundPane=nt;e.drawPane=tt;e.overlayPane=it;e.translate=s;c.destroy();e.setEventsEnabled(v)}};mxPrintPreview.prototype.getLinkForCellState=function(n){return this.graph.getLinkForCell(n.cell)};mxPrintPreview.prototype.insertBackgroundImage=function(n,t,i){var u=this.graph.backgroundImage,r;u!=null&&(r=document.createElement("img"),r.style.position="absolute",r.style.marginLeft=Math.round(t*this.scale)+"px",r.style.marginTop=Math.round(i*this.scale)+"px",r.setAttribute("width",Math.round(this.scale*u.width)),r.setAttribute("height",Math.round(this.scale*u.height)),r.src=u.src,n.insertBefore(r,n.firstChild))};mxPrintPreview.prototype.getCoverPages=function(){return null};mxPrintPreview.prototype.getAppendices=function(){return null};mxPrintPreview.prototype.print=function(n){var t=this.open(n);t!=null&&t.print()};mxPrintPreview.prototype.close=function(){this.wnd!=null&&(this.wnd.close(),this.wnd=null)};mxStylesheet.prototype.styles;mxStylesheet.prototype.createDefaultVertexStyle=function(){var n={};return n[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE,n[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter,n[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE,n[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER,n[mxConstants.STYLE_FILLCOLOR]="#C3D9FF",n[mxConstants.STYLE_STROKECOLOR]="#6482B9",n[mxConstants.STYLE_FONTCOLOR]="#774400",n};mxStylesheet.prototype.createDefaultEdgeStyle=function(){var n={};return n[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR,n[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC,n[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE,n[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER,n[mxConstants.STYLE_STROKECOLOR]="#6482B9",n[mxConstants.STYLE_FONTCOLOR]="#446299",n};mxStylesheet.prototype.putDefaultVertexStyle=function(n){this.putCellStyle("defaultVertex",n)};mxStylesheet.prototype.putDefaultEdgeStyle=function(n){this.putCellStyle("defaultEdge",n)};mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles.defaultVertex};mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles.defaultEdge};mxStylesheet.prototype.putCellStyle=function(n,t){this.styles[n]=t};mxStylesheet.prototype.getCellStyle=function(n,t){var i=t,h,e,u,o,f,s,r;if(n!=null&&n.length>0)for(h=n.split(";"),i=i!=null&&n.charAt(0)!=";"?mxUtils.clone(i):{},e=0;e<h.length;e++)if(u=h[e],o=u.indexOf("="),o>=0)r=u.substring(0,o),f=u.substring(o+1),f==mxConstants.NONE?delete i[r]:i[r]=mxUtils.isNumeric(f)?parseFloat(f):f;else if(s=this.styles[u],s!=null)for(r in s)i[r]=s[r];return i};mxCellState.prototype=new mxRectangle;mxCellState.prototype.constructor=mxCellState;mxCellState.prototype.view=null;mxCellState.prototype.cell=null;mxCellState.prototype.style=null;mxCellState.prototype.invalid=!0;mxCellState.prototype.origin=null;mxCellState.prototype.absolutePoints=null;mxCellState.prototype.absoluteOffset=null;mxCellState.prototype.visibleSourceState=null;mxCellState.prototype.visibleTargetState=null;mxCellState.prototype.terminalDistance=0;mxCellState.prototype.length=0;mxCellState.prototype.segments=null;mxCellState.prototype.shape=null;mxCellState.prototype.text=null;mxCellState.prototype.unscaledWidth=null;mxCellState.prototype.getPerimeterBounds=function(n,t){if(n=n||0,t=t!=null?t:new mxRectangle(this.x,this.y,this.width,this.height),this.shape!=null&&this.shape.stencil!=null&&this.shape.stencil.aspect=="fixed"){var i=this.shape.stencil.computeAspect(this.style,t.x,t.y,t.width,t.height);t.x=i.x;t.y=i.y;t.width=this.shape.stencil.w0*i.width;t.height=this.shape.stencil.h0*i.height}return n!=0&&t.grow(n),t};mxCellState.prototype.setAbsoluteTerminalPoint=function(n,t){t?(this.absolutePoints==null&&(this.absolutePoints=[]),this.absolutePoints.length==0?this.absolutePoints.push(n):this.absolutePoints[0]=n):this.absolutePoints==null?(this.absolutePoints=[],this.absolutePoints.push(null),this.absolutePoints.push(n)):this.absolutePoints.length==1?this.absolutePoints.push(n):this.absolutePoints[this.absolutePoints.length-1]=n};mxCellState.prototype.setCursor=function(n){this.shape!=null&&this.shape.setCursor(n);this.text!=null&&this.text.setCursor(n)};mxCellState.prototype.getVisibleTerminal=function(n){var t=this.getVisibleTerminalState(n);return t!=null?t.cell:null};mxCellState.prototype.getVisibleTerminalState=function(n){return n?this.visibleSourceState:this.visibleTargetState};mxCellState.prototype.setVisibleTerminalState=function(n,t){t?this.visibleSourceState=n:this.visibleTargetState=n};mxCellState.prototype.getCellBounds=function(){return this.cellBounds};mxCellState.prototype.getPaintBounds=function(){return this.paintBounds};mxCellState.prototype.updateCachedBounds=function(){var t=this.view.translate,n=this.view.scale;this.cellBounds=new mxRectangle(this.x/n-t.x,this.y/n-t.y,this.width/n,this.height/n);this.paintBounds=mxRectangle.fromRectangle(this.cellBounds);this.shape!=null&&this.shape.isPaintBoundsInverted()&&this.paintBounds.rotate90()};mxCellState.prototype.setState=function(n){this.view=n.view;this.cell=n.cell;this.style=n.style;this.absolutePoints=n.absolutePoints;this.origin=n.origin;this.absoluteOffset=n.absoluteOffset;this.boundingBox=n.boundingBox;this.terminalDistance=n.terminalDistance;this.segments=n.segments;this.length=n.length;this.x=n.x;this.y=n.y;this.width=n.width;this.height=n.height;this.unscaledWidth=n.unscaledWidth};mxCellState.prototype.clone=function(){var n=new mxCellState(this.view,this.cell,this.style),t;if(this.absolutePoints!=null)for(n.absolutePoints=[],t=0;t<this.absolutePoints.length;t++)n.absolutePoints[t]=this.absolutePoints[t].clone();return this.origin!=null&&(n.origin=this.origin.clone()),this.absoluteOffset!=null&&(n.absoluteOffset=this.absoluteOffset.clone()),this.boundingBox!=null&&(n.boundingBox=this.boundingBox.clone()),n.terminalDistance=this.terminalDistance,n.segments=this.segments,n.length=this.length,n.x=this.x,n.y=this.y,n.width=this.width,n.height=this.height,n.unscaledWidth=this.unscaledWidth,n};mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this)};mxGraphSelectionModel.prototype=new mxEventSource;mxGraphSelectionModel.prototype.constructor=mxGraphSelectionModel;mxGraphSelectionModel.prototype.doneResource=mxClient.language!="none"?"done":"";mxGraphSelectionModel.prototype.updatingSelectionResource=mxClient.language!="none"?"updatingSelection":"";mxGraphSelectionModel.prototype.graph=null;mxGraphSelectionModel.prototype.singleSelection=!1;mxGraphSelectionModel.prototype.isSingleSelection=function(){return this.singleSelection};mxGraphSelectionModel.prototype.setSingleSelection=function(n){this.singleSelection=n};mxGraphSelectionModel.prototype.isSelected=function(n){return n!=null?mxUtils.indexOf(this.cells,n)>=0:!1};mxGraphSelectionModel.prototype.isEmpty=function(){return this.cells.length==0};mxGraphSelectionModel.prototype.clear=function(){this.changeSelection(null,this.cells)};mxGraphSelectionModel.prototype.setCell=function(n){n!=null&&this.setCells([n])};mxGraphSelectionModel.prototype.setCells=function(n){var i,t;if(n!=null){for(this.singleSelection&&(n=[this.getFirstSelectableCell(n)]),i=[],t=0;t<n.length;t++)this.graph.isCellSelectable(n[t])&&i.push(n[t]);this.changeSelection(i,this.cells)}};mxGraphSelectionModel.prototype.getFirstSelectableCell=function(n){if(n!=null)for(var t=0;t<n.length;t++)if(this.graph.isCellSelectable(n[t]))return n[t];return null};mxGraphSelectionModel.prototype.addCell=function(n){n!=null&&this.addCells([n])};mxGraphSelectionModel.prototype.addCells=function(n){var i,r,t;if(n!=null){for(i=null,this.singleSelection&&(i=this.cells,n=[this.getFirstSelectableCell(n)]),r=[],t=0;t<n.length;t++)!this.isSelected(n[t])&&this.graph.isCellSelectable(n[t])&&r.push(n[t]);this.changeSelection(r,i)}};mxGraphSelectionModel.prototype.removeCell=function(n){n!=null&&this.removeCells([n])};mxGraphSelectionModel.prototype.removeCells=function(n){var i,t;if(n!=null){for(i=[],t=0;t<n.length;t++)this.isSelected(n[t])&&i.push(n[t]);this.changeSelection(null,i)}};mxGraphSelectionModel.prototype.changeSelection=function(n,t){var i,r;(n!=null&&n.length>0&&n[0]!=null||t!=null&&t.length>0&&t[0]!=null)&&(i=new mxSelectionChange(this,n,t),i.execute(),r=new mxUndoableEdit(this,!1),r.add(i),this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",r)))};mxGraphSelectionModel.prototype.cellAdded=function(n){n==null||this.isSelected(n)||this.cells.push(n)};mxGraphSelectionModel.prototype.cellRemoved=function(n){if(n!=null){var t=mxUtils.indexOf(this.cells,n);t>=0&&this.cells.splice(t,1)}};mxSelectionChange.prototype.execute=function(){var i=mxLog.enter("mxSelectionChange.execute"),n,t;if(window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource,this.removed!=null)for(n=0;n<this.removed.length;n++)this.selectionModel.cellRemoved(this.removed[n]);if(this.added!=null)for(n=0;n<this.added.length;n++)this.selectionModel.cellAdded(this.added[n]);t=this.added;this.added=this.removed;this.removed=t;window.status=mxResources.get(this.selectionModel.doneResource)||this.selectionModel.doneResource;mxLog.leave("mxSelectionChange.execute",i);this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed))};mxCellEditor.prototype.graph=null;mxCellEditor.prototype.textarea=null;mxCellEditor.prototype.editingCell=null;mxCellEditor.prototype.trigger=null;mxCellEditor.prototype.modified=!1;mxCellEditor.prototype.autoSize=!0;mxCellEditor.prototype.selectText=!0;mxCellEditor.prototype.emptyLabelText=mxClient.IS_FF?"<br>":"";mxCellEditor.prototype.escapeCancelsEditing=!0;mxCellEditor.prototype.textNode="";mxCellEditor.prototype.zIndex=5;mxCellEditor.prototype.minResize=new mxRectangle(0,20);mxCellEditor.prototype.wordWrapPadding=mxClient.IS_QUIRKS?2:mxClient.IS_IE11?0:1;mxCellEditor.prototype.blurEnabled=!1;mxCellEditor.prototype.initialValue=null;mxCellEditor.prototype.init=function(){this.textarea=document.createElement("div");this.textarea.className="mxCellEditor mxPlainTextEditor";this.textarea.contentEditable=!0;mxClient.IS_GC&&(this.textarea.style.minHeight="1em");this.textarea.style.position=this.isLegacyEditor()?"absolute":"relative";this.installListeners(this.textarea)};mxCellEditor.prototype.applyValue=function(n,t){this.graph.labelChanged(n.cell,t,this.trigger)};mxCellEditor.prototype.getInitialValue=function(n,t){var i=mxUtils.htmlEntities(this.graph.getEditingValue(n.cell,t),!1);return mxClient.IS_QUIRKS||document.documentMode==8||document.documentMode==9||document.documentMode==10||(i=mxUtils.replaceTrailingNewlines(i,"<div><br><\/div>")),i.replace(/\n/g,"<br>")};mxCellEditor.prototype.getCurrentValue=function(){return mxUtils.extractTextWithWhitespace(this.textarea.childNodes)};mxCellEditor.prototype.isCancelEditingKeyEvent=function(n){return this.escapeCancelsEditing||mxEvent.isShiftDown(n)||mxEvent.isControlDown(n)||mxEvent.isMetaDown(n)};mxCellEditor.prototype.installListeners=function(n){var r,i,u,t;mxEvent.addListener(n,"blur",mxUtils.bind(this,function(n){this.blurEnabled&&this.focusLost(n)}));mxEvent.addListener(n,"keydown",mxUtils.bind(this,function(n){mxEvent.isConsumed(n)||(this.isStopEditingEvent(n)?(this.graph.stopEditing(!1),mxEvent.consume(n)):n.keyCode==27&&(this.graph.stopEditing(this.isCancelEditingKeyEvent(n)),mxEvent.consume(n)))}));r=mxUtils.bind(this,function(t){this.editingCell!=null&&this.clearOnChange&&n.innerHTML==this.getEmptyLabelText()&&(!mxClient.IS_FF||t.keyCode!=8&&t.keyCode!=46)&&(this.clearOnChange=!1,n.innerHTML="")});mxEvent.addListener(n,"keypress",r);mxEvent.addListener(n,"paste",r);i=mxUtils.bind(this,function(){this.editingCell!=null&&(this.textarea.innerHTML.length==0||this.textarea.innerHTML=="<br>"?(this.textarea.innerHTML=this.getEmptyLabelText(),this.clearOnChange=this.textarea.innerHTML.length>0):this.clearOnChange=!1)});mxEvent.addListener(n,!mxClient.IS_IE11&&!mxClient.IS_IE?"input":"keyup",i);mxEvent.addListener(n,"cut",i);mxEvent.addListener(n,"paste",i);u=!mxClient.IS_IE11&&!mxClient.IS_IE?"input":"keydown";t=mxUtils.bind(this,function(n){this.editingCell!=null&&this.autoSize&&!mxEvent.isConsumed(n)&&(this.resizeThread!=null&&window.clearTimeout(this.resizeThread),this.resizeThread=window.setTimeout(mxUtils.bind(this,function(){this.resizeThread=null;this.resize()}),0))});mxEvent.addListener(n,u,t);document.documentMode>=9?(mxEvent.addListener(n,"DOMNodeRemoved",t),mxEvent.addListener(n,"DOMNodeInserted",t)):(mxEvent.addListener(n,"cut",t),mxEvent.addListener(n,"paste",t))};mxCellEditor.prototype.isStopEditingEvent=function(n){return n.keyCode==113||this.graph.isEnterStopsCellEditing()&&n.keyCode==13&&!mxEvent.isControlDown(n)&&!mxEvent.isShiftDown(n)};mxCellEditor.prototype.isEventSource=function(n){return mxEvent.getSource(n)==this.textarea};mxCellEditor.prototype.resize=function(){var n=this.graph.getView().getState(this.editingCell),f,u,e,o;if(n==null)this.stopEditing(!0);else if(this.textarea!=null){var v=this.graph.getModel().isEdge(n.cell),t=this.graph.getView().scale,i=null;if(this.autoSize&&n.style[mxConstants.STYLE_OVERFLOW]!="fill"){if(f=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_WIDTH,null),i=n.text!=null?n.text.margin:null,i==null&&(i=mxUtils.getAlignmentAsPoint(mxUtils.getValue(n.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE))),v)this.bounds=new mxRectangle(n.absoluteOffset.x,n.absoluteOffset.y,0,0),f!=null&&(u=(parseFloat(f)+2)*t,this.bounds.width=u,this.bounds.x+=i.x*u);else{var r=mxRectangle.fromRectangle(n),h=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),c=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(r=n.shape!=null&&h==mxConstants.ALIGN_CENTER&&c==mxConstants.ALIGN_MIDDLE?n.shape.getLabelBounds(r):r,f!=null&&(r.width=parseFloat(f)*t),!n.view.graph.cellRenderer.legacySpacing||n.style[mxConstants.STYLE_OVERFLOW]!="width"){var s=parseInt(n.style[mxConstants.STYLE_SPACING]||2)*t,l=(parseInt(n.style[mxConstants.STYLE_SPACING_TOP]||0)+mxText.prototype.baseSpacingTop)*t+s,y=(parseInt(n.style[mxConstants.STYLE_SPACING_RIGHT]||0)+mxText.prototype.baseSpacingRight)*t+s,p=(parseInt(n.style[mxConstants.STYLE_SPACING_BOTTOM]||0)+mxText.prototype.baseSpacingBottom)*t+s,a=(parseInt(n.style[mxConstants.STYLE_SPACING_LEFT]||0)+mxText.prototype.baseSpacingLeft)*t+s,h=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),c=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);r=new mxRectangle(r.x+a,r.y+l,r.width-(h==mxConstants.ALIGN_CENTER&&f==null?a+y:0),r.height-(c==mxConstants.ALIGN_MIDDLE?l+p:0))}this.bounds=new mxRectangle(r.x+n.absoluteOffset.x,r.y+n.absoluteOffset.y,r.width,r.height)}this.graph.isWrapping(n.cell)&&(this.bounds.width>=2||this.bounds.height>=2)&&this.textarea.innerHTML!=this.getEmptyLabelText()?(this.textarea.style.wordWrap=mxConstants.WORD_WRAP,this.textarea.style.whiteSpace="normal",u=Math.round(this.bounds.width/(document.documentMode==8?t:t))+this.wordWrapPadding,this.textarea.style.position!="relative"?(this.textarea.style.width=u+"px",this.textarea.scrollWidth>u&&(this.textarea.style.width=this.textarea.scrollWidth+"px")):this.textarea.style.maxWidth=u+"px"):(this.textarea.style.whiteSpace="nowrap",this.textarea.style.width="");document.documentMode==8&&(this.textarea.style.zoom="1",this.textarea.style.height="auto");e=this.textarea.scrollWidth;o=this.textarea.scrollHeight;document.documentMode==8?(this.textarea.style.left=Math.max(0,Math.ceil((this.bounds.x-i.x*(this.bounds.width-(e+1)*t)+e*(t-1)*0+(i.x+.5)*2)/t))+"px",this.textarea.style.top=Math.max(0,Math.ceil((this.bounds.y-i.y*(this.bounds.height-(o+.5)*t)+o*(t-1)*0+Math.abs(i.y+.5)*1)/t))+"px",this.textarea.style.width=Math.round(e*t)+"px",this.textarea.style.height=Math.round(o*t)+"px"):mxClient.IS_QUIRKS?(this.textarea.style.left=Math.max(0,Math.ceil(this.bounds.x-i.x*(this.bounds.width-(e+1)*t)+e*(t-1)*0+(i.x+.5)*2))+"px",this.textarea.style.top=Math.max(0,Math.ceil(this.bounds.y-i.y*(this.bounds.height-(o+.5)*t)+o*(t-1)*0+Math.abs(i.y+.5)*1))+"px"):(this.textarea.style.left=Math.max(0,Math.round(this.bounds.x-i.x*(this.bounds.width-2))+1)+"px",this.textarea.style.top=Math.max(0,Math.round(this.bounds.y-i.y*(this.bounds.height-4)+(i.y==-1?3:0))+1)+"px")}else this.bounds=this.getEditorBounds(n),this.textarea.style.width=Math.round(this.bounds.width/t)+"px",this.textarea.style.height=Math.round(this.bounds.height/t)+"px",document.documentMode==8||mxClient.IS_QUIRKS?(this.textarea.style.left=Math.round(this.bounds.x)+"px",this.textarea.style.top=Math.round(this.bounds.y)+"px"):(this.textarea.style.left=Math.max(0,Math.round(this.bounds.x+1))+"px",this.textarea.style.top=Math.max(0,Math.round(this.bounds.y+1))+"px"),this.graph.isWrapping(n.cell)&&(this.bounds.width>=2||this.bounds.height>=2)&&this.textarea.innerHTML!=this.getEmptyLabelText()?(this.textarea.style.wordWrap=mxConstants.WORD_WRAP,this.textarea.style.whiteSpace="normal",n.style[mxConstants.STYLE_OVERFLOW]!="fill"&&(this.textarea.style.width=Math.round(this.bounds.width/t)+this.wordWrapPadding+"px")):(this.textarea.style.whiteSpace="nowrap",n.style[mxConstants.STYLE_OVERFLOW]!="fill"&&(this.textarea.style.width=""));mxClient.IS_VML?this.textarea.style.zoom=t:(mxUtils.setPrefixedStyle(this.textarea.style,"transformOrigin","0px 0px"),mxUtils.setPrefixedStyle(this.textarea.style,"transform","scale("+t+","+t+")"+(i==null?"":" translate("+i.x*100+"%,"+i.y*100+"%)")))}};mxCellEditor.prototype.focusLost=function(){this.stopEditing(!this.graph.isInvokesStopCellEditing())};mxCellEditor.prototype.getBackgroundColor=function(){return null};mxCellEditor.prototype.isLegacyEditor=function(){var n,t;return mxClient.IS_VML?!0:(n=!1,mxClient.IS_SVG&&(t=this.graph.view.getDrawPane().ownerSVGElement,t!=null&&(n=mxUtils.getCurrentStyle(t).position=="absolute")),!n)};mxCellEditor.prototype.startEditing=function(n,t){var i,r;if(this.stopEditing(!0),this.textarea==null&&this.init(),this.graph.tooltipHandler!=null&&this.graph.tooltipHandler.hideTooltip(),i=this.graph.getView().getState(n),i!=null){var l=this.graph.getView().scale,u=mxUtils.getValue(i.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE),f=mxUtils.getValue(i.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY),e=mxUtils.getValue(i.style,mxConstants.STYLE_FONTCOLOR,"black"),o=mxUtils.getValue(i.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT),s=(mxUtils.getValue(i.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD,h=(mxUtils.getValue(i.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC,c=(mxUtils.getValue(i.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;this.textarea.style.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?Math.round(u*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;this.textarea.style.backgroundColor=this.getBackgroundColor(i);this.textarea.style.textDecoration=c?"underline":"";this.textarea.style.fontWeight=s?"bold":"normal";this.textarea.style.fontStyle=h?"italic":"";this.textarea.style.fontSize=Math.round(u)+"px";this.textarea.style.zIndex=this.zIndex;this.textarea.style.fontFamily=f;this.textarea.style.textAlign=o;this.textarea.style.outline="none";this.textarea.style.color=e;r=this.textDirection=mxUtils.getValue(i.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);r==mxConstants.TEXT_DIRECTION_AUTO&&(i==null||i.text==null||i.text.dialect==mxConstants.DIALECT_STRICTHTML||mxUtils.isNode(i.text.value)||(r=i.text.getAutoDirection()));r==mxConstants.TEXT_DIRECTION_LTR||r==mxConstants.TEXT_DIRECTION_RTL?this.textarea.setAttribute("dir",r):this.textarea.removeAttribute("dir");this.textarea.innerHTML=this.getInitialValue(i,t)||"";this.initialValue=this.textarea.innerHTML;this.textarea.innerHTML.length==0||this.textarea.innerHTML=="<br>"?(this.textarea.innerHTML=this.getEmptyLabelText(),this.clearOnChange=!0):this.clearOnChange=this.textarea.innerHTML==this.getEmptyLabelText();this.graph.container.appendChild(this.textarea);this.editingCell=n;this.trigger=t;this.textNode=null;i.text!=null&&this.isHideLabel(i)&&(this.textNode=i.text.node,this.textNode.style.visibility="hidden");this.autoSize&&(this.graph.model.isEdge(i.cell)||i.style[mxConstants.STYLE_OVERFLOW]!="fill")&&window.setTimeout(mxUtils.bind(this,function(){this.resize()}),0);this.resize();try{this.textarea.focus();this.isSelectText()&&this.textarea.innerHTML.length>0&&(this.textarea.innerHTML!=this.getEmptyLabelText()||!this.clearOnChange)&&document.execCommand("selectAll",!1,null)}catch(a){}}};mxCellEditor.prototype.isSelectText=function(){return this.selectText};mxCellEditor.prototype.clearSelection=function(){var n=null;window.getSelection?n=window.getSelection():document.selection&&(n=document.selection);n!=null&&(n.empty?n.empty():n.removeAllRanges&&n.removeAllRanges())};mxCellEditor.prototype.stopEditing=function(n){var t,r,i;n=n||!1;this.editingCell!=null&&(this.textNode!=null&&(this.textNode.style.visibility="visible",this.textNode=null),t=n?null:this.graph.view.getState(this.editingCell),r=this.initialValue,this.initialValue=null,this.editingCell=null,this.trigger=null,this.bounds=null,this.textarea.blur(),this.clearSelection(),this.textarea.parentNode!=null&&this.textarea.parentNode.removeChild(this.textarea),this.clearOnChange&&this.textarea.innerHTML==this.getEmptyLabelText()&&(this.textarea.innerHTML="",this.clearOnChange=!1),t!=null&&this.textarea.innerHTML!=r&&(this.prepareTextarea(),i=this.getCurrentValue(t),i!=null&&this.applyValue(t,i)),mxEvent.release(this.textarea),this.textarea=null)};mxCellEditor.prototype.prepareTextarea=function(){mxClient.IS_FF&&this.textarea.lastChild!=null&&this.textarea.lastChild.nodeName=="BR"&&this.textarea.removeChild(this.textarea.lastChild)};mxCellEditor.prototype.isHideLabel=function(){return!0};mxCellEditor.prototype.getMinimumSize=function(n){var t=this.graph.getView().scale;return new mxRectangle(0,0,n.text==null?30:n.text.size*t+20,this.textarea.style.textAlign=="left"?120:40)};mxCellEditor.prototype.getEditorBounds=function(n){var u=this.graph.getModel().isEdge(n.cell),i=this.graph.getView().scale,o=this.getMinimumSize(n),s=o.width,h=o.height,t=null,a,v,f,e;if(!u&&n.view.graph.cellRenderer.legacySpacing&&n.style[mxConstants.STYLE_OVERFLOW]=="fill")t=n.shape.getLabelBounds(mxRectangle.fromRectangle(n));else{var r=parseInt(n.style[mxConstants.STYLE_SPACING]||0)*i,c=(parseInt(n.style[mxConstants.STYLE_SPACING_TOP]||0)+mxText.prototype.baseSpacingTop)*i+r,y=(parseInt(n.style[mxConstants.STYLE_SPACING_RIGHT]||0)+mxText.prototype.baseSpacingRight)*i+r,p=(parseInt(n.style[mxConstants.STYLE_SPACING_BOTTOM]||0)+mxText.prototype.baseSpacingBottom)*i+r,l=(parseInt(n.style[mxConstants.STYLE_SPACING_LEFT]||0)+mxText.prototype.baseSpacingLeft)*i+r;t=new mxRectangle(n.x,n.y,Math.max(s,n.width-l-y),Math.max(h,n.height-c-p));a=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);v=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);t=n.shape!=null&&a==mxConstants.ALIGN_CENTER&&v==mxConstants.ALIGN_MIDDLE?n.shape.getLabelBounds(t):t;u?(t.x=n.absoluteOffset.x,t.y=n.absoluteOffset.y,n.text!=null&&n.text.boundingBox!=null&&(n.text.boundingBox.x>0&&(t.x=n.text.boundingBox.x),n.text.boundingBox.y>0&&(t.y=n.text.boundingBox.y))):n.text!=null&&n.text.boundingBox!=null&&(t.x=Math.min(t.x,n.text.boundingBox.x),t.y=Math.min(t.y,n.text.boundingBox.y));t.x+=l;t.y+=c;n.text!=null&&n.text.boundingBox!=null&&(u?(t.width=Math.max(s,n.text.boundingBox.width),t.height=Math.max(h,n.text.boundingBox.height)):(t.width=Math.max(t.width,n.text.boundingBox.width),t.height=Math.max(t.height,n.text.boundingBox.height)));this.graph.getModel().isVertex(n.cell)&&(f=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),f==mxConstants.ALIGN_LEFT?t.x-=n.width:f==mxConstants.ALIGN_RIGHT&&(t.x+=n.width),e=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),e==mxConstants.ALIGN_TOP?t.y-=n.height:e==mxConstants.ALIGN_BOTTOM&&(t.y+=n.height))}return new mxRectangle(Math.round(t.x),Math.round(t.y),Math.round(t.width),Math.round(t.height))};mxCellEditor.prototype.getEmptyLabelText=function(){return this.emptyLabelText};mxCellEditor.prototype.getEditingCell=function(){return this.editingCell};mxCellEditor.prototype.destroy=function(){this.textarea!=null&&(mxEvent.release(this.textarea),this.textarea.parentNode!=null&&this.textarea.parentNode.removeChild(this.textarea),this.textarea=null);this.changeHandler!=null&&(this.graph.getModel().removeListener(this.changeHandler),this.changeHandler=null);this.zoomHandler&&(this.graph.view.removeListener(this.zoomHandler),this.zoomHandler=null)};mxCellRenderer.defaultShapes={};mxCellRenderer.prototype.defaultEdgeShape=mxConnector;mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape;mxCellRenderer.prototype.defaultTextShape=mxText;mxCellRenderer.prototype.legacyControlPosition=!0;mxCellRenderer.prototype.legacySpacing=!0;mxCellRenderer.prototype.antiAlias=!0;mxCellRenderer.prototype.forceControlClickHandler=!1;mxCellRenderer.registerShape=function(n,t){mxCellRenderer.defaultShapes[n]=t};mxCellRenderer.registerShape(mxConstants.SHAPE_RECTANGLE,mxRectangleShape);mxCellRenderer.registerShape(mxConstants.SHAPE_ELLIPSE,mxEllipse);mxCellRenderer.registerShape(mxConstants.SHAPE_RHOMBUS,mxRhombus);mxCellRenderer.registerShape(mxConstants.SHAPE_CYLINDER,mxCylinder);mxCellRenderer.registerShape(mxConstants.SHAPE_CONNECTOR,mxConnector);mxCellRenderer.registerShape(mxConstants.SHAPE_ACTOR,mxActor);mxCellRenderer.registerShape(mxConstants.SHAPE_TRIANGLE,mxTriangle);mxCellRenderer.registerShape(mxConstants.SHAPE_HEXAGON,mxHexagon);mxCellRenderer.registerShape(mxConstants.SHAPE_CLOUD,mxCloud);mxCellRenderer.registerShape(mxConstants.SHAPE_LINE,mxLine);mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW,mxArrow);mxCellRenderer.registerShape(mxConstants.SHAPE_ARROW_CONNECTOR,mxArrowConnector);mxCellRenderer.registerShape(mxConstants.SHAPE_DOUBLE_ELLIPSE,mxDoubleEllipse);mxCellRenderer.registerShape(mxConstants.SHAPE_SWIMLANE,mxSwimlane);mxCellRenderer.registerShape(mxConstants.SHAPE_IMAGE,mxImageShape);mxCellRenderer.registerShape(mxConstants.SHAPE_LABEL,mxLabel);mxCellRenderer.prototype.initializeShape=function(n){n.shape.dialect=n.view.graph.dialect;this.configureShape(n);n.shape.init(n.view.getDrawPane())};mxCellRenderer.prototype.createShape=function(n){var t=null,i,r;return n.style!=null&&(i=mxStencilRegistry.getStencil(n.style[mxConstants.STYLE_SHAPE]),i!=null?t=new mxShape(i):(r=this.getShapeConstructor(n),t=new r)),t};mxCellRenderer.prototype.createIndicatorShape=function(n){n.shape.indicatorShape=this.getShape(n.view.graph.getIndicatorShape(n))};mxCellRenderer.prototype.getShape=function(n){return n!=null?mxCellRenderer.defaultShapes[n]:null};mxCellRenderer.prototype.getShapeConstructor=function(n){var t=this.getShape(n.style[mxConstants.STYLE_SHAPE]);return t==null&&(t=n.view.graph.getModel().isEdge(n.cell)?this.defaultEdgeShape:this.defaultVertexShape),t};mxCellRenderer.prototype.configureShape=function(n){n.shape.apply(n);n.shape.image=n.view.graph.getImage(n);n.shape.indicatorColor=n.view.graph.getIndicatorColor(n);n.shape.indicatorStrokeColor=n.style[mxConstants.STYLE_INDICATOR_STROKECOLOR];n.shape.indicatorGradientColor=n.view.graph.getIndicatorGradientColor(n);n.shape.indicatorDirection=n.style[mxConstants.STYLE_INDICATOR_DIRECTION];n.shape.indicatorImage=n.view.graph.getIndicatorImage(n);this.postConfigureShape(n)};mxCellRenderer.prototype.postConfigureShape=function(n){n.shape!=null&&(this.resolveColor(n,"indicatorColor",mxConstants.STYLE_FILLCOLOR),this.resolveColor(n,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR),this.resolveColor(n,"fill",mxConstants.STYLE_FILLCOLOR),this.resolveColor(n,"stroke",mxConstants.STYLE_STROKECOLOR),this.resolveColor(n,"gradient",mxConstants.STYLE_GRADIENTCOLOR))};mxCellRenderer.prototype.checkPlaceholderStyles=function(n){var r,i,t;if(n.style!=null)for(r=["inherit","swimlane","indicated"],i=[mxConstants.STYLE_FILLCOLOR,mxConstants.STYLE_STROKECOLOR,mxConstants.STYLE_GRADIENTCOLOR],t=0;t<i.length;t++)if(mxUtils.indexOf(r,n.style[i[t]])>=0)return!0;return!1};mxCellRenderer.prototype.resolveColor=function(n,t,i){var e=n.shape[t],r=n.view.graph,u=null,f;e=="inherit"?u=r.model.getParent(n.cell):e=="swimlane"?(n.shape[t]=i==mxConstants.STYLE_STROKECOLOR?"#000000":"#ffffff",u=r.model.getTerminal(n.cell,!1)!=null?r.model.getTerminal(n.cell,!1):n.cell,u=r.getSwimlane(u),i=r.swimlaneIndicatorColorAttribute):e=="indicated"&&(n.shape[t]=n.shape.indicatorColor);u!=null&&(f=r.getView().getState(u),n.shape[t]=null,f!=null&&(n.shape[t]=f.shape!=null&&t!="indicatorColor"?f.shape[t]:f.style[i]))};mxCellRenderer.prototype.getLabelValue=function(n){return n.view.graph.getLabel(n.cell)};mxCellRenderer.prototype.createLabel=function(n,t){var i=n.view.graph,e=i.getModel().isEdge(n.cell),f,r,u;(n.style[mxConstants.STYLE_FONTSIZE]>0||n.style[mxConstants.STYLE_FONTSIZE]==null)&&(f=i.isHtmlLabel(n.cell)||t!=null&&mxUtils.isNode(t),n.text=new this.defaultTextShape(t,new mxRectangle,n.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER,i.getVerticalAlign(n),n.style[mxConstants.STYLE_FONTCOLOR],n.style[mxConstants.STYLE_FONTFAMILY],n.style[mxConstants.STYLE_FONTSIZE],n.style[mxConstants.STYLE_FONTSTYLE],n.style[mxConstants.STYLE_SPACING],n.style[mxConstants.STYLE_SPACING_TOP],n.style[mxConstants.STYLE_SPACING_RIGHT],n.style[mxConstants.STYLE_SPACING_BOTTOM],n.style[mxConstants.STYLE_SPACING_LEFT],n.style[mxConstants.STYLE_HORIZONTAL],n.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],n.style[mxConstants.STYLE_LABEL_BORDERCOLOR],i.isWrapping(n.cell)&&i.isHtmlLabel(n.cell),i.isLabelClipped(n.cell),n.style[mxConstants.STYLE_OVERFLOW],n.style[mxConstants.STYLE_LABEL_PADDING],mxUtils.getValue(n.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION)),n.text.opacity=mxUtils.getValue(n.style,mxConstants.STYLE_TEXT_OPACITY,100),n.text.dialect=f?mxConstants.DIALECT_STRICTHTML:n.view.graph.dialect,n.text.style=n.style,n.text.state=n,this.initializeLabel(n,n.text),r=!1,u=function(t){var u=n;if(mxClient.IS_TOUCH||r){var e=mxEvent.getClientX(t),o=mxEvent.getClientY(t),f=mxUtils.convertPoint(i.container,e,o);u=i.view.getState(i.getCellAt(f.x,f.y))}return u},mxEvent.addGestureListeners(n.text.node,mxUtils.bind(this,function(t){this.isLabelEvent(n,t)&&(i.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t,n)),r=i.dialect!=mxConstants.DIALECT_SVG&&mxEvent.getSource(t).nodeName=="IMG")}),mxUtils.bind(this,function(t){this.isLabelEvent(n,t)&&i.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,u(t)))}),mxUtils.bind(this,function(t){this.isLabelEvent(n,t)&&(i.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t,u(t))),r=!1)})),i.nativeDblClickEnabled&&mxEvent.addListener(n.text.node,"dblclick",mxUtils.bind(this,function(t){this.isLabelEvent(n,t)&&(i.dblClick(t,n.cell),mxEvent.consume(t))})))};mxCellRenderer.prototype.initializeLabel=function(n,t){mxClient.IS_SVG&&mxClient.NO_FO&&t.dialect!=mxConstants.DIALECT_SVG?t.init(n.view.graph.container):t.init(n.view.getDrawPane())};mxCellRenderer.prototype.createCellOverlays=function(n){var e=n.view.graph,i=e.getCellOverlays(n.cell),u=null,t,f,r;if(i!=null)for(u=new mxDictionary,t=0;t<i.length;t++)f=n.overlays!=null?n.overlays.remove(i[t]):null,f==null?(r=new mxImageShape(new mxRectangle,i[t].image.src),r.dialect=n.view.graph.dialect,r.preserveImageAspect=!1,r.overlay=i[t],this.initializeOverlay(n,r),this.installCellOverlayListeners(n,i[t],r),i[t].cursor!=null&&(r.node.style.cursor=i[t].cursor),u.put(i[t],r)):u.put(i[t],f);n.overlays!=null&&n.overlays.visit(function(n,t){t.destroy()});n.overlays=u};mxCellRenderer.prototype.initializeOverlay=function(n,t){t.init(n.view.getOverlayPane())};mxCellRenderer.prototype.installCellOverlayListeners=function(n,t,i){var r=n.view.graph;mxEvent.addListener(i.node,"click",function(i){r.isEditing()&&r.stopEditing(!r.isInvokesStopCellEditing());t.fireEvent(new mxEventObject(mxEvent.CLICK,"event",i,"cell",n.cell))});mxEvent.addGestureListeners(i.node,function(n){mxEvent.consume(n)},function(t){r.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,n))});mxClient.IS_TOUCH&&mxEvent.addListener(i.node,"touchend",function(i){t.fireEvent(new mxEventObject(mxEvent.CLICK,"event",i,"cell",n.cell))})};mxCellRenderer.prototype.createControl=function(n){var i=n.view.graph,t=i.getFoldingImage(n),r;i.foldingEnabled&&t!=null?n.control==null&&(r=new mxRectangle(0,0,t.width,t.height),n.control=new mxImageShape(r,t.src),n.control.preserveImageAspect=!1,n.control.dialect=i.dialect,this.initControl(n,n.control,!0,this.createControlClickHandler(n))):n.control!=null&&(n.control.destroy(),n.control=null)};mxCellRenderer.prototype.createControlClickHandler=function(n){var t=n.view.graph;return mxUtils.bind(this,function(i){if(this.forceControlClickHandler||t.isEnabled()){var r=!t.isCellCollapsed(n.cell);t.foldCells(r,!1,[n.cell],null,i);mxEvent.consume(i)}})};mxCellRenderer.prototype.initControl=function(n,t,i,r){var u=n.view.graph,o=u.isHtmlLabel(n.cell)&&mxClient.NO_FO&&u.dialect==mxConstants.DIALECT_SVG,f,e;return o?(t.dialect=mxConstants.DIALECT_PREFERHTML,t.init(u.container),t.node.style.zIndex=1):t.init(n.view.getOverlayPane()),f=t.innerNode||t.node,r==null||mxClient.IS_IOS||(u.isEnabled()&&(f.style.cursor="pointer"),mxEvent.addListener(f,"click",r)),i&&(e=null,mxEvent.addGestureListeners(f,function(t){e=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t));u.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t,n));mxEvent.consume(t)},function(t){u.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,n))},function(t){u.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t,n));mxEvent.consume(t)}),r!=null&&mxClient.IS_IOS&&f.addEventListener("touchend",function(n){if(e!=null){var t=u.tolerance;Math.abs(e.x-mxEvent.getClientX(n))<t&&Math.abs(e.y-mxEvent.getClientY(n))<t&&(r.call(r,n),mxEvent.consume(n))}},!0)),f};mxCellRenderer.prototype.isShapeEvent=function(){return!0};mxCellRenderer.prototype.isLabelEvent=function(){return!0};mxCellRenderer.prototype.installListeners=function(n){var t=n.view.graph,i=function(i){var r=n;if(t.dialect!=mxConstants.DIALECT_SVG&&mxEvent.getSource(i).nodeName=="IMG"||mxClient.IS_TOUCH){var f=mxEvent.getClientX(i),e=mxEvent.getClientY(i),u=mxUtils.convertPoint(t.container,f,e);r=t.view.getState(t.getCellAt(u.x,u.y))}return r};mxEvent.addGestureListeners(n.shape.node,mxUtils.bind(this,function(i){this.isShapeEvent(n,i)&&t.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(i,n))}),mxUtils.bind(this,function(r){this.isShapeEvent(n,r)&&t.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(r,i(r)))}),mxUtils.bind(this,function(r){this.isShapeEvent(n,r)&&t.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(r,i(r)))}));t.nativeDblClickEnabled&&mxEvent.addListener(n.shape.node,"dblclick",mxUtils.bind(this,function(i){this.isShapeEvent(n,i)&&(t.dblClick(i,n.cell),mxEvent.consume(i))}))};mxCellRenderer.prototype.redrawLabel=function(n,t){var f=n.view.graph,i=this.getLabelValue(n),e=f.isWrapping(n.cell),o=f.isLabelClipped(n.cell),l=n.view.graph.isHtmlLabel(n.cell)||i!=null&&mxUtils.isNode(i),s=l?mxConstants.DIALECT_STRICTHTML:n.view.graph.dialect,h=n.style[mxConstants.STYLE_OVERFLOW]||"visible",r,u,c;n.text!=null&&(n.text.wrap!=e||n.text.clipped!=o||n.text.overflow!=h||n.text.dialect!=s)&&(n.text.destroy(),n.text=null);n.text==null&&i!=null&&(mxUtils.isNode(i)||i.length>0)?this.createLabel(n,i):n.text!=null&&(i==null||i.length==0)&&(n.text.destroy(),n.text=null);n.text!=null&&(t&&(n.text.lastValue!=null&&this.isTextShapeInvalid(n,n.text)&&(n.text.lastValue=null),n.text.resetStyles(),n.text.apply(n),n.text.valign=f.getVerticalAlign(n)),r=this.getLabelBounds(n),u=this.getTextScale(n),(t||n.text.value!=i||n.text.isWrapping!=e||n.text.overflow!=h||n.text.isClipping!=o||n.text.scale!=u||n.text.dialect!=s||!n.text.bounds.equals(r))&&(n.text.bounds.width!=0&&n.unscaledWidth!=null&&Math.round(n.text.bounds.width/n.text.scale*u-r.width)!=0&&(n.unscaledWidth=null),n.text.dialect=s,n.text.value=i,n.text.bounds=r,n.text.scale=u,n.text.wrap=e,n.text.clipped=o,n.text.overflow=h,c=n.text.node.style.visibility,this.redrawLabelShape(n.text),n.text.node.style.visibility=c))};mxCellRenderer.prototype.isTextShapeInvalid=function(n,t){function i(i,r,u){return result=r=="spacingTop"||r=="spacingRight"||r=="spacingBottom"||r=="spacingLeft"?parseFloat(t[i])-parseFloat(t.spacing)!=(n.style[r]||u):t[i]!=(n.style[r]||u)}return i("fontStyle",mxConstants.STYLE_FONTSTYLE,mxConstants.DEFAULT_FONTSTYLE)||i("family",mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY)||i("size",mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)||i("color",mxConstants.STYLE_FONTCOLOR,"black")||i("align",mxConstants.STYLE_ALIGN,"")||i("valign",mxConstants.STYLE_VERTICAL_ALIGN,"")||i("spacing",mxConstants.STYLE_SPACING,2)||i("spacingTop",mxConstants.STYLE_SPACING_TOP,0)||i("spacingRight",mxConstants.STYLE_SPACING_RIGHT,0)||i("spacingBottom",mxConstants.STYLE_SPACING_BOTTOM,0)||i("spacingLeft",mxConstants.STYLE_SPACING_LEFT,0)||i("horizontal",mxConstants.STYLE_HORIZONTAL,!0)||i("background",mxConstants.STYLE_LABEL_BACKGROUNDCOLOR)||i("border",mxConstants.STYLE_LABEL_BORDERCOLOR)||i("opacity",mxConstants.STYLE_TEXT_OPACITY,100)||i("textDirection",mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION)};mxCellRenderer.prototype.redrawLabelShape=function(n){n.redraw()};mxCellRenderer.prototype.getTextScale=function(n){return n.view.scale};mxCellRenderer.prototype.getLabelBounds=function(n){var h=n.view.graph,i=n.view.scale,c=h.getModel().isEdge(n.cell),t=new mxRectangle(n.absoluteOffset.x,n.absoluteOffset.y),f,r,e,o,u,y,p,s;if(c)f=n.text.getSpacing(),t.x+=f.x*i,t.y+=f.y*i,r=h.getCellGeometry(n.cell),r!=null&&(t.width=Math.max(0,r.width*i),t.height=Math.max(0,r.height*i));else if(n.text.isPaintBoundsInverted()&&(u=t.x,t.x=t.y,t.y=u),t.x+=n.x,t.y+=n.y,t.width=Math.max(1,n.width),t.height=Math.max(1,n.height),e=mxUtils.getValue(n.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE),e!=mxConstants.NONE&&e!=""){var l=parseFloat(mxUtils.getValue(n.style,mxConstants.STYLE_STROKEWIDTH,1))*i,a=1+Math.floor((l-1)/2),v=Math.floor(l+1);t.x+=a;t.y+=a;t.width-=v;t.height-=v}return n.text.isPaintBoundsInverted()&&(o=(n.width-n.height)/2,t.x+=o,t.y-=o,u=t.width,t.width=t.height,t.height=u),n.shape!=null&&(y=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),p=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),y==mxConstants.ALIGN_CENTER&&p==mxConstants.ALIGN_MIDDLE&&(t=n.shape.getLabelBounds(t))),s=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_WIDTH,null),s!=null&&(t.width=parseFloat(s)*i),c||this.rotateLabelBounds(n,t),t};mxCellRenderer.prototype.rotateLabelBounds=function(n,t){var i,r,u,f,e,o;if(t.y-=n.text.margin.y*t.height,t.x-=n.text.margin.x*t.width,!this.legacySpacing||n.style[mxConstants.STYLE_OVERFLOW]!="fill"&&n.style[mxConstants.STYLE_OVERFLOW]!="width"){i=n.view.scale;r=n.text.getSpacing();t.x+=r.x*i;t.y+=r.y*i;var s=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),h=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE),c=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_WIDTH,null);t.width=Math.max(0,t.width-(s==mxConstants.ALIGN_CENTER&&c==null?n.text.spacingLeft*i+n.text.spacingRight*i:0));t.height=Math.max(0,t.height-(h==mxConstants.ALIGN_MIDDLE?n.text.spacingTop*i+n.text.spacingBottom*i:0))}u=n.text.getTextRotation();u!=0&&n!=null&&n.view.graph.model.isVertex(n.cell)&&(f=n.getCenterX(),e=n.getCenterY(),(t.x!=f||t.y!=e)&&(o=u*(Math.PI/180),pt=mxUtils.getRotatedPoint(new mxPoint(t.x,t.y),Math.cos(o),Math.sin(o),new mxPoint(f,e)),t.x=pt.x,t.y=pt.y))};mxCellRenderer.prototype.redrawCellOverlays=function(n,t){if(this.createCellOverlays(n),n.overlays!=null){var i=mxUtils.mod(mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION,0),90),r=mxUtils.toRadians(i),u=Math.cos(r),f=Math.sin(r);n.overlays.visit(function(r,e){var o=e.overlay.getBounds(n);if(!n.view.graph.getModel().isEdge(n.cell)&&n.shape!=null&&i!=0){var s=o.getCenterX(),h=o.getCenterY(),c=mxUtils.getRotatedPoint(new mxPoint(s,h),u,f,new mxPoint(n.getCenterX(),n.getCenterY()));s=c.x;h=c.y;o.x=Math.round(s-o.width/2);o.y=Math.round(h-o.height/2)}(t||e.bounds==null||e.scale!=n.view.scale||!e.bounds.equals(o))&&(e.bounds=o,e.scale=n.view.scale,e.redraw())})}};mxCellRenderer.prototype.redrawControl=function(n,t){var i=n.view.graph.getFoldingImage(n);if(n.control!=null&&i!=null){var r=this.getControlBounds(n,i.width,i.height),u=this.legacyControlPosition?mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION,0):n.shape.getTextRotation(),f=n.view.scale;(t||n.control.scale!=f||!n.control.bounds.equals(r)||n.control.rotation!=u)&&(n.control.rotation=u,n.control.bounds=r,n.control.scale=f,n.control.redraw())}};mxCellRenderer.prototype.getControlBounds=function(n,t,i){var e,o;if(n.control!=null){var r=n.view.scale,u=n.getCenterX(),f=n.getCenterY();if(!n.view.graph.getModel().isEdge(n.cell)&&(u=n.x+t*r,f=n.y+i*r,n.shape!=null&&(e=n.shape.getShapeRotation(),this.legacyControlPosition?e=mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION,0):n.shape.isPaintBoundsInverted()&&(o=(n.width-n.height)/2,u+=o,f-=o),e!=0))){var s=mxUtils.toRadians(e),c=Math.cos(s),l=Math.sin(s),h=mxUtils.getRotatedPoint(new mxPoint(u,f),c,l,new mxPoint(n.getCenterX(),n.getCenterY()));u=h.x;f=h.y}return n.view.graph.getModel().isEdge(n.cell)?new mxRectangle(Math.round(u-t/2*r),Math.round(f-i/2*r),Math.round(t*r),Math.round(i*r)):new mxRectangle(Math.round(u-t/2*r),Math.round(f-i/2*r),Math.round(t*r),Math.round(i*r))}return null};mxCellRenderer.prototype.insertStateAfter=function(n,t,i){for(var o,e,f,u=this.getShapesForState(n),r=0;r<u.length;r++)if(u[r]!=null&&u[r].node!=null){if(o=u[r].node.parentNode!=n.view.getDrawPane()&&u[r].node.parentNode!=n.view.getOverlayPane(),e=o?i:t,e!=null&&e.nextSibling!=u[r].node)e.nextSibling==null?e.parentNode.appendChild(u[r].node):e.parentNode.insertBefore(u[r].node,e.nextSibling);else if(e==null)if(u[r].node.parentNode==n.view.graph.container){for(f=n.view.canvas;f!=null&&f.parentNode!=n.view.graph.container;)f=f.parentNode;f!=null&&f.nextSibling!=null?f.nextSibling!=u[r].node&&u[r].node.parentNode.insertBefore(u[r].node,f.nextSibling):u[r].node.parentNode.appendChild(u[r].node)}else u[r].node.parentNode.firstChild!=null&&u[r].node.parentNode.firstChild!=u[r].node&&u[r].node.parentNode.insertBefore(u[r].node,u[r].node.parentNode.firstChild);o?i=u[r].node:t=u[r].node}return[t,i]};mxCellRenderer.prototype.getShapesForState=function(n){return[n.shape,n.text,n.control]};mxCellRenderer.prototype.redraw=function(n,t,i){var r=this.redrawShape(n,t,i);n.shape!=null&&(i==null||i)&&(this.redrawLabel(n,r),this.redrawCellOverlays(n,r),this.redrawControl(n,r))};mxCellRenderer.prototype.redrawShape=function(n,t,i){var r=n.view.graph.model,u=!1;return n.shape!=null&&n.shape.style!=null&&n.style!=null&&n.shape.style[mxConstants.STYLE_SHAPE]!=n.style[mxConstants.STYLE_SHAPE]&&(n.shape.destroy(),n.shape=null),n.shape==null&&n.view.graph.container!=null&&n.cell!=n.view.currentRoot&&(r.isVertex(n.cell)||r.isEdge(n.cell))?(n.shape=this.createShape(n),n.shape!=null&&(n.shape.antiAlias=this.antiAlias,this.createIndicatorShape(n),this.initializeShape(n),this.createCellOverlays(n),this.installListeners(n),n.view.graph.selectionCellsHandler.updateHandler(n))):t||n.shape==null||mxUtils.equalEntries(n.shape.style,n.style)&&!this.checkPlaceholderStyles(n)||(n.shape.resetStyles(),this.configureShape(n),n.view.graph.selectionCellsHandler.updateHandler(n),t=!0),n.shape!=null&&(this.createControl(n),(t||this.isShapeInvalid(n,n.shape))&&(n.absolutePoints!=null?(n.shape.points=n.absolutePoints.slice(),n.shape.bounds=null):(n.shape.points=null,n.shape.bounds=new mxRectangle(n.x,n.y,n.width,n.height)),n.shape.scale=n.view.scale,i==null||i?this.doRedrawShape(n):n.shape.updateBoundingBox(),u=!0)),u};mxCellRenderer.prototype.doRedrawShape=function(n){n.shape.redraw()};mxCellRenderer.prototype.isShapeInvalid=function(n,t){return t.bounds==null||t.scale!=n.view.scale||n.absolutePoints==null&&!t.bounds.equals(n)||n.absolutePoints!=null&&!mxUtils.equalPoints(t.points,n.absolutePoints)};mxCellRenderer.prototype.destroy=function(n){n.shape!=null&&(n.text!=null&&(n.text.destroy(),n.text=null),n.overlays!=null&&(n.overlays.visit(function(n,t){t.destroy()}),n.overlays=null),n.control!=null&&(n.control.destroy(),n.control=null),n.shape.destroy(),n.shape=null)};mxEdgeStyle={EntityRelation:function(n,t,i,r,u){var h=n.view,ut=h.graph,v=mxUtils.getValue(n.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*h.scale,y=n.absolutePoints,p=y[0],w=y[y.length-1],f=!1,b,o,e,k,s,it,rt;if(p!=null)t=new mxCellState,t.x=p.x,t.y=p.y;else if(t!=null)e=mxUtils.getPortConstraints(t,n,!0,mxConstants.DIRECTION_MASK_NONE),e!=mxConstants.DIRECTION_MASK_NONE&&e!=mxConstants.DIRECTION_MASK_WEST+mxConstants.DIRECTION_MASK_EAST?f=e==mxConstants.DIRECTION_MASK_WEST:(b=ut.getCellGeometry(t.cell),b.relative?f=b.x<=.5:i!=null&&(f=i.x+i.width<t.x));else return;if(o=!0,w!=null?(i=new mxCellState,i.x=w.x,i.y=w.y):i!=null&&(e=mxUtils.getPortConstraints(i,n,!1,mxConstants.DIRECTION_MASK_NONE),e!=mxConstants.DIRECTION_MASK_NONE&&e!=mxConstants.DIRECTION_MASK_WEST+mxConstants.DIRECTION_MASK_EAST?o=e==mxConstants.DIRECTION_MASK_WEST:(k=ut.getCellGeometry(i.cell),k.relative?o=k.x<=.5:t!=null&&(o=t.x+t.width<i.x))),t!=null&&i!=null){var d=f?t.x:t.x+t.width,c=h.getRoutingCenterY(t),g=o?i.x:i.x+i.width,nt=h.getRoutingCenterY(i),l=v,tt=f?-l:l,a=new mxPoint(d+tt,c);tt=o?-l:l;s=new mxPoint(g+tt,nt);f==o?(it=f?Math.min(d,g)-v:Math.max(d,g)+v,u.push(new mxPoint(it,c)),u.push(new mxPoint(it,nt))):a.x<s.x==f?(rt=c+(nt-c)/2,u.push(a),u.push(new mxPoint(a.x,rt)),u.push(new mxPoint(s.x,rt)),u.push(s)):(u.push(a),u.push(s))}},Loop:function(n,t,i,r,u){var v=n.absolutePoints,p=v[0],w=v[v.length-1],a,f;if(p!=null&&w!=null){if(r!=null&&r.length>0)for(a=0;a<r.length;a++)f=r[a],f=n.view.transformControlPoint(n,f),u.push(new mxPoint(f.x,f.y));return}if(t!=null){var h=n.view,b=h.graph,f=r!=null&&r.length>0?r[0]:null;f!=null&&(f=h.transformControlPoint(n,f),mxUtils.contains(t,f.x,f.y)&&(f=null));var o=0,c=0,s=0,e=0,y=mxUtils.getValue(n.style,mxConstants.STYLE_SEGMENT,b.gridSize)*h.scale,l=mxUtils.getValue(n.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST);l==mxConstants.DIRECTION_NORTH||l==mxConstants.DIRECTION_SOUTH?(o=h.getRoutingCenterX(t),c=y):(s=h.getRoutingCenterY(t),e=y);f==null||f.x<t.x||f.x>t.x+t.width?f!=null?(o=f.x,e=Math.max(Math.abs(s-f.y),e)):l==mxConstants.DIRECTION_NORTH?s=t.y-2*c:l==mxConstants.DIRECTION_SOUTH?s=t.y+t.height+2*c:o=l==mxConstants.DIRECTION_EAST?t.x-2*e:t.x+t.width+2*e:f!=null&&(o=h.getRoutingCenterX(t),c=Math.max(Math.abs(o-f.x),e),s=f.y,e=0);u.push(new mxPoint(o-c,s-e));u.push(new mxPoint(o+c,s+e))}},ElbowConnector:function(n,t,i,r,u){var f=r!=null&&r.length>0?r[0]:null,e=!1,o=!1,s,h,c,l;if(t!=null&&i!=null)if(f!=null){var s=Math.min(t.x,i.x),h=Math.max(t.x+t.width,i.x+i.width),c=Math.min(t.y,i.y),l=Math.max(t.y+t.height,i.y+i.height);f=n.view.transformControlPoint(n,f);e=f.y<c||f.y>l;o=f.x<s||f.x>h}else s=Math.max(t.x,i.x),h=Math.min(t.x+t.width,i.x+i.width),e=s==h,e||(c=Math.max(t.y,i.y),l=Math.min(t.y+t.height,i.y+i.height),o=c==l);!o&&(e||n.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)?mxEdgeStyle.TopToBottom(n,t,i,r,u):mxEdgeStyle.SideToSide(n,t,i,r,u)},SideToSide:function(n,t,i,r,u){var h=n.view,f=r!=null&&r.length>0?r[0]:null,c=n.absolutePoints,l=c[0],a=c[c.length-1],v,p;if(f!=null&&(f=h.transformControlPoint(n,f)),l!=null&&(t=new mxCellState,t.x=l.x,t.y=l.y),a!=null&&(i=new mxCellState,i.x=a.x,i.y=a.y),t!=null&&i!=null){var w=Math.max(t.x,i.x),y=Math.min(t.x+t.width,i.x+i.width),e=f!=null?f.x:Math.round(y+(w-y)/2),o=h.getRoutingCenterY(t),s=h.getRoutingCenterY(i);f!=null&&(f.y>=t.y&&f.y<=t.y+t.height&&(o=f.y),f.y>=i.y&&f.y<=i.y+i.height&&(s=f.y));mxUtils.contains(i,e,o)||mxUtils.contains(t,e,o)||u.push(new mxPoint(e,o));mxUtils.contains(i,e,s)||mxUtils.contains(t,e,s)||u.push(new mxPoint(e,s));u.length==1&&(f!=null?mxUtils.contains(i,e,f.y)||mxUtils.contains(t,e,f.y)||u.push(new mxPoint(e,f.y)):(v=Math.max(t.y,i.y),p=Math.min(t.y+t.height,i.y+i.height),u.push(new mxPoint(e,v+(p-v)/2))))}},TopToBottom:function(n,t,i,r,u){var s=n.view,f=r!=null&&r.length>0?r[0]:null,h=n.absolutePoints,c=h[0],l=h[h.length-1],e,a,y;if(f!=null&&(f=s.transformControlPoint(n,f)),c!=null&&(t=new mxCellState,t.x=c.x,t.y=c.y),l!=null&&(i=new mxCellState,i.x=l.x,i.y=l.y),t!=null&&i!=null){var p=Math.max(t.y,i.y),v=Math.min(t.y+t.height,i.y+i.height),o=s.getRoutingCenterX(t);f!=null&&f.x>=t.x&&f.x<=t.x+t.width&&(o=f.x);e=f!=null?f.y:Math.round(v+(p-v)/2);mxUtils.contains(i,o,e)||mxUtils.contains(t,o,e)||u.push(new mxPoint(o,e));o=f!=null&&f.x>=i.x&&f.x<=i.x+i.width?f.x:s.getRoutingCenterX(i);mxUtils.contains(i,o,e)||mxUtils.contains(t,o,e)||u.push(new mxPoint(o,e));u.length==1&&(f!=null&&u.length==1?mxUtils.contains(i,f.x,e)||mxUtils.contains(t,f.x,e)||u.push(new mxPoint(f.x,e)):(a=Math.max(t.x,i.x),y=Math.min(t.x+t.width,i.x+i.width),u.push(new mxPoint(a+(y-a)/2,e))))}},SegmentConnector:function(n,t,i,r,u){function k(n){return(b==null||Math.abs(b.x-n.x)>=y||Math.abs(b.y-n.y)>=y)&&(u.push(n),b=n),b}var o=n.absolutePoints,y=Math.max(1,n.view.scale),b=u.length>0?u[0]:null,l=!0,e=null,f=o[0],a,g,p,c,h;if(f==null&&t!=null?f=new mxPoint(n.view.getRoutingCenterX(t),n.view.getRoutingCenterY(t)):f!=null&&(f=f.clone()),f.x=Math.round(f.x),f.y=Math.round(f.y),a=o.length-1,r!=null&&r.length>0){for(g=[],h=0;h<r.length;h++)p=n.view.transformControlPoint(n,r[h]),p!=null&&(p.x=Math.round(p.x),p.y=Math.round(p.y),g.push(p));if(g.length==0)return;r=g;f!=null&&r[0]!=null&&(Math.abs(r[0].x-f.x)<y&&(r[0].x=f.x),Math.abs(r[0].y-f.y)<y&&(r[0].y=f.y));c=o[a];c!=null&&r[r.length-1]!=null&&(Math.abs(r[r.length-1].x-c.x)<y&&(r[r.length-1].x=c.x),Math.abs(r[r.length-1].y-c.y)<y&&(r[r.length-1].y=c.y));e=r[0];var v=t,s=o[0],d=!1,nt=!1,w=e;for(s!=null&&(s.x=Math.round(s.x),s.y=Math.round(s.y),v=null),h=0;h<2;h++){var tt=s!=null&&s.x==w.x,it=s!=null&&s.y==w.y,rt=v!=null&&w.y>=v.y&&w.y<=v.y+v.height,ut=v!=null&&w.x>=v.x&&w.x<=v.x+v.width;if(d=it||s==null&&rt,nt=tt||s==null&&ut,h!=0||!(d&&nt||tt&&it)){if(s!=null&&!it&&!tt&&(rt||ut)){l=rt?!1:!0;break}if(nt||d){l=d;h==1&&(l=r.length%2==0?d:nt);break}}v=i;s=o[a];s!=null&&(s.x=Math.round(s.x),s.y=Math.round(s.y),v=null);w=r[r.length-1];tt&&it&&(r=r.slice(1))}for(l&&(o[0]!=null&&o[0].y!=e.y||o[0]==null&&t!=null&&(e.y<t.y||e.y>t.y+t.height))?k(new mxPoint(f.x,e.y)):!l&&(o[0]!=null&&o[0].x!=e.x||o[0]==null&&t!=null&&(e.x<t.x||e.x>t.x+t.width))&&k(new mxPoint(e.x,f.y)),l?f.y=e.y:f.x=e.x,h=0;h<r.length;h++)l=!l,e=r[h],l?f.y=e.y:f.x=e.x,k(f.clone())}else e=f,l=!0;if(f=o[a],f==null&&i!=null&&(f=new mxPoint(n.view.getRoutingCenterX(i),n.view.getRoutingCenterY(i))),f!=null&&(f.x=Math.round(f.x),f.y=Math.round(f.y),e!=null&&(l&&(o[a]!=null&&o[a].y!=e.y||o[a]==null&&i!=null&&(e.y<i.y||e.y>i.y+i.height))?k(new mxPoint(f.x,e.y)):!l&&(o[a]!=null&&o[a].x!=e.x||o[a]==null&&i!=null&&(e.x<i.x||e.x>i.x+i.width))&&k(new mxPoint(e.x,f.y)))),o[0]==null&&t!=null)while(u.length>1&&u[1]!=null&&mxUtils.contains(t,u[1].x,u[1].y))u.splice(1,1);if(o[a]==null&&i!=null)while(u.length>1&&u[u.length-1]!=null&&mxUtils.contains(i,u[u.length-1].x,u[u.length-1].y))u.splice(u.length-1,1);c!=null&&u[u.length-1]!=null&&Math.abs(c.x-u[u.length-1].x)<y&&Math.abs(c.y-u[u.length-1].y)<y&&(u.splice(u.length-1,1),u[u.length-1]!=null&&(Math.abs(u[u.length-1].x-c.x)<y&&(u[u.length-1].x=c.x),Math.abs(u[u.length-1].y-c.y)<y&&(u[u.length-1].y=c.y)))},orthBuffer:10,orthPointsFallback:!0,dirVectors:[[-1,0],[0,-1],[1,0],[0,1],[-1,0],[0,-1],[1,0]],wayPoints1:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],routePatterns:[[[513,2308,2081,2562],[513,1090,514,2184,2114,2561],[513,1090,514,2564,2184,2562],[513,2308,2561,1090,514,2568,2308]],[[514,1057,513,2308,2081,2562],[514,2184,2114,2561],[514,2184,2562,1057,513,2564,2184],[514,1057,513,2568,2308,2561]],[[1090,514,1057,513,2308,2081,2562],[2114,2561],[1090,2562,1057,513,2564,2184],[1090,514,1057,513,2308,2561,2568]],[[2081,2562],[1057,513,1090,514,2184,2114,2561],[1057,513,1090,514,2184,2562,2564],[1057,2561,1090,514,2568,2308]]],inlineRoutePatterns:[[null,[2114,2568],null,null],[null,[514,2081,2114,2568],null,null],[null,[2114,2561],null,null],[[2081,2562],[1057,2114,2568],[2184,2562],null]],vertexSeperations:[],limits:[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],LEFT_MASK:32,TOP_MASK:64,RIGHT_MASK:128,BOTTOM_MASK:256,LEFT:1,TOP:2,RIGHT:4,BOTTOM:8,SIDE_MASK:480,CENTER_MASK:512,SOURCE_MASK:1024,TARGET_MASK:2048,VERTEX_MASK:3072,getJettySize:function(n,t,i,r,u){var f=mxUtils.getValue(n.style,u?mxConstants.STYLE_SOURCE_JETTY_SIZE:mxConstants.STYLE_TARGET_JETTY_SIZE,mxUtils.getValue(n.style,mxConstants.STYLE_JETTY_SIZE,mxEdgeStyle.orthBuffer)),e,o;return f=="auto"&&(e=mxUtils.getValue(n.style,u?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW,mxConstants.NONE),e!=mxConstants.NONE?(o=mxUtils.getNumber(n.style,u?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE),f=Math.max(2,Math.ceil((o+mxEdgeStyle.orthBuffer)/mxEdgeStyle.orthBuffer))*mxEdgeStyle.orthBuffer):f=2*mxEdgeStyle.orthBuffer),f},OrthConnector:function(n,t,i,r,u){var pi=n.view.graph,ir=t==null?!1:pi.getModel().isEdge(t.cell),rr=i==null?!1:pi.getModel().isEdge(i.cell),hi=n.absolutePoints,ot=hi[0],st=hi[hi.length-1],ct=t!=null?t.x:ot.x,lt=t!=null?t.y:ot.y,at=t!=null?t.width:0,vt=t!=null?t.height:0,yt=i!=null?i.x:st.x,pt=i!=null?i.y:st.y,wt=i!=null?i.width:0,bt=i!=null?i.height:0,k=n.view.scale*mxEdgeStyle.getJettySize(n,t,i,r,!0),kt=n.view.scale*mxEdgeStyle.getJettySize(n,t,i,r,!1),nt,ci,dt,gt,s,tt,p,y,b,ni,ti,rt,ai,d,ft,oi,si,g,di,vi,gi,yi,f,nr,tr,w;if(t!=null&&i==t&&(kt=Math.max(k,kt),k=kt),nt=kt+k,ci=!1,ot!=null&&st!=null&&(dt=st.x-ot.x,gt=st.y-ot.y,ci=dt*dt+gt*gt<nt*nt),ci||mxEdgeStyle.orthPointsFallback&&r!=null&&r.length>0||ir||rr){mxEdgeStyle.SegmentConnector(n,t,i,r,u);return}s=[mxConstants.DIRECTION_MASK_ALL,mxConstants.DIRECTION_MASK_ALL];tt=0;t!=null&&(s[0]=mxUtils.getPortConstraints(t,n,!0,mxConstants.DIRECTION_MASK_ALL),tt=mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0),tt!=0&&(p=mxUtils.getBoundingBox(new mxRectangle(ct,lt,at,vt),tt),ct=p.x,lt=p.y,at=p.width,vt=p.height));i!=null&&(s[1]=mxUtils.getPortConstraints(i,n,!1,mxConstants.DIRECTION_MASK_ALL),tt=mxUtils.getValue(i.style,mxConstants.STYLE_ROTATION,0),tt!=0&&(p=mxUtils.getBoundingBox(new mxRectangle(yt,pt,wt,bt),tt),yt=p.x,pt=p.y,wt=p.width,bt=p.height));ct=Math.round(ct*10)/10;lt=Math.round(lt*10)/10;at=Math.round(at*10)/10;vt=Math.round(vt*10)/10;yt=Math.round(yt*10)/10;pt=Math.round(pt*10)/10;wt=Math.round(wt*10)/10;bt=Math.round(bt*10)/10;var v=[0,0],e=[[ct,lt,at,vt],[yt,pt,wt,bt]],ii=[k,kt];for(f=0;f<2;f++)mxEdgeStyle.limits[f][1]=e[f][0]-ii[f],mxEdgeStyle.limits[f][2]=e[f][1]-ii[f],mxEdgeStyle.limits[f][4]=e[f][0]+e[f][2]+ii[f],mxEdgeStyle.limits[f][8]=e[f][1]+e[f][3]+ii[f];var ur=e[0][0]+e[0][2]/2,fr=e[0][1]+e[0][3]/2,er=e[1][0]+e[1][2]/2,or=e[1][1]+e[1][3]/2,dt=ur-er,gt=fr-or,it=0;for(dt<0?it=gt<0?2:1:gt<=0&&(it=3,dt==0&&(it=2)),y=null,t!=null&&(y=ot),b=[[.5,.5],[.5,.5]],f=0;f<2;f++)y!=null&&(b[f][0]=(y.x-e[f][0])/e[f][2],Math.abs(y.x-e[f][0])<=1?v[f]=mxConstants.DIRECTION_MASK_WEST:Math.abs(y.x-e[f][0]-e[f][2])<=1&&(v[f]=mxConstants.DIRECTION_MASK_EAST),b[f][1]=(y.y-e[f][1])/e[f][3],Math.abs(y.y-e[f][1])<=1?v[f]=mxConstants.DIRECTION_MASK_NORTH:Math.abs(y.y-e[f][1]-e[f][3])<=1&&(v[f]=mxConstants.DIRECTION_MASK_SOUTH)),y=null,i!=null&&(y=st);var ri=e[0][1]-(e[1][1]+e[1][3]),ui=e[0][0]-(e[1][0]+e[1][2]),fi=e[1][1]-(e[0][1]+e[0][3]),ei=e[1][0]-(e[0][0]+e[0][2]);mxEdgeStyle.vertexSeperations[1]=Math.max(ui-nt,0);mxEdgeStyle.vertexSeperations[2]=Math.max(ri-nt,0);mxEdgeStyle.vertexSeperations[4]=Math.max(fi-nt,0);mxEdgeStyle.vertexSeperations[3]=Math.max(ei-nt,0);var a=[],c=[],l=[];c[0]=ui>=ei?mxConstants.DIRECTION_MASK_WEST:mxConstants.DIRECTION_MASK_EAST;l[0]=ri>=fi?mxConstants.DIRECTION_MASK_NORTH:mxConstants.DIRECTION_MASK_SOUTH;c[1]=mxUtils.reversePortConstraints(c[0]);l[1]=mxUtils.reversePortConstraints(l[0]);var wi=ui>=ei?ui:ei,bi=ri>=fi?ri:fi,o=[[0,0],[0,0]],ht=!1;for(f=0;f<2;f++)v[f]==0&&((c[f]&s[f])==0&&(c[f]=mxUtils.reversePortConstraints(c[f])),(l[f]&s[f])==0&&(l[f]=mxUtils.reversePortConstraints(l[f])),o[f][0]=l[f],o[f][1]=c[f]);for(bi>0&&wi>0&&((c[0]&s[0])>0&&(l[1]&s[1])>0?(o[0][0]=c[0],o[0][1]=l[0],o[1][0]=l[1],o[1][1]=c[1],ht=!0):(l[0]&s[0])>0&&(c[1]&s[1])>0&&(o[0][0]=l[0],o[0][1]=c[0],o[1][0]=c[1],o[1][1]=l[1],ht=!0)),bi>0&&!ht&&(o[0][0]=l[0],o[0][1]=c[0],o[1][0]=l[1],o[1][1]=c[1],ht=!0),wi>0&&!ht&&(o[0][0]=c[0],o[0][1]=l[0],o[1][0]=c[1],o[1][1]=l[1],ht=!0),f=0;f<2;f++)v[f]==0&&((o[f][0]&s[f])==0&&(o[f][0]=o[f][1]),a[f]=o[f][0]&s[f],a[f]|=(o[f][1]&s[f])<<8,a[f]|=(o[1-f][f]&s[f])<<16,a[f]|=(o[1-f][1-f]&s[f])<<24,(a[f]&15)==0&&(a[f]=a[f]<<8),(a[f]&3840)==0&&(a[f]=a[f]&15|a[f]>>8),(a[f]&983040)==0&&(a[f]=a[f]&65535|(a[f]&251658240)>>8),v[f]=a[f]&15,(s[f]==mxConstants.DIRECTION_MASK_WEST||s[f]==mxConstants.DIRECTION_MASK_NORTH||s[f]==mxConstants.DIRECTION_MASK_EAST||s[f]==mxConstants.DIRECTION_MASK_SOUTH)&&(v[f]=s[f]));ni=v[0]==mxConstants.DIRECTION_MASK_EAST?3:v[0];ti=v[1]==mxConstants.DIRECTION_MASK_EAST?3:v[1];ni-=it;ti-=it;ni<1&&(ni+=4);ti<1&&(ti+=4);rt=mxEdgeStyle.routePatterns[ni-1][ti-1];mxEdgeStyle.wayPoints1[0][0]=e[0][0];mxEdgeStyle.wayPoints1[0][1]=e[0][1];switch(v[0]){case mxConstants.DIRECTION_MASK_WEST:mxEdgeStyle.wayPoints1[0][0]-=k;mxEdgeStyle.wayPoints1[0][1]+=b[0][1]*e[0][3];break;case mxConstants.DIRECTION_MASK_SOUTH:mxEdgeStyle.wayPoints1[0][0]+=b[0][0]*e[0][2];mxEdgeStyle.wayPoints1[0][1]+=e[0][3]+k;break;case mxConstants.DIRECTION_MASK_EAST:mxEdgeStyle.wayPoints1[0][0]+=e[0][2]+k;mxEdgeStyle.wayPoints1[0][1]+=b[0][1]*e[0][3];break;case mxConstants.DIRECTION_MASK_NORTH:mxEdgeStyle.wayPoints1[0][0]+=b[0][0]*e[0][2];mxEdgeStyle.wayPoints1[0][1]-=k}var h=0,li=(v[0]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))>0?0:1,sr=li,ut=0;for(f=0;f<rt.length;f++){ai=rt[f]&15;d=ai==mxConstants.DIRECTION_MASK_EAST?3:ai;d+=it;d>4&&(d-=4);ft=mxEdgeStyle.dirVectors[d-1];ut=d%2>0?0:1;ut!=li&&(h++,mxEdgeStyle.wayPoints1[h][0]=mxEdgeStyle.wayPoints1[h-1][0],mxEdgeStyle.wayPoints1[h][1]=mxEdgeStyle.wayPoints1[h-1][1]);var hr=(rt[f]&mxEdgeStyle.TARGET_MASK)>0,ki=(rt[f]&mxEdgeStyle.SOURCE_MASK)>0,et=(rt[f]&mxEdgeStyle.SIDE_MASK)>>5;et=et<<it;et>15&&(et=et>>4);oi=(rt[f]&mxEdgeStyle.CENTER_MASK)>0;(ki||hr)&&et<9?(si=0,g=ki?0:1,si=oi&&ut==0?e[g][0]+b[g][0]*e[g][2]:oi?e[g][1]+b[g][1]*e[g][3]:mxEdgeStyle.limits[g][et],ut==0?(di=mxEdgeStyle.wayPoints1[h][0],vi=(si-di)*ft[0],vi>0&&(mxEdgeStyle.wayPoints1[h][0]+=ft[0]*vi)):(gi=mxEdgeStyle.wayPoints1[h][1],yi=(si-gi)*ft[1],yi>0&&(mxEdgeStyle.wayPoints1[h][1]+=ft[1]*yi))):oi&&(mxEdgeStyle.wayPoints1[h][0]+=ft[0]*Math.abs(mxEdgeStyle.vertexSeperations[d]/2),mxEdgeStyle.wayPoints1[h][1]+=ft[1]*Math.abs(mxEdgeStyle.vertexSeperations[d]/2));h>0&&mxEdgeStyle.wayPoints1[h][ut]==mxEdgeStyle.wayPoints1[h-1][ut]?h--:li=ut}for(f=0;f<=h;f++){if(f==h&&(nr=(v[1]&(mxConstants.DIRECTION_MASK_EAST|mxConstants.DIRECTION_MASK_WEST))>0?0:1,tr=nr==sr?0:1,tr!=(h+1)%2))break;u.push(new mxPoint(Math.round(mxEdgeStyle.wayPoints1[f][0]),Math.round(mxEdgeStyle.wayPoints1[f][1])))}for(w=1;w<u.length;)u[w-1]==null||u[w]==null||u[w-1].x!=u[w].x||u[w-1].y!=u[w].y?w++:u.splice(w,1)},getRoutePattern:function(n,t,i,r){var u=n[0]==mxConstants.DIRECTION_MASK_EAST?3:n[0],f=n[1]==mxConstants.DIRECTION_MASK_EAST?3:n[1],e;return u-=t,f-=t,u<1&&(u+=4),f<1&&(f+=4),e=routePatterns[u-1][f-1],(i==0||r==0)&&inlineRoutePatterns[u-1][f-1]!=null&&(e=inlineRoutePatterns[u-1][f-1]),e}};mxStyleRegistry={values:[],putValue:function(n,t){mxStyleRegistry.values[n]=t},getValue:function(n){return mxStyleRegistry.values[n]},getName:function(n){for(var t in mxStyleRegistry.values)if(mxStyleRegistry.values[t]==n)return t;return null}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ORTHOGONAL,mxEdgeStyle.OrthConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SEGMENT,mxEdgeStyle.SegmentConnector);mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_HEXAGON,mxPerimeter.HexagonPerimeter);mxGraphView.prototype=new mxEventSource;mxGraphView.prototype.constructor=mxGraphView;mxGraphView.prototype.EMPTY_POINT=new mxPoint;mxGraphView.prototype.doneResource=mxClient.language!="none"?"done":"";mxGraphView.prototype.updatingDocumentResource=mxClient.language!="none"?"updatingDocument":"";mxGraphView.prototype.allowEval=!1;mxGraphView.prototype.captureDocumentGesture=!0;mxGraphView.prototype.optimizeVmlReflows=!0;mxGraphView.prototype.rendering=!0;mxGraphView.prototype.graph=null;mxGraphView.prototype.currentRoot=null;mxGraphView.prototype.graphBounds=null;mxGraphView.prototype.scale=1;mxGraphView.prototype.translate=null;mxGraphView.prototype.states=null;mxGraphView.prototype.updateStyle=!1;mxGraphView.prototype.lastNode=null;mxGraphView.prototype.lastHtmlNode=null;mxGraphView.prototype.lastForegroundNode=null;mxGraphView.prototype.lastForegroundHtmlNode=null;mxGraphView.prototype.getGraphBounds=function(){return this.graphBounds};mxGraphView.prototype.setGraphBounds=function(n){this.graphBounds=n};mxGraphView.prototype.getBounds=function(n){var i=null,u,t,r;if(n!=null&&n.length>0)for(u=this.graph.getModel(),t=0;t<n.length;t++)(u.isVertex(n[t])||u.isEdge(n[t]))&&(r=this.getState(n[t]),r!=null&&(i==null?i=mxRectangle.fromRectangle(r):i.add(r)));return i};mxGraphView.prototype.setCurrentRoot=function(n){var t,i;return this.currentRoot!=n&&(t=new mxCurrentRootChange(this,n),t.execute(),i=new mxUndoableEdit(this,!1),i.add(t),this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",i)),this.graph.sizeDidChange()),n};mxGraphView.prototype.scaleAndTranslate=function(n,t,i){var r=this.scale,u=new mxPoint(this.translate.x,this.translate.y);(this.scale!=n||this.translate.x!=t||this.translate.y!=i)&&(this.scale=n,this.translate.x=t,this.translate.y=i,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange()));this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",n,"previousScale",r,"translate",this.translate,"previousTranslate",u))};mxGraphView.prototype.getScale=function(){return this.scale};mxGraphView.prototype.setScale=function(n){var t=this.scale;this.scale!=n&&(this.scale=n,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange()));this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",n,"previousScale",t))};mxGraphView.prototype.getTranslate=function(){return this.translate};mxGraphView.prototype.setTranslate=function(n,t){var i=new mxPoint(this.translate.x,this.translate.y);(this.translate.x!=n||this.translate.y!=t)&&(this.translate.x=n,this.translate.y=t,this.isEventsEnabled()&&(this.revalidate(),this.graph.sizeDidChange()));this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",i))};mxGraphView.prototype.refresh=function(){this.currentRoot!=null&&this.clear();this.revalidate()};mxGraphView.prototype.revalidate=function(){this.invalidate();this.validate()};mxGraphView.prototype.clear=function(n,t,i){var u=this.graph.getModel(),f,r;if(n=n||u.getRoot(),t=t!=null?t:!1,i=i!=null?i:!0,this.removeState(n),i&&(t||n!=this.currentRoot))for(f=u.getChildCount(n),r=0;r<f;r++)this.clear(u.getChildAt(n,r),t);else this.invalidate(n)};mxGraphView.prototype.invalidate=function(n,t,i){var u=this.graph.getModel(),f,e,o,s,r;if(n=n||u.getRoot(),t=t!=null?t:!0,i=i!=null?i:!0,f=this.getState(n),f!=null&&(f.invalid=!0),!n.invalidating){if(n.invalidating=!0,t)for(e=u.getChildCount(n),r=0;r<e;r++)o=u.getChildAt(n,r),this.invalidate(o,t,i);if(i)for(s=u.getEdgeCount(n),r=0;r<s;r++)this.invalidate(u.getEdgeAt(n,r),t,i);delete n.invalidating}};mxGraphView.prototype.validate=function(n){var r=mxLog.enter("mxGraphView.validate"),t,i;window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;this.resetValidationState();t=null;this.optimizeVmlReflows&&this.canvas!=null&&this.textDiv==null&&(document.documentMode==8&&!mxClient.IS_EM||mxClient.IS_QUIRKS)&&(this.placeholder=document.createElement("div"),this.placeholder.style.position="absolute",this.placeholder.style.width=this.canvas.clientWidth+"px",this.placeholder.style.height=this.canvas.clientHeight+"px",this.canvas.parentNode.appendChild(this.placeholder),t=this.drawPane.style.display,this.canvas.style.display="none",this.textDiv=document.createElement("div"),this.textDiv.style.position="absolute",this.textDiv.style.whiteSpace="nowrap",this.textDiv.style.visibility="hidden",this.textDiv.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",this.textDiv.style.zoom="1",document.body.appendChild(this.textDiv));i=this.getBoundingBox(this.validateCellState(this.validateCell(n||(this.currentRoot!=null?this.currentRoot:this.graph.getModel().getRoot()))));this.setGraphBounds(i!=null?i:this.getEmptyBounds());this.validateBackground();t!=null&&(this.canvas.style.display=t,this.textDiv.parentNode.removeChild(this.textDiv),this.placeholder!=null&&this.placeholder.parentNode.removeChild(this.placeholder),this.textDiv=null);this.resetValidationState();window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",r)};mxGraphView.prototype.getEmptyBounds=function(){return new mxRectangle(this.translate.x*this.scale,this.translate.y*this.scale)};mxGraphView.prototype.getBoundingBox=function(n,t){var i,f,e,r,u;if(t=t!=null?t:!0,i=null,n!=null&&(n.shape!=null&&n.shape.boundingBox!=null&&(i=n.shape.boundingBox.clone()),n.text!=null&&n.text.boundingBox!=null&&(i!=null?i.add(n.text.boundingBox):i=n.text.boundingBox.clone()),t))for(f=this.graph.getModel(),e=f.getChildCount(n.cell),r=0;r<e;r++)u=this.getBoundingBox(this.getState(f.getChildAt(n.cell,r))),u!=null&&(i==null?i=u:i.add(u));return i};mxGraphView.prototype.createBackgroundPageShape=function(n){return new mxRectangleShape(n,"white","black")};mxGraphView.prototype.validateBackground=function(){this.validateBackgroundImage();this.validateBackgroundPage()};mxGraphView.prototype.validateBackgroundImage=function(){var n=this.graph.getBackgroundImage(),t;n!=null?((this.backgroundImage==null||this.backgroundImage.image!=n.src)&&(this.backgroundImage!=null&&this.backgroundImage.destroy(),t=new mxRectangle(0,0,1,1),this.backgroundImage=new mxImageShape(t,n.src),this.backgroundImage.dialect=this.graph.dialect,this.backgroundImage.init(this.backgroundPane),this.backgroundImage.redraw(),document.documentMode!=8||mxClient.IS_EM||mxEvent.addGestureListeners(this.backgroundImage.node,mxUtils.bind(this,function(n){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n))}),mxUtils.bind(this,function(n){this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n))}),mxUtils.bind(this,function(n){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n))}))),this.redrawBackgroundImage(this.backgroundImage,n)):this.backgroundImage!=null&&(this.backgroundImage.destroy(),this.backgroundImage=null)};mxGraphView.prototype.validateBackgroundPage=function(){if(this.graph.pageVisible){var n=this.getBackgroundPageBounds();this.backgroundPageShape==null?(this.backgroundPageShape=this.createBackgroundPageShape(n),this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.isShadow=!0,this.backgroundPageShape.dialect=this.graph.dialect,this.backgroundPageShape.init(this.backgroundPane),this.backgroundPageShape.redraw(),this.graph.nativeDblClickEnabled&&mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(n){this.graph.dblClick(n)})),mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(n){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n))}),mxUtils.bind(this,function(n){this.graph.tooltipHandler!=null&&this.graph.tooltipHandler.isHideOnHover()&&this.graph.tooltipHandler.hide();this.graph.isMouseDown&&!mxEvent.isConsumed(n)&&this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n))}),mxUtils.bind(this,function(n){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n))}))):(this.backgroundPageShape.scale=this.scale,this.backgroundPageShape.bounds=n,this.backgroundPageShape.redraw())}else this.backgroundPageShape!=null&&(this.backgroundPageShape.destroy(),this.backgroundPageShape=null)};mxGraphView.prototype.getBackgroundPageBounds=function(){var n=this.graph.pageFormat,t=this.scale*this.graph.pageScale;return new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,n.width*t,n.height*t)};mxGraphView.prototype.redrawBackgroundImage=function(n,t){n.scale=this.scale;n.bounds.x=this.scale*this.translate.x;n.bounds.y=this.scale*this.translate.y;n.bounds.width=this.scale*t.width;n.bounds.height=this.scale*t.height;n.redraw()};mxGraphView.prototype.validateCell=function(n,t){var u,r,f,i;if(t=t!=null?t:!0,n!=null)if(t=t&&this.graph.isCellVisible(n),u=this.getState(n,t),u==null||t)for(r=this.graph.getModel(),f=r.getChildCount(n),i=0;i<f;i++)this.validateCell(r.getChildAt(n,i),t&&(!this.isCellCollapsed(n)||n==this.currentRoot));else this.removeState(n);return n};mxGraphView.prototype.validateCellState=function(n,t){var i,r,f,u;if(t=t!=null?t:!0,i=null,n!=null&&(i=this.getState(n),i!=null&&(r=this.graph.getModel(),i.invalid&&(i.invalid=!1,i.style==null&&(i.style=this.graph.getCellStyle(i.cell)),n!=this.currentRoot&&this.validateCellState(r.getParent(n),!1),i.setVisibleTerminalState(this.validateCellState(this.getVisibleTerminal(n,!0),!1),!0),i.setVisibleTerminalState(this.validateCellState(this.getVisibleTerminal(n,!1),!1),!1),this.updateCellState(i),n==this.currentRoot||i.invalid||(this.graph.cellRenderer.redraw(i,!1,this.isRendering()),i.updateCachedBounds())),t&&!i.invalid)))for(i.shape!=null&&this.stateValidated(i),f=r.getChildCount(n),u=0;u<f;u++)this.validateCellState(r.getChildAt(n,u));return i};mxGraphView.prototype.updateCellState=function(n){var u,i,r,t,f;n.absoluteOffset.x=0;n.absoluteOffset.y=0;n.origin.x=0;n.origin.y=0;n.length=0;n.cell!=this.currentRoot&&(u=this.graph.getModel(),i=this.getState(u.getParent(n.cell)),i!=null&&i.cell!=this.currentRoot&&(n.origin.x+=i.origin.x,n.origin.y+=i.origin.y),r=this.graph.getChildOffsetForCell(n.cell),r!=null&&(n.origin.x+=r.x,n.origin.y+=r.y),t=this.graph.getCellGeometry(n.cell),t!=null&&(u.isEdge(n.cell)||(r=t.offset||this.EMPTY_POINT,t.relative&&i!=null?u.isEdge(i.cell)?(f=this.getPoint(i,t),f!=null&&(n.origin.x+=f.x/this.scale-i.origin.x-this.translate.x,n.origin.y+=f.y/this.scale-i.origin.y-this.translate.y)):(n.origin.x+=t.x*i.width/this.scale+r.x,n.origin.y+=t.y*i.height/this.scale+r.y):(n.absoluteOffset.x=this.scale*r.x,n.absoluteOffset.y=this.scale*r.y,n.origin.x+=t.x,n.origin.y+=t.y)),n.x=this.scale*(this.translate.x+n.origin.x),n.y=this.scale*(this.translate.y+n.origin.y),n.width=this.scale*t.width,n.unscaledWidth=t.width,n.height=this.scale*t.height,u.isVertex(n.cell)&&this.updateVertexState(n,t),u.isEdge(n.cell)&&this.updateEdgeState(n,t)));n.updateCachedBounds()};mxGraphView.prototype.isCellCollapsed=function(n){return this.graph.isCellCollapsed(n)};mxGraphView.prototype.updateVertexState=function(n,t){var u=this.graph.getModel(),i=this.getState(u.getParent(n.cell)),r;if(t.relative&&i!=null&&!u.isEdge(i.cell)&&(r=mxUtils.toRadians(i.style[mxConstants.STYLE_ROTATION]||"0"),r!=0)){var e=Math.cos(r),o=Math.sin(r),s=new mxPoint(n.getCenterX(),n.getCenterY()),h=new mxPoint(i.getCenterX(),i.getCenterY()),f=mxUtils.getRotatedPoint(s,e,o,h);n.x=f.x-n.width/2;n.y=f.y-n.height/2}this.updateVertexLabelOffset(n)};mxGraphView.prototype.updateEdgeState=function(n,t){var r=n.getVisibleTerminalState(!0),u=n.getVisibleTerminalState(!1),i;this.graph.model.getTerminal(n.cell,!0)!=null&&r==null||r==null&&t.getTerminalPoint(!0)==null||this.graph.model.getTerminal(n.cell,!1)!=null&&u==null||u==null&&t.getTerminalPoint(!1)==null?this.clear(n.cell,!0):(this.updateFixedTerminalPoints(n,r,u),this.updatePoints(n,t.points,r,u),this.updateFloatingTerminalPoints(n,r,u),i=n.absolutePoints,n.cell!=this.currentRoot&&(i==null||i.length<2||i[0]==null||i[i.length-1]==null)?this.clear(n.cell,!0):(this.updateEdgeBounds(n),this.updateEdgeLabelOffset(n)))};mxGraphView.prototype.updateVertexLabelOffset=function(n){var r=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),t,u,i,f;r==mxConstants.ALIGN_LEFT?(t=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_WIDTH,null),t!=null?t*=this.scale:t=n.width,n.absoluteOffset.x-=t):r==mxConstants.ALIGN_RIGHT?n.absoluteOffset.x+=n.width:r==mxConstants.ALIGN_CENTER&&(t=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_WIDTH,null),t!=null&&(u=mxUtils.getValue(n.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),i=0,u==mxConstants.ALIGN_CENTER?i=.5:u==mxConstants.ALIGN_RIGHT&&(i=1),i!=0&&(n.absoluteOffset.x-=(t*this.scale-n.width)*i)));f=mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);f==mxConstants.ALIGN_TOP?n.absoluteOffset.y-=n.height:f==mxConstants.ALIGN_BOTTOM&&(n.absoluteOffset.y+=n.height)};mxGraphView.prototype.resetValidationState=function(){this.lastNode=null;this.lastHtmlNode=null;this.lastForegroundNode=null;this.lastForegroundHtmlNode=null};mxGraphView.prototype.stateValidated=function(n){var i=this.graph.getModel().isEdge(n.cell)&&this.graph.keepEdgesInForeground||this.graph.getModel().isVertex(n.cell)&&this.graph.keepEdgesInBackground,r=i?this.lastForegroundHtmlNode||this.lastHtmlNode:this.lastHtmlNode,u=i?this.lastForegroundNode||this.lastNode:this.lastNode,t=this.graph.cellRenderer.insertStateAfter(n,u,r);i?(this.lastForegroundHtmlNode=t[1],this.lastForegroundNode=t[0]):(this.lastHtmlNode=t[1],this.lastNode=t[0])};mxGraphView.prototype.updateFixedTerminalPoints=function(n,t,i){this.updateFixedTerminalPoint(n,t,!0,this.graph.getConnectionConstraint(n,t,!0));this.updateFixedTerminalPoint(n,i,!1,this.graph.getConnectionConstraint(n,i,!1))};mxGraphView.prototype.updateFixedTerminalPoint=function(n,t,i,r){n.setAbsoluteTerminalPoint(this.getFixedTerminalPoint(n,t,i,r),i)};mxGraphView.prototype.getFixedTerminalPoint=function(n,t,i,r){var u=null;if(r!=null&&(u=this.graph.getConnectionPoint(t,r)),u==null&&t==null){var f=this.scale,e=this.translate,o=n.origin,s=this.graph.getCellGeometry(n.cell);u=s.getTerminalPoint(i);u!=null&&(u=new mxPoint(f*(e.x+u.x+o.x),f*(e.y+u.y+o.y)))}return u};mxGraphView.prototype.updateBoundsFromStencil=function(n){var i=null,t;return n!=null&&n.shape!=null&&n.shape.stencil!=null&&n.shape.stencil.aspect=="fixed"&&(i=mxRectangle.fromRectangle(n),t=n.shape.stencil.computeAspect(n.style,n.x,n.y,n.width,n.height),n.setRect(t.x,t.y,n.shape.stencil.w0*t.width,n.shape.stencil.h0*t.height)),i};mxGraphView.prototype.updatePoints=function(n,t,i,r){var u,s,o,a,l;if(n!=null){if(u=[],u.push(n.absolutePoints[0]),s=this.getEdgeStyle(n,t,i,r),s!=null){var h=this.getTerminalPort(n,i,!0),c=this.getTerminalPort(n,r,!1),f=this.updateBoundsFromStencil(h),e=this.updateBoundsFromStencil(c);s(n,h,c,t,u);f!=null&&h.setRect(f.x,f.y,f.width,f.height);e!=null&&c.setRect(e.x,e.y,e.width,e.height)}else if(t!=null)for(o=0;o<t.length;o++)t[o]!=null&&(a=mxUtils.clone(t[o]),u.push(this.transformControlPoint(n,a)));l=n.absolutePoints;u.push(l[l.length-1]);n.absolutePoints=u}};mxGraphView.prototype.transformControlPoint=function(n,t){if(n!=null&&t!=null){var i=n.origin;return new mxPoint(this.scale*(t.x+this.translate.x+i.x),this.scale*(t.y+this.translate.y+i.y))}return null};mxGraphView.prototype.isLoopStyleEnabled=function(n,t,i,r){var u=this.graph.getConnectionConstraint(n,i,!0),f=this.graph.getConnectionConstraint(n,r,!1);return(t==null||t.length<2)&&(!mxUtils.getValue(n.style,mxConstants.STYLE_ORTHOGONAL_LOOP,!1)||(u==null||u.point==null)&&(f==null||f.point==null))?i!=null&&i==r:!1};mxGraphView.prototype.getEdgeStyle=function(n,t,i,r){var u=this.isLoopStyleEnabled(n,t,i,r)?mxUtils.getValue(n.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):mxUtils.getValue(n.style,mxConstants.STYLE_NOEDGESTYLE,!1)?null:n.style[mxConstants.STYLE_EDGE],f;return(typeof u=="string"&&(f=mxStyleRegistry.getValue(u),f==null&&this.isAllowEval()&&(f=mxUtils.eval(u)),u=f),typeof u=="function")?u:null};mxGraphView.prototype.updateFloatingTerminalPoints=function(n,t,i){var r=n.absolutePoints,u=r[0],f=r[r.length-1];f==null&&i!=null&&this.updateFloatingTerminalPoint(n,i,t,!1);u==null&&t!=null&&this.updateFloatingTerminalPoint(n,t,i,!0)};mxGraphView.prototype.updateFloatingTerminalPoint=function(n,t,i,r){n.setAbsoluteTerminalPoint(this.getFloatingTerminalPoint(n,t,i,r),r)};mxGraphView.prototype.getFloatingTerminalPoint=function(n,t,i,r){var h,o,f,e;t=this.getTerminalPort(n,t,r);var s=this.getNextPoint(n,i,r),l=this.graph.isOrthogonal(n),u=mxUtils.toRadians(Number(t.style[mxConstants.STYLE_ROTATION]||"0")),c=new mxPoint(t.getCenterX(),t.getCenterY());return u!=0&&(f=Math.cos(-u),e=Math.sin(-u),s=mxUtils.getRotatedPoint(s,f,e,c)),h=parseFloat(n.style[mxConstants.STYLE_PERIMETER_SPACING]||0),h+=parseFloat(n.style[r?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0),o=this.getPerimeterPoint(t,s,u==0&&l,h),u!=0&&(f=Math.cos(u),e=Math.sin(u),o=mxUtils.getRotatedPoint(o,f,e,c)),o};mxGraphView.prototype.getTerminalPort=function(n,t,i){var f=i?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT,u=mxUtils.getValue(n.style,f),r;return u!=null&&(r=this.getState(this.graph.getModel().getCell(u)),r!=null&&(t=r)),t};mxGraphView.prototype.getPerimeterPoint=function(n,t,i,r){var u=null,s,f,e,o;return n!=null&&(s=this.getPerimeterFunction(n),s!=null&&t!=null&&(f=this.getPerimeterBounds(n,r),(f.width>0||f.height>0)&&(u=new mxPoint(t.x,t.y),e=!1,o=!1,this.graph.model.isVertex(n.cell)&&(e=mxUtils.getValue(n.style,mxConstants.STYLE_FLIPH,0)==1,o=mxUtils.getValue(n.style,mxConstants.STYLE_FLIPV,0)==1,n.shape!=null&&n.shape.stencil!=null&&(e=mxUtils.getValue(n.style,"stencilFlipH",0)==1||e,o=mxUtils.getValue(n.style,"stencilFlipV",0)==1||o),e&&(u.x=2*f.getCenterX()-u.x),o&&(u.y=2*f.getCenterY()-u.y)),u=s(f,n,u,i),u!=null&&(e&&(u.x=2*f.getCenterX()-u.x),o&&(u.y=2*f.getCenterY()-u.y)))),u==null&&(u=this.getPoint(n))),u};mxGraphView.prototype.getRoutingCenterX=function(n){var t=n.style!=null?parseFloat(n.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return n.getCenterX()+t*n.width};mxGraphView.prototype.getRoutingCenterY=function(n){var t=n.style!=null?parseFloat(n.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return n.getCenterY()+t*n.height};mxGraphView.prototype.getPerimeterBounds=function(n,t){return t=t!=null?t:0,n!=null&&(t+=parseFloat(n.style[mxConstants.STYLE_PERIMETER_SPACING]||0)),n.getPerimeterBounds(t*this.scale)};mxGraphView.prototype.getPerimeterFunction=function(n){var t=n.style[mxConstants.STYLE_PERIMETER],i;return(typeof t=="string"&&(i=mxStyleRegistry.getValue(t),i==null&&this.isAllowEval()&&(i=mxUtils.eval(t)),t=i),typeof t=="function")?t:null};mxGraphView.prototype.getNextPoint=function(n,t,i){var r=n.absolutePoints,u=null,f;return r!=null&&r.length>=2&&(f=r.length,u=r[i?Math.min(1,f-1):Math.max(0,f-2)]),u==null&&t!=null&&(u=new mxPoint(t.getCenterX(),t.getCenterY())),u};mxGraphView.prototype.getVisibleTerminal=function(n,t){for(var u=this.graph.getModel(),i=u.getTerminal(n,t),r=i;i!=null&&i!=this.currentRoot;)(!this.graph.isCellVisible(r)||this.isCellCollapsed(i))&&(r=i),i=u.getParent(i);return u.getParent(r)==u.getRoot()&&(r=null),r};mxGraphView.prototype.updateEdgeBounds=function(n){var i=n.absolutePoints,r=i[0],h=i[i.length-1],u,f,c,s,v;r.x!=h.x||r.y!=h.y?(u=h.x-r.x,f=h.y-r.y,n.terminalDistance=Math.sqrt(u*u+f*f)):n.terminalDistance=0;var y=0,p=[],t=r;if(t!=null){var e=t.x,o=t.y,l=e,a=o;for(c=1;c<i.length;c++)if(s=i[c],s!=null){var u=t.x-s.x,f=t.y-s.y,w=Math.sqrt(u*u+f*f);p.push(w);y+=w;t=s;e=Math.min(t.x,e);o=Math.min(t.y,o);l=Math.max(t.x,l);a=Math.max(t.y,a)}n.length=y;n.segments=p;v=1;n.x=e;n.y=o;n.width=Math.max(v,l-e);n.height=Math.max(v,a-o)}};mxGraphView.prototype.getPoint=function(n,t){var e=n.getCenterX(),o=n.getCenterY(),r;if(n.segments!=null&&(t==null||t.relative)){for(var b=t!=null?t.x/2:0,k=n.absolutePoints.length,l=Math.round((b+.5)*n.length),i=n.segments[0],s=0,f=1;l>=Math.round(s+i)&&f<k-1;)s+=i,i=n.segments[f++];var a=i==0?0:(l-s)/i,u=n.absolutePoints[f-1],h=n.absolutePoints[f];if(u!=null&&h!=null){var c=0,v=0,y=0;t!=null&&(c=t.y,r=t.offset,r!=null&&(v=r.x,y=r.y));var p=h.x-u.x,w=h.y-u.y,d=i==0?0:w/i,g=i==0?0:p/i;e=u.x+p*a+(d*c+v)*this.scale;o=u.y+w*a-(g*c-y)*this.scale}}else t!=null&&(r=t.offset,r!=null&&(e+=r.x,o+=r.y));return new mxPoint(e,o)};mxGraphView.prototype.getRelativePoint=function(n,t,i){var et=this.graph.getModel(),k=et.getGeometry(n.cell),y,f,p,w,b,l,a,v,ft;if(k!=null&&(y=n.absolutePoints.length,k.relative&&y>1)){var d=n.length,g=n.segments,u=n.absolutePoints[0],r=n.absolutePoints[1],nt=mxUtils.ptSegDistSq(u.x,u.y,r.x,r.y,t,i),e=0,tt=0,it=0;for(f=2;f<y;f++)tt+=g[f-2],r=n.absolutePoints[f],p=mxUtils.ptSegDistSq(u.x,u.y,r.x,r.y,t,i),p<=nt&&(nt=p,e=f-1,it=tt),u=r;w=g[e];u=n.absolutePoints[e];r=n.absolutePoints[e+1];var ot=u.x,st=u.y,rt=r.x,ut=r.y,o=t,s=i,h=ot-rt,c=st-ut;return o-=rt,s-=ut,b=0,o=h-o,s=c-s,l=o*h+s*c,b=l<=0?0:l*l/(h*h+c*c),a=Math.sqrt(b),a>w&&(a=w),v=Math.sqrt(mxUtils.ptSegDistSq(u.x,u.y,r.x,r.y,t,i)),ft=mxUtils.relativeCcw(u.x,u.y,r.x,r.y,t,i),ft==-1&&(v=-v),new mxPoint((d/2-it-a)/d*-2,v/this.scale)}return new mxPoint};mxGraphView.prototype.updateEdgeLabelOffset=function(n){var i=n.absolutePoints,r,f,t,u,h,c;if(n.absoluteOffset.x=n.getCenterX(),n.absoluteOffset.y=n.getCenterY(),i!=null&&i.length>0&&n.segments!=null)if(r=this.graph.getCellGeometry(n.cell),r.relative)f=this.getPoint(n,r),f!=null&&(n.absoluteOffset=f);else if(t=i[0],u=i[i.length-1],t!=null&&u!=null){var l=u.x-t.x,a=u.y-t.y,o=0,s=0,e=r.offset;e!=null&&(o=e.x,s=e.y);h=t.x+l/2+o*this.scale;c=t.y+a/2+s*this.scale;n.absoluteOffset.x=h;n.absoluteOffset.y=c}};mxGraphView.prototype.getState=function(n,t){t=t||!1;var i=null;return n!=null&&(i=this.states.get(n),t&&(i==null||this.updateStyle)&&this.graph.isCellVisible(n)&&(i==null?(i=this.createState(n),this.states.put(n,i)):i.style=this.graph.getCellStyle(n))),i};mxGraphView.prototype.isRendering=function(){return this.rendering};mxGraphView.prototype.setRendering=function(n){this.rendering=n};mxGraphView.prototype.isAllowEval=function(){return this.allowEval};mxGraphView.prototype.setAllowEval=function(n){this.allowEval=n};mxGraphView.prototype.getStates=function(){return this.states};mxGraphView.prototype.setStates=function(n){this.states=n};mxGraphView.prototype.getCellStates=function(n){var i,t,r;if(n==null)return this.states;for(i=[],t=0;t<n.length;t++)r=this.getState(n[t]),r!=null&&i.push(r);return i};mxGraphView.prototype.removeState=function(n){var t=null;return n!=null&&(t=this.states.remove(n),t!=null&&(this.graph.cellRenderer.destroy(t),t.invalid=!0,t.destroy())),t};mxGraphView.prototype.createState=function(n){return new mxCellState(this,n,this.graph.getCellStyle(n))};mxGraphView.prototype.getCanvas=function(){return this.canvas};mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane};mxGraphView.prototype.getDrawPane=function(){return this.drawPane};mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane};mxGraphView.prototype.getDecoratorPane=function(){return this.decoratorPane};mxGraphView.prototype.isContainerEvent=function(n){var t=mxEvent.getSource(n);return t==this.graph.container||t.parentNode==this.backgroundPane||t.parentNode!=null&&t.parentNode.parentNode==this.backgroundPane||t==this.canvas.parentNode||t==this.canvas||t==this.backgroundPane||t==this.drawPane||t==this.overlayPane||t==this.decoratorPane};mxGraphView.prototype.isScrollEvent=function(n){var u=mxUtils.getOffset(this.graph.container),t=new mxPoint(n.clientX-u.x,n.clientY-u.y),f=this.graph.container.offsetWidth,e=this.graph.container.clientWidth,i,r;return f>e&&t.x>e+2&&t.x<=f?!0:(i=this.graph.container.offsetHeight,r=this.graph.container.clientHeight,i>r&&t.y>r+2&&t.y<=i)?!0:!1};mxGraphView.prototype.init=function(){this.installListeners();var n=this.graph;n.dialect==mxConstants.DIALECT_SVG?this.createSvg():n.dialect==mxConstants.DIALECT_VML?this.createVml():this.createHtml()};mxGraphView.prototype.installListeners=function(){var n=this.graph,t=n.container,i;t!=null&&(mxClient.IS_TOUCH&&(mxEvent.addListener(t,"gesturestart",mxUtils.bind(this,function(t){n.fireGestureEvent(t);mxEvent.consume(t)})),mxEvent.addListener(t,"gesturechange",mxUtils.bind(this,function(t){n.fireGestureEvent(t);mxEvent.consume(t)})),mxEvent.addListener(t,"gestureend",mxUtils.bind(this,function(t){n.fireGestureEvent(t);mxEvent.consume(t)}))),mxEvent.addGestureListeners(t,mxUtils.bind(this,function(t){!this.isContainerEvent(t)||(mxClient.IS_IE||mxClient.IS_IE11||mxClient.IS_GC||mxClient.IS_OP||mxClient.IS_SF)&&this.isScrollEvent(t)||n.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){this.isContainerEvent(t)&&n.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){this.isContainerEvent(t)&&n.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))})),mxEvent.addListener(t,"dblclick",mxUtils.bind(this,function(t){this.isContainerEvent(t)&&n.dblClick(t)})),i=function(i){var r=null;if(mxClient.IS_TOUCH){var f=mxEvent.getClientX(i),e=mxEvent.getClientY(i),u=mxUtils.convertPoint(t,f,e);r=n.view.getState(n.getCellAt(u.x,u.y))}return r},n.addMouseListener({mouseDown:function(){n.popupMenuHandler.hideMenu()},mouseMove:function(){},mouseUp:function(){}}),this.moveHandler=mxUtils.bind(this,function(t){n.tooltipHandler!=null&&n.tooltipHandler.isHideOnHover()&&n.tooltipHandler.hide();this.captureDocumentGesture&&n.isMouseDown&&n.container!=null&&!this.isContainerEvent(t)&&n.container.style.display!="none"&&n.container.style.visibility!="hidden"&&!mxEvent.isConsumed(t)&&n.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t,i(t)))}),this.endHandler=mxUtils.bind(this,function(t){this.captureDocumentGesture&&n.isMouseDown&&n.container!=null&&!this.isContainerEvent(t)&&n.container.style.display!="none"&&n.container.style.visibility!="hidden"&&n.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))}),mxEvent.addGestureListeners(document,null,this.moveHandler,this.endHandler))};mxGraphView.prototype.createHtml=function(){var n=this.graph.container,t;n!=null&&(this.canvas=this.createHtmlPane("100%","100%"),this.canvas.style.overflow="hidden",this.backgroundPane=this.createHtmlPane("1px","1px"),this.drawPane=this.createHtmlPane("1px","1px"),this.overlayPane=this.createHtmlPane("1px","1px"),this.decoratorPane=this.createHtmlPane("1px","1px"),this.canvas.appendChild(this.backgroundPane),this.canvas.appendChild(this.drawPane),this.canvas.appendChild(this.overlayPane),this.canvas.appendChild(this.decoratorPane),n.appendChild(this.canvas),this.updateContainerStyle(n),mxClient.IS_QUIRKS&&(t=mxUtils.bind(this,function(){var n=this.getGraphBounds(),t=n.x+n.width+this.graph.border,i=n.y+n.height+this.graph.border;this.updateHtmlCanvasSize(t,i)}),mxEvent.addListener(window,"resize",t)))};mxGraphView.prototype.updateHtmlCanvasSize=function(n,t){if(this.graph.container!=null){var i=this.graph.container.offsetWidth,r=this.graph.container.offsetHeight;this.canvas.style.width=i<n?n+"px":"100%";this.canvas.style.height=r<t?t+"px":"100%"}};mxGraphView.prototype.createHtmlPane=function(n,t){var i=document.createElement("DIV");return n!=null&&t!=null?(i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width=n,i.style.height=t):i.style.position="relative",i};mxGraphView.prototype.createVml=function(){var i=this.graph.container,n,t;i!=null&&(n=i.offsetWidth,t=i.offsetHeight,this.canvas=this.createVmlPane(n,t),this.canvas.style.overflow="hidden",this.backgroundPane=this.createVmlPane(n,t),this.drawPane=this.createVmlPane(n,t),this.overlayPane=this.createVmlPane(n,t),this.decoratorPane=this.createVmlPane(n,t),this.canvas.appendChild(this.backgroundPane),this.canvas.appendChild(this.drawPane),this.canvas.appendChild(this.overlayPane),this.canvas.appendChild(this.decoratorPane),i.appendChild(this.canvas))};mxGraphView.prototype.createVmlPane=function(n,t){var i=document.createElement(mxClient.VML_PREFIX+":group");return i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width=n+"px",i.style.height=t+"px",i.setAttribute("coordsize",n+","+t),i.setAttribute("coordorigin","0,0"),i};mxGraphView.prototype.createSvg=function(){var t=this.graph.container,n;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);this.decoratorPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.decoratorPane);n=document.createElementNS(mxConstants.NS_SVG,"svg");n.style.width="100%";n.style.height="100%";n.style.display="block";n.appendChild(this.canvas);(mxClient.IS_IE||mxClient.IS_IE11)&&(n.style.overflow="hidden");t!=null&&(t.appendChild(n),this.updateContainerStyle(t))};mxGraphView.prototype.updateContainerStyle=function(n){var t=mxUtils.getCurrentStyle(n);t!=null&&t.position=="static"&&(n.style.position="relative");mxClient.IS_POINTER&&(n.style.touchAction="none")};mxGraphView.prototype.destroy=function(){var n=this.canvas!=null?this.canvas.ownerSVGElement:null;n==null&&(n=this.canvas);n!=null&&n.parentNode!=null&&(this.clear(this.currentRoot,!0),mxEvent.removeGestureListeners(document,null,this.moveHandler,this.endHandler),mxEvent.release(this.graph.container),n.parentNode.removeChild(n),this.moveHandler=null,this.endHandler=null,this.canvas=null,this.backgroundPane=null,this.drawPane=null,this.overlayPane=null,this.decoratorPane=null)};mxCurrentRootChange.prototype.execute=function(){var i=this.view.currentRoot,n,t;this.view.currentRoot=this.previous;this.previous=i;n=this.view.graph.getTranslateForRoot(this.view.currentRoot);n!=null&&(this.view.translate=new mxPoint(-n.x,-n.y));this.isUp?(this.view.clear(this.view.currentRoot,!0),this.view.validate()):this.view.refresh();t=this.isUp?mxEvent.UP:mxEvent.DOWN;this.view.fireEvent(new mxEventObject(t,"root",this.view.currentRoot,"previous",this.previous));this.isUp=!this.isUp};mxLoadResources?mxResources.add(mxClient.basePath+"/resources/graph"):mxClient.defaultBundles.push(mxClient.basePath+"/resources/graph");mxGraph.prototype=new mxEventSource;mxGraph.prototype.constructor=mxGraph;mxGraph.prototype.EMPTY_ARRAY=[];mxGraph.prototype.mouseListeners=null;mxGraph.prototype.isMouseDown=!1;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selectionModel=null;mxGraph.prototype.cellEditor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=!0;mxGraph.prototype.portsEnabled=!0;mxGraph.prototype.nativeDblClickEnabled=!0;mxGraph.prototype.doubleTapEnabled=!0;mxGraph.prototype.doubleTapTimeout=500;mxGraph.prototype.doubleTapTolerance=25;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchY=0;mxGraph.prototype.lastTouchTime=0;mxGraph.prototype.tapAndHoldEnabled=!0;mxGraph.prototype.tapAndHoldDelay=500;mxGraph.prototype.tapAndHoldInProgress=!1;mxGraph.prototype.tapAndHoldValid=!1;mxGraph.prototype.initialTouchX=0;mxGraph.prototype.initialTouchY=0;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;mxGraph.prototype.pageVisible=!1;mxGraph.prototype.pageBreaksVisible=!1;mxGraph.prototype.pageBreakColor="gray";mxGraph.prototype.pageBreakDashed=!0;mxGraph.prototype.minPageBreakDist=20;mxGraph.prototype.preferPageSize=!1;mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;mxGraph.prototype.pageScale=1.5;mxGraph.prototype.enabled=!0;mxGraph.prototype.escapeEnabled=!0;mxGraph.prototype.invokesStopCellEditing=!0;mxGraph.prototype.enterStopsCellEditing=!1;mxGraph.prototype.useScrollbarsForPanning=!0;mxGraph.prototype.exportEnabled=!0;mxGraph.prototype.importEnabled=!0;mxGraph.prototype.cellsLocked=!1;mxGraph.prototype.cellsCloneable=!0;mxGraph.prototype.foldingEnabled=!0;mxGraph.prototype.cellsEditable=!0;mxGraph.prototype.cellsDeletable=!0;mxGraph.prototype.cellsMovable=!0;mxGraph.prototype.edgeLabelsMovable=!0;mxGraph.prototype.vertexLabelsMovable=!1;mxGraph.prototype.dropEnabled=!1;mxGraph.prototype.splitEnabled=!0;mxGraph.prototype.cellsResizable=!0;mxGraph.prototype.cellsBendable=!0;mxGraph.prototype.cellsSelectable=!0;mxGraph.prototype.cellsDisconnectable=!0;mxGraph.prototype.autoSizeCells=!1;mxGraph.prototype.autoSizeCellsOnAdd=!1;mxGraph.prototype.autoScroll=!0;mxGraph.prototype.ignoreScrollbars=!1;mxGraph.prototype.translateToScrollPosition=!1;mxGraph.prototype.timerAutoScroll=!1;mxGraph.prototype.allowAutoPanning=!1;mxGraph.prototype.autoExtend=!0;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumGraphSize=null;mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.resizeContainer=!1;mxGraph.prototype.border=0;mxGraph.prototype.keepEdgesInForeground=!1;mxGraph.prototype.keepEdgesInBackground=!1;mxGraph.prototype.allowNegativeCoordinates=!0;mxGraph.prototype.constrainChildren=!0;mxGraph.prototype.constrainRelativeChildren=!1;mxGraph.prototype.extendParents=!0;mxGraph.prototype.extendParentsOnAdd=!0;mxGraph.prototype.extendParentsOnMove=!1;mxGraph.prototype.recursiveResize=!1;mxGraph.prototype.collapseToPreferredSize=!0;mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=!1;mxGraph.prototype.centerZoom=!0;mxGraph.prototype.resetViewOnRootChange=!0;mxGraph.prototype.resetEdgesOnResize=!1;mxGraph.prototype.resetEdgesOnMove=!1;mxGraph.prototype.resetEdgesOnConnect=!0;mxGraph.prototype.allowLoops=!1;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=!0;mxGraph.prototype.connectableEdges=!1;mxGraph.prototype.allowDanglingEdges=!0;mxGraph.prototype.cloneInvalidEdges=!1;mxGraph.prototype.disconnectOnMove=!0;mxGraph.prototype.labelsVisible=!0;mxGraph.prototype.htmlLabels=!1;mxGraph.prototype.swimlaneSelectionEnabled=!0;mxGraph.prototype.swimlaneNesting=!0;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.imageBundles=null;mxGraph.prototype.minFitScale=.1;mxGraph.prototype.maxFitScale=8;mxGraph.prototype.panDx=0;mxGraph.prototype.panDy=0;mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+(mxClient.IS_MAC?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource=mxClient.language!="none"?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource=mxClient.language!="none"?"containsValidationErrors":"";mxGraph.prototype.collapseExpandResource=mxClient.language!="none"?"collapse-expand":"";mxGraph.prototype.init=function(n){this.container=n;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();mxEvent.addListener(n,"mouseleave",mxUtils.bind(this,function(){this.tooltipHandler!=null&&this.tooltipHandler.hide()}));mxClient.IS_IE&&(mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy()})),mxEvent.addListener(n,"selectstart",mxUtils.bind(this,function(n){return this.isEditing()||!this.isMouseDown&&!mxEvent.isShiftDown(n)})));document.documentMode==8&&n.insertAdjacentHTML("beforeend","<"+mxClient.VML_PREFIX+':group style="DISPLAY: none;"><\/'+mxClient.VML_PREFIX+":group>")};mxGraph.prototype.createHandlers=function(){this.tooltipHandler=this.createTooltipHandler();this.tooltipHandler.setEnabled(!1);this.selectionCellsHandler=this.createSelectionCellsHandler();this.connectionHandler=this.createConnectionHandler();this.connectionHandler.setEnabled(!1);this.graphHandler=this.createGraphHandler();this.panningHandler=this.createPanningHandler();this.panningHandler.panningEnabled=!1;this.popupMenuHandler=this.createPopupMenuHandler()};mxGraph.prototype.createTooltipHandler=function(){return new mxTooltipHandler(this)};mxGraph.prototype.createSelectionCellsHandler=function(){return new mxSelectionCellsHandler(this)};mxGraph.prototype.createConnectionHandler=function(){return new mxConnectionHandler(this)};mxGraph.prototype.createGraphHandler=function(){return new mxGraphHandler(this)};mxGraph.prototype.createPanningHandler=function(){return new mxPanningHandler(this)};mxGraph.prototype.createPopupMenuHandler=function(){return new mxPopupMenuHandler(this)};mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this)};mxGraph.prototype.createStylesheet=function(){return new mxStylesheet};mxGraph.prototype.createGraphView=function(){return new mxGraphView(this)};mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer};mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this)};mxGraph.prototype.getModel=function(){return this.model};mxGraph.prototype.getView=function(){return this.view};mxGraph.prototype.getStylesheet=function(){return this.stylesheet};mxGraph.prototype.setStylesheet=function(n){this.stylesheet=n};mxGraph.prototype.getSelectionModel=function(){return this.selectionModel};mxGraph.prototype.setSelectionModel=function(n){this.selectionModel=n};mxGraph.prototype.getSelectionCellsForChanges=function(n){for(var t,i,r=[],u=0;u<n.length;u++)t=n[u],t.constructor!=mxRootChange&&(i=null,t instanceof mxChildChange&&t.previous==null?i=t.child:t.cell!=null&&t.cell instanceof mxCell&&(i=t.cell),i!=null&&mxUtils.indexOf(r,i)<0&&r.push(i));return this.getModel().getTopmostCells(r)};mxGraph.prototype.graphModelChanged=function(n){for(var t=0;t<n.length;t++)this.processChange(n[t]);this.removeSelectionCells(this.getRemovedCellsForChanges(n));this.view.validate();this.sizeDidChange()};mxGraph.prototype.getRemovedCellsForChanges=function(n){for(var t,i=[],r=0;r<n.length;r++)if(t=n[r],t instanceof mxRootChange)break;else t instanceof mxChildChange?t.previous!=null&&t.parent==null&&(i=i.concat(this.model.getDescendants(t.child))):t instanceof mxVisibleChange&&(i=i.concat(this.model.getDescendants(t.cell)));return i};mxGraph.prototype.processChange=function(n){var t,i;n instanceof mxRootChange?(this.clearSelection(),this.setDefaultParent(null),this.removeStateForCell(n.previous),this.resetViewOnRootChange&&(this.view.scale=1,this.view.translate.x=0,this.view.translate.y=0),this.fireEvent(new mxEventObject(mxEvent.ROOT))):n instanceof mxChildChange?(t=this.model.getParent(n.child),this.view.invalidate(n.child,!0,!0),(t==null||this.isCellCollapsed(t))&&(this.view.invalidate(n.child,!0,!0),this.removeStateForCell(n.child),this.view.currentRoot==n.child&&this.home()),t!=n.previous&&(t!=null&&this.view.invalidate(t,!1,!1),n.previous!=null&&this.view.invalidate(n.previous,!1,!1))):n instanceof mxTerminalChange||n instanceof mxGeometryChange?(n instanceof mxTerminalChange||n.previous==null&&n.geometry!=null||n.previous!=null&&!n.previous.equals(n.geometry))&&this.view.invalidate(n.cell):n instanceof mxValueChange?this.view.invalidate(n.cell,!1,!1):n instanceof mxStyleChange?(this.view.invalidate(n.cell,!0,!0),i=this.view.getState(n.cell),i!=null&&(i.style=null)):n.cell!=null&&n.cell instanceof mxCell&&this.removeStateForCell(n.cell)};mxGraph.prototype.removeStateForCell=function(n){for(var i=this.model.getChildCount(n),t=0;t<i;t++)this.removeStateForCell(this.model.getChildAt(n,t));this.view.invalidate(n,!1,!0);this.view.removeState(n)};mxGraph.prototype.addCellOverlay=function(n,t){n.overlays==null&&(n.overlays=[]);n.overlays.push(t);var i=this.view.getState(n);return i!=null&&this.cellRenderer.redraw(i),this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",n,"overlay",t)),t};mxGraph.prototype.getCellOverlays=function(n){return n.overlays};mxGraph.prototype.removeCellOverlay=function(n,t){var i,r;return t==null?this.removeCellOverlays(n):(i=mxUtils.indexOf(n.overlays,t),i>=0?(n.overlays.splice(i,1),n.overlays.length==0&&(n.overlays=null),r=this.view.getState(n),r!=null&&this.cellRenderer.redraw(r),this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",n,"overlay",t))):t=null),t};mxGraph.prototype.removeCellOverlays=function(n){var t=n.overlays,r,i;if(t!=null)for(n.overlays=null,r=this.view.getState(n),r!=null&&this.cellRenderer.redraw(r),i=0;i<t.length;i++)this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",n,"overlay",t[i]));return t};mxGraph.prototype.clearCellOverlays=function(n){var i,t,r;for(n=n!=null?n:this.model.getRoot(),this.removeCellOverlays(n),i=this.model.getChildCount(n),t=0;t<i;t++)r=this.model.getChildAt(n,t),this.clearCellOverlays(r)};mxGraph.prototype.setCellWarning=function(n,t,i,r){if(t!=null&&t.length>0){i=i!=null?i:this.warningImage;var u=new mxCellOverlay(i,"<font color=red>"+t+"<\/font>");return r&&u.addListener(mxEvent.CLICK,mxUtils.bind(this,function(){this.isEnabled()&&this.setSelectionCell(n)})),this.addCellOverlay(n,u)}return this.removeCellOverlays(n),null};mxGraph.prototype.startEditing=function(n){this.startEditingAtCell(null,n)};mxGraph.prototype.startEditingAtCell=function(n,t){t!=null&&mxEvent.isMultiTouchEvent(t)||(n==null&&(n=this.getSelectionCell(),n==null||this.isCellEditable(n)||(n=null)),n!=null&&(this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",n,"event",t)),this.cellEditor.startEditing(n,t),this.fireEvent(new mxEventObject(mxEvent.EDITING_STARTED,"cell",n,"event",t))))};mxGraph.prototype.getEditingValue=function(n){return this.convertValueToString(n)};mxGraph.prototype.stopEditing=function(n){this.cellEditor.stopEditing(n);this.fireEvent(new mxEventObject(mxEvent.EDITING_STOPPED,"cancel",n))};mxGraph.prototype.labelChanged=function(n,t,i){this.model.beginUpdate();try{var r=n.value;this.cellLabelChanged(n,t,this.isAutoSizeCell(n));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",n,"value",t,"old",r,"event",i))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellLabelChanged=function(n,t,i){this.model.beginUpdate();try{this.model.setValue(n,t);i&&this.cellSizeUpdated(n,!1)}finally{this.model.endUpdate()}};mxGraph.prototype.escape=function(n){this.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",n))};mxGraph.prototype.click=function(n){var t=n.getEvent(),i=n.getCell(),f=new mxEventObject(mxEvent.CLICK,"event",t,"cell",i),r,e,u;n.isConsumed()&&f.consume();this.fireEvent(f);!this.isEnabled()||mxEvent.isConsumed(t)||f.isConsumed()||(i!=null?(this.isTransparentClickEvent(t)&&(r=!1,e=this.getCellAt(n.graphX,n.graphY,null,null,null,mxUtils.bind(this,function(n){var t=this.isCellSelected(n.cell);return r=r||t,!r||t})),e!=null&&(i=e)),this.selectCellForEvent(i,t)):(u=null,this.isSwimlaneSelectionEnabled()&&(u=this.getSwimlaneAt(n.getGraphX(),n.getGraphY())),u!=null?this.selectCellForEvent(u,t):this.isToggleEvent(t)||this.clearSelection()))};mxGraph.prototype.dblClick=function(n,t){var i=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",n,"cell",t);this.fireEvent(i);!this.isEnabled()||mxEvent.isConsumed(n)||i.isConsumed()||t==null||!this.isCellEditable(t)||this.isEditing(t)||(this.startEditingAtCell(t,n),mxEvent.consume(n))};mxGraph.prototype.tapAndHold=function(n){var r=n.getEvent(),i=new mxEventObject(mxEvent.TAP_AND_HOLD,"event",r,"cell",n.getCell()),t;this.fireEvent(i);i.isConsumed()&&(this.panningHandler.panningTrigger=!1);this.isEnabled()&&!mxEvent.isConsumed(r)&&!i.isConsumed()&&this.connectionHandler.isEnabled()&&(t=this.view.getState(this.connectionHandler.marker.getCell(n)),t!=null&&(this.connectionHandler.marker.currentColor=this.connectionHandler.marker.validColor,this.connectionHandler.marker.markedState=t,this.connectionHandler.marker.mark(),this.connectionHandler.first=new mxPoint(n.getGraphX(),n.getGraphY()),this.connectionHandler.edgeState=this.connectionHandler.createEdgeState(n),this.connectionHandler.previous=t,this.connectionHandler.fireEvent(new mxEventObject(mxEvent.START,"state",this.connectionHandler.previous))))};mxGraph.prototype.scrollPointToVisible=function(n,t,i,r){var u,f,h,e,o,s,l,c;!this.timerAutoScroll&&(this.ignoreScrollbars||mxUtils.hasScrollbars(this.container))?(u=this.container,r=r!=null?r:20,n>=u.scrollLeft&&t>=u.scrollTop&&n<=u.scrollLeft+u.clientWidth&&t<=u.scrollTop+u.clientHeight&&(f=u.scrollLeft+u.clientWidth-n,f<r?(o=u.scrollLeft,u.scrollLeft+=r-f,i&&o==u.scrollLeft&&(this.dialect==mxConstants.DIALECT_SVG?(s=this.view.getDrawPane().ownerSVGElement,h=this.container.scrollWidth+r-f,s.style.width=h+"px"):(h=Math.max(u.clientWidth,u.scrollWidth)+r-f,c=this.view.getCanvas(),c.style.width=h+"px"),u.scrollLeft+=r-f)):(f=n-u.scrollLeft,f<r&&(u.scrollLeft-=r-f)),e=u.scrollTop+u.clientHeight-t,e<r?(o=u.scrollTop,u.scrollTop+=r-e,o==u.scrollTop&&i&&(this.dialect==mxConstants.DIALECT_SVG?(s=this.view.getDrawPane().ownerSVGElement,l=this.container.scrollHeight+r-e,s.style.height=l+"px"):(l=Math.max(u.clientHeight,u.scrollHeight)+r-e,c=this.view.getCanvas(),c.style.height=l+"px"),u.scrollTop+=r-e)):(e=t-u.scrollTop,e<r&&(u.scrollTop-=r-e)))):this.allowAutoPanning&&!this.panningHandler.isActive()&&(this.panningManager==null&&(this.panningManager=this.createPanningManager()),this.panningManager.panTo(n+this.panDx,t+this.panDy))};mxGraph.prototype.createPanningManager=function(){return new mxPanningManager(this)};mxGraph.prototype.getBorderSizes=function(){var n=mxUtils.getCurrentStyle(this.container);return new mxRectangle(mxUtils.parseCssNumber(n.paddingLeft)+(n.borderLeftStyle!="none"?mxUtils.parseCssNumber(n.borderLeftWidth):0),mxUtils.parseCssNumber(n.paddingTop)+(n.borderTopStyle!="none"?mxUtils.parseCssNumber(n.borderTopWidth):0),mxUtils.parseCssNumber(n.paddingRight)+(n.borderRightStyle!="none"?mxUtils.parseCssNumber(n.borderRightWidth):0),mxUtils.parseCssNumber(n.paddingBottom)+(n.borderBottomStyle!="none"?mxUtils.parseCssNumber(n.borderBottomWidth):0))};mxGraph.prototype.getPreferredPageSize=function(n,t,i){var h=this.view.scale,u=this.view.translate,f=this.pageFormat,e=this.pageScale,r=new mxRectangle(0,0,Math.ceil(f.width*e),Math.ceil(f.height*e)),o=this.pageBreaksVisible?Math.ceil(t/r.width):1,s=this.pageBreaksVisible?Math.ceil(i/r.height):1;return new mxRectangle(0,0,o*r.width+2+u.x,s*r.height+2+u.y)};mxGraph.prototype.fit=function(n,t,i,r,u,f,e){var w,s,b,k,c;if(this.container!=null){n=n!=null?n:this.getBorder();t=t!=null?t:!1;i=i!=null?i:0;r=r!=null?r:!0;u=u!=null?u:!1;f=f!=null?f:!1;var l=this.getBorderSizes(),y=this.container.offsetWidth-l.x-l.width-1,p=e!=null?e:this.container.offsetHeight-l.y-l.height-1,o=this.view.getGraphBounds();if(o.width>0&&o.height>0){t&&o.x!=null&&o.y!=null&&(o=o.clone(),o.width+=o.x,o.height+=o.y,o.x=0,o.y=0);var h=this.view.scale,a=o.width/h,v=o.height/h;if(this.backgroundImage!=null&&(a=Math.max(a,this.backgroundImage.width-o.x/h),v=Math.max(v,this.backgroundImage.height-o.y/h)),w=(t?n:2*n)+i,y-=w,p-=w,s=u?p/v:f?y/a:Math.min(y/a,p/v),this.minFitScale!=null&&(s=Math.max(s,this.minFitScale)),this.maxFitScale!=null&&(s=Math.min(s,this.maxFitScale)),r)t?this.view.scale!=s&&this.view.setScale(s):mxUtils.hasScrollbars(this.container)?(this.view.setScale(s),c=this.getGraphBounds(),c.x!=null&&(this.container.scrollLeft=c.x),c.y!=null&&(this.container.scrollTop=c.y)):(b=o.x!=null?Math.floor(this.view.translate.x-o.x/h+n/s+i/2):n,k=o.y!=null?Math.floor(this.view.translate.y-o.y/h+n/s+i/2):n,this.view.scaleAndTranslate(s,b,k));else return s}}return this.view.scale};mxGraph.prototype.sizeDidChange=function(){var i=this.getGraphBounds(),u,r;if(this.container!=null){var f=this.getBorder(),n=Math.max(0,i.x+i.width+f),t=Math.max(0,i.y+i.height+f);this.minimumContainerSize!=null&&(n=Math.max(n,this.minimumContainerSize.width),t=Math.max(t,this.minimumContainerSize.height));this.resizeContainer&&this.doResizeContainer(n,t);(this.preferPageSize||!mxClient.IS_IE&&this.pageVisible)&&(u=this.getPreferredPageSize(i,Math.max(1,n),Math.max(1,t)),u!=null&&(n=u.width*this.view.scale,t=u.height*this.view.scale));this.minimumGraphSize!=null&&(n=Math.max(n,this.minimumGraphSize.width*this.view.scale),t=Math.max(t,this.minimumGraphSize.height*this.view.scale));n=Math.ceil(n);t=Math.ceil(t);this.dialect==mxConstants.DIALECT_SVG?(r=this.view.getDrawPane().ownerSVGElement,r.style.minWidth=Math.max(1,n)+"px",r.style.minHeight=Math.max(1,t)+"px",r.style.width="100%",r.style.height="100%"):mxClient.IS_QUIRKS?this.view.updateHtmlCanvasSize(Math.max(1,n),Math.max(1,t)):(this.view.canvas.style.minWidth=Math.max(1,n)+"px",this.view.canvas.style.minHeight=Math.max(1,t)+"px");this.updatePageBreaks(this.pageBreaksVisible,n,t)}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",i))};mxGraph.prototype.doResizeContainer=function(n,t){this.maximumContainerSize!=null&&(n=Math.min(this.maximumContainerSize.width,n),t=Math.min(this.maximumContainerSize.height,t));this.container.style.width=Math.ceil(n)+"px";this.container.style.height=Math.ceil(t)+"px"};mxGraph.prototype.updatePageBreaks=function(n){var r=this.view.scale,u=this.view.translate,s=this.pageFormat,h=r*this.pageScale,t=new mxRectangle(0,0,s.width*h,s.height*h),i=mxRectangle.fromRectangle(this.getGraphBounds()),o;i.width=Math.max(1,i.width);i.height=Math.max(1,i.height);t.x=Math.floor((i.x-u.x*r)/t.width)*t.width+u.x*r;t.y=Math.floor((i.y-u.y*r)/t.height)*t.height+u.y*r;i.width=Math.ceil((i.width+(i.x-t.x))/t.width)*t.width;i.height=Math.ceil((i.height+(i.y-t.y))/t.height)*t.height;n=n&&Math.min(t.width,t.height)>this.minPageBreakDist;var f=n?Math.ceil(i.height/t.height)+1:0,e=n?Math.ceil(i.width/t.width)+1:0,c=(e-1)*t.width,l=(f-1)*t.height;this.horizontalPageBreaks==null&&f>0&&(this.horizontalPageBreaks=[]);this.verticalPageBreaks==null&&e>0&&(this.verticalPageBreaks=[]);o=mxUtils.bind(this,function(n){var u,o,r,i;if(n!=null){for(u=n==this.horizontalPageBreaks?f:e,i=0;i<=u;i++)o=n==this.horizontalPageBreaks?[new mxPoint(Math.round(t.x),Math.round(t.y+i*t.height)),new mxPoint(Math.round(t.x+c),Math.round(t.y+i*t.height))]:[new mxPoint(Math.round(t.x+i*t.width),Math.round(t.y)),new mxPoint(Math.round(t.x+i*t.width),Math.round(t.y+l))],n[i]!=null?(n[i].points=o,n[i].redraw()):(r=new mxPolyline(o,this.pageBreakColor),r.dialect=this.dialect,r.pointerEvents=!1,r.isDashed=this.pageBreakDashed,r.init(this.view.backgroundPane),r.redraw(),n[i]=r);for(i=u;i<n.length;i++)n[i].destroy();n.splice(u,n.length-u)}});o(this.horizontalPageBreaks);o(this.verticalPageBreaks)};mxGraph.prototype.getCellStyle=function(n){var i=this.model.getStyle(n),t=null;return t=this.model.isEdge(n)?this.stylesheet.getDefaultEdgeStyle():this.stylesheet.getDefaultVertexStyle(),i!=null&&(t=this.postProcessCellStyle(this.stylesheet.getCellStyle(i,t))),t==null&&(t=mxGraph.prototype.EMPTY_ARRAY),t};mxGraph.prototype.postProcessCellStyle=function(n){var r,t,i;return n!=null&&(r=n[mxConstants.STYLE_IMAGE],t=this.getImageFromBundles(r),t!=null?n[mxConstants.STYLE_IMAGE]=t:t=r,t!=null&&t.substring(0,11)=="data:image/"&&(t.substring(0,20)=="data:image/svg+xml,<"?t=t.substring(0,19)+encodeURIComponent(t.substring(19)):t.substring(0,22)!="data:image/svg+xml,%3C"&&(i=t.indexOf(","),i>0&&t.substring(i-7,i+1)!=";base64,"&&(t=t.substring(0,i)+";base64,"+t.substring(i+1))),n[mxConstants.STYLE_IMAGE]=t)),n};mxGraph.prototype.setCellStyle=function(n,t){if(t=t||this.getSelectionCells(),t!=null){this.model.beginUpdate();try{for(var i=0;i<t.length;i++)this.model.setStyle(t[i],n)}finally{this.model.endUpdate()}}};mxGraph.prototype.toggleCellStyle=function(n,t,i){return i=i||this.getSelectionCell(),this.toggleCellStyles(n,t,[i])};mxGraph.prototype.toggleCellStyles=function(n,t,i){var r,u,f;return t=t!=null?t:!1,i=i||this.getSelectionCells(),r=null,i!=null&&i.length>0&&(u=this.view.getState(i[0]),f=u!=null?u.style:this.getCellStyle(i[0]),f!=null&&(r=mxUtils.getValue(f,n,t)?0:1,this.setCellStyles(n,r,i))),r};mxGraph.prototype.setCellStyles=function(n,t,i){i=i||this.getSelectionCells();mxUtils.setCellStyles(this.model,i,n,t)};mxGraph.prototype.toggleCellStyleFlags=function(n,t,i){this.setCellStyleFlags(n,t,null,i)};mxGraph.prototype.setCellStyleFlags=function(n,t,i,r){var u,f,e;r=r||this.getSelectionCells();r!=null&&r.length>0&&(i==null&&(u=this.view.getState(r[0]),f=u!=null?u.style:this.getCellStyle(r[0]),f!=null&&(e=parseInt(f[n]||0),i=!((e&t)==t))),mxUtils.setCellStyleFlags(this.model,r,n,t,i))};mxGraph.prototype.alignCells=function(n,t,i){var e,u,r,f;if(t==null&&(t=this.getSelectionCells()),t!=null&&t.length>1){if(i==null)for(u=0;u<t.length;u++)if(r=this.view.getState(t[u]),r!=null&&!this.model.isEdge(t[u]))if(i==null)if(n==mxConstants.ALIGN_CENTER){i=r.x+r.width/2;break}else if(n==mxConstants.ALIGN_RIGHT)i=r.x+r.width;else if(n==mxConstants.ALIGN_TOP)i=r.y;else if(n==mxConstants.ALIGN_MIDDLE){i=r.y+r.height/2;break}else i=n==mxConstants.ALIGN_BOTTOM?r.y+r.height:r.x;else i=n==mxConstants.ALIGN_RIGHT?Math.max(i,r.x+r.width):n==mxConstants.ALIGN_TOP?Math.min(i,r.y):n==mxConstants.ALIGN_BOTTOM?Math.max(i,r.y+r.height):Math.min(i,r.x);if(i!=null){e=this.view.scale;this.model.beginUpdate();try{for(u=0;u<t.length;u++)r=this.view.getState(t[u]),r!=null&&(f=this.getCellGeometry(t[u]),f==null||this.model.isEdge(t[u])||(f=f.clone(),n==mxConstants.ALIGN_CENTER?f.x+=(i-r.x-r.width/2)/e:n==mxConstants.ALIGN_RIGHT?f.x+=(i-r.x-r.width)/e:n==mxConstants.ALIGN_TOP?f.y+=(i-r.y)/e:n==mxConstants.ALIGN_MIDDLE?f.y+=(i-r.y-r.height/2)/e:n==mxConstants.ALIGN_BOTTOM?f.y+=(i-r.y-r.height)/e:f.x+=(i-r.x)/e,this.resizeCell(t[u],f)));this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",n,"cells",t))}finally{this.model.endUpdate()}}}return t};mxGraph.prototype.flipEdge=function(n){if(n!=null&&this.alternateEdgeStyle!=null){this.model.beginUpdate();try{var t=this.model.getStyle(n);t==null||t.length==0?this.model.setStyle(n,this.alternateEdgeStyle):this.model.setStyle(n,null);this.resetEdge(n);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",n))}finally{this.model.endUpdate()}}return n};mxGraph.prototype.addImageBundle=function(n){this.imageBundles.push(n)};mxGraph.prototype.removeImageBundle=function(n){for(var i=[],t=0;t<this.imageBundles.length;t++)this.imageBundles[t]!=n&&i.push(this.imageBundles[t]);this.imageBundles=i};mxGraph.prototype.getImageFromBundles=function(n){var t,i;if(n!=null)for(t=0;t<this.imageBundles.length;t++)if(i=this.imageBundles[t].getImage(n),i!=null)return i;return null};mxGraph.prototype.orderCells=function(n,t){t==null&&(t=mxUtils.sortCells(this.getSelectionCells(),!0));this.model.beginUpdate();try{this.cellsOrdered(t,n);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",n,"cells",t))}finally{this.model.endUpdate()}return t};mxGraph.prototype.cellsOrdered=function(n,t){var i,r;if(n!=null){this.model.beginUpdate();try{for(i=0;i<n.length;i++)r=this.model.getParent(n[i]),t?this.model.add(r,n[i],i):this.model.add(r,n[i],this.model.getChildCount(r)-1);this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",t,"cells",n))}finally{this.model.endUpdate()}}};mxGraph.prototype.groupCells=function(n,t,i){var r,u,f;if(i==null&&(i=mxUtils.sortCells(this.getSelectionCells(),!0)),i=this.getCellsForGroup(i),n==null&&(n=this.createGroupCell(i)),r=this.getBoundsForGroup(n,i,t),i.length>0&&r!=null){u=this.model.getParent(n);u==null&&(u=this.model.getParent(i[0]));this.model.beginUpdate();try{this.getCellGeometry(n)==null&&this.model.setGeometry(n,new mxGeometry);f=this.model.getChildCount(u);this.cellsAdded([n],u,f,null,null,!1,!1,!1);f=this.model.getChildCount(n);this.cellsAdded(i,n,f,null,null,!1,!1,!1);this.cellsMoved(i,-r.x,-r.y,!1,!1,!1);this.cellsResized([n],[r],!1);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",n,"border",t,"cells",i))}finally{this.model.endUpdate()}}return n};mxGraph.prototype.getCellsForGroup=function(n){var i=[],r,t;if(n!=null&&n.length>0)for(r=this.model.getParent(n[0]),i.push(n[0]),t=1;t<n.length;t++)this.model.getParent(n[t])==r&&i.push(n[t]);return i};mxGraph.prototype.getBoundsForGroup=function(n,t,i){var r=this.getBoundingBoxFromGeometry(t,!0),u;return r!=null&&(this.isSwimlane(n)&&(u=this.getStartSize(n),r.x-=u.width,r.y-=u.height,r.width+=u.width,r.height+=u.height),i!=null&&(r.x-=i,r.y-=i,r.width+=2*i,r.height+=2*i)),r};mxGraph.prototype.createGroupCell=function(){var n=new mxCell("");return n.setVertex(!0),n.setConnectable(!1),n};mxGraph.prototype.ungroupCells=function(n){var r=[],u,t,i,f,e;if(n==null){for(n=this.getSelectionCells(),u=[],t=0;t<n.length;t++)this.model.getChildCount(n[t])>0&&u.push(n[t]);n=u}if(n!=null&&n.length>0){this.model.beginUpdate();try{for(t=0;t<n.length;t++)i=this.model.getChildren(n[t]),i!=null&&i.length>0&&(i=i.slice(),f=this.model.getParent(n[t]),e=this.model.getChildCount(f),this.cellsAdded(i,f,e,null,null,!0),r=r.concat(i));this.removeCellsAfterUngroup(n);this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",n))}finally{this.model.endUpdate()}}return r};mxGraph.prototype.removeCellsAfterUngroup=function(n){this.cellsRemoved(this.addAllEdges(n))};mxGraph.prototype.removeCellsFromParent=function(n){n==null&&(n=this.getSelectionCells());this.model.beginUpdate();try{var t=this.getDefaultParent(),i=this.model.getChildCount(t);this.cellsAdded(n,t,i,null,null,!0);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",n))}finally{this.model.endUpdate()}return n};mxGraph.prototype.updateGroupBounds=function(n,t,i,r,u,f,e){var h,o,c,s,l,a,v;n==null&&(n=this.getSelectionCells());t=t!=null?t:0;i=i!=null?i:!1;r=r!=null?r:0;u=u!=null?u:0;f=f!=null?f:0;e=e!=null?e:0;this.model.beginUpdate();try{for(h=n.length-1;h>=0;h--)o=this.getCellGeometry(n[h]),o!=null&&(c=this.getChildCells(n[h]),c!=null&&c.length>0&&(s=this.getBoundingBoxFromGeometry(c,!0),s!=null&&s.width>0&&s.height>0&&(l=0,a=0,this.isSwimlane(n[h])&&(v=this.getStartSize(n[h]),l=v.width,a=v.height),o=o.clone(),i&&(o.x=Math.round(o.x+s.x-t-l-e),o.y=Math.round(o.y+s.y-t-a-r)),o.width=Math.round(s.width+2*t+l+e+u),o.height=Math.round(s.height+2*t+a+r+f),this.model.setGeometry(n[h],o),this.moveCells(c,t+l-s.x+e,t+a-s.y+r))))}finally{this.model.endUpdate()}return n};mxGraph.prototype.getBoundingBox=function(n){var i=null,t,r;if(n!=null&&n.length>0)for(t=0;t<n.length;t++)(this.model.isVertex(n[t])||this.model.isEdge(n[t]))&&(r=this.view.getBoundingBox(this.view.getState(n[t]),!0),r!=null&&(i==null?i=mxRectangle.fromRectangle(r):i.add(r)));return i};mxGraph.prototype.cloneCells=function(n,t,i){var u,v,p,h,c,r,f,w,y,b,k,e,o,s,d,l,a;if(t=t!=null?t:!0,u=null,n!=null){for(v=new mxDictionary,p=[],r=0;r<n.length;r++)v.put(n[r],!0),p.push(n[r]);if(p.length>0){for(h=this.view.scale,c=this.view.translate,u=this.model.cloneCells(n,!0,i),r=0;r<n.length;r++)if(!t&&this.model.isEdge(u[r])&&this.getEdgeValidationError(u[r],this.model.getTerminal(u[r],!0),this.model.getTerminal(u[r],!1))!=null)u[r]=null;else if(f=this.model.getGeometry(u[r]),f!=null&&(w=this.view.getState(n[r]),y=this.view.getState(this.model.getParent(n[r])),w!=null&&y!=null))if(b=y.origin.x,k=y.origin.y,this.model.isEdge(u[r])){for(e=w.absolutePoints,o=this.model.getTerminal(n[r],!0);o!=null&&!v.get(o);)o=this.model.getParent(o);for(o==null&&f.setTerminalPoint(new mxPoint(e[0].x/h-c.x,e[0].y/h-c.y),!0),s=this.model.getTerminal(n[r],!1);s!=null&&!v.get(s);)s=this.model.getParent(s);if(s==null&&(d=e.length-1,f.setTerminalPoint(new mxPoint(e[d].x/h-c.x,e[d].y/h-c.y),!1)),l=f.points,l!=null)for(a=0;a<l.length;a++)l[a].x+=b,l[a].y+=k}else f.translate(b,k)}else u=[]}return u};mxGraph.prototype.insertVertex=function(n,t,i,r,u,f,e,o,s){var h=this.createVertex(n,t,i,r,u,f,e,o,s);return this.addCell(h,n)};mxGraph.prototype.createVertex=function(n,t,i,r,u,f,e,o,s){var c=new mxGeometry(r,u,f,e),h;return c.relative=s!=null?s:!1,h=new mxCell(i,c,o),h.setId(t),h.setVertex(!0),h.setConnectable(!0),h};mxGraph.prototype.insertEdge=function(n,t,i,r,u,f){var e=this.createEdge(n,t,i,r,u,f);return this.addEdge(e,n,r,u)};mxGraph.prototype.createEdge=function(n,t,i,r,u,f){var e=new mxCell(i,new mxGeometry,f);return e.setId(t),e.setEdge(!0),e.geometry.relative=!0,e};mxGraph.prototype.addEdge=function(n,t,i,r,u){return this.addCell(n,t,u,i,r)};mxGraph.prototype.addCell=function(n,t,i,r,u){return this.addCells([n],t,i,r,u)[0]};mxGraph.prototype.addCells=function(n,t,i,r,u){t==null&&(t=this.getDefaultParent());i==null&&(i=this.model.getChildCount(t));this.model.beginUpdate();try{this.cellsAdded(n,t,i,r,u,!1,!0);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",n,"parent",t,"index",i,"source",r,"target",u))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellsAdded=function(n,t,i,r,u,f,e,o){var s,c,p,w;if(n!=null&&t!=null&&i!=null){this.model.beginUpdate();try{var a=f?this.view.getState(t):null,l=a!=null?a.origin:null,b=new mxPoint(0,0);for(s=0;s<n.length;s++)if(n[s]==null)i--;else{if(c=this.model.getParent(n[s]),l!=null&&n[s]!=t&&t!=c){var v=this.view.getState(c),y=v!=null?v.origin:b,h=this.model.getGeometry(n[s]);h!=null&&(p=y.x-l.x,w=y.y-l.y,h=h.clone(),h.translate(p,w),h.relative||!this.model.isVertex(n[s])||this.isAllowNegativeCoordinates()||(h.x=Math.max(0,h.x),h.y=Math.max(0,h.y)),this.model.setGeometry(n[s],h))}t==c&&i+s>this.model.getChildCount(t)&&i--;this.model.add(t,n[s],i+s);this.autoSizeCellsOnAdd&&this.autoSizeCell(n[s],!0);(o==null||o)&&this.isExtendParentsOnAdd(n[s])&&this.isExtendParent(n[s])&&this.extendParent(n[s]);(e==null||e)&&this.constrainChild(n[s]);r!=null&&this.cellConnected(n[s],r,!0);u!=null&&this.cellConnected(n[s],u,!1)}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",n,"parent",t,"index",i,"source",r,"target",u,"absolute",f))}finally{this.model.endUpdate()}}};mxGraph.prototype.autoSizeCell=function(n,t){var r,i;if(t=t!=null?t:!0,t)for(r=this.model.getChildCount(n),i=0;i<r;i++)this.autoSizeCell(this.model.getChildAt(n,i));this.getModel().isVertex(n)&&this.isAutoSizeCell(n)&&this.updateCellSize(n)};mxGraph.prototype.removeCells=function(n,t){t=t!=null?t:!0;n==null&&(n=this.getDeletableCells(this.getSelectionCells()));t&&(n=this.getDeletableCells(this.addAllEdges(n)));this.model.beginUpdate();try{this.cellsRemoved(n);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",n,"includeEdges",t))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellsRemoved=function(n){var u,f,e,t,r,o,i;if(n!=null&&n.length>0){u=this.view.scale;f=this.view.translate;this.model.beginUpdate();try{for(e=new mxDictionary,t=0;t<n.length;t++)e.put(n[t],!0);for(t=0;t<n.length;t++){for(r=this.getAllEdges([n[t]]),o=mxUtils.bind(this,function(e,o){var s=this.model.getGeometry(e),c,h,v,a,y;if(s!=null&&(c=this.view.getState(e),c!=null)){for(h=c.getVisibleTerminal(o),v=!1;h!=null;){if(n[t]==h){v=!0;break}h=this.model.getParent(h)}if(v){var p=f.x,w=f.y,l=this.view.getState(this.model.getParent(e));l!=null&&this.model.isVertex(l.cell)&&(p=l.x/u,w=l.y/u);s=s.clone();a=c.absolutePoints;y=o?0:a.length-1;s.setTerminalPoint(new mxPoint(a[y].x/u-p,a[y].y/u-w),o);this.model.setTerminal(r[i],null,o);this.model.setGeometry(r[i],s)}}}),i=0;i<r.length;i++)e.get(r[i])||(o(r[i],!0),o(r[i],!1));this.model.remove(n[t])}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",n))}finally{this.model.endUpdate()}}};mxGraph.prototype.splitEdge=function(n,t,i,r,u){var e,s,o,f;r=r||0;u=u||0;e=this.model.getParent(n);s=this.model.getTerminal(n,!0);this.model.beginUpdate();try{if(i==null&&(i=this.cloneCells([n])[0],o=this.view.getState(n),f=this.getCellGeometry(i),f!=null&&f.points!=null&&o!=null)){var h=this.view.translate,c=this.view.scale,l=mxUtils.findNearestSegment(o,(r+h.x)*c,(u+h.y)*c);f.points=f.points.slice(0,l);f=this.getCellGeometry(n);f!=null&&f.points!=null&&(f=f.clone(),f.points=f.points.slice(l),this.model.setGeometry(n,f))}this.cellsMoved(t,r,u,!1,!1);this.cellsAdded(t,e,this.model.getChildCount(e),null,null,!0);this.cellsAdded([i],e,this.model.getChildCount(e),s,t[0],!1);this.cellConnected(n,t[0],!0);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",n,"cells",t,"newEdge",i,"dx",r,"dy",u))}finally{this.model.endUpdate()}return i};mxGraph.prototype.toggleCells=function(n,t,i){t==null&&(t=this.getSelectionCells());i&&(t=this.addAllEdges(t));this.model.beginUpdate();try{this.cellsToggled(t,n);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",n,"cells",t,"includeEdges",i))}finally{this.model.endUpdate()}return t};mxGraph.prototype.cellsToggled=function(n,t){if(n!=null&&n.length>0){this.model.beginUpdate();try{for(var i=0;i<n.length;i++)this.model.setVisible(n[i],t)}finally{this.model.endUpdate()}}};mxGraph.prototype.foldCells=function(n,t,i,r){t=t!=null?t:!1;i==null&&(i=this.getFoldableCells(this.getSelectionCells(),n));this.stopEditing(!1);this.model.beginUpdate();try{this.cellsFolded(i,n,t,r);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",n,"recurse",t,"cells",i))}finally{this.model.endUpdate()}return i};mxGraph.prototype.cellsFolded=function(n,t,i,r){var u,f;if(n!=null&&n.length>0){this.model.beginUpdate();try{for(u=0;u<n.length;u++)(!r||this.isCellFoldable(n[u],t))&&t!=this.isCellCollapsed(n[u])&&(this.model.setCollapsed(n[u],t),this.swapBounds(n[u],t),this.isExtendParent(n[u])&&this.extendParent(n[u]),i&&(f=this.model.getChildren(n[u]),this.cellsFolded(f,t,i)),this.constrainChild(n[u]));this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",n,"collapse",t,"recurse",i))}finally{this.model.endUpdate()}}};mxGraph.prototype.swapBounds=function(n,t){if(n!=null){var i=this.model.getGeometry(n);i!=null&&(i=i.clone(),this.updateAlternateBounds(n,i,t),i.swap(),this.model.setGeometry(n,i))}};mxGraph.prototype.updateAlternateBounds=function(n,t){var u,f,i,e,o,r;if(n!=null&&t!=null&&(u=this.view.getState(n),f=u!=null?u.style:this.getCellStyle(n),t.alternateBounds==null&&(i=t,this.collapseToPreferredSize&&(e=this.getPreferredSizeForCell(n),e!=null&&(i=e,o=mxUtils.getValue(f,mxConstants.STYLE_STARTSIZE),o>0&&(i.height=Math.max(i.height,o)))),t.alternateBounds=new mxRectangle(0,0,i.width,i.height)),t.alternateBounds!=null&&(t.alternateBounds.x=t.x,t.alternateBounds.y=t.y,r=mxUtils.toRadians(f[mxConstants.STYLE_ROTATION]||0),r!=0))){var s=t.alternateBounds.getCenterX()-t.getCenterX(),h=t.alternateBounds.getCenterY()-t.getCenterY(),c=Math.cos(r),l=Math.sin(r),a=c*s-l*h,v=l*s+c*h;t.alternateBounds.x+=a-s;t.alternateBounds.y+=v-h}};mxGraph.prototype.addAllEdges=function(n){var t=n.slice();return mxUtils.removeDuplicates(t.concat(this.getAllEdges(n)))};mxGraph.prototype.getAllEdges=function(n){var i=[],t,u,r,f;if(n!=null)for(t=0;t<n.length;t++){for(u=this.model.getEdgeCount(n[t]),r=0;r<u;r++)i.push(this.model.getEdgeAt(n[t],r));f=this.model.getChildren(n[t]);i=i.concat(this.getAllEdges(f))}return i};mxGraph.prototype.updateCellSize=function(n,t){t=t!=null?t:!1;this.model.beginUpdate();try{this.cellSizeUpdated(n,t);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",n,"ignoreChildren",t))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellSizeUpdated=function(n,t){var r,i,e,f;if(n!=null){this.model.beginUpdate();try{if(r=this.getPreferredSizeForCell(n),i=this.model.getGeometry(n),r!=null&&i!=null){if(e=this.isCellCollapsed(n),i=i.clone(),this.isSwimlane(n)){var o=this.view.getState(n),c=o!=null?o.style:this.getCellStyle(n),u=this.model.getStyle(n);u==null&&(u="");mxUtils.getValue(c,mxConstants.STYLE_HORIZONTAL,!0)?(u=mxUtils.setStyle(u,mxConstants.STYLE_STARTSIZE,r.height+8),e&&(i.height=r.height+8),i.width=r.width):(u=mxUtils.setStyle(u,mxConstants.STYLE_STARTSIZE,r.width+8),e&&(i.width=r.width+8),i.height=r.height);this.model.setStyle(n,u)}else i.width=r.width,i.height=r.height;if(!t&&!e&&(f=this.view.getBounds(this.model.getChildren(n)),f!=null)){var s=this.view.translate,h=this.view.scale,l=(f.x+f.width)/h-i.x-s.x,a=(f.y+f.height)/h-i.y-s.y;i.width=Math.max(i.width,l);i.height=Math.max(i.height,a)}this.cellsResized([n],[i],!1)}}finally{this.model.endUpdate()}}};mxGraph.prototype.getPreferredSizeForCell=function(n){var s=null,r,t,h,i,a,c;if(n!=null&&(r=this.view.getState(n)||this.view.createState(n),t=r.style,!this.model.isEdge(n))){var v=t[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE,u=0,f=0;if((this.getImage(r)!=null||t[mxConstants.STYLE_IMAGE]!=null)&&t[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL&&(t[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE&&(u+=parseFloat(t[mxConstants.STYLE_IMAGE_WIDTH])||mxLabel.prototype.imageSize),t[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER&&(f+=parseFloat(t[mxConstants.STYLE_IMAGE_HEIGHT])||mxLabel.prototype.imageSize)),u+=2*(t[mxConstants.STYLE_SPACING]||0),u+=t[mxConstants.STYLE_SPACING_LEFT]||0,u+=t[mxConstants.STYLE_SPACING_RIGHT]||0,f+=2*(t[mxConstants.STYLE_SPACING]||0),f+=t[mxConstants.STYLE_SPACING_TOP]||0,f+=t[mxConstants.STYLE_SPACING_BOTTOM]||0,h=this.getFoldingImage(r),h!=null&&(u+=h.width+8),i=this.cellRenderer.getLabelValue(r),i!=null&&i.length>0){this.isHtmlLabel(r.cell)||(i=mxUtils.htmlEntities(i));i=i.replace(/\n/g,"<br>");var l=mxUtils.getSizeForString(i,v,t[mxConstants.STYLE_FONTFAMILY]),e=l.width+u,o=l.height+f;mxUtils.getValue(t,mxConstants.STYLE_HORIZONTAL,!0)||(a=o,o=e,e=a);this.gridEnabled&&(e=this.snap(e+this.gridSize/2),o=this.snap(o+this.gridSize/2));s=new mxRectangle(0,0,e,o)}else c=4*this.gridSize,s=new mxRectangle(0,0,c,c)}return s};mxGraph.prototype.resizeCell=function(n,t,i){return this.resizeCells([n],[t],i)[0]};mxGraph.prototype.resizeCells=function(n,t,i){i=i!=null?i:this.isRecursiveResize();this.model.beginUpdate();try{this.cellsResized(n,t,i);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",n,"bounds",t))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellsResized=function(n,t,i){if(i=i!=null?i:!1,n!=null&&t!=null&&n.length==t.length){this.model.beginUpdate();try{for(var r=0;r<n.length;r++)this.cellResized(n[r],t[r],!1,i),this.isExtendParent(n[r])&&this.extendParent(n[r]),this.constrainChild(n[r]);this.resetEdgesOnResize&&this.resetEdges(n);this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",n,"bounds",t))}finally{this.model.endUpdate()}}};mxGraph.prototype.cellResized=function(n,t,i,r){var u=this.model.getGeometry(n),f;if(u!=null&&(u.x!=t.x||u.y!=t.y||u.width!=t.width||u.height!=t.height)){u=u.clone();!i&&u.relative?(f=u.offset,f!=null&&(f.x+=t.x-u.x,f.y+=t.y-u.y)):(u.x=t.x,u.y=t.y);u.width=t.width;u.height=t.height;u.relative||!this.model.isVertex(n)||this.isAllowNegativeCoordinates()||(u.x=Math.max(0,u.x),u.y=Math.max(0,u.y));this.model.beginUpdate();try{r&&this.resizeChildCells(n,u);this.model.setGeometry(n,u);this.constrainChildCells(n)}finally{this.model.endUpdate()}}};mxGraph.prototype.resizeChildCells=function(n,t){for(var r=this.model.getGeometry(n),u=t.width/r.width,f=t.height/r.height,e=this.model.getChildCount(n),i=0;i<e;i++)this.scaleCell(this.model.getChildAt(n,i),u,f,!0)};mxGraph.prototype.constrainChildCells=function(n){for(var i=this.model.getChildCount(n),t=0;t<i;t++)this.constrainChild(this.model.getChildAt(n,t))};mxGraph.prototype.scaleCell=function(n,t,i,r){var u=this.model.getGeometry(n),e,f;if(u!=null){e=this.view.getState(n);f=e!=null?e.style:this.getCellStyle(n);u=u.clone();var h=u.x,c=u.y,o=u.width,s=u.height;u.scale(t,i,f[mxConstants.STYLE_ASPECT]=="fixed");f[mxConstants.STYLE_RESIZE_WIDTH]=="1"?u.width=o*t:f[mxConstants.STYLE_RESIZE_WIDTH]=="0"&&(u.width=o);f[mxConstants.STYLE_RESIZE_HEIGHT]=="1"?u.height=s*i:f[mxConstants.STYLE_RESIZE_HEIGHT]=="0"&&(u.height=s);this.isCellMovable(n)||(u.x=h,u.y=c);this.isCellResizable(n)||(u.width=o,u.height=s);this.model.isVertex(n)?this.cellResized(n,u,!0,r):this.model.setGeometry(n,u)}};mxGraph.prototype.extendParent=function(n){var r,t,i;n!=null&&(r=this.model.getParent(n),t=this.getCellGeometry(r),r==null||t==null||this.isCellCollapsed(r)||(i=this.getCellGeometry(n),i!=null&&!i.relative&&(t.width<i.x+i.width||t.height<i.y+i.height)&&(t=t.clone(),t.width=Math.max(t.width,i.x+i.width),t.height=Math.max(t.height,i.y+i.height),this.cellsResized([r],[t],!1))))};mxGraph.prototype.importCells=function(n,t,i,r,u,f){return this.moveCells(n,t,i,!0,r,u,f)};mxGraph.prototype.moveCells=function(n,t,i,r,u,f,e){var h,c,l,o,a,s,v,y;if(t=t!=null?t:0,i=i!=null?i:0,r=r!=null?r:!1,n!=null&&(t!=0||i!=0||r||u!=null)){n=this.model.getTopmostCells(n);this.model.beginUpdate();try{for(h=new mxDictionary,o=0;o<n.length;o++)h.put(n[o],!0);for(c=mxUtils.bind(this,function(n){while(n!=null){if(h.get(n))return!0;n=this.model.getParent(n)}return!1}),l=[],o=0;o<n.length;o++)a=this.getCellGeometry(n[o]),s=this.model.getParent(n[o]),a!=null&&a.relative&&this.model.isEdge(s)&&(c(this.model.getTerminal(s,!0))||c(this.model.getTerminal(s,!1)))||l.push(n[o]);n=l;r&&(n=this.cloneCells(n,this.isCloneInvalidEdges(),e),u==null&&(u=this.getDefaultParent()));v=this.isAllowNegativeCoordinates();u!=null&&this.setAllowNegativeCoordinates(!0);this.cellsMoved(n,t,i,!r&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),u==null,this.isExtendParentsOnMove()&&u==null);this.setAllowNegativeCoordinates(v);u!=null&&(y=this.model.getChildCount(u),this.cellsAdded(n,u,y,null,null,!0));this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",n,"dx",t,"dy",i,"clone",r,"target",u,"event",f))}finally{this.model.endUpdate()}}return n};mxGraph.prototype.cellsMoved=function(n,t,i,r,u,f){if(n!=null&&(t!=0||i!=0)){f=f!=null?f:!1;this.model.beginUpdate();try{r&&this.disconnectGraph(n);for(var e=0;e<n.length;e++)this.translateCell(n[e],t,i),f&&this.isExtendParent(n[e])?this.extendParent(n[e]):u&&this.constrainChild(n[e]);this.resetEdgesOnMove&&this.resetEdges(n);this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",n,"dx",t,"dy",i,"disconnect",r))}finally{this.model.endUpdate()}}};mxGraph.prototype.translateCell=function(n,t,i){var r=this.model.getGeometry(n),u,f,e,o;if(r!=null){if(t=parseFloat(t),i=parseFloat(i),r=r.clone(),r.translate(t,i),r.relative||!this.model.isVertex(n)||this.isAllowNegativeCoordinates()||(r.x=Math.max(0,parseFloat(r.x)),r.y=Math.max(0,parseFloat(r.y))),r.relative&&!this.model.isEdge(n)){if(u=this.model.getParent(n),f=0,this.model.isVertex(u)&&(e=this.view.getState(u),o=e!=null?e.style:this.getCellStyle(u),f=mxUtils.getValue(o,mxConstants.STYLE_ROTATION,0)),f!=0){var s=mxUtils.toRadians(-f),c=Math.cos(s),l=Math.sin(s),h=mxUtils.getRotatedPoint(new mxPoint(t,i),c,l,new mxPoint(0,0));t=h.x;i=h.y}r.offset==null?r.offset=new mxPoint(t,i):(r.offset.x=parseFloat(r.offset.x)+t,r.offset.y=parseFloat(r.offset.y)+i)}this.model.setGeometry(n,r)}};mxGraph.prototype.getCellContainmentArea=function(n){var t,u,v;if(n!=null&&!this.model.isEdge(n)&&(t=this.model.getParent(n),t!=null&&t!=this.getDefaultParent()&&(u=this.model.getGeometry(t),u!=null))){var e=0,o=0,s=u.width,h=u.height;if(this.isSwimlane(t)){var i=this.getStartSize(t),c=this.view.getState(t),f=c!=null?c.style:this.getCellStyle(t),r=mxUtils.getValue(f,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST),l=mxUtils.getValue(f,mxConstants.STYLE_FLIPH,0)==1,a=mxUtils.getValue(f,mxConstants.STYLE_FLIPV,0)==1;(r==mxConstants.DIRECTION_SOUTH||r==mxConstants.DIRECTION_NORTH)&&(v=i.width,i.width=i.height,i.height=v);(r==mxConstants.DIRECTION_EAST&&!a||r==mxConstants.DIRECTION_NORTH&&!l||r==mxConstants.DIRECTION_WEST&&a||r==mxConstants.DIRECTION_SOUTH&&l)&&(e=i.width,o=i.height);s-=i.width;h-=i.height}return new mxRectangle(e,o,s,h)}return null};mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds};mxGraph.prototype.constrainChild=function(n,t){var r,c,u,s,a,l,h,f,e,o;if(t=t!=null?t:!0,n!=null&&(r=this.getCellGeometry(n),r!=null&&(this.isConstrainRelativeChildren()||!r.relative))){var v=this.model.getParent(n),y=this.getCellGeometry(v),i=this.getMaximumGraphBounds();if(i!=null&&(c=this.getBoundingBoxFromGeometry([v],!1),c!=null&&(i=mxRectangle.fromRectangle(i),i.x-=c.x,i.y-=c.y)),this.isConstrainChild(n)&&(u=this.getCellContainmentArea(n),u!=null&&(s=this.getOverlap(n),s>0&&(u=mxRectangle.fromRectangle(u),u.x-=u.width*s,u.y-=u.height*s,u.width+=2*u.width*s,u.height+=2*u.height*s),i==null?i=u:(i=mxRectangle.fromRectangle(i),i.intersect(u)))),i!=null){if(a=[n],!this.isCellCollapsed(n))for(l=this.model.getDescendants(n),h=0;h<l.length;h++)this.isCellVisible(l[h])&&a.push(l[h]);f=this.getBoundingBoxFromGeometry(a,!1);f!=null&&(r=r.clone(),e=0,r.width>i.width&&(e=r.width-i.width,r.width-=e),f.x+f.width>i.x+i.width&&(e-=f.x+f.width-i.x-i.width-e),o=0,r.height>i.height&&(o=r.height-i.height,r.height-=o),f.y+f.height>i.y+i.height&&(o-=f.y+f.height-i.y-i.height-o),f.x<i.x&&(e-=f.x-i.x),f.y<i.y&&(o-=f.y-i.y),(e!=0||o!=0)&&(r.relative?(r.offset==null&&(r.offset=new mxPoint),r.offset.x+=e,r.offset.y+=o):(r.x+=e,r.y+=o)),this.model.setGeometry(n,r))}}};mxGraph.prototype.resetEdges=function(n){var u,t,i,r;if(n!=null){for(u=new mxDictionary,t=0;t<n.length;t++)u.put(n[t],!0);this.model.beginUpdate();try{for(t=0;t<n.length;t++){if(i=this.model.getEdges(n[t]),i!=null)for(r=0;r<i.length;r++){var f=this.view.getState(i[r]),e=f!=null?f.getVisibleTerminal(!0):this.view.getVisibleTerminal(i[r],!0),o=f!=null?f.getVisibleTerminal(!1):this.view.getVisibleTerminal(i[r],!1);u.get(e)&&u.get(o)||this.resetEdge(i[r])}this.resetEdges(this.model.getChildren(n[t]))}}finally{this.model.endUpdate()}}};mxGraph.prototype.resetEdge=function(n){var t=this.model.getGeometry(n);return t!=null&&t.points!=null&&t.points.length>0&&(t=t.clone(),t.points=[],this.model.setGeometry(n,t)),n};mxGraph.prototype.getOutlineConstraint=function(n,t){var i,f,o,r,u,e,a,v;if(t.shape!=null){if(i=this.view.getPerimeterBounds(t),f=t.style[mxConstants.STYLE_DIRECTION],(f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH)&&(i.x+=i.width/2-i.height/2,i.y+=i.height/2-i.width/2,e=i.width,i.width=i.height,i.height=e),o=mxUtils.toRadians(t.shape.getShapeRotation()),o!=0){var y=Math.cos(-o),p=Math.sin(-o),w=new mxPoint(i.getCenterX(),i.getCenterY());n=mxUtils.getRotatedPoint(n,y,p,w)}var s=1,h=1,c=0,l=0;return this.getModel().isVertex(t.cell)&&(r=t.style[mxConstants.STYLE_FLIPH],u=t.style[mxConstants.STYLE_FLIPV],t.shape!=null&&t.shape.stencil!=null&&(r=mxUtils.getValue(t.style,"stencilFlipH",0)==1||r,u=mxUtils.getValue(t.style,"stencilFlipV",0)==1||u),(f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH)&&(e=r,r=u,u=e),r&&(s=-1,c=-i.width),u&&(h=-1,l=-i.height)),n=new mxPoint((n.x-i.x)*s-c+i.x,(n.y-i.y)*h-l+i.y),a=Math.round((n.x-i.x)*1e3/i.width)/1e3,v=Math.round((n.y-i.y)*1e3/i.height)/1e3,new mxConnectionConstraint(new mxPoint(a,v),!1)}return null};mxGraph.prototype.getAllConnectionConstraints=function(n){return n!=null&&n.shape!=null&&n.shape.stencil!=null?n.shape.stencil.constraints:null};mxGraph.prototype.getConnectionConstraint=function(n,t,i){var r=null,e=n.style[i?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X],u,f;return e!=null&&(u=n.style[i?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y],u!=null&&(r=new mxPoint(parseFloat(e),parseFloat(u)))),f=!1,r!=null&&(f=mxUtils.getValue(n.style,i?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,!0)),new mxConnectionConstraint(r,f)};mxGraph.prototype.setConnectionConstraint=function(n,t,i,r){if(r!=null){this.model.beginUpdate();try{r==null||r.point==null?(this.setCellStyles(i?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[n]),this.setCellStyles(i?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[n]),this.setCellStyles(i?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[n])):r.point!=null&&(this.setCellStyles(i?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,r.point.x,[n]),this.setCellStyles(i?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,r.point.y,[n]),r.perimeter?this.setCellStyles(i?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[n]):this.setCellStyles(i?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[n]))}finally{this.model.endUpdate()}}};mxGraph.prototype.getConnectionPoint=function(n,t){var i=null,o,s,e,h,c;if(n!=null&&t.point!=null){var r=this.view.getPerimeterBounds(n),l=new mxPoint(r.getCenterX(),r.getCenterY()),f=n.style[mxConstants.STYLE_DIRECTION],u=0;if(f!=null&&(f==mxConstants.DIRECTION_NORTH?u+=270:f==mxConstants.DIRECTION_WEST?u+=180:f==mxConstants.DIRECTION_SOUTH&&(u+=90),(f==mxConstants.DIRECTION_NORTH||f==mxConstants.DIRECTION_SOUTH)&&r.rotate90()),i=new mxPoint(r.x+t.point.x*r.width,r.y+t.point.y*r.height),o=n.style[mxConstants.STYLE_ROTATION]||0,t.perimeter?(u!=0&&(s=0,e=0,u==90?e=1:u==180?s=-1:u==270&&(e=-1),i=mxUtils.getRotatedPoint(i,s,e,l)),i=this.view.getPerimeterPoint(n,i,!1)):(o+=u,this.getModel().isVertex(n.cell)&&(h=n.style[mxConstants.STYLE_FLIPH]==1,c=n.style[mxConstants.STYLE_FLIPV]==1,n.shape!=null&&n.shape.stencil!=null&&(h=mxUtils.getValue(n.style,"stencilFlipH",0)==1||h,c=mxUtils.getValue(n.style,"stencilFlipV",0)==1||c),h&&(i.x=2*r.getCenterX()-i.x),c&&(i.y=2*r.getCenterY()-i.y))),o!=0&&i!=null){var a=mxUtils.toRadians(o),s=Math.cos(a),e=Math.sin(a);i=mxUtils.getRotatedPoint(i,s,e,l)}}return i!=null&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),i};mxGraph.prototype.connectCell=function(n,t,i,r){this.model.beginUpdate();try{var u=this.model.getTerminal(n,i);this.cellConnected(n,t,i,r);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",n,"terminal",t,"source",i,"previous",u))}finally{this.model.endUpdate()}return n};mxGraph.prototype.cellConnected=function(n,t,i,r){var f,u,e;if(n!=null){this.model.beginUpdate();try{f=this.model.getTerminal(n,i);this.setConnectionConstraint(n,t,i,r);this.isPortsEnabled()&&(u=null,this.isPort(t)&&(u=t.getId(),t=this.getTerminalForPort(t,i)),e=i?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT,this.setCellStyles(e,u,[n]));this.model.setTerminal(n,t,i);this.resetEdgesOnConnect&&this.resetEdge(n);this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",n,"terminal",t,"source",i,"previous",f))}finally{this.model.endUpdate()}}};mxGraph.prototype.disconnectGraph=function(n){var t,r,c,s,i,l;if(n!=null){this.model.beginUpdate();try{var e=this.view.scale,o=this.view.translate,h=new mxDictionary;for(t=0;t<n.length;t++)h.put(n[t],!0);for(t=0;t<n.length;t++)if(this.model.isEdge(n[t])&&(r=this.model.getGeometry(n[t]),r!=null&&(c=this.view.getState(n[t]),s=this.view.getState(this.model.getParent(n[t])),c!=null&&s!=null))){r=r.clone();var a=-s.origin.x,v=-s.origin.y,f=c.absolutePoints,u=this.model.getTerminal(n[t],!0);if(u!=null&&this.isCellDisconnectable(n[t],u,!0)){while(u!=null&&!h.get(u))u=this.model.getParent(u);u==null&&(r.setTerminalPoint(new mxPoint(f[0].x/e-o.x+a,f[0].y/e-o.y+v),!0),this.model.setTerminal(n[t],null,!0))}if(i=this.model.getTerminal(n[t],!1),i!=null&&this.isCellDisconnectable(n[t],i,!1)){while(i!=null&&!h.get(i))i=this.model.getParent(i);i==null&&(l=f.length-1,r.setTerminalPoint(new mxPoint(f[l].x/e-o.x+a,f[l].y/e-o.y+v),!1),this.model.setTerminal(n[t],null,!1))}this.model.setGeometry(n[t],r)}}finally{this.model.endUpdate()}}};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot};mxGraph.prototype.getTranslateForRoot=function(){return null};mxGraph.prototype.isPort=function(){return!1};mxGraph.prototype.getTerminalForPort=function(n){return this.model.getParent(n)};mxGraph.prototype.getChildOffsetForCell=function(){return null};mxGraph.prototype.enterGroup=function(n){n=n||this.getSelectionCell();n!=null&&this.isValidRoot(n)&&(this.view.setCurrentRoot(n),this.clearSelection())};mxGraph.prototype.exitGroup=function(){var t=this.model.getRoot(),i=this.getCurrentRoot(),n,r;if(i!=null){for(n=this.model.getParent(i);n!=t&&!this.isValidRoot(n)&&this.model.getParent(n)!=t;)n=this.model.getParent(n);n==t||this.model.getParent(n)==t?this.view.setCurrentRoot(null):this.view.setCurrentRoot(n);r=this.view.getState(i);r!=null&&this.setSelectionCell(i)}};mxGraph.prototype.home=function(){var n=this.getCurrentRoot(),t;n!=null&&(this.view.setCurrentRoot(null),t=this.view.getState(n),t!=null&&this.setSelectionCell(n))};mxGraph.prototype.isValidRoot=function(n){return n!=null};mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds()};mxGraph.prototype.getCellBounds=function(n,t,i){var f=[n],r,o,u,e;if(t&&(f=f.concat(this.model.getEdges(n))),r=this.view.getBounds(f),i)for(o=this.model.getChildCount(n),u=0;u<o;u++)e=this.getCellBounds(this.model.getChildAt(n,u),t,!0),r!=null?r.add(e):r=e;return r};mxGraph.prototype.getBoundingBoxFromGeometry=function(n,t){var s,f,r,u,h,o,c,e,i;if(t=t!=null?t:!1,s=null,n!=null)for(f=0;f<n.length;f++)if((t||this.model.isVertex(n[f]))&&(r=this.getCellGeometry(n[f]),r!=null)){if(u=null,this.model.isEdge(n[f])){if(h=function(n){n!=null&&(i==null?i=new mxRectangle(n.x,n.y,0,0):i.add(new mxRectangle(n.x,n.y,0,0)))},this.model.getTerminal(n[f],!0)==null&&h(r.getTerminalPoint(!0)),this.model.getTerminal(n[f],!1)==null&&h(r.getTerminalPoint(!1)),o=r.points,o!=null&&o.length>0)for(i=new mxRectangle(o[0].x,o[0].y,0,0),c=1;c<o.length;c++)h(o[c]);u=i}else e=this.model.getParent(n[f]),r.relative?this.model.isVertex(e)&&e!=this.view.currentRoot&&(i=this.getBoundingBoxFromGeometry([e],!1),i!=null&&(u=new mxRectangle(r.x*i.width,r.y*i.height,r.width,r.height),mxUtils.indexOf(n,e)>=0&&(u.x+=i.x,u.y+=i.y))):(u=mxRectangle.fromRectangle(r),this.model.isVertex(e)&&mxUtils.indexOf(n,e)>=0&&(i=this.getBoundingBoxFromGeometry([e],!1),i!=null&&(u.x+=i.x,u.y+=i.y))),u!=null&&r.offset!=null&&(u.x+=r.offset.x,u.y+=r.offset.y);u!=null&&(s==null?s=mxRectangle.fromRectangle(u):s.add(u))}return s};mxGraph.prototype.refresh=function(n){this.view.clear(n,n==null);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH))};mxGraph.prototype.snap=function(n){return this.gridEnabled&&(n=Math.round(n/this.gridSize)*this.gridSize),n};mxGraph.prototype.panGraph=function(n,t){var r,f,i,u;if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container))this.container.scrollLeft=-n,this.container.scrollTop=-t;else{if(r=this.view.getCanvas(),this.dialect==mxConstants.DIALECT_SVG)if(n==0&&t==0){if(mxClient.IS_IE?r.setAttribute("transform","translate("+n+","+t+")"):r.removeAttribute("transform"),this.shiftPreview1!=null){for(i=this.shiftPreview1.firstChild;i!=null;)u=i.nextSibling,this.container.appendChild(i),i=u;for(this.shiftPreview1.parentNode!=null&&this.shiftPreview1.parentNode.removeChild(this.shiftPreview1),this.shiftPreview1=null,this.container.appendChild(r.parentNode),i=this.shiftPreview2.firstChild;i!=null;)u=i.nextSibling,this.container.appendChild(i),i=u;this.shiftPreview2.parentNode!=null&&this.shiftPreview2.parentNode.removeChild(this.shiftPreview2);this.shiftPreview2=null}}else{if(r.setAttribute("transform","translate("+n+","+t+")"),this.shiftPreview1==null){for(this.shiftPreview1=document.createElement("div"),this.shiftPreview1.style.position="absolute",this.shiftPreview1.style.overflow="visible",this.shiftPreview2=document.createElement("div"),this.shiftPreview2.style.position="absolute",this.shiftPreview2.style.overflow="visible",f=this.shiftPreview1,i=this.container.firstChild;i!=null;)u=i.nextSibling,i!=r.parentNode?f.appendChild(i):f=this.shiftPreview2,i=u;this.shiftPreview1.firstChild!=null&&this.container.insertBefore(this.shiftPreview1,r.parentNode);this.shiftPreview2.firstChild!=null&&this.container.appendChild(this.shiftPreview2)}this.shiftPreview1.style.left=n+"px";this.shiftPreview1.style.top=t+"px";this.shiftPreview2.style.left=n+"px";this.shiftPreview2.style.top=t+"px"}else r.style.left=n+"px",r.style.top=t+"px";this.panDx=n;this.panDy=t;this.fireEvent(new mxEventObject(mxEvent.PAN))}};mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor)};mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor)};mxGraph.prototype.zoomActual=function(){this.view.scale==1?this.view.setTranslate(0,0):(this.view.translate.x=0,this.view.translate.y=0,this.view.setScale(1))};mxGraph.prototype.zoomTo=function(n,t){this.zoom(n/this.view.scale,t)};mxGraph.prototype.center=function(n,t,i,r){var l,a;n=n!=null?n:!0;t=t!=null?t:!0;i=i!=null?i:.5;r=r!=null?r:.5;var v=mxUtils.hasScrollbars(this.container),o=this.container.clientWidth,s=this.container.clientHeight,u=this.getGraphBounds(),f=this.view.translate,e=this.view.scale,h=n?o-u.width:0,c=t?s-u.height:0;v?(u.x-=f.x,u.y-=f.y,l=this.container.scrollWidth,a=this.container.scrollHeight,l>o&&(h=0),a>s&&(c=0),this.view.setTranslate(Math.floor(h/2-u.x),Math.floor(c/2-u.y)),this.container.scrollLeft=(l-o)/2,this.container.scrollTop=(a-s)/2):this.view.setTranslate(n?Math.floor(f.x-u.x*e+h*i/e):f.x,t?Math.floor(f.y-u.y*e+c*r/e):f.y)};mxGraph.prototype.zoom=function(n,t){var i,f,s,o,e,r,u;if(t=t!=null?t:this.centerZoom,i=Math.round(this.view.scale*n*100)/100,f=this.view.getState(this.getSelectionCell()),n=i/this.view.scale,this.keepSelectionVisibleOnZoom&&f!=null)s=new mxRectangle(f.x*n,f.y*n,f.width*n,f.height*n),this.view.scale=i,this.scrollRectToVisible(s)||(this.view.revalidate(),this.view.setScale(i));else if(o=mxUtils.hasScrollbars(this.container),t&&!o)r=this.container.offsetWidth,u=this.container.offsetHeight,n>1?(e=(n-1)/(i*2),r*=-e,u*=-e):(e=(1/n-1)/(this.view.scale*2),r*=e,u*=e),this.view.scaleAndTranslate(i,this.view.translate.x+r,this.view.translate.y+u);else{var h=this.view.translate.x,c=this.view.translate.y,l=this.container.scrollLeft,a=this.container.scrollTop;this.view.setScale(i);o&&(r=0,u=0,t&&(r=this.container.offsetWidth*(n-1)/2,u=this.container.offsetHeight*(n-1)/2),this.container.scrollLeft=(this.view.translate.x-h)*this.view.scale+Math.round(l*n+r),this.container.scrollTop=(this.view.translate.y-c)*this.view.scale+Math.round(a*n+u))}};mxGraph.prototype.zoomToRect=function(n){var a=this.container.clientWidth/n.width,v=this.container.clientHeight/n.height,u=a/v,t,i,f,s,h,e,c,l,r,o;n.x=Math.max(0,n.x);n.y=Math.max(0,n.y);t=Math.min(this.container.scrollWidth,n.x+n.width);i=Math.min(this.container.scrollHeight,n.y+n.height);n.width=t-n.x;n.height=i-n.y;u<1?(f=n.height/u,s=(f-n.height)/2,n.height=f,h=Math.min(n.y,s),n.y=n.y-h,i=Math.min(this.container.scrollHeight,n.y+n.height),n.height=i-n.y):(e=n.width*u,c=(e-n.width)/2,n.width=e,l=Math.min(n.x,c),n.x=n.x-l,t=Math.min(this.container.scrollWidth,n.x+n.width),n.width=t-n.x);r=this.container.clientWidth/n.width;o=this.view.scale*r;mxUtils.hasScrollbars(this.container)?(this.view.setScale(o),this.container.scrollLeft=Math.round(n.x*r),this.container.scrollTop=Math.round(n.y*r)):this.view.scaleAndTranslate(o,this.view.translate.x-n.x/this.view.scale,this.view.translate.y-n.y/this.view.scale)};mxGraph.prototype.scrollCellToVisible=function(n,t){var s=-this.view.translate.x,h=-this.view.translate.y,r=this.view.getState(n),i,u,f,e,o;r!=null&&(i=new mxRectangle(s+r.x,h+r.y,r.width,r.height),t&&this.container!=null&&(u=this.container.clientWidth,f=this.container.clientHeight,i.x=i.getCenterX()-u/2,i.width=u,i.y=i.getCenterY()-f/2,i.height=f),e=new mxPoint(this.view.translate.x,this.view.translate.y),this.scrollRectToVisible(i)&&(o=new mxPoint(this.view.translate.x,this.view.translate.y),this.view.translate.x=e.x,this.view.translate.y=e.y,this.view.setTranslate(o.x,o.y)))};mxGraph.prototype.scrollRectToVisible=function(n){var u=!1,t,i,a,r,v;if(n!=null){var s=this.container.offsetWidth,h=this.container.offsetHeight,c=Math.min(s,n.width),l=Math.min(h,n.height);if(mxUtils.hasScrollbars(this.container))t=this.container,n.x+=this.view.translate.x,n.y+=this.view.translate.y,i=t.scrollLeft-n.x,a=Math.max(i-t.scrollLeft,0),i>0?t.scrollLeft-=i+2:(i=n.x+c-t.scrollLeft-t.clientWidth,i>0&&(t.scrollLeft+=i+2)),r=t.scrollTop-n.y,v=Math.max(0,r-t.scrollTop),r>0?t.scrollTop-=r+2:(r=n.y+l-t.scrollTop-t.clientHeight,r>0&&(t.scrollTop+=r+2)),this.useScrollbarsForPanning||a==0&&v==0||this.view.setTranslate(a,v);else{var f=-this.view.translate.x,e=-this.view.translate.y,o=this.view.scale;n.x+c>f+s&&(this.view.translate.x-=(n.x+c-s-f)/o,u=!0);n.y+l>e+h&&(this.view.translate.y-=(n.y+l-h-e)/o,u=!0);n.x<f&&(this.view.translate.x+=(f-n.x)/o,u=!0);n.y<e&&(this.view.translate.y+=(e-n.y)/o,u=!0);u&&(this.view.refresh(),this.selectionCellsHandler!=null&&this.selectionCellsHandler.refresh())}}return u};mxGraph.prototype.getCellGeometry=function(n){return this.model.getGeometry(n)};mxGraph.prototype.isCellVisible=function(n){return this.model.isVisible(n)};mxGraph.prototype.isCellCollapsed=function(n){return this.model.isCollapsed(n)};mxGraph.prototype.isCellConnectable=function(n){return this.model.isConnectable(n)};mxGraph.prototype.isOrthogonal=function(n){var i=n.style[mxConstants.STYLE_ORTHOGONAL],t;return i!=null?i:(t=this.view.getEdgeStyle(n),t==mxEdgeStyle.SegmentConnector||t==mxEdgeStyle.ElbowConnector||t==mxEdgeStyle.SideToSide||t==mxEdgeStyle.TopToBottom||t==mxEdgeStyle.EntityRelation||t==mxEdgeStyle.OrthConnector)};mxGraph.prototype.isLoop=function(n){var t=n.getVisibleTerminalState(!0),i=n.getVisibleTerminalState(!1);return t!=null&&t==i};mxGraph.prototype.isCloneEvent=function(n){return mxEvent.isControlDown(n)};mxGraph.prototype.isTransparentClickEvent=function(){return!1};mxGraph.prototype.isToggleEvent=function(n){return mxClient.IS_MAC?mxEvent.isMetaDown(n):mxEvent.isControlDown(n)};mxGraph.prototype.isGridEnabledEvent=function(n){return n!=null&&!mxEvent.isAltDown(n)};mxGraph.prototype.isConstrainedEvent=function(n){return mxEvent.isShiftDown(n)};mxGraph.prototype.isIgnoreTerminalEvent=function(){return!1};mxGraph.prototype.validationAlert=function(n){mxUtils.alert(n)};mxGraph.prototype.isEdgeValid=function(n,t,i){return this.getEdgeValidationError(n,t,i)==null};mxGraph.prototype.getEdgeValidationError=function(n,t,i){var r,f,o,s,e,u;if(n!=null&&!this.isAllowDanglingEdges()&&(t==null||i==null))return"";if(n!=null&&this.model.getTerminal(n,!0)==null&&this.model.getTerminal(n,!1)==null)return null;if(!this.allowLoops&&t==i&&t!=null||!this.isValidConnection(t,i))return"";if(t!=null&&i!=null){if(r="",this.multigraph||(f=this.model.getEdgesBetween(t,i,!0),(f.length>1||f.length==1&&f[0]!=n)&&(r+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n")),o=this.model.getDirectedEdgeCount(t,!0,n),s=this.model.getDirectedEdgeCount(i,!1,n),this.multiplicities!=null)for(e=0;e<this.multiplicities.length;e++)u=this.multiplicities[e].check(this,n,t,i,o,s),u!=null&&(r+=u);return u=this.validateEdge(n,t,i),u!=null&&(r+=u),r.length>0?r:null}return this.allowDanglingEdges?null:""};mxGraph.prototype.validateEdge=function(){return null};mxGraph.prototype.validateGraph=function(n,t){var r,h,f,u,o,e,i,s;for(n=n!=null?n:this.model.getRoot(),t=t!=null?t:{},r=!0,h=this.model.getChildCount(n),f=0;f<h;f++)u=this.model.getChildAt(n,f),o=t,this.isValidRoot(u)&&(o={}),e=this.validateGraph(u,o),e!=null?this.setCellWarning(u,e.replace(/\n/g,"<br>")):this.setCellWarning(u,null),r=r&&e==null;return i="",this.isCellCollapsed(n)&&!r&&(i+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n"),i+=this.model.isEdge(n)?this.getEdgeValidationError(n,this.model.getTerminal(n,!0),this.model.getTerminal(n,!1))||"":this.getCellValidationError(n)||"",s=this.validateCell(n,t),s!=null&&(i+=s),this.model.getParent(n)==null&&this.view.validate(),i.length>0||!r?i:null};mxGraph.prototype.getCellValidationError=function(n){var u=this.model.getDirectedEdgeCount(n,!0),f=this.model.getDirectedEdgeCount(n,!1),e=this.model.getValue(n),i="",r,t;if(this.multiplicities!=null)for(r=0;r<this.multiplicities.length;r++)t=this.multiplicities[r],t.source&&mxUtils.isNode(e,t.type,t.attr,t.value)&&(u>t.max||u<t.min)?i+=t.countError+"\n":!t.source&&mxUtils.isNode(e,t.type,t.attr,t.value)&&(f>t.max||f<t.min)&&(i+=t.countError+"\n");return i.length>0?i:null};mxGraph.prototype.validateCell=function(){return null};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage};mxGraph.prototype.setBackgroundImage=function(n){this.backgroundImage=n};mxGraph.prototype.getFoldingImage=function(n){if(n!=null&&this.foldingEnabled&&!this.getModel().isEdge(n.cell)){var t=this.isCellCollapsed(n.cell);if(this.isCellFoldable(n.cell,!t))return t?this.collapsedImage:this.expandedImage}return null};mxGraph.prototype.convertValueToString=function(n){var t=this.model.getValue(n);if(t!=null){if(mxUtils.isNode(t))return t.nodeName;if(typeof t.toString=="function")return t.toString()}return""};mxGraph.prototype.getLabel=function(n){var i="",t,r;return this.labelsVisible&&n!=null&&(t=this.view.getState(n),r=t!=null?t.style:this.getCellStyle(n),mxUtils.getValue(r,mxConstants.STYLE_NOLABEL,!1)||(i=this.convertValueToString(n))),i};mxGraph.prototype.isHtmlLabel=function(){return this.isHtmlLabels()};mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels};mxGraph.prototype.setHtmlLabels=function(n){this.htmlLabels=n};mxGraph.prototype.isWrapping=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return i!=null?i[mxConstants.STYLE_WHITE_SPACE]=="wrap":!1};mxGraph.prototype.isLabelClipped=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return i!=null?i[mxConstants.STYLE_OVERFLOW]=="hidden":!1};mxGraph.prototype.getTooltip=function(n,t){var i=null,r;return n!=null&&(n.control!=null&&(t==n.control.node||t.parentNode==n.control.node)&&(i=this.collapseExpandResource,i=mxUtils.htmlEntities(mxResources.get(i)||i).replace(/\\n/g,"<br>")),i==null&&n.overlays!=null&&n.overlays.visit(function(n,r){i==null&&(t==r.node||t.parentNode==r.node)&&(i=r.overlay.toString())}),i==null&&(r=this.selectionCellsHandler.getHandler(n.cell),r!=null&&typeof r.getTooltipForNode=="function"&&(i=r.getTooltipForNode(t))),i==null&&(i=this.getTooltipForCell(n.cell))),i};mxGraph.prototype.getTooltipForCell=function(n){return n!=null&&n.getTooltip!=null?n.getTooltip():this.convertValueToString(n)};mxGraph.prototype.getLinkForCell=function(){return null};mxGraph.prototype.getCursorForMouseEvent=function(n){return this.getCursorForCell(n.getCell())};mxGraph.prototype.getCursorForCell=function(){return null};mxGraph.prototype.getStartSize=function(n){var t=new mxRectangle,u=this.view.getState(n),i=u!=null?u.style:this.getCellStyle(n),r;return i!=null&&(r=parseInt(mxUtils.getValue(i,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),mxUtils.getValue(i,mxConstants.STYLE_HORIZONTAL,!0)?t.height=r:t.width=r),t};mxGraph.prototype.getImage=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_IMAGE]:null};mxGraph.prototype.getVerticalAlign=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE:null};mxGraph.prototype.getIndicatorColor=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_INDICATOR_COLOR]:null};mxGraph.prototype.getIndicatorGradientColor=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null};mxGraph.prototype.getIndicatorShape=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_INDICATOR_SHAPE]:null};mxGraph.prototype.getIndicatorImage=function(n){return n!=null&&n.style!=null?n.style[mxConstants.STYLE_INDICATOR_IMAGE]:null};mxGraph.prototype.getBorder=function(){return this.border};mxGraph.prototype.setBorder=function(n){this.border=n};mxGraph.prototype.isSwimlane=function(n){if(n!=null&&this.model.getParent(n)!=this.model.getRoot()){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);if(i!=null&&!this.model.isEdge(n))return i[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE}return!1};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer};mxGraph.prototype.setResizeContainer=function(n){this.resizeContainer=n};mxGraph.prototype.isEnabled=function(){return this.enabled};mxGraph.prototype.setEnabled=function(n){this.enabled=n};mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled};mxGraph.prototype.setEscapeEnabled=function(n){this.escapeEnabled=n};mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing};mxGraph.prototype.setInvokesStopCellEditing=function(n){this.invokesStopCellEditing=n};mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing};mxGraph.prototype.setEnterStopsCellEditing=function(n){this.enterStopsCellEditing=n};mxGraph.prototype.isCellLocked=function(n){var t=this.model.getGeometry(n);return this.isCellsLocked()||t!=null&&this.model.isVertex(n)&&t.relative};mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked};mxGraph.prototype.setCellsLocked=function(n){this.cellsLocked=n};mxGraph.prototype.getCloneableCells=function(n){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.isCellCloneable(n)}))};mxGraph.prototype.isCellCloneable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsCloneable()&&i[mxConstants.STYLE_CLONEABLE]!=0};mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable};mxGraph.prototype.setCellsCloneable=function(n){this.cellsCloneable=n};mxGraph.prototype.getExportableCells=function(n){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.canExportCell(n)}))};mxGraph.prototype.canExportCell=function(){return this.exportEnabled};mxGraph.prototype.getImportableCells=function(n){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.canImportCell(n)}))};mxGraph.prototype.canImportCell=function(){return this.importEnabled};mxGraph.prototype.isCellSelectable=function(){return this.isCellsSelectable()};mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable};mxGraph.prototype.setCellsSelectable=function(n){this.cellsSelectable=n};mxGraph.prototype.getDeletableCells=function(n){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.isCellDeletable(n)}))};mxGraph.prototype.isCellDeletable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsDeletable()&&i[mxConstants.STYLE_DELETABLE]!=0};mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable};mxGraph.prototype.setCellsDeletable=function(n){this.cellsDeletable=n};mxGraph.prototype.isLabelMovable=function(n){return!this.isCellLocked(n)&&(this.model.isEdge(n)&&this.edgeLabelsMovable||this.model.isVertex(n)&&this.vertexLabelsMovable)};mxGraph.prototype.isCellRotatable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return i[mxConstants.STYLE_ROTATABLE]!=0};mxGraph.prototype.getMovableCells=function(n){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.isCellMovable(n)}))};mxGraph.prototype.isCellMovable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsMovable()&&!this.isCellLocked(n)&&i[mxConstants.STYLE_MOVABLE]!=0};mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable};mxGraph.prototype.setCellsMovable=function(n){this.cellsMovable=n};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled};mxGraph.prototype.setGridEnabled=function(n){this.gridEnabled=n};mxGraph.prototype.isPortsEnabled=function(){return this.portsEnabled};mxGraph.prototype.setPortsEnabled=function(n){this.portsEnabled=n};mxGraph.prototype.getGridSize=function(){return this.gridSize};mxGraph.prototype.setGridSize=function(n){this.gridSize=n};mxGraph.prototype.getTolerance=function(){return this.tolerance};mxGraph.prototype.setTolerance=function(n){this.tolerance=n};mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable};mxGraph.prototype.setVertexLabelsMovable=function(n){this.vertexLabelsMovable=n};mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable};mxGraph.prototype.setEdgeLabelsMovable=function(n){this.edgeLabelsMovable=n};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting};mxGraph.prototype.setSwimlaneNesting=function(n){this.swimlaneNesting=n};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled};mxGraph.prototype.setSwimlaneSelectionEnabled=function(n){this.swimlaneSelectionEnabled=n};mxGraph.prototype.isMultigraph=function(){return this.multigraph};mxGraph.prototype.setMultigraph=function(n){this.multigraph=n};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops};mxGraph.prototype.setAllowDanglingEdges=function(n){this.allowDanglingEdges=n};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges};mxGraph.prototype.setConnectableEdges=function(n){this.connectableEdges=n};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges};mxGraph.prototype.setCloneInvalidEdges=function(n){this.cloneInvalidEdges=n};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges};mxGraph.prototype.setAllowLoops=function(n){this.allowLoops=n};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove};mxGraph.prototype.setDisconnectOnMove=function(n){this.disconnectOnMove=n};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled};mxGraph.prototype.setDropEnabled=function(n){this.dropEnabled=n};mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled};mxGraph.prototype.setSplitEnabled=function(n){this.splitEnabled=n};mxGraph.prototype.isCellResizable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsResizable()&&!this.isCellLocked(n)&&mxUtils.getValue(i,mxConstants.STYLE_RESIZABLE,"1")!="0"};mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable};mxGraph.prototype.setCellsResizable=function(n){this.cellsResizable=n};mxGraph.prototype.isTerminalPointMovable=function(){return!0};mxGraph.prototype.isCellBendable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsBendable()&&!this.isCellLocked(n)&&i[mxConstants.STYLE_BENDABLE]!=0};mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable};mxGraph.prototype.setCellsBendable=function(n){this.cellsBendable=n};mxGraph.prototype.isCellEditable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isCellsEditable()&&!this.isCellLocked(n)&&i[mxConstants.STYLE_EDITABLE]!=0};mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable};mxGraph.prototype.setCellsEditable=function(n){this.cellsEditable=n};mxGraph.prototype.isCellDisconnectable=function(n){return this.isCellsDisconnectable()&&!this.isCellLocked(n)};mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable};mxGraph.prototype.setCellsDisconnectable=function(n){this.cellsDisconnectable=n};mxGraph.prototype.isValidSource=function(n){return n==null&&this.allowDanglingEdges||n!=null&&(!this.model.isEdge(n)||this.connectableEdges)&&this.isCellConnectable(n)};mxGraph.prototype.isValidTarget=function(n){return this.isValidSource(n)};mxGraph.prototype.isValidConnection=function(n,t){return this.isValidSource(n)&&this.isValidTarget(t)};mxGraph.prototype.setConnectable=function(n){this.connectionHandler.setEnabled(n)};mxGraph.prototype.isConnectable=function(){return this.connectionHandler.isEnabled()};mxGraph.prototype.setTooltips=function(n){this.tooltipHandler.setEnabled(n)};mxGraph.prototype.setPanning=function(n){this.panningHandler.panningEnabled=n};mxGraph.prototype.isEditing=function(n){if(this.cellEditor!=null){var t=this.cellEditor.getEditingCell();return n==null?t!=null:n==t}return!1};mxGraph.prototype.isAutoSizeCell=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isAutoSizeCells()||i[mxConstants.STYLE_AUTOSIZE]==1};mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells};mxGraph.prototype.setAutoSizeCells=function(n){this.autoSizeCells=n};mxGraph.prototype.isExtendParent=function(n){return!this.getModel().isEdge(n)&&this.isExtendParents()};mxGraph.prototype.isExtendParents=function(){return this.extendParents};mxGraph.prototype.setExtendParents=function(n){this.extendParents=n};mxGraph.prototype.isExtendParentsOnAdd=function(){return this.extendParentsOnAdd};mxGraph.prototype.setExtendParentsOnAdd=function(n){this.extendParentsOnAdd=n};mxGraph.prototype.isExtendParentsOnMove=function(){return this.extendParentsOnMove};mxGraph.prototype.setExtendParentsOnMove=function(n){this.extendParentsOnMove=n};mxGraph.prototype.isRecursiveResize=function(){return this.recursiveResize};mxGraph.prototype.setRecursiveResize=function(n){this.recursiveResize=n};mxGraph.prototype.isConstrainChild=function(n){return this.isConstrainChildren()&&!this.getModel().isEdge(this.getModel().getParent(n))};mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren};mxGraph.prototype.setConstrainChildren=function(n){this.constrainChildren=n};mxGraph.prototype.isConstrainRelativeChildren=function(){return this.constrainRelativeChildren};mxGraph.prototype.setConstrainRelativeChildren=function(n){this.constrainRelativeChildren=n};mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates};mxGraph.prototype.setAllowNegativeCoordinates=function(n){this.allowNegativeCoordinates=n};mxGraph.prototype.getOverlap=function(n){return this.isAllowOverlapParent(n)?this.defaultOverlap:0};mxGraph.prototype.isAllowOverlapParent=function(){return!1};mxGraph.prototype.getFoldableCells=function(n,t){return this.model.filterCells(n,mxUtils.bind(this,function(n){return this.isCellFoldable(n,t)}))};mxGraph.prototype.isCellFoldable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.model.getChildCount(n)>0&&i[mxConstants.STYLE_FOLDABLE]!=0};mxGraph.prototype.isValidDropTarget=function(n,t,i){return n!=null&&(this.isSplitEnabled()&&this.isSplitTarget(n,t,i)||!this.model.isEdge(n)&&(this.isSwimlane(n)||this.model.getChildCount(n)>0&&!this.isCellCollapsed(n)))};mxGraph.prototype.isSplitTarget=function(n,t){if(this.model.isEdge(n)&&t!=null&&t.length==1&&this.isCellConnectable(t[0])&&this.getEdgeValidationError(n,this.model.getTerminal(n,!0),t[0])==null){var i=this.model.getTerminal(n,!0),r=this.model.getTerminal(n,!1);return!this.model.isAncestor(t[0],i)&&!this.model.isAncestor(t[0],r)}return!1};mxGraph.prototype.getDropTarget=function(n,t,i,r){var s,e,o,u,f;if(!this.isSwimlaneNesting())for(s=0;s<n.length;s++)if(this.isSwimlane(n[s]))return null;if(e=mxUtils.convertPoint(this.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),e.x-=this.panDx,e.y-=this.panDy,o=this.getSwimlaneAt(e.x,e.y),i==null)i=o;else if(o!=null){for(u=this.model.getParent(o);u!=null&&this.isSwimlane(u)&&u!=i;)u=this.model.getParent(u);u==i&&(i=o)}while(i!=null&&!this.isValidDropTarget(i,n,t)&&!this.model.isLayer(i))i=this.model.getParent(i);if(r==null||!r)for(f=i;f!=null&&mxUtils.indexOf(n,f)<0;)f=this.model.getParent(f);return!this.model.isLayer(i)&&f==null?i:null};mxGraph.prototype.getDefaultParent=function(){var n=this.getCurrentRoot(),t;return n==null&&(n=this.defaultParent,n==null&&(t=this.model.getRoot(),n=this.model.getChildAt(t,0))),n};mxGraph.prototype.setDefaultParent=function(n){this.defaultParent=n};mxGraph.prototype.getSwimlane=function(n){while(n!=null&&!this.isSwimlane(n))n=this.model.getParent(n);return n};mxGraph.prototype.getSwimlaneAt=function(n,t,i){var e,u,r,f,o;if(i=i||this.getDefaultParent(),i!=null)for(e=this.model.getChildCount(i),u=0;u<e;u++){if(r=this.model.getChildAt(i,u),f=this.getSwimlaneAt(n,t,r),f!=null)return f;if(this.isSwimlane(r)&&(o=this.view.getState(r),this.intersects(o,n,t)))return r}return null};mxGraph.prototype.getCellAt=function(n,t,i,r,u,f){var c,o,e,h,s;if(r=r!=null?r:!0,u=u!=null?u:!0,i==null&&(i=this.getCurrentRoot(),i==null&&(i=this.getModel().getRoot())),i!=null)for(c=this.model.getChildCount(i),o=c-1;o>=0;o--){if(e=this.model.getChildAt(i,o),h=this.getCellAt(n,t,e,r,u,f),h!=null)return h;if(this.isCellVisible(e)&&(u&&this.model.isEdge(e)||r&&this.model.isVertex(e))&&(s=this.view.getState(e),s!=null&&(f==null||!f(s,n,t))&&this.intersects(s,n,t)))return e}return null};mxGraph.prototype.intersects=function(n,t,i){var u,s,r,f,e,h,o;if(n!=null)if(u=n.absolutePoints,u!=null)for(s=this.tolerance*this.tolerance,r=u[0],f=1;f<u.length;f++){if(e=u[f],h=mxUtils.ptSegDistSq(r.x,r.y,e.x,e.y,t,i),h<=s)return!0;r=e}else{if(o=mxUtils.toRadians(mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION)||0),o!=0){var c=Math.cos(-o),l=Math.sin(-o),a=new mxPoint(n.getCenterX(),n.getCenterY()),r=mxUtils.getRotatedPoint(new mxPoint(t,i),c,l,a);t=r.x;i=r.y}if(mxUtils.contains(n,t,i))return!0}return!1};mxGraph.prototype.hitsSwimlaneContent=function(n,t,i){var u=this.getView().getState(n),r=this.getStartSize(n),f;return u!=null&&((f=this.getView().getScale(),t-=u.x,i-=u.y,r.width>0&&t>0&&t>r.width*f)||r.height>0&&i>0&&i>r.height*f)?!0:!1};mxGraph.prototype.getChildVertices=function(n){return this.getChildCells(n,!0,!1)};mxGraph.prototype.getChildEdges=function(n){return this.getChildCells(n,!1,!0)};mxGraph.prototype.getChildCells=function(n,t,i){var u,f,r;for(n=n!=null?n:this.getDefaultParent(),t=t!=null?t:!1,i=i!=null?i:!1,u=this.model.getChildCells(n,t,i),f=[],r=0;r<u.length;r++)this.isCellVisible(u[r])&&f.push(u[r]);return f};mxGraph.prototype.getConnections=function(n,t){return this.getEdges(n,t,!0,!0,!1)};mxGraph.prototype.getIncomingEdges=function(n,t){return this.getEdges(n,t,!0,!1,!1)};mxGraph.prototype.getOutgoingEdges=function(n,t){return this.getEdges(n,t,!1,!0,!1)};mxGraph.prototype.getEdges=function(n,t,i,r,u,f){var l,a,e;i=i!=null?i:!0;r=r!=null?r:!0;u=u!=null?u:!0;f=f!=null?f:!1;var o=[],v=this.isCellCollapsed(n),y=this.model.getChildCount(n);for(e=0;e<y;e++)l=this.model.getChildAt(n,e),(v||!this.isCellVisible(l))&&(o=o.concat(this.model.getEdges(l,i,r)));for(o=o.concat(this.model.getEdges(n,i,r)),a=[],e=0;e<o.length;e++){var s=this.view.getState(o[e]),h=s!=null?s.getVisibleTerminal(!0):this.view.getVisibleTerminal(o[e],!0),c=s!=null?s.getVisibleTerminal(!1):this.view.getVisibleTerminal(o[e],!1);(u&&h==c||h!=c&&(i&&c==n&&(t==null||this.isValidAncestor(h,t,f))||r&&h==n&&(t==null||this.isValidAncestor(c,t,f))))&&a.push(o[e])}return a};mxGraph.prototype.isValidAncestor=function(n,t,i){return i?this.model.isAncestor(t,n):this.model.getParent(n)==t};mxGraph.prototype.getOpposites=function(n,t,i,r){var s,o,u;if(i=i!=null?i:!0,r=r!=null?r:!0,s=[],o=new mxDictionary,n!=null)for(u=0;u<n.length;u++){var h=this.view.getState(n[u]),f=h!=null?h.getVisibleTerminal(!0):this.view.getVisibleTerminal(n[u],!0),e=h!=null?h.getVisibleTerminal(!1):this.view.getVisibleTerminal(n[u],!1);f==t&&e!=null&&e!=t&&r?o.get(e)||(o.put(e,!0),s.push(e)):e==t&&f!=null&&f!=t&&i&&(o.get(f)||(o.put(f,!0),s.push(f)))}return s};mxGraph.prototype.getEdgesBetween=function(n,t,i){var u,e,r;for(i=i!=null?i:!1,u=this.getEdges(n),e=[],r=0;r<u.length;r++){var f=this.view.getState(u[r]),o=f!=null?f.getVisibleTerminal(!0):this.view.getVisibleTerminal(u[r],!0),s=f!=null?f.getVisibleTerminal(!1):this.view.getVisibleTerminal(u[r],!1);(o!=n||s!=t)&&(i||o!=t||s!=n)||e.push(u[r])}return e};mxGraph.prototype.getPointForEvent=function(n,t){var i=mxUtils.convertPoint(this.container,mxEvent.getClientX(n),mxEvent.getClientY(n)),r=this.view.scale,u=this.view.translate,f=t!=!1?this.gridSize/2:0;return i.x=this.snap(i.x/r-u.x-f),i.y=this.snap(i.y/r-u.y-f),i};mxGraph.prototype.getCells=function(n,t,i,r,u,f){var a,h,o,c,l,e;if(f=f!=null?f:[],i>0||r>0){var s=this.getModel(),v=n+i,y=t+r;if(u==null&&(u=this.getCurrentRoot(),u==null&&(u=s.getRoot())),u!=null)for(a=s.getChildCount(u),h=0;h<a;h++)o=s.getChildAt(u,h),c=this.view.getState(o),c!=null&&this.isCellVisible(o)&&(l=mxUtils.getValue(c.style,mxConstants.STYLE_ROTATION)||0,e=c,l!=0&&(e=mxUtils.getBoundingBox(e,l)),(s.isEdge(o)||s.isVertex(o))&&e.x>=n&&e.y+e.height<=y&&e.y>=t&&e.x+e.width<=v?f.push(o):this.getCells(n,t,i,r,o,f))}return f};mxGraph.prototype.getCellsBeyond=function(n,t,i,r,u){var s=[],h,f,e,o;if((r||u)&&(i==null&&(i=this.getDefaultParent()),i!=null))for(h=this.model.getChildCount(i),f=0;f<h;f++)e=this.model.getChildAt(i,f),o=this.view.getState(e),this.isCellVisible(e)&&o!=null&&(!r||o.x>=n)&&(!u||o.y>=t)&&s.push(e);return s};mxGraph.prototype.findTreeRoots=function(n,t,i){var u,o,r,s,y,c;if(t=t!=null?t:!1,i=i!=null?i:!1,u=[],n!=null){var l=this.getModel(),p=l.getChildCount(n),h=null,a=0;for(o=0;o<p;o++)if(r=l.getChildAt(n,o),this.model.isVertex(r)&&this.isCellVisible(r)){var v=this.getConnections(r,t?n:null),f=0,e=0;for(s=0;s<v.length;s++)y=this.view.getVisibleTerminal(v[s],!0),y==r?f++:e++;(i&&f==0&&e>0||!i&&e==0&&f>0)&&u.push(r);c=i?e-f:f-e;c>a&&(a=c,h=r)}u.length==0&&h!=null&&u.push(h)}return u};mxGraph.prototype.traverse=function(n,t,i,r,u,f){var s,h,e,o,c,l;if(i!=null&&n!=null&&(t=t!=null?t:!0,f=f!=null?f:!1,u=u||new mxDictionary,!u.get(n)&&(u.put(n,!0),s=i(n,r),(s==null||s)&&(h=this.model.getEdgeCount(n),h>0))))for(e=0;e<h;e++)o=this.model.getEdgeAt(n,e),c=this.model.getTerminal(o,!0)==n,t&&!f!=c||(l=this.model.getTerminal(o,!c),this.traverse(l,t,i,o,u,f))};mxGraph.prototype.isCellSelected=function(n){return this.getSelectionModel().isSelected(n)};mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty()};mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear()};mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length};mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0]};mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice()};mxGraph.prototype.setSelectionCell=function(n){this.getSelectionModel().setCell(n)};mxGraph.prototype.setSelectionCells=function(n){this.getSelectionModel().setCells(n)};mxGraph.prototype.addSelectionCell=function(n){this.getSelectionModel().addCell(n)};mxGraph.prototype.addSelectionCells=function(n){this.getSelectionModel().addCells(n)};mxGraph.prototype.removeSelectionCell=function(n){this.getSelectionModel().removeCell(n)};mxGraph.prototype.removeSelectionCells=function(n){this.getSelectionModel().removeCells(n)};mxGraph.prototype.selectRegion=function(n,t){var i=this.getCells(n.x,n.y,n.width,n.height);return this.selectCellsForEvent(i,t),i};mxGraph.prototype.selectNextCell=function(){this.selectCell(!0)};mxGraph.prototype.selectPreviousCell=function(){this.selectCell()};mxGraph.prototype.selectParentCell=function(){this.selectCell(!1,!0)};mxGraph.prototype.selectChildCell=function(){this.selectCell(!1,!1,!0)};mxGraph.prototype.selectCell=function(n,t,i){var s=this.selectionModel,u=s.cells.length>0?s.cells[0]:null,r,o,h,e,c,f;s.cells.length>1&&s.clear();r=u!=null?this.model.getParent(u):this.getDefaultParent();o=this.model.getChildCount(r);u==null&&o>0?(f=this.model.getChildAt(r,0),this.setSelectionCell(f)):(u==null||t)&&this.view.getState(r)!=null&&this.model.getGeometry(r)!=null?this.getCurrentRoot()!=r&&this.setSelectionCell(r):u!=null&&i?(h=this.model.getChildCount(u),h>0&&(f=this.model.getChildAt(u,0),this.setSelectionCell(f))):o>0&&(e=r.getIndex(u),n?(e++,f=this.model.getChildAt(r,e%o),this.setSelectionCell(f)):(e--,c=e<0?o-1:e,f=this.model.getChildAt(r,c),this.setSelectionCell(f)))};mxGraph.prototype.selectAll=function(n,t){n=n||this.getDefaultParent();var i=t?this.model.filterDescendants(function(t){return t!=n},n):this.model.getChildren(n);i!=null&&this.setSelectionCells(i)};mxGraph.prototype.selectVertices=function(n){this.selectCells(!0,!1,n)};mxGraph.prototype.selectEdges=function(n){this.selectCells(!1,!0,n)};mxGraph.prototype.selectCells=function(n,t,i){i=i||this.getDefaultParent();var r=mxUtils.bind(this,function(i){return this.view.getState(i)!=null&&(this.model.getChildCount(i)==0&&this.model.isVertex(i)&&n&&!this.model.isEdge(this.model.getParent(i))||this.model.isEdge(i)&&t)}),u=this.model.filterDescendants(r,i);this.setSelectionCells(u)};mxGraph.prototype.selectCellForEvent=function(n,t){var i=this.isCellSelected(n);this.isToggleEvent(t)?i?this.removeSelectionCell(n):this.addSelectionCell(n):i&&this.getSelectionCount()==1||this.setSelectionCell(n)};mxGraph.prototype.selectCellsForEvent=function(n,t){this.isToggleEvent(t)?this.addSelectionCells(n):this.setSelectionCells(n)};mxGraph.prototype.createHandler=function(n){var t=null;if(n!=null)if(this.model.isEdge(n.cell)){var r=n.getVisibleTerminalState(!0),u=n.getVisibleTerminalState(!1),i=this.getCellGeometry(n.cell),f=this.view.getEdgeStyle(n,i!=null?i.points:null,r,u);t=this.createEdgeHandler(n,f)}else t=this.createVertexHandler(n);return t};mxGraph.prototype.createVertexHandler=function(n){return new mxVertexHandler(n)};mxGraph.prototype.createEdgeHandler=function(n,t){return t==mxEdgeStyle.Loop||t==mxEdgeStyle.ElbowConnector||t==mxEdgeStyle.SideToSide||t==mxEdgeStyle.TopToBottom?this.createElbowEdgeHandler(n):t==mxEdgeStyle.SegmentConnector||t==mxEdgeStyle.OrthConnector?this.createEdgeSegmentHandler(n):new mxEdgeHandler(n)};mxGraph.prototype.createEdgeSegmentHandler=function(n){return new mxEdgeSegmentHandler(n)};mxGraph.prototype.createElbowEdgeHandler=function(n){return new mxElbowEdgeHandler(n)};mxGraph.prototype.addMouseListener=function(n){this.mouseListeners==null&&(this.mouseListeners=[]);this.mouseListeners.push(n)};mxGraph.prototype.removeMouseListener=function(n){if(this.mouseListeners!=null)for(var t=0;t<this.mouseListeners.length;t++)if(this.mouseListeners[t]==n){this.mouseListeners.splice(t,1);break}};mxGraph.prototype.updateMouseEvent=function(n,t){if(n.graphX==null||n.graphY==null){var i=mxUtils.convertPoint(this.container,n.getX(),n.getY());n.graphX=i.x-this.panDx;n.graphY=i.y-this.panDy;n.getCell()==null&&this.isMouseDown&&t==mxEvent.MOUSE_MOVE&&(n.state=this.view.getState(this.getCellAt(i.x,i.y,null,null,null,function(n){return n.shape==null||n.shape.paintBackground!=mxRectangleShape.prototype.paintBackground||mxUtils.getValue(n.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"||n.shape.fill!=null&&n.shape.fill!=mxConstants.NONE})))}return n};mxGraph.prototype.getStateForTouchEvent=function(n){var i=mxEvent.getClientX(n),r=mxEvent.getClientY(n),t=mxUtils.convertPoint(this.container,i,r);return this.view.getState(this.getCellAt(t.x,t.y))};mxGraph.prototype.isEventIgnored=function(n,t,i){var u=mxEvent.isMouseEvent(t.getEvent()),r=!1;return(t.getEvent()==this.lastEvent?r=!0:this.lastEvent=t.getEvent(),this.eventSource!=null&&n!=mxEvent.MOUSE_MOVE?(mxEvent.removeGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect),this.mouseMoveRedirect=null,this.mouseUpRedirect=null,this.eventSource=null):mxClient.IS_GC||this.eventSource==null||t.getSource()==this.eventSource?!mxClient.IS_TOUCH||n!=mxEvent.MOUSE_DOWN||u||mxEvent.isPenEvent(t.getEvent())||(this.eventSource=t.getSource(),this.mouseMoveRedirect=mxUtils.bind(this,function(n){this.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n,this.getStateForTouchEvent(n)))}),this.mouseUpRedirect=mxUtils.bind(this,function(n){this.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n,this.getStateForTouchEvent(n)))}),mxEvent.addGestureListeners(this.eventSource,null,this.mouseMoveRedirect,this.mouseUpRedirect)):r=!0,this.isSyntheticEventIgnored(n,t,i)&&(r=!0),!mxEvent.isPopupTrigger(this.lastEvent)&&n!=mxEvent.MOUSE_MOVE&&this.lastEvent.detail==2)?!0:(n==mxEvent.MOUSE_UP&&this.isMouseDown?this.isMouseDown=!1:n!=mxEvent.MOUSE_DOWN||this.isMouseDown?r||(mxClient.IS_FF&&n==mxEvent.MOUSE_MOVE||!this.isMouseDown||this.isMouseTrigger==u)&&(n!=mxEvent.MOUSE_DOWN||!this.isMouseDown)&&(n!=mxEvent.MOUSE_UP||this.isMouseDown)||(r=!0):(this.isMouseDown=!0,this.isMouseTrigger=u),r||n!=mxEvent.MOUSE_DOWN||(this.lastMouseX=t.getX(),this.lastMouseY=t.getY()),r)};mxGraph.prototype.isSyntheticEventIgnored=function(n,t){var i=!1,r=mxEvent.isMouseEvent(t.getEvent());return this.ignoreMouseEvents&&r&&n!=mxEvent.MOUSE_MOVE?(this.ignoreMouseEvents=n!=mxEvent.MOUSE_UP,i=!0):mxClient.IS_FF&&!r&&n==mxEvent.MOUSE_UP&&(this.ignoreMouseEvents=!0),i};mxGraph.prototype.isEventSourceIgnored=function(n,t){var i=t.getSource(),r=i.nodeName!=null?i.nodeName.toLowerCase():"",u=!mxEvent.isMouseEvent(t.getEvent())||mxEvent.isLeftMouseButton(t.getEvent());return n==mxEvent.MOUSE_DOWN&&u&&(r=="select"||r=="option"||r=="input"&&i.type!="checkbox"&&i.type!="radio"&&i.type!="button"&&i.type!="submit"&&i.type!="file")};mxGraph.prototype.getEventState=function(n){return n};mxGraph.prototype.fireMouseEvent=function(n,t,i){var o,s,u,l,h,c,f,e,r,a;if(this.isEventSourceIgnored(n,t)){this.tooltipHandler!=null&&this.tooltipHandler.hide();return}if(i==null&&(i=this),t=this.updateMouseEvent(t,n),!this.nativeDblClickEnabled&&!mxEvent.isPopupTrigger(t.getEvent())||this.doubleTapEnabled&&mxClient.IS_TOUCH&&(mxEvent.isTouchEvent(t.getEvent())||mxEvent.isPenEvent(t.getEvent())))if(o=(new Date).getTime(),(mxClient.IS_QUIRKS||n!=mxEvent.MOUSE_DOWN)&&(!mxClient.IS_QUIRKS||n!=mxEvent.MOUSE_UP||this.fireDoubleClick)){if((this.isMouseDown||n==mxEvent.MOUSE_UP)&&this.fireDoubleClick){this.fireDoubleClick=!1;u=this.lastTouchCell;this.lastTouchCell=null;this.isMouseDown=!1;l=u!=null||(mxEvent.isTouchEvent(t.getEvent())||mxEvent.isPenEvent(t.getEvent()))&&(mxClient.IS_GC||mxClient.IS_SF);l&&Math.abs(this.lastTouchX-t.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-t.getY())<this.doubleTapTolerance?this.dblClick(t.getEvent(),u):mxEvent.consume(t.getEvent());return}}else if(this.lastTouchEvent!=null&&this.lastTouchEvent!=t.getEvent()&&o-this.lastTouchTime<this.doubleTapTimeout&&Math.abs(this.lastTouchX-t.getX())<this.doubleTapTolerance&&Math.abs(this.lastTouchY-t.getY())<this.doubleTapTolerance&&this.doubleClickCounter<2){if(this.doubleClickCounter++,s=!1,n==mxEvent.MOUSE_UP?t.getCell()==this.lastTouchCell&&this.lastTouchCell!=null&&(this.lastTouchTime=0,u=this.lastTouchCell,this.lastTouchCell=null,mxClient.IS_QUIRKS&&t.getSource().fireEvent("ondblclick"),this.dblClick(t.getEvent(),u),s=!0):(this.fireDoubleClick=!0,this.lastTouchTime=0),!mxClient.IS_QUIRKS||s){mxEvent.consume(t.getEvent());return}}else(this.lastTouchEvent==null||this.lastTouchEvent!=t.getEvent())&&(this.lastTouchCell=t.getCell(),this.lastTouchX=t.getX(),this.lastTouchY=t.getY(),this.lastTouchTime=o,this.lastTouchEvent=t.getEvent(),this.doubleClickCounter=0);if(!this.isEventIgnored(n,t,i)){if(t.state=this.getEventState(t.getState()),this.fireEvent(new mxEventObject(mxEvent.FIRE_MOUSE_EVENT,"eventName",n,"event",t)),mxClient.IS_OP||mxClient.IS_SF||mxClient.IS_GC||mxClient.IS_IE11||mxClient.IS_IE&&mxClient.IS_SVG||t.getEvent().target!=this.container){if(n==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll&&!mxEvent.isMultiTouchEvent(t.getEvent)?this.scrollPointToVisible(t.getGraphX(),t.getGraphY(),this.autoExtend):n==mxEvent.MOUSE_UP&&this.ignoreScrollbars&&this.translateToScrollPosition&&(this.container.scrollLeft!=0||this.container.scrollTop!=0)&&(h=this.view.scale,c=this.view.translate,this.view.setTranslate(c.x-this.container.scrollLeft/h,c.y-this.container.scrollTop/h),this.container.scrollLeft=0,this.container.scrollTop=0),this.mouseListeners!=null)for(f=[i,t],t.getEvent().preventDefault||(t.getEvent().returnValue=!0),e=0;e<this.mouseListeners.length;e++)r=this.mouseListeners[e],n==mxEvent.MOUSE_DOWN?r.mouseDown.apply(r,f):n==mxEvent.MOUSE_MOVE?r.mouseMove.apply(r,f):n==mxEvent.MOUSE_UP&&r.mouseUp.apply(r,f);n==mxEvent.MOUSE_UP&&this.click(t)}(mxEvent.isTouchEvent(t.getEvent())||mxEvent.isPenEvent(t.getEvent()))&&n==mxEvent.MOUSE_DOWN&&this.tapAndHoldEnabled&&!this.tapAndHoldInProgress?(this.tapAndHoldInProgress=!0,this.initialTouchX=t.getGraphX(),this.initialTouchY=t.getGraphY(),a=function(){this.tapAndHoldValid&&this.tapAndHold(t);this.tapAndHoldInProgress=!1;this.tapAndHoldValid=!1},this.tapAndHoldThread&&window.clearTimeout(this.tapAndHoldThread),this.tapAndHoldThread=window.setTimeout(mxUtils.bind(this,a),this.tapAndHoldDelay),this.tapAndHoldValid=!0):n==mxEvent.MOUSE_UP?(this.tapAndHoldInProgress=!1,this.tapAndHoldValid=!1):this.tapAndHoldValid&&(this.tapAndHoldValid=Math.abs(this.initialTouchX-t.getGraphX())<this.tolerance&&Math.abs(this.initialTouchY-t.getGraphY())<this.tolerance);n==mxEvent.MOUSE_DOWN&&this.isEditing()&&!this.cellEditor.isEventSource(t.getEvent())&&this.stopEditing(!this.isInvokesStopCellEditing());this.consumeMouseEvent(n,t,i)}};mxGraph.prototype.consumeMouseEvent=function(n,t){n==mxEvent.MOUSE_DOWN&&mxEvent.isTouchEvent(t.getEvent())&&t.consume(!1)};mxGraph.prototype.fireGestureEvent=function(n,t){this.lastTouchTime=0;this.fireEvent(new mxEventObject(mxEvent.GESTURE,"event",n,"cell",t))};mxGraph.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.tooltipHandler!=null&&this.tooltipHandler.destroy(),this.selectionCellsHandler!=null&&this.selectionCellsHandler.destroy(),this.panningHandler!=null&&this.panningHandler.destroy(),this.popupMenuHandler!=null&&this.popupMenuHandler.destroy(),this.connectionHandler!=null&&this.connectionHandler.destroy(),this.graphHandler!=null&&this.graphHandler.destroy(),this.cellEditor!=null&&this.cellEditor.destroy(),this.view!=null&&this.view.destroy(),this.model!=null&&this.graphModelChangeListener!=null&&(this.model.removeListener(this.graphModelChangeListener),this.graphModelChangeListener=null),this.container=null)};mxCellOverlay.prototype=new mxEventSource;mxCellOverlay.prototype.constructor=mxCellOverlay;mxCellOverlay.prototype.image=null;mxCellOverlay.prototype.tooltip=null;mxCellOverlay.prototype.align=mxConstants.ALIGN_RIGHT;mxCellOverlay.prototype.verticalAlign=mxConstants.ALIGN_BOTTOM;mxCellOverlay.prototype.offset=null;mxCellOverlay.prototype.cursor=null;mxCellOverlay.prototype.defaultOverlap=.5;mxCellOverlay.prototype.getBounds=function(n){var h=n.view.graph.getModel().isEdge(n.cell),r=n.view.scale,t=null,f=this.image.width,e=this.image.height,i;if(h)if(i=n.absolutePoints,i.length%2==1)t=i[Math.floor(i.length/2)];else{var o=i.length/2,u=i[o-1],s=i[o];t=new mxPoint(u.x+(s.x-u.x)/2,u.y+(s.y-u.y)/2)}else t=new mxPoint,t.x=this.align==mxConstants.ALIGN_LEFT?n.x:this.align==mxConstants.ALIGN_CENTER?n.x+n.width/2:n.x+n.width,t.y=this.verticalAlign==mxConstants.ALIGN_TOP?n.y:this.verticalAlign==mxConstants.ALIGN_MIDDLE?n.y+n.height/2:n.y+n.height;return new mxRectangle(Math.round(t.x-(f*this.defaultOverlap-this.offset.x)*r),Math.round(t.y-(e*this.defaultOverlap-this.offset.y)*r),f*r,e*r)};mxCellOverlay.prototype.toString=function(){return this.tooltip};mxOutline.prototype.source=null;mxOutline.prototype.outline=null;mxOutline.prototype.graphRenderHint=mxConstants.RENDERING_HINT_FASTER;mxOutline.prototype.enabled=!0;mxOutline.prototype.showViewport=!0;mxOutline.prototype.border=10;mxOutline.prototype.sizerSize=8;mxOutline.prototype.labelsVisible=!1;mxOutline.prototype.updateOnPan=!1;mxOutline.prototype.sizerImage=null;mxOutline.prototype.minScale=.0001;mxOutline.prototype.suspended=!1;mxOutline.prototype.forceVmlHandles=document.documentMode==8;mxOutline.prototype.createGraph=function(n){var t=new mxGraph(n,this.source.getModel(),this.graphRenderHint,this.source.getStylesheet());return t.foldingEnabled=!1,t.autoScroll=!1,t};mxOutline.prototype.init=function(n){var u,i,t,r;this.outline=this.createGraph(n);u=this.outline.graphModelChanged;this.outline.graphModelChanged=mxUtils.bind(this,function(){this.suspended||this.outline==null||u.apply(this.outline,arguments)});mxClient.IS_SVG&&(i=this.outline.getView().getCanvas().parentNode,i.setAttribute("shape-rendering","optimizeSpeed"),i.setAttribute("image-rendering","optimizeSpeed"));this.outline.labelsVisible=this.labelsVisible;this.outline.setEnabled(!1);this.updateHandler=mxUtils.bind(this,function(){this.suspended||this.active||this.update()});this.source.getModel().addListener(mxEvent.CHANGE,this.updateHandler);this.outline.addMouseListener(this);t=this.source.getView();t.addListener(mxEvent.SCALE,this.updateHandler);t.addListener(mxEvent.TRANSLATE,this.updateHandler);t.addListener(mxEvent.SCALE_AND_TRANSLATE,this.updateHandler);t.addListener(mxEvent.DOWN,this.updateHandler);t.addListener(mxEvent.UP,this.updateHandler);mxEvent.addListener(this.source.container,"scroll",this.updateHandler);this.panHandler=mxUtils.bind(this,function(){this.updateOnPan&&this.updateHandler.apply(this,arguments)});this.source.addListener(mxEvent.PAN,this.panHandler);this.refreshHandler=mxUtils.bind(this,function(){this.outline.setStylesheet(this.source.getStylesheet());this.outline.refresh()});this.source.addListener(mxEvent.REFRESH,this.refreshHandler);this.bounds=new mxRectangle(0,0,0,0);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=this.outline.dialect;this.forceVmlHandles&&(this.selectionBorder.isHtmlAllowed=function(){return!1});this.selectionBorder.init(this.outline.getView().getOverlayPane());r=mxUtils.bind(this,function(n){var t=mxEvent.getSource(n),i=mxUtils.bind(this,function(n){this.outline.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(n))}),r=mxUtils.bind(this,function(n){mxEvent.removeGestureListeners(t,null,i,r);this.outline.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(n))});mxEvent.addGestureListeners(t,null,i,r);this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n))});mxEvent.addGestureListeners(this.selectionBorder.node,r);this.sizer=this.createSizer();this.forceVmlHandles&&(this.sizer.isHtmlAllowed=function(){return!1});this.sizer.init(this.outline.getView().getOverlayPane());this.enabled&&(this.sizer.node.style.cursor="nwse-resize");mxEvent.addGestureListeners(this.sizer.node,r);this.selectionBorder.node.style.display=this.showViewport?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;this.selectionBorder.node.style.cursor="move";this.update(!1)};mxOutline.prototype.isEnabled=function(){return this.enabled};mxOutline.prototype.setEnabled=function(n){this.enabled=n};mxOutline.prototype.setZoomEnabled=function(n){this.sizer.node.style.visibility=n?"visible":"hidden"};mxOutline.prototype.refresh=function(){this.update(!0)};mxOutline.prototype.createSizer=function(){var n;return this.sizerImage!=null?(n=new mxImageShape(new mxRectangle(0,0,this.sizerImage.width,this.sizerImage.height),this.sizerImage.src),n.dialect=this.outline.dialect,n):(n=new mxRectangleShape(new mxRectangle(0,0,this.sizerSize,this.sizerSize),mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR),n.dialect=this.outline.dialect,n)};mxOutline.prototype.getSourceContainerSize=function(){return new mxRectangle(0,0,this.source.container.scrollWidth,this.source.container.scrollHeight)};mxOutline.prototype.getOutlineOffset=function(){return null};mxOutline.prototype.getSourceGraphBounds=function(){return this.source.getGraphBounds()};mxOutline.prototype.update=function(n){var i,v,t,f;if(this.source!=null&&this.outline!=null){var r=this.source.view.scale,h=this.getSourceGraphBounds(),e=new mxRectangle(h.x/r+this.source.panDx,h.y/r+this.source.panDy,h.width/r,h.height/r),d=new mxRectangle(0,0,this.source.container.clientWidth/r,this.source.container.clientHeight/r),l=e.clone();l.add(d);var y=this.getSourceContainerSize(),g=Math.max(y.width/r,l.width),nt=Math.max(y.height/r,l.height),tt=Math.max(0,this.outline.container.clientWidth-this.border),it=Math.max(0,this.outline.container.clientHeight-this.border),p=Math.min(tt/g,it/nt),u=isNaN(p)?this.minScale:Math.max(this.minScale,p);if(u>0){this.outline.getView().scale!=u&&(this.outline.getView().scale=u,n=!0);i=this.outline.getView();i.currentRoot!=this.source.getView().currentRoot&&i.setCurrentRoot(this.source.getView().currentRoot);var c=this.source.view.translate,o=c.x+this.source.panDx,s=c.y+this.source.panDy,a=this.getOutlineOffset(u);a!=null&&(o+=a.x,s+=a.y);e.x<0&&(o=o-e.x);e.y<0&&(s=s-e.y);(i.translate.x!=o||i.translate.y!=s)&&(i.translate.x=o,i.translate.y=s,n=!0);v=i.translate;u=this.source.getView().scale;var w=u/i.scale,b=1/i.scale,k=this.source.container;this.bounds=new mxRectangle((v.x-c.x-this.source.panDx)/b,(v.y-c.y-this.source.panDy)/b,k.clientWidth/w,k.clientHeight/w);this.bounds.x+=this.source.container.scrollLeft*i.scale/u;this.bounds.y+=this.source.container.scrollTop*i.scale/u;t=this.selectionBorder.bounds;(t.x!=this.bounds.x||t.y!=this.bounds.y||t.width!=this.bounds.width||t.height!=this.bounds.height)&&(this.selectionBorder.bounds=this.bounds,this.selectionBorder.redraw());t=this.sizer.bounds;f=new mxRectangle(this.bounds.x+this.bounds.width-t.width/2,this.bounds.y+this.bounds.height-t.height/2,t.width,t.height);(t.x!=f.x||t.y!=f.y||t.width!=f.width||t.height!=f.height)&&(this.sizer.bounds=f,this.sizer.node.style.visibility!="hidden"&&this.sizer.redraw());n&&this.outline.view.revalidate()}}};mxOutline.prototype.mouseDown=function(n,t){if(this.enabled&&this.showViewport){var i=mxEvent.isMouseEvent(t.getEvent())?0:this.source.tolerance,r=this.source.allowHandleBoundsCheck&&(mxClient.IS_IE||i>0)?new mxRectangle(t.getGraphX()-i,t.getGraphY()-i,2*i,2*i):null;this.zoom=t.isSource(this.sizer)||r!=null&&mxUtils.intersects(shape.bounds,r);this.startX=t.getX();this.startY=t.getY();this.active=!0;this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)?(this.dx0=this.source.container.scrollLeft,this.dy0=this.source.container.scrollTop):(this.dx0=0,this.dy0=0)}t.consume()};mxOutline.prototype.mouseMove=function(n,t){var e,o,h,f;if(this.active){this.selectionBorder.node.style.display=this.showViewport?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;var s=this.getTranslateForEvent(t),r=s.x,u=s.y,i=null;this.zoom?(o=this.source.container,h=o.clientWidth/o.clientHeight,u=r/h,i=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+r),Math.max(1,this.bounds.height+u)),this.selectionBorder.bounds=i,this.selectionBorder.redraw()):(e=this.outline.getView().scale,i=new mxRectangle(this.bounds.x+r,this.bounds.y+u,this.bounds.width,this.bounds.height),this.selectionBorder.bounds=i,this.selectionBorder.redraw(),r/=e,r*=this.source.getView().scale,u/=e,u*=this.source.getView().scale,this.source.panGraph(-r-this.dx0,-u-this.dy0));f=this.sizer.bounds;this.sizer.bounds=new mxRectangle(i.x+i.width-f.width/2,i.y+i.height-f.height/2,f.width,f.height);this.sizer.node.style.visibility!="hidden"&&this.sizer.redraw();t.consume()}};mxOutline.prototype.getTranslateForEvent=function(n){return new mxPoint(n.getX()-this.startX,n.getY()-this.startY)};mxOutline.prototype.mouseUp=function(n,t){var u,o,f;if(this.active){var e=this.getTranslateForEvent(t),i=e.x,r=e.y;(Math.abs(i)>0||Math.abs(r)>0)&&(this.zoom?(o=this.selectionBorder.bounds.width,f=this.source.getView().scale,this.source.zoomTo(Math.max(this.minScale,f-i*f/o),!1)):this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)||(this.source.panGraph(0,0),i/=this.outline.getView().scale,r/=this.outline.getView().scale,u=this.source.getView().translate,this.source.getView().setTranslate(u.x-i,u.y-r)),this.update(),t.consume());this.index=null;this.active=!1}};mxOutline.prototype.destroy=function(){this.source!=null&&(this.source.removeListener(this.panHandler),this.source.removeListener(this.refreshHandler),this.source.getModel().removeListener(this.updateHandler),this.source.getView().removeListener(this.updateHandler),mxEvent.addListener(this.source.container,"scroll",this.updateHandler),this.source=null);this.outline!=null&&(this.outline.removeMouseListener(this),this.outline.destroy(),this.outline=null);this.selectionBorder!=null&&(this.selectionBorder.destroy(),this.selectionBorder=null);this.sizer!=null&&(this.sizer.destroy(),this.sizer=null)};mxMultiplicity.prototype.type=null;mxMultiplicity.prototype.attr=null;mxMultiplicity.prototype.value=null;mxMultiplicity.prototype.source=null;mxMultiplicity.prototype.min=null;mxMultiplicity.prototype.max=null;mxMultiplicity.prototype.validNeighbors=null;mxMultiplicity.prototype.validNeighborsAllowed=!0;mxMultiplicity.prototype.countError=null;mxMultiplicity.prototype.typeError=null;mxMultiplicity.prototype.check=function(n,t,i,r,u,f){var e="",o;return(this.source&&this.checkTerminal(n,i,t)||!this.source&&this.checkTerminal(n,r,t))&&(this.countError!=null&&(this.source&&(this.max==0||u>=this.max)||!this.source&&(this.max==0||f>=this.max))&&(e+=this.countError+"\n"),this.validNeighbors!=null&&this.typeError!=null&&this.validNeighbors.length>0&&(o=this.checkNeighbors(n,t,i,r),o||(e+=this.typeError+"\n"))),e.length>0?e:null};mxMultiplicity.prototype.checkNeighbors=function(n,t,i,r){for(var o=n.model.getValue(i),s=n.model.getValue(r),f=!this.validNeighborsAllowed,e=this.validNeighbors,u=0;u<e.length;u++)if(this.source&&this.checkType(n,s,e[u])){f=this.validNeighborsAllowed;break}else if(!this.source&&this.checkType(n,o,e[u])){f=this.validNeighborsAllowed;break}return f};mxMultiplicity.prototype.checkTerminal=function(n,t){var i=n.model.getValue(t);return this.checkType(n,i,this.type,this.attr,this.value)};mxMultiplicity.prototype.checkType=function(n,t,i,r,u){return t!=null?isNaN(t.nodeType)?t==i:mxUtils.isNode(t,i,r,u):!1};mxLayoutManager.prototype=new mxEventSource;mxLayoutManager.prototype.constructor=mxLayoutManager;mxLayoutManager.prototype.graph=null;mxLayoutManager.prototype.bubbling=!0;mxLayoutManager.prototype.enabled=!0;mxLayoutManager.prototype.updateHandler=null;mxLayoutManager.prototype.moveHandler=null;mxLayoutManager.prototype.isEnabled=function(){return this.enabled};mxLayoutManager.prototype.setEnabled=function(n){this.enabled=n};mxLayoutManager.prototype.isBubbling=function(){return this.bubbling};mxLayoutManager.prototype.setBubbling=function(n){this.bubbling=n};mxLayoutManager.prototype.getGraph=function(){return this.graph};mxLayoutManager.prototype.setGraph=function(n){var t;this.graph!=null&&(t=this.graph.getModel(),t.removeListener(this.undoHandler),this.graph.removeListener(this.moveHandler));this.graph=n;this.graph!=null&&(t=this.graph.getModel(),t.addListener(mxEvent.BEFORE_UNDO,this.undoHandler),this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler))};mxLayoutManager.prototype.getLayout=function(){return null};mxLayoutManager.prototype.beforeUndo=function(n){for(var i=this.getCellsForChanges(n.changes),r=this.getGraph().getModel(),t=[],u=0;u<i.length;u++)t=t.concat(r.getDescendants(i[u]));if(i=t,this.isBubbling())for(t=r.getParents(i);t.length>0;)i=i.concat(t),t=r.getParents(t);this.executeLayoutForCells(i)};mxLayoutManager.prototype.executeLayoutForCells=function(n){var t=mxUtils.sortCells(n,!0);t=t.concat(t.slice().reverse());this.layoutCells(t)};mxLayoutManager.prototype.cellsMoved=function(n,t){var r,e,i,u,f;if(n!=null&&t!=null)for(r=mxUtils.convertPoint(this.getGraph().container,mxEvent.getClientX(t),mxEvent.getClientY(t)),e=this.getGraph().getModel(),i=0;i<n.length;i++)u=e.getParent(n[i]),mxUtils.indexOf(n,u)<0&&(f=this.getLayout(u),f!=null&&f.moveCell(n[i],r.x,r.y))};mxLayoutManager.prototype.getCellsForChanges=function(n){for(var u,i,t,f=new mxDictionary,e=[],r=0;r<n.length;r++){if(u=n[r],u instanceof mxRootChange)return[];for(i=this.getCellsForChange(u),t=0;t<i.length;t++)i[t]==null||f.get(i[t])||(f.put(i[t],!0),e.push(i[t]))}return e};mxLayoutManager.prototype.getCellsForChange=function(n){var t=this.getGraph().getModel();return n instanceof mxChildChange?[n.child,n.previous,t.getParent(n.child)]:n instanceof mxTerminalChange||n instanceof mxGeometryChange?[n.cell,t.getParent(n.cell)]:n instanceof mxVisibleChange||n instanceof mxStyleChange?[n.cell]:[]};mxLayoutManager.prototype.layoutCells=function(n){var i,r,t;if(n.length>0){i=this.getGraph().getModel();i.beginUpdate();try{for(r=null,t=0;t<n.length;t++)n[t]!=i.getRoot()&&n[t]!=r&&this.executeLayout(this.getLayout(n[t]),n[t])&&(r=n[t]);this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",n))}finally{i.endUpdate()}}};mxLayoutManager.prototype.executeLayout=function(n,t){var i=!1;return n!=null&&t!=null&&(n.execute(t),i=!0),i};mxLayoutManager.prototype.destroy=function(){this.setGraph(null)};mxSwimlaneManager.prototype=new mxEventSource;mxSwimlaneManager.prototype.constructor=mxSwimlaneManager;mxSwimlaneManager.prototype.graph=null;mxSwimlaneManager.prototype.enabled=!0;mxSwimlaneManager.prototype.horizontal=!0;mxSwimlaneManager.prototype.addEnabled=!0;mxSwimlaneManager.prototype.resizeEnabled=!0;mxSwimlaneManager.prototype.addHandler=null;mxSwimlaneManager.prototype.resizeHandler=null;mxSwimlaneManager.prototype.isEnabled=function(){return this.enabled};mxSwimlaneManager.prototype.setEnabled=function(n){this.enabled=n};mxSwimlaneManager.prototype.isHorizontal=function(){return this.horizontal};mxSwimlaneManager.prototype.setHorizontal=function(n){this.horizontal=n};mxSwimlaneManager.prototype.isAddEnabled=function(){return this.addEnabled};mxSwimlaneManager.prototype.setAddEnabled=function(n){this.addEnabled=n};mxSwimlaneManager.prototype.isResizeEnabled=function(){return this.resizeEnabled};mxSwimlaneManager.prototype.setResizeEnabled=function(n){this.resizeEnabled=n};mxSwimlaneManager.prototype.getGraph=function(){return this.graph};mxSwimlaneManager.prototype.setGraph=function(n){this.graph!=null&&(this.graph.removeListener(this.addHandler),this.graph.removeListener(this.resizeHandler));this.graph=n;this.graph!=null&&(this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler),this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler))};mxSwimlaneManager.prototype.isSwimlaneIgnored=function(n){return!this.getGraph().isSwimlane(n)};mxSwimlaneManager.prototype.isCellHorizontal=function(n){if(this.graph.isSwimlane(n)){var t=this.graph.getCellStyle(n);return mxUtils.getValue(t,mxConstants.STYLE_HORIZONTAL,1)==1}return!this.isHorizontal()};mxSwimlaneManager.prototype.cellsAdded=function(n){var i,t;if(n!=null){i=this.getGraph().getModel();i.beginUpdate();try{for(t=0;t<n.length;t++)this.isSwimlaneIgnored(n[t])||this.swimlaneAdded(n[t])}finally{i.endUpdate()}}};mxSwimlaneManager.prototype.swimlaneAdded=function(n){for(var u,e,i=this.getGraph().getModel(),r=i.getParent(n),o=i.getChildCount(r),t=null,f=0;f<o;f++)if(u=i.getChildAt(r,f),u!=n&&!this.isSwimlaneIgnored(u)&&(t=i.getGeometry(u),t!=null))break;t!=null&&(e=r!=null?this.isCellHorizontal(r):this.horizontal,this.resizeSwimlane(n,t.width,t.height,e))};mxSwimlaneManager.prototype.cellsResized=function(n){var r,i,u,o,s;if(n!=null){r=this.getGraph().getModel();r.beginUpdate();try{for(i=0;i<n.length;i++)if(!this.isSwimlaneIgnored(n[i])&&(u=r.getGeometry(n[i]),u!=null)){for(var f=new mxRectangle(0,0,u.width,u.height),e=n[i],t=e;t!=null;)e=t,t=r.getParent(t),o=this.graph.isSwimlane(t)?this.graph.getStartSize(t):new mxRectangle,f.width+=o.width,f.height+=o.height;s=t!=null?this.isCellHorizontal(t):this.horizontal;this.resizeSwimlane(e,f.width,f.height,s)}}finally{r.endUpdate()}}};mxSwimlaneManager.prototype.resizeSwimlane=function(n,t,i,r){var f=this.getGraph().getModel(),s,u,o,h,e,c;f.beginUpdate();try{for(s=this.isCellHorizontal(n),this.isSwimlaneIgnored(n)||(u=f.getGeometry(n),u!=null&&(r&&u.height!=i||!r&&u.width!=t)&&(u=u.clone(),r?u.height=i:u.width=t,f.setGeometry(n,u))),o=this.graph.isSwimlane(n)?this.graph.getStartSize(n):new mxRectangle,t-=o.width,i-=o.height,h=f.getChildCount(n),e=0;e<h;e++)c=f.getChildAt(n,e),this.resizeSwimlane(c,t,i,s)}finally{f.endUpdate()}};mxSwimlaneManager.prototype.destroy=function(){this.setGraph(null)};mxTemporaryCellStates.prototype.view=null;mxTemporaryCellStates.prototype.oldStates=null;mxTemporaryCellStates.prototype.oldBounds=null;mxTemporaryCellStates.prototype.oldScale=null;mxTemporaryCellStates.prototype.destroy=function(){this.view.setScale(this.oldScale);this.view.setStates(this.oldStates);this.view.setGraphBounds(this.oldBounds);this.view.validateCellState=this.oldValidateCellState;this.view.graph.cellRenderer.doRedrawShape=this.oldDoRedrawShape};mxCellStatePreview.prototype.graph=null;mxCellStatePreview.prototype.deltas=null;mxCellStatePreview.prototype.count=0;mxCellStatePreview.prototype.isEmpty=function(){return this.count==0};mxCellStatePreview.prototype.moveState=function(n,t,i,r,u){r=r!=null?r:!0;u=u!=null?u:!0;var f=this.deltas.get(n.cell);return f==null?(f={point:new mxPoint(t,i),state:n},this.deltas.put(n.cell,f),this.count++):r?(f.point.x+=t,f.point.y+=i):(f.point.x=t,f.point.y=i),u&&this.addEdges(n),f.point};mxCellStatePreview.prototype.show=function(n){this.deltas.visit(mxUtils.bind(this,function(n,t){this.translateState(t.state,t.point.x,t.point.y)}));this.deltas.visit(mxUtils.bind(this,function(t,i){this.revalidateState(i.state,i.point.x,i.point.y,n)}))};mxCellStatePreview.prototype.translateState=function(n,t,i){var r,f,e,u;if(n!=null)for(r=this.graph.getModel(),r.isVertex(n.cell)&&(n.view.updateCellState(n),f=r.getGeometry(n.cell),t==0&&i==0||f==null||f.relative&&this.deltas.get(n.cell)==null||(n.x+=t,n.y+=i)),e=r.getChildCount(n.cell),u=0;u<e;u++)this.translateState(n.view.getState(r.getChildAt(n.cell,u)),t,i)};mxCellStatePreview.prototype.revalidateState=function(n,t,i,r){var u,e,o,s,f;if(n!=null)for(u=this.graph.getModel(),u.isEdge(n.cell)&&n.view.updateCellState(n),e=this.graph.getCellGeometry(n.cell),o=n.view.getState(u.getParent(n.cell)),(t!=0||i!=0)&&e!=null&&e.relative&&u.isVertex(n.cell)&&(o==null||u.isVertex(o.cell)||this.deltas.get(n.cell)!=null)&&(n.x+=t,n.y+=i),this.graph.cellRenderer.redraw(n),r!=null&&r(n),s=u.getChildCount(n.cell),f=0;f<s;f++)this.revalidateState(this.graph.view.getState(u.getChildAt(n.cell,f)),t,i,r)};mxCellStatePreview.prototype.addEdges=function(n){for(var i,r=this.graph.getModel(),u=r.getEdgeCount(n.cell),t=0;t<u;t++)i=n.view.getState(r.getEdgeAt(n.cell,t)),i!=null&&this.moveState(i,0,0)};mxConnectionConstraint.prototype.point=null;mxConnectionConstraint.prototype.perimeter=null;mxConnectionConstraint.prototype.name=null;mxGraphHandler.prototype.graph=null;mxGraphHandler.prototype.maxCells=mxClient.IS_IE?20:50;mxGraphHandler.prototype.enabled=!0;mxGraphHandler.prototype.highlightEnabled=!0;mxGraphHandler.prototype.cloneEnabled=!0;mxGraphHandler.prototype.moveEnabled=!0;mxGraphHandler.prototype.guidesEnabled=!1;mxGraphHandler.prototype.guide=null;mxGraphHandler.prototype.currentDx=null;mxGraphHandler.prototype.currentDy=null;mxGraphHandler.prototype.updateCursor=!0;mxGraphHandler.prototype.selectEnabled=!0;mxGraphHandler.prototype.removeCellsFromParent=!0;mxGraphHandler.prototype.connectOnDrop=!1;mxGraphHandler.prototype.scrollOnMove=!0;mxGraphHandler.prototype.minimumSize=6;mxGraphHandler.prototype.previewColor="black";mxGraphHandler.prototype.htmlPreview=!1;mxGraphHandler.prototype.shape=null;mxGraphHandler.prototype.scaleGrid=!1;mxGraphHandler.prototype.rotationEnabled=!0;mxGraphHandler.prototype.isEnabled=function(){return this.enabled};mxGraphHandler.prototype.setEnabled=function(n){this.enabled=n};mxGraphHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled};mxGraphHandler.prototype.setCloneEnabled=function(n){this.cloneEnabled=n};mxGraphHandler.prototype.isMoveEnabled=function(){return this.moveEnabled};mxGraphHandler.prototype.setMoveEnabled=function(n){this.moveEnabled=n};mxGraphHandler.prototype.isSelectEnabled=function(){return this.selectEnabled};mxGraphHandler.prototype.setSelectEnabled=function(n){this.selectEnabled=n};mxGraphHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent};mxGraphHandler.prototype.setRemoveCellsFromParent=function(n){this.removeCellsFromParent=n};mxGraphHandler.prototype.getInitialCellForEvent=function(n){return n.getCell()};mxGraphHandler.prototype.isDelayedSelection=function(n){return this.graph.isCellSelected(n)};mxGraphHandler.prototype.consumeMouseEvent=function(n,t){t.consume()};mxGraphHandler.prototype.mouseDown=function(n,t){var i,r,u;!t.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&t.getState()!=null&&!mxEvent.isMultiTouchEvent(t.getEvent())&&(i=this.getInitialCellForEvent(t),this.delayedSelection=this.isDelayedSelection(i,t),this.cell=null,this.isSelectEnabled()&&!this.delayedSelection&&this.graph.selectCellForEvent(i,t.getEvent()),this.isMoveEnabled()&&(r=this.graph.model,u=r.getGeometry(i),this.graph.isCellMovable(i)&&(!r.isEdge(i)||this.graph.getSelectionCount()>1||u.points!=null&&u.points.length>0||r.getTerminal(i,!0)==null||r.getTerminal(i,!1)==null||this.graph.allowDanglingEdges||this.graph.isCloneEvent(t.getEvent())&&this.graph.isCellsCloneable())?this.start(i,t.getX(),t.getY()):this.delayedSelection&&(this.cell=i),this.cellWasClicked=!0,this.consumeMouseEvent(mxEvent.MOUSE_DOWN,t)))};mxGraphHandler.prototype.getGuideStates=function(){var t=this.graph.getDefaultParent(),n=this.graph.getModel(),i=mxUtils.bind(this,function(t){return this.graph.view.getState(t)!=null&&n.isVertex(t)&&n.getGeometry(t)!=null&&!n.getGeometry(t).relative});return this.graph.view.getCellStates(n.filterDescendants(i,t))};mxGraphHandler.prototype.getCells=function(n){return!this.delayedSelection&&this.graph.isCellMovable(n)?[n]:this.graph.getMovableCells(this.graph.getSelectionCells())};mxGraphHandler.prototype.getPreviewBounds=function(n){var t=this.getBoundingBox(n),i,u,f,r;return t!=null&&(t.width=Math.max(0,t.width-1),t.height=Math.max(0,t.height-1),t.width<this.minimumSize?(i=this.minimumSize-t.width,t.x-=i/2,t.width=this.minimumSize):(t.x=Math.round(t.x),t.width=Math.ceil(t.width)),u=this.graph.view.translate,f=this.graph.view.scale,t.height<this.minimumSize?(r=this.minimumSize-t.height,t.y-=r/2,t.height=this.minimumSize):(t.y=Math.round(t.y),t.height=Math.ceil(t.height))),t};mxGraphHandler.prototype.getBoundingBox=function(n){var r=null,u,t,i,f;if(n!=null&&n.length>0)for(u=this.graph.getModel(),t=0;t<n.length;t++)(u.isVertex(n[t])||u.isEdge(n[t]))&&(i=this.graph.view.getState(n[t]),i!=null&&(f=i,u.isVertex(n[t])&&i.shape!=null&&i.shape.boundingBox!=null&&(f=i.shape.boundingBox),r==null?r=mxRectangle.fromRectangle(f):r.add(f)));return r};mxGraphHandler.prototype.createPreviewShape=function(n){var t=new mxRectangleShape(n,null,this.previewColor);return t.isDashed=!0,this.htmlPreview?(t.dialect=mxConstants.DIALECT_STRICTHTML,t.init(this.graph.container)):(t.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,t.init(this.graph.getView().getOverlayPane()),t.pointerEvents=!1,mxClient.IS_IOS&&(t.getSvgScreenOffset=function(){return 0})),t};mxGraphHandler.prototype.start=function(n,t,i){this.cell=n;this.first=mxUtils.convertPoint(this.graph.container,t,i);this.cells=this.getCells(this.cell);this.bounds=this.graph.getView().getBounds(this.cells);this.pBounds=this.getPreviewBounds(this.cells);this.guidesEnabled&&(this.guide=new mxGuide(this.graph,this.getGuideStates()))};mxGraphHandler.prototype.useGuidesForEvent=function(n){return this.guide!=null?this.guide.isEnabledForEvent(n.getEvent()):!0};mxGraphHandler.prototype.snap=function(n){var t=this.scaleGrid?this.graph.view.scale:1;return n.x=this.graph.snap(n.x/t)*t,n.y=this.graph.snap(n.y/t)*t,n};mxGraphHandler.prototype.getDelta=function(n){var i=mxUtils.convertPoint(this.graph.container,n.getX(),n.getY()),t=this.graph.view.scale;return new mxPoint(this.roundLength((i.x-this.first.x)/t)*t,this.roundLength((i.y-this.first.y)/t)*t)};mxGraphHandler.prototype.updateHint=function(){};mxGraphHandler.prototype.removeHint=function(){};mxGraphHandler.prototype.roundLength=function(n){return Math.round(n*2)/2};mxGraphHandler.prototype.mouseMove=function(n,t){var i=this.graph,v,y,e,l,k,d,a;if(!t.isConsumed()&&i.isMouseDown&&this.cell!=null&&this.first!=null&&this.bounds!=null){if(mxEvent.isMultiTouchEvent(t.getEvent())){this.reset();return}var o=this.getDelta(t),r=o.x,u=o.y,p=i.tolerance;if(this.shape!=null||Math.abs(r)>p||Math.abs(u)>p){if(this.highlight==null&&(this.highlight=new mxCellHighlight(this.graph,mxConstants.DROP_TARGET_COLOR,3)),this.shape==null&&(this.shape=this.createPreviewShape(this.bounds)),v=i.isGridEnabledEvent(t.getEvent()),y=!0,this.guide!=null&&this.useGuidesForEvent(t))o=this.guide.move(this.bounds,new mxPoint(r,u),v),y=!1,r=o.x,u=o.y;else if(v){var h=i.getView().translate,c=i.getView().scale,g=this.bounds.x-(i.snap(this.bounds.x/c-h.x)+h.x)*c,nt=this.bounds.y-(i.snap(this.bounds.y/c-h.y)+h.y)*c,w=this.snap(new mxPoint(r,u));r=w.x-g;u=w.y-nt}this.guide!=null&&y&&this.guide.hide();i.isConstrainedEvent(t.getEvent())&&(Math.abs(r)>Math.abs(u)?u=0:r=0);this.currentDx=r;this.currentDy=u;this.updatePreviewShape();var s=null,f=t.getCell(),b=i.isCloneEvent(t.getEvent())&&i.isCellsCloneable()&&this.isCloneEnabled();i.isDropEnabled()&&this.highlightEnabled&&(s=i.getDropTarget(this.cells,t.getEvent(),f,b));e=i.getView().getState(s);l=!1;e!=null&&(i.model.getParent(this.cell)!=s||b)?(this.target!=s&&(this.target=s,this.setHighlightColor(mxConstants.DROP_TARGET_COLOR)),l=!0):(this.target=null,this.connectOnDrop&&f!=null&&this.cells.length==1&&i.getModel().isVertex(f)&&i.isCellConnectable(f)&&(e=i.getView().getState(f),e!=null&&(k=i.getEdgeValidationError(null,this.cell,f),d=k==null?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR,this.setHighlightColor(d),l=!0)));e!=null&&l?this.highlight.highlight(e):this.highlight.hide()}this.updateHint(t);this.consumeMouseEvent(mxEvent.MOUSE_MOVE,t);mxEvent.consume(t.getEvent())}else(this.isMoveEnabled()||this.isCloneEnabled())&&this.updateCursor&&!t.isConsumed()&&t.getState()!=null&&!i.isMouseDown&&(a=i.getCursorForMouseEvent(t),a==null&&i.isEnabled()&&i.isCellMovable(t.getCell())&&(a=i.getModel().isEdge(t.getCell())?mxConstants.CURSOR_MOVABLE_EDGE:mxConstants.CURSOR_MOVABLE_VERTEX),t.sourceState!=null&&t.sourceState.setCursor(a))};mxGraphHandler.prototype.updatePreviewShape=function(){this.shape!=null&&(this.shape.bounds=new mxRectangle(Math.round(this.pBounds.x+this.currentDx-this.graph.panDx),Math.round(this.pBounds.y+this.currentDy-this.graph.panDy),this.pBounds.width,this.pBounds.height),this.shape.redraw())};mxGraphHandler.prototype.setHighlightColor=function(n){this.highlight!=null&&this.highlight.setHighlightColor(n)};mxGraphHandler.prototype.mouseUp=function(n,t){var i,r;if(!t.isConsumed())if(i=this.graph,this.cell!=null&&this.first!=null&&this.shape!=null&&this.currentDx!=null&&this.currentDy!=null)if(r=t.getCell(),this.connectOnDrop&&this.target==null&&r!=null&&i.getModel().isVertex(r)&&i.isCellConnectable(r)&&i.isEdgeValid(null,this.cell,r))i.connectionHandler.connect(this.cell,r,t.getEvent());else{var s=i.isCloneEvent(t.getEvent())&&i.isCellsCloneable()&&this.isCloneEnabled(),u=i.getView().scale,f=this.roundLength(this.currentDx/u),e=this.roundLength(this.currentDy/u),o=this.target;i.isSplitEnabled()&&i.isSplitTarget(o,this.cells,t.getEvent())?i.splitEdge(o,this.cells,null,f,e):this.moveCells(this.cells,f,e,s,this.target,t.getEvent())}else this.isSelectEnabled()&&this.delayedSelection&&this.cell!=null&&this.selectDelayed(t);this.cellWasClicked&&this.consumeMouseEvent(mxEvent.MOUSE_UP,t);this.reset()};mxGraphHandler.prototype.selectDelayed=function(n){this.graph.isCellSelected(this.cell)&&this.graph.popupMenuHandler.isPopupTrigger(n)||this.graph.selectCellForEvent(this.cell,n.getEvent())};mxGraphHandler.prototype.reset=function(){this.destroyShapes();this.removeHint();this.cellWasClicked=!1;this.delayedSelection=!1;this.currentDx=null;this.currentDy=null;this.guides=null;this.first=null;this.cell=null;this.target=null};mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(n,t,i){var r,u,f;if(this.graph.getModel().isVertex(n)&&(r=this.graph.getView().getState(n),r!=null)){if(u=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(i),mxEvent.getClientY(i)),f=mxUtils.toRadians(mxUtils.getValue(r.style,mxConstants.STYLE_ROTATION)||0),f!=0){var e=Math.cos(-f),o=Math.sin(-f),s=new mxPoint(r.getCenterX(),r.getCenterY());u=mxUtils.getRotatedPoint(u,e,o,s)}return!mxUtils.contains(r,u.x,u.y)}return!1};mxGraphHandler.prototype.moveCells=function(n,t,i,r,u,f){r&&(n=this.graph.getCloneableCells(n));u==null&&this.isRemoveCellsFromParent()&&this.shouldRemoveCellsFromParent(this.graph.getModel().getParent(this.cell),n,f)&&(u=this.graph.getDefaultParent());r=r&&!this.graph.isCellLocked(u||this.graph.getDefaultParent());n=this.graph.moveCells(n,t-this.graph.panDx/this.graph.view.scale,i-this.graph.panDy/this.graph.view.scale,r,u,f);this.isSelectEnabled()&&this.scrollOnMove&&this.graph.scrollCellToVisible(n[0]);r&&this.graph.setSelectionCells(n)};mxGraphHandler.prototype.destroyShapes=function(){this.shape!=null&&(this.shape.destroy(),this.shape=null);this.guide!=null&&(this.guide.destroy(),this.guide=null);this.highlight!=null&&(this.highlight.destroy(),this.highlight=null)};mxGraphHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.graph.removeListener(this.panHandler);this.escapeHandler!=null&&(this.graph.removeListener(this.escapeHandler),this.escapeHandler=null);this.destroyShapes();this.removeHint()};mxPanningHandler.prototype=new mxEventSource;mxPanningHandler.prototype.constructor=mxPanningHandler;mxPanningHandler.prototype.graph=null;mxPanningHandler.prototype.useLeftButtonForPanning=!1;mxPanningHandler.prototype.usePopupTrigger=!0;mxPanningHandler.prototype.ignoreCell=!1;mxPanningHandler.prototype.previewEnabled=!0;mxPanningHandler.prototype.useGrid=!1;mxPanningHandler.prototype.panningEnabled=!0;mxPanningHandler.prototype.pinchEnabled=!0;mxPanningHandler.prototype.maxScale=8;mxPanningHandler.prototype.minScale=.01;mxPanningHandler.prototype.dx=null;mxPanningHandler.prototype.dy=null;mxPanningHandler.prototype.startX=0;mxPanningHandler.prototype.startY=0;mxPanningHandler.prototype.isActive=function(){return this.active||this.initialScale!=null};mxPanningHandler.prototype.isPanningEnabled=function(){return this.panningEnabled};mxPanningHandler.prototype.setPanningEnabled=function(n){this.panningEnabled=n};mxPanningHandler.prototype.isPinchEnabled=function(){return this.pinchEnabled};mxPanningHandler.prototype.setPinchEnabled=function(n){this.pinchEnabled=n};mxPanningHandler.prototype.isPanningTrigger=function(n){var t=n.getEvent();return this.useLeftButtonForPanning&&n.getState()==null&&mxEvent.isLeftMouseButton(t)||mxEvent.isControlDown(t)&&mxEvent.isShiftDown(t)||this.usePopupTrigger&&mxEvent.isPopupTrigger(t)};mxPanningHandler.prototype.isForcePanningEvent=function(n){return this.ignoreCell||mxEvent.isMultiTouchEvent(n.getEvent())};mxPanningHandler.prototype.mouseDown=function(n,t){this.mouseDownEvent=t;!t.isConsumed()&&this.isPanningEnabled()&&!this.active&&this.isPanningTrigger(t)&&(this.start(t),this.consumePanningTrigger(t))};mxPanningHandler.prototype.start=function(n){this.dx0=-this.graph.container.scrollLeft;this.dy0=-this.graph.container.scrollTop;this.startX=n.getX();this.startY=n.getY();this.dx=null;this.dy=null;this.panningTrigger=!0};mxPanningHandler.prototype.consumePanningTrigger=function(n){n.consume()};mxPanningHandler.prototype.mouseMove=function(n,t){if(this.dx=t.getX()-this.startX,this.dy=t.getY()-this.startY,this.active)this.previewEnabled&&(this.useGrid&&(this.dx=this.graph.snap(this.dx),this.dy=this.graph.snap(this.dy)),this.graph.panGraph(this.dx+this.dx0,this.dy+this.dy0)),this.fireEvent(new mxEventObject(mxEvent.PAN,"event",t));else if(this.panningTrigger){var i=this.active;this.active=Math.abs(this.dx)>this.graph.tolerance||Math.abs(this.dy)>this.graph.tolerance;!i&&this.active&&this.fireEvent(new mxEventObject(mxEvent.PAN_START,"event",t))}(this.active||this.panningTrigger)&&t.consume()};mxPanningHandler.prototype.mouseUp=function(n,t){if(this.active){if(this.dx!=null&&this.dy!=null){if(!this.graph.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.graph.container)){var i=this.graph.getView().scale,r=this.graph.getView().translate;this.graph.panGraph(0,0);this.panGraph(r.x+this.dx/i,r.y+this.dy/i)}t.consume()}this.fireEvent(new mxEventObject(mxEvent.PAN_END,"event",t))}this.reset()};mxPanningHandler.prototype.reset=function(){this.panningTrigger=!1;this.mouseDownEvent=null;this.active=!1;this.dx=null;this.dy=null};mxPanningHandler.prototype.panGraph=function(n,t){this.graph.getView().setTranslate(n,t)};mxPanningHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.graph.removeListener(this.forcePanningHandler);this.graph.removeListener(this.gestureHandler);mxEvent.removeListener(document,"mouseup",this.mouseUpListener)};mxPopupMenuHandler.prototype=new mxPopupMenu;mxPopupMenuHandler.prototype.constructor=mxPopupMenuHandler;mxPopupMenuHandler.prototype.graph=null;mxPopupMenuHandler.prototype.selectOnPopup=!0;mxPopupMenuHandler.prototype.clearSelectionOnBackground=!0;mxPopupMenuHandler.prototype.triggerX=null;mxPopupMenuHandler.prototype.triggerY=null;mxPopupMenuHandler.prototype.screenX=null;mxPopupMenuHandler.prototype.screenY=null;mxPopupMenuHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this);mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.graph.tooltipHandler.hide()}))};mxPopupMenuHandler.prototype.isSelectOnPopup=function(){return this.selectOnPopup};mxPopupMenuHandler.prototype.mouseDown=function(n,t){this.isEnabled()&&!mxEvent.isMultiTouchEvent(t.getEvent())&&(this.hideMenu(),this.triggerX=t.getGraphX(),this.triggerY=t.getGraphY(),this.screenX=mxEvent.getMainEvent(t.getEvent()).screenX,this.screenY=mxEvent.getMainEvent(t.getEvent()).screenY,this.popupTrigger=this.isPopupTrigger(t),this.inTolerance=!0)};mxPopupMenuHandler.prototype.mouseMove=function(n,t){this.inTolerance&&this.screenX!=null&&this.screenY!=null&&(Math.abs(mxEvent.getMainEvent(t.getEvent()).screenX-this.screenX)>this.graph.tolerance||Math.abs(mxEvent.getMainEvent(t.getEvent()).screenY-this.screenY)>this.graph.tolerance)&&(this.inTolerance=!1)};mxPopupMenuHandler.prototype.mouseUp=function(n,t){var i,r;this.popupTrigger&&this.inTolerance&&this.triggerX!=null&&this.triggerY!=null&&(i=this.getCellForPopupEvent(t),this.graph.isEnabled()&&this.isSelectOnPopup(t)&&i!=null&&!this.graph.isCellSelected(i)?this.graph.setSelectionCell(i):this.clearSelectionOnBackground&&i==null&&this.graph.clearSelection(),this.graph.tooltipHandler.hide(),r=mxUtils.getScrollOrigin(),this.popup(t.getX()+r.x+1,t.getY()+r.y+1,i,t.getEvent()),t.consume());this.popupTrigger=!1;this.inTolerance=!1};mxPopupMenuHandler.prototype.getCellForPopupEvent=function(n){return n.getCell()};mxPopupMenuHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.graph.removeListener(this.gestureHandler);mxPopupMenu.prototype.destroy.apply(this)};mxUtils.extend(mxCellMarker,mxEventSource);mxCellMarker.prototype.graph=null;mxCellMarker.prototype.enabled=!0;mxCellMarker.prototype.hotspot=mxConstants.DEFAULT_HOTSPOT;mxCellMarker.prototype.hotspotEnabled=!1;mxCellMarker.prototype.validColor=null;mxCellMarker.prototype.invalidColor=null;mxCellMarker.prototype.currentColor=null;mxCellMarker.prototype.validState=null;mxCellMarker.prototype.markedState=null;mxCellMarker.prototype.setEnabled=function(n){this.enabled=n};mxCellMarker.prototype.isEnabled=function(){return this.enabled};mxCellMarker.prototype.setHotspot=function(n){this.hotspot=n};mxCellMarker.prototype.getHotspot=function(){return this.hotspot};mxCellMarker.prototype.setHotspotEnabled=function(n){this.hotspotEnabled=n};mxCellMarker.prototype.isHotspotEnabled=function(){return this.hotspotEnabled};mxCellMarker.prototype.hasValidState=function(){return this.validState!=null};mxCellMarker.prototype.getValidState=function(){return this.validState};mxCellMarker.prototype.getMarkedState=function(){return this.markedState};mxCellMarker.prototype.reset=function(){this.validState=null;this.markedState!=null&&(this.markedState=null,this.unmark())};mxCellMarker.prototype.process=function(n){var t=null;return this.isEnabled()&&(t=this.getState(n),this.setCurrentState(t,n)),t};mxCellMarker.prototype.setCurrentState=function(n,t,i){var r=n!=null?this.isValidState(n):!1;i=i!=null?i:this.getMarkerColor(t.getEvent(),n,r);this.validState=r?n:null;(n!=this.markedState||i!=this.currentColor)&&(this.currentColor=i,n!=null&&this.currentColor!=null?(this.markedState=n,this.mark()):this.markedState!=null&&(this.markedState=null,this.unmark()))};mxCellMarker.prototype.markCell=function(n,t){var i=this.graph.getView().getState(n);i!=null&&(this.currentColor=t!=null?t:this.validColor,this.markedState=i,this.mark())};mxCellMarker.prototype.mark=function(){this.highlight.setHighlightColor(this.currentColor);this.highlight.highlight(this.markedState);this.fireEvent(new mxEventObject(mxEvent.MARK,"state",this.markedState))};mxCellMarker.prototype.unmark=function(){this.mark()};mxCellMarker.prototype.isValidState=function(){return!0};mxCellMarker.prototype.getMarkerColor=function(n,t,i){return i?this.validColor:this.invalidColor};mxCellMarker.prototype.getState=function(n){var i=this.graph.getView(),r=this.getCell(n),t=this.getStateToMark(i.getState(r));return t!=null&&this.intersects(t,n)?t:null};mxCellMarker.prototype.getCell=function(n){return n.getCell()};mxCellMarker.prototype.getStateToMark=function(n){return n};mxCellMarker.prototype.intersects=function(n,t){return this.hotspotEnabled?mxUtils.intersectsHotspot(n,t.getGraphX(),t.getGraphY(),this.hotspot,mxConstants.MIN_HOTSPOT_SIZE,mxConstants.MAX_HOTSPOT_SIZE):!0};mxCellMarker.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);this.highlight.destroy()};mxUtils.extend(mxSelectionCellsHandler,mxEventSource);mxSelectionCellsHandler.prototype.graph=null;mxSelectionCellsHandler.prototype.enabled=!0;mxSelectionCellsHandler.prototype.refreshHandler=null;mxSelectionCellsHandler.prototype.maxHandlers=100;mxSelectionCellsHandler.prototype.handlers=null;mxSelectionCellsHandler.prototype.isEnabled=function(){return this.enabled};mxSelectionCellsHandler.prototype.setEnabled=function(n){this.enabled=n};mxSelectionCellsHandler.prototype.getHandler=function(n){return this.handlers.get(n)};mxSelectionCellsHandler.prototype.reset=function(){this.handlers.visit(function(n,t){t.reset.apply(t)})};mxSelectionCellsHandler.prototype.refresh=function(){var u=this.handlers,i,t,r,n;for(this.handlers=new mxDictionary,i=this.graph.getSelectionCells(),t=0;t<i.length;t++)r=this.graph.view.getState(i[t]),r!=null&&(n=u.remove(i[t]),n!=null&&(n.state!=r?(n.destroy(),n=null):this.isHandlerActive(n)||(n.refresh!=null&&n.refresh(),n.redraw())),n==null&&(n=this.graph.createHandler(r),this.fireEvent(new mxEventObject(mxEvent.ADD,"state",r))),n!=null&&this.handlers.put(i[t],n));u.visit(mxUtils.bind(this,function(n,t){this.fireEvent(new mxEventObject(mxEvent.REMOVE,"state",t.state));t.destroy()}))};mxSelectionCellsHandler.prototype.isHandlerActive=function(n){return n.index!=null};mxSelectionCellsHandler.prototype.updateHandler=function(n){var t=this.handlers.remove(n.cell);t!=null&&(t.destroy(),t=this.graph.createHandler(n),t!=null&&this.handlers.put(n.cell,t))};mxSelectionCellsHandler.prototype.mouseDown=function(n,t){if(this.graph.isEnabled()&&this.isEnabled()){var i=[n,t];this.handlers.visit(function(n,t){t.mouseDown.apply(t,i)})}};mxSelectionCellsHandler.prototype.mouseMove=function(n,t){if(this.graph.isEnabled()&&this.isEnabled()){var i=[n,t];this.handlers.visit(function(n,t){t.mouseMove.apply(t,i)})}};mxSelectionCellsHandler.prototype.mouseUp=function(n,t){if(this.graph.isEnabled()&&this.isEnabled()){var i=[n,t];this.handlers.visit(function(n,t){t.mouseUp.apply(t,i)})}};mxSelectionCellsHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.refreshHandler!=null&&(this.graph.getSelectionModel().removeListener(this.refreshHandler),this.graph.getModel().removeListener(this.refreshHandler),this.graph.getView().removeListener(this.refreshHandler),this.refreshHandler=null)};mxUtils.extend(mxConnectionHandler,mxEventSource);mxConnectionHandler.prototype.graph=null;mxConnectionHandler.prototype.factoryMethod=!0;mxConnectionHandler.prototype.moveIconFront=!1;mxConnectionHandler.prototype.moveIconBack=!1;mxConnectionHandler.prototype.connectImage=null;mxConnectionHandler.prototype.targetConnectImage=!1;mxConnectionHandler.prototype.enabled=!0;mxConnectionHandler.prototype.select=!0;mxConnectionHandler.prototype.createTarget=!1;mxConnectionHandler.prototype.marker=null;mxConnectionHandler.prototype.constraintHandler=null;mxConnectionHandler.prototype.error=null;mxConnectionHandler.prototype.waypointsEnabled=!1;mxConnectionHandler.prototype.ignoreMouseDown=!1;mxConnectionHandler.prototype.first=null;mxConnectionHandler.prototype.connectIconOffset=new mxPoint(0,mxConstants.TOOLTIP_VERTICAL_OFFSET);mxConnectionHandler.prototype.edgeState=null;mxConnectionHandler.prototype.changeHandler=null;mxConnectionHandler.prototype.drillHandler=null;mxConnectionHandler.prototype.mouseDownCounter=0;mxConnectionHandler.prototype.movePreviewAway=mxClient.IS_VML;mxConnectionHandler.prototype.outlineConnect=!1;mxConnectionHandler.prototype.livePreview=!1;mxConnectionHandler.prototype.cursor=null;mxConnectionHandler.prototype.insertBeforeSource=!1;mxConnectionHandler.prototype.isEnabled=function(){return this.enabled};mxConnectionHandler.prototype.setEnabled=function(n){this.enabled=n};mxConnectionHandler.prototype.isInsertBefore=function(n,t,i){return this.insertBeforeSource&&t!=i};mxConnectionHandler.prototype.isCreateTarget=function(){return this.createTarget};mxConnectionHandler.prototype.setCreateTarget=function(n){this.createTarget=n};mxConnectionHandler.prototype.createShape=function(){var n=this.livePreview&&this.edgeState!=null?this.graph.cellRenderer.createShape(this.edgeState):new mxPolyline([],mxConstants.INVALID_COLOR);return n.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,n.scale=this.graph.view.scale,n.pointerEvents=!1,n.isDashed=!0,n.init(this.graph.getView().getOverlayPane()),mxEvent.redirectMouseEvents(n.node,this.graph,null),n};mxConnectionHandler.prototype.init=function(){this.graph.addMouseListener(this);this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.changeHandler=mxUtils.bind(this,function(){this.iconState!=null&&(this.iconState=this.graph.getView().getState(this.iconState.cell));this.iconState!=null?(this.redrawIcons(this.icons,this.iconState),this.constraintHandler.reset()):this.previous!=null&&this.graph.view.getState(this.previous.cell)==null&&this.reset()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE,this.changeHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.changeHandler);this.drillHandler=mxUtils.bind(this,function(){this.reset()});this.graph.addListener(mxEvent.START_EDITING,this.drillHandler);this.graph.getView().addListener(mxEvent.DOWN,this.drillHandler);this.graph.getView().addListener(mxEvent.UP,this.drillHandler)};mxConnectionHandler.prototype.isConnectableCell=function(){return!0};mxConnectionHandler.prototype.createMarker=function(){var n=new mxCellMarker(this.graph);return n.hotspotEnabled=!0,n.getCell=mxUtils.bind(this,function(t){var i=mxCellMarker.prototype.getCell.apply(n,arguments),r;return this.error=null,i==null&&this.currentPoint!=null&&(i=this.graph.getCellAt(this.currentPoint.x,this.currentPoint.y)),i==null||this.graph.isCellConnectable(i)||(r=this.graph.getModel().getParent(i),this.graph.getModel().isVertex(r)&&this.graph.isCellConnectable(r)&&(i=r)),(this.graph.isSwimlane(i)&&this.currentPoint!=null&&this.graph.hitsSwimlaneContent(i,this.currentPoint.x,this.currentPoint.y)||!this.isConnectableCell(i))&&(i=null),i!=null?this.isConnecting()?this.previous!=null&&(this.error=this.validateConnection(this.previous.cell,i),this.error!=null&&this.error.length==0&&(i=null,this.isCreateTarget(t.getEvent())&&(this.error=null))):this.isValidSource(i,t)||(i=null):!this.isConnecting()||this.isCreateTarget(t.getEvent())||this.graph.allowDanglingEdges||(this.error=""),i}),n.isValidState=mxUtils.bind(this,function(){return this.isConnecting()?this.error==null:mxCellMarker.prototype.isValidState.apply(n,arguments)}),n.getMarkerColor=mxUtils.bind(this,function(){return this.connectImage==null||this.isConnecting()?mxCellMarker.prototype.getMarkerColor.apply(n,arguments):null}),n.intersects=mxUtils.bind(this,function(){return this.connectImage!=null||this.isConnecting()?!0:mxCellMarker.prototype.intersects.apply(n,arguments)}),n};mxConnectionHandler.prototype.start=function(n,t,i,r){this.previous=n;this.first=new mxPoint(t,i);this.edgeState=r!=null?r:this.createEdgeState(null);this.marker.currentColor=this.marker.validColor;this.marker.markedState=n;this.marker.mark();this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous))};mxConnectionHandler.prototype.isConnecting=function(){return this.first!=null&&this.shape!=null};mxConnectionHandler.prototype.isValidSource=function(n){return this.graph.isValidSource(n)};mxConnectionHandler.prototype.isValidTarget=function(){return!0};mxConnectionHandler.prototype.validateConnection=function(n,t){return this.isValidTarget(t)?this.graph.getEdgeValidationError(null,n,t):""};mxConnectionHandler.prototype.getConnectImage=function(){return this.connectImage};mxConnectionHandler.prototype.isMoveIconToFrontForState=function(n){return n.text!=null&&n.text.node.parentNode==this.graph.container?!0:this.moveIconFront};mxConnectionHandler.prototype.createIcons=function(n){var i=this.getConnectImage(n),u,f;if(i!=null&&n!=null){this.iconState=n;var r=[],e=new mxRectangle(0,0,i.width,i.height),t=new mxImageShape(e,i.src,null,null,0);return t.preserveImageAspect=!1,this.isMoveIconToFrontForState(n)?(t.dialect=mxConstants.DIALECT_STRICTHTML,t.init(this.graph.container)):(t.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,t.init(this.graph.getView().getOverlayPane()),this.moveIconBack&&t.node.previousSibling!=null&&t.node.parentNode.insertBefore(t.node,t.node.parentNode.firstChild)),t.node.style.cursor=mxConstants.CURSOR_CONNECT,u=mxUtils.bind(this,function(){return this.currentState!=null?this.currentState:n}),f=mxUtils.bind(this,function(n){mxEvent.isConsumed(n)||(this.icon=t,this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(n,u())))}),mxEvent.redirectMouseEvents(t.node,this.graph,u,f),r.push(t),this.redrawIcons(r,this.iconState),r}return null};mxConnectionHandler.prototype.redrawIcons=function(n,t){if(n!=null&&n[0]!=null&&t!=null){var i=this.getIconPosition(n[0],t);n[0].bounds.x=i.x;n[0].bounds.y=i.y;n[0].redraw()}};mxConnectionHandler.prototype.getIconPosition=function(n,t){var e=this.graph.getView().scale,i=t.getCenterX(),r=t.getCenterY(),u,f;if(this.graph.isSwimlane(t.cell)&&(u=this.graph.getStartSize(t.cell),i=u.width!=0?t.x+u.width*e/2:i,r=u.height!=0?t.y+u.height*e/2:r,f=mxUtils.toRadians(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION)||0),f!=0)){var s=Math.cos(f),h=Math.sin(f),c=new mxPoint(t.getCenterX(),t.getCenterY()),o=mxUtils.getRotatedPoint(new mxPoint(i,r),s,h,c);i=o.x;r=o.y}return new mxPoint(i-n.bounds.width/2,r-n.bounds.height/2)};mxConnectionHandler.prototype.destroyIcons=function(){if(this.icons!=null){for(var n=0;n<this.icons.length;n++)this.icons[n].destroy();this.icons=null;this.icon=null;this.selectedIcon=null;this.iconState=null}};mxConnectionHandler.prototype.isStartEvent=function(){return this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null||this.previous!=null&&this.error==null&&(this.icons==null||this.icons!=null&&this.icon!=null)};mxConnectionHandler.prototype.mouseDown=function(n,t){if(this.mouseDownCounter++,this.isEnabled()&&this.graph.isEnabled()&&!t.isConsumed()&&!this.isConnecting()&&this.isStartEvent(t)){if(this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentPoint!=null?(this.sourceConstraint=this.constraintHandler.currentConstraint,this.previous=this.constraintHandler.currentFocus,this.first=this.constraintHandler.currentPoint.clone()):this.first=new mxPoint(t.getGraphX(),t.getGraphY()),this.edgeState=this.createEdgeState(t),this.mouseDownCounter=1,this.waypointsEnabled&&this.shape==null&&(this.waypoints=null,this.shape=this.createShape(),this.edgeState!=null&&this.shape.apply(this.edgeState)),this.previous==null&&this.edgeState!=null){var i=this.graph.getPointForEvent(t.getEvent());this.edgeState.cell.geometry.setTerminalPoint(i,!0)}this.fireEvent(new mxEventObject(mxEvent.START,"state",this.previous));t.consume()}this.selectedIcon=this.icon;this.icon=null};mxConnectionHandler.prototype.isImmediateConnectSource=function(n){return!this.graph.isCellMovable(n.cell)};mxConnectionHandler.prototype.createEdgeState=function(){return null};mxConnectionHandler.prototype.isOutlineConnectEvent=function(n){var i=mxUtils.getOffset(this.graph.container),r=n.getEvent(),u=mxEvent.getClientX(r),f=mxEvent.getClientY(r),t=document.documentElement,s=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),h=(window.pageYOffset||t.scrollTop)-(t.clientTop||0),e=this.currentPoint.x-this.graph.container.scrollLeft+i.x-s,o=this.currentPoint.y-this.graph.container.scrollTop+i.y-h;return this.outlineConnect&&!mxEvent.isShiftDown(n.getEvent())&&(n.isSource(this.marker.highlight.shape)||mxEvent.isAltDown(n.getEvent())&&n.getState()!=null||this.marker.highlight.isHighlightAt(u,f)||(e!=u||o!=f)&&n.getState()==null&&this.marker.highlight.isHighlightAt(e,o))};mxConnectionHandler.prototype.updateCurrentState=function(n,t){var r,u,i;this.constraintHandler.update(n,this.first==null,!1,this.first==null||n.isSource(this.marker.highlight.shape)?null:t);this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null?(this.marker.highlight!=null&&this.marker.highlight.state!=null&&this.marker.highlight.state.cell==this.constraintHandler.currentFocus.cell?this.marker.highlight.shape.stroke!="transparent"&&(this.marker.highlight.shape.stroke="transparent",this.marker.highlight.repaint()):this.marker.markCell(this.constraintHandler.currentFocus.cell,"transparent"),this.previous!=null&&(this.error=this.validateConnection(this.previous.cell,this.constraintHandler.currentFocus.cell),this.error==null?this.currentState=this.constraintHandler.currentFocus:this.constraintHandler.reset())):(this.graph.isIgnoreTerminalEvent(n.getEvent())?(this.marker.reset(),this.currentState=null):(this.marker.process(n),this.currentState=this.marker.getValidState()),r=this.isOutlineConnectEvent(n),this.currentState!=null&&r&&(n.isSource(this.marker.highlight.shape)&&(t=new mxPoint(n.getGraphX(),n.getGraphY())),u=this.graph.getOutlineConstraint(t,this.currentState,n),this.constraintHandler.setFocus(n,this.currentState,!1),this.constraintHandler.currentConstraint=u,this.constraintHandler.currentPoint=t),this.outlineConnect&&this.marker.highlight!=null&&this.marker.highlight.shape!=null&&(i=this.graph.view.scale,this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null?(this.marker.highlight.shape.stroke=mxConstants.OUTLINE_HIGHLIGHT_COLOR,this.marker.highlight.shape.strokewidth=mxConstants.OUTLINE_HIGHLIGHT_STROKEWIDTH/i/i,this.marker.highlight.repaint()):this.marker.hasValidState()&&(this.marker.getValidState()!=n.getState()?(this.marker.highlight.shape.stroke="transparent",this.currentState=null):this.marker.highlight.shape.stroke=mxConstants.DEFAULT_VALID_COLOR,this.marker.highlight.shape.strokewidth=mxConstants.HIGHLIGHT_STROKEWIDTH/i/i,this.marker.highlight.repaint())))};mxConnectionHandler.prototype.convertWaypoint=function(n){var t=this.graph.getView().getScale(),i=this.graph.getView().getTranslate();n.x=n.x/t-i.x;n.y=n.y/t-i.y};mxConnectionHandler.prototype.snapToPreview=function(n,t){if(!mxEvent.isAltDown(n.getEvent())&&this.previous!=null){var r=this.graph.gridSize*this.graph.view.scale/2,i=this.sourceConstraint!=null?this.first:new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());Math.abs(i.x-n.getGraphX())<r&&(t.x=i.x);Math.abs(i.y-n.getGraphY())<r&&(t.y=i.y)}};mxConnectionHandler.prototype.mouseMove=function(n,t){var v,r,f,d,g,y,nt,tt,u,p,e,o,s,a,b,h;if(t.isConsumed()||!this.ignoreMouseDown&&this.first==null&&this.graph.isMouseDown)this.constraintHandler.reset();else{this.isEnabled()||this.currentState==null||(this.destroyIcons(),this.currentState=null);var k=this.graph.getView(),c=k.scale,l=k.translate,i=new mxPoint(t.getGraphX(),t.getGraphY());if(this.error=null,this.graph.isGridEnabledEvent(t.getEvent())&&(i=new mxPoint((this.graph.snap(i.x/c-l.x)+l.x)*c,(this.graph.snap(i.y/c-l.y)+l.y)*c)),this.snapToPreview(t,i),this.currentPoint=i,(this.first!=null||this.isEnabled()&&this.graph.isEnabled())&&this.updateCurrentState(t,i),this.first!=null){if(v=null,r=i,this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentPoint!=null?(v=this.constraintHandler.currentConstraint,r=this.constraintHandler.currentPoint.clone()):this.previous!=null&&!this.graph.isIgnoreTerminalEvent(t.getEvent())&&mxEvent.isShiftDown(t.getEvent())&&(Math.abs(this.previous.getCenterX()-i.x)<Math.abs(this.previous.getCenterY()-i.y)?i.x=this.previous.getCenterX():i.y=this.previous.getCenterY()),f=this.first,this.selectedIcon!=null&&(d=this.selectedIcon.bounds.width,g=this.selectedIcon.bounds.height,this.currentState!=null&&this.targetConnectImage?(y=this.getIconPosition(this.selectedIcon,this.currentState),this.selectedIcon.bounds.x=y.x,this.selectedIcon.bounds.y=y.y):(nt=new mxRectangle(t.getGraphX()+this.connectIconOffset.x,t.getGraphY()+this.connectIconOffset.y,d,g),this.selectedIcon.bounds=nt),this.selectedIcon.redraw()),this.edgeState!=null?(this.updateEdgeState(r,v),r=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-1],f=this.edgeState.absolutePoints[0]):(this.currentState!=null&&this.constraintHandler.currentConstraint==null&&(u=this.getTargetPerimeterPoint(this.currentState,t),u!=null&&(r=u)),this.sourceConstraint==null&&this.previous!=null&&(tt=this.waypoints!=null&&this.waypoints.length>0?this.waypoints[0]:r,u=this.getSourcePerimeterPoint(this.previous,tt,t),u!=null&&(f=u))),this.currentState==null&&this.movePreviewAway){u=f;this.edgeState!=null&&this.edgeState.absolutePoints.length>=2&&(p=this.edgeState.absolutePoints[this.edgeState.absolutePoints.length-2],p!=null&&(u=p));var e=r.x-u.x,o=r.y-u.y,w=Math.sqrt(e*e+o*o);if(w==0)return;this.originalPoint=r.clone();r.x-=e*4/w;r.y-=o*4/w}else this.originalPoint=null;this.shape==null&&(e=Math.abs(i.x-this.first.x),o=Math.abs(i.y-this.first.y),(e>this.graph.tolerance||o>this.graph.tolerance)&&(this.shape=this.createShape(),this.edgeState!=null&&this.shape.apply(this.edgeState),this.updateCurrentState(t,i)));this.shape!=null&&(this.edgeState!=null?this.shape.points=this.edgeState.absolutePoints:(s=[f],this.waypoints!=null&&(s=s.concat(this.waypoints)),s.push(r),this.shape.points=s),this.drawPreview());this.cursor!=null&&(this.graph.container.style.cursor=this.cursor);mxEvent.consume(t.getEvent());t.consume()}else this.isEnabled()&&this.graph.isEnabled()?this.previous!=this.currentState&&this.edgeState==null?(this.destroyIcons(),this.currentState!=null&&this.error==null&&this.constraintHandler.currentConstraint==null&&(this.icons=this.createIcons(this.currentState),this.icons==null&&(this.currentState.setCursor(mxConstants.CURSOR_CONNECT),t.consume())),this.previous=this.currentState):this.previous!=this.currentState||this.currentState==null||this.icons!=null||this.graph.isMouseDown||t.consume():this.constraintHandler.reset();if(!this.graph.isMouseDown&&this.currentState!=null&&this.icons!=null){for(a=!1,b=t.getSource(),h=0;h<this.icons.length&&!a;h++)a=b==this.icons[h].node||b.parentNode==this.icons[h].node;a||this.updateIcons(this.currentState,this.icons,t)}}};mxConnectionHandler.prototype.updateEdgeState=function(n,t){var r,i,u;if(this.sourceConstraint!=null&&this.sourceConstraint.point!=null&&(this.edgeState.style[mxConstants.STYLE_EXIT_X]=this.sourceConstraint.point.x,this.edgeState.style[mxConstants.STYLE_EXIT_Y]=this.sourceConstraint.point.y),t!=null&&t.point!=null?(this.edgeState.style[mxConstants.STYLE_ENTRY_X]=t.point.x,this.edgeState.style[mxConstants.STYLE_ENTRY_Y]=t.point.y):(delete this.edgeState.style[mxConstants.STYLE_ENTRY_X],delete this.edgeState.style[mxConstants.STYLE_ENTRY_Y]),this.edgeState.absolutePoints=[null,this.currentState!=null?null:n],this.graph.view.updateFixedTerminalPoint(this.edgeState,this.previous,!0,this.sourceConstraint),this.currentState!=null&&(t==null&&(t=this.graph.getConnectionConstraint(this.edgeState,this.previous,!1)),this.edgeState.setAbsoluteTerminalPoint(null,!1),this.graph.view.updateFixedTerminalPoint(this.edgeState,this.currentState,!1,t)),r=null,this.waypoints!=null)for(r=[],i=0;i<this.waypoints.length;i++)u=this.waypoints[i].clone(),this.convertWaypoint(u),r[i]=u;this.graph.view.updatePoints(this.edgeState,r,this.previous,this.currentState);this.graph.view.updateFloatingTerminalPoints(this.edgeState,this.previous,this.currentState)};mxConnectionHandler.prototype.getTargetPerimeterPoint=function(n){var t=null,r=n.view,u=r.getPerimeterFunction(n),f,i;return u!=null?(f=this.waypoints!=null&&this.waypoints.length>0?this.waypoints[this.waypoints.length-1]:new mxPoint(this.previous.getCenterX(),this.previous.getCenterY()),i=u(r.getPerimeterBounds(n),this.edgeState,f,!1),i!=null&&(t=i)):t=new mxPoint(n.getCenterX(),n.getCenterY()),t};mxConnectionHandler.prototype.getSourcePerimeterPoint=function(n,t){var f=null,o=n.view,s=o.getPerimeterFunction(n),e=new mxPoint(n.getCenterX(),n.getCenterY()),u,r,i;return s!=null?(u=mxUtils.getValue(n.style,mxConstants.STYLE_ROTATION,0),r=-u*(Math.PI/180),u!=0&&(t=mxUtils.getRotatedPoint(new mxPoint(t.x,t.y),Math.cos(r),Math.sin(r),e)),i=s(o.getPerimeterBounds(n),n,t,!1),i!=null&&(u!=0&&(i=mxUtils.getRotatedPoint(new mxPoint(i.x,i.y),Math.cos(-r),Math.sin(-r),e)),f=i)):f=e,f};mxConnectionHandler.prototype.updateIcons=function(){};mxConnectionHandler.prototype.isStopEvent=function(n){return n.getState()!=null};mxConnectionHandler.prototype.addWaypointForEvent=function(n){var i=mxUtils.convertPoint(this.graph.container,n.getX(),n.getY()),r=Math.abs(i.x-this.first.x),u=Math.abs(i.y-this.first.y),f=this.waypoints!=null||this.mouseDownCounter>1&&(r>this.graph.tolerance||u>this.graph.tolerance),t;f&&(this.waypoints==null&&(this.waypoints=[]),t=this.graph.view.scale,i=new mxPoint(this.graph.snap(n.getGraphX()/t)*t,this.graph.snap(n.getGraphY()/t)*t),this.waypoints.push(i))};mxConnectionHandler.prototype.mouseUp=function(n,t){if(!t.isConsumed()&&this.isConnecting()){if(this.waypointsEnabled&&!this.isStopEvent(t)){this.addWaypointForEvent(t);t.consume();return}if(this.error==null){var r=this.previous!=null?this.previous.cell:null,i=null;this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null&&(i=this.constraintHandler.currentFocus.cell);i==null&&this.currentState!=null&&(i=this.currentState.cell);this.connect(r,i,t.getEvent(),t.getCell())}else this.previous!=null&&this.marker.validState!=null&&this.previous.cell==this.marker.validState.cell&&this.graph.selectCellForEvent(this.marker.source,evt),this.error.length>0&&this.graph.validationAlert(this.error);this.destroyIcons();t.consume()}this.first!=null&&this.reset()};mxConnectionHandler.prototype.reset=function(){this.shape!=null&&(this.shape.destroy(),this.shape=null);this.cursor!=null&&this.graph.container!=null&&(this.graph.container.style.cursor="");this.destroyIcons();this.marker.reset();this.constraintHandler.reset();this.originalPoint=null;this.currentPoint=null;this.edgeState=null;this.previous=null;this.error=null;this.sourceConstraint=null;this.mouseDownCounter=0;this.first=null;this.fireEvent(new mxEventObject(mxEvent.RESET))};mxConnectionHandler.prototype.drawPreview=function(){this.updatePreview(this.error==null);this.shape.redraw()};mxConnectionHandler.prototype.updatePreview=function(n){this.shape.strokewidth=this.getEdgeWidth(n);this.shape.stroke=this.getEdgeColor(n)};mxConnectionHandler.prototype.getEdgeColor=function(n){return n?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR};mxConnectionHandler.prototype.getEdgeWidth=function(n){return n?3:1};mxConnectionHandler.prototype.connect=function(n,t,i,r){var l,p,w,h,u,b,o,s,k,a,c;if(t!=null||this.isCreateTarget(i)||this.graph.allowDanglingEdges){var f=this.graph.getModel(),y=!1,e=null;f.beginUpdate();try{if(n!=null&&t==null&&!this.graph.isIgnoreTerminalEvent(i)&&this.isCreateTarget(i)&&(t=this.createTargetVertex(i,n),t!=null&&(r=this.graph.getDropTarget([t],i,r),y=!0,r!=null&&this.graph.getModel().isEdge(r)?r=this.graph.getDefaultParent():(l=this.graph.getView().getState(r),l!=null&&(u=f.getGeometry(t),u.x-=l.origin.x,u.y-=l.origin.y)),this.graph.addCell(t,r))),h=this.graph.getDefaultParent(),n!=null&&t!=null&&f.getParent(n)==f.getParent(t)&&f.getParent(f.getParent(n))!=f.getRoot()&&(h=f.getParent(n),n.geometry!=null&&n.geometry.relative&&t.geometry!=null&&t.geometry.relative&&(h=f.getParent(h))),p=null,w=null,this.edgeState!=null&&(p=this.edgeState.cell.value,w=this.edgeState.cell.style),e=this.insertEdge(h,null,p,n,t,w),e!=null){if(this.graph.setConnectionConstraint(e,n,!0,this.sourceConstraint),this.graph.setConnectionConstraint(e,t,!1,this.constraintHandler.currentConstraint),this.edgeState!=null&&f.setGeometry(e,this.edgeState.cell.geometry),h=f.getParent(n),this.isInsertBefore(e,n,t,i,r)){for(b=null,u=n;u.parent!=null&&u.geometry!=null&&u.geometry.relative&&u.parent!=e.parent;)u=this.graph.model.getParent(u);u!=null&&u.parent!=null&&u.parent==e.parent&&(b=u.parent.getIndex(u),u.parent.insert(e,b))}if(o=f.getGeometry(e),o==null&&(o=new mxGeometry,o.relative=!0,f.setGeometry(e,o)),this.waypoints!=null&&this.waypoints.length>0)for(s=this.graph.view.scale,k=this.graph.view.translate,o.points=[],a=0;a<this.waypoints.length;a++)c=this.waypoints[a],o.points.push(new mxPoint(c.x/s-k.x,c.y/s-k.y));if(t==null){var v=this.graph.view.translate,s=this.graph.view.scale,c=this.originalPoint!=null?new mxPoint(this.originalPoint.x/s-v.x,this.originalPoint.y/s-v.y):new mxPoint(this.currentPoint.x/s-v.x,this.currentPoint.y/s-v.y);c.x-=this.graph.panDx/this.graph.view.scale;c.y-=this.graph.panDy/this.graph.view.scale;o.setTerminalPoint(c,!1)}this.fireEvent(new mxEventObject(mxEvent.CONNECT,"cell",e,"terminal",t,"event",i,"target",r,"terminalInserted",y))}}catch(d){mxLog.show();mxLog.debug(d.message)}finally{f.endUpdate()}this.select&&this.selectCells(e,y?t:null)}};mxConnectionHandler.prototype.selectCells=function(n){this.graph.setSelectionCell(n)};mxConnectionHandler.prototype.insertEdge=function(n,t,i,r,u,f){if(this.factoryMethod==null)return this.graph.insertEdge(n,t,i,r,u,f);var e=this.createEdge(i,r,u,f);return this.graph.addEdge(e,n,r,u)};mxConnectionHandler.prototype.createTargetVertex=function(n,t){for(var i=this.graph.getCellGeometry(t),o,f,e,s,h;i!=null&&i.relative;)t=this.graph.getModel().getParent(t),i=this.graph.getCellGeometry(t);if(o=this.graph.cloneCells([t])[0],i=this.graph.getModel().getGeometry(o),i!=null){var u=this.graph.view.translate,r=this.graph.view.scale,c=new mxPoint(this.currentPoint.x/r-u.x,this.currentPoint.y/r-u.y);i.x=Math.round(c.x-i.width/2-this.graph.panDx/r);i.y=Math.round(c.y-i.height/2-this.graph.panDy/r);f=this.getAlignmentTolerance();f>0&&(e=this.graph.view.getState(t),e!=null&&(s=e.x/r-u.x,h=e.y/r-u.y,Math.abs(s-i.x)<=f&&(i.x=Math.round(s)),Math.abs(h-i.y)<=f&&(i.y=Math.round(h))))}return o};mxConnectionHandler.prototype.getAlignmentTolerance=function(){return this.graph.isGridEnabled()?this.graph.gridSize/2:this.graph.tolerance};mxConnectionHandler.prototype.createEdge=function(n,t,i,r){var u=null,f;return this.factoryMethod!=null&&(u=this.factoryMethod(t,i,r)),u==null&&(u=new mxCell(n||""),u.setEdge(!0),u.setStyle(r),f=new mxGeometry,f.relative=!0,u.setGeometry(f)),u};mxConnectionHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.shape!=null&&(this.shape.destroy(),this.shape=null);this.marker!=null&&(this.marker.destroy(),this.marker=null);this.constraintHandler!=null&&(this.constraintHandler.destroy(),this.constraintHandler=null);this.changeHandler!=null&&(this.graph.getModel().removeListener(this.changeHandler),this.graph.getView().removeListener(this.changeHandler),this.changeHandler=null);this.drillHandler!=null&&(this.graph.removeListener(this.drillHandler),this.graph.getView().removeListener(this.drillHandler),this.drillHandler=null);this.escapeHandler!=null&&(this.graph.removeListener(this.escapeHandler),this.escapeHandler=null)};mxConstraintHandler.prototype.pointImage=new mxImage(mxClient.imageBasePath+"/point.gif",5,5);mxConstraintHandler.prototype.graph=null;mxConstraintHandler.prototype.enabled=!0;mxConstraintHandler.prototype.highlightColor=mxConstants.DEFAULT_VALID_COLOR;mxConstraintHandler.prototype.isEnabled=function(){return this.enabled};mxConstraintHandler.prototype.setEnabled=function(n){this.enabled=n};mxConstraintHandler.prototype.reset=function(){if(this.focusIcons!=null){for(var n=0;n<this.focusIcons.length;n++)this.focusIcons[n].destroy();this.focusIcons=null}this.focusHighlight!=null&&(this.focusHighlight.destroy(),this.focusHighlight=null);this.currentConstraint=null;this.currentFocusArea=null;this.currentPoint=null;this.currentFocus=null;this.focusPoints=null};mxConstraintHandler.prototype.getTolerance=function(){return this.graph.getTolerance()};mxConstraintHandler.prototype.getImageForConstraint=function(){return this.pointImage};mxConstraintHandler.prototype.isEventIgnored=function(){return!1};mxConstraintHandler.prototype.isStateIgnored=function(){return!1};mxConstraintHandler.prototype.destroyIcons=function(){if(this.focusIcons!=null){for(var n=0;n<this.focusIcons.length;n++)this.focusIcons[n].destroy();this.focusIcons=null;this.focusPoints=null}};mxConstraintHandler.prototype.destroyFocusHighlight=function(){this.focusHighlight!=null&&(this.focusHighlight.destroy(),this.focusHighlight=null)};mxConstraintHandler.prototype.isKeepFocusEvent=function(n){return mxEvent.isShiftDown(n.getEvent())};mxConstraintHandler.prototype.getCellForEvent=function(n,t){var i=n.getCell(),r;return i==null&&t!=null&&(n.getGraphX()!=t.x||n.getGraphY()!=t.y)&&(i=this.graph.getCellAt(t.x,t.y)),i==null||this.graph.isCellConnectable(i)||(r=this.graph.getModel().getParent(i),this.graph.getModel().isVertex(r)&&this.graph.isCellConnectable(r)&&(i=r)),i};mxConstraintHandler.prototype.update=function(n,t,i,r){var c,l,a,u,e,s,p;if(this.isEnabled()&&!this.isEventIgnored(n)){this.mouseleaveHandler==null&&this.graph.container!=null&&(this.mouseleaveHandler=mxUtils.bind(this,function(){this.reset()}),mxEvent.addListener(this.graph.container,"mouseleave",this.resetHandler));var f=this.getTolerance(n),w=r!=null?r.x:n.getGraphX(),b=r!=null?r.y:n.getGraphY(),k=new mxRectangle(w-f,b-f,2*f,2*f),h=new mxRectangle(n.getGraphX()-f,n.getGraphY()-f,2*f,2*f),o=this.graph.view.getState(this.getCellForEvent(n,r));if(this.isKeepFocusEvent(n)||this.currentFocusArea!=null&&this.currentFocus!=null&&o==null&&this.graph.getModel().isVertex(this.currentFocus.cell)&&mxUtils.intersects(this.currentFocusArea,h)||o==this.currentFocus||(this.currentFocusArea=null,this.currentFocus=null,this.setFocus(n,o,t)),this.currentConstraint=null,this.currentPoint=null,c=null,this.focusIcons!=null&&this.constraints!=null&&(o==null||this.currentFocus==o))for(l=h.getCenterX(),a=h.getCenterY(),u=0;u<this.focusIcons.length;u++){var v=l-this.focusIcons[u].bounds.getCenterX(),y=a-this.focusIcons[u].bounds.getCenterY(),e=v*v+y*y;(this.intersects(this.focusIcons[u],h,t,i)||r!=null&&this.intersects(this.focusIcons[u],k,t,i))&&(c==null||e<c)&&(this.currentConstraint=this.constraints[u],this.currentPoint=this.focusPoints[u],c=e,e=this.focusIcons[u].bounds.clone(),e.grow(mxConstants.HIGHLIGHT_SIZE+1),e.width-=1,e.height-=1,this.focusHighlight==null&&(s=this.createHighlightShape(),s.dialect=this.graph.dialect==mxConstants.DIALECT_SVG?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML,s.pointerEvents=!1,s.init(this.graph.getView().getOverlayPane()),this.focusHighlight=s,p=mxUtils.bind(this,function(){return this.currentFocus!=null?this.currentFocus:o}),mxEvent.redirectMouseEvents(s.node,this.graph,p)),this.focusHighlight.bounds=e,this.focusHighlight.redraw())}this.currentConstraint==null&&this.destroyFocusHighlight()}else this.currentConstraint=null,this.currentFocus=null,this.currentPoint=null};mxConstraintHandler.prototype.redraw=function(){var t,n;if(this.currentFocus!=null&&this.constraints!=null&&this.focusIcons!=null)for(t=this.graph.view.getState(this.currentFocus.cell),this.currentFocus=t,this.currentFocusArea=new mxRectangle(t.x,t.y,t.width,t.height),n=0;n<this.constraints.length;n++){var i=this.graph.getConnectionPoint(t,this.constraints[n]),r=this.getImageForConstraint(t,this.constraints[n],i),u=new mxRectangle(Math.round(i.x-r.width/2),Math.round(i.y-r.height/2),r.width,r.height);this.focusIcons[n].bounds=u;this.focusIcons[n].redraw();this.currentFocusArea.add(this.focusIcons[n].bounds);this.focusPoints[n]=i}};mxConstraintHandler.prototype.setFocus=function(n,t,i){var u,o;if(this.constraints=t!=null&&!this.isStateIgnored(t,i)&&this.graph.isCellConnectable(t.cell)?this.isEnabled()?this.graph.getAllConnectionConstraints(t,i)||[]:[]:null,this.constraints!=null){if(this.currentFocus=t,this.currentFocusArea=new mxRectangle(t.x,t.y,t.width,t.height),this.focusIcons!=null){for(u=0;u<this.focusIcons.length;u++)this.focusIcons[u].destroy();this.focusIcons=null;this.focusPoints=null}for(this.focusPoints=[],this.focusIcons=[],u=0;u<this.constraints.length;u++){var e=this.graph.getConnectionPoint(t,this.constraints[u]),f=this.getImageForConstraint(t,this.constraints[u],e),s=f.src,h=new mxRectangle(Math.round(e.x-f.width/2),Math.round(e.y-f.height/2),f.width,f.height),r=new mxImageShape(h,s);r.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG;r.preserveImageAspect=!1;r.init(this.graph.getView().getDecoratorPane());(mxClient.IS_QUIRKS||document.documentMode==8)&&mxEvent.addListener(r.node,"dragstart",function(n){return mxEvent.consume(n),!1});r.node.previousSibling!=null&&r.node.parentNode.insertBefore(r.node,r.node.parentNode.firstChild);o=mxUtils.bind(this,function(){return this.currentFocus!=null?this.currentFocus:t});r.redraw();mxEvent.redirectMouseEvents(r.node,this.graph,o);this.currentFocusArea.add(r.bounds);this.focusIcons.push(r);this.focusPoints.push(e)}this.currentFocusArea.grow(this.getTolerance(n))}else this.destroyIcons(),this.destroyFocusHighlight()};mxConstraintHandler.prototype.createHighlightShape=function(){var n=new mxRectangleShape(null,this.highlightColor,this.highlightColor,mxConstants.HIGHLIGHT_STROKEWIDTH);return n.opacity=mxConstants.HIGHLIGHT_OPACITY,n};mxConstraintHandler.prototype.intersects=function(n,t){return mxUtils.intersects(n.bounds,t)};mxConstraintHandler.prototype.destroy=function(){this.reset();this.resetHandler!=null&&(this.graph.model.removeListener(this.resetHandler),this.graph.view.removeListener(this.resetHandler),this.graph.removeListener(this.resetHandler),this.resetHandler=null);this.mouseleaveHandler!=null&&this.graph.container!=null&&(mxEvent.removeListener(this.graph.container,"mouseleave",this.mouseleaveHandler),this.mouseleaveHandler=null)};mxRubberband.prototype.defaultOpacity=20;mxRubberband.prototype.enabled=!0;mxRubberband.prototype.div=null;mxRubberband.prototype.sharedDiv=null;mxRubberband.prototype.currentX=0;mxRubberband.prototype.currentY=0;mxRubberband.prototype.fadeOut=!1;mxRubberband.prototype.isEnabled=function(){return this.enabled};mxRubberband.prototype.setEnabled=function(n){this.enabled=n};mxRubberband.prototype.isForceRubberbandEvent=function(n){return mxEvent.isAltDown(n.getEvent())};mxRubberband.prototype.mouseDown=function(n,t){if(!t.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&t.getState()==null&&!mxEvent.isMultiTouchEvent(t.getEvent())){var r=mxUtils.getOffset(this.graph.container),i=mxUtils.getScrollOrigin(this.graph.container);i.x-=r.x;i.y-=r.y;this.start(t.getX()+i.x,t.getY()+i.y);t.consume(!1)}};mxRubberband.prototype.start=function(n,t){function i(n){var t=new mxMouseEvent(n),i=mxUtils.convertPoint(r,t.getX(),t.getY());return t.graphX=i.x,t.graphY=i.y,t}this.first=new mxPoint(n,t);var r=this.graph.container;this.dragHandler=mxUtils.bind(this,function(n){this.mouseMove(this.graph,i(n))});this.dropHandler=mxUtils.bind(this,function(n){this.mouseUp(this.graph,i(n))});mxClient.IS_FF&&mxEvent.addGestureListeners(document,null,this.dragHandler,this.dropHandler)};mxRubberband.prototype.mouseMove=function(n,t){var i,r;if(!t.isConsumed()&&this.first!=null){i=mxUtils.getScrollOrigin(this.graph.container);r=mxUtils.getOffset(this.graph.container);i.x-=r.x;i.y-=r.y;var u=t.getX()+i.x,f=t.getY()+i.y,o=this.first.x-u,s=this.first.y-f,e=this.graph.tolerance;(this.div!=null||Math.abs(o)>e||Math.abs(s)>e)&&(this.div==null&&(this.div=this.createShape()),mxUtils.clearSelection(),this.update(u,f),t.consume())}};mxRubberband.prototype.createShape=function(){this.sharedDiv==null&&(this.sharedDiv=document.createElement("div"),this.sharedDiv.className="mxRubberband",mxUtils.setOpacity(this.sharedDiv,this.defaultOpacity));this.graph.container.appendChild(this.sharedDiv);var n=this.sharedDiv;return mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)&&this.fadeOut&&(this.sharedDiv=null),n};mxRubberband.prototype.isActive=function(){return this.div!=null&&this.div.style.display!="none"};mxRubberband.prototype.mouseUp=function(n,t){var i=this.isActive();this.reset();i&&(this.execute(t.getEvent()),t.consume())};mxRubberband.prototype.execute=function(n){var t=new mxRectangle(this.x,this.y,this.width,this.height);this.graph.selectRegion(t,n)};mxRubberband.prototype.reset=function(){if(this.div!=null)if(mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)&&this.fadeOut){var n=this.div;mxUtils.setPrefixedStyle(n.style,"transition","all 0.2s linear");n.style.pointerEvents="none";n.style.opacity=0;window.setTimeout(function(){n.parentNode.removeChild(n)},200)}else this.div.parentNode.removeChild(this.div);mxEvent.removeGestureListeners(document,null,this.dragHandler,this.dropHandler);this.dragHandler=null;this.dropHandler=null;this.currentX=0;this.currentY=0;this.first=null;this.div=null};mxRubberband.prototype.update=function(n,t){this.currentX=n;this.currentY=t;this.repaint()};mxRubberband.prototype.repaint=function(){var n,t,i,r;this.div!=null&&(n=this.currentX-this.graph.panDx,t=this.currentY-this.graph.panDy,this.x=Math.min(this.first.x,n),this.y=Math.min(this.first.y,t),this.width=Math.max(this.first.x,n)-this.x,this.height=Math.max(this.first.y,t)-this.y,i=mxClient.IS_VML?this.graph.panDx:0,r=mxClient.IS_VML?this.graph.panDy:0,this.div.style.left=this.x+i+"px",this.div.style.top=this.y+r+"px",this.div.style.width=Math.max(1,this.width)+"px",this.div.style.height=Math.max(1,this.height)+"px")};mxRubberband.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.graph.removeMouseListener(this),this.graph.removeListener(this.forceRubberbandHandler),this.graph.removeListener(this.panHandler),this.reset(),this.sharedDiv!=null&&(this.sharedDiv=null))};mxHandle.prototype.cursor="default";mxHandle.prototype.image=null;mxHandle.prototype.ignoreGrid=!1;mxHandle.prototype.getPosition=function(){};mxHandle.prototype.setPosition=function(){};mxHandle.prototype.execute=function(){};mxHandle.prototype.copyStyle=function(n){this.graph.setCellStyles(n,this.state.style[n],[this.state.cell])};mxHandle.prototype.processEvent=function(n){var i=this.graph.view.scale,u=this.graph.view.translate,t=new mxPoint(n.getGraphX()/i-u.x,n.getGraphY()/i-u.y),r,f;this.shape!=null&&this.shape.bounds!=null&&(t.x-=this.shape.bounds.width/i/4,t.y-=this.shape.bounds.height/i/4);r=-mxUtils.toRadians(this.getRotation());f=-mxUtils.toRadians(this.getTotalRotation())-r;t=this.flipPoint(this.rotatePoint(this.snapPoint(this.rotatePoint(t,r),this.ignoreGrid||!this.graph.isGridEnabledEvent(n.getEvent())),f));this.setPosition(this.state.getPaintBounds(),t,n);this.positionChanged();this.redraw()};mxHandle.prototype.positionChanged=function(){this.state.text!=null&&this.state.text.apply(this.state);this.state.shape!=null&&this.state.shape.apply(this.state);this.graph.cellRenderer.redraw(this.state,!0)};mxHandle.prototype.getRotation=function(){return this.state.shape!=null?this.state.shape.getRotation():0};mxHandle.prototype.getTotalRotation=function(){return this.state.shape!=null?this.state.shape.getShapeRotation():0};mxHandle.prototype.init=function(){var n=this.isHtmlRequired();this.image!=null?(this.shape=new mxImageShape(new mxRectangle(0,0,this.image.width,this.image.height),this.image.src),this.shape.preserveImageAspect=!1):this.shape=this.createShape(n);this.initShape(n)};mxHandle.prototype.createShape=function(){var n=new mxRectangle(0,0,mxConstants.HANDLE_SIZE,mxConstants.HANDLE_SIZE);return new mxRectangleShape(n,mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};mxHandle.prototype.initShape=function(n){n&&this.shape.isHtmlAllowed()?(this.shape.dialect=mxConstants.DIALECT_STRICTHTML,this.shape.init(this.graph.container)):(this.shape.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,this.cursor!=null&&this.shape.init(this.graph.getView().getOverlayPane()));mxEvent.redirectMouseEvents(this.shape.node,this.graph,this.state);this.shape.node.style.cursor=this.cursor};mxHandle.prototype.redraw=function(){var n,r,t,i;this.shape!=null&&this.state.shape!=null&&(n=this.getPosition(this.state.getPaintBounds()),n!=null&&(r=mxUtils.toRadians(this.getTotalRotation()),n=this.rotatePoint(this.flipPoint(n),r),t=this.graph.view.scale,i=this.graph.view.translate,this.shape.bounds.x=Math.floor((n.x+i.x)*t-this.shape.bounds.width/2),this.shape.bounds.y=Math.floor((n.y+i.y)*t-this.shape.bounds.height/2),this.shape.redraw()))};mxHandle.prototype.isHtmlRequired=function(){return this.state.text!=null&&this.state.text.node.parentNode==this.graph.container};mxHandle.prototype.rotatePoint=function(n,t){var i=this.state.getCellBounds(),r=new mxPoint(i.getCenterX(),i.getCenterY()),u=Math.cos(t),f=Math.sin(t);return mxUtils.getRotatedPoint(n,u,f,r)};mxHandle.prototype.flipPoint=function(n){if(this.state.shape!=null){var t=this.state.getCellBounds();this.state.shape.flipH&&(n.x=2*t.x+t.width-n.x);this.state.shape.flipV&&(n.y=2*t.y+t.height-n.y)}return n};mxHandle.prototype.snapPoint=function(n,t){return t||(n.x=this.graph.snap(n.x),n.y=this.graph.snap(n.y)),n};mxHandle.prototype.setVisible=function(n){this.shape!=null&&this.shape.node!=null&&(this.shape.node.style.display=n?"":"none")};mxHandle.prototype.reset=function(){this.setVisible(!0);this.state.style=this.graph.getCellStyle(this.state.cell);this.positionChanged()};mxHandle.prototype.destroy=function(){this.shape!=null&&(this.shape.destroy(),this.shape=null)};mxVertexHandler.prototype.graph=null;mxVertexHandler.prototype.state=null;mxVertexHandler.prototype.singleSizer=!1;mxVertexHandler.prototype.index=null;mxVertexHandler.prototype.allowHandleBoundsCheck=!0;mxVertexHandler.prototype.handleImage=null;mxVertexHandler.prototype.tolerance=0;mxVertexHandler.prototype.rotationEnabled=!1;mxVertexHandler.prototype.parentHighlightEnabled=!1;mxVertexHandler.prototype.rotationRaster=!0;mxVertexHandler.prototype.rotationCursor="crosshair";mxVertexHandler.prototype.livePreview=!1;mxVertexHandler.prototype.manageSizers=!1;mxVertexHandler.prototype.constrainGroupByChildren=!1;mxVertexHandler.prototype.rotationHandleVSpacing=-16;mxVertexHandler.prototype.horizontalOffset=0;mxVertexHandler.prototype.verticalOffset=0;mxVertexHandler.prototype.init=function(){var t,n,i;this.graph=this.state.view.graph;this.selectionBounds=this.getSelectionBounds(this.state);this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height);this.selectionBorder=this.createSelectionShape(this.bounds);this.selectionBorder.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.pointerEvents=!1;this.selectionBorder.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0");this.selectionBorder.init(this.graph.getView().getOverlayPane());mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state);this.graph.isCellMovable(this.state.cell)&&this.selectionBorder.setCursor(mxConstants.CURSOR_MOVABLE_VERTEX);(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)&&(t=this.graph.isCellResizable(this.state.cell),this.sizers=[],t||this.graph.isLabelMovable(this.state.cell)&&this.state.width>=2&&this.state.height>=2?(n=0,t&&(this.singleSizer||(this.sizers.push(this.createSizer("nw-resize",n++)),this.sizers.push(this.createSizer("n-resize",n++)),this.sizers.push(this.createSizer("ne-resize",n++)),this.sizers.push(this.createSizer("w-resize",n++)),this.sizers.push(this.createSizer("e-resize",n++)),this.sizers.push(this.createSizer("sw-resize",n++)),this.sizers.push(this.createSizer("s-resize",n++))),this.sizers.push(this.createSizer("se-resize",n++))),i=this.graph.model.getGeometry(this.state.cell),i==null||i.relative||this.graph.isSwimlane(this.state.cell)||!this.graph.isLabelMovable(this.state.cell)||(this.labelShape=this.createSizer(mxConstants.CURSOR_LABEL_HANDLE,mxEvent.LABEL_HANDLE,mxConstants.LABEL_HANDLE_SIZE,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape))):this.graph.isCellMovable(this.state.cell)&&!this.graph.isCellResizable(this.state.cell)&&this.state.width<2&&this.state.height<2&&(this.labelShape=this.createSizer(mxConstants.CURSOR_MOVABLE_VERTEX,mxEvent.LABEL_HANDLE,null,mxConstants.LABEL_HANDLE_FILLCOLOR),this.sizers.push(this.labelShape)));this.isRotationHandleVisible()&&(this.rotationShape=this.createSizer(this.rotationCursor,mxEvent.ROTATION_HANDLE,mxConstants.HANDLE_SIZE+3,mxConstants.HANDLE_FILLCOLOR),this.sizers.push(this.rotationShape));this.customHandles=this.createCustomHandles();this.redraw();this.constrainGroupByChildren&&this.updateMinBounds()};mxVertexHandler.prototype.isRotationHandleVisible=function(){return this.graph.isEnabled()&&this.rotationEnabled&&this.graph.isCellRotatable(this.state.cell)&&(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)&&this.state.width>=2&&this.state.height>=2};mxVertexHandler.prototype.isConstrainedEvent=function(n){return mxEvent.isShiftDown(n.getEvent())||this.state.style[mxConstants.STYLE_ASPECT]=="fixed"};mxVertexHandler.prototype.isCenteredEvent=function(){return!1};mxVertexHandler.prototype.createCustomHandles=function(){return null};mxVertexHandler.prototype.updateMinBounds=function(){var i=this.graph.getChildCells(this.state.cell),n,t;i.length>0&&(this.minBounds=this.graph.view.getBounds(i),this.minBounds!=null&&(n=this.state.view.scale,t=this.state.view.translate,this.minBounds.x-=this.state.x,this.minBounds.y-=this.state.y,this.minBounds.x/=n,this.minBounds.y/=n,this.minBounds.width/=n,this.minBounds.height/=n,this.x0=this.state.x/n-t.x,this.y0=this.state.y/n-t.y))};mxVertexHandler.prototype.getSelectionBounds=function(n){return new mxRectangle(Math.round(n.x),Math.round(n.y),Math.round(n.width),Math.round(n.height))};mxVertexHandler.prototype.createParentHighlightShape=function(n){return this.createSelectionShape(n)};mxVertexHandler.prototype.createSelectionShape=function(n){var t=new mxRectangleShape(n,null,this.getSelectionColor());return t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t};mxVertexHandler.prototype.getSelectionColor=function(){return mxConstants.VERTEX_SELECTION_COLOR};mxVertexHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.VERTEX_SELECTION_STROKEWIDTH};mxVertexHandler.prototype.isSelectionDashed=function(){return mxConstants.VERTEX_SELECTION_DASHED};mxVertexHandler.prototype.createSizer=function(n,t,i,r){i=i||mxConstants.HANDLE_SIZE;var f=new mxRectangle(0,0,i,i),u=this.createSizerShape(f,t,r);return u.isHtmlAllowed()&&this.state.text!=null&&this.state.text.node.parentNode==this.graph.container?(u.bounds.height-=1,u.bounds.width-=1,u.dialect=mxConstants.DIALECT_STRICTHTML,u.init(this.graph.container)):(u.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,u.init(this.graph.getView().getOverlayPane())),mxEvent.redirectMouseEvents(u.node,this.graph,this.state),this.graph.isEnabled()&&u.setCursor(n),this.isSizerVisible(t)||(u.visible=!1),u};mxVertexHandler.prototype.isSizerVisible=function(){return!0};mxVertexHandler.prototype.createSizerShape=function(n,t,i){if(this.handleImage!=null){n=new mxRectangle(n.x,n.y,this.handleImage.width,this.handleImage.height);var r=new mxImageShape(n,this.handleImage.src);return r.preserveImageAspect=!1,r}return t==mxEvent.ROTATION_HANDLE?new mxEllipse(n,i||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR):new mxRectangleShape(n,i||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR)};mxVertexHandler.prototype.moveSizerTo=function(n,t,i){n!=null&&(n.bounds.x=Math.floor(t-n.bounds.width/2),n.bounds.y=Math.floor(i-n.bounds.height/2),n.node!=null&&n.node.style.display!="none"&&n.redraw())};mxVertexHandler.prototype.getHandleForEvent=function(n){function r(t){return t!=null&&(n.isSource(t)||u!=null&&mxUtils.intersects(t.bounds,u)&&t.node.style.display!="none"&&t.node.style.visibility!="hidden")}var i=mxEvent.isMouseEvent(n.getEvent())?1:this.tolerance,u=this.allowHandleBoundsCheck&&(mxClient.IS_IE||i>0)?new mxRectangle(n.getGraphX()-i,n.getGraphY()-i,2*i,2*i):null,t;if(this.customHandles!=null&&this.isCustomHandleEvent(n))for(t=this.customHandles.length-1;t>=0;t--)if(r(this.customHandles[t].shape))return mxEvent.CUSTOM_HANDLE-t;if(r(this.rotationShape))return mxEvent.ROTATION_HANDLE;if(r(this.labelShape))return mxEvent.LABEL_HANDLE;if(this.sizers!=null)for(t=0;t<this.sizers.length;t++)if(r(this.sizers[t]))return t;return null};mxVertexHandler.prototype.isCustomHandleEvent=function(){return!0};mxVertexHandler.prototype.mouseDown=function(n,t){var r=mxEvent.isMouseEvent(t.getEvent())?0:this.tolerance,i;!t.isConsumed()&&this.graph.isEnabled()&&(r>0||t.getState()==this.state)&&(i=this.getHandleForEvent(t),i!=null&&(this.start(t.getGraphX(),t.getGraphY(),i),t.consume()))};mxVertexHandler.prototype.isLivePreviewBorder=function(){return this.state.shape!=null&&this.state.shape.fill==null&&this.state.shape.stroke==null};mxVertexHandler.prototype.start=function(n,t,i){var u,r,e,f,o;if(this.inTolerance=!0,this.childOffsetX=0,this.childOffsetY=0,this.index=i,this.startX=n,this.startY=t,u=this.state.view.graph.model,r=u.getParent(this.state.cell),this.state.view.currentRoot!=r&&(u.isVertex(r)||u.isEdge(r))&&(this.parentState=this.state.view.graph.view.getState(r)),this.selectionBorder.node.style.display=i==mxEvent.ROTATION_HANDLE?"inline":"none",(!this.livePreview||this.isLivePreviewBorder())&&(this.preview=this.createSelectionShape(this.bounds),mxClient.IS_SVG&&Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")!=0||this.state.text==null||this.state.text.node.parentNode!=this.graph.container?(this.preview.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.preview.init(this.graph.view.getOverlayPane())):(this.preview.dialect=mxConstants.DIALECT_STRICTHTML,this.preview.init(this.graph.container))),this.livePreview)for(this.hideSizers(),i==mxEvent.ROTATION_HANDLE?this.rotationShape.node.style.display="":i==mxEvent.LABEL_HANDLE?this.labelShape.node.style.display="":this.sizers!=null&&this.sizers[i]!=null?this.sizers[i].node.style.display="":i<=mxEvent.CUSTOM_HANDLE&&this.customHandles!=null&&this.customHandles[mxEvent.CUSTOM_HANDLE-i].setVisible(!0),e=this.graph.getEdges(this.state.cell),this.edgeHandlers=[],f=0;f<e.length;f++)o=this.graph.selectionCellsHandler.getHandler(e[f]),o!=null&&this.edgeHandlers.push(o)};mxVertexHandler.prototype.setHandlesVisible=function(n){var t;if(this.sizers!=null)for(t=0;t<this.sizers.length;t++)this.sizers[t].node.style.display=n?"":"none";if(this.customHandles!=null)for(t=0;t<this.customHandles.length;t++)this.customHandles[t].setVisible(n)};mxVertexHandler.prototype.hideSizers=function(){this.setHandlesVisible(!1)};mxVertexHandler.prototype.checkTolerance=function(n){this.inTolerance&&this.startX!=null&&this.startY!=null&&(mxEvent.isMouseEvent(n.getEvent())||Math.abs(n.getGraphX()-this.startX)>this.graph.tolerance||Math.abs(n.getGraphY()-this.startY)>this.graph.tolerance)&&(this.inTolerance=!1)};mxVertexHandler.prototype.updateHint=function(){};mxVertexHandler.prototype.removeHint=function(){};mxVertexHandler.prototype.roundAngle=function(n){return Math.round(n*10)/10};mxVertexHandler.prototype.roundLength=function(n){return Math.round(n)};mxVertexHandler.prototype.mouseMove=function(n,t){t.isConsumed()||this.index==null?this.graph.isMouseDown||this.getHandleForEvent(t)==null||t.consume(!1):(this.checkTolerance(t),this.inTolerance||(this.index<=mxEvent.CUSTOM_HANDLE?this.customHandles!=null&&(this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].processEvent(t),this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].active=!0):this.index==mxEvent.LABEL_HANDLE?this.moveLabel(t):this.index==mxEvent.ROTATION_HANDLE?this.rotateVertex(t):this.resizeVertex(t),this.updateHint(t)),t.consume())};mxVertexHandler.prototype.moveLabel=function(n){var t=new mxPoint(n.getGraphX(),n.getGraphY()),i=this.graph.view.translate,r=this.graph.view.scale,u;this.graph.isGridEnabledEvent(n.getEvent())&&(t.x=(this.graph.snap(t.x/r-i.x)+i.x)*r,t.y=(this.graph.snap(t.y/r-i.y)+i.y)*r);u=this.rotationShape!=null?this.sizers.length-2:this.sizers.length-1;this.moveSizerTo(this.sizers[u],t.x,t.y)};mxVertexHandler.prototype.rotateVertex=function(n){var i=new mxPoint(n.getGraphX(),n.getGraphY()),t=this.state.x+this.state.width/2-i.x,r=this.state.y+this.state.height/2-i.y;if(this.currentAlpha=t!=0?Math.atan(r/t)*180/Math.PI+90:r<0?180:0,t>0&&(this.currentAlpha-=180),this.rotationRaster&&this.graph.isGridEnabledEvent(n.getEvent())){var t=i.x-this.state.getCenterX(),r=i.y-this.state.getCenterY(),f=Math.abs(Math.sqrt(t*t+r*r)-20)*3,u=Math.max(1,5*Math.min(3,Math.max(0,Math.round(80/Math.abs(f)))));this.currentAlpha=Math.round(this.currentAlpha/u)*u}else this.currentAlpha=this.roundAngle(this.currentAlpha);this.selectionBorder.rotation=this.currentAlpha;this.selectionBorder.redraw();this.livePreview&&this.redrawHandles()};mxVertexHandler.prototype.resizeVertex=function(n){var y=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),h=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),p=new mxPoint(n.getGraphX(),n.getGraphY()),c=this.graph.view.translate,i=this.graph.view.scale,u=Math.cos(-h),f=Math.sin(-h),e=p.x-this.startX,o=p.y-this.startY,d=u*e-f*o,g=f*e+u*o,l,t,r,s;e=d;o=g;l=this.graph.getCellGeometry(this.state.cell);this.unscaledBounds=this.union(l,e/i,o/i,this.index,this.graph.isGridEnabledEvent(n.getEvent()),1,new mxPoint(0,0),this.isConstrainedEvent(n),this.isCenteredEvent(this.state,n));l.relative||(t=this.graph.getMaximumGraphBounds(),t!=null&&this.parentState!=null&&(t=mxRectangle.fromRectangle(t),t.x-=(this.parentState.x-c.x*i)/i,t.y-=(this.parentState.y-c.y*i)/i),this.graph.isConstrainChild(this.state.cell)&&(r=this.graph.getCellContainmentArea(this.state.cell),r!=null&&(s=this.graph.getOverlap(this.state.cell),s>0&&(r=mxRectangle.fromRectangle(r),r.x-=r.width*s,r.y-=r.height*s,r.width+=2*r.width*s,r.height+=2*r.height*s),t==null?t=r:(t=mxRectangle.fromRectangle(t),t.intersect(r)))),t!=null&&(this.unscaledBounds.x<t.x&&(this.unscaledBounds.width-=t.x-this.unscaledBounds.x,this.unscaledBounds.x=t.x),this.unscaledBounds.y<t.y&&(this.unscaledBounds.height-=t.y-this.unscaledBounds.y,this.unscaledBounds.y=t.y),this.unscaledBounds.x+this.unscaledBounds.width>t.x+t.width&&(this.unscaledBounds.width-=this.unscaledBounds.x+this.unscaledBounds.width-t.x-t.width),this.unscaledBounds.y+this.unscaledBounds.height>t.y+t.height&&(this.unscaledBounds.height-=this.unscaledBounds.y+this.unscaledBounds.height-t.y-t.height)));this.bounds=new mxRectangle((this.parentState!=null?this.parentState.x:c.x*i)+this.unscaledBounds.x*i,(this.parentState!=null?this.parentState.y:c.y*i)+this.unscaledBounds.y*i,this.unscaledBounds.width*i,this.unscaledBounds.height*i);l.relative&&this.parentState!=null&&(this.bounds.x+=this.state.x-this.parentState.x,this.bounds.y+=this.state.y-this.parentState.y);u=Math.cos(h);f=Math.sin(h);var w=new mxPoint(this.bounds.getCenterX(),this.bounds.getCenterY()),e=w.x-y.x,o=w.y-y.y,nt=u*e-f*o,tt=f*e+u*o,a=nt-e,v=tt-o,b=this.bounds.x-this.state.x,k=this.bounds.y-this.state.y,it=u*b-f*k,rt=f*b+u*k;this.bounds.x+=a;this.bounds.y+=v;this.unscaledBounds.x=this.roundLength(this.unscaledBounds.x+a/i);this.unscaledBounds.y=this.roundLength(this.unscaledBounds.y+v/i);this.unscaledBounds.width=this.roundLength(this.unscaledBounds.width);this.unscaledBounds.height=this.roundLength(this.unscaledBounds.height);this.graph.isCellCollapsed(this.state.cell)||a==0&&v==0?(this.childOffsetX=0,this.childOffsetY=0):(this.childOffsetX=this.state.x-this.bounds.x+it,this.childOffsetY=this.state.y-this.bounds.y+rt);this.livePreview&&this.updateLivePreview(n);this.preview!=null&&this.drawPreview()};mxVertexHandler.prototype.updateLivePreview=function(){var r=this.graph.view.scale,u=this.graph.view.translate,f=this.state.clone(),n,t,i;this.state.x=this.bounds.x;this.state.y=this.bounds.y;this.state.origin=new mxPoint(this.state.x/r-u.x,this.state.y/r-u.y);this.state.width=this.bounds.width;this.state.height=this.bounds.height;this.state.unscaledWidth=null;n=this.state.absoluteOffset;n=new mxPoint(n.x,n.y);this.state.absoluteOffset.x=0;this.state.absoluteOffset.y=0;t=this.graph.getCellGeometry(this.state.cell);t!=null&&(i=t.offset||this.EMPTY_POINT,i==null||t.relative||(this.state.absoluteOffset.x=this.state.view.scale*i.x,this.state.absoluteOffset.y=this.state.view.scale*i.y),this.state.view.updateVertexLabelOffset(this.state));this.state.view.graph.cellRenderer.redraw(this.state,!0);this.state.view.invalidate(this.state.cell);this.state.invalid=!1;this.state.view.validate();this.redrawHandles();this.state.setState(f)};mxVertexHandler.prototype.mouseUp=function(n,t){var u,f,e,c;if(this.index!=null&&this.state!=null){u=new mxPoint(t.getGraphX(),t.getGraphY());this.graph.getModel().beginUpdate();try{if(this.index<=mxEvent.CUSTOM_HANDLE)this.customHandles!=null&&(this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].active=!1,this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].execute());else if(this.index==mxEvent.ROTATION_HANDLE)this.currentAlpha!=null?(f=this.currentAlpha-(this.state.style[mxConstants.STYLE_ROTATION]||0),f!=0&&this.rotateCell(this.state.cell,f)):this.rotateClick();else{var l=this.graph.isGridEnabledEvent(t.getEvent()),o=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),s=Math.cos(-o),h=Math.sin(-o),i=u.x-this.startX,r=u.y-this.startY,a=s*i-h*r,v=h*i+s*r;i=a;r=v;e=this.graph.view.scale;c=this.isRecursiveResize(this.state,t);this.resizeCell(this.state.cell,this.roundLength(i/e),this.roundLength(r/e),this.index,l,this.isConstrainedEvent(t),c)}}finally{this.graph.getModel().endUpdate()}t.consume();this.reset()}};mxVertexHandler.prototype.isRecursiveResize=function(){return this.graph.isRecursiveResize(this.state)};mxVertexHandler.prototype.rotateClick=function(){};mxVertexHandler.prototype.rotateCell=function(n,t,i){var r,o,s,h,u,f,c,e;if(t!=0&&(r=this.graph.getModel(),(r.isVertex(n)||r.isEdge(n))&&(r.isEdge(n)||(o=this.graph.view.getState(n),s=o!=null?o.style:this.graph.getCellStyle(n),s!=null&&(h=(s[mxConstants.STYLE_ROTATION]||0)+t,this.graph.setCellStyles(mxConstants.STYLE_ROTATION,h,[n]))),u=this.graph.getCellGeometry(n),u!=null&&(f=this.graph.getCellGeometry(i),f==null||r.isEdge(i)||(u=u.clone(),u.rotate(t,new mxPoint(f.width/2,f.height/2)),r.setGeometry(n,u)),r.isVertex(n)&&!u.relative||r.isEdge(n)))))for(c=r.getChildCount(n),e=0;e<c;e++)this.rotateCell(r.getChildAt(n,e),t,n)};mxVertexHandler.prototype.reset=function(){var n;if(this.sizers!=null&&this.index!=null&&this.sizers[this.index]!=null&&this.sizers[this.index].node.style.display=="none"&&(this.sizers[this.index].node.style.display=""),this.currentAlpha=null,this.inTolerance=null,this.index=null,this.preview!=null&&(this.preview.destroy(),this.preview=null),this.livePreview&&this.sizers!=null)for(n=0;n<this.sizers.length;n++)this.sizers[n]!=null&&(this.sizers[n].node.style.display="");if(this.customHandles!=null)for(n=0;n<this.customHandles.length;n++)this.customHandles[n].active?(this.customHandles[n].active=!1,this.customHandles[n].reset()):this.customHandles[n].setVisible(!0);this.selectionBorder!=null&&(this.selectionBorder.node.style.display="inline",this.selectionBounds=this.getSelectionBounds(this.state),this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height),this.drawPreview());this.removeHint();this.redrawHandles();this.edgeHandlers=null;this.unscaledBounds=null};mxVertexHandler.prototype.resizeCell=function(n,t,i,r,u,f,e){var o=this.graph.model.getGeometry(n),s;o!=null&&(r==mxEvent.LABEL_HANDLE?(s=this.graph.view.scale,t=Math.round((this.labelShape.bounds.getCenterX()-this.startX)/s),i=Math.round((this.labelShape.bounds.getCenterY()-this.startY)/s),o=o.clone(),o.offset==null?o.offset=new mxPoint(t,i):(o.offset.x+=t,o.offset.y+=i),this.graph.model.setGeometry(n,o)):this.unscaledBounds!=null&&(s=this.graph.view.scale,(this.childOffsetX!=0||this.childOffsetY!=0)&&this.moveChildren(n,Math.round(this.childOffsetX/s),Math.round(this.childOffsetY/s)),this.graph.resizeCell(n,this.unscaledBounds,e)))};mxVertexHandler.prototype.moveChildren=function(n,t,i){for(var e,r,u=this.graph.getModel(),o=u.getChildCount(n),f=0;f<o;f++)e=u.getChildAt(n,f),r=this.graph.getCellGeometry(e),r!=null&&(r=r.clone(),r.translate(t,i),u.setGeometry(e,r))};mxVertexHandler.prototype.union=function(n,t,i,r,u,f,e,o,s){var w,b,d,c,l,k,tt,it,rt,v;if(this.singleSizer)return w=n.x+n.width+t,b=n.y+n.height+i,u&&(w=this.graph.snap(w/f)*f,b=this.graph.snap(b/f)*f),d=new mxRectangle(n.x,n.y,0,0),d.add(new mxRectangle(w,b,0,0)),d;var g=n.width,nt=n.height,a=n.x-e.x*f,p=a+g,h=n.y-e.y*f,y=h+nt,ut=a+g/2,ft=h+nt/2;return r>4?(y=y+i,u&&(y=this.graph.snap(y/f)*f)):r<3&&(h=h+i,u&&(h=this.graph.snap(h/f)*f)),r==0||r==3||r==5?(a+=t,u&&(a=this.graph.snap(a/f)*f)):(r==2||r==4||r==7)&&(p+=t,u&&(p=this.graph.snap(p/f)*f)),c=p-a,l=y-h,o&&(k=this.graph.getCellGeometry(this.state.cell),k!=null&&(tt=k.width/k.height,r==1||r==2||r==7||r==6?c=l*tt:l=c/tt,r==0&&(a=p-c,h=y-l))),s&&(c+=c-g,l+=l-nt,it=ut-(a+c/2),rt=ft-(h+l/2),a+=it,h+=rt,p+=it,y+=rt),c<0&&(a+=c,c=Math.abs(c)),l<0&&(h+=l,l=Math.abs(l)),v=new mxRectangle(a+e.x*f,h+e.y*f,c,l),this.minBounds!=null&&(v.width=Math.max(v.width,this.minBounds.x*f+this.minBounds.width*f+Math.max(0,this.x0*f-v.x)),v.height=Math.max(v.height,this.minBounds.y*f+this.minBounds.height*f+Math.max(0,this.y0*f-v.y))),v};mxVertexHandler.prototype.redraw=function(){this.selectionBounds=this.getSelectionBounds(this.state);this.bounds=new mxRectangle(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height);this.redrawHandles();this.drawPreview()};mxVertexHandler.prototype.getHandlePadding=function(){var t=new mxPoint(0,0),n=this.tolerance;return this.sizers!=null&&this.sizers.length>0&&this.sizers[0]!=null&&(this.bounds.width<2*this.sizers[0].bounds.width+2*n||this.bounds.height<2*this.sizers[0].bounds.height+2*n)&&(n/=2,t.x=this.sizers[0].bounds.width+n,t.y=this.sizers[0].bounds.height+n),t};mxVertexHandler.prototype.redrawHandles=function(){var y=this.tolerance,t,v,s,h,c,l,r,p;if(this.horizontalOffset=0,this.verticalOffset=0,t=this.bounds,this.sizers!=null&&this.sizers.length>0&&this.sizers[0]!=null)if(this.index==null&&this.manageSizers&&this.sizers.length>=8&&(v=this.getHandlePadding(),this.horizontalOffset=v.x,this.verticalOffset=v.y,(this.horizontalOffset!=0||this.verticalOffset!=0)&&(t=new mxRectangle(t.x,t.y,t.width,t.height),t.x-=this.horizontalOffset/2,t.width+=this.horizontalOffset,t.y-=this.verticalOffset/2,t.height+=this.verticalOffset),this.sizers.length>=8&&(t.width<2*this.sizers[0].bounds.width+2*y||t.height<2*this.sizers[0].bounds.height+2*y?(this.sizers[0].node.style.display="none",this.sizers[2].node.style.display="none",this.sizers[5].node.style.display="none",this.sizers[7].node.style.display="none"):(this.sizers[0].node.style.display="",this.sizers[2].node.style.display="",this.sizers[5].node.style.display="",this.sizers[7].node.style.display=""))),s=t.x+t.width,h=t.y+t.height,this.singleSizer)this.moveSizerTo(this.sizers[0],s,h);else if(c=t.x+t.width/2,l=t.y+t.height/2,this.sizers.length>=8){var i=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],a=mxUtils.toRadians(this.state.style[mxConstants.STYLE_ROTATION]||"0"),u=Math.cos(a),f=Math.sin(a),o=Math.round(a*4/Math.PI),e=new mxPoint(t.getCenterX(),t.getCenterY()),n=mxUtils.getRotatedPoint(new mxPoint(t.x,t.y),u,f,e);this.moveSizerTo(this.sizers[0],n.x,n.y);this.sizers[0].setCursor(i[mxUtils.mod(0+o,i.length)]);n.x=c;n.y=t.y;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[1],n.x,n.y);this.sizers[1].setCursor(i[mxUtils.mod(1+o,i.length)]);n.x=s;n.y=t.y;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[2],n.x,n.y);this.sizers[2].setCursor(i[mxUtils.mod(2+o,i.length)]);n.x=t.x;n.y=l;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[3],n.x,n.y);this.sizers[3].setCursor(i[mxUtils.mod(7+o,i.length)]);n.x=s;n.y=l;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[4],n.x,n.y);this.sizers[4].setCursor(i[mxUtils.mod(3+o,i.length)]);n.x=t.x;n.y=h;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[5],n.x,n.y);this.sizers[5].setCursor(i[mxUtils.mod(6+o,i.length)]);n.x=c;n.y=h;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[6],n.x,n.y);this.sizers[6].setCursor(i[mxUtils.mod(5+o,i.length)]);n.x=s;n.y=h;n=mxUtils.getRotatedPoint(n,u,f,e);this.moveSizerTo(this.sizers[7],n.x,n.y);this.sizers[7].setCursor(i[mxUtils.mod(4+o,i.length)]);this.moveSizerTo(this.sizers[8],c+this.state.absoluteOffset.x,l+this.state.absoluteOffset.y)}else this.state.width>=2&&this.state.height>=2?this.moveSizerTo(this.sizers[0],c+this.state.absoluteOffset.x,l+this.state.absoluteOffset.y):this.moveSizerTo(this.sizers[0],this.state.x,this.state.y);if(this.rotationShape!=null){var a=mxUtils.toRadians(this.currentAlpha!=null?this.currentAlpha:this.state.style[mxConstants.STYLE_ROTATION]||"0"),u=Math.cos(a),f=Math.sin(a),e=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),n=mxUtils.getRotatedPoint(this.getRotationHandlePosition(),u,f,e);this.rotationShape.node!=null&&(this.moveSizerTo(this.rotationShape,n.x,n.y),this.rotationShape.node.style.visibility=this.state.view.graph.isEditing()?"hidden":"")}if(this.selectionBorder!=null&&(this.selectionBorder.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0")),this.edgeHandlers!=null)for(r=0;r<this.edgeHandlers.length;r++)this.edgeHandlers[r].redraw();if(this.customHandles!=null)for(r=0;r<this.customHandles.length;r++)p=this.customHandles[r].shape.node.style.display,this.customHandles[r].redraw(),this.customHandles[r].shape.node.style.display=p,this.customHandles[r].shape.node.style.visibility=this.graph.isEditing()?"hidden":"";this.updateParentHighlight()};mxVertexHandler.prototype.getRotationHandlePosition=function(){return new mxPoint(this.bounds.x+this.bounds.width/2,this.bounds.y+this.rotationHandleVSpacing)};mxVertexHandler.prototype.updateParentHighlight=function(){var i,t,n;this.selectionBorder!=null&&(this.parentHighlight!=null?(t=this.graph.model.getParent(this.state.cell),this.graph.model.isVertex(t)?(n=this.graph.view.getState(t),i=this.parentHighlight.bounds,n!=null&&(i.x!=n.x||i.y!=n.y||i.width!=n.width||i.height!=n.height)&&(this.parentHighlight.bounds=n,this.parentHighlight.redraw())):(this.parentHighlight.destroy(),this.parentHighlight=null)):this.parentHighlightEnabled&&(t=this.graph.model.getParent(this.state.cell),this.graph.model.isVertex(t)&&(n=this.graph.view.getState(t),n!=null&&(this.parentHighlight=this.createParentHighlightShape(n),this.parentHighlight.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.parentHighlight.pointerEvents=!1,this.parentHighlight.rotation=Number(n.style[mxConstants.STYLE_ROTATION]||"0"),this.parentHighlight.init(this.graph.getView().getOverlayPane())))))};mxVertexHandler.prototype.drawPreview=function(){this.preview!=null&&(this.preview.bounds=this.bounds,this.preview.node.parentNode==this.graph.container&&(this.preview.bounds.width=Math.max(0,this.preview.bounds.width-1),this.preview.bounds.height=Math.max(0,this.preview.bounds.height-1)),this.preview.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0"),this.preview.redraw());this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw();this.parentHighlight!=null&&this.parentHighlight.redraw()};mxVertexHandler.prototype.destroy=function(){var n;if(this.escapeHandler!=null&&(this.state.view.graph.removeListener(this.escapeHandler),this.escapeHandler=null),this.preview!=null&&(this.preview.destroy(),this.preview=null),this.parentHighlight!=null&&(this.parentHighlight.destroy(),this.parentHighlight=null),this.selectionBorder!=null&&(this.selectionBorder.destroy(),this.selectionBorder=null),this.labelShape=null,this.removeHint(),this.sizers!=null){for(n=0;n<this.sizers.length;n++)this.sizers[n].destroy();this.sizers=null}if(this.customHandles!=null){for(n=0;n<this.customHandles.length;n++)this.customHandles[n].destroy();this.customHandles=null}};mxEdgeHandler.prototype.graph=null;mxEdgeHandler.prototype.state=null;mxEdgeHandler.prototype.marker=null;mxEdgeHandler.prototype.constraintHandler=null;mxEdgeHandler.prototype.error=null;mxEdgeHandler.prototype.shape=null;mxEdgeHandler.prototype.bends=null;mxEdgeHandler.prototype.labelShape=null;mxEdgeHandler.prototype.cloneEnabled=!0;mxEdgeHandler.prototype.addEnabled=!1;mxEdgeHandler.prototype.removeEnabled=!1;mxEdgeHandler.prototype.dblClickRemoveEnabled=!1;mxEdgeHandler.prototype.mergeRemoveEnabled=!1;mxEdgeHandler.prototype.straightRemoveEnabled=!1;mxEdgeHandler.prototype.virtualBendsEnabled=!1;mxEdgeHandler.prototype.virtualBendOpacity=20;mxEdgeHandler.prototype.parentHighlightEnabled=!1;mxEdgeHandler.prototype.preferHtml=!1;mxEdgeHandler.prototype.allowHandleBoundsCheck=!0;mxEdgeHandler.prototype.snapToTerminals=!1;mxEdgeHandler.prototype.handleImage=null;mxEdgeHandler.prototype.tolerance=0;mxEdgeHandler.prototype.outlineConnect=!1;mxEdgeHandler.prototype.manageLabelHandle=!1;mxEdgeHandler.prototype.init=function(){var n,t,r,i;this.graph=this.state.view.graph;this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.points=[];this.abspoints=this.getSelectionPoints(this.state);this.shape=this.createSelectionShape(this.abspoints);this.shape.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.pointerEvents=!1;this.shape.setCursor(mxConstants.CURSOR_MOVABLE_EDGE);mxEvent.redirectMouseEvents(this.shape.node,this.graph,this.state);this.preferHtml=this.state.text!=null&&this.state.text.node.parentNode==this.graph.container;this.preferHtml||(n=this.state.getVisibleTerminalState(!0),n!=null&&(this.preferHtml=n.text!=null&&n.text.node.parentNode==this.graph.container),this.preferHtml||(t=this.state.getVisibleTerminalState(!1),t!=null&&(this.preferHtml=t.text!=null&&t.text.node.parentNode==this.graph.container)));this.parentHighlightEnabled&&(r=this.graph.model.getParent(this.state.cell),this.graph.model.isVertex(r)&&(i=this.graph.view.getState(r),i!=null&&(this.parentHighlight=this.createParentHighlightShape(i),this.parentHighlight.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,this.parentHighlight.pointerEvents=!1,this.parentHighlight.rotation=Number(i.style[mxConstants.STYLE_ROTATION]||"0"),this.parentHighlight.init(this.graph.getView().getOverlayPane()))));(this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells||mxGraphHandler.prototype.maxCells<=0)&&(this.bends=this.createBends(),this.isVirtualBendsEnabled()&&(this.virtualBends=this.createVirtualBends()));this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape=this.createLabelHandleShape();this.initBend(this.labelShape);this.labelShape.setCursor(mxConstants.CURSOR_LABEL_HANDLE);this.customHandles=this.createCustomHandles();this.redraw()};mxEdgeHandler.prototype.createCustomHandles=function(){return null};mxEdgeHandler.prototype.isVirtualBendsEnabled=function(){return this.virtualBendsEnabled&&(this.state.style[mxConstants.STYLE_EDGE]==null||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.NONE||this.state.style[mxConstants.STYLE_NOEDGESTYLE]==1)&&mxUtils.getValue(this.state.style,mxConstants.STYLE_SHAPE,null)!="arrow"};mxEdgeHandler.prototype.isAddPointEvent=function(n){return mxEvent.isShiftDown(n)};mxEdgeHandler.prototype.isRemovePointEvent=function(n){return mxEvent.isShiftDown(n)};mxEdgeHandler.prototype.getSelectionPoints=function(n){return n.absolutePoints};mxEdgeHandler.prototype.createParentHighlightShape=function(n){var t=new mxRectangleShape(n,null,this.getSelectionColor());return t.strokewidth=this.getSelectionStrokeWidth(),t.isDashed=this.isSelectionDashed(),t};mxEdgeHandler.prototype.createSelectionShape=function(){var n=new this.state.shape.constructor;return n.outline=!0,n.apply(this.state),n.isDashed=this.isSelectionDashed(),n.stroke=this.getSelectionColor(),n.isShadow=!1,n};mxEdgeHandler.prototype.getSelectionColor=function(){return mxConstants.EDGE_SELECTION_COLOR};mxEdgeHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.EDGE_SELECTION_STROKEWIDTH};mxEdgeHandler.prototype.isSelectionDashed=function(){return mxConstants.EDGE_SELECTION_DASHED};mxEdgeHandler.prototype.isConnectableCell=function(){return!0};mxEdgeHandler.prototype.getCellAt=function(n,t){return this.outlineConnect?null:this.graph.getCellAt(n,t)};mxEdgeHandler.prototype.createMarker=function(){var t=new mxCellMarker(this.graph),n=this;return t.getCell=function(){var t=mxCellMarker.prototype.getCell.apply(this,arguments),i,r;return(t==n.state.cell||t==null)&&n.currentPoint!=null&&(t=n.graph.getCellAt(n.currentPoint.x,n.currentPoint.y)),t==null||this.graph.isCellConnectable(t)||(i=this.graph.getModel().getParent(t),this.graph.getModel().isVertex(i)&&this.graph.isCellConnectable(i)&&(t=i)),r=n.graph.getModel(),(this.graph.isSwimlane(t)&&n.currentPoint!=null&&this.graph.hitsSwimlaneContent(t,n.currentPoint.x,n.currentPoint.y)||!n.isConnectableCell(t)||t==n.state.cell||t!=null&&!n.graph.connectableEdges&&r.isEdge(t)||r.isAncestor(n.state.cell,t))&&(t=null),this.graph.isCellConnectable(t)||(t=null),t},t.isValidState=function(t){var u=n.graph.getModel(),i=n.graph.view.getTerminalPort(t,n.graph.view.getState(u.getTerminal(n.state.cell,!n.isSource)),!n.isSource),r=i!=null?i.cell:null,f=n.isSource?t.cell:r,e=n.isSource?r:t.cell;return n.error=n.validateConnection(f,e),n.error==null},t};mxEdgeHandler.prototype.validateConnection=function(n,t){return this.graph.getEdgeValidationError(this.state.cell,n,t)};mxEdgeHandler.prototype.createBends=function(){for(var r=this.state.cell,i=[],n=0;n<this.abspoints.length;n++)if(this.isHandleVisible(n)){var u=n==0,f=n==this.abspoints.length-1,t=u||f;(t||this.graph.isCellBendable(r))&&mxUtils.bind(this,function(r){var u=this.createHandleShape(r);this.initBend(u,mxUtils.bind(this,mxUtils.bind(this,function(){this.dblClickRemoveEnabled&&this.removePoint(this.state,r)})));this.isHandleEnabled(n)&&u.setCursor(t?mxConstants.CURSOR_TERMINAL_HANDLE:mxConstants.CURSOR_BEND_HANDLE);i.push(u);t||(this.points.push(new mxPoint(0,0)),u.node.style.visibility="hidden")})(n)}return i};mxEdgeHandler.prototype.createVirtualBends=function(){var i=this.state.cell,r=this.abspoints[0],t=[],n;if(this.graph.isCellBendable(i))for(n=1;n<this.abspoints.length;n++)mxUtils.bind(this,function(n){this.initBend(n);n.setCursor(mxConstants.CURSOR_VIRTUAL_BEND_HANDLE);t.push(n)})(this.createHandleShape());return t};mxEdgeHandler.prototype.isHandleEnabled=function(){return!0};mxEdgeHandler.prototype.isHandleVisible=function(n){var i=this.state.getVisibleTerminalState(!0),r=this.state.getVisibleTerminalState(!1),t=this.graph.getCellGeometry(this.state.cell),u=t!=null?this.graph.view.getEdgeStyle(this.state,t.points,i,r):null;return u!=mxEdgeStyle.EntityRelation||n==0||n==this.abspoints.length-1};mxEdgeHandler.prototype.createHandleShape=function(){var t,n;return this.handleImage!=null?(t=new mxImageShape(new mxRectangle(0,0,this.handleImage.width,this.handleImage.height),this.handleImage.src),t.preserveImageAspect=!1,t):(n=mxConstants.HANDLE_SIZE,this.preferHtml&&(n-=1),new mxRectangleShape(new mxRectangle(0,0,n,n),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR))};mxEdgeHandler.prototype.createLabelHandleShape=function(){var n,t;return this.labelHandleImage!=null?(n=new mxImageShape(new mxRectangle(0,0,this.labelHandleImage.width,this.labelHandleImage.height),this.labelHandleImage.src),n.preserveImageAspect=!1,n):(t=mxConstants.LABEL_HANDLE_SIZE,new mxRectangleShape(new mxRectangle(0,0,t,t),mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR))};mxEdgeHandler.prototype.initBend=function(n,t){this.preferHtml?(n.dialect=mxConstants.DIALECT_STRICTHTML,n.init(this.graph.container)):(n.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_MIXEDHTML:mxConstants.DIALECT_SVG,n.init(this.graph.getView().getOverlayPane()));mxEvent.redirectMouseEvents(n.node,this.graph,this.state,null,null,null,t);(mxClient.IS_QUIRKS||document.documentMode==8)&&mxEvent.addListener(n.node,"dragstart",function(n){return mxEvent.consume(n),!1});mxClient.IS_TOUCH&&n.node.setAttribute("pointer-events","none")};mxEdgeHandler.prototype.getHandleForEvent=function(n){function u(t){if(t!=null&&t.node.style.display!="none"&&t.node.style.visibility!="hidden"&&(n.isSource(t)||e!=null&&mxUtils.intersects(t.bounds,e))){var i=n.getGraphX()-t.bounds.getCenterX(),r=n.getGraphY()-t.bounds.getCenterY(),u=i*i+r*r;if(f==null||u<=f)return f=u,!0}return!1}var i=mxEvent.isMouseEvent(n.getEvent())?1:this.tolerance,e=this.allowHandleBoundsCheck&&(mxClient.IS_IE||i>0)?new mxRectangle(n.getGraphX()-i,n.getGraphY()-i,2*i,2*i):null,f=null,r=null,t;if(this.customHandles!=null&&this.isCustomHandleEvent(n))for(t=this.customHandles.length-1;t>=0;t--)if(u(this.customHandles[t].shape))return mxEvent.CUSTOM_HANDLE-t;if((n.isSource(this.state.text)||u(this.labelShape))&&(r=mxEvent.LABEL_HANDLE),this.bends!=null)for(t=0;t<this.bends.length;t++)u(this.bends[t])&&(r=t);if(this.virtualBends!=null&&this.isAddVirtualBendEvent(n))for(t=0;t<this.virtualBends.length;t++)u(this.virtualBends[t])&&(r=mxEvent.VIRTUAL_HANDLE-t);return r};mxEdgeHandler.prototype.isAddVirtualBendEvent=function(){return!0};mxEdgeHandler.prototype.isCustomHandleEvent=function(){return!0};mxEdgeHandler.prototype.mouseDown=function(n,t){var i=this.getHandleForEvent(t),r;this.bends!=null&&this.bends[i]!=null&&(r=this.bends[i].bounds,this.snapPoint=new mxPoint(r.getCenterX(),r.getCenterY()));this.addEnabled&&i==null&&this.isAddPointEvent(t.getEvent())?(this.addPoint(this.state,t.getEvent()),t.consume()):i!=null&&!t.isConsumed()&&this.graph.isEnabled()&&(this.removeEnabled&&this.isRemovePointEvent(t.getEvent())?this.removePoint(this.state,i):(i!=mxEvent.LABEL_HANDLE||this.graph.isLabelMovable(t.getCell()))&&(i<=mxEvent.VIRTUAL_HANDLE&&mxUtils.setOpacity(this.virtualBends[mxEvent.VIRTUAL_HANDLE-i].node,100),this.start(t.getX(),t.getY(),i)),t.consume())};mxEdgeHandler.prototype.start=function(n,t,i){var u,f,r;if(this.startX=n,this.startY=t,this.isSource=this.bends==null?!1:i==0,this.isTarget=this.bends==null?!1:i==this.bends.length-1,this.isLabel=i==mxEvent.LABEL_HANDLE,this.isSource||this.isTarget?(u=this.state.cell,f=this.graph.model.getTerminal(u,this.isSource),(f==null&&this.graph.isTerminalPointMovable(u,this.isSource)||f!=null&&this.graph.isCellDisconnectable(u,f,this.isSource))&&(this.index=i)):this.index=i,this.index<=mxEvent.CUSTOM_HANDLE&&this.index>mxEvent.VIRTUAL_HANDLE&&this.customHandles!=null)for(r=0;r<this.customHandles.length;r++)r!=mxEvent.CUSTOM_HANDLE-this.index&&this.customHandles[r].setVisible(!1)};mxEdgeHandler.prototype.clonePreviewState=function(){return this.state.clone()};mxEdgeHandler.prototype.getSnapToTerminalTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2};mxEdgeHandler.prototype.updateHint=function(){};mxEdgeHandler.prototype.removeHint=function(){};mxEdgeHandler.prototype.roundLength=function(n){return Math.round(n)};mxEdgeHandler.prototype.isSnapToTerminalsEvent=function(n){return this.snapToTerminals&&!mxEvent.isAltDown(n.getEvent())};mxEdgeHandler.prototype.getPointForEvent=function(n){var u=this.graph.getView(),i=u.scale,t=new mxPoint(this.roundLength(n.getGraphX()/i)*i,this.roundLength(n.getGraphY()/i)*i),e=this.getSnapToTerminalTolerance(),o=!1,s=!1,f,r;if(e>0&&this.isSnapToTerminalsEvent(n)){function n(n){var i,r;n!=null&&(i=n.x,Math.abs(t.x-i)<e&&(t.x=i,o=!0),r=n.y,Math.abs(t.y-r)<e&&(t.y=r,s=!0))}function i(t){t!=null&&n.call(this,new mxPoint(u.getRoutingCenterX(t),u.getRoutingCenterY(t)))}if(i.call(this,this.state.getVisibleTerminalState(!0)),i.call(this,this.state.getVisibleTerminalState(!1)),this.state.absolutePoints!=null)for(f=0;f<this.state.absolutePoints.length;f++)n.call(this,this.state.absolutePoints[f])}return this.graph.isGridEnabledEvent(n.getEvent())&&(r=u.translate,o||(t.x=(this.graph.snap(t.x/i-r.x)+r.x)*i),s||(t.y=(this.graph.snap(t.y/i-r.y)+r.y)*i)),t};mxEdgeHandler.prototype.getPreviewTerminalState=function(n){var t;if(this.constraintHandler.update(n,this.isSource,!0,n.isSource(this.marker.highlight.shape)?null:this.currentPoint),this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null){this.marker.highlight!=null&&this.marker.highlight.state!=null&&this.marker.highlight.state.cell==this.constraintHandler.currentFocus.cell?this.marker.highlight.shape.stroke!="transparent"&&(this.marker.highlight.shape.stroke="transparent",this.marker.highlight.repaint()):this.marker.markCell(this.constraintHandler.currentFocus.cell,"transparent");var u=this.graph.getModel(),i=this.graph.view.getTerminalPort(this.state,this.graph.view.getState(u.getTerminal(this.state.cell,!this.isSource)),!this.isSource),r=i!=null?i.cell:null,f=this.isSource?this.constraintHandler.currentFocus.cell:r,e=this.isSource?r:this.constraintHandler.currentFocus.cell;return this.error=this.validateConnection(f,e),t=null,this.error==null?t=this.constraintHandler.currentFocus:this.constraintHandler.reset(),t}return this.graph.isIgnoreTerminalEvent(n.getEvent())?(this.marker.reset(),null):(this.marker.process(n),this.marker.getValidState())};mxEdgeHandler.prototype.getPreviewPoints=function(n,t){var l=this.graph.getCellGeometry(this.state.cell),i=l.points!=null?l.points.slice():null,h=new mxPoint(n.x,n.y),e=null,s,c,a,r,u,f,o;if(this.isSource||this.isTarget)this.graph.resetEdgesOnConnect&&(i=null);else if(this.convertPoint(h,!1),i==null)i=[h];else{if(this.index<=mxEvent.VIRTUAL_HANDLE&&i.splice(mxEvent.VIRTUAL_HANDLE-this.index,0,h),!this.isSource&&!this.isTarget){for(s=0;s<this.bends.length;s++)s!=this.index&&(c=this.bends[s],c!=null&&mxUtils.contains(c.bounds,n.x,n.y)&&(this.index<=mxEvent.VIRTUAL_HANDLE?i.splice(mxEvent.VIRTUAL_HANDLE-this.index,1):i.splice(this.index-1,1),e=i));if(e==null&&this.straightRemoveEnabled&&(t==null||!mxEvent.isAltDown(t.getEvent()))){a=this.graph.tolerance*this.graph.tolerance;r=this.state.absolutePoints.slice();r[this.index]=n;u=this.state.getVisibleTerminalState(!0);u!=null&&(o=this.graph.getConnectionConstraint(this.state,u,!0),(o==null||this.graph.getConnectionPoint(u,o)==null)&&(r[0]=new mxPoint(u.view.getRoutingCenterX(u),u.view.getRoutingCenterY(u))));f=this.state.getVisibleTerminalState(!1);f!=null&&(o=this.graph.getConnectionConstraint(this.state,f,!1),(o==null||this.graph.getConnectionPoint(f,o)==null)&&(r[r.length-1]=new mxPoint(f.view.getRoutingCenterX(f),f.view.getRoutingCenterY(f))));function t(n,t){n>0&&n<r.length-1&&mxUtils.ptSegDistSq(r[n-1].x,r[n-1].y,r[n+1].x,r[n+1].y,t.x,t.y)<a&&(i.splice(n-1,1),e=i)}t(this.index,n)}}e==null&&this.index>mxEvent.VIRTUAL_HANDLE&&(i[this.index-1]=h)}return e!=null?e:i};mxEdgeHandler.prototype.isOutlineConnectEvent=function(n){var i=mxUtils.getOffset(this.graph.container),r=n.getEvent(),u=mxEvent.getClientX(r),f=mxEvent.getClientY(r),t=document.documentElement,s=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),h=(window.pageYOffset||t.scrollTop)-(t.clientTop||0),e=this.currentPoint.x-this.graph.container.scrollLeft+i.x-s,o=this.currentPoint.y-this.graph.container.scrollTop+i.y-h;return this.outlineConnect&&!mxEvent.isShiftDown(n.getEvent())&&(n.isSource(this.marker.highlight.shape)||mxEvent.isAltDown(n.getEvent())&&n.getState()!=null||this.marker.highlight.isHighlightAt(u,f)||(e!=u||o!=f)&&n.getState()==null&&this.marker.highlight.isHighlightAt(e,o))};mxEdgeHandler.prototype.updatePreviewState=function(n,t,i,r,u){var e=this.isSource?i:this.state.getVisibleTerminalState(!0),o=this.isTarget?i:this.state.getVisibleTerminalState(!1),h=this.graph.getConnectionConstraint(n,e,!0),c=this.graph.getConnectionConstraint(n,o,!1),f=this.constraintHandler.currentConstraint,s;f==null&&u&&(i!=null?(r.isSource(this.marker.highlight.shape)&&(t=new mxPoint(r.getGraphX(),r.getGraphY())),f=this.graph.getOutlineConstraint(t,i,r),this.constraintHandler.setFocus(r,i,this.isSource),this.constraintHandler.currentConstraint=f,this.constraintHandler.currentPoint=t):f=new mxConnectionConstraint);this.outlineConnect&&this.marker.highlight!=null&&this.marker.highlight.shape!=null&&(s=this.graph.view.scale,this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null?(this.marker.highlight.shape.stroke=u?mxConstants.OUTLINE_HIGHLIGHT_COLOR:"transparent",this.marker.highlight.shape.strokewidth=mxConstants.OUTLINE_HIGHLIGHT_STROKEWIDTH/s/s,this.marker.highlight.repaint()):this.marker.hasValidState()&&(this.marker.highlight.shape.stroke=this.marker.getValidState()==r.getState()?mxConstants.DEFAULT_VALID_COLOR:"transparent",this.marker.highlight.shape.strokewidth=mxConstants.HIGHLIGHT_STROKEWIDTH/s/s,this.marker.highlight.repaint()));this.isSource?h=f:this.isTarget&&(c=f);(this.isSource||this.isTarget)&&(f!=null&&f.point!=null?(n.style[this.isSource?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X]=f.point.x,n.style[this.isSource?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y]=f.point.y):(delete n.style[this.isSource?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X],delete n.style[this.isSource?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y]));n.setVisibleTerminalState(e,!0);n.setVisibleTerminalState(o,!1);this.isSource&&e==null||n.view.updateFixedTerminalPoint(n,e,!0,h);this.isTarget&&o==null||n.view.updateFixedTerminalPoint(n,o,!1,c);(this.isSource||this.isTarget)&&i==null&&(n.setAbsoluteTerminalPoint(t,this.isSource),this.marker.getMarkedState()==null&&(this.error=this.graph.allowDanglingEdges?null:""));n.view.updatePoints(n,this.points,e,o);n.view.updateFloatingTerminalPoints(n,e,o)};mxEdgeHandler.prototype.mouseMove=function(n,t){var i,r,u,f;this.index!=null&&this.marker!=null?(this.currentPoint=this.getPointForEvent(t),this.error=null,!this.graph.isIgnoreTerminalEvent(t.getEvent())&&mxEvent.isShiftDown(t.getEvent())&&this.snapPoint!=null&&(Math.abs(this.snapPoint.x-this.currentPoint.x)<Math.abs(this.snapPoint.y-this.currentPoint.y)?this.currentPoint.x=this.snapPoint.x:this.currentPoint.y=this.snapPoint.y),this.index<=mxEvent.CUSTOM_HANDLE&&this.index>mxEvent.VIRTUAL_HANDLE?this.customHandles!=null&&this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].processEvent(t):this.isLabel?(this.label.x=this.currentPoint.x,this.label.y=this.currentPoint.y):(this.points=this.getPreviewPoints(this.currentPoint,t),i=this.isSource||this.isTarget?this.getPreviewTerminalState(t):null,this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentPoint!=null?this.currentPoint=this.constraintHandler.currentPoint.clone():this.outlineConnect&&(r=this.isSource||this.isTarget?this.isOutlineConnectEvent(t):!1,r?i=this.marker.highlight.state:i!=null&&i!=t.getState()&&this.marker.highlight.shape!=null&&(this.marker.highlight.shape.stroke="transparent",this.marker.highlight.repaint(),i=null)),u=this.clonePreviewState(this.currentPoint,i!=null?i.cell:null),this.updatePreviewState(u,this.currentPoint,i,t,r),f=this.error==null?this.marker.validColor:this.marker.invalidColor,this.setPreviewColor(f),this.abspoints=u.absolutePoints,this.active=!0),this.updateHint(t,this.currentPoint),this.drawPreview(),mxEvent.consume(t.getEvent()),t.consume()):mxClient.IS_IE&&this.getHandleForEvent(t)!=null&&t.consume(!1)};mxEdgeHandler.prototype.mouseUp=function(n,t){var i,e,r,h,o,u,c,f,s;if(this.index!=null&&this.marker!=null){if(i=this.state.cell,t.getX()!=this.startX||t.getY()!=this.startY)if(u=!this.graph.isIgnoreTerminalEvent(t.getEvent())&&this.graph.isCloneEvent(t.getEvent())&&this.cloneEnabled&&this.graph.isCellsCloneable(),this.error!=null)this.error.length>0&&this.graph.validationAlert(this.error);else if(this.index<=mxEvent.CUSTOM_HANDLE&&this.index>mxEvent.VIRTUAL_HANDLE){if(this.customHandles!=null){r=this.graph.getModel();r.beginUpdate();try{this.customHandles[mxEvent.CUSTOM_HANDLE-this.index].execute()}finally{r.endUpdate()}}}else if(this.isLabel)this.moveLabel(this.state,this.label.x,this.label.y);else if(this.isSource||this.isTarget)if(e=null,this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null&&(e=this.constraintHandler.currentFocus.cell),e==null&&this.marker.hasValidState()&&this.marker.highlight!=null&&this.marker.highlight.shape!=null&&this.marker.highlight.shape.stroke!="transparent"&&this.marker.highlight.shape.stroke!="white"&&(e=this.marker.validState.cell),e!=null){r=this.graph.getModel();h=r.getParent(i);r.beginUpdate();try{u&&(o=r.getGeometry(i),u=this.graph.cloneCells([i])[0],r.add(h,u,r.getChildCount(h)),o!=null&&(o=o.clone(),r.setGeometry(u,o)),c=r.getTerminal(i,!this.isSource),this.graph.connectCell(u,c,!this.isSource),i=u);i=this.connect(i,e,this.isSource,u,t)}finally{r.endUpdate()}}else this.graph.isAllowDanglingEdges()&&(f=this.abspoints[this.isSource?0:this.abspoints.length-1],f.x=this.roundLength(f.x/this.graph.view.scale-this.graph.view.translate.x),f.y=this.roundLength(f.y/this.graph.view.scale-this.graph.view.translate.y),s=this.graph.getView().getState(this.graph.getModel().getParent(i)),s!=null&&(f.x-=s.origin.x,f.y-=s.origin.y),f.x-=this.graph.panDx/this.graph.view.scale,f.y-=this.graph.panDy/this.graph.view.scale,i=this.changeTerminalPoint(i,f,this.isSource,u));else this.active?i=this.changePoints(i,this.points,u):(this.graph.getView().invalidate(this.state.cell),this.graph.getView().validate(this.state.cell));this.marker!=null&&(this.reset(),i!=this.state.cell&&this.graph.setSelectionCell(i));t.consume()}};mxEdgeHandler.prototype.reset=function(){var n;if(this.active&&this.refresh(),this.error=null,this.index=null,this.label=null,this.points=null,this.snapPoint=null,this.isLabel=!1,this.isSource=!1,this.isTarget=!1,this.active=!1,this.livePreview&&this.sizers!=null)for(n=0;n<this.sizers.length;n++)this.sizers[n]!=null&&(this.sizers[n].node.style.display="");if(this.marker!=null&&this.marker.reset(),this.constraintHandler!=null&&this.constraintHandler.reset(),this.customHandles!=null)for(n=0;n<this.customHandles.length;n++)this.customHandles[n].reset();this.setPreviewColor(mxConstants.EDGE_SELECTION_COLOR);this.removeHint();this.redraw()};mxEdgeHandler.prototype.setPreviewColor=function(n){this.shape!=null&&(this.shape.stroke=n)};mxEdgeHandler.prototype.convertPoint=function(n,t){var r=this.graph.getView().getScale(),u=this.graph.getView().getTranslate(),i;return t&&(n.x=this.graph.snap(n.x),n.y=this.graph.snap(n.y)),n.x=Math.round(n.x/r-u.x),n.y=Math.round(n.y/r-u.y),i=this.graph.getView().getState(this.graph.getModel().getParent(this.state.cell)),i!=null&&(n.x-=i.origin.x,n.y-=i.origin.y),n};mxEdgeHandler.prototype.moveLabel=function(n,t,i){var h=this.graph.getModel(),r=h.getGeometry(n.cell),f,u,c,l;if(r!=null){if(f=this.graph.getView().scale,r=r.clone(),r.relative)u=this.graph.getView().getRelativePoint(n,t,i),r.x=Math.round(u.x*1e4)/1e4,r.y=Math.round(u.y),r.offset=new mxPoint(0,0),u=this.graph.view.getPoint(n,r),r.offset=new mxPoint(Math.round((t-u.x)/f),Math.round((i-u.y)/f));else{var o=n.absolutePoints,e=o[0],s=o[o.length-1];e!=null&&s!=null&&(c=e.x+(s.x-e.x)/2,l=e.y+(s.y-e.y)/2,r.offset=new mxPoint(Math.round((t-c)/f),Math.round((i-l)/f)),r.x=0,r.y=0)}h.setGeometry(n.cell,r)}};mxEdgeHandler.prototype.connect=function(n,t,i){var u=this.graph.getModel(),f=u.getParent(n),r;u.beginUpdate();try{r=this.constraintHandler.currentConstraint;r==null&&(r=new mxConnectionConstraint);this.graph.connectCell(n,t,i,r)}finally{u.endUpdate()}return n};mxEdgeHandler.prototype.changeTerminalPoint=function(n,t,i,r){var u=this.graph.getModel(),e,o,f;u.beginUpdate();try{r&&(e=u.getParent(n),o=u.getTerminal(n,!i),n=this.graph.cloneCells([n])[0],u.add(e,n,u.getChildCount(e)),u.setTerminal(n,o,!i));f=u.getGeometry(n);f!=null&&(f=f.clone(),f.setTerminalPoint(t,i),u.setGeometry(n,f),this.graph.connectCell(n,null,i,new mxConnectionConstraint))}finally{u.endUpdate()}return n};mxEdgeHandler.prototype.changePoints=function(n,t,i){var r=this.graph.getModel(),u;r.beginUpdate();try{if(i){var f=r.getParent(n),e=r.getTerminal(n,!0),o=r.getTerminal(n,!1);n=this.graph.cloneCells([n])[0];r.add(f,n,r.getChildCount(f));r.setTerminal(n,e,!0);r.setTerminal(n,o,!1)}u=r.getGeometry(n);u!=null&&(u=u.clone(),u.points=t,r.setGeometry(n,u))}finally{r.endUpdate()}return n};mxEdgeHandler.prototype.addPoint=function(n,t){var i=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(t),mxEvent.getClientY(t)),r=this.graph.isGridEnabledEvent(t);this.convertPoint(i,r);this.addPointAt(n,i.x,i.y);mxEvent.consume(t)};mxEdgeHandler.prototype.addPointAt=function(n,t,i){var r=this.graph.getCellGeometry(n.cell),u=new mxPoint(t,i),o,c;if(r!=null){r=r.clone();var s=this.graph.view.translate,f=this.graph.view.scale,e=new mxPoint(s.x*f,s.y*f),h=this.graph.model.getParent(this.state.cell);this.graph.model.isVertex(h)&&(o=this.graph.view.getState(h),e=new mxPoint(o.x,o.y));c=mxUtils.findNearestSegment(n,u.x*f+e.x,u.y*f+e.y);r.points==null?r.points=[u]:r.points.splice(c,0,u);this.graph.getModel().setGeometry(n.cell,r);this.refresh();this.redraw()}};mxEdgeHandler.prototype.removePoint=function(n,t){if(t>0&&t<this.abspoints.length-1){var i=this.graph.getCellGeometry(this.state.cell);i!=null&&i.points!=null&&(i=i.clone(),i.points.splice(t-1,1),this.graph.getModel().setGeometry(n.cell,i),this.refresh(),this.redraw())}};mxEdgeHandler.prototype.getHandleFillColor=function(n){var i=n==0,r=this.state.cell,t=this.graph.getModel().getTerminal(r,i),u=mxConstants.HANDLE_FILLCOLOR;return(t==null||this.graph.isCellDisconnectable(r,t,i))&&(t!=null||this.graph.isTerminalPointMovable(r,i))?t!=null&&this.graph.isCellDisconnectable(r,t,i)&&(u=mxConstants.CONNECT_HANDLE_FILLCOLOR):u=mxConstants.LOCKED_HANDLE_FILLCOLOR,u};mxEdgeHandler.prototype.redraw=function(){var i,t,n;if(this.abspoints=this.state.absolutePoints.slice(),this.redrawHandles(),i=this.graph.getModel().getGeometry(this.state.cell),t=i.points,this.bends!=null&&this.bends.length>0&&t!=null)for(this.points==null&&(this.points=[]),n=1;n<this.bends.length-1;n++)this.bends[n]!=null&&this.abspoints[n]!=null&&(this.points[n-1]=t[n-1]);this.drawPreview()};mxEdgeHandler.prototype.redrawHandles=function(){var s=this.state.cell,n=this.labelShape.bounds,u,r,t;if(this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y),this.labelShape.bounds=new mxRectangle(Math.round(this.label.x-n.width/2),Math.round(this.label.y-n.height/2),n.width,n.height),u=this.graph.getLabel(s),this.labelShape.visible=u!=null&&u.length>0&&this.graph.isLabelMovable(s),this.bends!=null&&this.bends.length>0){var h=this.abspoints.length-1,f=this.abspoints[0],c=f.x,l=f.y;n=this.bends[0].bounds;this.bends[0].bounds=new mxRectangle(Math.floor(c-n.width/2),Math.floor(l-n.height/2),n.width,n.height);this.bends[0].fill=this.getHandleFillColor(0);this.bends[0].redraw();this.manageLabelHandle&&this.checkLabelHandle(this.bends[0].bounds);var e=this.abspoints[h],a=e.x,v=e.y,i=this.bends.length-1;n=this.bends[i].bounds;this.bends[i].bounds=new mxRectangle(Math.floor(a-n.width/2),Math.floor(v-n.height/2),n.width,n.height);this.bends[i].fill=this.getHandleFillColor(i);this.bends[i].redraw();this.manageLabelHandle&&this.checkLabelHandle(this.bends[i].bounds);this.redrawInnerBends(f,e)}if(this.abspoints!=null&&this.virtualBends!=null&&this.virtualBends.length>0)for(r=this.abspoints[0],t=0;t<this.virtualBends.length;t++)if(this.virtualBends[t]!=null&&this.abspoints[t+1]!=null){var o=this.abspoints[t+1],n=this.virtualBends[t],y=r.x+(o.x-r.x)/2,p=r.y+(o.y-r.y)/2;n.bounds=new mxRectangle(Math.floor(y-n.bounds.width/2),Math.floor(p-n.bounds.height/2),n.bounds.width,n.bounds.height);n.redraw();mxUtils.setOpacity(n.node,this.virtualBendOpacity);r=o;this.manageLabelHandle&&this.checkLabelHandle(n.bounds)}if(this.labelShape!=null&&this.labelShape.redraw(),this.customHandles!=null)for(t=0;t<this.customHandles.length;t++)this.customHandles[t].redraw()};mxEdgeHandler.prototype.setHandlesVisible=function(n){var t;if(this.bends!=null)for(t=0;t<this.bends.length;t++)this.bends[t].node.style.display=n?"":"none";if(this.virtualBends!=null)for(t=0;t<this.virtualBends.length;t++)this.virtualBends[t].node.style.display=n?"":"none";if(this.labelShape!=null&&(this.labelShape.node.style.display=n?"":"none"),this.customHandles!=null)for(t=0;t<this.customHandles.length;t++)this.customHandles[t].setVisible(n)};mxEdgeHandler.prototype.redrawInnerBends=function(){for(var n=1;n<this.bends.length-1;n++)if(this.bends[n]!=null)if(this.abspoints[n]!=null){var i=this.abspoints[n].x,r=this.abspoints[n].y,t=this.bends[n].bounds;this.bends[n].node.style.visibility="visible";this.bends[n].bounds=new mxRectangle(Math.round(i-t.width/2),Math.round(r-t.height/2),t.width,t.height);this.manageLabelHandle?this.checkLabelHandle(this.bends[n].bounds):this.handleImage==null&&this.labelShape.visible&&mxUtils.intersects(this.bends[n].bounds,this.labelShape.bounds)&&(w=mxConstants.HANDLE_SIZE+3,h=mxConstants.HANDLE_SIZE+3,this.bends[n].bounds=new mxRectangle(Math.round(i-w/2),Math.round(r-h/2),w,h));this.bends[n].redraw()}else this.bends[n].destroy(),this.bends[n]=null};mxEdgeHandler.prototype.checkLabelHandle=function(n){if(this.labelShape!=null){var t=this.labelShape.bounds;mxUtils.intersects(n,t)&&(t.y=n.getCenterY()<t.getCenterY()?n.y+n.height:n.y-t.height)}};mxEdgeHandler.prototype.drawPreview=function(){if(this.isLabel){var n=this.labelShape.bounds,t=new mxRectangle(Math.round(this.label.x-n.width/2),Math.round(this.label.y-n.height/2),n.width,n.height);this.labelShape.bounds=t;this.labelShape.redraw()}else this.shape!=null&&(this.shape.apply(this.state),this.shape.points=this.abspoints,this.shape.scale=this.state.view.scale,this.shape.isDashed=this.isSelectionDashed(),this.shape.stroke=this.getSelectionColor(),this.shape.strokewidth=this.getSelectionStrokeWidth()/this.shape.scale/this.shape.scale,this.shape.isShadow=!1,this.shape.redraw());this.parentHighlight!=null&&this.parentHighlight.redraw()};mxEdgeHandler.prototype.refresh=function(){this.abspoints=this.getSelectionPoints(this.state);this.points=[];this.shape!=null&&(this.shape.points=this.abspoints);this.bends!=null&&(this.destroyBends(this.bends),this.bends=this.createBends());this.virtualBends!=null&&(this.destroyBends(this.virtualBends),this.virtualBends=this.createVirtualBends());this.customHandles!=null&&(this.destroyBends(this.customHandles),this.customHandles=this.createCustomHandles());this.labelShape!=null&&this.labelShape.node!=null&&this.labelShape.node.parentNode!=null&&this.labelShape.node.parentNode.appendChild(this.labelShape.node)};mxEdgeHandler.prototype.destroyBends=function(n){if(n!=null)for(var t=0;t<n.length;t++)n[t]!=null&&n[t].destroy()};mxEdgeHandler.prototype.destroy=function(){this.escapeHandler!=null&&(this.state.view.graph.removeListener(this.escapeHandler),this.escapeHandler=null);this.marker!=null&&(this.marker.destroy(),this.marker=null);this.shape!=null&&(this.shape.destroy(),this.shape=null);this.parentHighlight!=null&&(this.parentHighlight.destroy(),this.parentHighlight=null);this.labelShape!=null&&(this.labelShape.destroy(),this.labelShape=null);this.constraintHandler!=null&&(this.constraintHandler.destroy(),this.constraintHandler=null);this.destroyBends(this.virtualBends);this.virtualBends=null;this.destroyBends(this.customHandles);this.customHandles=null;this.destroyBends(this.bends);this.bends=null;this.removeHint()};mxUtils.extend(mxElbowEdgeHandler,mxEdgeHandler);mxElbowEdgeHandler.prototype.flipEnabled=!0;mxElbowEdgeHandler.prototype.doubleClickOrientationResource=mxClient.language!="none"?"doubleClickOrientation":"";mxElbowEdgeHandler.prototype.createBends=function(){var t=[],n=this.createHandleShape(0);return this.initBend(n),n.setCursor(mxConstants.CURSOR_TERMINAL_HANDLE),t.push(n),t.push(this.createVirtualBend(mxUtils.bind(this,function(n){!mxEvent.isConsumed(n)&&this.flipEnabled&&(this.graph.flipEdge(this.state.cell,n),mxEvent.consume(n))}))),this.points.push(new mxPoint(0,0)),n=this.createHandleShape(2),this.initBend(n),n.setCursor(mxConstants.CURSOR_TERMINAL_HANDLE),t.push(n),t};mxElbowEdgeHandler.prototype.createVirtualBend=function(n){var t=this.createHandleShape();return this.initBend(t,n),t.setCursor(this.getCursorForBend()),this.graph.isCellBendable(this.state.cell)||(t.node.style.display="none"),t};mxElbowEdgeHandler.prototype.getCursorForBend=function(){return this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_TOPTOBOTTOM||(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_ELBOW)&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL?"row-resize":"col-resize"};mxElbowEdgeHandler.prototype.getTooltipForNode=function(n){var t=null;return this.bends!=null&&this.bends[1]!=null&&(n==this.bends[1].node||n.parentNode==this.bends[1].node)&&(t=this.doubleClickOrientationResource,t=mxResources.get(t)||t),t};mxElbowEdgeHandler.prototype.convertPoint=function(n,t){var i=this.graph.getView().getScale(),r=this.graph.getView().getTranslate(),u=this.state.origin;return t&&(n.x=this.graph.snap(n.x),n.y=this.graph.snap(n.y)),n.x=Math.round(n.x/i-r.x-u.x),n.y=Math.round(n.y/i-r.y-u.y),n};mxElbowEdgeHandler.prototype.redrawInnerBends=function(n,t){var o=this.graph.getModel().getGeometry(this.state.cell),r=this.state.absolutePoints,i=null;r.length>1?(n=r[1],t=r[r.length-2]):o.points!=null&&o.points.length>0&&(i=r[0]);i=i==null?new mxPoint(n.x+(t.x-n.x)/2,n.y+(t.y-n.y)/2):new mxPoint(this.graph.getView().scale*(i.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(i.y+this.graph.getView().translate.y+this.state.origin.y));var s=this.bends[1].bounds,u=s.width,f=s.height,e=new mxRectangle(Math.round(i.x-u/2),Math.round(i.y-f/2),u,f);this.manageLabelHandle?this.checkLabelHandle(e):this.handleImage==null&&this.labelShape.visible&&mxUtils.intersects(e,this.labelShape.bounds)&&(u=mxConstants.HANDLE_SIZE+3,f=mxConstants.HANDLE_SIZE+3,e=new mxRectangle(Math.floor(i.x-u/2),Math.floor(i.y-f/2),u,f));this.bends[1].bounds=e;this.bends[1].redraw();this.manageLabelHandle&&this.checkLabelHandle(this.bends[1].bounds)};mxUtils.extend(mxEdgeSegmentHandler,mxElbowEdgeHandler);mxEdgeSegmentHandler.prototype.getCurrentPoints=function(){var n=this.state.absolutePoints,t,i;return n!=null&&(n.length==2||n.length==3&&(n[0].x==n[1].x&&n[1].x==n[2].x||n[0].y==n[1].y&&n[1].y==n[2].y))&&(t=n[0].x+(n[n.length-1].x-n[0].x)/2,i=n[0].y+(n[n.length-1].y-n[0].y)/2,n=[n[0],new mxPoint(t,i),new mxPoint(t,i),n[n.length-1]]),n};mxEdgeSegmentHandler.prototype.getPreviewPoints=function(n){var f,r,t,u,i;if(this.isSource||this.isTarget)return mxElbowEdgeHandler.prototype.getPreviewPoints.apply(this,arguments);for(f=this.getCurrentPoints(),r=this.convertPoint(f[0].clone(),!1),n=this.convertPoint(n.clone(),!1),t=[],u=1;u<f.length;u++)i=this.convertPoint(f[u].clone(),!1),u==this.index&&(Math.round(r.x-i.x)==0&&(r.x=n.x,i.x=n.x),Math.round(r.y-i.y)==0&&(r.y=n.y,i.y=n.y)),u<f.length-1&&t.push(i),r=i;if(t.length==1){var e=this.state.getVisibleTerminalState(!0),o=this.state.getVisibleTerminalState(!1),s=this.state.view.getScale(),h=this.state.view.getTranslate(),c=t[0].x*s+h.x,l=t[0].y*s+h.y;(e!=null&&mxUtils.contains(e,c,l)||o!=null&&mxUtils.contains(o,c,l))&&(t=[n,n])}return t};mxEdgeSegmentHandler.prototype.updatePreviewState=function(n,t){var s,h,v,y,r;if(mxEdgeHandler.prototype.updatePreviewState.apply(this,arguments),!this.isSource&&!this.isTarget){t=this.convertPoint(t.clone(),!1);var i=n.absolutePoints,a=i[0],u=i[1],o=[];for(s=2;s<i.length;s++)h=i[s],(Math.round(a.x-u.x)!=0||Math.round(u.x-h.x)!=0)&&(Math.round(a.y-u.y)!=0||Math.round(u.y-h.y)!=0)&&o.push(this.convertPoint(u.clone(),!1)),a=u,u=h;var f=this.state.getVisibleTerminalState(!0),e=this.state.getVisibleTerminalState(!1),c=this.state.absolutePoints;if(o.length==0&&(Math.round(i[0].x-i[i.length-1].x)==0||Math.round(i[0].y-i[i.length-1].y)==0))o=[t,t];else if(i.length==5&&o.length==2&&f!=null&&e!=null&&c!=null&&Math.round(c[0].x-c[c.length-1].x)==0){var l=this.graph.getView(),p=l.getScale(),w=l.getTranslate(),b=l.getRoutingCenterY(f)/p-w.y,k=this.graph.getConnectionConstraint(n,f,!0);k!=null&&(r=this.graph.getConnectionPoint(f,k),r!=null&&(this.convertPoint(r,!1),b=r.y));v=l.getRoutingCenterY(e)/p-w.y;y=this.graph.getConnectionConstraint(n,e,!1);y&&(r=this.graph.getConnectionPoint(e,y),r!=null&&(this.convertPoint(r,!1),v=r.y));o=[new mxPoint(t.x,b),new mxPoint(t.x,v)]}this.points=o;n.view.updateFixedTerminalPoints(n,f,e);n.view.updatePoints(n,this.points,f,e);n.view.updateFloatingTerminalPoints(n,f,e)}};mxEdgeSegmentHandler.prototype.connect=function(n){var r=this.graph.getModel(),t=r.getGeometry(n),u=null,e,o;if(t!=null&&t.points!=null&&t.points.length>0){var f=this.abspoints,s=f[0],i=f[1];for(u=[],e=2;e<f.length;e++)o=f[e],(Math.round(s.x-i.x)!=0||Math.round(i.x-o.x)!=0)&&(Math.round(s.y-i.y)!=0||Math.round(i.y-o.y)!=0)&&u.push(this.convertPoint(i.clone(),!1)),s=i,i=o}r.beginUpdate();try{u!=null&&(t=r.getGeometry(n),t!=null&&(t=t.clone(),t.points=u,r.setGeometry(n,t)));n=mxEdgeHandler.prototype.connect.apply(this,arguments)}finally{r.endUpdate()}return n};mxEdgeSegmentHandler.prototype.getTooltipForNode=function(){return null};mxEdgeSegmentHandler.prototype.start=function(n,t,i){mxEdgeHandler.prototype.start.apply(this,arguments);this.bends[i]==null||this.isSource||this.isTarget||mxUtils.setOpacity(this.bends[i].node,100)};mxEdgeSegmentHandler.prototype.createBends=function(){var r=[],n=this.createHandleShape(0),t,i,u;if(this.initBend(n),n.setCursor(mxConstants.CURSOR_TERMINAL_HANDLE),r.push(n),t=this.getCurrentPoints(),this.graph.isCellBendable(this.state.cell))for(this.points==null&&(this.points=[]),i=0;i<t.length-1;i++)n=this.createVirtualBend(),r.push(n),u=Math.round(t[i].x-t[i+1].x)==0,Math.round(t[i].y-t[i+1].y)==0&&i<t.length-2&&(u=Math.round(t[i].x-t[i+2].x)==0),n.setCursor(u?"col-resize":"row-resize"),this.points.push(new mxPoint(0,0));return n=this.createHandleShape(t.length),this.initBend(n),n.setCursor(mxConstants.CURSOR_TERMINAL_HANDLE),r.push(n),r};mxEdgeSegmentHandler.prototype.redraw=function(){this.refresh();mxEdgeHandler.prototype.redraw.apply(this,arguments)};mxEdgeSegmentHandler.prototype.redrawInnerBends=function(n,t){var i,f,e,o,r;if(this.graph.isCellBendable(this.state.cell)&&(i=this.getCurrentPoints(),i!=null&&i.length>1)){for(f=!1,i.length==4&&Math.round(i[1].x-i[2].x)==0&&Math.round(i[1].y-i[2].y)==0&&(f=!0,Math.round(i[0].y-i[i.length-1].y)==0?(e=i[0].x+(i[i.length-1].x-i[0].x)/2,i[1]=new mxPoint(e,i[1].y),i[2]=new mxPoint(e,i[2].y)):(o=i[0].y+(i[i.length-1].y-i[0].y)/2,i[1]=new mxPoint(i[1].x,o),i[2]=new mxPoint(i[2].x,o))),r=0;r<i.length-1;r++)if(this.bends[r+1]!=null){var n=i[r],t=i[r+1],s=new mxPoint(n.x+(t.x-n.x)/2,n.y+(t.y-n.y)/2),u=this.bends[r+1].bounds;this.bends[r+1].bounds=new mxRectangle(Math.floor(s.x-u.width/2),Math.floor(s.y-u.height/2),u.width,u.height);this.bends[r+1].redraw();this.manageLabelHandle&&this.checkLabelHandle(this.bends[r+1].bounds)}f&&(mxUtils.setOpacity(this.bends[1].node,this.virtualBendOpacity),mxUtils.setOpacity(this.bends[3].node,this.virtualBendOpacity))}};mxKeyHandler.prototype.graph=null;mxKeyHandler.prototype.target=null;mxKeyHandler.prototype.normalKeys=null;mxKeyHandler.prototype.shiftKeys=null;mxKeyHandler.prototype.controlKeys=null;mxKeyHandler.prototype.controlShiftKeys=null;mxKeyHandler.prototype.enabled=!0;mxKeyHandler.prototype.isEnabled=function(){return this.enabled};mxKeyHandler.prototype.setEnabled=function(n){this.enabled=n};mxKeyHandler.prototype.bindKey=function(n,t){this.normalKeys[n]=t};mxKeyHandler.prototype.bindShiftKey=function(n,t){this.shiftKeys[n]=t};mxKeyHandler.prototype.bindControlKey=function(n,t){this.controlKeys[n]=t};mxKeyHandler.prototype.bindControlShiftKey=function(n,t){this.controlShiftKeys[n]=t};mxKeyHandler.prototype.isControlDown=function(n){return mxEvent.isControlDown(n)};mxKeyHandler.prototype.getFunction=function(n){return n!=null&&!mxEvent.isAltDown(n)?this.isControlDown(n)?mxEvent.isShiftDown(n)?this.controlShiftKeys[n.keyCode]:this.controlKeys[n.keyCode]:mxEvent.isShiftDown(n)?this.shiftKeys[n.keyCode]:this.normalKeys[n.keyCode]:null};mxKeyHandler.prototype.isGraphEvent=function(n){var t=mxEvent.getSource(n);return t==this.target||t.parentNode==this.target||this.graph.cellEditor!=null&&this.graph.cellEditor.isEventSource(n)?!0:mxUtils.isAncestorNode(this.graph.container,t)};mxKeyHandler.prototype.keyDown=function(n){if(this.isEnabledForEvent(n))if(n.keyCode==27)this.escape(n);else if(!this.isEventIgnored(n)){var t=this.getFunction(n);t!=null&&(t(n),mxEvent.consume(n))}};mxKeyHandler.prototype.isEnabledForEvent=function(n){return this.graph.isEnabled()&&!mxEvent.isConsumed(n)&&this.isGraphEvent(n)&&this.isEnabled()};mxKeyHandler.prototype.isEventIgnored=function(){return this.graph.isEditing()};mxKeyHandler.prototype.escape=function(n){this.graph.isEscapeEnabled()&&this.graph.escape(n)};mxKeyHandler.prototype.destroy=function(){this.target!=null&&this.keydownHandler!=null&&(mxEvent.removeListener(this.target,"keydown",this.keydownHandler),this.keydownHandler=null);this.target=null};mxTooltipHandler.prototype.zIndex=10005;mxTooltipHandler.prototype.graph=null;mxTooltipHandler.prototype.delay=null;mxTooltipHandler.prototype.ignoreTouchEvents=!0;mxTooltipHandler.prototype.hideOnHover=!1;mxTooltipHandler.prototype.destroyed=!1;mxTooltipHandler.prototype.enabled=!0;mxTooltipHandler.prototype.isEnabled=function(){return this.enabled};mxTooltipHandler.prototype.setEnabled=function(n){this.enabled=n};mxTooltipHandler.prototype.isHideOnHover=function(){return this.hideOnHover};mxTooltipHandler.prototype.setHideOnHover=function(n){this.hideOnHover=n};mxTooltipHandler.prototype.init=function(){document.body!=null&&(this.div=document.createElement("div"),this.div.className="mxTooltip",this.div.style.visibility="hidden",document.body.appendChild(this.div),mxEvent.addGestureListeners(this.div,mxUtils.bind(this,function(){this.hideTooltip()})))};mxTooltipHandler.prototype.mouseDown=function(n,t){this.reset(t,!1);this.hideTooltip()};mxTooltipHandler.prototype.mouseMove=function(n,t){(t.getX()!=this.lastX||t.getY()!=this.lastY)&&(this.reset(t,!0),(this.isHideOnHover()||t.getState()!=this.state||t.getSource()!=this.node&&(!this.stateSource||t.getState()!=null&&this.stateSource==(t.isSource(t.getState().shape)||!t.isSource(t.getState().text))))&&this.hideTooltip());this.lastX=t.getX();this.lastY=t.getY()};mxTooltipHandler.prototype.mouseUp=function(n,t){this.reset(t,!0);this.hideTooltip()};mxTooltipHandler.prototype.resetTimer=function(){this.thread!=null&&(window.clearTimeout(this.thread),this.thread=null)};mxTooltipHandler.prototype.reset=function(n,t){if((!this.ignoreTouchEvents||mxEvent.isMouseEvent(n.getEvent()))&&(this.resetTimer(),t&&this.isEnabled()&&n.getState()!=null&&(this.div==null||this.div.style.visibility=="hidden"))){var i=n.getState(),r=n.getSource(),u=n.getX(),f=n.getY(),e=n.isSource(i.shape)||n.isSource(i.text);this.thread=window.setTimeout(mxUtils.bind(this,function(){if(!this.graph.isEditing()&&!this.graph.popupMenuHandler.isMenuShowing()&&!this.graph.isMouseDown){var n=this.graph.getTooltip(i,r,u,f);this.show(n,u,f);this.state=i;this.node=r;this.stateSource=e}}),this.delay)}};mxTooltipHandler.prototype.hide=function(){this.resetTimer();this.hideTooltip()};mxTooltipHandler.prototype.hideTooltip=function(){this.div!=null&&(this.div.style.visibility="hidden",this.div.innerHTML="")};mxTooltipHandler.prototype.show=function(n,t,i){if(!this.destroyed&&n!=null&&n.length>0){this.div==null&&this.init();var r=mxUtils.getScrollOrigin();this.div.style.zIndex=this.zIndex;this.div.style.left=t+r.x+"px";this.div.style.top=i+mxConstants.TOOLTIP_VERTICAL_OFFSET+r.y+"px";mxUtils.isNode(n)?(this.div.innerHTML="",this.div.appendChild(n)):this.div.innerHTML=n.replace(/\n/g,"<br>");this.div.style.visibility="";mxUtils.fit(this.div)}};mxTooltipHandler.prototype.destroy=function(){this.destroyed||(this.graph.removeMouseListener(this),mxEvent.release(this.div),this.div!=null&&this.div.parentNode!=null&&this.div.parentNode.removeChild(this.div),this.destroyed=!0,this.div=null)};mxUtils.extend(mxCellTracker,mxCellMarker);mxCellTracker.prototype.mouseDown=function(){};mxCellTracker.prototype.mouseMove=function(n,t){this.isEnabled()&&this.process(t)};mxCellTracker.prototype.mouseUp=function(){};mxCellTracker.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.graph.removeMouseListener(this),mxCellMarker.prototype.destroy.apply(this))};mxCellHighlight.prototype.keepOnTop=!1;mxCellHighlight.prototype.graph=!0;mxCellHighlight.prototype.state=null;mxCellHighlight.prototype.spacing=2;mxCellHighlight.prototype.resetHandler=null;mxCellHighlight.prototype.setHighlightColor=function(n){this.highlightColor=n;this.shape!=null&&(this.shape.stroke=n)};mxCellHighlight.prototype.drawHighlight=function(){this.shape=this.createShape();this.repaint();this.keepOnTop||this.shape.node.parentNode.firstChild==this.shape.node||this.shape.node.parentNode.insertBefore(this.shape.node,this.shape.node.parentNode.firstChild)};mxCellHighlight.prototype.createShape=function(){var n=this.graph.cellRenderer.createShape(this.state);return n.svgStrokeTolerance=this.graph.tolerance,n.points=this.state.absolutePoints,n.apply(this.state),n.stroke=this.highlightColor,n.opacity=this.opacity,n.isDashed=this.dashed,n.isShadow=!1,n.dialect=this.graph.dialect!=mxConstants.DIALECT_SVG?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG,n.init(this.graph.getView().getOverlayPane()),mxEvent.redirectMouseEvents(n.node,this.graph,this.state),this.graph.dialect!=mxConstants.DIALECT_SVG?n.pointerEvents=!1:n.svgPointerEvents="stroke",n};mxCellHighlight.prototype.getStrokeWidth=function(){return this.strokeWidth};mxCellHighlight.prototype.repaint=function(){this.state!=null&&this.shape!=null&&(this.shape.scale=this.state.view.scale,this.graph.model.isEdge(this.state.cell)?(this.shape.strokewidth=this.getStrokeWidth(),this.shape.points=this.state.absolutePoints,this.shape.outline=!1):(this.shape.bounds=new mxRectangle(this.state.x-this.spacing,this.state.y-this.spacing,this.state.width+2*this.spacing,this.state.height+2*this.spacing),this.shape.rotation=Number(this.state.style[mxConstants.STYLE_ROTATION]||"0"),this.shape.strokewidth=this.getStrokeWidth()/this.state.view.scale,this.shape.outline=!0),this.state.shape!=null&&this.shape.setCursor(this.state.shape.getCursor()),(mxClient.IS_QUIRKS||document.documentMode==8)&&(this.shape.stroke=="transparent"?(this.shape.stroke="white",this.shape.opacity=1):this.shape.opacity=this.opacity),this.shape.redraw())};mxCellHighlight.prototype.hide=function(){this.highlight(null)};mxCellHighlight.prototype.highlight=function(n){this.state!=n&&(this.shape!=null&&(this.shape.destroy(),this.shape=null),this.state=n,this.state!=null&&this.drawHighlight())};mxCellHighlight.prototype.isHighlightAt=function(n,t){var r=!1,i;if(this.shape!=null&&document.elementFromPoint!=null&&!mxClient.IS_QUIRKS)for(i=document.elementFromPoint(n,t);i!=null;){if(i==this.shape.node){r=!0;break}i=i.parentNode}return r};mxCellHighlight.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getView().removeListener(this.repaintHandler);this.graph.getModel().removeListener(this.repaintHandler);this.shape!=null&&(this.shape.destroy(),this.shape=null)};mxDefaultKeyHandler.prototype.editor=null;mxDefaultKeyHandler.prototype.handler=null;mxDefaultKeyHandler.prototype.bindAction=function(n,t,i){var r=mxUtils.bind(this,function(){this.editor.execute(t)});i?this.handler.bindControlKey(n,r):this.handler.bindKey(n,r)};mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy();this.handler=null};mxDefaultPopupMenu.prototype.imageBasePath=null;mxDefaultPopupMenu.prototype.config=null;mxDefaultPopupMenu.prototype.createMenu=function(n,t,i,r){if(this.config!=null){var u=this.createConditions(n,i,r),f=this.config.firstChild;this.addItems(n,t,i,r,u,f,null)}};mxDefaultPopupMenu.prototype.addItems=function(n,t,i,r,u,f,e){for(var h=!1,c,o,a;f!=null;){if(f.nodeName=="add"){if(c=f.getAttribute("if"),c==null||u[c]){o=f.getAttribute("as");o=mxResources.get(o)||o;var v=mxUtils.eval(mxUtils.getTextContent(f)),y=f.getAttribute("action"),s=f.getAttribute("icon"),p=f.getAttribute("iconCls"),l=f.getAttribute("enabled-if"),w=l==null||u[l];h&&(t.addSeparator(e),h=!1);s!=null&&this.imageBasePath&&(s=this.imageBasePath+s);a=this.addAction(t,n,o,s,v,y,i,e,p,w);this.addItems(n,t,i,r,u,f.firstChild,a)}}else f.nodeName=="separator"&&(h=!0);f=f.nextSibling}};mxDefaultPopupMenu.prototype.addAction=function(n,t,i,r,u,f,e,o,s,h){var c=function(n){typeof u=="function"&&u.call(t,t,e,n);f!=null&&t.execute(f,e,n)};return n.addItem(i,r,c,o,s,h)};mxDefaultPopupMenu.prototype.createConditions=function(n,t,i){var o=n.graph.getModel(),c=o.getChildCount(t),r=[],u,e,f,s,h;for(r.nocell=t==null,r.ncells=n.graph.getSelectionCount()>1,r.notRoot=o.getRoot()!=o.getParent(n.graph.getDefaultParent()),r.cell=t!=null,u=t!=null&&n.graph.getSelectionCount()==1,r.nonEmpty=u&&c>0,r.expandable=u&&n.graph.isCellFoldable(t,!1),r.collapsable=u&&n.graph.isCellFoldable(t,!0),r.validRoot=u&&n.graph.isValidRoot(t),r.emptyValidRoot=r.validRoot&&c==0,r.swimlane=u&&n.graph.isSwimlane(t),e=this.config.getElementsByTagName("condition"),f=0;f<e.length;f++)s=mxUtils.eval(mxUtils.getTextContent(e[f])),h=e[f].getAttribute("name"),h!=null&&typeof s=="function"&&(r[h]=s(n,t,i));return r};mxDefaultToolbar.prototype.editor=null;mxDefaultToolbar.prototype.toolbar=null;mxDefaultToolbar.prototype.resetHandler=null;mxDefaultToolbar.prototype.spacing=4;mxDefaultToolbar.prototype.connectOnDrop=!1;mxDefaultToolbar.prototype.init=function(n){n!=null&&(this.toolbar=new mxToolbar(n),this.toolbar.addListener(mxEvent.SELECT,mxUtils.bind(this,function(n,t){var i=t.getProperty("function");this.editor.insertFunction=i!=null?mxUtils.bind(this,function(){i.apply(this,arguments);this.toolbar.resetMode()}):null})),this.resetHandler=mxUtils.bind(this,function(){this.toolbar!=null&&this.toolbar.resetMode(!0)}),this.editor.graph.addListener(mxEvent.DOUBLE_CLICK,this.resetHandler),this.editor.addListener(mxEvent.ESCAPE,this.resetHandler))};mxDefaultToolbar.prototype.addItem=function(n,t,i,r){var u=mxUtils.bind(this,function(){i!=null&&i.length>0&&this.editor.execute(i)});return this.toolbar.addItem(n,t,u,r)};mxDefaultToolbar.prototype.addSeparator=function(n){n=n||mxClient.imageBasePath+"/separator.gif";this.toolbar.addSeparator(n)};mxDefaultToolbar.prototype.addCombo=function(){return this.toolbar.addCombo()};mxDefaultToolbar.prototype.addActionCombo=function(n){return this.toolbar.addActionCombo(n)};mxDefaultToolbar.prototype.addActionOption=function(n,t,i){var r=mxUtils.bind(this,function(){this.editor.execute(i)});this.addOption(n,t,r)};mxDefaultToolbar.prototype.addOption=function(n,t,i){return this.toolbar.addOption(n,t,i)};mxDefaultToolbar.prototype.addMode=function(n,t,i,r,u){var f=mxUtils.bind(this,function(){this.editor.setMode(i);u!=null&&u(this.editor)});return this.toolbar.addSwitchMode(n,t,f,r)};mxDefaultToolbar.prototype.addPrototype=function(n,t,i,r,u,f){var e=mxUtils.bind(this,function(){return typeof i=="function"?i():i!=null?this.editor.graph.cloneCells([i])[0]:null}),o=mxUtils.bind(this,function(n,t){typeof u=="function"?u(this.editor,e(),n,t):this.drop(e(),n,t);this.toolbar.resetMode();mxEvent.consume(n)}),s=this.toolbar.addMode(n,t,o,r,null,f),h=function(n,t,i){o(t,i)};return this.installDropHandler(s,h),s};mxDefaultToolbar.prototype.drop=function(n,t,i){var r=this.editor.graph,u=r.getModel();if(i!=null&&!u.isEdge(i)&&this.connectOnDrop&&r.isCellConnectable(i))this.connect(n,t,i);else{while(i!=null&&!r.isValidDropTarget(i,[n],t))i=u.getParent(i);this.insert(n,t,i)}};mxDefaultToolbar.prototype.insert=function(n,t,i){var r=this.editor.graph;if(r.canImportCell(n)){var f=mxEvent.getClientX(t),e=mxEvent.getClientY(t),u=mxUtils.convertPoint(r.container,f,e);return r.isSplitEnabled()&&r.isSplitTarget(i,[n],t)?r.splitEdge(i,[n],null,u.x,u.y):this.editor.addVertex(i,n,u.x,u.y)}return null};mxDefaultToolbar.prototype.connect=function(n,t,i){var u=this.editor.graph,f=u.getModel(),o,e,r,s,h,c,l;if(i!=null&&u.isCellConnectable(n)&&u.isEdgeValid(null,i,n)){o=null;f.beginUpdate();try{e=f.getGeometry(i);r=f.getGeometry(n).clone();r.x=e.x+(e.width-r.width)/2;r.y=e.y+(e.height-r.height)/2;s=this.spacing*u.gridSize;h=f.getDirectedEdgeCount(i,!0)*20;this.editor.horizontalFlow?r.x+=(r.width+e.width)/2+s+h:r.y+=(r.height+e.height)/2+s+h;n.setGeometry(r);c=f.getParent(i);u.addCell(n,c);u.constrainChild(n);o=this.editor.createEdge(i,n);f.getGeometry(o)==null&&(l=new mxGeometry,l.relative=!0,f.setGeometry(o,l));u.addEdge(o,c,i,n)}finally{f.endUpdate()}u.setSelectionCells([n,o]);u.scrollCellToVisible(n)}};mxDefaultToolbar.prototype.installDropHandler=function(n,t){var i=document.createElement("img"),r;i.setAttribute("src",n.getAttribute("src"));r=mxUtils.bind(this,function(){i.style.width=2*n.offsetWidth+"px";i.style.height=2*n.offsetHeight+"px";mxUtils.makeDraggable(n,this.editor.graph,t,i);mxEvent.removeListener(i,"load",r)});mxClient.IS_IE?r():mxEvent.addListener(i,"load",r)};mxDefaultToolbar.prototype.destroy=function(){this.resetHandler!=null&&(this.editor.graph.removeListener("dblclick",this.resetHandler),this.editor.removeListener("escape",this.resetHandler),this.resetHandler=null);this.toolbar!=null&&(this.toolbar.destroy(),this.toolbar=null)};mxLoadResources?mxResources.add(mxClient.basePath+"/resources/editor"):mxClient.defaultBundles.push(mxClient.basePath+"/resources/editor");mxEditor.prototype=new mxEventSource;mxEditor.prototype.constructor=mxEditor;mxEditor.prototype.askZoomResource=mxClient.language!="none"?"askZoom":"";mxEditor.prototype.lastSavedResource=mxClient.language!="none"?"lastSaved":"";mxEditor.prototype.currentFileResource=mxClient.language!="none"?"currentFile":"";mxEditor.prototype.propertiesResource=mxClient.language!="none"?"properties":"";mxEditor.prototype.tasksResource=mxClient.language!="none"?"tasks":"";mxEditor.prototype.helpResource=mxClient.language!="none"?"help":"";mxEditor.prototype.outlineResource=mxClient.language!="none"?"outline":"";mxEditor.prototype.outline=null;mxEditor.prototype.graph=null;mxEditor.prototype.graphRenderHint=null;mxEditor.prototype.toolbar=null;mxEditor.prototype.status=null;mxEditor.prototype.popupHandler=null;mxEditor.prototype.undoManager=null;mxEditor.prototype.keyHandler=null;mxEditor.prototype.actions=null;mxEditor.prototype.dblClickAction="edit";mxEditor.prototype.swimlaneRequired=!1;mxEditor.prototype.disableContextMenu=!0;mxEditor.prototype.insertFunction=null;mxEditor.prototype.forcedInserting=!1;mxEditor.prototype.templates=null;mxEditor.prototype.defaultEdge=null;mxEditor.prototype.defaultEdgeStyle=null;mxEditor.prototype.defaultGroup=null;mxEditor.prototype.groupBorderSize=null;mxEditor.prototype.filename=null;mxEditor.prototype.linefeed="&#xa;";mxEditor.prototype.postParameterName="xml";mxEditor.prototype.escapePostData=!0;mxEditor.prototype.urlPost=null;mxEditor.prototype.urlImage=null;mxEditor.prototype.horizontalFlow=!1;mxEditor.prototype.layoutDiagram=!1;mxEditor.prototype.swimlaneSpacing=0;mxEditor.prototype.maintainSwimlanes=!1;mxEditor.prototype.layoutSwimlanes=!1;mxEditor.prototype.cycleAttributeValues=null;mxEditor.prototype.cycleAttributeIndex=0;mxEditor.prototype.cycleAttributeName="fillColor";mxEditor.prototype.tasks=null;mxEditor.prototype.tasksWindowImage=null;mxEditor.prototype.tasksTop=20;mxEditor.prototype.help=null;mxEditor.prototype.helpWindowImage=null;mxEditor.prototype.urlHelp=null;mxEditor.prototype.helpWidth=300;mxEditor.prototype.helpHeight=260;mxEditor.prototype.propertiesWidth=240;mxEditor.prototype.propertiesHeight=null;mxEditor.prototype.movePropertiesDialog=!1;mxEditor.prototype.validating=!1;mxEditor.prototype.modified=!1;mxEditor.prototype.isModified=function(){return this.modified};mxEditor.prototype.setModified=function(n){this.modified=n};mxEditor.prototype.addActions=function(){this.addAction("save",function(n){n.save()});this.addAction("print",function(n){var t=new mxPrintPreview(n.graph,1);t.open()});this.addAction("show",function(n){mxUtils.show(n.graph,null,10,10)});this.addAction("exportImage",function(n){var t=n.getUrlImage(),i,r;t==null||mxClient.IS_LOCAL?n.execute("show"):(i=mxUtils.getViewXml(n.graph,1),r=mxUtils.getXml(i,"\n"),mxUtils.submit(t,n.postParameterName+"="+encodeURIComponent(r),document,"_blank"))});this.addAction("refresh",function(n){n.graph.refresh()});this.addAction("cut",function(n){n.graph.isEnabled()&&mxClipboard.cut(n.graph)});this.addAction("copy",function(n){n.graph.isEnabled()&&mxClipboard.copy(n.graph)});this.addAction("paste",function(n){n.graph.isEnabled()&&mxClipboard.paste(n.graph)});this.addAction("delete",function(n){n.graph.isEnabled()&&n.graph.removeCells()});this.addAction("group",function(n){n.graph.isEnabled()&&n.graph.setSelectionCell(n.groupCells())});this.addAction("ungroup",function(n){n.graph.isEnabled()&&n.graph.setSelectionCells(n.graph.ungroupCells())});this.addAction("removeFromParent",function(n){n.graph.isEnabled()&&n.graph.removeCellsFromParent()});this.addAction("undo",function(n){n.graph.isEnabled()&&n.undo()});this.addAction("redo",function(n){n.graph.isEnabled()&&n.redo()});this.addAction("zoomIn",function(n){n.graph.zoomIn()});this.addAction("zoomOut",function(n){n.graph.zoomOut()});this.addAction("actualSize",function(n){n.graph.zoomActual()});this.addAction("fit",function(n){n.graph.fit()});this.addAction("showProperties",function(n,t){n.showProperties(t)});this.addAction("selectAll",function(n){n.graph.isEnabled()&&n.graph.selectAll()});this.addAction("selectNone",function(n){n.graph.isEnabled()&&n.graph.clearSelection()});this.addAction("selectVertices",function(n){n.graph.isEnabled()&&n.graph.selectVertices()});this.addAction("selectEdges",function(n){n.graph.isEnabled()&&n.graph.selectEdges()});this.addAction("edit",function(n,t){n.graph.isEnabled()&&n.graph.isCellEditable(t)&&n.graph.startEditingAtCell(t)});this.addAction("toBack",function(n){n.graph.isEnabled()&&n.graph.orderCells(!0)});this.addAction("toFront",function(n){n.graph.isEnabled()&&n.graph.orderCells(!1)});this.addAction("enterGroup",function(n,t){n.graph.enterGroup(t)});this.addAction("exitGroup",function(n){n.graph.exitGroup()});this.addAction("home",function(n){n.graph.home()});this.addAction("selectPrevious",function(n){n.graph.isEnabled()&&n.graph.selectPreviousCell()});this.addAction("selectNext",function(n){n.graph.isEnabled()&&n.graph.selectNextCell()});this.addAction("selectParent",function(n){n.graph.isEnabled()&&n.graph.selectParentCell()});this.addAction("selectChild",function(n){n.graph.isEnabled()&&n.graph.selectChildCell()});this.addAction("collapse",function(n){n.graph.isEnabled()&&n.graph.foldCells(!0)});this.addAction("collapseAll",function(n){if(n.graph.isEnabled()){var t=n.graph.getChildVertices();n.graph.foldCells(!0,!1,t)}});this.addAction("expand",function(n){n.graph.isEnabled()&&n.graph.foldCells(!1)});this.addAction("expandAll",function(n){if(n.graph.isEnabled()){var t=n.graph.getChildVertices();n.graph.foldCells(!1,!1,t)}});this.addAction("bold",function(n){n.graph.isEnabled()&&n.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD)});this.addAction("italic",function(n){n.graph.isEnabled()&&n.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC)});this.addAction("underline",function(n){n.graph.isEnabled()&&n.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE)});this.addAction("alignCellsLeft",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_LEFT)});this.addAction("alignCellsCenter",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_CENTER)});this.addAction("alignCellsRight",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_RIGHT)});this.addAction("alignCellsTop",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_TOP)});this.addAction("alignCellsMiddle",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_MIDDLE)});this.addAction("alignCellsBottom",function(n){n.graph.isEnabled()&&n.graph.alignCells(mxConstants.ALIGN_BOTTOM)});this.addAction("alignFontLeft",function(n){n.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT)});this.addAction("alignFontCenter",function(n){n.graph.isEnabled()&&n.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER)});this.addAction("alignFontRight",function(n){n.graph.isEnabled()&&n.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT)});this.addAction("alignFontTop",function(n){n.graph.isEnabled()&&n.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP)});this.addAction("alignFontMiddle",function(n){n.graph.isEnabled()&&n.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE)});this.addAction("alignFontBottom",function(n){n.graph.isEnabled()&&n.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM)});this.addAction("zoom",function(n){var i=n.graph.getView().scale*100,t=parseFloat(mxUtils.prompt(mxResources.get(n.askZoomResource)||n.askZoomResource,i))/100;isNaN(t)||n.graph.getView().setScale(t)});this.addAction("toggleTasks",function(n){n.tasks!=null?n.tasks.setVisible(!n.tasks.isVisible()):n.showTasks()});this.addAction("toggleHelp",function(n){n.help!=null?n.help.setVisible(!n.help.isVisible()):n.showHelp()});this.addAction("toggleOutline",function(n){n.outline==null?n.showOutline():n.outline.setVisible(!n.outline.isVisible())});this.addAction("toggleConsole",function(){mxLog.setVisible(!mxLog.isVisible())})};mxEditor.prototype.configure=function(n){if(n!=null){var t=new mxCodec(n.ownerDocument);t.decode(n,this);this.resetHistory()}};mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/"};mxEditor.prototype.resetHistory=function(){this.lastSnapshot=(new Date).getTime();this.undoManager.clear();this.ignoredChanges=0;this.setModified(!1)};mxEditor.prototype.addAction=function(n,t){this.actions[n]=t};mxEditor.prototype.execute=function(n){var i=this.actions[n],t;if(i!=null)try{t=arguments;t[0]=this;i.apply(this,t)}catch(r){mxUtils.error("Cannot execute "+n+": "+r.message,280,!0);throw r;}else mxUtils.error("Cannot find action "+n,280,!0)};mxEditor.prototype.addTemplate=function(n,t){this.templates[n]=t};mxEditor.prototype.getTemplate=function(n){return this.templates[n]};mxEditor.prototype.createGraph=function(){var n=new mxGraph(null,null,this.graphRenderHint);return n.setTooltips(!0),n.setPanning(!0),this.installDblClickHandler(n),this.installUndoHandler(n),this.installDrillHandler(n),this.installChangeHandler(n),this.installInsertHandler(n),n.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(n,t,i){return this.createPopupMenu(n,t,i)}),n.connectionHandler.factoryMethod=mxUtils.bind(this,function(n,t){return this.createEdge(n,t)}),this.createSwimlaneManager(n),this.createLayoutManager(n),n};mxEditor.prototype.createSwimlaneManager=function(n){var t=new mxSwimlaneManager(n,!1);return t.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow}),t.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes}),t};mxEditor.prototype.createLayoutManager=function(n){var i=new mxLayoutManager(n),t=this;return i.getLayout=function(i){var r=null,u=t.graph.getModel();return u.getParent(i)!=null&&(t.layoutSwimlanes&&n.isSwimlane(i)?(t.swimlaneLayout==null&&(t.swimlaneLayout=t.createSwimlaneLayout()),r=t.swimlaneLayout):t.layoutDiagram&&(n.isValidRoot(i)||u.getParent(u.getParent(i))==null)&&(t.diagramLayout==null&&(t.diagramLayout=t.createDiagramLayout()),r=t.diagramLayout)),r},i};mxEditor.prototype.setGraphContainer=function(n){this.graph.container==null&&(this.graph.init(n),this.rubberband=new mxRubberband(this.graph),this.disableContextMenu&&mxEvent.disableContextMenu(n),mxClient.IS_QUIRKS&&new mxDivResizer(n))};mxEditor.prototype.installDblClickHandler=function(n){n.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(t,i){var r=i.getProperty("cell");r!=null&&n.isEnabled()&&this.dblClickAction!=null&&(this.execute(this.dblClickAction,r),i.consume())}))};mxEditor.prototype.installUndoHandler=function(n){var i=mxUtils.bind(this,function(n,t){var i=t.getProperty("edit");this.undoManager.undoableEditHappened(i)}),t;n.getModel().addListener(mxEvent.UNDO,i);n.getView().addListener(mxEvent.UNDO,i);t=function(t,i){var r=i.getProperty("edit").changes;n.setSelectionCells(n.getSelectionCellsForChanges(r))};this.undoManager.addListener(mxEvent.UNDO,t);this.undoManager.addListener(mxEvent.REDO,t)};mxEditor.prototype.installDrillHandler=function(n){var t=mxUtils.bind(this,function(){this.fireEvent(new mxEventObject(mxEvent.ROOT))});n.getView().addListener(mxEvent.DOWN,t);n.getView().addListener(mxEvent.UP,t)};mxEditor.prototype.installChangeHandler=function(n){var t=mxUtils.bind(this,function(t,i){var f,u,r;for(this.setModified(!0),this.validating==!0&&n.validateGraph(),f=i.getProperty("edit").changes,u=0;u<f.length;u++)if(r=f[u],r instanceof mxRootChange||r instanceof mxValueChange&&r.cell==this.graph.model.root||r instanceof mxCellAttributeChange&&r.cell==this.graph.model.root){this.fireEvent(new mxEventObject(mxEvent.ROOT));break}});n.getModel().addListener(mxEvent.CHANGE,t)};mxEditor.prototype.installInsertHandler=function(n){var t=this,i={mouseDown:function(n,i){t.insertFunction!=null&&!i.isPopupTrigger()&&(t.forcedInserting||i.getState()==null)&&(t.graph.clearSelection(),t.insertFunction(i.getEvent(),i.getCell()),this.isActive=!0,i.consume())},mouseMove:function(n,t){this.isActive&&t.consume()},mouseUp:function(n,t){this.isActive&&(this.isActive=!1,t.consume())}};n.addMouseListener(i)};mxEditor.prototype.createDiagramLayout=function(){var t=this.graph.gridSize,n=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*t,2*t);return n.isVertexIgnored=function(t){return!n.graph.isSwimlane(t)},n};mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow)};mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this)};mxEditor.prototype.setToolbarContainer=function(n){this.toolbar.init(n);mxClient.IS_QUIRKS&&new mxDivResizer(n)};mxEditor.prototype.setStatusContainer=function(n){this.status==null&&(this.status=n,this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var n=(new Date).toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+n)})),this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename)})),mxClient.IS_QUIRKS&&new mxDivResizer(n))};mxEditor.prototype.setStatus=function(n){this.status!=null&&n!=null&&(this.status.innerHTML=n)};mxEditor.prototype.setTitleContainer=function(n){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){n.innerHTML=this.getTitle()}));mxClient.IS_QUIRKS&&new mxDivResizer(n)};mxEditor.prototype.treeLayout=function(n,t){if(n!=null){var i=new mxCompactTreeLayout(this.graph,t);i.execute(n)}};mxEditor.prototype.getTitle=function(){for(var i="",n=this.graph,t=n.getCurrentRoot(),r;t!=null&&n.getModel().getParent(n.getModel().getParent(t))!=null;)n.isValidRoot(t)&&(i=" > "+n.convertValueToString(t)+i),t=n.getModel().getParent(t);return r=this.getRootTitle(),r+i};mxEditor.prototype.getRootTitle=function(){var n=this.graph.getModel().getRoot();return this.graph.convertValueToString(n)};mxEditor.prototype.undo=function(){this.undoManager.undo()};mxEditor.prototype.redo=function(){this.undoManager.redo()};mxEditor.prototype.groupCells=function(){var n=this.groupBorderSize!=null?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),n)};mxEditor.prototype.createGroup=function(){var n=this.graph.getModel();return n.cloneCell(this.defaultGroup)};mxEditor.prototype.open=function(n){if(n!=null){var t=mxUtils.load(n).getXml();this.readGraphModel(t.documentElement);this.filename=n;this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",n))}};mxEditor.prototype.readGraphModel=function(n){var t=new mxCodec(n.ownerDocument);t.decode(n,this.graph.getModel());this.resetHistory()};mxEditor.prototype.save=function(n,t){if(n=n||this.getUrlPost(),n!=null&&n.length>0){var i=this.writeGraphModel(t);this.postDiagram(n,i);this.setModified(!1)}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",n))};mxEditor.prototype.postDiagram=function(n,t){this.escapePostData&&(t=encodeURIComponent(t));mxUtils.post(n,this.postParameterName+"="+t,mxUtils.bind(this,function(i){this.fireEvent(new mxEventObject(mxEvent.POST,"request",i,"url",n,"data",t))}))};mxEditor.prototype.writeGraphModel=function(n){n=n!=null?n:this.linefeed;var t=new mxCodec,i=t.encode(this.graph.getModel());return mxUtils.getXml(i,n)};mxEditor.prototype.getUrlPost=function(){return this.urlPost};mxEditor.prototype.getUrlImage=function(){return this.urlImage};mxEditor.prototype.swapStyles=function(n,t){var i=this.graph.getStylesheet().styles[t];this.graph.getView().getStylesheet().putCellStyle(t,this.graph.getStylesheet().styles[n]);this.graph.getStylesheet().putCellStyle(n,i);this.graph.refresh()};mxEditor.prototype.showProperties=function(n){var t,u;if(n=n||this.graph.getSelectionCell(),n==null&&(n=this.graph.getCurrentRoot(),n==null&&(n=this.graph.getModel().getRoot())),n!=null){this.graph.stopEditing(!0);var f=mxUtils.getOffset(this.graph.container),i=f.x+10,r=f.y;this.properties==null||this.movePropertiesDialog?(t=this.graph.getCellBounds(n),t!=null&&(i+=t.x+Math.min(200,t.width),r+=t.y)):(i=this.properties.getX(),r=this.properties.getY());this.hideProperties();u=this.createProperties(n);u!=null&&(this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,u,i,r,this.propertiesWidth,this.propertiesHeight,!1),this.properties.setVisible(!0))}};mxEditor.prototype.isPropertiesVisible=function(){return this.properties!=null};mxEditor.prototype.createProperties=function(n){var i=this.graph.getModel(),e=i.getValue(n),r,o,u,y,p,w;if(mxUtils.isNode(e)){r=new mxForm("properties");o=r.addText("ID",n.getId());o.setAttribute("readonly","true");var t=null,s=null,h=null,c=null,l=null;i.isVertex(n)&&(t=i.getGeometry(n),t!=null&&(s=r.addText("top",t.y),h=r.addText("left",t.x),c=r.addText("width",t.width),l=r.addText("height",t.height)));var b=i.getStyle(n),a=r.addText("Style",b||""),f=e.attributes,v=[];for(u=0;u<f.length;u++)y=f[u].value,v[u]=r.addTextarea(f[u].nodeName,y,f[u].nodeName=="label"?4:2);return p=mxUtils.bind(this,function(){var r,u;this.hideProperties();i.beginUpdate();try{for(t!=null&&(t=t.clone(),t.x=parseFloat(h.value),t.y=parseFloat(s.value),t.width=parseFloat(c.value),t.height=parseFloat(l.value),i.setGeometry(n,t)),a.value.length>0?i.setStyle(n,a.value):i.setStyle(n,null),r=0;r<f.length;r++)u=new mxCellAttributeChange(n,f[r].nodeName,v[r].value),i.execute(u);this.graph.isAutoSizeCell(n)&&this.graph.updateCellSize(n)}finally{i.endUpdate()}}),w=mxUtils.bind(this,function(){this.hideProperties()}),r.addButtons(p,w),r.table}return null};mxEditor.prototype.hideProperties=function(){this.properties!=null&&(this.properties.destroy(),this.properties=null)};mxEditor.prototype.showTasks=function(){var n,r,t,i;this.tasks==null&&(n=document.createElement("div"),n.style.padding="4px",n.style.paddingLeft="20px",r=document.body.clientWidth,t=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,n,r-220,this.tasksTop,200),t.setClosable(!0),t.destroyOnClose=!1,i=mxUtils.bind(this,function(){mxEvent.release(n);n.innerHTML="";this.createTasks(n)}),this.graph.getModel().addListener(mxEvent.CHANGE,i),this.graph.getSelectionModel().addListener(mxEvent.CHANGE,i),this.graph.addListener(mxEvent.ROOT,i),this.tasksWindowImage!=null&&t.setImage(this.tasksWindowImage),this.tasks=t,this.createTasks(n));this.tasks.setVisible(!0)};mxEditor.prototype.refreshTasks=function(n){if(this.tasks!=null){var n=this.tasks.content;mxEvent.release(n);n.innerHTML="";this.createTasks(n)}};mxEditor.prototype.createTasks=function(){};mxEditor.prototype.showHelp=function(){var t,i;if(this.help==null){t=document.createElement("iframe");t.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);t.setAttribute("height","100%");t.setAttribute("width","100%");t.setAttribute("frameBorder","0");t.style.backgroundColor="white";var r=document.body.clientWidth,u=document.body.clientHeight||document.documentElement.clientHeight,n=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,t,(r-this.helpWidth)/2,(u-this.helpHeight)/3,this.helpWidth,this.helpHeight);n.setMaximizable(!0);n.setClosable(!0);n.destroyOnClose=!1;n.setResizable(!0);this.helpWindowImage!=null&&n.setImage(this.helpWindowImage);mxClient.IS_NS&&(i=function(){var i=n.div.offsetHeight;t.setAttribute("height",i-26+"px")},n.addListener(mxEvent.RESIZE_END,i),n.addListener(mxEvent.MAXIMIZE,i),n.addListener(mxEvent.NORMALIZE,i),n.addListener(mxEvent.SHOW,i));this.help=n}this.help.setVisible(!0)};mxEditor.prototype.showOutline=function(){var r=this.outline==null,n,t,i;r&&(n=document.createElement("div"),n.style.overflow="hidden",n.style.position="relative",n.style.width="100%",n.style.height="100%",n.style.background="white",n.style.cursor="move",document.documentMode==8&&(n.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=100)"),t=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,n,600,480,200,200,!1),i=new mxOutline(this.graph,n),t.setClosable(!0),t.setResizable(!0),t.destroyOnClose=!1,t.addListener(mxEvent.RESIZE_END,function(){i.update()}),this.outline=t,this.outline.outline=i);this.outline.setVisible(!0);this.outline.outline.update(!0)};mxEditor.prototype.setMode=function(n){n=="select"?(this.graph.panningHandler.useLeftButtonForPanning=!1,this.graph.setConnectable(!1)):n=="connect"?(this.graph.panningHandler.useLeftButtonForPanning=!1,this.graph.setConnectable(!0)):n=="pan"&&(this.graph.panningHandler.useLeftButtonForPanning=!0,this.graph.setConnectable(!1))};mxEditor.prototype.createPopupMenu=function(n,t,i){this.popupHandler.createMenu(this,n,t,i)};mxEditor.prototype.createEdge=function(){var n=null,r,t,i;return this.defaultEdge!=null?(r=this.graph.getModel(),n=r.cloneCell(this.defaultEdge)):(n=new mxCell(""),n.setEdge(!0),t=new mxGeometry,t.relative=!0,n.setGeometry(t)),i=this.getEdgeStyle(),i!=null&&n.setStyle(i),n};mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle};mxEditor.prototype.consumeCycleAttribute=function(n){return this.cycleAttributeValues!=null&&this.cycleAttributeValues.length>0&&this.graph.isSwimlane(n)?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null};mxEditor.prototype.cycleAttribute=function(n){if(this.cycleAttributeName!=null){var t=this.consumeCycleAttribute(n);t!=null&&n.setStyle(n.getStyle()+";"+this.cycleAttributeName+"="+t)}};mxEditor.prototype.addVertex=function(n,t,i,r){for(var o=this.graph.getModel(),u;n!=null&&!this.graph.isValidDropTarget(n);)n=o.getParent(n);n=n!=null?n:this.graph.getSwimlaneAt(i,r);var e=this.graph.getView().scale,f=o.getGeometry(t),h=o.getGeometry(n);if(this.graph.isSwimlane(t)&&!this.graph.swimlaneNesting)n=null;else{if(n==null&&this.swimlaneRequired)return null;if(n!=null&&h!=null)if(u=this.graph.getView().getState(n),u!=null){if(i-=u.origin.x*e,r-=u.origin.y*e,this.graph.isConstrainedMoving){var c=f.width,l=f.height,s=u.x+u.width;i+c>s&&(i-=i+c-s);s=u.y+u.height;r+l>s&&(r-=r+l-s)}}else h!=null&&(i-=h.x*e,r-=h.y*e)}f=f.clone();f.x=this.graph.snap(i/e-this.graph.getView().translate.x-this.graph.gridSize/2);f.y=this.graph.snap(r/e-this.graph.getView().translate.y-this.graph.gridSize/2);t.setGeometry(f);n==null&&(n=this.graph.getDefaultParent());this.cycleAttribute(t);this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",t,"parent",n));o.beginUpdate();try{t=this.graph.addCell(t,n);t!=null&&(this.graph.constrainChild(t),this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",t)))}finally{o.endUpdate()}return t!=null&&(this.graph.setSelectionCell(t),this.graph.scrollCellToVisible(t),this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",t))),t};mxEditor.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.tasks!=null&&this.tasks.destroy(),this.outline!=null&&this.outline.destroy(),this.properties!=null&&this.properties.destroy(),this.keyHandler!=null&&this.keyHandler.destroy(),this.rubberband!=null&&this.rubberband.destroy(),this.toolbar!=null&&this.toolbar.destroy(),this.graph!=null&&this.graph.destroy(),this.status=null,this.templates=null)};mxCodecRegistry={codecs:[],aliases:[],register:function(n){var t,i;return n!=null&&(t=n.getName(),mxCodecRegistry.codecs[t]=n,i=mxUtils.getFunctionName(n.template.constructor),i!=t&&mxCodecRegistry.addAlias(i,t)),n},addAlias:function(n,t){mxCodecRegistry.aliases[n]=t},getCodec:function(n){var t=null,i,r;if(n!=null&&(i=mxUtils.getFunctionName(n),r=mxCodecRegistry.aliases[i],r!=null&&(i=r),t=mxCodecRegistry.codecs[i],t==null))try{t=new mxObjectCodec(new n);mxCodecRegistry.register(t)}catch(u){}return t}};mxCodec.prototype.document=null;mxCodec.prototype.objects=null;mxCodec.prototype.elements=null;mxCodec.prototype.encodeDefaults=!1;mxCodec.prototype.putObject=function(n,t){return this.objects[n]=t,t};mxCodec.prototype.getObject=function(n){var t=null,i;return n!=null&&(t=this.objects[n],t==null&&(t=this.lookup(n),t==null&&(i=this.getElementById(n),i!=null&&(t=this.decode(i))))),t};mxCodec.prototype.lookup=function(){return null};mxCodec.prototype.getElementById=function(n){if(this.elements==null){if(this.document.documentElement==null)throw new Error("mxCodec constructor needs document parameter");this.elements={};this.addElement(this.document.documentElement)}return this.elements[n]};mxCodec.prototype.addElement=function(n){if(n.nodeType==mxConstants.NODETYPE_ELEMENT){var t=n.getAttribute("id");t!=null&&this.elements[t]==null&&(this.elements[t]=n)}for(n=n.firstChild;n!=null;)this.addElement(n),n=n.nextSibling};mxCodec.prototype.getId=function(n){var t=null;return n!=null&&(t=this.reference(n),t==null&&n instanceof mxCell&&(t=n.getId(),t==null&&(t=mxCellPath.create(n),t.length==0&&(t="root")))),t};mxCodec.prototype.reference=function(){return null};mxCodec.prototype.encode=function(n){var t=null,i;return n!=null&&n.constructor!=null&&(i=mxCodecRegistry.getCodec(n.constructor),i!=null?t=i.encode(this,n):mxUtils.isNode(n)?t=mxUtils.importNode(this.document,n,!0):mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(n.constructor))),t};mxCodec.prototype.decode=function(n,t){var i=null,r,u;if(n!=null&&n.nodeType==mxConstants.NODETYPE_ELEMENT){r=null;try{r=window[n.nodeName]}catch(f){}u=mxCodecRegistry.getCodec(r);u!=null?i=u.decode(this,n,t):(i=n.cloneNode(!0),i.removeAttribute("as"))}return i};mxCodec.prototype.encodeCell=function(n,t,i){var u,r;if(t.appendChild(this.encode(n)),i==null||i)for(u=n.getChildCount(),r=0;r<u;r++)this.encodeCell(n.getChildAt(r),t)};mxCodec.prototype.isCellCodec=function(n){return n!=null&&typeof n.isCellCodec=="function"?n.isCellCodec():!1};mxCodec.prototype.decodeCell=function(n,t){var u,i,r;if(t=t!=null?t:!0,u=null,n!=null&&n.nodeType==mxConstants.NODETYPE_ELEMENT){if(i=mxCodecRegistry.getCodec(n.nodeName),!this.isCellCodec(i))for(r=n.firstChild;r!=null&&!this.isCellCodec(i);)i=mxCodecRegistry.getCodec(r.nodeName),r=r.nextSibling;this.isCellCodec(i)||(i=mxCodecRegistry.getCodec(mxCell));u=i.decode(this,n);t&&this.insertIntoGraph(u)}return u};mxCodec.prototype.insertIntoGraph=function(n){var t=n.parent,i=n.getTerminal(!0),r=n.getTerminal(!1);n.setTerminal(null,!1);n.setTerminal(null,!0);n.parent=null;t!=null&&t.insert(n);i!=null&&i.insertEdge(n,!0);r!=null&&r.insertEdge(n,!1)};mxCodec.prototype.setAttribute=function(n,t,i){t!=null&&i!=null&&n.setAttribute(t,i)};mxObjectCodec.allowEval=!1;mxObjectCodec.prototype.template=null;mxObjectCodec.prototype.exclude=null;mxObjectCodec.prototype.idrefs=null;mxObjectCodec.prototype.mapping=null;mxObjectCodec.prototype.reverse=null;mxObjectCodec.prototype.getName=function(){return mxUtils.getFunctionName(this.template.constructor)};mxObjectCodec.prototype.cloneTemplate=function(){return new this.template.constructor};mxObjectCodec.prototype.getFieldName=function(n){if(n!=null){var t=this.reverse[n];t!=null&&(n=t)}return n};mxObjectCodec.prototype.getAttributeName=function(n){if(n!=null){var t=this.mapping[n];t!=null&&(n=t)}return n};mxObjectCodec.prototype.isExcluded=function(n,t){return t==mxObjectIdentity.FIELD_NAME||mxUtils.indexOf(this.exclude,t)>=0};mxObjectCodec.prototype.isReference=function(n,t){return mxUtils.indexOf(this.idrefs,t)>=0};mxObjectCodec.prototype.encode=function(n,t){var i=n.document.createElement(this.getName());return t=this.beforeEncode(n,t,i),this.encodeObject(n,t,i),this.afterEncode(n,t,i)};mxObjectCodec.prototype.encodeObject=function(n,t,i){var f,r,u;n.setAttribute(i,"id",n.getId(t));for(f in t)r=f,u=t[r],u==null||this.isExcluded(t,r,u,!0)||(mxUtils.isInteger(r)&&(r=null),this.encodeValue(n,t,r,u,i))};mxObjectCodec.prototype.encodeValue=function(n,t,i,r,u){var f,e;if(r!=null){if(this.isReference(t,i,r,!0)){if(f=n.getId(r),f==null){mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+i+"="+r);return}r=f}e=this.template[i];(i==null||n.encodeDefaults||e!=r)&&(i=this.getAttributeName(i),this.writeAttribute(n,t,i,r,u))}};mxObjectCodec.prototype.writeAttribute=function(n,t,i,r,u){typeof r!="object"?this.writePrimitiveAttribute(n,t,i,r,u):this.writeComplexAttribute(n,t,i,r,u)};mxObjectCodec.prototype.writePrimitiveAttribute=function(n,t,i,r,u){if(r=this.convertAttributeToXml(n,t,i,r,u),i==null){var f=n.document.createElement("add");typeof r=="function"?f.appendChild(n.document.createTextNode(r)):n.setAttribute(f,"value",r);u.appendChild(f)}else typeof r!="function"&&n.setAttribute(u,i,r)};mxObjectCodec.prototype.writeComplexAttribute=function(n,t,i,r,u){var f=n.encode(r);f!=null?(i!=null&&f.setAttribute("as",i),u.appendChild(f)):mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+i+": "+r)};mxObjectCodec.prototype.convertAttributeToXml=function(n,t,i,r){return this.isBooleanAttribute(n,t,i,r)&&(r=r==!0?"1":"0"),r};mxObjectCodec.prototype.isBooleanAttribute=function(n,t,i,r){return typeof r.length=="undefined"&&(r==!0||r==!1)};mxObjectCodec.prototype.convertAttributeFromXml=function(n,t,i){var r=t.value;return this.isNumericAttribute(n,t,i)&&(r=parseFloat(r)),r};mxObjectCodec.prototype.isNumericAttribute=function(n,t){return mxUtils.isNumeric(t.value)};mxObjectCodec.prototype.beforeEncode=function(n,t){return t};mxObjectCodec.prototype.afterEncode=function(n,t,i){return i};mxObjectCodec.prototype.decode=function(n,t,i){var u=t.getAttribute("id"),r=n.objects[u];return r==null&&(r=i||this.cloneTemplate(),u!=null&&n.putObject(u,r)),t=this.beforeDecode(n,t,r),this.decodeNode(n,t,r),this.afterDecode(n,t,r)};mxObjectCodec.prototype.decodeNode=function(n,t,i){t!=null&&(this.decodeAttributes(n,t,i),this.decodeChildren(n,t,i))};mxObjectCodec.prototype.decodeAttributes=function(n,t,i){var u=t.attributes,r;if(u!=null)for(r=0;r<u.length;r++)this.decodeAttribute(n,u[r],i)};mxObjectCodec.prototype.isIgnoredAttribute=function(n,t){return t.nodeName=="as"||t.nodeName=="id"};mxObjectCodec.prototype.decodeAttribute=function(n,t,i){var f;if(!this.isIgnoredAttribute(n,t,i)){var u=t.nodeName,r=this.convertAttributeFromXml(n,t,i),e=this.getFieldName(u);if(this.isReference(i,e,r,!1)){if(f=n.getObject(r),f==null){mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+u+"="+r);return}r=f}this.isExcluded(i,u,r,!1)||(i[u]=r)}};mxObjectCodec.prototype.decodeChildren=function(n,t,i){for(var r=t.firstChild,u;r!=null;)u=r.nextSibling,r.nodeType!=mxConstants.NODETYPE_ELEMENT||this.processInclude(n,r,i)||this.decodeChild(n,r,i),r=u};mxObjectCodec.prototype.decodeChild=function(n,t,i){var u=this.getFieldName(t.getAttribute("as")),f,r;u!=null&&this.isExcluded(i,u,t,!1)||(f=this.getFieldTemplate(i,u,t),r=null,t.nodeName=="add"?(r=t.getAttribute("value"),r==null&&mxObjectCodec.allowEval&&(r=mxUtils.eval(mxUtils.getTextContent(t)))):r=n.decode(t,f),this.addObjectValue(i,u,r,f))};mxObjectCodec.prototype.getFieldTemplate=function(n,t){var i=n[t];return i instanceof Array&&i.length>0&&(i=null),i};mxObjectCodec.prototype.addObjectValue=function(n,t,i,r){i!=null&&i!=r&&(t!=null&&t.length>0?n[t]=i:n.push(i))};mxObjectCodec.prototype.processInclude=function(n,t,i){var r,u;if(t.nodeName=="include"){if(r=t.getAttribute("name"),r!=null)try{u=mxUtils.load(r).getDocumentElement();u!=null&&n.decode(u,i)}catch(f){}return!0}return!1};mxObjectCodec.prototype.beforeDecode=function(n,t){return t};mxObjectCodec.prototype.afterDecode=function(n,t,i){return i};mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxCell,["children","edges","overlays","mxTransient"],["parent","source","target"]);return n.isCellCodec=function(){return!0},n.isNumericAttribute=function(n,t){return t.nodeName!=="value"&&mxObjectCodec.prototype.isNumericAttribute.apply(this,arguments)},n.isExcluded=function(n,t,i,r){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||r&&t=="value"&&i.nodeType==mxConstants.NODETYPE_ELEMENT},n.afterEncode=function(n,t,i){var r,u;return t.value!=null&&t.value.nodeType==mxConstants.NODETYPE_ELEMENT&&(r=i,i=mxUtils.importNode(n.document,t.value,!0),i.appendChild(r),u=r.getAttribute("id"),i.setAttribute("id",u),r.removeAttribute("id")),i},n.beforeDecode=function(n,t,i){var u=t.cloneNode(!0),l=this.getName(),r,c,e,o,f,s,h,a;if(t.nodeName!=l?(r=t.getElementsByTagName(l)[0],r!=null&&r.parentNode==t?(mxUtils.removeWhitespace(r,!0),mxUtils.removeWhitespace(r,!1),r.parentNode.removeChild(r),u=r):u=null,i.value=t.cloneNode(!0),c=i.value.getAttribute("id"),c!=null&&(i.setId(c),i.value.removeAttribute("id"))):i.setId(t.getAttribute("id")),u!=null)for(e=0;e<this.idrefs.length;e++)o=this.idrefs[e],f=u.getAttribute(o),f!=null&&(u.removeAttribute(o),s=n.objects[f]||n.lookup(f),s==null&&(h=n.getElementById(f),h!=null&&(a=mxCodecRegistry.codecs[h.nodeName]||this,s=a.decode(n,h))),i[o]=s);return u},n}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxGraphModel);return n.encodeObject=function(n,t,i){var r=n.document.createElement("root");n.encodeCell(t.getRoot(),r);i.appendChild(r)},n.decodeChild=function(n,t,i){t.nodeName=="root"?this.decodeRoot(n,t,i):mxObjectCodec.prototype.decodeChild.apply(this,arguments)},n.decodeRoot=function(n,t,i){for(var f=null,r=t.firstChild,u;r!=null;)u=n.decodeCell(r),u!=null&&u.getParent()==null&&(f=u),r=r.nextSibling;f!=null&&i.setRoot(f)},n}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxRootChange,["model","previous","root"]);return n.afterEncode=function(n,t,i){return n.encodeCell(t.root,i),i},n.beforeDecode=function(n,t,i){var r,u;if(t.firstChild!=null&&t.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT)for(t=t.cloneNode(!0),r=t.firstChild,i.root=n.decodeCell(r,!1),u=r.nextSibling,r.parentNode.removeChild(r),r=u;r!=null;)u=r.nextSibling,n.decodeCell(r),r.parentNode.removeChild(r),r=u;return t},n.afterDecode=function(n,t,i){return i.previous=i.root,i},n}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxChildChange,["model","child","previousIndex"],["parent","previous"]);return n.isReference=function(n,t,i,r){return t=="child"&&(n.previous!=null||!r)?!0:mxUtils.indexOf(this.idrefs,t)>=0},n.afterEncode=function(n,t,i){return this.isReference(t,"child",t.child,!0)?i.setAttribute("child",n.getId(t.child)):n.encodeCell(t.child,i),i},n.beforeDecode=function(n,t,i){var r,u,f,e;if(t.firstChild!=null&&t.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT)for(t=t.cloneNode(!0),r=t.firstChild,i.child=n.decodeCell(r,!1),u=r.nextSibling,r.parentNode.removeChild(r),r=u;r!=null;)u=r.nextSibling,r.nodeType==mxConstants.NODETYPE_ELEMENT&&(f=r.getAttribute("id"),n.lookup(f)==null&&n.decodeCell(r)),r.parentNode.removeChild(r),r=u;else e=t.getAttribute("child"),i.child=n.getObject(e);return t},n.afterDecode=function(n,t,i){return i.child!=null&&(i.child.parent!=null&&i.previous!=null&&i.child.parent!=i.previous&&(i.previous=i.child.parent),i.child.parent=i.previous,i.previous=i.parent,i.previousIndex=i.index),i},n}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxTerminalChange,["model","previous"],["cell","terminal"]);return n.afterDecode=function(n,t,i){return i.previous=i.terminal,i},n}());mxGenericChangeCodec=function(n,t){var i=new mxObjectCodec(n,["model","previous"],["cell"]);return i.afterDecode=function(n,i,r){return mxUtils.isNode(r.cell)&&(r.cell=n.decodeCell(r.cell,!1)),r.previous=r[t],r},i};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange,"value"));mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange,"style"));mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange,"geometry"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange,"collapsed"));mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange,"visible"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange,"value"));mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph,["graphListeners","eventListeners","view","container","cellRenderer","editor","selection"])}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxGraphView);return n.encode=function(n,t){return this.encodeCell(n,t,t.graph.getModel().getRoot())},n.encodeCell=function(n,t,i){var h=t.graph.getModel(),f=t.getState(i),a=h.getParent(i),r,b,c,e,o,v,l,u,y;if(a==null||f!=null){var p=h.getChildCount(i),w=t.graph.getCellGeometry(i),s=null;if(a==h.getRoot()?s="layer":a==null?s="graph":h.isEdge(i)?s="edge":p>0&&w!=null?s="group":h.isVertex(i)&&(s="vertex"),s!=null){if(r=n.document.createElement(s),b=t.graph.getLabel(i),b!=null&&(r.setAttribute("label",t.graph.getLabel(i)),t.graph.isHtmlLabel(i)&&r.setAttribute("html",!0)),a==null)c=t.getGraphBounds(),c!=null&&(r.setAttribute("x",Math.round(c.x)),r.setAttribute("y",Math.round(c.y)),r.setAttribute("width",Math.round(c.width)),r.setAttribute("height",Math.round(c.height))),r.setAttribute("scale",t.scale);else if(f!=null&&w!=null){for(u in f.style)e=f.style[u],typeof e=="function"&&typeof e=="object"&&(e=mxStyleRegistry.getName(e)),e!=null&&typeof e!="function"&&typeof e!="object"&&r.setAttribute(u,e);if(o=f.absolutePoints,o!=null&&o.length>0){for(v=Math.round(o[0].x)+","+Math.round(o[0].y),u=1;u<o.length;u++)v+=" "+Math.round(o[u].x)+","+Math.round(o[u].y);r.setAttribute("points",v)}else r.setAttribute("x",Math.round(f.x)),r.setAttribute("y",Math.round(f.y)),r.setAttribute("width",Math.round(f.width)),r.setAttribute("height",Math.round(f.height));l=f.absoluteOffset;l!=null&&(l.x!=0&&r.setAttribute("dx",Math.round(l.x)),l.y!=0&&r.setAttribute("dy",Math.round(l.y)))}for(u=0;u<p;u++)y=this.encodeCell(n,t,h.getChildAt(i,u)),y!=null&&r.appendChild(y)}}return r},n}());mxStylesheetCodec=mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxStylesheet);return n.encode=function(n,t){var s=n.document.createElement(this.getName()),r,e,i,u,o,f;for(r in t.styles)if(e=t.styles[r],i=n.document.createElement("add"),r!=null){i.setAttribute("as",r);for(u in e)o=this.getStringValue(u,e[u]),o!=null&&(f=n.document.createElement("add"),f.setAttribute("value",o),f.setAttribute("as",u),i.appendChild(f));i.childNodes.length>0&&s.appendChild(i)}return s},n.getStringValue=function(n,t){var i=typeof t;return i=="function"?t=mxStyleRegistry.getName(style[j]):i=="object"&&(t=null),t},n.decode=function(n,t,i){var e=i||new this.template.constructor,l=t.getAttribute("id"),h,o,f,r,c,s,u;for(l!=null&&(n.objects[l]=e),t=t.firstChild;t!=null;){if(!this.processInclude(n,t,e)&&t.nodeName=="add"&&(h=t.getAttribute("as"),h!=null)){for(o=t.getAttribute("extend"),f=o!=null?mxUtils.clone(e.styles[o]):null,f==null&&(o!=null&&mxLog.warn("mxStylesheetCodec.decode: stylesheet "+o+" not found to extend"),f={}),r=t.firstChild;r!=null;)r.nodeType==mxConstants.NODETYPE_ELEMENT&&(c=r.getAttribute("as"),r.nodeName=="add"?(s=mxUtils.getTextContent(r),u=null,s!=null&&s.length>0&&mxStylesheetCodec.allowEval?u=mxUtils.eval(s):(u=r.getAttribute("value"),mxUtils.isNumeric(u)&&(u=parseFloat(u))),u!=null&&(f[c]=u)):r.nodeName=="remove"&&delete f[c]),r=r.nextSibling;e.putCellStyle(h,f)}t=t.nextSibling}return e},n}());mxStylesheetCodec.allowEval=!0;mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxDefaultKeyHandler);return n.encode=function(){return null},n.decode=function(n,t,i){var r;if(i!=null)for(r=i.editor,t=t.firstChild;t!=null;){if(!this.processInclude(n,t,i)&&t.nodeName=="add"){var u=t.getAttribute("as"),f=t.getAttribute("action"),e=t.getAttribute("control");i.bindAction(u,f,e)}t=t.nextSibling}return i},n}());mxDefaultToolbarCodec=mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxDefaultToolbar);return n.encode=function(){return null},n.decode=function(n,t,i){var o,u,w,h,b,k,c,d,g,rt,f,r,v;if(i!=null)for(o=i.editor,t=t.firstChild;t!=null;){if(t.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(n,t,i))if(t.nodeName=="separator")i.addSeparator();else if(t.nodeName=="br")i.toolbar.addBreak();else if(t.nodeName=="hr")i.toolbar.addLine();else if(t.nodeName=="add"){u=t.getAttribute("as");u=mxResources.get(u)||u;var l=t.getAttribute("icon"),y=t.getAttribute("pressedIcon"),nt=t.getAttribute("action"),tt=t.getAttribute("mode"),p=t.getAttribute("template"),it=t.getAttribute("toggle")!="0",s=mxUtils.getTextContent(t),a=null;if(nt!=null)a=i.addItem(u,l,nt,y);else if(tt!=null)w=mxDefaultToolbarCodec.allowEval?mxUtils.eval(s):null,a=i.addMode(u,l,tt,y,w);else if(p!=null||s!=null&&s.length>0)h=o.templates[p],b=t.getAttribute("style"),h!=null&&b!=null&&(h=o.graph.cloneCells([h])[0],h.setStyle(b)),k=null,s!=null&&s.length>0&&mxDefaultToolbarCodec.allowEval&&(k=mxUtils.eval(s)),a=i.addPrototype(u,l,h,y,k,it);else if(c=mxUtils.getChildNodes(t),c.length>0)if(l==null)for(d=i.addActionCombo(u),f=0;f<c.length;f++)r=c[f],r.nodeName=="separator"?i.addOption(d,"---"):r.nodeName=="add"&&(g=r.getAttribute("as"),rt=r.getAttribute("action"),i.addActionOption(d,g,rt));else{var e=null,ut=function(){var n=o.templates[e.value],t,i;return n!=null?(t=n.clone(),i=e.options[e.selectedIndex].cellStyle,i!=null&&t.setStyle(i),t):(mxLog.warn("Template "+n+" not found"),null)},ft=i.addPrototype(u,l,ut,null,null,it);for(e=i.addCombo(),mxEvent.addListener(e,"change",function(){i.toolbar.selectMode(ft,function(n){var t=mxUtils.convertPoint(o.graph.container,mxEvent.getClientX(n),mxEvent.getClientY(n));return o.addVertex(null,w(),t.x,t.y)});i.toolbar.noReset=!1}),f=0;f<c.length;f++)if(r=c[f],r.nodeName=="separator")i.addOption(e,"---");else if(r.nodeName=="add"){var g=r.getAttribute("as"),et=r.getAttribute("template"),ot=i.addOption(e,g,et||p);ot.cellStyle=r.getAttribute("style")}}a!=null&&(v=t.getAttribute("id"),v!=null&&v.length>0&&a.setAttribute("id",v))}t=t.nextSibling}return i},n}());mxDefaultToolbarCodec.allowEval=!0;mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxDefaultPopupMenu);return n.encode=function(){return null},n.decode=function(n,t,i){var r=t.getElementsByTagName("include")[0];return r!=null?this.processInclude(n,r,i):i!=null&&(i.config=t),i},n}());mxCodecRegistry.register(function(){var n=new mxObjectCodec(new mxEditor,["modified","lastSnapshot","ignoredChanges","undoManager","graphContainer","toolbarContainer"]);return n.afterDecode=function(n,t,i){var u=t.getAttribute("defaultEdge"),r;return u!=null&&(t.removeAttribute("defaultEdge"),i.defaultEdge=i.templates[u]),r=t.getAttribute("defaultGroup"),r!=null&&(t.removeAttribute("defaultGroup"),i.defaultGroup=i.templates[r]),i},n.decodeChild=function(n,t,i){if(t.nodeName=="Array"){var r=t.getAttribute("as");if(r=="templates"){this.decodeTemplates(n,t,i);return}}else if(t.nodeName=="ui"){this.decodeUi(n,t,i);return}mxObjectCodec.prototype.decodeChild.apply(this,arguments)},n.decodeUi=function(n,t,i){for(var r=t.firstChild,s;r!=null;){if(r.nodeName=="add"){var f=r.getAttribute("as"),o=r.getAttribute("element"),e=r.getAttribute("style"),u=null;if(o!=null)u=document.getElementById(o),u!=null&&e!=null&&(u.style.cssText+=";"+e);else{var h=parseInt(r.getAttribute("x")),c=parseInt(r.getAttribute("y")),l=r.getAttribute("width"),a=r.getAttribute("height");u=document.createElement("div");u.style.cssText=e;s=new mxWindow(mxResources.get(f)||f,u,h,c,l,a,!1,!0);s.setVisible(!0)}f=="graph"?i.setGraphContainer(u):f=="toolbar"?i.setToolbarContainer(u):f=="title"?i.setTitleContainer(u):f=="status"?i.setStatusContainer(u):f=="map"&&i.setMapContainer(u)}else r.nodeName=="resource"?mxResources.add(r.getAttribute("basename")):r.nodeName=="stylesheet"&&mxClient.link("stylesheet",r.getAttribute("name"));r=r.nextSibling}},n.decodeTemplates=function(n,t,i){var f,u,e,r;for(i.templates==null&&(i.templates=[]),f=mxUtils.getChildNodes(t),u=0;u<f.length;u++){for(e=f[u].getAttribute("as"),r=f[u].firstChild;r!=null&&r.nodeType!=1;)r=r.nextSibling;r!=null&&(i.templates[e]=n.decodeCell(r))}},n}());var openUrl=function(n){var t=layer.open({type:2,content:n,area:["320px","195px"],maxmin:!0});layer.full(t)},openNewWindow=function(n,t){var i=parseInt($(window).innerWidth()*.8)+"px",r=parseInt($(window).innerHeight()-60)+"px",u=layer.open({type:2,content:n,area:[i,r],maxmin:!0,yes:function(n){layer.close(n);t&&t()}})},layerWindow=function(n){var t=layer.open({type:2,content:n,area:["320px","195px"],maxmin:!0});layer.full(t)},bootboxWindow=function(n,t,i){i===undefined&&(i={cancel:{label:MultiLangHelper.getResName("global_oper_close","关闭"),className:"btn-default"}});var r=bootbox.dialog({title:n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',size:"large",buttons:i});r.init(function(){$.get(t,function(n){r.find(".bootbox-body").html(n)})})};(function(n){n.fn.tclick=function(n){return this.bind("touchstart",function(t){n.call(this,t);t.stopPropagation();t.preventDefault()}),this.bind("click",function(t){n.call(this,t)}),this};n.fn.serializeObject=function(){var t={},i=this.serializeArray();return n.each(i,function(){t[this.name]!==undefined?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t};n.fn.autoWindowHeight=function(t){var i=0,r;t&&(i=t);r=this.offset();availableHeight=n(window).height()-r.top-i;this.css("height",availableHeight+"px")};n.fn.doScroll=function(t){var i=0,r,u;t!==undefined&&(i=t);r=this.offset();u=n(window).height()-r.top-i;n(this).ace_scroll({styleClass:"scroll-top",size:u,mouseWheelLock:!0,observeContent:!0});setTimeout(function(){n(".scrollable").trigger("mouseenter.ace_scroll")},0)}})(jQuery);jQuery.randomUrl=function(n){var t=(new Date).getTime();return n.indexOf("?")>-1?n+"&tamp="+t:n+"?timestamp="+t};$.msg=function(n,t){$.gritter.add({title:MultiLangHelper.getResName("information","提示信息"),text:n,sticky:!1,time:1e3,speed:500,position:t||"gritter-center",class_name:"gritter-success  gritter-light"})};$.toThousands=function(n){return(n||0).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")};isMobile={Android:function(){return navigator.userAgent.match(/Android/i)?!0:!1},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)?!0:!1},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1},Windows:function(){return navigator.userAgent.match(/IEMobile/i)?!0:!1},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Windows()}};HtmlUtil={htmlDecode:function(n){return n&&(n==="&nbsp;"||n==="&#160;"||n.length===1&&n.charCodeAt(0)===160)?"":n?String(n).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):n},htmlEncode:function(n){return n?String(n).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n}};window.urlParams=window.urlParams||{};window.MAX_REQUEST_SIZE=window.MAX_REQUEST_SIZE||10485760;window.MAX_AREA=window.MAX_AREA||225e6;window.EXPORT_URL=window.EXPORT_URL||"/export";window.SAVE_URL=window.SAVE_URL||"/Workflow/Api/WorkflowDiagraph";window.SAVEAS_URL=window.SAVEAS_URL||"/Workflow/Process/SaveAsFile";window.OPEN_URL=window.OPEN_URL||"/Workflow/Api/WorkflowDiagraph";window.TRANSITION_URL=window.TRANSITION_URL||"/Workflow/Process/Transition";window.BILLTEMPLATE_URL=window.BILLTEMPLATE_URL||"/Workflow/Api/BillTemplate";window.FIELDLIST_URL=window.FIELDLIST_URL||"/Api/Core/FieldList";window.SUBPROCESS_URL=window.SUBPROCESS_URL||"/Workflow/Api/WfTemplate";window.APPROVER_URL=window.APPROVER_URL||"/Workflow/Process/Approver";window.RESOURCES_PATH=window.RESOURCES_PATH||"../../../Content/mxGraph/resources";window.RESOURCE_BASE=window.RESOURCE_BASE||window.RESOURCES_PATH+"/grapheditor";window.STENCIL_PATH=window.STENCIL_PATH||"../../../Content/mxGraph/stencils";window.IMAGE_PATH=window.IMAGE_PATH||"../../../Content/mxGraph/images";window.STYLE_PATH=window.STYLE_PATH||"../../../Content/mxGraph/styles";window.CSS_PATH=window.CSS_PATH||"../../../Content/mxGraph/styles";window.OPEN_FORM=window.OPEN_FORM||"OpenFile";window.mxBasePath=window.mxBasePath||"../../../Content/mxGraph/src";window.mxLanguage=window.mxLanguage||"zh";window.mxLanguages=window.mxLanguages||["zh"];EditorUi=function(n,t,i){var r,u,v,y,s,b,k,d,rt,ut,e,o,l,f,a,w;mxEventSource.call(this);this.destroyFunctions=[];this.editor=n||new Editor;this.container=t||document.body;r=this.editor.graph;r.lightbox=i;mxClient.IS_SVG?mxPopupMenu.prototype.submenuImage="data:image/gif;base64,R0lGODlhCQAJAIAAAP///zMzMyH5BAEAAAAALAAAAAAJAAkAAAIPhI8WebHsHopSOVgb26AAADs=":(new Image).src=mxPopupMenu.prototype.submenuImage;mxClient.IS_SVG||mxConnectionHandler.prototype.connectImage==null||((new Image).src=mxConnectionHandler.prototype.connectImage.src);this.editor.chromeless&&!this.editor.editable&&(this.footerHeight=0,r.isEnabled=function(){return!1},r.panningHandler.isForcePanningEvent=function(n){return!mxEvent.isPopupTrigger(n.getEvent())});this.actions=new Actions(this);this.menus=this.createMenus();this.createDivs();this.createUi();this.refresh();u=mxUtils.bind(this,function(n){return n==null&&(n=window.event),this.isSelectionAllowed(n)||r.isEditing()});this.container==document.body&&(this.menubarContainer.onselectstart=u,this.menubarContainer.onmousedown=u,this.toolbarContainer.onselectstart=u,this.toolbarContainer.onmousedown=u,this.diagramContainer.onselectstart=u,this.diagramContainer.onmousedown=u,this.sidebarContainer.onselectstart=u,this.sidebarContainer.onmousedown=u,this.formatContainer.onselectstart=u,this.formatContainer.onmousedown=u,this.footerContainer.onselectstart=u,this.footerContainer.onmousedown=u,this.tabContainer!=null&&(this.tabContainer.onselectstart=u));!this.editor.chromeless||this.editor.editable?(v=function(n){var t=mxEvent.getSource(n);if(t.nodeName=="A")while(t!=null){if(t.className=="geHint")return!0;t=t.parentNode}return u(n)},mxClient.IS_IE&&(typeof document.documentMode=="undefined"||document.documentMode<9)?mxEvent.addListener(this.diagramContainer,"contextmenu",v):this.diagramContainer.oncontextmenu=v):r.panningHandler.usePopupTrigger=!1;r.init(this.diagramContainer);mxClient.IS_SVG&&r.view.getDrawPane()!=null&&(y=r.view.getDrawPane().ownerSVGElement,y!=null&&(y.style.position="absolute"));this.hoverIcons=this.createHoverIcons();mxEvent.addListener(this.diagramContainer,"mousemove",mxUtils.bind(this,function(n){var t=mxUtils.getOffset(this.diagramContainer);mxEvent.getClientX(n)-t.x-this.diagramContainer.clientWidth>0||mxEvent.getClientY(n)-t.y-this.diagramContainer.clientHeight>0?this.diagramContainer.setAttribute("title",mxResources.get("panTooltip")):this.diagramContainer.removeAttribute("title")}));s=!1;b=this.hoverIcons.isResetEvent;this.hoverIcons.isResetEvent=function(){return s||b.apply(this,arguments)};this.keydownHandler=mxUtils.bind(this,function(n){n.which==32?(s=!0,this.hoverIcons.reset(),r.container.style.cursor="move",r.isEditing()||mxEvent.getSource(n)!=r.container||mxEvent.consume(n)):mxEvent.isConsumed(n)||n.keyCode!=27||this.hideDialog()});mxEvent.addListener(document,"keydown",this.keydownHandler);this.keyupHandler=mxUtils.bind(this,function(){r.container.style.cursor="";s=!1});mxEvent.addListener(document,"keyup",this.keyupHandler);k=r.panningHandler.isForcePanningEvent;r.panningHandler.isForcePanningEvent=function(n){return k.apply(this,arguments)||s||mxEvent.isMouseEvent(n.getEvent())&&(this.usePopupTrigger||!mxEvent.isPopupTrigger(n.getEvent()))&&(!mxEvent.isControlDown(n.getEvent())&&mxEvent.isRightMouseButton(n.getEvent())||mxEvent.isMiddleMouseButton(n.getEvent()))};d=r.cellEditor.isStopEditingEvent;r.cellEditor.isStopEditingEvent=function(n){return d.apply(this,arguments)||n.keyCode==13&&(!mxClient.IS_SF&&mxEvent.isControlDown(n)||mxClient.IS_MAC&&mxEvent.isMetaDown(n)||mxClient.IS_SF&&mxEvent.isShiftDown(n))};var g=!1,nt=null,tt=null,c=null,it=mxUtils.bind(this,function(){var n,i,u,f,e,t;if(this.toolbar!=null&&g!=r.cellEditor.isContentEditing()){for(n=this.toolbar.container.firstChild,i=[];n!=null;)u=n.nextSibling,mxUtils.indexOf(this.toolbar.staticElements,n)<0&&(n.parentNode.removeChild(n),i.push(n)),n=u;if(f=this.toolbar.fontMenu,e=this.toolbar.sizeMenu,c==null)this.toolbar.createTextToolbar();else{for(t=0;t<c.length;t++)this.toolbar.container.appendChild(c[t]);this.toolbar.fontMenu=nt;this.toolbar.sizeMenu=tt}g=r.cellEditor.isContentEditing();nt=f;tt=e;c=i}}),p=this,ot=r.cellEditor.startEditing;if(r.cellEditor.startEditing=function(){if(ot.apply(this,arguments),it(),r.cellEditor.isContentEditing()){var t=!1,n=function(){t||(t=!0,window.setTimeout(function(){for(var f=r.getSelectedElement(),i=f,u,n;i!=null&&i.nodeType!=mxConstants.NODETYPE_ELEMENT;)i=i.parentNode;i!=null&&(u=mxUtils.getCurrentStyle(i),u!=null&&p.toolbar!=null&&(n=u.fontFamily,n.charAt(0)=="'"&&(n=n.substring(1)),n.charAt(n.length-1)=="'"&&(n=n.substring(0,n.length-1)),p.toolbar.setFontName(n),p.toolbar.setFontSize(parseInt(u.fontSize))));t=!1},0))};mxEvent.addListener(r.cellEditor.textarea,"input",n);mxEvent.addListener(r.cellEditor.textarea,"touchend",n);mxEvent.addListener(r.cellEditor.textarea,"mouseup",n);mxEvent.addListener(r.cellEditor.textarea,"keyup",n);n()}},rt=r.cellEditor.stopEditing,r.cellEditor.stopEditing=function(){rt.apply(this,arguments);it()},r.container.setAttribute("tabindex","0"),r.container.style.cursor="default",window.self===window.top&&r.container.parentNode!=null)try{r.container.focus()}catch(st){}ut=r.fireMouseEvent;r.fireMouseEvent=function(n){n==mxEvent.MOUSE_DOWN&&this.container.focus();ut.apply(this,arguments)};r.popupMenuHandler.autoExpand=!0;this.menus!=null&&(r.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(n,t,i){this.menus.createPopupMenu(n,t,i)}));mxEvent.addGestureListeners(document,mxUtils.bind(this,function(){r.popupMenuHandler.hideMenu()}));this.keyHandler=this.createKeyHandler(n);this.getKeyHandler=function(){return keyHandler};e=["rounded","shadow","glass","dashed","dashPattern","comic","labelBackgroundColor"];o=["shape","edgeStyle","curved","rounded","elbow","comic","jumpStyle","jumpSize"];this.setDefaultStyle=function(n){var i=r.view.getState(n),o,c,l,u,f,e,t,a;if(i!=null){o=n.clone();o.style="";var v=r.getCellStyle(o),s=[],h=[];for(t in i.style)v[t]!=i.style[t]&&(s.push(i.style[t]),h.push(t));for(c=r.getModel().getStyle(i.cell),l=c!=null?c.split(";"):[],u=0;u<l.length;u++)f=l[u],e=f.indexOf("="),e>=0&&(t=f.substring(0,e),a=f.substring(e+1),v[t]!=null&&a=="none"&&(s.push(a),h.push(t)));r.getModel().isEdge(i.cell)?r.currentEdgeStyle={}:r.currentVertexStyle={};this.fireEvent(new mxEventObject("styleChanged","keys",h,"values",s,"cells",[i.cell]))}};this.clearDefaultStyle=function(){r.currentEdgeStyle=mxUtils.clone(r.defaultEdgeStyle);r.currentVertexStyle=mxUtils.clone(r.defaultVertexStyle);this.fireEvent(new mxEventObject("styleChanged","keys",[],"values",[],"cells",[]))};var ft=["fontFamily","fontSize","fontColor"],et=["edgeStyle","startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],h=[["startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],["strokeColor","strokeWidth"],["fillColor","gradientColor"],ft,["align"],["html"]];for(f=0;f<h.length;f++)for(l=0;l<h[f].length;l++)e.push(h[f][l]);for(f=0;f<o.length;f++)mxUtils.indexOf(e,o[f])<0&&e.push(o[f]);a=function(n,t){var f=r.getModel(),b,a,k,d,g,v,y,p,nt,i,u,it;f.beginUpdate();try{if(t){var l=f.isEdge(c),rt=l?r.currentEdgeStyle:r.currentVertexStyle,w=["fontSize","fontFamily","fontColor"];for(i=0;i<w.length;i++)b=rt[w[i]],b!=null&&r.setCellStyles(w[i],b,n)}else for(a=0;a<n.length;a++){var c=n[a],ut=f.getStyle(c),ft=ut!=null?ut.split(";"):[],s=e.slice();for(i=0;i<ft.length;i++)if(k=ft[i],d=k.indexOf("="),d>=0)for(u=k.substring(0,d),g=mxUtils.indexOf(s,u),g>=0&&s.splice(g,1),v=0;v<h.length;v++)if(y=h[v],mxUtils.indexOf(y,u)>=0)for(p=0;p<y.length;p++)nt=mxUtils.indexOf(s,y[p]),nt>=0&&s.splice(nt,1);var l=f.isEdge(c),rt=l?r.currentEdgeStyle:r.currentVertexStyle,tt=f.getStyle(c);for(i=0;i<s.length;i++)u=s[i],it=rt[u],it!=null&&(u!="shape"||l)&&(!l||mxUtils.indexOf(o,u)<0)&&(tt=mxUtils.setStyle(tt,u,it));f.setStyle(c,tt)}}finally{f.endUpdate()}};r.addListener("cellsInserted",function(n,t){a(t.getProperty("cells"))});r.addListener("textInserted",function(n,t){a(t.getProperty("cells"),!0)});r.connectionHandler.addListener(mxEvent.CONNECT,function(n,t){var i=[t.getProperty("cell")];t.getProperty("terminalInserted")&&i.push(t.getProperty("terminal"));a(i)});this.addListener("styleChanged",mxUtils.bind(this,function(n,t){var c=t.getProperty("cells"),s=!1,h=!1,u,f,i,l,a,v,y,p;if(c.length>0){for(i=0;i<c.length;i++)if(s=r.getModel().isVertex(c[i])||s,h=r.getModel().isEdge(c[i])||h,h&&s)break}else s=!0,h=!0;for(u=t.getProperty("keys"),f=t.getProperty("values"),i=0;i<u.length;i++)l=mxUtils.indexOf(ft,u[i])>=0,(u[i]!="strokeColor"||f[i]!=null&&f[i]!="none")&&(mxUtils.indexOf(o,u[i])>=0?h||mxUtils.indexOf(et,u[i])>=0?f[i]==null?delete r.currentEdgeStyle[u[i]]:r.currentEdgeStyle[u[i]]=f[i]:s&&mxUtils.indexOf(e,u[i])>=0&&(f[i]==null?delete r.currentVertexStyle[u[i]]:r.currentVertexStyle[u[i]]=f[i]):mxUtils.indexOf(e,u[i])>=0&&((s||l)&&(f[i]==null?delete r.currentVertexStyle[u[i]]:r.currentVertexStyle[u[i]]=f[i]),(h||l||mxUtils.indexOf(et,u[i])>=0)&&(f[i]==null?delete r.currentEdgeStyle[u[i]]:r.currentEdgeStyle[u[i]]=f[i])));this.toolbar!=null&&(this.toolbar.setFontName(r.currentVertexStyle.fontFamily||Menus.prototype.defaultFont),this.toolbar.setFontSize(r.currentVertexStyle.fontSize||Menus.prototype.defaultFontSize),this.toolbar.edgeStyleMenu!=null&&(a=this.toolbar.edgeStyleMenu.getElementsByTagName("div")[0],a.className=r.currentEdgeStyle.edgeStyle=="orthogonalEdgeStyle"&&r.currentEdgeStyle.curved=="1"?"geSprite geSprite-curved":r.currentEdgeStyle.edgeStyle=="straight"||r.currentEdgeStyle.edgeStyle=="none"||r.currentEdgeStyle.edgeStyle==null?"geSprite geSprite-straight":r.currentEdgeStyle.edgeStyle=="entityRelationEdgeStyle"?"geSprite geSprite-entity":r.currentEdgeStyle.edgeStyle=="elbowEdgeStyle"?"geSprite geSprite-"+(r.currentEdgeStyle.elbow=="vertical"?"verticalelbow":"horizontalelbow"):r.currentEdgeStyle.edgeStyle=="isometricEdgeStyle"?"geSprite geSprite-"+(r.currentEdgeStyle.elbow=="vertical"?"verticalisometric":"horizontalisometric"):"geSprite geSprite-orthogonal"),this.toolbar.edgeShapeMenu!=null&&(v=this.toolbar.edgeShapeMenu.getElementsByTagName("div")[0],v.className=r.currentEdgeStyle.shape=="link"?"geSprite geSprite-linkedge":r.currentEdgeStyle.shape=="flexArrow"?"geSprite geSprite-arrow":r.currentEdgeStyle.shape=="arrow"?"geSprite geSprite-simplearrow":"geSprite geSprite-connection"),this.toolbar.lineStartMenu!=null&&(y=this.toolbar.lineStartMenu.getElementsByTagName("div")[0],y.className=this.getCssClassForMarker("start",r.currentEdgeStyle.shape,r.currentEdgeStyle[mxConstants.STYLE_STARTARROW],mxUtils.getValue(r.currentEdgeStyle,"startFill","1"))),this.toolbar.lineEndMenu!=null&&(p=this.toolbar.lineEndMenu.getElementsByTagName("div")[0],p.className=this.getCssClassForMarker("end",r.currentEdgeStyle.shape,r.currentEdgeStyle[mxConstants.STYLE_ENDARROW],mxUtils.getValue(r.currentEdgeStyle,"endFill","1"))))}));this.toolbar!=null&&(w=mxUtils.bind(this,function(){var n=r.currentVertexStyle.fontFamily||"Helvetica",t=String(r.currentVertexStyle.fontSize||"12"),i=r.getView().getState(r.getSelectionCell());i!=null&&(n=i.style[mxConstants.STYLE_FONTFAMILY]||n,t=i.style[mxConstants.STYLE_FONTSIZE]||t,n.length>10&&(n=n.substring(0,8)+"..."));this.toolbar.setFontName(n);this.toolbar.setFontSize(t)}),r.getSelectionModel().addListener(mxEvent.CHANGE,w),r.getModel().addListener(mxEvent.CHANGE,w));r.addListener(mxEvent.CELLS_ADDED,function(n,t){var u=t.getProperty("cells"),i=t.getProperty("parent");r.getModel().isLayer(i)&&!r.isCellVisible(i)&&u!=null&&u.length>0&&r.getModel().setVisible(i,!0)});this.gestureHandler=mxUtils.bind(this,function(n){this.currentMenu!=null&&mxEvent.getSource(n)!=this.currentMenu.div&&this.hideCurrentMenu()});mxEvent.addGestureListeners(document,this.gestureHandler);this.resizeHandler=mxUtils.bind(this,function(){window.setTimeout(mxUtils.bind(this,function(){this.refresh()}),0)});mxEvent.addListener(window,"resize",this.resizeHandler);this.orientationChangeHandler=mxUtils.bind(this,function(){this.refresh()});mxEvent.addListener(window,"orientationchange",this.orientationChangeHandler);mxClient.IS_IOS&&!window.navigator.standalone&&(this.scrollHandler=mxUtils.bind(this,function(){window.scrollTo(0,0)}),mxEvent.addListener(window,"scroll",this.scrollHandler));this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){this.resetScrollbars()}));this.addListener("gridEnabledChanged",mxUtils.bind(this,function(){r.view.validateBackground()}));this.addListener("backgroundColorChanged",mxUtils.bind(this,function(){r.view.validateBackground()}));r.addListener("gridSizeChanged",mxUtils.bind(this,function(){r.isGridEnabled()&&r.view.validateBackground()}));this.editor.resetGraph();this.init();this.open()};mxUtils.extend(EditorUi,mxEventSource);EditorUi.compactUi=!0;EditorUi.prototype.splitSize=mxClient.IS_TOUCH||mxClient.IS_POINTER?12:8;EditorUi.prototype.menubarHeight=30;EditorUi.prototype.formatEnabled=!0;EditorUi.prototype.formatWidth=240;EditorUi.prototype.toolbarHeight=34;EditorUi.prototype.footerHeight=28;EditorUi.prototype.sidebarFooterHeight=34;EditorUi.prototype.editButtonLink=null;EditorUi.prototype.hsplitPosition=screen.width<=640?118:208;EditorUi.prototype.allowAnimation=!0;EditorUi.prototype.lightboxMaxFitScale=2;EditorUi.prototype.lightboxVerticalDivider=4;EditorUi.prototype.init=function(){var n=this.editor.graph,i,t;mxEvent.addListener(n.container,"keydown",mxUtils.bind(this,function(n){this.onKeyDown(n)}));mxEvent.addListener(n.container,"keypress",mxUtils.bind(this,function(n){this.onKeyPress(n)}));this.addUndoListener();this.addBeforeUnloadListener();n.getSelectionModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));n.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));i=n.setDefaultParent;t=this;this.editor.graph.setDefaultParent=function(){i.apply(this,arguments);t.updateActionStates()};n.editLink=t.actions.get("editLink").funct;this.updateActionStates();this.initClipboard();this.initCanvas();this.format!=null&&this.format.init()};EditorUi.prototype.onKeyDown=function(n){var t=this.editor.graph;n.which==9&&t.isEnabled()&&!mxEvent.isAltDown(n)&&(t.isEditing()?t.stopEditing(!1):t.selectCell(!mxEvent.isShiftDown(n)),mxEvent.consume(n))};EditorUi.prototype.onKeyPress=function(n){var t=this.editor.graph,r,i,u;!this.isImmediateEditingEvent(n)||t.isEditing()||t.isSelectionEmpty()||n.which===0||mxEvent.isAltDown(n)||mxEvent.isControlDown(n)||mxEvent.isMetaDown(n)||(t.escape(),t.startEditing(),mxClient.IS_FF&&(r=t.cellEditor,r.textarea.innerHTML=String.fromCharCode(n.which),i=document.createRange(),i.selectNodeContents(r.textarea),i.collapse(!1),u=window.getSelection(),u.removeAllRanges(),u.addRange(i)))};EditorUi.prototype.isImmediateEditingEvent=function(){return!0};EditorUi.prototype.getCssClassForMarker=function(n,t,i,r){return t=="flexArrow"?i!=null&&i!=mxConstants.NONE?"geSprite geSprite-"+n+"blocktrans":"geSprite geSprite-noarrow":i==mxConstants.ARROW_CLASSIC?r=="1"?"geSprite geSprite-"+n+"classic":"geSprite geSprite-"+n+"classictrans":i==mxConstants.ARROW_CLASSIC_THIN?r=="1"?"geSprite geSprite-"+n+"classicthin":"geSprite geSprite-"+n+"classicthintrans":i==mxConstants.ARROW_OPEN?"geSprite geSprite-"+n+"open":i==mxConstants.ARROW_OPEN_THIN?"geSprite geSprite-"+n+"openthin":i==mxConstants.ARROW_BLOCK?r=="1"?"geSprite geSprite-"+n+"block":"geSprite geSprite-"+n+"blocktrans":i==mxConstants.ARROW_BLOCK_THIN?r=="1"?"geSprite geSprite-"+n+"blockthin":"geSprite geSprite-"+n+"blockthintrans":i==mxConstants.ARROW_OVAL?r=="1"?"geSprite geSprite-"+n+"oval":"geSprite geSprite-"+n+"ovaltrans":i==mxConstants.ARROW_DIAMOND?r=="1"?"geSprite geSprite-"+n+"diamond":"geSprite geSprite-"+n+"diamondtrans":i==mxConstants.ARROW_DIAMOND_THIN?r=="1"?"geSprite geSprite-"+n+"thindiamond":"geSprite geSprite-"+n+"thindiamondtrans":i=="openAsync"?"geSprite geSprite-"+n+"openasync":i=="dash"?"geSprite geSprite-"+n+"dash":i=="cross"?"geSprite geSprite-"+n+"cross":i=="async"?r=="1"?"geSprite geSprite-"+n+"async":"geSprite geSprite-"+n+"asynctrans":i=="circle"||i=="circlePlus"?r=="1"||i=="circle"?"geSprite geSprite-"+n+"circle":"geSprite geSprite-"+n+"circleplus":i=="ERone"?"geSprite geSprite-"+n+"erone":i=="ERmandOne"?"geSprite geSprite-"+n+"eronetoone":i=="ERmany"?"geSprite geSprite-"+n+"ermany":i=="ERoneToMany"?"geSprite geSprite-"+n+"eronetomany":i=="ERzeroToOne"?"geSprite geSprite-"+n+"eroneopt":i=="ERzeroToMany"?"geSprite geSprite-"+n+"ermanyopt":"geSprite geSprite-noarrow"};EditorUi.prototype.createMenus=function(){return null};EditorUi.prototype.updatePasteActionStates=function(){var n=this.editor.graph,t=this.actions.get("paste"),i=this.actions.get("pasteHere");t.setEnabled(this.editor.graph.cellEditor.isContentEditing()||!mxClipboard.isEmpty()&&n.isEnabled()&&!n.isCellLocked(n.getDefaultParent()));i.setEnabled(t.isEnabled())};EditorUi.prototype.initClipboard=function(){var n=this,f=mxClipboard.cut,t,i,r,u;mxClipboard.cut=function(t){t.cellEditor.isContentEditing()?document.execCommand("cut",!1,null):f.apply(this,arguments);n.updatePasteActionStates()};t=mxClipboard.copy;mxClipboard.copy=function(i){i.cellEditor.isContentEditing()?document.execCommand("copy",!1,null):t.apply(this,arguments);n.updatePasteActionStates()};i=mxClipboard.paste;mxClipboard.paste=function(t){var r=null;return t.cellEditor.isContentEditing()?document.execCommand("paste",!1,null):r=i.apply(this,arguments),n.updatePasteActionStates(),r};r=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){r.apply(this,arguments);n.updatePasteActionStates()};u=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(){u.apply(this,arguments);n.updatePasteActionStates()};this.updatePasteActionStates()};EditorUi.prototype.initCanvas=function(){var n=this.editor.graph,n=this.editor.graph,h,v,y,p,f,w,k,b,a,o,d,g,s;if(n.timerAutoScroll=!0,n.getPagePadding=function(){return new mxPoint(Math.max(0,Math.round((n.container.offsetWidth-34)/n.view.scale)),Math.max(0,Math.round((n.container.offsetHeight-34)/n.view.scale)))},n.view.getBackgroundPageBounds=function(){var n=this.graph.getPageLayout(),t=this.graph.getPageSize();return new mxRectangle(this.scale*(this.translate.x+n.x*t.width),this.scale*(this.translate.y+n.y*t.height),this.scale*n.width*t.width,this.scale*n.height*t.height)},n.getPreferredPageSize=function(){var n=this.getPageLayout(),t=this.getPageSize();return new mxRectangle(0,0,n.width*t.width,n.height*t.height)},h=null,v=this,this.editor.chromeless){if(h=mxUtils.bind(this,function(t,i,r,u){var v;if(n.container!=null){r=r!=null?r:0;u=u!=null?u:0;var s=n.pageVisible?n.view.getBackgroundPageBounds():n.getGraphBounds(),y=mxUtils.hasScrollbars(n.container),p=n.view.translate,e=n.view.scale,f=mxRectangle.fromRectangle(s);f.x=f.x/e-p.x;f.y=f.y/e-p.y;f.width/=e;f.height/=e;var b=n.container.scrollTop,k=n.container.scrollLeft,h=mxClient.IS_QUIRKS||document.documentMode>=8?20:14;(document.documentMode==8||document.documentMode==9)&&(h+=3);var c=n.container.offsetWidth-h,w=n.container.offsetHeight-h,o=t?Math.max(.3,Math.min(i||1,c/f.width)):e,l=(c-o*f.width)/2/o,a=this.lightboxVerticalDivider==0?0:(w-o*f.height)/this.lightboxVerticalDivider/o;y&&(l=Math.max(l,0),a=Math.max(a,0));y||s.width<c||s.height<w?(n.view.scaleAndTranslate(o,Math.floor(l-f.x),Math.floor(a-f.y)),n.container.scrollTop=b*o/e,n.container.scrollLeft=k*o/e):(r!=0||u!=0)&&(v=n.view.translate,n.view.setTranslate(Math.floor(v.x+r/e),Math.floor(v.y+u/e)))}}),this.chromelessResize=h,this.chromelessWindowResize=mxUtils.bind(this,function(){this.chromelessResize(!1)}),y=mxUtils.bind(this,function(){this.chromelessWindowResize(!1)}),mxEvent.addListener(window,"resize",y),this.destroyFunctions.push(function(){mxEvent.removeListener(window,"resize",y)}),this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){this.chromelessResize(!0)})),this.actions.get("zoomIn").funct=mxUtils.bind(this,function(){n.zoomIn();this.chromelessResize(!1)}),this.actions.get("zoomOut").funct=mxUtils.bind(this,function(){n.zoomOut();this.chromelessResize(!1)}),urlParams.toolbar!="0"){this.chromelessToolbar=document.createElement("div");this.chromelessToolbar.style.position="fixed";this.chromelessToolbar.style.overflow="hidden";this.chromelessToolbar.style.boxSizing="border-box";this.chromelessToolbar.style.whiteSpace="nowrap";this.chromelessToolbar.style.backgroundColor="#000000";this.chromelessToolbar.style.padding="10px 10px 8px 10px";this.chromelessToolbar.style.left="50%";mxClient.IS_VML||(mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"borderRadius","20px"),mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transition","opacity 600ms ease-in-out"));p=mxUtils.bind(this,function(){var t=mxUtils.getCurrentStyle(n.container);this.chromelessToolbar.style.bottom=(t!=null?parseInt(t["margin-bottom"]||0):0)+(this.tabContainer!=null?20+parseInt(this.tabContainer.style.height):20)+"px"});this.editor.addListener("resetGraphView",p);p();var nt=0,i=mxUtils.bind(this,function(n,t,i){var r,u;return nt++,r=document.createElement("span"),r.style.paddingLeft="8px",r.style.paddingRight="8px",r.style.cursor="pointer",mxEvent.addListener(r,"click",n),i!=null&&r.setAttribute("title",i),u=document.createElement("img"),u.setAttribute("border","0"),u.setAttribute("src",t),r.appendChild(u),this.chromelessToolbar.appendChild(r),r}),c=i(mxUtils.bind(this,function(n){this.actions.get("previousPage").funct();mxEvent.consume(n)}),Editor.previousLargeImage,mxResources.get("previousPage")),t=document.createElement("div");t.style.display="inline-block";t.style.verticalAlign="top";t.style.fontFamily="Helvetica,Arial";t.style.marginTop="8px";t.style.color="#ffffff";this.chromelessToolbar.appendChild(t);f=i(mxUtils.bind(this,function(n){this.actions.get("nextPage").funct();mxEvent.consume(n)}),Editor.nextLargeImage,mxResources.get("nextPage"));w=mxUtils.bind(this,function(){this.pages!=null&&this.pages.length>1&&this.currentPage!=null&&(t.innerHTML="",mxUtils.write(t,mxUtils.indexOf(this.pages,this.currentPage)+1+" / "+this.pages.length))});c.style.paddingLeft="0px";c.style.paddingRight="4px";f.style.paddingLeft="4px";f.style.paddingRight="0px";k=mxUtils.bind(this,function(){this.pages!=null&&this.pages.length>1&&this.currentPage!=null?(f.style.display="",c.style.display="",t.style.display="inline-block"):(f.style.display="none",c.style.display="none",t.style.display="none");w()});this.editor.addListener("resetGraphView",k);this.editor.addListener("pageSelected",w);i(mxUtils.bind(this,function(n){this.actions.get("zoomOut").funct();mxEvent.consume(n)}),Editor.zoomOutLargeImage,mxResources.get("zoomOut")+" (Alt+Mousewheel)");i(mxUtils.bind(this,function(n){this.actions.get("zoomIn").funct();mxEvent.consume(n)}),Editor.zoomInLargeImage,mxResources.get("zoomIn")+" (Alt+Mousewheel)");i(mxUtils.bind(this,function(t){n.lightbox?(n.view.scale==1?this.lightboxFit():n.zoomTo(1),this.chromelessResize(!1)):this.chromelessResize(!0);mxEvent.consume(t)}),Editor.actualSizeLargeImage,mxResources.get("fit"));var r=null,u=null,l=mxUtils.bind(this,function(n){r!=null&&(window.clearTimeout(r),fadeThead=null);u!=null&&(window.clearTimeout(u),fadeThead2=null);r=window.setTimeout(mxUtils.bind(this,function(){mxUtils.setOpacity(this.chromelessToolbar,0);r=null;u=window.setTimeout(mxUtils.bind(this,function(){this.chromelessToolbar.style.display="none";u=null}),600)}),n||200)}),e=mxUtils.bind(this,function(n){r!=null&&(window.clearTimeout(r),fadeThead=null);u!=null&&(window.clearTimeout(u),fadeThead2=null);this.chromelessToolbar.style.display="";mxUtils.setOpacity(this.chromelessToolbar,n||30)});urlParams.layers=="1"&&(this.layersDialog=null,b=i(mxUtils.bind(this,function(t){var i,r;this.layersDialog!=null?(this.layersDialog.parentNode.removeChild(this.layersDialog),this.layersDialog=null):(this.layersDialog=n.createLayersDialog(),mxEvent.addListener(this.layersDialog,"mouseleave",mxUtils.bind(this,function(){this.layersDialog.parentNode.removeChild(this.layersDialog);this.layersDialog=null})),i=b.getBoundingClientRect(),mxUtils.setPrefixedStyle(this.layersDialog.style,"borderRadius","5px"),this.layersDialog.style.position="fixed",this.layersDialog.style.fontFamily="Helvetica,Arial",this.layersDialog.style.backgroundColor="#000000",this.layersDialog.style.width="160px",this.layersDialog.style.padding="4px 2px 4px 2px",this.layersDialog.style.color="#ffffff",mxUtils.setOpacity(this.layersDialog,70),this.layersDialog.style.left=i.left+"px",this.layersDialog.style.bottom=parseInt(this.chromelessToolbar.style.bottom)+this.chromelessToolbar.offsetHeight+4+"px",r=mxUtils.getCurrentStyle(this.editor.graph.container),this.layersDialog.style.zIndex=r.zIndex,document.body.appendChild(this.layersDialog));mxEvent.consume(t)}),Editor.layersLargeImage,mxResources.get("layers")),a=n.getModel(),a.addListener(mxEvent.CHANGE,function(){b.style.display=a.getChildCount(a.root)>1?"":"none"}));this.addChromelessToolbarItems(i);this.editor.editButtonLink!=null&&i(mxUtils.bind(this,function(n){this.editor.editButtonLink=="_blank"?this.editor.editAsNew(this.getEditBlankXml()):window.open(this.editor.editButtonLink,"editWindow");mxEvent.consume(n)}),Editor.editLargeImage,mxResources.get("edit"));n.lightbox&&(urlParams.close=="1"||this.container!=document.body)&&i(mxUtils.bind(this,function(n){urlParams.close=="1"?window.close():(this.destroy(),mxEvent.consume(n))}),Editor.closeLargeImage,mxResources.get("close")+" (Escape)");this.chromelessToolbar.style.display="none";mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transform","translate(-50%,0)");n.container.appendChild(this.chromelessToolbar);mxEvent.addListener(n.container,mxClient.IS_POINTER?"pointermove":"mousemove",mxUtils.bind(this,function(n){mxEvent.isTouchEvent(n)||(mxEvent.isShiftDown(n)||e(30),l())}));mxEvent.addListener(this.chromelessToolbar,mxClient.IS_POINTER?"pointermove":"mousemove",function(n){mxEvent.consume(n)});mxEvent.addListener(this.chromelessToolbar,"mouseenter",mxUtils.bind(this,function(n){mxEvent.isShiftDown(n)?l():e(100)}));mxEvent.addListener(this.chromelessToolbar,"mousemove",mxUtils.bind(this,function(n){mxEvent.isShiftDown(n)?l():e(100);mxEvent.consume(n)}));mxEvent.addListener(this.chromelessToolbar,"mouseleave",mxUtils.bind(this,function(n){mxEvent.isTouchEvent(n)||e(30)}));o=n.getTolerance();n.addMouseListener({startX:0,startY:0,scrollLeft:0,scrollTop:0,mouseDown:function(t,i){this.startX=i.getGraphX();this.startY=i.getGraphY();this.scrollLeft=n.container.scrollLeft;this.scrollTop=n.container.scrollTop},mouseMove:function(){},mouseUp:function(t,i){mxEvent.isTouchEvent(i.getEvent())&&Math.abs(this.scrollLeft-n.container.scrollLeft)<o&&Math.abs(this.scrollTop-n.container.scrollTop)<o&&Math.abs(this.startX-i.getGraphX())<o&&Math.abs(this.startY-i.getGraphY())<o&&(parseFloat(v.chromelessToolbar.style.opacity||0)>0?l():e(30))}})}this.editor.editable||this.addChromelessClickHandler()}else this.editor.extendCanvas&&(d=n.view.validate,n.view.validate=function(){if(this.graph.container!=null&&mxUtils.hasScrollbars(this.graph.container)){var n=this.graph.getPagePadding(),t=this.graph.getPageSize(),i=this.translate.x,r=this.translate.y;this.translate.x=n.x-(this.x0||0)*t.width;this.translate.y=n.y-(this.y0||0)*t.height}d.apply(this,arguments)},g=n.sizeDidChange,n.sizeDidChange=function(){var u,f,h,c;if(this.container!=null&&mxUtils.hasScrollbars(this.container)){var t=this.getPageLayout(),i=this.getPagePadding(),r=this.getPageSize(),o=Math.ceil(2*i.x+t.width*r.width),s=Math.ceil(2*i.y+t.height*r.height),e=n.minimumGraphSize;if((e==null||e.width!=o||e.height!=s)&&(n.minimumGraphSize=new mxRectangle(0,0,o,s)),u=i.x-t.x*r.width,f=i.y-t.y*r.height,!this.autoTranslate&&(this.view.translate.x!=u||this.view.translate.y!=f)){this.autoTranslate=!0;this.view.x0=t.x;this.view.y0=t.y;h=n.view.translate.x;c=n.view.translate.y;n.view.setTranslate(u,f);n.container.scrollLeft+=Math.round((u-h)*n.view.scale);n.container.scrollTop+=Math.round((f-c)*n.view.scale);this.autoTranslate=!1;return}g.apply(this,arguments)}});n.updateZoomTimeout=null;n.cumulativeZoomFactor=1;s=null;n.lazyZoom=function(t){this.updateZoomTimeout!=null&&window.clearTimeout(this.updateZoomTimeout);t?this.view.scale*this.cumulativeZoomFactor<.15?this.cumulativeZoomFactor=(this.view.scale+.01)/this.view.scale:(this.cumulativeZoomFactor*=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale):this.view.scale*this.cumulativeZoomFactor<=.15?this.cumulativeZoomFactor=(this.view.scale-.01)/this.view.scale:(this.cumulativeZoomFactor/=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale);this.cumulativeZoomFactor=Math.max(.01,Math.min(this.view.scale*this.cumulativeZoomFactor,160)/this.view.scale);this.updateZoomTimeout=window.setTimeout(mxUtils.bind(this,function(){var r=mxUtils.getOffset(n.container),t=0,i=0,u,f;s!=null&&(t=n.container.offsetWidth/2-s.x+r.x,i=n.container.offsetHeight/2-s.y+r.y);u=this.view.scale;this.zoom(this.cumulativeZoomFactor);f=this.view.scale;f!=u&&(h!=null&&v.chromelessResize(!1,null,t*(this.cumulativeZoomFactor-1),i*(this.cumulativeZoomFactor-1)),mxUtils.hasScrollbars(n.container)&&(t!=0||i!=0)&&(n.container.scrollLeft-=t*(this.cumulativeZoomFactor-1),n.container.scrollTop-=i*(this.cumulativeZoomFactor-1)));this.cumulativeZoomFactor=1;this.updateZoomTimeout=null}),20)};mxEvent.addMouseWheelListener(mxUtils.bind(this,function(t,i){if((mxEvent.isAltDown(t)||mxEvent.isControlDown(t)&&!mxClient.IS_MAC||n.panningHandler.isActive())&&(this.dialogs==null||this.dialogs.length==0))for(var r=mxEvent.getSource(t);r!=null;){if(r==n.container){s=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t));n.lazyZoom(i);mxEvent.consume(t);return}r=r.parentNode}}))};EditorUi.prototype.addChromelessToolbarItems=function(n){n(mxUtils.bind(this,function(n){this.actions.get("print").funct();mxEvent.consume(n)}),Editor.printLargeImage,mxResources.get("print"))};EditorUi.prototype.createTemporaryGraph=function(n){var t=new Graph(document.createElement("div"),null,null,n);return t.resetViewOnRootChange=!1,t.setConnectable(!1),t.gridEnabled=!1,t.autoScroll=!1,t.setTooltips(!1),t.setEnabled(!1),t.container.style.visibility="hidden",t.container.style.position="absolute",t.container.style.overflow="hidden",t.container.style.height="1px",t.container.style.width="1px",t};EditorUi.prototype.addChromelessClickHandler=function(){var n=urlParams.highlight;n!=null&&n.length>0&&(n="#"+n);this.editor.graph.addClickHandler(n)};EditorUi.prototype.toggleFormatPanel=function(n){this.formatWidth=n||this.formatWidth>0?0:240;this.formatContainer.style.display=n||this.formatWidth>0?"":"none";this.refresh();this.format.refresh();this.fireEvent(new mxEventObject("formatWidthChanged"))};EditorUi.prototype.lightboxFit=function(n){if(this.isDiagramEmpty())this.editor.graph.view.setScale(1);else{var t=urlParams.border,i=60;t!=null&&(i=parseInt(t));this.editor.graph.maxFitScale=this.lightboxMaxFitScale;this.editor.graph.fit(i,null,null,null,null,null,n);this.editor.graph.maxFitScale=null}};EditorUi.prototype.isDiagramEmpty=function(){var n=this.editor.graph.getModel();return n.getChildCount(n.root)==1&&n.getChildCount(n.getChildAt(n.root,0))==0};EditorUi.prototype.isSelectionAllowed=function(n){return mxEvent.getSource(n).nodeName=="SELECT"||mxEvent.getSource(n).nodeName=="INPUT"&&mxUtils.isAncestorNode(this.formatContainer,mxEvent.getSource(n))};EditorUi.prototype.addBeforeUnloadListener=function(){window.onbeforeunload=mxUtils.bind(this,function(){if(!this.editor.chromeless)return this.onBeforeUnload()})};EditorUi.prototype.onBeforeUnload=function(){if(this.editor.modified)return mxResources.get("allChangesLost")};EditorUi.prototype.open=function(){try{window.opener!=null&&window.opener.openFile!=null&&window.opener.openFile.setConsumer(mxUtils.bind(this,function(n,t){try{var i=mxUtils.parseXml(n);this.editor.setGraphXml(i.documentElement);this.editor.setModified(!1);this.editor.undoManager.clear();t!=null&&(this.editor.setFilename(t),this.updateDocumentTitle());return}catch(r){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+r.message)}}))}catch(n){}this.editor.graph.view.validate();this.editor.graph.sizeDidChange();this.editor.fireEvent(new mxEventObject("resetGraphView"))};EditorUi.prototype.setCurrentMenu=function(n,t){this.currentMenuElt=t;this.currentMenu=n};EditorUi.prototype.resetCurrentMenu=function(){this.currentMenuElt=null;this.currentMenu=null};EditorUi.prototype.hideCurrentMenu=function(){this.currentMenu!=null&&(this.currentMenu.hideMenu(),this.resetCurrentMenu())};EditorUi.prototype.updateDocumentTitle=function(){var n=this.editor.getOrCreateFilename();this.editor.appName!=null&&(n+=" - "+this.editor.appName);document.title=n};EditorUi.prototype.createHoverIcons=function(){return new HoverIcons(this.editor.graph)};EditorUi.prototype.redo=function(){try{var n=this.editor.graph;n.isEditing()?document.execCommand("redo",!1,null):this.editor.undoManager.redo()}catch(t){}};EditorUi.prototype.undo=function(){var n,t;try{n=this.editor.graph;n.isEditing()?(t=n.cellEditor.textarea.innerHTML,document.execCommand("undo",!1,null),t==n.cellEditor.textarea.innerHTML&&(n.stopEditing(!0),this.editor.undoManager.undo())):this.editor.undoManager.undo()}catch(i){}};EditorUi.prototype.canRedo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canRedo()};EditorUi.prototype.canUndo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canUndo()};EditorUi.prototype.getEditBlankXml=function(){return mxUtils.getXml(this.editor.getGraphXml())};EditorUi.prototype.getUrl=function(n){var t=n!=null?n:window.location.pathname,i=t.indexOf("?")>0?1:0;for(var r in urlParams)t+=i==0?"?":"&",t+=r+"="+urlParams[r],i++;return t};EditorUi.prototype.setScrollbars=function(n){var t=this.editor.graph,f=t.container.style.overflow,i,r,u;t.scrollbars=n;this.editor.updateGraphComponents();f!=t.container.style.overflow&&(t.container.style.overflow=="hidden"?(i=t.view.translate,t.view.setTranslate(i.x-t.container.scrollLeft/t.view.scale,i.y-t.container.scrollTop/t.view.scale),t.container.scrollLeft=0,t.container.scrollTop=0,t.minimumGraphSize=null,t.sizeDidChange()):(r=t.view.translate.x,u=t.view.translate.y,t.view.translate.x=0,t.view.translate.y=0,t.sizeDidChange(),t.container.scrollLeft-=Math.round(r*t.view.scale),t.container.scrollTop-=Math.round(u*t.view.scale)));this.fireEvent(new mxEventObject("scrollbarsChanged"))};EditorUi.prototype.hasScrollbars=function(){return this.editor.graph.scrollbars};EditorUi.prototype.resetScrollbars=function(){var n=this.editor.graph,r,i,t;if(this.editor.extendCanvas){if(!this.editor.chromeless)if(mxUtils.hasScrollbars(n.container))if(n.pageVisible)r=n.getPagePadding(),n.container.scrollTop=Math.floor(r.y-this.editor.initialTopSpacing),n.container.scrollLeft=Math.floor(Math.min(r.x,(n.container.scrollWidth-n.container.clientWidth)/2)),t=n.getGraphBounds(),t.width>0&&t.height>0&&(t.x>n.container.scrollLeft+n.container.clientWidth*.9&&(n.container.scrollLeft=Math.min(t.x+t.width-n.container.clientWidth,t.x-10)),t.y>n.container.scrollTop+n.container.clientHeight*.9&&(n.container.scrollTop=Math.min(t.y+t.height-n.container.clientHeight,t.y-10)));else{var t=n.getGraphBounds(),u=Math.max(t.width,n.scrollTileSize.width*n.view.scale),f=Math.max(t.height,n.scrollTileSize.height*n.view.scale);n.container.scrollTop=Math.floor(Math.max(0,t.y-Math.max(20,(n.container.clientHeight-f)/4)));n.container.scrollLeft=Math.floor(Math.max(0,t.x-Math.max(0,(n.container.clientWidth-u)/2)))}else n.pageVisible?(i=n.view.getBackgroundPageBounds(),n.view.setTranslate(Math.floor(Math.max(0,(n.container.clientWidth-i.width)/2)-i.x),Math.floor(Math.max(0,(n.container.clientHeight-i.height)/2)-i.y))):(t=n.getGraphBounds(),n.view.setTranslate(Math.floor(Math.max(0,Math.max(0,(n.container.clientWidth-t.width)/2)-t.x)),Math.floor(Math.max(0,Math.max(20,(n.container.clientHeight-t.height)/4))-t.y)))}else n.container.scrollTop=0,n.container.scrollLeft=0,mxUtils.hasScrollbars(n.container)||n.view.setTranslate(0,0)};EditorUi.prototype.setPageVisible=function(n){var t=this.editor.graph,i=mxUtils.hasScrollbars(t.container),r=0,u=0,f;i&&(r=t.view.translate.x*t.view.scale-t.container.scrollLeft,u=t.view.translate.y*t.view.scale-t.container.scrollTop);t.pageVisible=n;t.pageBreaksVisible=n;t.preferPageSize=n;t.view.validateBackground();i&&(f=t.getSelectionCells(),t.clearSelection(),t.setSelectionCells(f));t.sizeDidChange();i&&(t.container.scrollLeft=t.view.translate.x*t.view.scale-r,t.container.scrollTop=t.view.translate.y*t.view.scale-u);this.fireEvent(new mxEventObject("pageViewChanged"))};ChangePageSetup.prototype.execute=function(){var t=this.ui.editor.graph,n;this.ignoreColor||(this.color=this.previousColor,n=t.background,this.ui.setBackgroundColor(this.previousColor),this.previousColor=n);this.ignoreImage||(this.image=this.previousImage,n=t.backgroundImage,this.ui.setBackgroundImage(this.previousImage),this.previousImage=n);this.previousFormat!=null&&(this.format=this.previousFormat,n=t.pageFormat,(this.previousFormat.width!=n.width||this.previousFormat.height!=n.height)&&(this.ui.setPageFormat(this.previousFormat),this.previousFormat=n));this.foldingEnabled!=null&&this.foldingEnabled!=this.ui.editor.graph.foldingEnabled&&(this.ui.setFoldingEnabled(this.foldingEnabled),this.foldingEnabled=!this.foldingEnabled)},function(){var n=new mxObjectCodec(new ChangePageSetup,["ui","previousColor","previousImage","previousFormat"]);n.afterDecode=function(n,t,i){return i.previousColor=i.color,i.previousImage=i.image,i.previousFormat=i.format,i.foldingEnabled!=null&&(i.foldingEnabled=!i.foldingEnabled),i};mxCodecRegistry.register(n)}();EditorUi.prototype.setBackgroundColor=function(n){this.editor.graph.background=n;this.editor.graph.view.validateBackground();this.fireEvent(new mxEventObject("backgroundColorChanged"))};EditorUi.prototype.setFoldingEnabled=function(n){this.editor.graph.foldingEnabled=n;this.editor.graph.view.revalidate();this.fireEvent(new mxEventObject("foldingEnabledChanged"))};EditorUi.prototype.setPageFormat=function(n){this.editor.graph.pageFormat=n;this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct();this.fireEvent(new mxEventObject("pageFormatChanged"))};EditorUi.prototype.setPageScale=function(n){this.editor.graph.pageScale=n;this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct();this.fireEvent(new mxEventObject("pageScaleChanged"))};EditorUi.prototype.setGridColor=function(n){this.editor.graph.view.gridColor=n;this.editor.graph.view.validateBackground();this.fireEvent(new mxEventObject("gridColorChanged"))};EditorUi.prototype.addUndoListener=function(){var u=this.actions.get("undo"),f=this.actions.get("redo"),t=this.editor.undoManager,n=mxUtils.bind(this,function(){u.setEnabled(this.canUndo());f.setEnabled(this.canRedo())}),i,r;t.addListener(mxEvent.ADD,n);t.addListener(mxEvent.UNDO,n);t.addListener(mxEvent.REDO,n);t.addListener(mxEvent.CLEAR,n);i=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){i.apply(this,arguments);n()};r=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(){r.apply(this,arguments);n()};n()};EditorUi.prototype.updateActionStates=function(){var n=this.editor.graph,c=!n.isSelectionEmpty(),t=!1,f=!1,e=n.getSelectionCells(),o,s,r,u,l,h,i;if(e!=null)for(r=0;r<e.length;r++)if(o=e[r],n.getModel().isEdge(o)&&(f=!0),n.getModel().isVertex(o)&&(t=!0),f&&t)break;for(s=["cut","copy","bold","italic","underline","delete","duplicate","editStyle","editTooltip","editLink","backgroundColor","borderColor","edit","toFront","toBack","lockUnlock","solid","dashed","dotted","fillColor","gradientColor","shadow","fontColor","formattedText","rounded","toggleRounded","sharp","strokeColor"],r=0;r<s.length;r++)this.actions.get(s[r]).setEnabled(c);this.actions.get("setAsDefaultStyle").setEnabled(n.getSelectionCount()==1);this.actions.get("clearWaypoints").setEnabled(!n.isSelectionEmpty());this.actions.get("turn").setEnabled(!n.isSelectionEmpty());this.actions.get("curved").setEnabled(f);this.actions.get("rotation").setEnabled(t);this.actions.get("wordWrap").setEnabled(t);this.actions.get("autosize").setEnabled(t);u=t&&n.getSelectionCount()==1;this.actions.get("group").setEnabled(n.getSelectionCount()>1||u&&!n.isContainer(n.getSelectionCell()));this.actions.get("ungroup").setEnabled(n.getSelectionCount()==1&&(n.getModel().getChildCount(n.getSelectionCell())>0||u&&n.isContainer(n.getSelectionCell())));this.actions.get("removeFromGroup").setEnabled(u&&n.getModel().isVertex(n.getModel().getParent(n.getSelectionCell())));l=n.view.getState(n.getSelectionCell());this.menus.get("navigation").setEnabled(c||n.view.currentRoot!=null);this.actions.get("collapsible").setEnabled(t&&(n.isContainer(n.getSelectionCell())||n.model.getChildCount(n.getSelectionCell())>0));this.actions.get("home").setEnabled(n.view.currentRoot!=null);this.actions.get("exitGroup").setEnabled(n.view.currentRoot!=null);this.actions.get("enterGroup").setEnabled(n.getSelectionCount()==1&&n.isValidRoot(n.getSelectionCell()));h=n.getSelectionCount()==1&&n.isCellFoldable(n.getSelectionCell());this.actions.get("expand").setEnabled(h);this.actions.get("collapse").setEnabled(h);this.actions.get("editLink").setEnabled(n.getSelectionCount()==1);this.actions.get("openLink").setEnabled(n.getSelectionCount()==1&&n.getLinkForCell(n.getSelectionCell())!=null);this.actions.get("guides").setEnabled(n.isEnabled());this.actions.get("grid").setEnabled(!this.editor.chromeless||this.editor.editable);i=n.isEnabled()&&!n.isCellLocked(n.getDefaultParent());this.menus.get("layout").setEnabled(i);this.menus.get("insert").setEnabled(i);this.menus.get("direction").setEnabled(i&&t);this.menus.get("align").setEnabled(i&&t&&n.getSelectionCount()>1);this.menus.get("distribute").setEnabled(i&&t&&n.getSelectionCount()>1);this.actions.get("selectVertices").setEnabled(i);this.actions.get("selectEdges").setEnabled(i);this.actions.get("selectAll").setEnabled(i);this.actions.get("selectNone").setEnabled(i);this.updatePasteActionStates()};EditorUi.prototype.refresh=function(n){var t,r,i,f,h,o,c,s,l;n=n!=null?n:!0;var a=mxClient.IS_IE&&(document.documentMode==null||document.documentMode==5),u=this.container.clientWidth,e=this.container.clientHeight;this.container==document.body&&(u=document.body.clientWidth||document.documentElement.clientWidth,e=a?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight);t=0;mxClient.IS_IOS&&!window.navigator.standalone&&window.innerHeight!=document.documentElement.clientHeight&&(t=document.documentElement.clientHeight-window.innerHeight,window.scrollTo(0,0));r=Math.max(0,Math.min(this.hsplitPosition,u-this.splitSize-20));i=0;this.menubar!=null&&(this.menubarContainer.style.height=this.menubarHeight+"px",i+=this.menubarHeight);this.toolbar!=null&&(this.toolbarContainer.style.top=this.menubarHeight+"px",this.toolbarContainer.style.height=this.toolbarHeight+"px",i+=this.toolbarHeight);i>0&&!mxClient.IS_QUIRKS&&(i+=1);f=0;this.sidebarFooterContainer!=null&&(h=this.footerHeight+t,f=Math.max(0,Math.min(e-i-h,this.sidebarFooterHeight)),this.sidebarFooterContainer.style.width=r+"px",this.sidebarFooterContainer.style.height=f+"px",this.sidebarFooterContainer.style.bottom=h+"px");o=this.format!=null?this.formatWidth:0;this.sidebarContainer.style.top=i+"px";this.sidebarContainer.style.width=r+"px";this.formatContainer.style.top=i+"px";this.formatContainer.style.width=o+"px";this.formatContainer.style.display=this.format!=null?"":"none";this.diagramContainer.style.left=this.hsplit.parentNode!=null?r+this.splitSize+"px":"0px";this.diagramContainer.style.top=this.sidebarContainer.style.top;this.footerContainer.style.height=this.footerHeight+"px";this.hsplit.style.top=this.sidebarContainer.style.top;this.hsplit.style.bottom=this.footerHeight+t+"px";this.hsplit.style.left=r+"px";this.tabContainer!=null&&(this.tabContainer.style.left=this.diagramContainer.style.left);a?(this.menubarContainer.style.width=u+"px",this.toolbarContainer.style.width=this.menubarContainer.style.width,c=Math.max(0,e-this.footerHeight-this.menubarHeight-this.toolbarHeight),this.sidebarContainer.style.height=c-f+"px",this.formatContainer.style.height=c+"px",this.diagramContainer.style.width=this.hsplit.parentNode!=null?Math.max(0,u-r-this.splitSize-o)+"px":u+"px",this.footerContainer.style.width=this.menubarContainer.style.width,s=Math.max(0,e-this.footerHeight-this.menubarHeight-this.toolbarHeight),this.tabContainer!=null&&(this.tabContainer.style.width=this.diagramContainer.style.width,this.tabContainer.style.bottom=this.footerHeight+t+"px",s-=this.tabContainer.clientHeight),this.diagramContainer.style.height=s+"px",this.hsplit.style.height=s+"px"):(this.footerHeight>0&&(this.footerContainer.style.bottom=t+"px"),this.diagramContainer.style.right=o+"px",l=0,this.tabContainer!=null&&(this.tabContainer.style.bottom=this.footerHeight+t+"px",this.tabContainer.style.right=this.diagramContainer.style.right,l=this.tabContainer.clientHeight),this.sidebarContainer.style.bottom=this.footerHeight+f+t+"px",this.formatContainer.style.bottom=this.footerHeight+t+"px",this.diagramContainer.style.bottom=this.footerHeight+t+l+"px");n&&this.editor.graph.sizeDidChange()};EditorUi.prototype.createTabContainer=function(){return null};EditorUi.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer");this.toolbarContainer=this.createDiv("geToolbarContainer");this.sidebarContainer=this.createDiv("geSidebarContainer");this.formatContainer=this.createDiv("geSidebarContainer geFormatContainer");this.diagramContainer=this.createDiv("geDiagramContainer");this.footerContainer=this.createDiv("geFooterContainer");this.hsplit=this.createDiv("geHsplit");this.hsplit.setAttribute("title",mxResources.get("collapseExpand"));this.menubarContainer.style.top="0px";this.menubarContainer.style.left="0px";this.menubarContainer.style.right="0px";this.toolbarContainer.style.left="0px";this.toolbarContainer.style.right="0px";this.sidebarContainer.style.left="0px";this.formatContainer.style.right="0px";this.formatContainer.style.zIndex="1";this.diagramContainer.style.right=(this.format!=null?this.formatWidth:0)+"px";this.footerContainer.style.left="0px";this.footerContainer.style.right="0px";this.footerContainer.style.bottom="0px";this.footerContainer.style.zIndex=mxPopupMenu.prototype.zIndex-2;this.hsplit.style.width=this.splitSize+"px";this.sidebarFooterContainer=this.createSidebarFooterContainer();this.sidebarFooterContainer&&(this.sidebarFooterContainer.style.left="0px");this.editor.chromeless||(this.tabContainer=this.createTabContainer())};EditorUi.prototype.createSidebarFooterContainer=function(){return null};EditorUi.prototype.createUi=function(){this.menubar=this.editor.chromeless?null:this.menus.createMenubar(this.createDiv("geMenubar"));this.menubar!=null&&this.menubarContainer.appendChild(this.menubar.container);this.menubar!=null&&(this.statusContainer=this.createStatusContainer(),this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())})),this.setStatusText(this.editor.getStatus()),this.menubar.container.appendChild(this.statusContainer),this.container.appendChild(this.menubarContainer));this.sidebar=this.editor.chromeless?null:this.createSidebar(this.sidebarContainer);this.sidebar!=null&&this.container.appendChild(this.sidebarContainer);this.format=this.editor.chromeless||!this.formatEnabled?null:this.createFormat(this.formatContainer);this.format!=null&&this.container.appendChild(this.formatContainer);var n=this.editor.chromeless?null:this.createFooter();n!=null&&(this.footerContainer.appendChild(n),this.container.appendChild(this.footerContainer));this.sidebar!=null&&this.sidebarFooterContainer&&this.container.appendChild(this.sidebarFooterContainer);this.container.appendChild(this.diagramContainer);this.container!=null&&this.tabContainer!=null&&this.container.appendChild(this.tabContainer);this.toolbar=this.editor.chromeless?null:this.createToolbar(this.createDiv("geToolbar"));this.toolbar!=null&&(this.toolbarContainer.appendChild(this.toolbar.container),this.container.appendChild(this.toolbarContainer));this.sidebar!=null&&(this.container.appendChild(this.hsplit),this.addSplitHandler(this.hsplit,!0,0,mxUtils.bind(this,function(n){this.hsplitPosition=n;this.refresh()})))};EditorUi.prototype.createStatusContainer=function(){var n=document.createElement("a");return n.className="geItem geStatus",screen.width<420&&(n.style.maxWidth=Math.max(20,screen.width-320)+"px",n.style.overflow="hidden"),n};EditorUi.prototype.setStatusText=function(n){this.statusContainer.innerHTML=n};EditorUi.prototype.createToolbar=function(n){return new Toolbar(this,n)};EditorUi.prototype.createSidebar=function(n){return new Sidebar(this,n)};EditorUi.prototype.createFormat=function(n){return new Format(this,n)};EditorUi.prototype.createFooter=function(){return this.createDiv("geFooter")};EditorUi.prototype.createDiv=function(n){var t=document.createElement("div");return t.className=n,t};EditorUi.prototype.addSplitHandler=function(n,t,i,r){function h(n){if(u!=null){var h=new mxPoint(mxEvent.getClientX(n),mxEvent.getClientY(n));r(Math.max(0,f+(t?h.x-u.x:u.y-h.y)-i));mxEvent.consume(n);f!=o()&&(s=!0,e=null)}}function c(n){h(n);f=null;u=null}var u=null,f=null,s=!0,e=null,o;mxClient.IS_POINTER&&(n.style.touchAction="none");o=mxUtils.bind(this,function(){var r=parseInt(t?n.style.left:n.style.bottom);return t||(r=r+i-this.footerHeight),r});mxEvent.addGestureListeners(n,function(n){u=new mxPoint(mxEvent.getClientX(n),mxEvent.getClientY(n));f=o();s=!1;mxEvent.consume(n)});mxEvent.addListener(n,"click",function(n){if(!s){var t=e!=null?e-i:0;e=o();r(t);mxEvent.consume(n)}});mxEvent.addGestureListeners(document,null,h,c);this.destroyFunctions.push(function(){mxEvent.removeGestureListeners(document,null,h,c)})};EditorUi.prototype.showDialog=function(n,t,i,r,u,f,e){this.editor.graph.tooltipHandler.hideTooltip();this.dialogs==null&&(this.dialogs=[]);this.dialog=new Dialog(this,n,t,i,r,u,f,e);this.dialogs.push(this.dialog)};EditorUi.prototype.hideDialog=function(n){if(this.dialogs!=null&&this.dialogs.length>0){var t=this.dialogs.pop();t.close(n);this.dialog=this.dialogs.length>0?this.dialogs[this.dialogs.length-1]:null;this.dialog==null&&this.editor.graph.container.style.visibility!="hidden"&&this.editor.graph.container.focus();this.editor.fireEvent(new mxEventObject("hideDialog"))}};EditorUi.prototype.pickColor=function(n,t){var i=this.editor.graph,r=i.cellEditor.saveSelection(),u=new ColorDialog(this,n||"none",function(n){i.cellEditor.restoreSelection(r);t(n)},function(){i.cellEditor.restoreSelection(r)});this.showDialog(u.container,230,430,!0,!1);u.init()};EditorUi.prototype.openFile=function(){window.openFile=new OpenFile(mxUtils.bind(this,function(n){this.hideDialog(n)}));this.showDialog(new OpenDialog(this).container,Editor.useLocalStorage?640:320,Editor.useLocalStorage?480:220,!0,!0,function(){window.openFile=null})};EditorUi.prototype.extractGraphModelFromHtml=function(n){var r=null,t,i;try{t=n.indexOf("&lt;mxGraphModel ");t>=0&&(i=n.lastIndexOf("&lt;/mxGraphModel&gt;"),i>t&&(r=n.substring(t,i+21).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/\\&quot;/g,'"').replace(/\n/g,"")))}catch(u){}return r};EditorUi.prototype.extractGraphModelFromEvent=function(n){var u=null,t=null,i,r;return n!=null&&(i=n.dataTransfer!=null?n.dataTransfer:n.clipboardData,i!=null&&(document.documentMode==10||document.documentMode==11?t=i.getData("Text"):(t=mxUtils.indexOf(i.types,"text/html")>=0?i.getData("text/html"):null,mxUtils.indexOf(i.types,"text/plain"&&(t==null||t.length==0))&&(t=i.getData("text/plain"))),t!=null&&(t=this.editor.graph.zapGremlins(mxUtils.trim(t)),r=this.extractGraphModelFromHtml(t),r!=null&&(t=r)))),t!=null&&this.isCompatibleString(t)&&(u=t),u};EditorUi.prototype.isCompatibleString=function(){return!1};EditorUi.prototype.saveFile=function(n){if(n){var t=new FilenameDialog(this,this.editor.getOrCreateFilename(),mxResources.get("save"),mxUtils.bind(this,function(n){this.save(n)}),null,mxUtils.bind(this,function(n){return n!=null&&n.length>0?!0:(mxUtils.confirm(mxResources.get("invalidName")),!1)}));this.showDialog(t.container,300,100,!0,!0);t.init()}else this.save(null)};EditorUi.prototype.save=function(n){var t=mxUtils.getXml(this.editor.getGraphXml());if(n==null){this.editor.graph.isEditing()&&this.editor.graph.stopEditing();try{if(Editor.useLocalStorage){if(localStorage.getItem(n)!=null&&!mxUtils.confirm(mxResources.get("replaceIt",[n])))return;localStorage.setItem(n,t);this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("saved"))+" "+new Date)}else{if(this.validateWrokflowDiagram()==!1)return;t=encodeURIComponent(t);mxUtils.post(SAVE_URL,"filename="+encodeURIComponent(n)+"&xml="+encodeURIComponent(t),function(n){var t=JSON.parse(n.getText());t.success?mxUtils.alert(mxResources.get("saved")):mxUtils.alert(t.msg)})}this.editor.setModified(!1)}catch(i){this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("errorSavingFile")))}}else if(t.length<MAX_REQUEST_SIZE)new mxXmlRequest(SAVEAS_URL,"filename="+encodeURIComponent(n)+"&xml="+encodeURIComponent(t)).simulate(document,"_blank");else{mxUtils.alert(mxResources.get("drawingTooLarge"));mxUtils.popup(t);return}};EditorUi.prototype.validateWrokflowDiagram=function(){let r=this.editor.graph;var n=r.getModel().cells;let t=_.filter(_.values(n),function(n){return n.getAttribute("nodeType")=="0"}).length;if(t>1)return layer.alert("开始节点只能存在一个，请删除多余的开始节点"),!1;if(t<1)return layer.alert("必须存在一个开始节点"),!1;let i=_.filter(_.values(n),function(n){return n.getAttribute("nodeType")=="99"}).length;return i>1?(layer.alert("结束节点只能存在一个，请删除多余的结束节点"),!1):i<1?(layer.alert("必须存在一个结束节点"),!1):!0};EditorUi.prototype.executeLayout=function(n,t,i){var r=this.editor.graph,u;if(r.isEnabled()){r.getModel().beginUpdate();try{n()}catch(f){throw f;}finally{this.allowAnimation&&t&&navigator.userAgent.indexOf("Camino")<0?(u=new mxMorphing(r),u.addListener(mxEvent.DONE,mxUtils.bind(this,function(){r.getModel().endUpdate();i!=null&&i()})),u.startAnimation()):(r.getModel().endUpdate(),i!=null&&i())}}};EditorUi.prototype.showImageDialog=function(n,t,i){var f=this.editor.graph.cellEditor,e=f.saveSelection(),u=mxUtils.prompt(n,t),r;f.restoreSelection(e);u!=null&&u.length>0?(r=new Image,r.onload=function(){i(u,r.width,r.height)},r.onerror=function(){i(null);mxUtils.alert(mxResources.get("fileNotFound"))},r.src=u):i(null)};EditorUi.prototype.showLinkDialog=function(n,t,i){var r=new LinkDialog(this,n,t,i);this.showDialog(r.container,420,90,!0,!0);r.init()};EditorUi.prototype.showBackgroundImageDialog=function(n){var i,t;n=n!=null?n:mxUtils.bind(this,function(n){var t=new ChangePageSetup(this,null,n);t.ignoreColor=!0;this.editor.graph.model.execute(t)});i=mxUtils.prompt(mxResources.get("backgroundImage"),"");i!=null&&i.length>0?(t=new Image,t.onload=function(){n(new mxImage(i,t.width,t.height))},t.onerror=function(){n(null);mxUtils.alert(mxResources.get("fileNotFound"))},t.src=i):n(null)};EditorUi.prototype.setBackgroundImage=function(n){this.editor.graph.setBackgroundImage(n);this.editor.graph.view.validateBackgroundImage();this.fireEvent(new mxEventObject("backgroundImageChanged"))};EditorUi.prototype.confirm=function(n,t,i){mxUtils.confirm(n)?t!=null&&t():i!=null&&i()};EditorUi.prototype.createOutline=function(){var n=new mxOutline(this.editor.graph);return n.border=20,mxEvent.addListener(window,"resize",function(){n.update()}),this.addListener("pageFormatChanged",function(){n.update()}),n};EditorUi.prototype.createKeyHandler=function(){function f(n,u,f){i.push(function(){var e,r,i,a,h,c;if(!t.isSelectionEmpty()&&t.isEnabled())if(u=u!=null?u:1,f){t.getModel().beginUpdate();try{for(e=t.getSelectionCells(),r=0;r<e.length;r++)t.getModel().isVertex(e[r])&&t.isCellResizable(e[r])&&(i=t.getCellGeometry(e[r]),i!=null&&(i=i.clone(),n==37?i.width=Math.max(0,i.width-u):n==38?i.height=Math.max(0,i.height-u):n==39?i.width+=u:n==40&&(i.height+=u),t.getModel().setGeometry(e[r],i)))}finally{t.getModel().endUpdate()}}else{var o=t.getSelectionCell(),s=t.model.getParent(o),l=null;t.getSelectionCount()==1&&t.model.isVertex(o)&&t.layoutManager!=null&&!t.isCellLocked(o)&&(l=t.layoutManager.getLayout(s));l!=null&&l.constructor==mxStackLayout?(a=s.getIndex(o),n==37||n==38?t.model.add(s,o,Math.max(0,a-1)):(n==39||n==40)&&t.model.add(s,o,Math.min(t.model.getChildCount(s),a+1))):(h=0,c=0,n==37?h=-u:n==38?c=-u:n==39?h=u:n==40&&(c=u),t.moveCells(t.getMovableCells(t.getSelectionCells()),h,c))}});r!=null&&window.clearTimeout(r);r=window.setTimeout(function(){if(i.length>0){t.getModel().beginUpdate();try{for(var n=0;n<i.length;n++)i[n]();i=[]}finally{t.getModel().endUpdate()}t.scrollCellToVisible(t.getSelectionCell())}},200)}var u=this,t=this.editor.graph,n=new mxKeyHandler(t),s=n.isEventIgnored,i,r,l,o;n.isEventIgnored=function(n){return(!this.isControlDown(n)||mxEvent.isShiftDown(n)||n.keyCode!=90&&n.keyCode!=89&&n.keyCode!=188&&n.keyCode!=190&&n.keyCode!=85)&&(n.keyCode!=66&&n.keyCode!=73||!this.isControlDown(n)||this.graph.cellEditor.isContentEditing()&&!mxClient.IS_FF&&!mxClient.IS_SF)&&s.apply(this,arguments)};n.isEnabledForEvent=function(n){return!mxEvent.isConsumed(n)&&this.isGraphEvent(n)&&this.isEnabled()};n.isControlDown=function(n){return mxEvent.isControlDown(n)||mxClient.IS_MAC&&n.metaKey};i=[];r=null;var e={37:mxConstants.DIRECTION_WEST,38:mxConstants.DIRECTION_NORTH,39:mxConstants.DIRECTION_EAST,40:mxConstants.DIRECTION_SOUTH},h=n.getFunction,c={67:this.actions.get("clearWaypoints"),65:this.actions.get("connectionArrows"),80:this.actions.get("connectionPoints")};return mxKeyHandler.prototype.getFunction=function(n){if(t.isEnabled()){if(mxEvent.isShiftDown(n)&&mxEvent.isAltDown(n)){var i=c[n.keyCode];if(i!=null)return i.funct}if(n.keyCode==9&&mxEvent.isAltDown(n))return mxEvent.isShiftDown(n)?function(){t.selectParentCell()}:function(){t.selectChildCell()};if(e[n.keyCode]!=null&&!t.isSelectionEmpty())if(mxEvent.isShiftDown(n)&&mxEvent.isAltDown(n)){if(t.model.isVertex(t.getSelectionCell()))return function(){var i=t.connectVertex(t.getSelectionCell(),e[n.keyCode],t.defaultEdgeLength,n,!0);i!=null&&i.length>0&&(i.length==1&&t.model.isEdge(i[0])?t.setSelectionCell(t.model.getTerminal(i[0],!1)):t.setSelectionCell(i[i.length-1]),t.scrollCellToVisible(t.getSelectionCell()),u.hoverIcons!=null&&u.hoverIcons.update(t.view.getState(t.getSelectionCell())))}}else return this.isControlDown(n)?function(){f(n.keyCode,mxEvent.isShiftDown(n)?t.gridSize:null,!0)}:function(){f(n.keyCode,mxEvent.isShiftDown(n)?t.gridSize:null)}}return h.apply(this,arguments)},n.bindAction=mxUtils.bind(this,function(t,i,r,u){var e=this.actions.get(r),f;e!=null&&(f=function(){e.isEnabled()&&e.funct()},i?u?n.bindControlShiftKey(t,f):n.bindControlKey(t,f):u?n.bindShiftKey(t,f):n.bindKey(t,f))}),l=this,o=n.escape,n.escape=function(){o.apply(this,arguments)},n.enter=function(){},n.bindControlShiftKey(36,function(){t.exitGroup()}),n.bindControlShiftKey(35,function(){t.enterGroup()}),n.bindKey(36,function(){t.home()}),n.bindKey(35,function(){t.refresh()}),n.bindAction(107,!0,"zoomIn"),n.bindAction(109,!0,"zoomOut"),n.bindAction(80,!0,"print"),n.bindAction(79,!0,"outline",!0),n.bindAction(112,!1,"about"),(!this.editor.chromeless||this.editor.editable)&&(n.bindControlKey(36,function(){t.isEnabled()&&t.foldCells(!0)}),n.bindControlKey(35,function(){t.isEnabled()&&t.foldCells(!1)}),n.bindControlKey(13,function(){t.isEnabled()&&t.setSelectionCells(t.duplicateCells(t.getSelectionCells(),!1))}),n.bindAction(8,!1,"delete"),n.bindAction(8,!0,"deleteAll"),n.bindAction(46,!1,"delete"),n.bindAction(46,!0,"deleteAll"),n.bindAction(72,!0,"resetView"),n.bindAction(72,!0,"fitWindow",!0),n.bindAction(74,!0,"fitPage"),n.bindAction(74,!0,"fitTwoPages",!0),n.bindAction(48,!0,"customZoom"),n.bindAction(82,!0,"turn"),n.bindAction(82,!0,"clearDefaultStyle",!0),n.bindAction(83,!0,"save"),n.bindAction(83,!0,"saveAs",!0),n.bindAction(65,!0,"selectAll"),n.bindAction(65,!0,"selectNone",!0),n.bindAction(73,!0,"selectVertices",!0),n.bindAction(69,!0,"selectEdges",!0),n.bindAction(69,!0,"editStyle"),n.bindAction(66,!0,"bold"),n.bindAction(66,!0,"toBack",!0),n.bindAction(70,!0,"toFront",!0),n.bindAction(68,!0,"duplicate"),n.bindAction(68,!0,"setAsDefaultStyle",!0),n.bindAction(90,!0,"undo"),n.bindAction(89,!0,"autosize",!0),n.bindAction(88,!0,"cut"),n.bindAction(67,!0,"copy"),n.bindAction(86,!0,"paste"),n.bindAction(71,!0,"group"),n.bindAction(77,!0,"editData"),n.bindAction(71,!0,"grid",!0),n.bindAction(73,!0,"italic"),n.bindAction(76,!0,"lockUnlock"),n.bindAction(76,!0,"layers",!0),n.bindAction(80,!0,"formatPanel",!0),n.bindAction(85,!0,"underline"),n.bindAction(85,!0,"ungroup",!0),n.bindAction(190,!0,"superscript"),n.bindAction(188,!0,"subscript"),n.bindKey(13,function(){t.isEnabled()&&t.startEditingAtCell()}),n.bindKey(113,function(){t.isEnabled()&&t.startEditingAtCell()})),mxClient.IS_WIN?n.bindAction(89,!0,"redo"):n.bindAction(90,!0,"redo",!0),n};EditorUi.prototype.destroy=function(){var t,n;if(this.editor!=null&&(this.editor.destroy(),this.editor=null),this.menubar!=null&&(this.menubar.destroy(),this.menubar=null),this.toolbar!=null&&(this.toolbar.destroy(),this.toolbar=null),this.sidebar!=null&&(this.sidebar.destroy(),this.sidebar=null),this.keyHandler!=null&&(this.keyHandler.destroy(),this.keyHandler=null),this.keydownHandler!=null&&(mxEvent.removeListener(document,"keydown",this.keydownHandler),this.keydownHandler=null),this.keyupHandler!=null&&(mxEvent.removeListener(document,"keyup",this.keyupHandler),this.keyupHandler=null),this.resizeHandler!=null&&(mxEvent.removeListener(window,"resize",this.resizeHandler),this.resizeHandler=null),this.gestureHandler!=null&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null),this.orientationChangeHandler!=null&&(mxEvent.removeListener(window,"orientationchange",this.orientationChangeHandler),this.orientationChangeHandler=null),this.scrollHandler!=null&&(mxEvent.removeListener(window,"scroll",this.scrollHandler),this.scrollHandler=null),this.destroyFunctions!=null){for(n=0;n<this.destroyFunctions.length;n++)this.destroyFunctions[n]();this.destroyFunctions=null}for(t=[this.menubarContainer,this.toolbarContainer,this.sidebarContainer,this.formatContainer,this.diagramContainer,this.footerContainer,this.chromelessToolbar,this.hsplit,this.sidebarFooterContainer,this.layersDialog],n=0;n<t.length;n++)t[n]!=null&&t[n].parentNode!=null&&t[n].parentNode.removeChild(t[n])};Editor=function(n,t,i,r,u){mxEventSource.call(this);this.chromeless=n!=null?n:this.chromeless;this.initStencilRegistry();this.graph=r||this.createGraph(t,i);this.editable=u!=null?u:!n;this.undoManager=this.createUndoManager();this.status="";this.getOrCreateFilename=function(){return this.filename||mxResources.get("drawing",[Editor.pageCounter])+".xml"};this.getFilename=function(){return this.filename};this.setStatus=function(n){this.status=n;this.fireEvent(new mxEventObject("statusChanged"))};this.getStatus=function(){return this.status};this.graphChangeListener=function(n,t){var i=t!=null?t.getProperty("edit"):null;i!=null&&i.ignoreEdit||this.setModified(!0)};this.graph.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.graphChangeListener.apply(this,arguments)}));this.graph.resetViewOnRootChange=!1;this.init()};Editor.pageCounter=0,function(){try{for(var n=window;n.opener!=null&&typeof n.opener.Editor!="undefined"&&!isNaN(n.opener.Editor.pageCounter)&&n.opener!=n;)n=n.opener;n!=null&&(n.Editor.pageCounter++,Editor.pageCounter=n.Editor.pageCounter)}catch(t){}}();Editor.useLocalStorage=typeof Storage!="undefined"&&mxClient.IS_IOS;Editor.helpImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAXVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC5BxTwAAAAH3RSTlMAlUF8boNQIE0LBgOgkGlHNSwqFIx/dGVUOjApmV9ezNACSAAAAIVJREFUGNNtjNsOgzAMQ5NeoVcKDAZs+//PXLKI8YKlWvaRU7jXuFpb9qsbdK05XILUiE8JHQox1Pv3OgFUzf1AGqWqUg+QBwLF0YAeegBlCNgRWOpB5vUfTCmeoHQ/wNdy0jLH/cM+b+wLTw4n/7ACEmHVVy8h6qy8V7MNcGowWpsNbvUFcGUEdSi1s/oAAAAASUVORK5CYII=":IMAGE_PATH+"/help.png";Editor.checkmarkImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhFQAVAMQfAGxsbHx8fIqKioaGhvb29nJycvr6+sDAwJqamltbW5OTk+np6YGBgeTk5Ly8vJiYmP39/fLy8qWlpa6ursjIyOLi4vj4+N/f3+3t7fT09LCwsHZ2dubm5r6+vmZmZv///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEY4NTZERTQ5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEY4NTZERTU5QUFBMTFFMUE5MTVDOTM5MUZGMTE3M0QiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Rjg1NkRFMjlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Rjg1NkRFMzlBQUExMUUxQTkxNUM5MzkxRkYxMTczRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAB8ALAAAAAAVABUAAAVI4CeOZGmeaKqubKtylktSgCOLRyLd3+QJEJnh4VHcMoOfYQXQLBcBD4PA6ngGlIInEHEhPOANRkaIFhq8SuHCE1Hb8Lh8LgsBADs=":IMAGE_PATH+"/checkmark.gif";Editor.maximizeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAAAAAAAAAAAAAAAADgKxmiAAAABXRSTlMA758vX1Pw3BoAAABJSURBVAjXY8AJQkODGBhUQ0MhbAUGBiYY24CBgRnGFmZgMISwgwwDGRhEhVVBbAVmEQYGRwMmBjIAQi/CTIRd6G5AuA3dzYQBAHj0EFdHkvV4AAAAAElFTkSuQmCC";Editor.zoomOutImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCxxcXEhISFgYGChjTUxAAAAAXRSTlMAQObYZgAAAEdJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITgLJZXFxgbIQ4Qj3CHIT5ggoIe5kgNkM1KSDYKBKqxPkDAPo5BAZBE54hAAAAAElFTkSuQmCC";Editor.zoomInImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAElBMVEUAAAAAAAAsLCwhISFxcXFgYGBavKaoAAAAAXRSTlMAQObYZgAAAElJREFUCNdjIAMwCQrB2YKCggJQJqMIA4sglK3owMzgqABVwsDMwCgAZTMbG8PYCHGEeoQ5CPMFFRD2MkFshmpSQLBRJFSJ8wcAEqcEM2uhl2MAAAAASUVORK5CYII=";Editor.zoomFitImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVBAMAAABbObilAAAAD1BMVEUAAAAAAAAwMDBwcHBgYGC1xl09AAAAAXRSTlMAQObYZgAAAEFJREFUCNdjIAMwCQrB2YKCggJQJqMwA7MglK1owMBgqABVApITwMdGqEeYgzBfUAFhLxPEZqgmBQQbRUKFOH8AAK5OA3lA+FFOAAAAAElFTkSuQmCC";Editor.layersImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAMAAACeyVWkAAAAaVBMVEUAAAAgICAICAgdHR0PDw8WFhYICAgLCwsXFxcvLy8ODg4uLi4iIiIqKiokJCQYGBgKCgonJycFBQUCAgIqKiocHBwcHBwODg4eHh4cHBwnJycJCQkUFBQqKiojIyMuLi4ZGRkgICAEBATOWYXAAAAAGnRSTlMAD7+fnz8/H7/ff18/77+vr5+fn39/b28fH2xSoKsAAACQSURBVBjTrYxJEsMgDARZZMAY73sgCcn/HxnhKtnk7j6oRq0psfuoyndZ/SuODkHPLzfVT6KeyPePnJ7KrnkRjWMXTn4SMnN8mXe2SSM3ts8L/ZUxxrbAULSYJJULE0Iw9pjpenoICcgcX61mGgTgtCv9Be99pzCoDhNQWQnchD1mup5++CYGcoQexajZbfwAj/0MD8ZOaUgAAAAASUVORK5CYII=";Editor.previousImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAh0lEQVQ4je3UsQnCUBCA4U8hpa1NsoEjpHQJS0dxADdwEMuMIJkgA1hYChbGQgMi+JC8q4L/AB/vDu7x74cWWEZhJU44RmA1zujR5GIbXF9YNrjD/Q0bDRY4fEBZ4P4LlgTnCbAf84pUM8/9hY08tMUtEoQ1LpEgrNBFglChFXR6Q6GfwwR6AGKJMF74Vtt3AAAAAElFTkSuQmCC";Editor.nextImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAAi0lEQVQ4jeXUIQ7CUAwA0MeGxWI2yylwnALJUdBcgYvM7QYLmjOQIAkIPmJZghiIvypoUtX0tfnJL38X5ZfaEgUeUcManFBHgS0SLlhHggk3bCPBhCf2keCQR8wjwYTDp6YiZxJmOU1jGw7vGALescuBxsArNlOwd/CM1VSM/ut1qCIw+uOwiMJ+OF4CQzBCXm3hyAAAAABJRU5ErkJggg==";Editor.zoomOutLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABJklEQVQ4y4WT2XaDMAxEvWD2nSSUNEnTJN3r//+9Sj7ILAY6L0ijC4ONYVZRpo6cByrz2YKSUGorGTpz71lPVHvT+avoB5wIkU/mxk8veceSuNoLg44IzziXjvpih72wKQnm8yc2UoiP/LAd8jQfe2Xf4Pq+2EyYIvv9wbzHHCgwxDdlBtWZOdqDfTCVgqpygQpsZaojVAVc9UjQxnAJDIBhiQv84tq3gMQCAVTxVoSibXJf8tMuc7e1TB/DCmejBNg/w1Y3c+AM5vv4w7xM59/oXamrHaLVqPQ+OTCnmMZxgz0SdL5zji0/ld6j88qGa5KIiBB6WeJGKfUKwSMKLuXgvl1TW0tm5R9UQL/efSDYsnzxD8CinhBsTTdugJatKpJwf8v+ADb8QmvW7AeAAAAAAElFTkSuQmCC";Editor.zoomInLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABKElEQVQ4y4WT6WKCMBCENwkBwn2oFKvWqr3L+79es4EkQIDOH2d3Pxk2ABiJlB8JCXjqw4LikHVGLHTm3nM3UeVN5690GBBN0GwyV/3kkrUQR+WeKnREeKpzaXWd77CmJiXGfPIEI4V4yQ9TIW/ntlcMBe731Vts9w5TWG8F5j3mQI4hvrKpdGeYA7CX9qAcl650gVJartxRuhyHVghF8idQAIbFLvCLu28BsQEC6aKtCK6Pyb3JT7PmbmtNH8Ny56CotD/2qOs5cJbuffxgXmCib+xddVU5RNOhkvvkhTlFehzVWCOh3++MYElOhfdovaImnRYVmqDdsuhNp1QrBBE6uGC2+3ZNjGdg5B94oD+9uyVgWT79BwAxEBTWdOu3bWBVgsn/N/AHUD9IC01Oe40AAAAASUVORK5CYII=";Editor.actualSizeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAilBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////2N2iNAAAALXRSTlMA+vTcKMM96GRBHwXxi0YaX1HLrKWhiHpWEOnOr52Vb2xKSDcT19PKv5l/Ngdk8+viAAABIUlEQVQ4y4WT2XqDIBCFBxDc9yTWNEnTJN3r+79eGT4BEbXnaubMr8dBBaM450dCQp4LWFAascGIRd48eB4cNYE7f6XjgGiCFs5c+dml6CFN6j1V6IQIlHPpdV/usKcmJcV88gQTRXjLD9Mhb+fWq8YG9/uCmTCFjeeDeY85UGKIUGUuqzN42kv7oCouq9oHamlzVR1lVfpAIu1QVRiW+sAv7r4FpAYIZZVsRXB9TP5Dfpo1d1trCgzz1iiptH/sUbdz4CzN9+mLeXHn3+hdddd4RDegsrvzwZwSs2GLPRJidAqCLTlVwaMPqpYMWjTWBB2WRW86pVkhSKyDK2bdt2tmagZG4sBD/evdLQHLEvQfAOKRoLCmG1FAB6uKmby+gz+REDn7O5+EwQAAAABJRU5ErkJggg==";Editor.printLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAXVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9RKvvlAAAAHnRSTlMAydnl77qbMLT093H7K4Nd4Ktn082+lYt5bkklEgP44nQSAAAApUlEQVQ4y73P2Q6DIBRF0cOgbRHHzhP//5m9mBAQKjG1cT0Yc7ITAMu1LNQgUZiQ2DYoNQ0sCQb6qgHAfRx48opq3J9AZ6xuF7uOew8Ik1OsCZRS2UAC9V+D9a+QZYxNA45YFQftPtSkATOhw7dAc0vPBwKWiIOjP0JZ0yMuQJ27g36DipOUsqRAM0dR8KD1/ILHaHSE/w8DIx09E3g/BTce6rHUB5sAPKvfF+JdAAAAAElFTkSuQmCC";Editor.layersLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAmVBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+/v7///+bnZkkAAAAMnRSTlMABPr8ByiD88KsTi/rvJb272mjeUA1CuPe1M/KjVxYHxMP6KZ0S9nYzGRGGRaznpGIbzaGUf0AAAHESURBVDjLbZLZYoIwEEVDgLCjbKIgAlqXqt3m/z+uNwu1rcyDhjl3ktnYL7OY254C0VX3yWFZfzDrOClbbgKxi0YDHjwl4jbnRkXxJS/C1YP3DbBhD1n7Ex4uaAqdVDb3yJ/4J/3nJD2to/ngQz/DfUvzMp4JJ5sSCaF5oXmemgQDfDxzbi+Kq4sU+vNcuAmx94JtyOP2DD4Epz2asWSCz4Z/4fECxyNj9zC9xNLHcdPEO+awDKeSaUu0W4twZQiO2hYVisTR3RCtK/c1X6t4xMEpiGqXqVntEBLolkZZsKY4QtwH6jzq67dEHlJysB1aNOD3XT7n1UkasQN59L4yC2RELMDSeCRtz3yV22Ub3ozIUTknYx8JWqDdQxbUes98cR2kZtUSveF/bAhcedwEWmlxIkpZUy4XOCb6VBjjxHvbwo/1lBAHHi2JCr0NI570QhyHq/DhJoE2lLgyA4RVe6KmZ47O/3b86MCP0HWa73A8/C3SUc5Qc1ajt6fgpXJ+RGpMvDSchepZDOOQRcZVIKcK90x2D7etqtI+56+u6n3sPriO6nfphitR4+O2m3EbM7lh3me1FM1o+LMI887rN+s3/wZdTFlpNVJiOAAAAABJRU5ErkJggg==";Editor.closeLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAUVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////8IN+deAAAAGnRSTlMAuvAIg/dDM/QlOeuFhj0S5s4vKgzjxJRQNiLSey0AAADNSURBVDjLfZLbEoMgDEQjRRRs1XqX///QNmOHJSnjPkHOGR7IEmeoGtJZstnwjqbRfIsmgEdtPCqe9Ynz7ZSc07rE2QiSc+qv8TvjRXA2PDUm3dpe82iJhOEUfxJJo3aCv+jKmRmH4lcCjCjeh9GWOdL/GZZkXH3PYYDrHBnfc4D/RVZf5sjoC1was+Y6HQxwaUxFvq/a0Pv343VCTxfBSRiB+ab3M3eiQZXmMNBJ3Y8pGRZtYQ7DgHMXJEdPLTaN/qBjzJOBc3nmNcbsA16bMR0oLqf+AAAAAElFTkSuQmCC";Editor.editLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAgVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9d3yJTAAAAKnRSTlMA+hzi3nRQWyXzkm0h2j3u54gzEgSXjlYoTBgJxL2loGpAOS3Jt7Wxm35Ga7gRAAAA6UlEQVQ4y63Q2XaCMBSF4Q0JBasoQ5DJqbXjfv8HbCK2BZNwo/8FXHx7rcMC7lQu0iX8qU/qtvAWCpoqH8dYzS0SwaV5eK/UAf8X9pd2CWKzuF5Jrftp1owXwnIGLUaL3PYndOHf4kNNXWrXK/m7CHunk7K8LE6YtBpcknwG9GKxnroY+ylBXcx4xKyx/u/EuXi509cP9V7OO1oyHnzrdFTcqLG/4ibBA5pIMr/4xvKzuQDkVy9wW8SgBFD6HDvuzMvrZcC9QlkfMzI7w64m+b4PqBMNHB05lH21PVxJo2/fBXxV4hB38PcD+5AkI4FuETsAAAAASUVORK5CYII=";Editor.previousLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFZJREFUOMvdkskRgDAMA4lDwg2B7b9XOlge/KKvdsa25KFb5XlRvxXC/DNBEv8IFNjBgGdDgXtFgTyhwDXiQAUHCvwa4Uv6mR6UR+1led2mVonvl+tML45qCQNQLIx7AAAAAElFTkSuQmCC";Editor.nextLargeImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD////////////////////////////////////////////////////////////////////////////YSWgTAAAAE3RSTlMA7fci493c0MW8uJ6CZks4MxQHEZL6ewAAAFRJREFUOMvd0skRgCAQBVEFwQ0V7fxzNQP6wI05v6pZ/kyj1b7FNgik2gQzzLcAwiUAigHOTwDHK4A1CmB5BJANJG1hQ9qafYcqFlZP3IFc9eVGrR+iIgkDQRUXIAAAAABJRU5ErkJggg==";Editor.ctrlKey=mxClient.IS_MAC?"Cmd":"Ctrl";mxUtils.extend(Editor,mxEventSource);Editor.prototype.originalNoForeignObject=mxClient.NO_FO;Editor.prototype.transparentImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhMAAwAIAAAP///wAAACH5BAEAAAAALAAAAAAwADAAAAIxhI+py+0Po5y02ouz3rz7D4biSJbmiabqyrbuC8fyTNf2jef6zvf+DwwKh8Si8egpAAA7":IMAGE_PATH+"/transparent.gif";Editor.prototype.extendCanvas=!0;Editor.prototype.chromeless=!1;Editor.prototype.cancelFirst=!0;Editor.prototype.enabled=!0;Editor.prototype.filename=null;Editor.prototype.modified=!1;Editor.prototype.autosave=!0;Editor.prototype.initialTopSpacing=0;Editor.prototype.appName=document.title;Editor.prototype.editBlankUrl=window.location.protocol+"//"+window.location.host+"/";Editor.prototype.init=function(){};Editor.prototype.setAutosave=function(n){this.autosave=n;this.fireEvent(new mxEventObject("autosaveChanged"))};Editor.prototype.getEditBlankUrl=function(n){return this.editBlankUrl+n};Editor.prototype.editAsNew=function(n,t){var i=t!=null?"?title="+encodeURIComponent(t):"";this.editorWindow==null||this.editorWindow.closed?typeof postMessage!="undefined"&&(document.documentMode==null||document.documentMode>=10)?(this.editorWindow==null&&mxEvent.addListener(window,"message",mxUtils.bind(this,function(t){t.data=="ready"&&t.source==this.editorWindow&&this.editorWindow.postMessage(n,"*")})),this.editorWindow=window.open(this.getEditBlankUrl(i+(i.length>0?"&":"?")+"client=1"))):this.editorWindow=window.open(this.getEditBlankUrl(i)+"#R"+encodeURIComponent(n)):this.editorWindow.focus()};Editor.prototype.createGraph=function(n,t){var i=new Graph(null,t,null,null,n);return i.transparentBackground=!1,this.chromeless||(i.isBlankLink=function(n){return!this.isExternalProtocol(n)}),i};Editor.prototype.resetGraph=function(){this.graph.gridEnabled=!this.chromeless||urlParams.grid=="1";this.graph.graphHandler.guidesEnabled=!0;this.graph.setTooltips(!0);this.graph.setConnectable(!0);this.graph.foldingEnabled=!0;this.graph.scrollbars=this.graph.defaultScrollbars;this.graph.pageVisible=this.graph.defaultPageVisible;this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;this.graph.background=this.graph.defaultGraphBackground;this.graph.pageScale=mxGraph.prototype.pageScale;this.graph.pageFormat=mxGraph.prototype.pageFormat;this.updateGraphComponents();this.graph.view.setScale(1)};Editor.prototype.readGraphState=function(n){var i,r,u,f,t;this.graph.gridEnabled=n.getAttribute("grid")!="0"&&(!this.chromeless||urlParams.grid=="1");this.graph.gridSize=parseFloat(n.getAttribute("gridSize"))||mxGraph.prototype.gridSize;this.graph.graphHandler.guidesEnabled=n.getAttribute("guides")!="0";this.graph.setTooltips(n.getAttribute("tooltips")!="0");this.graph.setConnectable(n.getAttribute("connect")!="0");this.graph.connectionArrowsEnabled=n.getAttribute("arrows")!="0";this.graph.foldingEnabled=n.getAttribute("fold")!="0";this.chromeless&&this.graph.foldingEnabled&&(this.graph.foldingEnabled=urlParams.nav=="1",this.graph.cellRenderer.forceControlClickHandler=this.graph.foldingEnabled);i=n.getAttribute("pageScale");this.graph.pageScale=i!=null?i:mxGraph.prototype.pageScale;this.graph.lightbox?this.graph.pageVisible=!1:(r=n.getAttribute("page"),this.graph.pageVisible=r!=null?r!="0":this.graph.defaultPageVisible);this.graph.pageBreaksVisible=this.graph.pageVisible;this.graph.preferPageSize=this.graph.pageBreaksVisible;u=n.getAttribute("pageWidth");f=n.getAttribute("pageHeight");u!=null&&f!=null&&(this.graph.pageFormat=new mxRectangle(0,0,parseFloat(u),parseFloat(f)));t=n.getAttribute("background");this.graph.background=t!=null&&t.length>0?t:this.graph.defaultGraphBackground;this.graph.wfProcessUid=n.getAttribute("wfProcessUid")||"";this.graph.wfDiagramUid=n.getAttribute("wfDiagramUid")||"";this.graph.wfDiagramName=n.getAttribute("wfDiagramName")||"";this.graph.wfDesc=n.getAttribute("wfDesc")||"";this.graph.wfResultNotice=n.getAttribute("wfResultNotice")||"1";this.graph.wfSuspendNotice=n.getAttribute("wfSuspendNotice")||"0";this.graph.wfMail=n.getAttribute("wfMail")||"1";this.graph.wfMessage=n.getAttribute("wfMessage")||"1";this.graph.frmType=n.getAttribute("frmType")||"Internal";this.graph.billTable=n.getAttribute("billTable")||"";this.graph.billTemplate=n.getAttribute("billTemplate")||""};Editor.prototype.setGraphXml=function(n){var t,i;if(n!=null)if(t=new mxCodec(n.ownerDocument),n.nodeName=="mxGraphModel"){this.graph.model.beginUpdate();try{this.graph.model.clear();this.graph.view.scale=1;this.readGraphState(n);this.updateGraphComponents();t.decode(n,this.graph.getModel())}finally{this.graph.model.endUpdate()}this.fireEvent(new mxEventObject("resetGraphView"))}else if(n.nodeName=="root")this.resetGraph(),i=t.document.createElement("mxGraphModel"),i.appendChild(n),t.decode(i,this.graph.getModel()),this.updateGraphComponents(),this.fireEvent(new mxEventObject("resetGraphView"));else throw{message:mxResources.get("cannotOpenFile"),node:n,toString:function(){return this.message}};else this.resetGraph(),this.graph.model.clear(),this.fireEvent(new mxEventObject("resetGraphView"))};Editor.prototype.getGraphXml=function(n){var t,i;return n=n!=null?n:!0,t=null,n?(i=new mxCodec(mxUtils.createXmlDocument()),t=i.encode(this.graph.getModel())):t=this.graph.encodeCells(mxUtils.sortCells(this.graph.model.getTopmostCells(this.graph.getSelectionCells()))),(this.graph.view.translate.x!=0||this.graph.view.translate.y!=0)&&(t.setAttribute("dx",Math.round(this.graph.view.translate.x*100)/100),t.setAttribute("dy",Math.round(this.graph.view.translate.y*100)/100)),t.setAttribute("grid",this.graph.isGridEnabled()?"1":"0"),t.setAttribute("gridSize",this.graph.gridSize),t.setAttribute("guides",this.graph.graphHandler.guidesEnabled?"1":"0"),t.setAttribute("tooltips",this.graph.tooltipHandler.isEnabled()?"1":"0"),t.setAttribute("connect",this.graph.connectionHandler.isEnabled()?"1":"0"),t.setAttribute("arrows",this.graph.connectionArrowsEnabled?"1":"0"),t.setAttribute("fold",this.graph.foldingEnabled?"1":"0"),t.setAttribute("page",this.graph.pageVisible?"1":"0"),t.setAttribute("pageScale",this.graph.pageScale),t.setAttribute("pageWidth",this.graph.pageFormat.width),t.setAttribute("pageHeight",this.graph.pageFormat.height),this.graph.background!=null&&t.setAttribute("background",this.graph.background),t.setAttribute("wfProcessUid",this.graph.wfProcessUid||""),t.setAttribute("wfDiagramUid",this.graph.wfDiagramUid||""),t.setAttribute("wfDiagramName",this.graph.wfDiagramName||""),t.setAttribute("wfDesc",this.graph.wfDesc||""),t.setAttribute("wfResultNotice",this.graph.wfResultNotice||"0"),t.setAttribute("wfSuspendNotice",this.graph.wfSuspendNotice||"0"),t.setAttribute("wfMail",this.graph.wfMail||"0"),t.setAttribute("wfMessage",this.graph.wfMessage||"0"),t.setAttribute("frmType",this.graph.frmType||"Internal"),t.setAttribute("billTable",this.graph.billTable||""),t.setAttribute("billTemplate",this.graph.billTemplate||""),t};Editor.prototype.updateGraphComponents=function(){var n=this.graph;n.container!=null&&(n.view.validateBackground(),n.container.style.overflow=n.scrollbars?"auto":"hidden",this.fireEvent(new mxEventObject("updateGraphComponents")))};Editor.prototype.setModified=function(n){this.modified=n};Editor.prototype.setFilename=function(n){this.filename=n};Editor.prototype.createUndoManager=function(){var n=this.graph,t=new mxUndoManager,i,r;return this.undoListener=function(n,i){t.undoableEditHappened(i.getProperty("edit"))},i=mxUtils.bind(this,function(){this.undoListener.apply(this,arguments)}),n.getModel().addListener(mxEvent.UNDO,i),n.getView().addListener(mxEvent.UNDO,i),r=function(t,i){for(var u=n.getSelectionCellsForChanges(i.getProperty("edit").changes),f=n.getModel(),e=[],r=0;r<u.length;r++)(f.isVertex(u[r])||f.isEdge(u[r]))&&n.view.getState(u[r])!=null&&e.push(u[r]);n.setSelectionCells(e)},t.addListener(mxEvent.UNDO,r),t.addListener(mxEvent.REDO,r),t};Editor.prototype.initStencilRegistry=function(){};Editor.prototype.destroy=function(){this.graph!=null&&(this.graph.destroy(),this.graph=null)};OpenFile=function(n){this.producer=null;this.consumer=null;this.done=n;this.args=null};OpenFile.prototype.setConsumer=function(n){this.consumer=n;this.execute()};OpenFile.prototype.setData=function(){this.args=arguments;this.execute()};OpenFile.prototype.error=function(n){this.cancel(!0);mxUtils.alert(n)};OpenFile.prototype.execute=function(){this.consumer!=null&&this.args!=null&&(this.cancel(!1),this.consumer.apply(this,this.args))};OpenFile.prototype.cancel=function(n){this.done!=null&&this.done(n!=null?n:!0)};Dialog.backdropColor="white";Dialog.prototype.zIndex=mxPopupMenu.prototype.zIndex-1;Dialog.prototype.noColorImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkEzRDlBMUUwODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkEzRDlBMUUxODYxMTExRTFCMzA4RDdDMjJBMEMxRDM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QTNEOUExREU4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QTNEOUExREY4NjExMTFFMUIzMDhEN0MyMkEwQzFEMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5xh3fmAAAABlBMVEX////MzMw46qqDAAAAGElEQVR42mJggAJGKGAYIIGBth8KAAIMAEUQAIElnLuQAAAAAElFTkSuQmCC":IMAGE_PATH+"/nocolor.png";Dialog.prototype.closeImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJAQMAAADaX5RTAAAABlBMVEV7mr3///+wksspAAAAAnRSTlP/AOW3MEoAAAAdSURBVAgdY9jXwCDDwNDRwHCwgeExmASygSL7GgB12QiqNHZZIwAAAABJRU5ErkJggg==":IMAGE_PATH+"/close.png";Dialog.prototype.clearImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQAKAIABAMDAwP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUIzOEM1NzI4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUIzOEM1NzM4NjEyMTFFMUEzMkNDMUE3NjZERDE2QjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QjM4QzU3MDg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QjM4QzU3MTg2MTIxMUUxQTMyQ0MxQTc2NkREMTZCMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAANAAoAAAIXTGCJebD9jEOTqRlttXdrB32PJ2ncyRQAOw==":IMAGE_PATH+"/clear.gif";Dialog.prototype.lockedImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCODExNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCODIxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3RjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI4MDE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvqMCFYAAAAVUExURZmZmb+/v7KysqysrMzMzLGxsf///4g8N1cAAAAHdFJOU////////wAaSwNGAAAAPElEQVR42lTMQQ4AIQgEwUa0//9kTQirOweYOgDqAMbZUr10AGlAwx4/BJ2QJ4U0L5brYjovvpv32xZgAHZaATFtMbu4AAAAAElFTkSuQmCC":IMAGE_PATH+"/locked.png";Dialog.prototype.unlockedImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzdDMDZCN0QxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzdDMDZCN0UxNzIxMTFFNUI0RTk5NTg4OTcyMUUyODEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozN0MwNkI3QjE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozN0MwNkI3QzE3MjExMUU1QjRFOTk1ODg5NzIxRTI4MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkKMpVwAAAAYUExURZmZmbKysr+/v6ysrOXl5czMzLGxsf///zHN5lwAAAAIdFJOU/////////8A3oO9WQAAADxJREFUeNpUzFESACAEBNBVsfe/cZJU+8Mzs8CIABCidtfGOndnYsT40HDSiCcbPdoJo10o9aI677cpwACRoAF3dFNlswAAAABJRU5ErkJggg==":IMAGE_PATH+"/unlocked.png";Dialog.prototype.bgOpacity=80;Dialog.prototype.getPosition=function(n,t){return new mxPoint(n,t)};Dialog.prototype.close=function(n){if(this.onDialogClose!=null){this.onDialogClose(n);this.onDialogClose=null}this.dialogImg!=null&&(this.dialogImg.parentNode.removeChild(this.dialogImg),this.dialogImg=null);this.bg!=null&&this.bg.parentNode!=null&&this.bg.parentNode.removeChild(this.bg);mxEvent.removeListener(window,"resize",this.resizeListener);this.container.parentNode.removeChild(this.container)};PrintDialog=function(n,t){this.create(n,t)};PrintDialog.prototype.create=function(n){function y(n){var e=r.checked||u.checked,i=parseInt(s.value)/100,t,h,c,l,a;isNaN(i)&&(i=1,s.value="100%");i*=.75;t=o.pageFormat||mxConstants.PAGE_FORMAT_A4_PORTRAIT;h=1/o.pageScale;e&&(c=r.checked?1:parseInt(f.value),isNaN(c)||(h=mxUtils.getScaleForPageCount(c,o,t)));var p=o.getGraphBounds(),v=0,y=0;t=mxRectangle.fromRectangle(t);t.width=Math.ceil(t.width*i);t.height=Math.ceil(t.height*i);h*=i;!e&&o.pageVisible?(l=o.getPageLayout(),v-=l.x*t.width,y-=l.y*t.height):e=!0;a=PrintDialog.createPrintPreview(o,h,t,0,v,y,e);a.open();n&&PrintDialog.printPreview(a)}var o=n.editor.graph,i,t,c=document.createElement("table"),h,r,u,e,f,s,l,a,v;c.style.width="100%";c.style.height="100%";h=document.createElement("tbody");i=document.createElement("tr");r=document.createElement("input");r.setAttribute("type","checkbox");t=document.createElement("td");t.setAttribute("colspan","2");t.style.fontSize="10pt";t.appendChild(r);e=document.createElement("span");mxUtils.write(e," "+mxResources.get("fitPage"));t.appendChild(e);mxEvent.addListener(e,"click",function(n){r.checked=!r.checked;u.checked=!r.checked;mxEvent.consume(n)});mxEvent.addListener(r,"change",function(){u.checked=!r.checked});i.appendChild(t);h.appendChild(i);i=i.cloneNode(!1);u=document.createElement("input");u.setAttribute("type","checkbox");t=document.createElement("td");t.style.fontSize="10pt";t.appendChild(u);e=document.createElement("span");mxUtils.write(e," "+mxResources.get("posterPrint")+":");t.appendChild(e);mxEvent.addListener(e,"click",function(n){u.checked=!u.checked;r.checked=!u.checked;mxEvent.consume(n)});i.appendChild(t);f=document.createElement("input");f.setAttribute("value","1");f.setAttribute("type","number");f.setAttribute("min","1");f.setAttribute("size","4");f.setAttribute("disabled","disabled");f.style.width="50px";t=document.createElement("td");t.style.fontSize="10pt";t.appendChild(f);mxUtils.write(t," "+mxResources.get("pages")+" (max)");i.appendChild(t);h.appendChild(i);mxEvent.addListener(u,"change",function(){u.checked?f.removeAttribute("disabled"):f.setAttribute("disabled","disabled");r.checked=!u.checked});i=i.cloneNode(!1);t=document.createElement("td");mxUtils.write(t,mxResources.get("pageScale")+":");i.appendChild(t);t=document.createElement("td");s=document.createElement("input");s.setAttribute("value","100 %");s.setAttribute("size","5");s.style.width="50px";t.appendChild(s);i.appendChild(t);h.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.colSpan=2;t.style.paddingTop="20px";t.setAttribute("align","right");l=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});l.className="geBtn";n.editor.cancelFirst&&t.appendChild(l);PrintDialog.previewEnabled&&(a=mxUtils.button(mxResources.get("preview"),function(){n.hideDialog();y(!1)}),a.className="geBtn",t.appendChild(a));v=mxUtils.button(mxResources.get(PrintDialog.previewEnabled?"print":"ok"),function(){n.hideDialog();y(!0)});v.className="geBtn gePrimaryBtn";t.appendChild(v);n.editor.cancelFirst||t.appendChild(l);i.appendChild(t);h.appendChild(i);c.appendChild(h);this.container=c};PrintDialog.printPreview=function(n){if(n.wnd!=null){var t=function(){n.wnd.focus();n.wnd.print();n.wnd.close()};mxClient.IS_GC?window.setTimeout(t,500):t()}};PrintDialog.createPrintPreview=function(n,t,i,r,u,f,e){var o=new mxPrintPreview(n,t,i,r,u,f),s,h;return o.title=mxResources.get("preview"),o.printBackgroundImage=!0,o.autoOrigin=e,s=n.background,(s==null||s==""||s==mxConstants.NONE)&&(s="#ffffff"),o.backgroundColor=s,h=o.writeHead,o.writeHead=function(n){h.apply(this,arguments);n.writeln('<style type="text/css">');n.writeln("@media screen {");n.writeln("  body > div { padding:30px;box-sizing:content-box; }");n.writeln("}");n.writeln("<\/style>")},o};PrintDialog.previewEnabled=!0;PageSetupDialog=function(n){function p(){o==null||o==mxConstants.NONE?(u.style.backgroundColor="",u.style.backgroundImage="url('"+Dialog.prototype.noColorImage+"')"):(u.style.backgroundColor=o,u.style.backgroundImage="")}function w(){s==null?(e.removeAttribute("title"),e.style.fontSize="",e.innerHTML=mxResources.get("change")+"..."):(e.setAttribute("title",s.src),e.style.fontSize="11px",e.innerHTML=s.src.substring(0,42)+"...")}var r=n.editor.graph,i,t,c=document.createElement("table"),h,v,y,u,o,f,e,s,l,a;c.style.width="100%";c.style.height="100%";h=document.createElement("tbody");i=document.createElement("tr");t=document.createElement("td");t.style.verticalAlign="top";t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("paperSize")+":");i.appendChild(t);t=document.createElement("td");t.style.verticalAlign="top";t.style.fontSize="10pt";v=PageSetupDialog.addPageFormatPanel(t,"pagesetupdialog",r.pageFormat);i.appendChild(t);h.appendChild(i);i=document.createElement("tr");t=document.createElement("td");mxUtils.write(t,mxResources.get("background")+":");i.appendChild(t);t=document.createElement("td");t.style.whiteSpace="nowrap";y=document.createElement("input");y.setAttribute("type","text");u=document.createElement("button");u.style.width="18px";u.style.height="18px";u.style.marginRight="20px";u.style.backgroundPosition="center center";u.style.backgroundRepeat="no-repeat";o=r.background;p();mxEvent.addListener(u,"click",function(t){n.pickColor(o||"none",function(n){o=n;p()});mxEvent.consume(t)});t.appendChild(u);mxUtils.write(t,mxResources.get("gridSize")+":");f=document.createElement("input");f.setAttribute("type","number");f.setAttribute("min","0");f.style.width="40px";f.style.marginLeft="6px";f.value=r.getGridSize();t.appendChild(f);mxEvent.addListener(f,"change",function(){var n=parseInt(f.value);f.value=Math.max(1,isNaN(n)?r.getGridSize():n)});i.appendChild(t);h.appendChild(i);i=document.createElement("tr");t=document.createElement("td");mxUtils.write(t,mxResources.get("image")+":");i.appendChild(t);t=document.createElement("td");e=document.createElement("a");e.style.textDecoration="underline";e.style.cursor="pointer";e.style.color="#a0a0a0";s=r.backgroundImage;mxEvent.addListener(e,"click",function(t){n.showBackgroundImageDialog(function(n){s=n;w()});mxEvent.consume(t)});w();t.appendChild(e);i.appendChild(t);h.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.colSpan=2;t.style.paddingTop="16px";t.setAttribute("align","right");l=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});l.className="geBtn";n.editor.cancelFirst&&t.appendChild(l);a=mxUtils.button(mxResources.get("apply"),function(){var t,i,u;n.hideDialog();r.gridSize!==f.value&&r.setGridSize(parseInt(f.value));t=new ChangePageSetup(n,o,s,v.get());t.ignoreColor=r.background==o;i=r.backgroundImage!=null?r.backgroundImage.src:null;u=s!=null?s.src:null;t.ignoreImage=i===u;r.pageFormat.width==t.previousFormat.width&&r.pageFormat.height==t.previousFormat.height&&t.ignoreColor&&t.ignoreImage||r.model.execute(t)});a.className="geBtn gePrimaryBtn";t.appendChild(a);n.editor.cancelFirst||t.appendChild(l);i.appendChild(t);h.appendChild(i);c.appendChild(h);this.container=c};PageSetupDialog.addPageFormatPanel=function(n,t,i,r){function tt(n,t,r){var a,v,l;if(r||h!=document.activeElement&&c!=document.activeElement){for(a=!1,v=0;v<p.length;v++)l=p[v],b?l.key=="custom"&&(s.value=l.key,b=!1):l.format!=null&&(l.key=="a4"?i.width==826?(i=mxRectangle.fromRectangle(i),i.width=827):i.height==826&&(i=mxRectangle.fromRectangle(i),i.height=827):l.key=="a5"&&(i.width==584?(i=mxRectangle.fromRectangle(i),i.width=583):i.height==584&&(i=mxRectangle.fromRectangle(i),i.height=583)),i.width==l.format.width&&i.height==l.format.height?(s.value=l.key,f.setAttribute("checked","checked"),f.defaultChecked=!0,f.checked=!0,u.removeAttribute("checked"),u.defaultChecked=!1,u.checked=!1,a=!0):i.width==l.format.height&&i.height==l.format.width&&(s.value=l.key,f.removeAttribute("checked"),f.defaultChecked=!1,f.checked=!1,u.setAttribute("checked","checked"),u.defaultChecked=!0,u.checked=!0,a=!0));a?(e.style.display="",o.style.display="none"):(h.value=i.width/100,c.value=i.height/100,f.setAttribute("checked","checked"),s.value="custom",e.style.display="none",o.style.display="")}}var nt="format-"+t,f=document.createElement("input"),u,s,e,v,y,o,h,c,g,p,k,w,d,b,a,l;for(f.setAttribute("name",nt),f.setAttribute("type","radio"),f.setAttribute("value","portrait"),u=document.createElement("input"),u.setAttribute("name",nt),u.setAttribute("type","radio"),u.setAttribute("value","landscape"),s=document.createElement("select"),s.style.marginBottom="8px",s.style.width="202px",e=document.createElement("div"),e.style.marginLeft="4px",e.style.width="210px",e.style.height="24px",f.style.marginRight="6px",e.appendChild(f),v=document.createElement("span"),v.style.maxWidth="100px",mxUtils.write(v,mxResources.get("portrait")),e.appendChild(v),u.style.marginLeft="10px",u.style.marginRight="6px",e.appendChild(u),y=document.createElement("span"),y.style.width="100px",mxUtils.write(y,mxResources.get("landscape")),e.appendChild(y),o=document.createElement("div"),o.style.marginLeft="4px",o.style.width="210px",o.style.height="24px",h=document.createElement("input"),h.setAttribute("size","7"),h.style.textAlign="right",o.appendChild(h),mxUtils.write(o," in x "),c=document.createElement("input"),c.setAttribute("size","7"),c.style.textAlign="right",o.appendChild(c),mxUtils.write(o," in"),e.style.display="none",o.style.display="none",g={},p=PageSetupDialog.getFormats(),k=0;k<p.length;k++)w=p[k],g[w.key]=w,d=document.createElement("option"),d.setAttribute("value",w.key),mxUtils.write(d,w.title),s.appendChild(d);return b=!1,tt(),n.appendChild(s),mxUtils.br(n),n.appendChild(e),n.appendChild(o),a=i,l=function(n,t){var l=g[s.value],f;l.format!=null?(h.value=l.format.width/100,c.value=l.format.height/100,o.style.display="none",e.style.display=""):(e.style.display="none",o.style.display="");isNaN(parseFloat(h.value))&&(h.value=i.width/100);isNaN(parseFloat(c.value))&&(c.value=i.height/100);f=new mxRectangle(0,0,Math.floor(parseFloat(h.value)*100),Math.floor(parseFloat(c.value)*100));s.value!="custom"&&u.checked&&(f=new mxRectangle(0,0,f.height,f.width));t&&b||f.width==a.width&&f.height==a.height||(a=f,r!=null&&r(a))},mxEvent.addListener(v,"click",function(n){f.checked=!0;l(n);mxEvent.consume(n)}),mxEvent.addListener(y,"click",function(n){u.checked=!0;l(n);mxEvent.consume(n)}),mxEvent.addListener(h,"blur",l),mxEvent.addListener(h,"click",l),mxEvent.addListener(c,"blur",l),mxEvent.addListener(c,"click",l),mxEvent.addListener(u,"change",l),mxEvent.addListener(f,"change",l),mxEvent.addListener(s,"change",function(n){b=s.value=="custom";l(n,!0)}),l(),{set:function(n){i=n;tt(null,null,!0)},get:function(){return a},widthInput:h,heightInput:c}};PageSetupDialog.getFormats=function(){return[{key:"letter",title:'US-Letter (8,5" x 11")',format:mxConstants.PAGE_FORMAT_LETTER_PORTRAIT},{key:"legal",title:'US-Legal (8,5" x 14")',format:new mxRectangle(0,0,850,1400)},{key:"tabloid",title:"US-Tabloid (279 mm x 432 mm)",format:new mxRectangle(0,0,1100,1700)},{key:"a0",title:"A0 (841 mm x 1189 mm)",format:new mxRectangle(0,0,3300,4681)},{key:"a1",title:"A1 (594 mm x 841 mm)",format:new mxRectangle(0,0,2339,3300)},{key:"a2",title:"A2 (420 mm x 594 mm)",format:new mxRectangle(0,0,1654,2336)},{key:"a3",title:"A3 (297 mm x 420 mm)",format:new mxRectangle(0,0,1169,1654)},{key:"a4",title:"A4 (210 mm x 297 mm)",format:mxConstants.PAGE_FORMAT_A4_PORTRAIT},{key:"a5",title:"A5 (148 mm x 210 mm)",format:new mxRectangle(0,0,583,827)},{key:"a6",title:"A6 (105 mm x 148 mm)",format:new mxRectangle(0,0,413,583)},{key:"a7",title:"A7 (74 mm x 105 mm)",format:new mxRectangle(0,0,291,413)},{key:"custom",title:mxResources.get("custom"),format:null}]},function(){var n,t,i,r,u,f,e;mxGraphView.prototype.validateBackgroundPage=function(){var n=this.graph,i,t;if(n.container!=null&&!n.transparentBackground){if(n.pageVisible)if(i=this.getBackgroundPageBounds(),this.backgroundPageShape==null){for(t=n.container.firstChild;t!=null&&t.nodeType!=mxConstants.NODETYPE_ELEMENT;)t=t.nextSibling;t!=null&&(this.backgroundPageShape=this.createBackgroundPageShape(i),this.backgroundPageShape.scale=1,this.backgroundPageShape.isShadow=!mxClient.IS_QUIRKS,this.backgroundPageShape.dialect=mxConstants.DIALECT_STRICTHTML,this.backgroundPageShape.init(n.container),t.style.position="absolute",n.container.insertBefore(this.backgroundPageShape.node,t),this.backgroundPageShape.redraw(),this.backgroundPageShape.node.className="geBackgroundPage",mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(t){n.dblClick(t)})),mxEvent.addGestureListeners(this.backgroundPageShape.node,mxUtils.bind(this,function(t){n.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){n.tooltipHandler!=null&&n.tooltipHandler.isHideOnHover()&&n.tooltipHandler.hide();n.isMouseDown&&!mxEvent.isConsumed(t)&&n.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(t))}),mxUtils.bind(this,function(t){n.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(t))})))}else this.backgroundPageShape.scale=1,this.backgroundPageShape.bounds=i,this.backgroundPageShape.redraw();else this.backgroundPageShape!=null&&(this.backgroundPageShape.destroy(),this.backgroundPageShape=null);this.validateBackgroundStyles()}};mxGraphView.prototype.validateBackgroundStyles=function(){var n=this.graph,u=n.background==null||n.background==mxConstants.NONE?n.defaultPageBackgroundColor:n.background,h=u!=null&&this.gridColor!=u.toLowerCase()?this.gridColor:"#ffffff",t="none",f="",r,e,o,s,i;n.isGridEnabled()&&(r=10,mxClient.IS_SVG?(t=unescape(encodeURIComponent(this.createSvgGrid(h))),t=window.btoa?btoa(t):Base64.encode(t,!0),t="url(data:image/svg+xml;base64,"+t+")",r=n.gridSize*this.scale*this.gridSteps):t="url("+this.gridImage+")",e=0,o=0,n.view.backgroundPageShape!=null&&(s=this.getBackgroundPageBounds(),e=1+s.x,o=1+s.y),f=-Math.round(r-mxUtils.mod(this.translate.x*this.scale-e,r))+"px "+-Math.round(r-mxUtils.mod(this.translate.y*this.scale-o,r))+"px");i=n.view.canvas;i.ownerSVGElement!=null&&(i=i.ownerSVGElement);n.view.backgroundPageShape!=null?(n.view.backgroundPageShape.node.style.backgroundPosition=f,n.view.backgroundPageShape.node.style.backgroundImage=t,n.view.backgroundPageShape.node.style.backgroundColor=u,n.container.className="geDiagramContainer geDiagramBackdrop",i.style.backgroundImage="none",i.style.backgroundColor=""):(n.container.className="geDiagramContainer",i.style.backgroundPosition=f,i.style.backgroundColor=u,i.style.backgroundImage=t)};mxGraphView.prototype.createSvgGrid=function(n){for(var r=this.graph.gridSize*this.scale,t,f,u,i,e,o;r<this.minGridSize;)r*=2;for(t=this.gridSteps*r,f=[],u=1;u<this.gridSteps;u++)i=u*r,f.push("M 0 "+i+" L "+t+" "+i+" M "+i+" 0 L "+i+" "+t);return e=t,o='<svg width="'+e+'" height="'+e+'" xmlns="'+mxConstants.NS_SVG+'"><defs><pattern id="grid" width="'+t+'" height="'+t+'" patternUnits="userSpaceOnUse"><path d="'+f.join(" ")+'" fill="none" stroke="'+n+'" opacity="0.2" stroke-width="1"/><path d="M '+t+" 0 L 0 0 0 "+t+'" fill="none" stroke="'+n+'" stroke-width="1"/><\/pattern><\/defs><rect width="100%" height="100%" fill="url(#grid)"/><\/svg>',o};n=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(t,i){var r,u,f;n.apply(this,arguments);this.shiftPreview1!=null&&(r=this.view.canvas,r.ownerSVGElement!=null&&(r=r.ownerSVGElement),u=this.gridSize*this.view.scale*this.view.gridSteps,f=-Math.round(u-mxUtils.mod(this.view.translate.x*this.view.scale+t,u))+"px "+-Math.round(u-mxUtils.mod(this.view.translate.y*this.view.scale+i,u))+"px",r.style.backgroundPosition=f)};mxGraph.prototype.updatePageBreaks=function(n,t,i){var f=this.view.scale,o=this.view.translate,s=this.pageFormat,h=f*this.pageScale,r=this.view.getBackgroundPageBounds(),u,e;t=r.width;i=r.height;u=new mxRectangle(f*o.x,f*o.y,s.width*h,s.height*h);n=n&&Math.min(u.width,u.height)>this.minPageBreakDist;var c=n?Math.ceil(i/u.height)-1:0,l=n?Math.ceil(t/u.width)-1:0,a=r.x+t,v=r.y+i;this.horizontalPageBreaks==null&&c>0&&(this.horizontalPageBreaks=[]);this.verticalPageBreaks==null&&l>0&&(this.verticalPageBreaks=[]);e=mxUtils.bind(this,function(n){var f,e,i,t;if(n!=null){for(f=n==this.horizontalPageBreaks?c:l,t=0;t<=f;t++)e=n==this.horizontalPageBreaks?[new mxPoint(Math.round(r.x),Math.round(r.y+(t+1)*u.height)),new mxPoint(Math.round(a),Math.round(r.y+(t+1)*u.height))]:[new mxPoint(Math.round(r.x+(t+1)*u.width),Math.round(r.y)),new mxPoint(Math.round(r.x+(t+1)*u.width),Math.round(v))],n[t]!=null?(n[t].points=e,n[t].redraw()):(i=new mxPolyline(e,this.pageBreakColor),i.dialect=this.dialect,i.isDashed=this.pageBreakDashed,i.pointerEvents=!1,i.init(this.view.backgroundPane),i.redraw(),n[t]=i);for(t=f;t<n.length;t++)n[t].destroy();n.splice(f,n.length-f)}});e(this.horizontalPageBreaks);e(this.verticalPageBreaks)};t=mxGraphHandler.prototype.shouldRemoveCellsFromParent;mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(n,i){for(var u,r=0;r<i.length;r++)if(this.graph.getModel().isVertex(i[r])&&(u=this.graph.getCellGeometry(i[r]),u!=null&&u.relative))return!1;return t.apply(this,arguments)};i=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var n=i.apply(this,arguments);return n.intersects=mxUtils.bind(this,function(){return this.isConnecting()?!0:mxCellMarker.prototype.intersects.apply(n,arguments)}),n};mxGraphView.prototype.createBackgroundPageShape=function(n){return new mxRectangleShape(n,"#ffffff",this.graph.defaultPageBorderColor)};mxGraphView.prototype.getBackgroundPageBounds=function(){var n=this.getGraphBounds(),r=n.width>0?n.x/this.scale-this.translate.x:0,u=n.height>0?n.y/this.scale-this.translate.y:0,h=n.width/this.scale,c=n.height/this.scale,f=this.graph.pageFormat,e=this.graph.pageScale,t=f.width*e,i=f.height*e,o=Math.floor(Math.min(0,r)/t),s=Math.floor(Math.min(0,u)/i),l=Math.ceil(Math.max(1,r+h)/t),a=Math.ceil(Math.max(1,u+c)/i),v=l-o,y=a-s;return new mxRectangle(this.scale*(this.translate.x+o*t),this.scale*(this.translate.y+s*i),this.scale*v*t,this.scale*y*i)};r=mxGraph.prototype.panGraph;mxGraph.prototype.panGraph=function(n,t){r.apply(this,arguments);this.dialect==mxConstants.DIALECT_SVG||this.view.backgroundPageShape==null||this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)||(this.view.backgroundPageShape.node.style.marginLeft=n+"px",this.view.backgroundPageShape.node.style.marginTop=t+"px")};u=mxPopupMenu.prototype.addItem;mxPopupMenu.prototype.addItem=function(n,t,i,r,f,e){var o=u.apply(this,arguments);return e==null||e||mxEvent.addListener(o,"mousedown",function(n){mxEvent.consume(n)}),o};f=mxGraphHandler.prototype.getInitialCellForEvent;mxGraphHandler.prototype.getInitialCellForEvent=function(){var i=this.graph.getModel(),r=i.getParent(this.graph.getSelectionCell()),n=f.apply(this,arguments),t=i.getParent(n);if(r==null||r!=n&&r!=t)while(!this.graph.isCellSelected(n)&&!this.graph.isCellSelected(t)&&i.isVertex(t)&&!this.graph.isContainer(t))n=t,t=this.graph.getModel().getParent(n);return n};e=mxGraphHandler.prototype.isDelayedSelection;mxGraphHandler.prototype.isDelayedSelection=function(n){var r=e.apply(this,arguments),i,t;if(!r)for(i=this.graph.getModel(),t=i.getParent(n);t!=null;){if(this.graph.isCellSelected(t)&&i.isVertex(t)){r=!0;break}t=i.getParent(t)}return r};mxGraphHandler.prototype.selectDelayed=function(n){var t,u,r,i;if(!this.graph.popupMenuHandler.isPopupTrigger(n))if(t=n.getCell(),t==null&&(t=this.cell),u=this.graph.view.getState(t),u!=null&&n.isSource(u.control))this.graph.selectCellForEvent(t,n.getEvent());else{for(r=this.graph.getModel(),i=r.getParent(t);!this.graph.isCellSelected(i)&&r.isVertex(i);)t=i,i=r.getParent(t);this.graph.selectCellForEvent(t,n.getEvent())}};mxPopupMenuHandler.prototype.getCellForPopupEvent=function(n){for(var i=n.getCell(),r=this.graph.getModel(),t=r.getParent(i);r.isVertex(t)&&!this.graph.isContainer(t);)this.graph.isCellSelected(t)&&(i=t),t=r.getParent(t);return i}}();Sidebar.prototype.init=function(){var n=STENCIL_PATH;this.addWorkflowPalette(n,!0)};Sidebar.prototype.collapsedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNUQyRTJFNjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNUQyRTJFNzZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MEUxNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MEUyNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhSMj6lrwAjcC1GyahV+dcZJgeIIFgA7":IMAGE_PATH+"/collapsed.gif";Sidebar.prototype.expandedImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAJmZmf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxREY3NzBERjZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxREY3NzBFMDZGNUYxMUU1QjZEOThCNDYxMDQ2MzNCQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFERjc3MERENkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFERjc3MERFNkY1RjExRTVCNkQ5OEI0NjEwNDYzM0JCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/expanded.gif";Sidebar.prototype.tooltipImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAbCAMAAAB7jU7LAAAACVBMVEX///+ZmZn///9Y2COLAAAAA3RSTlP//wDXyg1BAAAAOElEQVR42mXQMQ4AMAgDsWv//+iutcJmIQSk+9dJpVKpVCqVSqVSqZTdncWzF8/NeP7FkxWenPEDOnUBiL3jWx0AAAAASUVORK5CYII=":IMAGE_PATH+"/tooltip.png";Sidebar.prototype.searchImage=mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEaSURBVHjabNGxS5VxFIfxz71XaWuQUJCG/gCHhgTD9VpEETg4aMOlQRp0EoezObgcd220KQiXmpretTAHQRBdojlQEJyukPdt+b1ywfvAGc7wnHP4nlZd1yKijQW8xzNc4Su+ZOYfQ3T6/f4YNvEJYzjELXp4VVXVz263+7cR2niBxAFeZ2YPi3iHR/gYERPDwhpOsd6sz8x/mfkNG3iOlWFhFj8y89J9KvzGXER0GuEaD42mgwHqUtoljbcRsTBCeINpfM/MgZLKPpaxFxGbOCqDXmILN7hoJrTKH+axhxmcYRxP0MIDnOBDZv5q1XUNIuJxifJp+UNV7t7BFM6xeic0RMQ4Bpl5W/ol7GISx/eEUUTECrbx+f8A8xhiZht9zsgAAAAASUVORK5CYII=":IMAGE_PATH+"/search.png";Sidebar.prototype.dragPreviewBorder="1px dashed black";Sidebar.prototype.enableTooltips=!0;Sidebar.prototype.tooltipBorder=16;Sidebar.prototype.tooltipDelay=300;Sidebar.prototype.dropTargetDelay=200;Sidebar.prototype.gearImage=STENCIL_PATH+"/clipart/Gear_128x128.png";Sidebar.prototype.thumbWidth=36;Sidebar.prototype.thumbHeight=36;Sidebar.prototype.thumbPadding=document.documentMode>=5?0:1;Sidebar.prototype.thumbBorder=2;Sidebar.prototype.sidebarTitleSize=9;Sidebar.prototype.sidebarTitles=!1;Sidebar.prototype.tooltipTitles=!0;Sidebar.prototype.maxTooltipWidth=400;Sidebar.prototype.maxTooltipHeight=400;Sidebar.prototype.addStencilsToIndex=!0;Sidebar.prototype.defaultImageWidth=80;Sidebar.prototype.defaultImageHeight=80;Sidebar.prototype.getTooltipOffset=function(){return new mxPoint(0,0)};Sidebar.prototype.showTooltip=function(n,t,i,r,u,f){if(this.enableTooltips&&this.showTooltips&&this.currentElt!=n){this.thread!=null&&(window.clearTimeout(this.thread),this.thread=null);var e=mxUtils.bind(this,function(){var l,s;this.tooltip==null&&(this.tooltip=document.createElement("div"),this.tooltip.className="geSidebarTooltip",this.tooltip.style.zIndex=mxPopupMenu.prototype.zIndex-1,document.body.appendChild(this.tooltip),this.graph2=new Graph(this.tooltip,null,null,this.editorUi.editor.graph.getStylesheet()),this.graph2.resetViewOnRootChange=!1,this.graph2.foldingEnabled=!1,this.graph2.gridEnabled=!1,this.graph2.autoScroll=!1,this.graph2.setTooltips(!1),this.graph2.setConnectable(!1),this.graph2.setEnabled(!1),mxClient.IS_SVG||(this.graph2.view.canvas.style.position="relative"),this.tooltipImage=mxUtils.createImage(this.tooltipImage),this.tooltipImage.className="geSidebarTooltipImage",this.tooltipImage.style.zIndex=mxPopupMenu.prototype.zIndex-1,this.tooltipImage.style.position="absolute",this.tooltipImage.style.width="14px",this.tooltipImage.style.height="27px",document.body.appendChild(this.tooltipImage));this.graph2.model.clear();this.graph2.view.setTranslate(this.tooltipBorder,this.tooltipBorder);this.graph2.view.scale=i>this.maxTooltipWidth||r>this.maxTooltipHeight?Math.round(Math.min(this.maxTooltipWidth/i,this.maxTooltipHeight/r)*100)/100:1;this.tooltip.style.display="block";this.graph2.labelsVisible=f==null||f;l=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject;this.graph2.addCells(t);mxClient.NO_FO=l;var o=this.graph2.getGraphBounds(),p=o.width+2*this.tooltipBorder+4,e=o.height+2*this.tooltipBorder;mxClient.IS_QUIRKS?(e+=4,this.tooltip.style.overflow="hidden"):this.tooltip.style.overflow="visible";this.tooltipImage.style.visibility="visible";this.tooltip.style.width=p+"px";this.tooltipTitles&&u!=null&&u.length>0?(this.tooltipTitle==null?(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.style.borderTop="1px solid gray",this.tooltipTitle.style.textAlign="center",this.tooltipTitle.style.width="100%",this.tooltipTitle.style.overflow="hidden",this.tooltipTitle.style.position="absolute",this.tooltipTitle.style.paddingTop="6px",this.tooltipTitle.style.bottom="6px",this.tooltip.appendChild(this.tooltipTitle)):this.tooltipTitle.innerHTML="",this.tooltipTitle.style.display="",mxUtils.write(this.tooltipTitle,u),s=this.tooltipTitle.offsetHeight+10,e+=s,mxClient.IS_SVG?this.tooltipTitle.style.marginTop=2-s+"px":(e-=6,this.tooltipTitle.style.top=e-s+"px")):this.tooltipTitle!=null&&this.tooltipTitle.parentNode!=null&&(this.tooltipTitle.style.display="none");this.tooltip.style.height=e+"px";var h=-Math.round(o.x-this.tooltipBorder),c=-Math.round(o.y-this.tooltipBorder),w=document.body,b=document.documentElement,a=this.getTooltipOffset(),k=Math.max(w.clientHeight||0,b.clientHeight),v=this.container.clientWidth+this.editorUi.splitSize+3+this.editorUi.container.offsetLeft+a.x,y=Math.min(k-e-20,Math.max(0,this.editorUi.container.offsetTop+this.container.offsetTop+n.offsetTop-this.container.scrollTop-e/2+16))+a.y;mxClient.IS_SVG?h!=0||c!=0?this.graph2.view.canvas.setAttribute("transform","translate("+h+","+c+")"):this.graph2.view.canvas.removeAttribute("transform"):(this.graph2.view.drawPane.style.left=h+"px",this.graph2.view.drawPane.style.top=c+"px");this.tooltip.style.position="absolute";this.tooltip.style.left=v+"px";this.tooltip.style.top=y+"px";this.tooltipImage.style.left=v-13+"px";this.tooltipImage.style.top=y+e/2-13+"px"});this.tooltip!=null&&this.tooltip.style.display!="none"?e():this.thread=window.setTimeout(e,this.tooltipDelay);this.currentElt=n}};Sidebar.prototype.hideTooltip=function(){this.thread!=null&&(window.clearTimeout(this.thread),this.thread=null);this.tooltip!=null&&(this.tooltip.style.display="none",this.tooltipImage.style.visibility="hidden",this.currentElt=null)};Sidebar.prototype.addDataEntry=function(n,t,i,r,u){return this.addEntry(n,mxUtils.bind(this,function(){return this.createVertexTemplateFromData(u,t,i,r)}))};Sidebar.prototype.addEntry=function(n,t){var r,u,i,f;if(this.taglist!=null&&n!=null&&n.length>0)for(r=n.toLowerCase().replace(/[\/\,\(\)]/g," ").split(" "),u=mxUtils.bind(this,function(n){if(n.length>1){var i=this.taglist[n];typeof i!="object"&&(i={entries:[],dict:new mxDictionary},this.taglist[n]=i);i.dict.get(t)==null&&(i.dict.put(t,t),i.entries.push(t))}}),i=0;i<r.length;i++)u(r[i]),f=r[i].replace(/\.*\d*$/,""),f!=r[i]&&u(f);return t};Sidebar.prototype.searchEntries=function(n,t,i,r){var o,c,l,s,u,y;if(this.taglist!=null&&n!=null){var f=n.toLowerCase().split(" "),a=new mxDictionary,h=(i+1)*t,e=[],v=0;for(o=0;o<f.length;o++)if(f[o].length>0){if(u=this.taglist[f[o]],c=new mxDictionary,u!=null){for(l=u.entries,e=[],s=0;s<l.length;s++)if(u=l[s],v==0==(a.get(u)==null)&&(c.put(u,u),e.push(u),o==f.length-1&&e.length==h)){r(e.slice(i*t,h),h,!0,f);return}}else e=[];a=c;v++}y=e.length;r(e.slice(i*t,(i+1)*t),y,!1,f)}else r([],null,null,f)};Sidebar.prototype.filterTags=function(n){var t;if(n!=null){var i=n.split(" "),r=[],u={};for(t=0;t<i.length;t++)u[i[t]]==null&&(u[i[t]]="1",r.push(i[t]));return r.join(" ")}return null};Sidebar.prototype.cloneCell=function(n,t){var i=n.clone();return t!=null&&(i.value=t),i};Sidebar.prototype.insertSearchHint=function(n,t,i,r,u){if(u.length==0&&r==1){var f=document.createElement("div");f.className="geTitle";f.style.cssText="background-color:transparent;border-color:transparent;color:gray;padding:6px 0px 0px 0px !important;margin:4px 8px 4px 8px;text-align:center;cursor:default !important";mxUtils.write(f,mxResources.get("noResultsFor",[t]));n.appendChild(f)}};Sidebar.prototype.addWorkflowPalette=function(n,t){var i=this,f=mxUtils.createXmlDocument(),u=f.createElement("activity"),r,e;u.setAttribute("label","");u.setAttribute("placeholders","1");u.setAttribute("nodeName","流程开始");u.setAttribute("nodeType","0");r=f.createElement("activity");r.setAttribute("label","");r.setAttribute("placeholders","1");r.setAttribute("nodeName","流程结束");r.setAttribute("nodeType","99");e=[this.createVertexTemplateEntry("ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=1;shadow=1;comic=0;strokeColor=#A0C88F;fillColor=#A0C88F;gradientColor=#FFFFFF;fontSize=20;fontColor=#000033;align=center;gradientDirection=east;shadow=1;",40,40,u,"开始",!1,null,"活动开始"),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","step").join(" "),function(){var u=mxUtils.createXmlDocument(),n=u.createElement("activity"),r,t;return n.setAttribute("label",""),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","路由分支"),n.setAttribute("nodeType","8"),n.setAttribute("gateway","1"),n.setAttribute("direction","1"),r=n,t=new mxCell(r,new mxGeometry(0,0,60,60),"image;html=1;labelBackgroundColor=#ffffff;image="+IMAGE_PATH+"/symbols/fork.png;"),t.vertex=!0,i.createVertexTemplateFromCells([t],t.geometry.width,t.geometry.height,"路由分支",!1)}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","step").join(" "),function(){var u=mxUtils.createXmlDocument(),n=u.createElement("activity"),r,t;return n.setAttribute("label",""),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","路由合并"),n.setAttribute("nodeType","8"),n.setAttribute("gateway","2"),n.setAttribute("direction","16"),r=n,t=new mxCell(r,new mxGeometry(0,0,60,60),"image;html=1;labelBackgroundColor=#ffffff;image="+IMAGE_PATH+"/symbols/merge.png"),t.vertex=!0,i.createVertexTemplateFromCells([t],t.geometry.width,t.geometry.height,"路由合并",!1)}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","user_task").join(" "),function(){var u=mxUtils.createXmlDocument(),n=u.createElement("activity"),f,t,r;return n.setAttribute("label","普通任务"),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","普通任务"),n.setAttribute("nodeDesc",""),n.setAttribute("nodeType","1"),n.setAttribute("isAssign","1"),n.setAttribute("isAppoint","0"),n.setAttribute("approverMethod","1"),n.setAttribute("noticeApprover","1"),n.setAttribute("noticeApplicant","0"),n.setAttribute("isMail","1"),n.setAttribute("isMessage","1"),n.appendChild(u.createElement("participants")),n.appendChild(u.createElement("fields")),n.setAttribute("billTemplate",""),f=n,t=new mxCell(f,new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;strokeColor=#808080;gradientColor=#d4e1f5;gradientDirection=west;shadow=1"),t.vertex=!0,r=new mxCell("",new mxGeometry(0,0,14,14),"html=1;shape=mxgraph.bpmn.user_task;"),r.vertex=!0,r.geometry.relative=!0,r.geometry.offset=new mxPoint(7,7),r.setConnectable(!1),t.insert(r),i.createVertexTemplateFromCells([t],t.geometry.width,t.geometry.height,"普通任务")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","sign_task").join(" "),function(){var f=mxUtils.createXmlDocument(),n=f.createElement("activity"),e,t,r,u;return n.setAttribute("label","会签任务"),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","会签任务"),n.setAttribute("nodeDesc",""),n.setAttribute("nodeType","2"),n.setAttribute("passRate","100"),n.setAttribute("isAppoint","0"),n.setAttribute("noticeApprover","1"),n.setAttribute("noticeApplicant","0"),n.setAttribute("isMail","1"),n.setAttribute("isMessage","1"),n.appendChild(f.createElement("participants")),n.appendChild(f.createElement("fields")),n.setAttribute("billTemplate",""),e=n,t=new mxCell(e,new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;strokeColor=#808080;gradientColor=#d4e1f5;gradientDirection=west;shadow=1"),t.vertex=!0,r=new mxCell("",new mxGeometry(0,0,14,14),"html=1;shape=mxgraph.bpmn.user_task;"),r.vertex=!0,r.geometry.relative=!0,r.geometry.offset=new mxPoint(7,7),r.setConnectable(!1),t.insert(r),u=new mxCell("",new mxGeometry(.5,1,14,14),"html=1;shape=plus;"),u.vertex=!0,u.geometry.relative=!0,u.geometry.offset=new mxPoint(-7,-14),u.setConnectable(!1),t.insert(u),i.createVertexTemplateFromCells([t],t.geometry.width,t.geometry.height,"会签任务")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","timer_node").join(" "),function(){var u=mxUtils.createXmlDocument(),n=u.createElement("activity"),f,r,t;return n.setAttribute("label","定时任务"),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","定时任务"),n.setAttribute("nodeDesc",""),n.setAttribute("nodeType","3"),n.setAttribute("expiration","10"),n.setAttribute("isAppoint","0"),n.setAttribute("noticeApprover","1"),n.setAttribute("noticeApplicant","0"),n.setAttribute("isMail","1"),n.setAttribute("isMessage","1"),n.appendChild(u.createElement("participants")),n.appendChild(u.createElement("fields")),n.setAttribute("billTemplate",""),f=n,r=new mxCell(f,new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;strokeColor=#808080;gradientColor=#d4e1f5;gradientDirection=west;shadow=1"),r.vertex=!0,t=new mxCell("",new mxGeometry(1,0,30,30),"shape=mxgraph.bpmn.timer_start;perimeter=ellipsePerimeter;html=1;labelPosition=right;labelBackgroundColor=#ffffff;align=left;"),t.vertex=!0,t.geometry.relative=!0,t.geometry.offset=new mxPoint(-15,10),t.setConnectable(!1),r.insert(t),i.createVertexTemplateFromCells([r],135,80,"定时任务")}),this.addEntry(this.getTagsForStencil("mxgraph.bpmn","subprocess").join(" "),function(){var u=mxUtils.createXmlDocument(),n=u.createElement("activity"),t,r;return n.setAttribute("label","子流程"),n.setAttribute("placeholders","1"),n.setAttribute("nodeName","子流程"),n.setAttribute("nodeDesc",""),n.setAttribute("nodeType","98"),n.setAttribute("subProcess",""),t=new mxCell(n,new mxGeometry(0,0,120,80),"html=1;whiteSpace=wrap;rounded=1;strokeColor=#808080;gradientColor=#d4e1f5;gradientDirection=west;shadow=1"),t.vertex=!0,r=new mxCell("",new mxGeometry(.5,1,14,14),"html=1;shape=mxgraph.bpmn.loop;"),r.vertex=!0,r.geometry.relative=!0,r.geometry.offset=new mxPoint(-7,-18),r.setConnectable(!1),t.insert(r),i.createVertexTemplateFromCells([t],t.geometry.width,t.geometry.height,"子流程")}),this.addEntry("swimlane",function(){var r=mxUtils.createXmlDocument(),t=r.createElement("swimlane"),n;return t.setAttribute("label","泳道"),t.setAttribute("placeholders","1"),n=new mxCell(t,new mxGeometry(0,0,320,240),"swimlane;html=1;horizontal=0;startSize=30;gradientColor=#E0E0DF;gradientDirection=east;strokeColor=#a0a0a0;fontColor=#606060;fontStyle=0;shadow=1;rounded=0;glass=0;swimlaneLine=1;labelBackgroundColor=#efefef;"),n.vertex=!0,n.setConnectable(!1),i.createVertexTemplateFromCells([n],n.geometry.width,n.geometry.height,"泳道")}),this.createVertexTemplateEntry("ellipse;whiteSpace=wrap;html=1;aspect=fixed;rounded=1;shadow=1;comic=0;strokeColor=#AF7F73;fillColor=#DACCBC;gradientColor=#FFFFFF;fontSize=20;fontColor=#000033;align=center;gradientDirection=east;shadow=1;",40,40,r,"结束",!1,null,"活动结束"),];this.addPaletteFunctions("bpmn","BPMN ",t,e)};Sidebar.prototype.createTitle=function(n){var t=document.createElement("a");return t.setAttribute("href","javascript:void(0);"),t.setAttribute("title",mxResources.get("sidebarTooltip")),t.className="geTitle",mxUtils.write(t,n),t};Sidebar.prototype.createThumb=function(n,t,i,r,u,f,e){var l,h,c,o,a,s;return this.graph.labelsVisible=f==null||f,l=mxClient.NO_FO,mxClient.NO_FO=Editor.prototype.originalNoForeignObject,this.graph.view.scaleAndTranslate(1,0,0),this.graph.addCells(n),h=this.graph.getGraphBounds(),c=Math.floor(Math.min((t-2*this.thumbBorder)/h.width,(i-2*this.thumbBorder)/h.height)*100)/100,this.graph.view.scaleAndTranslate(c,Math.floor((t-h.width*c)/2/c-h.x),Math.floor((i-h.height*c)/2/c-h.y)),o=null,this.graph.dialect!=mxConstants.DIALECT_SVG||mxClient.NO_FO?(o=this.graph.container.cloneNode(!1),o.innerHTML=this.graph.container.innerHTML,(mxClient.IS_QUIRKS||document.documentMode==8)&&(o.firstChild.style.overflow="visible")):o=this.graph.view.getCanvas().ownerSVGElement.cloneNode(!0),this.graph.getModel().clear(),mxClient.NO_FO=l,mxClient.IS_IE6&&(r.style.backgroundImage="url("+this.editorUi.editor.transparentImage+")"),o.style.position="relative",o.style.overflow="hidden",o.style.cursor="move",o.style.left=this.thumbBorder+"px",o.style.top=this.thumbBorder+"px",o.style.width=t+"px",o.style.height=i+"px",o.style.visibility="",o.style.minWidth="",o.style.minHeight="",r.appendChild(o),this.sidebarTitles&&u!=null&&e!=!1&&(a=mxClient.IS_QUIRKS?2*this.thumbPadding+2:0,r.style.height=this.thumbHeight+a+this.sidebarTitleSize+8+"px",s=document.createElement("div"),s.style.fontSize=this.sidebarTitleSize+"px",s.style.color="#303030",s.style.textAlign="center",s.style.whiteSpace="nowrap",mxClient.IS_IE&&(s.style.height=this.sidebarTitleSize+12+"px"),s.style.paddingTop="4px",mxUtils.write(s,u),r.appendChild(s)),h};Sidebar.prototype.createItem=function(n,t,i,r,u,f,e){var o=document.createElement("a"),c,s,h;return o.setAttribute("href","javascript:void(0);"),o.className="geItem",o.style.overflow="hidden",c=mxClient.IS_QUIRKS?8+2*this.thumbPadding:2*this.thumbBorder,o.style.width=this.thumbWidth+c+"px",o.style.height=this.thumbHeight+c+"px",o.style.padding=this.thumbPadding+"px",mxClient.IS_IE6&&(o.style.border="none"),mxEvent.addListener(o,"click",function(n){mxEvent.consume(n)}),this.createThumb(n,this.thumbWidth,this.thumbHeight,o,t,i,r,u,f),s=new mxRectangle(0,0,u,f),n.length>1||n[0].vertex?(h=this.createDragSource(o,this.createDropHandler(n,!0,e,s),this.createDragPreview(u,f),n,s),this.addClickHandler(o,h,n),h.isGuidesEnabled=mxUtils.bind(this,function(){return this.editorUi.editor.graph.graphHandler.guidesEnabled})):n[0]!=null&&n[0].edge&&(h=this.createDragSource(o,this.createDropHandler(n,!1,e,s),this.createDragPreview(u,f),n,s),this.addClickHandler(o,h,n)),mxClient.IS_IOS||mxEvent.addGestureListeners(o,null,mxUtils.bind(this,function(r){mxEvent.isMouseEvent(r)&&this.showTooltip(o,n,s.width,s.height,t,i)})),o};Sidebar.prototype.existStartOrEndNode=function(n,t){var i,r;if(t=="0"||t=="99"){i=n.getModel().cells;for(r in i){let u=i[r],n=u.getAttribute("nodeType");if(n){if(t=="0"&&n==t)return layer.msg("只需要一个开始节点即可"),!0;if(t=="99"&&n==t)return layer.msg("只需要一个结束节点即可"),!0}}}return!1};Sidebar.prototype.updateShapes=function(n,t){var i=this.editorUi.editor.graph,c=i.getCellStyle(n),l=[],a,o,f,r,e,s,v,u,h;i.model.beginUpdate();try{for(a=i.getModel().getStyle(n),o=["shadow","dashed","dashPattern","fontFamily","fontSize","fontColor","align","startFill","startSize","endFill","endSize","strokeColor","strokeWidth","fillColor","gradientColor","html","part","noEdgeStyle","edgeStyle","elbow","childLayout","recursiveResize","container","collapsible","connectable"],f=0;f<t.length;f++){r=t[f];let y=r.value.getAttribute("nodeType");if(existStartOrEndNode(i,y))return!0;if(i.getModel().isVertex(r)==i.getModel().isVertex(n)||i.getModel().isEdge(r)==i.getModel().isEdge(n)){if(e=i.view.getState(r),s=e!=null?e.style:i.getCellStyle(t[f]),i.getModel().setStyle(r,a),e!=null&&mxUtils.getValue(e.style,"composite","0")=="1")for(v=i.model.getChildCount(r),u=v;u>=0;u--)i.model.remove(i.model.getChildAt(r,u));if(s!=null)for(s[mxConstants.STYLE_SHAPE]=="umlLifeline"&&c[mxConstants.STYLE_SHAPE]!="umlLifeline"&&(i.setCellStyles(mxConstants.STYLE_SHAPE,"umlLifeline",[r]),i.setCellStyles("participant",c[mxConstants.STYLE_SHAPE],[r])),u=0;u<o.length;u++)h=s[o[u]],h!=null&&i.setCellStyles(o[u],h,[r]);l.push(r)}}}finally{i.model.endUpdate()}return l};Sidebar.prototype.createDropHandler=function(n,t,i,r){return i=i!=null?i:!0,mxUtils.bind(this,function(u,f,e,o,s){var v,h,l,a,c;if(u.isEnabled()){if(n=u.getImportableCells(n),n.length>0){u.stopEditing();let k=n[0].value.getAttribute("nodeType");if(this.existStartOrEndNode(u,k))return;if(v=e!=null&&!mxEvent.isAltDown(f)?u.isValidDropTarget(e,n,f):!1,h=null,e==null||v||(e=null),!u.isCellLocked(e||u.getDefaultParent())){u.model.beginUpdate();try{if(o=Math.round(o),s=Math.round(s),t&&u.isSplitTarget(e,n,f)?(l=u.cloneCells(n),u.splitEdge(e,l,null,o-r.width/2,s-r.height/2),h=l):n.length>0&&(h=u.importCells(n,o,s,e)),u.layoutManager!=null&&(a=u.layoutManager.getLayout(e),a!=null)){var y=u.view.scale,p=u.view.translate,w=(o+p.x)*y,b=(s+p.y)*y;for(c=0;c<h.length;c++)a.moveCell(h[c],w,b)}i&&u.fireEvent(new mxEventObject("cellsInserted","cells",h))}finally{u.model.endUpdate()}h!=null&&h.length>0&&(u.scrollCellToVisible(h[0]),u.setSelectionCells(h))}}mxEvent.consume(f)}})};Sidebar.prototype.createDragPreview=function(n,t){var i=document.createElement("div");return i.style.border=this.dragPreviewBorder,i.style.width=n+"px",i.style.height=t+"px",i};Sidebar.prototype.dropAndConnect=function(n,t,i,r){var f=this.getDropAndConnectGeometry(n,t[r],i,t),s=[],u,b,y,l,a,v,p,w,o,g,e,nt;if(f!=null){if(u=this.editorUi.editor.graph,t[r]){let n=t[r].value.getAttribute("nodeType");if(this.existStartOrEndNode(u,n))return}u.model.beginUpdate();try{var k=u.getCellGeometry(n),h=u.getCellGeometry(t[r]),c=u.model.getParent(n),d=!0;u.layoutManager!=null&&(b=u.layoutManager.getLayout(c),b!=null&&b.constructor==mxStackLayout&&(d=!1,s=u.view.getState(c),s!=null&&(o=new mxPoint(s.x/u.view.scale-u.view.translate.x,s.y/u.view.scale-u.view.translate.y),f.x+=o.x,f.y+=o.y,y=f.getTerminalPoint(!1),y!=null&&(y.x+=o.x,y.y+=o.y))));l=h.x;a=h.y;u.model.isEdge(t[r])&&(l=0,a=0);v=u.model.isEdge(n)||k!=null&&!k.relative&&d;t=u.importCells(t,f.x-(v?l:0),f.y-(v?a:0),v?c:null);s=t;u.model.isEdge(n)?u.model.setTerminal(n,t[r],i==mxConstants.DIRECTION_NORTH):u.model.isEdge(t[r])?(u.model.setTerminal(t[r],n,!0),p=u.getCellGeometry(t[r]),p.points=null,p.getTerminalPoint(!1)!=null?p.setTerminalPoint(f.getTerminalPoint(!1),!1):v&&u.model.isVertex(c)&&(w=u.view.getState(c),o=w.cell!=u.view.currentRoot?new mxPoint(w.x/u.view.scale-u.view.translate.x,w.y/u.view.scale-u.view.translate.y):new mxPoint(0,0),u.cellsMoved(t,o.x,o.y,null,null,!0))):(h=u.getCellGeometry(t[r]),l=f.x-Math.round(h.x),a=f.y-Math.round(h.y),f.x=Math.round(h.x),f.y=Math.round(h.y),u.model.setGeometry(t[r],f),u.cellsMoved(t,l,a,null,null,!0),s=t.slice(),g=mxUtils.createXmlDocument(),e=g.createElement("transition"),e.setAttribute("label","无"),e.setAttribute("placeholders","1"),e.setAttribute("nodeName","流转设置"),e.setAttribute("nodeDesc",""),e.setAttribute("nodeType","100"),e.setAttribute("priority","1"),e.setAttribute("condition",""),nt=u.insertEdge(null,null,e,n,t[r],u.createCurrentEdgeStyle()),t.push(nt));u.fireEvent(new mxEventObject("cellsInserted","cells",t))}finally{u.model.endUpdate()}}return s};Sidebar.prototype.getDropAndConnectGeometry=function(n,t,i,r){var h=this.editorUi.editor.graph,o=h.view,w=r.length>1,f=h.getCellGeometry(n),u=h.getCellGeometry(t),c,s,e;if(f!=null&&u!=null)if(u=u.clone(),h.model.isEdge(n)){var c=h.view.getState(n),v=c.absolutePoints,l=v[0],a=v[v.length-1];i==mxConstants.DIRECTION_NORTH?(u.x=l.x/o.scale-o.translate.x-u.width/2,u.y=l.y/o.scale-o.translate.y-u.height/2):(u.x=a.x/o.scale-o.translate.x-u.width/2,u.y=a.y/o.scale-o.translate.y-u.height/2)}else if(f.relative&&(c=h.view.getState(n),f=f.clone(),f.x=(c.x-o.translate.x)/o.scale,f.y=(c.y-o.translate.y)/o.scale),s=h.defaultEdgeLength,h.model.isEdge(t)&&u.getTerminalPoint(!0)!=null&&u.getTerminalPoint(!1)!=null){var l=u.getTerminalPoint(!0),a=u.getTerminalPoint(!1),y=a.x-l.x,p=a.y-l.y;s=Math.sqrt(y*y+p*p);u.x=f.getCenterX();u.y=f.getCenterY();u.width=1;u.height=1;i==mxConstants.DIRECTION_NORTH?(u.height=s,u.y=f.y-s,u.setTerminalPoint(new mxPoint(u.x,u.y),!1)):i==mxConstants.DIRECTION_EAST?(u.width=s,u.x=f.x+f.width,u.setTerminalPoint(new mxPoint(u.x+u.width,u.y),!1)):i==mxConstants.DIRECTION_SOUTH?(u.height=s,u.y=f.y+f.height,u.setTerminalPoint(new mxPoint(u.x,u.y+u.height),!1)):i==mxConstants.DIRECTION_WEST&&(u.width=s,u.x=f.x-s,u.setTerminalPoint(new mxPoint(u.x,u.y),!1))}else!w&&u.width>45&&u.height>45&&f.width>45&&f.height>45&&(u.width=u.width*(f.height/u.height),u.height=f.height),u.x=f.x+f.width/2-u.width/2,u.y=f.y+f.height/2-u.height/2,i==mxConstants.DIRECTION_NORTH?u.y=u.y-f.height/2-u.height/2-s:i==mxConstants.DIRECTION_EAST?u.x=u.x+f.width/2+u.width/2+s:i==mxConstants.DIRECTION_SOUTH?u.y=u.y+f.height/2+u.height/2+s:i==mxConstants.DIRECTION_WEST&&(u.x=u.x-f.width/2-u.width/2-s),h.model.isEdge(t)&&u.getTerminalPoint(!0)!=null&&t.getTerminal(!1)!=null&&(e=h.getCellGeometry(t.getTerminal(!1)),e!=null&&(i==mxConstants.DIRECTION_NORTH?(u.x-=e.getCenterX(),u.y-=e.getCenterY()+e.height/2):i==mxConstants.DIRECTION_EAST?(u.x-=e.getCenterX()-e.width/2,u.y-=e.getCenterY()):i==mxConstants.DIRECTION_SOUTH?(u.x-=e.getCenterX(),u.y-=e.getCenterY()-e.height/2):i==mxConstants.DIRECTION_WEST&&(u.x-=e.getCenterX()+e.width/2,u.y-=e.getCenterY())));return u};Sidebar.prototype.createDragSource=function(n,t,i,r,u){function tt(n,t){var i=null;return mxClient.IS_IE&&!mxClient.IS_SVG?(mxClient.IS_IE6&&document.compatMode!="CSS1Compat"?(i=document.createElement(mxClient.VML_PREFIX+":image"),i.setAttribute("src",n.src),i.style.borderStyle="none"):(i=document.createElement("div"),i.style.backgroundImage="url("+n.src+")",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat"),i.style.width=n.width+4+"px",i.style.height=n.height+4+"px",i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"):(i=mxUtils.createImage(n.src),i.style.width=n.width+"px",i.style.height=n.height+"px"),t!=null&&i.setAttribute("title",t),mxUtils.setOpacity(i,n==this.refreshTarget?30:20),i.style.position="absolute",i.style.cursor="crosshair",i}function d(n,t,i,r){return r.parentNode!=null&&(mxUtils.contains(i,n,t)?(mxUtils.setOpacity(r,100),o=r):mxUtils.setOpacity(r,r==h?30:20)),i}for(var s,ot,st,ht,ct,ut=this.editorUi,vt=ut.editor.graph,g=null,c=null,yt=this,nt=0;nt<r.length;nt++)if(c==null&&this.editorUi.editor.graph.model.isVertex(r[nt])?c=nt:g==null&&this.editorUi.editor.graph.model.isEdge(r[nt])&&this.editorUi.editor.graph.model.getTerminal(r[nt],!0)==null&&(g=nt),c!=null&&g!=null)break;s=mxUtils.makeDraggable(n,this.editorUi.editor.graph,mxUtils.bind(this,function(n){var i,u,s;this.updateThread!=null&&window.clearTimeout(this.updateThread);r!=null&&e!=null&&o==h?(i=n.isCellSelected(e.cell)?n.getSelectionCells():[e.cell],u=this.updateShapes(n.model.isEdge(e.cell)?r[0]:r[c],i),n.setSelectionCells(u)):r!=null&&o!=null&&f!=null&&o!=h?(s=n.model.isEdge(f.cell)||g==null?c:g,n.setSelectionCells(this.dropAndConnect(f.cell,r,rt,s))):t.apply(this,arguments);this.editorUi.hoverIcons!=null&&this.editorUi.hoverIcons.update(n.view.getState(n.getSelectionCell()))}),i,0,0,this.editorUi.editor.graph.autoscroll,!0,!0);this.editorUi.editor.graph.addListener(mxEvent.ESCAPE,function(){s.isActive()&&s.reset()});ot=s.mouseDown;s.mouseDown=function(n){mxEvent.isPopupTrigger(n)||mxEvent.isMultiTouchEvent(n)||(vt.stopEditing(),ot.apply(this,arguments))};var f=null,a=null,e=null,ft=!1,p=tt(this.triangleUp,mxResources.get("connect")),v=tt(this.triangleRight,mxResources.get("connect")),w=tt(this.triangleDown,mxResources.get("connect")),b=tt(this.triangleLeft,mxResources.get("connect")),h=tt(this.refreshTarget,mxResources.get("replace")),it=null,k=tt(this.roundDrop),y=tt(this.roundDrop),rt=mxConstants.DIRECTION_NORTH,o=null;st=s.createPreviewElement;s.createPreviewElement=function(){var n=st.apply(this,arguments);return mxClient.IS_SVG&&(n.style.pointerEvents="none"),this.previewElementWidth=n.style.width,this.previewElementHeight=n.style.height,n};ht=s.dragEnter;s.dragEnter=function(){ut.hoverIcons!=null&&ut.hoverIcons.setDisplay("none");ht.apply(this,arguments)};ct=s.dragExit;s.dragExit=function(){ut.hoverIcons!=null&&ut.hoverIcons.setDisplay("");ct.apply(this,arguments)};s.dragOver=function(n){var t,v,y,p;if(mxDragSource.prototype.dragOver.apply(this,arguments),this.currentGuide!=null&&o!=null&&this.currentGuide.hide(),this.previewElement!=null)if(t=n.view,e!=null&&o==h)this.previewElement.style.display=n.model.isEdge(e.cell)?"none":"",this.previewElement.style.left=e.x+"px",this.previewElement.style.top=e.y+"px",this.previewElement.style.width=e.width+"px",this.previewElement.style.height=e.height+"px";else if(f!=null&&o!=null){var l=n.model.isEdge(f.cell)||g==null?c:g,i=yt.getDropAndConnectGeometry(f.cell,r[l],rt,r),w=n.model.isEdge(f.cell)?null:n.getCellGeometry(f.cell),b=n.getCellGeometry(r[l]),a=n.model.getParent(f.cell),k=t.translate.x*t.scale,d=t.translate.y*t.scale;w!=null&&!w.relative&&n.model.isVertex(a)&&a!=t.currentRoot&&(v=t.getState(a),k=v.x,d=v.y);y=b.x;p=b.y;n.model.isEdge(r[l])&&(y=0,p=0);this.previewElement.style.left=(i.x-y)*t.scale+k+"px";this.previewElement.style.top=(i.y-p)*t.scale+d+"px";r.length==1&&(this.previewElement.style.width=i.width*t.scale+"px",this.previewElement.style.height=i.height*t.scale+"px");this.previewElement.style.display=""}else s.currentHighlight.state!=null&&n.model.isEdge(s.currentHighlight.state.cell)?(this.previewElement.style.left=Math.round(parseInt(this.previewElement.style.left)-u.width*t.scale/2)+"px",this.previewElement.style.top=Math.round(parseInt(this.previewElement.style.top)-u.height*t.scale/2)+"px"):(this.previewElement.style.width=this.previewElementWidth,this.previewElement.style.height=this.previewElementHeight,this.previewElement.style.display="")};var lt=(new Date).getTime(),l=0,et=null,at=this.editorUi.editor.graph.getCellStyle(r[0]);return s.getDropTarget=mxUtils.bind(this,function(n,t,i,u){var ot=!mxEvent.isAltDown(u)&&r!=null?n.getCellAt(t,i):null,kt,g,st,ht,pt,wt,gt,yt,nt,tt,vt,ct,ut,bt;if(ot==null||this.graph.isCellConnectable(ot)||(kt=this.graph.getModel().getParent(ot),this.graph.getModel().isVertex(kt)&&this.graph.isCellConnectable(kt)&&(ot=kt)),n.isCellLocked(ot)&&(ot=null),g=n.view.getState(ot),o=null,st=null,et!=g?(et=g,lt=(new Date).getTime(),l=0,this.updateThread!=null&&window.clearTimeout(this.updateThread),g!=null&&(this.updateThread=window.setTimeout(function(){o==null&&(et=g,s.getDropTarget(n,t,i,u))},this.dropTargetDelay+10))):l=(new Date).getTime()-lt,l<2500&&g!=null&&!mxEvent.isShiftDown(u)&&(mxUtils.getValue(g.style,mxConstants.STYLE_SHAPE)!=mxUtils.getValue(at,mxConstants.STYLE_SHAPE)&&(mxUtils.getValue(g.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE)!=mxConstants.NONE||mxUtils.getValue(g.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE)!=mxConstants.NONE||mxUtils.getValue(g.style,mxConstants.STYLE_GRADIENTCOLOR,mxConstants.NONE)!=mxConstants.NONE)||mxUtils.getValue(at,mxConstants.STYLE_SHAPE)=="image"||l>1500||n.model.isEdge(g.cell))&&l>this.dropTargetDelay&&(n.model.isVertex(g.cell)&&c!=null||n.model.isEdge(g.cell)&&n.model.isEdge(r[0]))?(e=g,ht=n.model.isEdge(g.cell)?n.view.getPoint(g):new mxPoint(g.getCenterX(),g.getCenterY()),ht=new mxRectangle(ht.x-this.refreshTarget.width/2,ht.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),h.style.left=Math.floor(ht.x)+"px",h.style.top=Math.floor(ht.y)+"px",it==null&&(n.container.appendChild(h),it=h.parentNode),d(t,i,ht,h)):e==null||!mxUtils.contains(e,t,i)||l>1500&&!mxEvent.isShiftDown(u)?(e=null,it!=null&&(h.parentNode.removeChild(h),it=null)):e!=null&&it!=null&&(ht=n.model.isEdge(e.cell)?n.view.getPoint(e):new mxPoint(e.getCenterX(),e.getCenterY()),ht=new mxRectangle(ht.x-this.refreshTarget.width/2,ht.y-this.refreshTarget.height/2,this.refreshTarget.width,this.refreshTarget.height),d(t,i,ht,h)),ft&&f!=null&&!mxEvent.isAltDown(u)&&o==null&&(st=mxRectangle.fromRectangle(f),n.model.isEdge(f.cell)?(yt=f.absolutePoints,k.parentNode!=null&&(pt=yt[0],st.add(d(t,i,new mxRectangle(pt.x-this.roundDrop.width/2,pt.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),k))),y.parentNode!=null&&(wt=yt[yt.length-1],st.add(d(t,i,new mxRectangle(wt.x-this.roundDrop.width/2,wt.y-this.roundDrop.height/2,this.roundDrop.width,this.roundDrop.height),y)))):(nt=mxRectangle.fromRectangle(f),f.shape!=null&&f.shape.boundingBox!=null&&(nt=mxRectangle.fromRectangle(f.shape.boundingBox)),nt.grow(this.graph.tolerance),nt.grow(HoverIcons.prototype.arrowSpacing),tt=this.graph.selectionCellsHandler.getHandler(f.cell),tt!=null&&(nt.x-=tt.horizontalOffset/2,nt.y-=tt.verticalOffset/2,nt.width+=tt.horizontalOffset,nt.height+=tt.verticalOffset,tt.rotationShape!=null&&tt.rotationShape.node!=null&&tt.rotationShape.node.style.visibility!="hidden"&&tt.rotationShape.node.style.display!="none"&&tt.rotationShape.boundingBox!=null&&nt.add(tt.rotationShape.boundingBox)),st.add(d(t,i,new mxRectangle(f.getCenterX()-this.triangleUp.width/2,nt.y-this.triangleUp.height,this.triangleUp.width,this.triangleUp.height),p)),st.add(d(t,i,new mxRectangle(nt.x+nt.width,f.getCenterY()-this.triangleRight.height/2,this.triangleRight.width,this.triangleRight.height),v)),st.add(d(t,i,new mxRectangle(f.getCenterX()-this.triangleDown.width/2,nt.y+nt.height,this.triangleDown.width,this.triangleDown.height),w)),st.add(d(t,i,new mxRectangle(nt.x-this.triangleLeft.width,f.getCenterY()-this.triangleLeft.height/2,this.triangleLeft.width,this.triangleLeft.height),b))),st!=null&&st.grow(10)),rt=mxConstants.DIRECTION_NORTH,o==v?rt=mxConstants.DIRECTION_EAST:o==w||o==y?rt=mxConstants.DIRECTION_SOUTH:o==b&&(rt=mxConstants.DIRECTION_WEST),e!=null&&o==h&&(g=e),gt=(c==null||n.isCellConnectable(r[c]))&&(n.model.isEdge(ot)&&c!=null||n.model.isVertex(ot)&&n.isCellConnectable(ot)),f!=null&&l>=5e3||f!=g&&(st==null||!mxUtils.contains(st,t,i)||l>500&&o==null&&gt))if(ft=!1,f=l<5e3&&l>this.dropTargetDelay||n.model.isEdge(ot)?g:null,f!=null&&gt){for(vt=[k,y,p,v,w,b],ct=0;ct<vt.length;ct++)vt[ct].parentNode!=null&&vt[ct].parentNode.removeChild(vt[ct]);if(n.model.isEdge(ot)){if(yt=g.absolutePoints,yt!=null){var pt=yt[0],wt=yt[yt.length-1],dt=n.tolerance,ni=new mxRectangle(t-dt,i-dt,2*dt,2*dt);k.style.left=Math.floor(pt.x-this.roundDrop.width/2)+"px";k.style.top=Math.floor(pt.y-this.roundDrop.height/2)+"px";y.style.left=Math.floor(wt.x-this.roundDrop.width/2)+"px";y.style.top=Math.floor(wt.y-this.roundDrop.height/2)+"px";n.model.getTerminal(ot,!0)==null&&n.container.appendChild(k);n.model.getTerminal(ot,!1)==null&&n.container.appendChild(y)}}else nt=mxRectangle.fromRectangle(g),g.shape!=null&&g.shape.boundingBox!=null&&(nt=mxRectangle.fromRectangle(g.shape.boundingBox)),nt.grow(this.graph.tolerance),nt.grow(HoverIcons.prototype.arrowSpacing),tt=this.graph.selectionCellsHandler.getHandler(g.cell),tt!=null&&(nt.x-=tt.horizontalOffset/2,nt.y-=tt.verticalOffset/2,nt.width+=tt.horizontalOffset,nt.height+=tt.verticalOffset,tt.rotationShape!=null&&tt.rotationShape.node!=null&&tt.rotationShape.node.style.visibility!="hidden"&&tt.rotationShape.node.style.display!="none"&&tt.rotationShape.boundingBox!=null&&nt.add(tt.rotationShape.boundingBox)),p.style.left=Math.floor(g.getCenterX()-this.triangleUp.width/2)+"px",p.style.top=Math.floor(nt.y-this.triangleUp.height)+"px",v.style.left=Math.floor(nt.x+nt.width)+"px",v.style.top=Math.floor(g.getCenterY()-this.triangleRight.height/2)+"px",w.style.left=p.style.left,w.style.top=Math.floor(nt.y+nt.height)+"px",b.style.left=Math.floor(nt.x-this.triangleLeft.width)+"px",b.style.top=v.style.top,g.style.portConstraint!="eastwest"&&(n.container.appendChild(p),n.container.appendChild(w)),n.container.appendChild(v),n.container.appendChild(b);g!=null&&(a=n.selectionCellsHandler.getHandler(g.cell),a!=null&&a.setHandlesVisible!=null&&a.setHandlesVisible(!1));ft=!0}else for(vt=[k,y,p,v,w,b],ct=0;ct<vt.length;ct++)vt[ct].parentNode!=null&&vt[ct].parentNode.removeChild(vt[ct]);if(ft||a==null||a.setHandlesVisible(!0),ut=(!mxEvent.isAltDown(u)||mxEvent.isShiftDown(u))&&!(e!=null&&o==h)?mxDragSource.prototype.getDropTarget.apply(this,arguments):null,bt=n.getModel(),ut!=null&&(o!=null||!n.isSplitTarget(ut,r,u))){while(ut!=null&&!n.isValidDropTarget(ut,r,u)&&bt.isVertex(bt.getParent(ut)))ut=bt.getParent(ut);(n.view.currentRoot==ut||!n.isValidRoot(ut)&&n.getModel().getChildCount(ut)==0||n.isCellLocked(ut)||bt.isEdge(ut))&&(ut=null)}return ut}),s.stopDrag=function(){var t,n;for(mxDragSource.prototype.stopDrag.apply(this,arguments),t=[k,y,h,p,v,w,b],n=0;n<t.length;n++)t[n].parentNode!=null&&t[n].parentNode.removeChild(t[n]);f!=null&&a!=null&&a.reset();a=null;f=null;e=null;it=null;o=null},s};Sidebar.prototype.itemClicked=function(n,t,i){var r=this.editorUi.editor.graph,u,f,e;if(mxEvent.isAltDown(i)){if(r.getSelectionCount()==1&&r.model.isVertex(r.getSelectionCell())){for(u=null,f=0;f<n.length&&u==null;f++)r.model.isVertex(n[f])&&(u=f);u!=null&&(r.setSelectionCells(this.dropAndConnect(r.getSelectionCell(),n,mxEvent.isMetaDown(i)||mxEvent.isControlDown(i)?mxEvent.isShiftDown(i)?mxConstants.DIRECTION_WEST:mxConstants.DIRECTION_NORTH:mxEvent.isShiftDown(i)?mxConstants.DIRECTION_EAST:mxConstants.DIRECTION_SOUTH,u)),r.scrollCellToVisible(r.getSelectionCell()))}}else if(mxEvent.isShiftDown(i)&&!r.isSelectionEmpty())this.updateShapes(n[0],r.getSelectionCells()),r.scrollCellToVisible(r.getSelectionCell());else{let u=n[0].getAttribute("nodeType");if(this.existStartOrEndNode(r,u))return;e=r.getFreeInsertPoint();t.drop(r,i,null,e.x,e.y);this.editorUi.hoverIcons!=null&&(mxEvent.isTouchEvent(i)||mxEvent.isPenEvent(i))&&this.editorUi.hoverIcons.update(r.view.getState(r.getSelectionCell()))}};Sidebar.prototype.addClickHandler=function(n,t,i){var u=this.editorUi.editor.graph,f=t.mouseUp,r=null;mxEvent.addGestureListeners(n,function(n){r=new mxPoint(mxEvent.getClientX(n),mxEvent.getClientY(n))});t.mouseUp=mxUtils.bind(this,function(e){if(!mxEvent.isPopupTrigger(e)&&this.currentGraph==null&&r!=null){var o=u.tolerance;Math.abs(r.x-mxEvent.getClientX(e))<=o&&Math.abs(r.y-mxEvent.getClientY(e))<=o&&this.itemClicked(i,t,e,n)}f.apply(t,arguments);r=null;this.currentElt=n})};Sidebar.prototype.createVertexTemplateEntry=function(n,t,i,r,u,f,e,o){return o=o!=null&&o.length>0?o:u.toLowerCase(),this.addEntry(o,mxUtils.bind(this,function(){return this.createVertexTemplate(n,t,i,r,u,f,e)}))};Sidebar.prototype.createVertexTemplate=function(n,t,i,r,u,f,e,o){var s=[new mxCell(r!=null?r:"",new mxGeometry(0,0,t,i),n)];return s[0].vertex=!0,this.createVertexTemplateFromCells(s,t,i,u,f,e,o)};Sidebar.prototype.createVertexTemplateFromData=function(n,t,i,r,u,f,e){var o=mxUtils.parseXml(this.graph.decompress(n)),c=new mxCodec(o),s=new mxGraphModel,h;return c.decode(o.documentElement,s),h=this.graph.cloneCells(s.root.getChildAt(0).children),this.createVertexTemplateFromCells(h,t,i,r,u,f,e)};Sidebar.prototype.createVertexTemplateFromCells=function(n,t,i,r,u,f,e){return this.createItem(n,r,u,f,t,i,e)};Sidebar.prototype.createEdgeTemplateEntry=function(n,t,i,r,u,f,e,o){return e=e!=null&&e.length>0?e:u.toLowerCase(),this.addEntry(e,mxUtils.bind(this,function(){return this.createEdgeTemplate(n,t,i,r,u,f,o)}))};Sidebar.prototype.createEdgeTemplate=function(n,t,i,r,u,f,e){var o=new mxCell(r!=null?r:"",new mxGeometry(0,0,t,i),n);return o.geometry.setTerminalPoint(new mxPoint(0,i),!0),o.geometry.setTerminalPoint(new mxPoint(t,0),!1),o.geometry.relative=!0,o.edge=!0,this.createEdgeTemplateFromCells([o],t,i,u,f,e)};Sidebar.prototype.createEdgeTemplateFromCells=function(n,t,i,r,u,f){return this.createItem(n,r,u,!0,t,i,f)};Sidebar.prototype.addPaletteFunctions=function(n,t,i,r){this.addPalette(n,t,i,mxUtils.bind(this,function(n){for(var t=0;t<r.length;t++)n.appendChild(r[t](n))}))};Sidebar.prototype.addPalette=function(n,t,i,r){var e=this.createTitle(t),u,f;return this.container.appendChild(e),u=document.createElement("div"),u.className="geSidebar",mxClient.IS_POINTER&&(u.style.touchAction="none"),i?(r(u),r=null):u.style.display="none",this.addFoldingHandler(e,u,r),f=document.createElement("div"),f.appendChild(u),this.container.appendChild(f),n!=null&&(this.palettes[n]=[e,f]),u};Sidebar.prototype.addFoldingHandler=function(n,t,i){var r=!1;(!mxClient.IS_IE||document.documentMode>=8)&&(n.style.backgroundImage=t.style.display=="none"?"url('"+this.collapsedImage+"')":"url('"+this.expandedImage+"')");n.style.backgroundRepeat="no-repeat";n.style.backgroundPosition="0% 50%";mxEvent.addListener(n,"click",mxUtils.bind(this,function(u){if(t.style.display=="none"){if(r)t.style.display="block";else if(r=!0,i!=null){n.style.cursor="wait";var f=n.innerHTML;n.innerHTML=mxResources.get("loading")+"...";window.setTimeout(function(){var r=mxClient.NO_FO;mxClient.NO_FO=Editor.prototype.originalNoForeignObject;i(t);mxClient.NO_FO=r;t.style.display="block";n.style.cursor="";n.innerHTML=f},0)}else t.style.display="block";n.style.backgroundImage="url('"+this.expandedImage+"')"}else n.style.backgroundImage="url('"+this.collapsedImage+"')",t.style.display="none";mxEvent.consume(u)}))};Sidebar.prototype.removePalette=function(n){var i=this.palettes[n],t;if(i!=null){for(this.palettes[n]=null,t=0;t<i.length;t++)this.container.removeChild(i[t]);return!0}return!1};Sidebar.prototype.addImagePalette=function(n,t,i,r,u,f,e){for(var h=f!=null,s=[],o=0;o<u.length;o++)mxUtils.bind(this,function(n,t,u){if(u==null){var f=n.lastIndexOf("/"),e=n.lastIndexOf(".");u=n.substring(f>=0?f+1:0,e>=0?e:n.length).replace(/[-_]/g," ")}s.push(this.createVertexTemplateEntry("image;html=1;labelBackgroundColor=#ffffff;image="+i+n+r,this.defaultImageWidth,this.defaultImageHeight,"",t,t!=null,null,this.filterTags(u)))})(u[o],f!=null?f[o]:null,e!=null?e[u[o]]:null);this.addPaletteFunctions(n,t,!1,s)};Sidebar.prototype.getTagsForStencil=function(n,t,i){for(var r=n.split("."),u=1;u<r.length;u++)r[u]=r[u].replace(/_/g," ");return r.push(t.replace(/_/g," ")),i!=null&&r.push(i),r.slice(1,r.length)};Sidebar.prototype.addStencilPalette=function(n,t,i,r,u,f,e,o,s){var h,c;if(e=e!=null?e:1,this.addStencilsToIndex){if(h=[],s!=null)for(c=0;c<s.length;c++)h.push(s[c]);mxStencilRegistry.loadStencilSet(i,mxUtils.bind(this,function(n,t,i,f,s){if(u==null||mxUtils.indexOf(u,t)<0){var c=this.getTagsForStencil(n,t),l=o!=null?o[t]:null;l!=null&&c.push(l);h.push(this.createVertexTemplateEntry("shape="+n+t.toLowerCase()+r,Math.round(f*e),Math.round(s*e),"",t.replace(/_/g," "),null,null,this.filterTags(c.join(" "))))}}),!0,!0);this.addPaletteFunctions(n,t,!1,h)}else this.addPalette(n,t,!1,mxUtils.bind(this,function(n){if(r==null&&(r=""),f!=null&&f.call(this,n),s!=null)for(var t=0;t<s.length;t++)s[t](n);mxStencilRegistry.loadStencilSet(i,mxUtils.bind(this,function(t,i,f,o,s){(u==null||mxUtils.indexOf(u,i)<0)&&n.appendChild(this.createVertexTemplate("shape="+t+i.toLowerCase()+r,Math.round(o*e),Math.round(s*e),"",i.replace(/_/g," "),!0))}),!0)}))};Sidebar.prototype.destroy=function(){this.graph!=null&&(this.graph.container!=null&&this.graph.container.parentNode!=null&&this.graph.container.parentNode.removeChild(this.graph.container),this.graph.destroy(),this.graph=null);this.pointerUpHandler!=null&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerup":"mouseup",this.pointerUpHandler),this.pointerUpHandler=null);this.pointerDownHandler!=null&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerdown":"mousedown",this.pointerDownHandler),this.pointerDownHandler=null);this.pointerMoveHandler!=null&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointermove":"mousemove",this.pointerMoveHandler),this.pointerMoveHandler=null);this.pointerOutHandler!=null&&(mxEvent.removeListener(document,mxClient.IS_POINTER?"pointerout":"mouseout",this.pointerOutHandler),this.pointerOutHandler=null)};typeof html4!="undefined"&&(html4.ATTRIBS["a::target"]=0,html4.ATTRIBS["source::src"]=0,html4.ATTRIBS["video::src"]=0);mxConstants.SHADOW_OPACITY=.25;mxConstants.SHADOWCOLOR="#000000";mxConstants.VML_SHADOWCOLOR="#d0d0d0";mxGraph.prototype.pageBreakColor="#c0c0c0";mxGraph.prototype.pageScale=1,function(){try{if(navigator!=null&&navigator.language!=null){var n=navigator.language.toLowerCase();mxGraph.prototype.pageFormat=n==="en-us"||n==="en-ca"||n==="es-mx"?mxConstants.PAGE_FORMAT_LETTER_PORTRAIT:mxConstants.PAGE_FORMAT_A4_PORTRAIT}}catch(t){}}();mxText.prototype.baseSpacingTop=5;mxText.prototype.baseSpacingBottom=1;mxGraphModel.prototype.ignoreRelativeEdgeParent=!1;mxGraphView.prototype.gridImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhCgAKAJEAAAAAAP///8zMzP///yH5BAEAAAMALAAAAAAKAAoAAAIJ1I6py+0Po2wFADs=":IMAGE_PATH+"/grid.gif";mxGraphView.prototype.gridSteps=4;mxGraphView.prototype.minGridSize=4;mxGraphView.prototype.gridColor="#e0e0e0";mxSvgCanvas2D.prototype.foAltText="[Not supported by viewer]";Graph=function(n,t,i,r,u){var e,c,o,f,tt,v,h,p,w,b,a,k,d,g,s,nt;if(mxGraph.call(this,n,t,i,r),this.themes=u||this.defaultThemes,this.currentEdgeStyle=mxUtils.clone(this.defaultEdgeStyle),this.currentVertexStyle=mxUtils.clone(this.defaultVertexStyle),e=this.baseUrl,c=e.indexOf("//"),this.domainUrl="",this.domainPathUrl="",c>0&&(o=e.indexOf("/",c+2),o>0&&(this.domainUrl=e.substring(0,o)),o=e.lastIndexOf("/"),o>0&&(this.domainPathUrl=e.substring(0,o+1))),this.isHtmlLabel=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return i.html=="1"||i[mxConstants.STYLE_WHITE_SPACE]=="wrap"},this.edgeMode&&(f={point:null,event:null,state:null,handle:null,selected:!1},this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(n,t){var i,r,u;t.getProperty("eventName")=="mouseDown"&&this.isEnabled()&&(i=t.getProperty("event"),mxEvent.isControlDown(i.getEvent())||mxEvent.isShiftDown(i.getEvent())||(r=i.getState(),r!=null&&this.model.isEdge(r.cell)&&(f.point=new mxPoint(i.getGraphX(),i.getGraphY()),f.selected=this.isCellSelected(r.cell),f.state=r,f.event=i,r.text!=null&&r.text.boundingBox!=null&&mxUtils.contains(r.text.boundingBox,i.getGraphX(),i.getGraphY())?f.handle=mxEvent.LABEL_HANDLE:(u=this.selectionCellsHandler.getHandler(r.cell),u!=null&&u.bends!=null&&u.bends.length>0&&(f.handle=u.getHandleForEvent(i))))))})),tt=null,this.addMouseListener({mouseDown:function(){},mouseMove:mxUtils.bind(this,function(n,t){var v=this.selectionCellsHandler.handlers.map,y,l,e,p,r,s,i,o,w,c;for(y in v)if(v[y].index!=null)return;if(this.isEnabled()&&!this.panningHandler.isActive()&&!mxEvent.isControlDown(t.getEvent())&&!mxEvent.isShiftDown(t.getEvent())&&!mxEvent.isAltDown(t.getEvent()))if(l=this.tolerance,f.point!=null&&f.state!=null&&f.event!=null){if(r=f.state,(Math.abs(f.point.x-t.getGraphX())>l||Math.abs(f.point.y-t.getGraphY())>l)&&(this.isCellSelected(r.cell)||this.setSelectionCell(r.cell),e=this.selectionCellsHandler.getHandler(r.cell),e!=null&&e.bends!=null&&e.bends.length>0)){var u=e.getHandleForEvent(f.event),h=this.view.getEdgeStyle(r),a=h==mxEdgeStyle.EntityRelation;f.selected||f.handle!=mxEvent.LABEL_HANDLE||(u=f.handle);a&&u!=0&&u!=e.bends.length-1&&u!=mxEvent.LABEL_HANDLE?a&&(r.visibleSourceState!=null||r.visibleTargetState!=null)&&(this.graphHandler.reset(),t.consume()):(u==mxEvent.LABEL_HANDLE||u==0||r.visibleSourceState!=null||u==e.bends.length-1||r.visibleTargetState!=null)&&(a||u==mxEvent.LABEL_HANDLE||(i=r.absolutePoints,i!=null&&(h==null&&u==null||h==mxEdgeStyle.OrthConnector)&&(u=f.handle,u==null&&(o=new mxRectangle(f.point.x,f.point.y),o.grow(mxEdgeHandler.prototype.handleImage.width/2),mxUtils.contains(o,i[0].x,i[0].y)?u=0:mxUtils.contains(o,i[i.length-1].x,i[i.length-1].y)?u=e.bends.length-1:(p=h!=null&&(i.length==2||i.length==3&&(Math.round(i[0].x-i[1].x)==0&&Math.round(i[1].x-i[2].x)==0||Math.round(i[0].y-i[1].y)==0&&Math.round(i[1].y-i[2].y)==0)),p?u=2:(u=mxUtils.findNearestSegment(r,f.point.x,f.point.y),h==null?u=mxEvent.VIRTUAL_HANDLE-u:u+=1)))),u==null&&(u=mxEvent.VIRTUAL_HANDLE)),e.start(t.getGraphX(),t.getGraphX(),u),f.state=null,f.event=null,f.point=null,f.handle=null,f.selected=!1,t.consume(),this.graphHandler.reset())}}else r=t.getState(),r!=null&&this.model.isEdge(r.cell)&&(s=null,i=r.absolutePoints,i!=null&&(o=new mxRectangle(t.getGraphX(),t.getGraphY()),o.grow(mxEdgeHandler.prototype.handleImage.width/2),r.text!=null&&r.text.boundingBox!=null&&mxUtils.contains(r.text.boundingBox,t.getGraphX(),t.getGraphY())?s="move":mxUtils.contains(o,i[0].x,i[0].y)||mxUtils.contains(o,i[i.length-1].x,i[i.length-1].y)?s="pointer":(r.visibleSourceState!=null||r.visibleTargetState!=null)&&(w=this.view.getEdgeStyle(r),s="crosshair",w!=mxEdgeStyle.EntityRelation&&this.isOrthogonal(r)&&(c=mxUtils.findNearestSegment(r,t.getGraphX(),t.getGraphY()),c<i.length-1&&c>=0&&(s=Math.round(i[c].x-i[c+1].x)==0?"col-resize":"row-resize")))),s!=null&&r.setCursor(s))}),mouseUp:mxUtils.bind(this,function(){f.state=null;f.event=null;f.point=null;f.handle=null})})),this.cellRenderer.getLabelValue=function(n){var t=mxCellRenderer.prototype.getLabelValue.apply(this,arguments);return n.view.graph.isHtmlLabel(n.cell)&&(t=n.style.html!=1?mxUtils.htmlEntities(t,!1):n.view.graph.sanitizeHtml(t)),t},typeof mxVertexHandler!="undefined"){this.setConnectable(!0);this.setDropEnabled(!0);this.setPanning(!0);this.setTooltips(!0);this.setAllowLoops(!0);this.allowAutoPanning=!0;this.resetEdgesOnConnect=!1;this.constrainChildren=!1;this.constrainRelativeChildren=!0;this.graphHandler.scrollOnMove=!1;this.graphHandler.scaleGrid=!0;this.connectionHandler.setCreateTarget(!1);this.connectionHandler.insertBeforeSource=!0;this.connectionHandler.isValidSource=function(){return!1};this.alternateEdgeStyle="vertical";r==null&&this.loadStylesheet();v=this.graphHandler.getGuideStates;this.graphHandler.getGuideStates=function(){var o=v.apply(this,arguments),f,e;if(this.graph.pageVisible){var s=[],h=this.graph.pageFormat,c=this.graph.pageScale,i=h.width*c,r=h.height*c,u=this.graph.view.translate,n=this.graph.view.scale,t=this.graph.getPageLayout();for(f=0;f<t.width;f++)s.push(new mxRectangle(((t.x+f)*i+u.x)*n,(t.y*r+u.y)*n,i*n,r*n));for(e=0;e<t.height;e++)s.push(new mxRectangle((t.x*i+u.x)*n,((t.y+e)*r+u.y)*n,i*n,r*n));o=s.concat(o)}return o};mxDragSource.prototype.dragElementZIndex=mxPopupMenu.prototype.zIndex;mxGuide.prototype.getGuideColor=function(n){return n.cell==null?"#ffa500":mxConstants.GUIDE_COLOR};this.graphHandler.createPreviewShape=function(){return this.previewColor=this.graph.background=="#000000"?"#ffffff":mxGraphHandler.prototype.previewColor,mxGraphHandler.prototype.createPreviewShape.apply(this,arguments)};this.graphHandler.getCells=function(){for(var u,f,i,n=mxGraphHandler.prototype.getCells.apply(this,arguments),r=[],t=0;t<n.length;t++)u=this.graph.view.getState(n[t]),f=u!=null?u.style:this.graph.getCellStyle(n[t]),mxUtils.getValue(f,"part","0")=="1"?(i=this.graph.model.getParent(n[t]),this.graph.model.isVertex(i)&&mxUtils.indexOf(n,i)<0&&r.push(i)):r.push(n[t]);return r};this.connectionHandler.createTargetVertex=function(n,t){var r=this.graph.view.getState(t),u=r!=null?r.style:this.graph.getCellStyle(t),i;return mxUtils.getValue(u,"part",!1)&&(i=this.graph.model.getParent(t),this.graph.model.isVertex(i)&&(t=i)),mxConnectionHandler.prototype.createTargetVertex.apply(this,arguments)};h=new mxRubberband(this);this.getRubberband=function(){return h};var y=(new Date).getTime(),l=0,it=this.connectionHandler.mouseMove;this.connectionHandler.mouseMove=function(){var n=this.currentState;it.apply(this,arguments);n!=this.currentState?(y=(new Date).getTime(),l=0):l=(new Date).getTime()-y};p=this.connectionHandler.isOutlineConnectEvent;this.connectionHandler.isOutlineConnectEvent=function(n){return this.currentState!=null&&n.getState()==this.currentState&&l>2e3||(this.currentState==null||mxUtils.getValue(this.currentState.style,"outlineConnect","1")!="0")&&p.apply(this,arguments)};w=this.isToggleEvent;this.isToggleEvent=function(n){return w.apply(this,arguments)||mxEvent.isShiftDown(n)};b=h.isForceRubberbandEvent;h.isForceRubberbandEvent=function(n){return b.apply(this,arguments)||mxUtils.hasScrollbars(this.graph.container)&&mxClient.IS_FF&&mxClient.IS_WIN&&n.getState()==null&&mxEvent.isTouchEvent(n.getEvent())};a=null;this.panningHandler.addListener(mxEvent.PAN_START,mxUtils.bind(this,function(){this.isEnabled()&&(a=this.container.style.cursor,this.container.style.cursor="move")}));this.panningHandler.addListener(mxEvent.PAN_END,mxUtils.bind(this,function(){this.isEnabled()&&(this.container.style.cursor=a)}));this.popupMenuHandler.autoExpand=!0;this.popupMenuHandler.isSelectOnPopup=function(n){return mxEvent.isMouseEvent(n.getEvent())};k=this.click;this.click=function(n){var t,i;if(this.isEnabled()||n.isConsumed())return k.apply(this,arguments);t=n.getCell();t!=null&&(i=this.getLinkForCell(t),i!=null&&window.open(i))};d=this.getCursorForCell;this.getCursorForCell=function(n){if(this.isEnabled())return d.apply(this,arguments);var t=this.getLinkForCell(n);if(t!=null)return"pointer"};this.selectRegion=function(n,t){var i=this.getAllCells(n.x,n.y,n.width,n.height);return this.selectCellsForEvent(i,t),i};this.getAllCells=function(n,t,i,r,u,f){var a,c,o,h,l,e;if(f=f!=null?f:[],i>0||r>0){var s=this.getModel(),v=n+i,y=t+r;if(u==null&&(u=this.getCurrentRoot(),u==null&&(u=s.getRoot())),u!=null)for(a=s.getChildCount(u),c=0;c<a;c++)o=s.getChildAt(u,c),h=this.view.getState(o),h!=null&&this.isCellVisible(o)&&mxUtils.getValue(h.style,"locked","0")!="1"&&(l=mxUtils.getValue(h.style,mxConstants.STYLE_ROTATION)||0,e=h,l!=0&&(e=mxUtils.getBoundingBox(e,l)),(s.isEdge(o)||s.isVertex(o))&&e.x>=n&&e.y+e.height<=y&&e.y>=t&&e.x+e.width<=v&&f.push(o),this.getAllCells(n,t,i,r,o,f))}return f};g=this.graphHandler.shouldRemoveCellsFromParent;this.graphHandler.shouldRemoveCellsFromParent=function(n){return this.graph.isCellSelected(n)?!1:g.apply(this,arguments)};this.isCellLocked=function(n){for(var t=this.view.getState(n);t!=null;){if(mxUtils.getValue(t.style,"locked","0")=="1")return!0;t=this.view.getState(this.model.getParent(t.cell))}return!1};s=null;this.addListener(mxEvent.FIRE_MOUSE_EVENT,mxUtils.bind(this,function(n,t){if(t.getProperty("eventName")=="mouseDown"){var r=t.getProperty("event"),i=r.getState();s=i==null||this.isSelectionEmpty()||this.isCellSelected(i.cell)?null:this.getSelectionCells()}}));this.addListener(mxEvent.TAP_AND_HOLD,mxUtils.bind(this,function(n,t){var r,i,u;mxEvent.isMultiTouchEvent(t)||(r=t.getProperty("event"),i=t.getProperty("cell"),i==null?(u=mxUtils.convertPoint(this.container,mxEvent.getClientX(r),mxEvent.getClientY(r)),h.start(u.x,u.y)):s!=null?this.addSelectionCells(s):this.getSelectionCount()>1&&this.isCellSelected(i)&&this.removeSelectionCell(i),s=null,t.consume())}));this.connectionHandler.selectCells=function(n,t){this.graph.setSelectionCell(t||n)};this.connectionHandler.constraintHandler.isStateIgnored=function(n,t){return t&&n.view.graph.isCellSelected(n.cell)};this.selectionModel.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){var n=this.connectionHandler.constraintHandler;n.currentFocus!=null&&n.isStateIgnored(n.currentFocus,!0)&&(n.currentFocus=null,n.constraints=null,n.destroyIcons());n.destroyFocusHighlight()}));Graph.touchStyle&&this.initTouch();nt=this.updateMouseEvent;this.updateMouseEvent=function(n){return n=nt.apply(this,arguments),this.isCellLocked(n.getCell())&&(n.state=null),n}}};Graph.touchStyle=mxClient.IS_TOUCH||mxClient.IS_FF&&mxClient.IS_WIN||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||window.urlParams==null||urlParams.touch=="1";Graph.fileSupport=window.File!=null&&window.FileReader!=null&&window.FileList!=null&&(window.urlParams==null||urlParams.filesupport!="0");Graph.lineJumpsEnabled=!0;Graph.defaultJumpSize=6;Graph.createSvgImage=function(n,t,i){var r=unescape(encodeURIComponent('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+n+'px" height="'+t+'px" version="1.1">'+i+"<\/svg>"));return new mxImage("data:image/svg+xml;base64,"+(window.btoa?btoa(r):Base64.encode(r,!0)),n,t)};mxUtils.extend(Graph,mxGraph);Graph.prototype.minFitScale=null;Graph.prototype.maxFitScale=null;Graph.prototype.linkPolicy=urlParams.target=="frame"?"blank":urlParams.target||"auto";Graph.prototype.linkTarget=urlParams.target=="frame"?"_self":"_blank";Graph.prototype.defaultScrollbars=!mxClient.IS_IOS;Graph.prototype.defaultPageVisible=!0;Graph.prototype.lightbox=!1;Graph.prototype.defaultPageBackgroundColor="#ffffff";Graph.prototype.defaultPageBorderColor="#ffffff";Graph.prototype.defaultGraphBackground="#ffffff";Graph.prototype.scrollTileSize=new mxRectangle(0,0,400,400);Graph.prototype.transparentBackground=!0;Graph.prototype.defaultEdgeLength=80;Graph.prototype.edgeMode=!1;Graph.prototype.connectionArrowsEnabled=!0;Graph.prototype.placeholderPattern=new RegExp("%(date{.*}|[^%^{^}]+)%","g");Graph.prototype.absoluteUrlPattern=new RegExp("^(?:[a-z]+:)?//","i");Graph.prototype.defaultThemeName="default";Graph.prototype.defaultThemes={};Graph.prototype.baseUrl=(window!=window.top?document.referrer:document.location.toString()).split("#")[0];Graph.prototype.init=function(){mxGraph.prototype.init.apply(this,arguments);this.cellRenderer.initializeLabel=function(n,t){mxCellRenderer.prototype.initializeLabel.apply(this,arguments);var u=n.view.graph.tolerance,i=!0,r=null,f=mxUtils.bind(this,function(n){i=!0;r=new mxPoint(mxEvent.getClientX(n),mxEvent.getClientY(n))}),e=mxUtils.bind(this,function(n){i=i&&r!=null&&Math.abs(r.x-mxEvent.getClientX(n))<u&&Math.abs(r.y-mxEvent.getClientY(n))<u}),o=mxUtils.bind(this,function(r){if(i)for(var u=mxEvent.getSource(r);u!=null&&u!=t.node;){if(u.nodeName.toLowerCase()=="a"){n.view.graph.labelLinkClicked(n,u,r);break}u=u.parentNode}});mxEvent.addGestureListeners(t.node,f,e,o);mxEvent.addListener(t.node,"click",function(n){mxEvent.consume(n)})};this.initLayoutManager()};Graph.prototype.isPageLink=function(){return!1};Graph.prototype.labelLinkClicked=function(n,t,i){var r=t.getAttribute("href"),u;r==null||this.isPageLink(r)||(this.isEnabled()||(u=n.view.graph.isBlankLink(r)?n.view.graph.linkTarget:"_top",r=n.view.graph.getAbsoluteUrl(r),u=="_self"&&window!=window.top?window.location.href=r:r.substring(0,this.baseUrl.length)==this.baseUrl&&r.charAt(this.baseUrl.length)=="#"&&u=="_top"&&window==window.top?window.location.hash=r.split("#")[1]:(mxEvent.isLeftMouseButton(i)&&!mxEvent.isPopupTrigger(i)||mxEvent.isTouchEvent(i))&&window.open(r,u)),mxEvent.consume(i))};Graph.prototype.isExternalProtocol=function(n){return n.substring(0,7)==="mailto:"};Graph.prototype.isBlankLink=function(n){return!this.isExternalProtocol(n)&&(this.linkPolicy==="blank"||this.linkPolicy!=="self"&&!this.isRelativeUrl(n)&&n.substring(0,this.domainUrl.length)!==this.domainUrl)};Graph.prototype.isRelativeUrl=function(n){return n!=null&&!this.absoluteUrlPattern.test(n)&&n.substring(0,5)!=="data:"&&!this.isExternalProtocol(n)};Graph.prototype.initLayoutManager=function(){this.layoutManager=new mxLayoutManager(this);this.layoutManager.getLayout=function(n){var f=this.graph.view.getState(n),t=f!=null?f.style:this.graph.getCellStyle(n),i,r,u;return t.childLayout=="stackLayout"?(i=new mxStackLayout(this.graph,!0),i.resizeParentMax=mxUtils.getValue(t,"resizeParentMax","1")=="1",i.horizontal=mxUtils.getValue(t,"horizontalStack","1")=="1",i.resizeParent=mxUtils.getValue(t,"resizeParent","1")=="1",i.resizeLast=mxUtils.getValue(t,"resizeLast","0")=="1",i.spacing=t.stackSpacing||i.spacing,i.border=t.stackBorder||i.border,i.marginLeft=t.marginLeft||0,i.marginRight=t.marginRight||0,i.marginTop=t.marginTop||0,i.marginBottom=t.marginBottom||0,i.fill=!0,i):t.childLayout=="treeLayout"?(r=new mxCompactTreeLayout(this.graph),r.horizontal=mxUtils.getValue(t,"horizontalTree","1")=="1",r.resizeParent=mxUtils.getValue(t,"resizeParent","1")=="1",r.groupPadding=mxUtils.getValue(t,"parentPadding",20),r.levelDistance=mxUtils.getValue(t,"treeLevelDistance",30),r.maintainParentLocation=!0,r.edgeRouting=!1,r.resetEdges=!1,r):t.childLayout=="flowLayout"?(u=new mxHierarchicalLayout(this.graph,mxUtils.getValue(t,"flowOrientation",mxConstants.DIRECTION_EAST)),u.resizeParent=mxUtils.getValue(t,"resizeParent","1")=="1",u.parentBorder=mxUtils.getValue(t,"parentPadding",20),u.maintainParentLocation=!0,u.intraCellSpacing=mxUtils.getValue(t,"intraCellSpacing",mxHierarchicalLayout.prototype.intraCellSpacing),u.interRankCellSpacing=mxUtils.getValue(t,"interRankCellSpacing",mxHierarchicalLayout.prototype.interRankCellSpacing),u.interHierarchySpacing=mxUtils.getValue(t,"interHierarchySpacing",mxHierarchicalLayout.prototype.interHierarchySpacing),u.parallelEdgeSpacing=mxUtils.getValue(t,"parallelEdgeSpacing",mxHierarchicalLayout.prototype.parallelEdgeSpacing),u):null}};Graph.prototype.getPageSize=function(){return this.pageVisible?new mxRectangle(0,0,this.pageFormat.width*this.pageScale,this.pageFormat.height*this.pageScale):this.scrollTileSize};Graph.prototype.getPageLayout=function(){var t=this.getPageSize(),n=this.getGraphBounds();if(n.width==0||n.height==0)return new mxRectangle(0,0,1,1);var i=Math.ceil(n.x/this.view.scale-this.view.translate.x),r=Math.ceil(n.y/this.view.scale-this.view.translate.y),e=Math.floor(n.width/this.view.scale),o=Math.floor(n.height/this.view.scale),u=Math.floor(i/t.width),f=Math.floor(r/t.height),s=Math.ceil((i+e)/t.width)-u,h=Math.ceil((r+o)/t.height)-f;return new mxRectangle(u,f,s,h)};Graph.prototype.sanitizeHtml=function(n){function t(n){return n!=null&&n.toString().toLowerCase().substring(0,11)!=="javascript:"?n:null}function i(n){return n}return html_sanitize(n,t,i)};Graph.prototype.updatePlaceholders=function(){var r=this.model,t=!1,i,n;for(i in this.model.cells)n=this.model.cells[i],this.isReplacePlaceholders(n)&&(this.view.invalidate(n,!1,!1),t=!0);t&&this.view.validate()};Graph.prototype.isReplacePlaceholders=function(n){return n.value!=null&&typeof n.value=="object"&&n.value.getAttribute("placeholders")=="1"};Graph.prototype.isTransparentClickEvent=function(n){return mxEvent.isAltDown(n)};Graph.prototype.isIgnoreTerminalEvent=function(n){return mxEvent.isShiftDown(n)&&mxEvent.isControlDown(n)};Graph.prototype.isSplitTarget=function(n,t,i){return!this.model.isEdge(t[0])&&!mxEvent.isAltDown(i)&&!mxEvent.isShiftDown(i)&&mxGraph.prototype.isSplitTarget.apply(this,arguments)};Graph.prototype.getLabel=function(n){var t=mxGraph.prototype.getLabel.apply(this,arguments);return t!=null&&this.isReplacePlaceholders(n)&&n.getAttribute("placeholder")==null&&(t=this.replacePlaceholders(n,t)),t};Graph.prototype.isLabelMovable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return!this.isCellLocked(n)&&(this.model.isEdge(n)&&this.edgeLabelsMovable||this.model.isVertex(n)&&(this.vertexLabelsMovable||mxUtils.getValue(i,"labelMovable","0")=="1"))};Graph.prototype.setGridSize=function(n){this.gridSize=n;this.fireEvent(new mxEventObject("gridSizeChanged"))};Graph.prototype.getGlobalVariable=function(n){var t=null,i;return n=="date"?t=(new Date).toLocaleDateString():n=="time"?t=(new Date).toLocaleTimeString():n=="timestamp"?t=(new Date).toLocaleString():n.substring(0,5)=="date{"&&(i=n.substring(5,n.length-1),t=this.formatDate(new Date,i)),t};Graph.prototype.formatDate=function(n,t,i){this.dateFormatCache==null&&(this.dateFormatCache={i18n:{dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},masks:{"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"}});var e=this.dateFormatCache,r=function(n,t){for(n=String(n),t=t||2;n.length<t;)n="0"+n;return n};if(arguments.length!=1||Object.prototype.toString.call(n)!="[object String]"||/\d/.test(n)||(t=n,n=undefined),n=n?new Date(n):new Date,isNaN(n))throw SyntaxError("invalid date");t=String(e.masks[t]||t||e.masks["default"]);t.slice(0,4)=="UTC:"&&(t=t.slice(4),i=!0);var u=i?"getUTC":"get",o=n[u+"Date"](),l=n[u+"Day"](),s=n[u+"Month"](),a=n[u+"FullYear"](),f=n[u+"Hours"](),v=n[u+"Minutes"](),y=n[u+"Seconds"](),h=n[u+"Milliseconds"](),c=i?0:n.getTimezoneOffset(),p={d:o,dd:r(o),ddd:e.i18n.dayNames[l],dddd:e.i18n.dayNames[l+7],m:s+1,mm:r(s+1),mmm:e.i18n.monthNames[s],mmmm:e.i18n.monthNames[s+12],yy:String(a).slice(2),yyyy:a,h:f%12||12,hh:r(f%12||12),H:f,HH:r(f),M:v,MM:r(v),s:y,ss:r(y),l:r(h,3),L:r(h>99?Math.round(h/10):h),t:f<12?"a":"p",tt:f<12?"am":"pm",T:f<12?"A":"P",TT:f<12?"AM":"PM",Z:i?"UTC":(String(n).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),o:(c>0?"-":"+")+r(Math.floor(Math.abs(c)/60)*100+Math.abs(c)%60,4),S:["th","st","nd","rd"][o%10>3?0:(o%100-o%10!=10)*o%10]};return t.replace(/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,function(n){return n in p?p[n]:n.slice(1,n.length-1)})};Graph.prototype.createLayersDialog=function(){var i=document.createElement("div"),n,r,t;for(i.style.position="absolute",n=this.getModel(),r=n.getChildCount(n.root),t=0;t<r;t++)(function(t){var u=document.createElement("div"),r,f;u.style.overflow="hidden";u.style.textOverflow="ellipsis";u.style.padding="2px";u.style.whiteSpace="nowrap";r=document.createElement("input");r.style.display="inline-block";r.setAttribute("type","checkbox");n.isVisible(t)&&(r.setAttribute("checked","checked"),r.defaultChecked=!0);u.appendChild(r);f=t.value||mxResources.get("background")||"Background";u.setAttribute("title",f);mxUtils.write(u,f);i.appendChild(u);mxEvent.addListener(r,"click",function(){r.getAttribute("checked")!=null?r.removeAttribute("checked"):r.setAttribute("checked","checked");n.setVisible(t,r.checked)})})(n.getChildAt(n.root,t));return i};Graph.prototype.replacePlaceholders=function(n,t){for(var o=[],e=0,i,u,f,r;match=this.placeholderPattern.exec(t);)if(i=match[0],i.length>2&&i!="%label%"&&i!="%tooltip%"){if(u=null,match.index>e&&t.charAt(match.index-1)=="%")u=i.substring(1);else{if(f=i.substring(1,i.length-1),f.indexOf("{")<0)for(r=n;u==null&&r!=null;)r.value!=null&&typeof r.value=="object"&&(u=r.hasAttribute(f)?r.getAttribute(f)!=null?r.getAttribute(f):"":null),r=this.model.getParent(r);u==null&&(u=this.getGlobalVariable(f))}o.push(t.substring(e,match.index)+(u!=null?u:i));e=match.index+i.length}return o.push(t.substring(e)),o.join("")};Graph.prototype.selectCellsForConnectVertex=function(n,t,i){n.length==2&&this.model.isVertex(n[1])?(this.setSelectionCell(n[1]),i!=null&&(mxEvent.isTouchEvent(t)?i.update(i.getState(this.view.getState(n[1]))):i.reset()),this.scrollCellToVisible(n[1])):this.setSelectionCells(n)};Graph.prototype.connectVertex=function(n,t,i,r,u,f){var e,o,y,nt,tt,b,k,d,c,a,it,ot,rt,l,v,h,s,p;f=f?f:!1;e=n.geometry.relative&&n.parent.geometry!=null?new mxPoint(n.parent.geometry.width*n.geometry.x,n.parent.geometry.height*n.geometry.y):new mxPoint(n.geometry.x,n.geometry.y);t==mxConstants.DIRECTION_NORTH?(e.x+=n.geometry.width/2,e.y-=i):t==mxConstants.DIRECTION_SOUTH?(e.x+=n.geometry.width/2,e.y+=n.geometry.height+i):t==mxConstants.DIRECTION_WEST?(e.x-=i,e.y+=n.geometry.height/2):(e.x+=n.geometry.width+i,e.y+=n.geometry.height/2);var g=this.view.getState(this.model.getParent(n)),w=this.view.scale,ut=this.view.translate,ft=ut.x*w,et=ut.y*w;for(this.model.isVertex(g.cell)&&(ft=g.x,et=g.y),this.model.isVertex(n.parent)&&n.geometry.relative&&(e.x+=n.parent.geometry.x,e.y+=n.parent.geometry.y),o=f||mxEvent.isControlDown(r)&&!u?null:this.getCellAt(ft+e.x*w,et+e.y*w),this.model.isAncestor(o,n)&&(o=null),y=o;y!=null;){if(this.isCellLocked(y)){o=null;break}y=this.model.getParent(y)}o!=null&&(nt=this.view.getState(n),tt=this.view.getState(o),nt!=null&&tt!=null&&mxUtils.intersects(nt,tt)&&(o=null));b=!mxEvent.isShiftDown(r)||u;b&&(t==mxConstants.DIRECTION_NORTH?e.y-=n.geometry.height/2:t==mxConstants.DIRECTION_SOUTH?e.y+=n.geometry.height/2:t==mxConstants.DIRECTION_WEST?e.x-=n.geometry.width/2:e.x+=n.geometry.width/2);o==null||this.isCellConnectable(o)||(k=this.getModel().getParent(o),this.getModel().isVertex(k)&&this.isCellConnectable(k)&&(o=k));(o==n||this.model.isEdge(o)||!this.isCellConnectable(o))&&(o=null);d=[];this.model.beginUpdate();try{if(c=o,c==null&&b){for(a=n,l=this.getCellGeometry(n);l!=null&&l.relative;)a=this.getModel().getParent(a),l=this.getCellGeometry(a);it=this.view.getState(a);ot=it!=null?it.style:this.getCellStyle(a);mxUtils.getValue(ot,"part",!1)&&(rt=this.model.getParent(a),this.model.isVertex(rt)&&(a=rt));c=this.duplicateCells([a],!1)[0];l=this.getCellGeometry(c);l!=null&&(l.x=e.x-l.width/2,l.y=e.y-l.height/2)}if(v=null,this.layoutManager!=null&&(v=this.layoutManager.getLayout(this.model.getParent(n))),h=mxEvent.isControlDown(r)&&b||o==null&&v!=null&&v.constructor==mxStackLayout?null:this.insertEdge(this.model.getParent(n),null,"",n,c,this.createCurrentEdgeStyle()),h!=null&&this.connectionHandler.insertBeforeSource){for(p=null,s=n;s.parent!=null&&s.geometry!=null&&s.geometry.relative&&s.parent!=h.parent;)s=this.model.getParent(s);s!=null&&s.parent!=null&&s.parent==h.parent&&(p=s.parent.getIndex(s),this.model.add(s.parent,h,p))}o==null&&c!=null&&v!=null&&n.parent!=null&&v.constructor==mxStackLayout&&t==mxConstants.DIRECTION_WEST&&(p=n.parent.getIndex(n),this.model.add(n.parent,c,p));h!=null&&d.push(h);o==null&&c!=null&&d.push(c);c==null&&h!=null&&h.geometry.setTerminalPoint(e,!1);h!=null&&this.fireEvent(new mxEventObject("cellsInserted","cells",[h]))}finally{this.model.endUpdate()}return d};Graph.prototype.getIndexableText=function(){var i=document.createElement("div"),r=[],n="",u,t;for(u in this.model.cells)t=this.model.cells[u],(this.model.isVertex(t)||this.model.isEdge(t))&&(this.isHtmlLabel(t)?(i.innerHTML=this.getLabel(t),n=mxUtils.extractTextWithWhitespace([i])):n=this.getLabel(t),n=mxUtils.trim(n.replace(/[\x00-\x1F\x7F-\x9F]|\s+/g," ")),n.length>0&&r.push(n));return r.join(" ")};Graph.prototype.convertValueToString=function(n){if(n.value!=null&&typeof n.value=="object"){if(this.isReplacePlaceholders(n)&&n.getAttribute("placeholder")!=null){for(var i=n.getAttribute("placeholder"),t=n,r=null;r==null&&t!=null;)t.value!=null&&typeof t.value=="object"&&(r=t.hasAttribute(i)?t.getAttribute(i)!=null?t.getAttribute(i):"":null),t=this.model.getParent(t);return r||""}return n.value.getAttribute("label")}return mxGraph.prototype.convertValueToString.apply(this,arguments)};Graph.prototype.getLinksForState=function(n){return n!=null&&n.text!=null&&n.text.node!=null?n.text.node.getElementsByTagName("a"):null};Graph.prototype.getLinkForCell=function(n){if(n.value!=null&&typeof n.value=="object"){var t=n.value.getAttribute("link");return t!=null&&t.toLowerCase().substring(0,11)==="javascript:"&&(t=t.substring(11)),t}return null};Graph.prototype.getCellStyle=function(n){var r=mxGraph.prototype.getCellStyle.apply(this,arguments),i,t;return n!=null&&this.layoutManager!=null&&(i=this.model.getParent(n),this.model.isVertex(i)&&this.isCellCollapsed(n)&&(t=this.layoutManager.getLayout(i),t!=null&&t.constructor==mxStackLayout&&(r[mxConstants.STYLE_HORIZONTAL]=!t.horizontal))),r};Graph.prototype.updateAlternateBounds=function(n,t){if(n!=null&&t!=null&&this.layoutManager!=null&&t.alternateBounds!=null){var i=this.layoutManager.getLayout(this.model.getParent(n));i!=null&&i.constructor==mxStackLayout&&(i.horizontal?t.alternateBounds.height=0:t.alternateBounds.width=0)}mxGraph.prototype.updateAlternateBounds.apply(this,arguments)};Graph.prototype.isMoveCellsEvent=function(n){return mxEvent.isShiftDown(n)};Graph.prototype.foldCells=function(n,t,i,r,u){var f,e,s,h,c,l,o;if(t=t!=null?t:!1,i==null&&(i=this.getFoldableCells(this.getSelectionCells(),n)),i!=null){this.model.beginUpdate();try{if(mxGraph.prototype.foldCells.apply(this,arguments),this.layoutManager!=null)for(f=0;f<i.length;f++)e=this.view.getState(i[f]),s=this.getCellGeometry(i[f]),e!=null&&s!=null&&(h=Math.round(s.width-e.width/this.view.scale),c=Math.round(s.height-e.height/this.view.scale),(c!=0||h!=0)&&(l=this.model.getParent(i[f]),o=this.layoutManager.getLayout(l),o==null?u!=null&&this.isMoveCellsEvent(u)&&this.moveSiblings(e,l,h,c):u!=null&&mxEvent.isAltDown(u)||o.constructor!=mxStackLayout||o.resizeLast||this.resizeParentStacks(l,o,h,c)))}finally{this.model.endUpdate()}this.isEnabled()&&this.setSelectionCells(i)}};Graph.prototype.moveSiblings=function(n,t,i,r){var f,u,o,e;this.model.beginUpdate();try{for(f=this.getCellsBeyond(n.x,n.y,t,!0,!0),u=0;u<f.length;u++)f[u]!=n.cell&&(o=this.view.getState(f[u]),e=this.getCellGeometry(f[u]),o!=null&&e!=null&&(e=e.clone(),e.translate(Math.round(i*Math.max(0,Math.min(1,(o.x-n.x)/n.width))),Math.round(r*Math.max(0,Math.min(1,(o.y-n.y)/n.height)))),this.model.setGeometry(f[u],e)))}finally{this.model.endUpdate()}};Graph.prototype.resizeParentStacks=function(n,t,i,r){var e,u,f;if(this.layoutManager!=null&&t!=null&&t.constructor==mxStackLayout&&!t.resizeLast){this.model.beginUpdate();try{for(e=t.horizontal;n!=null&&t!=null&&t.constructor==mxStackLayout&&t.horizontal==e&&!t.resizeLast;)u=this.getCellGeometry(n),f=this.view.getState(n),f!=null&&u!=null&&(u=u.clone(),t.horizontal?u.width+=i+Math.min(0,f.width/this.view.scale-u.width):u.height+=r+Math.min(0,f.height/this.view.scale-u.height),this.model.setGeometry(n,u)),n=this.model.getParent(n),t=this.layoutManager.getLayout(n)}finally{this.model.endUpdate()}}};Graph.prototype.isContainer=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.isSwimlane(n)?i.container!="0":i.container=="1"};Graph.prototype.isCellConnectable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return i.connectable!=null?i.connectable!="0":mxGraph.prototype.isCellConnectable.apply(this,arguments)};Graph.prototype.selectAll=function(n){n=n||this.getDefaultParent();this.isCellLocked(n)||mxGraph.prototype.selectAll.apply(this,arguments)};Graph.prototype.selectCells=function(n,t,i){i=i||this.getDefaultParent();this.isCellLocked(i)||mxGraph.prototype.selectCells.apply(this,arguments)};Graph.prototype.getSwimlaneAt=function(n,t,i){return(i=i||this.getDefaultParent(),!this.isCellLocked(i))?mxGraph.prototype.getSwimlaneAt.apply(this,arguments):null};Graph.prototype.isCellFoldable=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return this.foldingEnabled&&!this.isCellLocked(n)&&(this.isContainer(n)&&i.collapsible!="0"||!this.isContainer(n)&&i.collapsible=="1")};Graph.prototype.reset=function(){this.isEditing()&&this.stopEditing(!0);this.escape();this.isSelectionEmpty()||this.clearSelection()};Graph.prototype.zoom=function(n){n=Math.max(.01,Math.min(this.view.scale*n,160))/this.view.scale;mxGraph.prototype.zoom.apply(this,arguments)};Graph.prototype.zoomIn=function(){this.view.scale<.15?this.zoom((this.view.scale+.01)/this.view.scale):this.zoom(Math.round(this.view.scale*this.zoomFactor*20)/20/this.view.scale)};Graph.prototype.zoomOut=function(){this.view.scale<=.15?this.zoom((this.view.scale-.01)/this.view.scale):this.zoom(Math.round(this.view.scale*(1/this.zoomFactor)*20)/20/this.view.scale)};Graph.prototype.getTooltipForCell=function(n){var r="",u,t;if(mxUtils.isNode(n.value))if(u=n.value.getAttribute("tooltip"),u!=null)u!=null&&this.isReplacePlaceholders(n)&&(u=this.replacePlaceholders(n,u)),r=this.sanitizeHtml(u);else{var e=["label","tooltip","placeholders","placeholder"],f=n.value.attributes,i=[];for(this.isEnabled()&&e.push("link"),t=0;t<f.length;t++)mxUtils.indexOf(e,f[t].nodeName)<0&&f[t].nodeValue.length>0&&i.push({name:f[t].nodeName,value:f[t].nodeValue});for(i.sort(function(n,t){return n.name<t.name?-1:n.name>t.name?1:0}),t=0;t<i.length;t++)i[t].name=="link"&&this.isPageLink(i[t].value)||(r+=(i[t].name!="link"?i[t].name+":":"")+mxUtils.htmlEntities(i[t].value)+"\n");r.length>0&&(r=r.substring(0,r.length-1))}return r};Graph.prototype.stringToBytes=function(n){for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i};Graph.prototype.bytesToString=function(n){for(var i=new Array(n.length),t=0;t<n.length;t++)i[t]=String.fromCharCode(n[t]);return i.join("")};Graph.prototype.compress=function(n){if(n==null||n.length==0||typeof pako=="undefined")return n;var t=this.bytesToString(pako.deflateRaw(encodeURIComponent(n)));return window.btoa?btoa(t):Base64.encode(t,!0)};Graph.prototype.decompress=function(n){if(n==null||n.length==0||typeof pako=="undefined")return n;var t=window.atob?atob(n):Base64.decode(n,!0);return this.zapGremlins(decodeURIComponent(this.bytesToString(pako.inflateRaw(t))))};Graph.prototype.zapGremlins=function(n){for(var t,r=[],i=0;i<n.length;i++)t=n.charCodeAt(i),(t>=32||t==9||t==10||t==13)&&r.push(n.charAt(i));return r.join("")};HoverIcons=function(n){this.graph=n;this.init()};HoverIcons.prototype.arrowSpacing=6;HoverIcons.prototype.updateDelay=500;HoverIcons.prototype.activationDelay=140;HoverIcons.prototype.currentState=null;HoverIcons.prototype.activeArrow=null;HoverIcons.prototype.inactiveOpacity=15;HoverIcons.prototype.cssCursor="copy";HoverIcons.prototype.checkCollisions=!0;HoverIcons.prototype.triangleUp=mxClient.IS_SVG?Graph.createSvgImage(26,14,'<path d="m 1 14 L 13 1 L 26 14 z" stroke="#fff" fill="#007dfc"/>'):new mxImage(IMAGE_PATH+"/triangle-up.png",26,14);HoverIcons.prototype.triangleRight=mxClient.IS_SVG?Graph.createSvgImage(14,26,'<path d="m 1 1 L 14 13 L 1 26 z" stroke="#fff" fill="#007dfc"/>'):new mxImage(IMAGE_PATH+"/triangle-right.png",14,26);HoverIcons.prototype.triangleDown=mxClient.IS_SVG?Graph.createSvgImage(26,14,'<path d="m 1 1 L 13 14 L 26 1 z" stroke="#fff" fill="#007dfc"/>'):new mxImage(IMAGE_PATH+"/triangle-down.png",26,14);HoverIcons.prototype.triangleLeft=mxClient.IS_SVG?Graph.createSvgImage(14,26,'<path d="m 14 1 L 1 13 L 14 26 z" stroke="#fff" fill="#007dfc"/>'):new mxImage(IMAGE_PATH+"/triangle-left.png",14,26);HoverIcons.prototype.roundDrop=mxClient.IS_SVG?Graph.createSvgImage(26,26,'<circle cx="13" cy="13" r="12" stroke="#fff" fill="#007dfc"/>'):new mxImage(IMAGE_PATH+"/round-drop.png",26,26);HoverIcons.prototype.refreshTarget=new mxImage(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDQxNERDRTU1QjY1MTFFNDkzNTRFQTVEMTdGMTdBQjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDQxNERDRTY1QjY1MTFFNDkzNTRFQTVEMTdGMTdBQjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NDE0RENFMzVCNjUxMUU0OTM1NEVBNUQxN0YxN0FCNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0NDE0RENFNDVCNjUxMUU0OTM1NEVBNUQxN0YxN0FCNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsvuX50AAANaSURBVHja7FjRZ1tRGD9ZJ1NCyIQSwrivI4Q8hCpjlFDyFEoYfSp9Ko1QWnmo0If+BSXkIfo0QirTMUpeGo2EPfWllFYjZMLKLDJn53d3biU337m5J223bPbxk5t7v+/c3/2+73znO8fDOWezKM/YjMpz68Lj8ejY+QTeCCwLxOS9qPxtyN+6wAeBTwJ31CCO0cJDjXBGBN4LfIepSwykTUT1bgpuib0SONIgo8KRHOtRiCFcvUcgZeGrHPNBxLIyFPyRgTGz0xLbegJCdmzpElue5KlAIMDX19d5uVzm5+fnfDAYmMA17uEZdOx2Yvb/sHlu2S0xwymn5ufneTab5b1ej08S6EAXNrDd2dnhiUTim21MvMtwQ6yiIrWwsMDPzs64rsBmf3/fvM7n89TYlUnEllSkQqEQv7q64g+Vk5MTVXosORErU0Zer5f0FEIlw2N6MxwO82QyaXql2+2SxDqdjopYWUUsqEp45IldqtWq6UWVh/1+P7+8vCTJ4QMUJSRIEXuneoH96w8PDyeWAnhSJfCqwm6NIlaklFdXV0cGhRcQ2mlJQXK5nMq2YPEZbnteU1U2lUqN/D84OGD9fl+5fgnSrFarsUwmw0qlEru4uBjTicViTk3Cr27HSnxR+Doyz0ZE1CAWiUTusbu7y9rttlZv5fP5WDQavYfIMba4uEipfhF8XtqJoZXx/uH+sC/4vPg7OljZZQbsCmLtYzc3N6zRaJhotVrmfx0xDINtbm6athYUeXpHdbBNaqZUKpWxWXV7e2vex+xaWVnhc3NzjrPUXgexyCt0m67LBV7uJMITjqRE4o8tZeg8FPpFitgapYxiOC0poFgsji1jKNo6BZZckrAGUtJsNk1vqAihCBcKhTE7hNWhqw2qFnGy5UFOUYJVIJ1OjzSE+BCEilon0URavRmBqnbbQ00AXbm+vnZc9O1tj72OnQoc2+cwygRkb2+P1et17ZoEm3g87lRmjgWZ00kbXkNuse6/Bu2wlegIxfb2tuvWGroO4bO2c4bbzUh60mxDXm1sbJhhxkQYnhS4h2fUZoRAWnf7lv8N27f8P7Xhnekjgpk+VKGOoQbsiY+hhhtF3YO7twIJ+ULvUGv+GQ2fQEvWxI/THNx5/p/BaspPAQYAqStgiSQwCDoAAAAASUVORK5CYII=":IMAGE_PATH+"/refresh.png",38,38);HoverIcons.prototype.tolerance=mxClient.IS_TOUCH?6:0;HoverIcons.prototype.init=function(){var t,n;this.arrowUp=this.createArrow(this.triangleUp,mxResources.get("plusTooltip"));this.arrowRight=this.createArrow(this.triangleRight,mxResources.get("plusTooltip"));this.arrowDown=this.createArrow(this.triangleDown,mxResources.get("plusTooltip"));this.arrowLeft=this.createArrow(this.triangleLeft,mxResources.get("plusTooltip"));this.elts=[this.arrowUp,this.arrowRight,this.arrowDown,this.arrowLeft];this.repaintHandler=mxUtils.bind(this,function(){this.repaint()});this.graph.selectionModel.addListener(mxEvent.CHANGE,this.repaintHandler);this.graph.model.addListener(mxEvent.CHANGE,this.repaintHandler);this.graph.view.addListener(mxEvent.SCALE_AND_TRANSLATE,this.repaintHandler);this.graph.view.addListener(mxEvent.TRANSLATE,this.repaintHandler);this.graph.view.addListener(mxEvent.SCALE,this.repaintHandler);this.graph.view.addListener(mxEvent.DOWN,this.repaintHandler);this.graph.view.addListener(mxEvent.UP,this.repaintHandler);this.graph.addListener(mxEvent.ROOT,this.repaintHandler);this.graph.addListener(mxEvent.ESCAPE,mxUtils.bind(this,function(){this.mouseDownPoint=null}));mxEvent.addListener(this.graph.container,"mouseleave",mxUtils.bind(this,function(n){n.relatedTarget!=null&&mxEvent.getSource(n)==this.graph.container&&this.setDisplay("none")}));this.graph.addListener(mxEvent.START_EDITING,mxUtils.bind(this,function(){this.reset()}));t=this.graph.click;this.graph.click=mxUtils.bind(this,function(n){t.apply(this.graph,arguments);this.currentState==null||this.graph.isCellSelected(this.currentState.cell)||!mxEvent.isTouchEvent(n.getEvent())||this.graph.model.isVertex(n.getCell())||this.reset()});n=!1;this.graph.addMouseListener({mouseDown:mxUtils.bind(this,function(t,i){var r,u;n=!1;r=i.getEvent();this.isResetEvent(r)?this.reset():this.isActive()||(u=this.getState(i.getState()),u==null&&mxEvent.isTouchEvent(r)||this.update(u));this.setDisplay("none")}),mouseMove:mxUtils.bind(this,function(t,i){var r=i.getEvent();this.isResetEvent(r)?this.reset():this.graph.isMouseDown||mxEvent.isTouchEvent(r)||this.update(this.getState(i.getState()),i.getGraphX(),i.getGraphY());this.graph.connectionHandler!=null&&this.graph.connectionHandler.shape!=null&&(n=!0)}),mouseUp:mxUtils.bind(this,function(t,i){var r=i.getEvent();this.isResetEvent(r)?this.reset():this.isActive()&&this.mouseDownPoint!=null&&Math.abs(i.getGraphX()-this.mouseDownPoint.x)<this.graph.tolerance&&Math.abs(i.getGraphY()-this.mouseDownPoint.y)<this.graph.tolerance?n||this.click(this.currentState,this.getDirection(),i):this.isActive()?this.graph.getSelectionCount()==1&&this.graph.model.isEdge(this.graph.getSelectionCell())?this.reset():this.update(this.getState(this.graph.view.getState(this.graph.getCellAt(i.getGraphX(),i.getGraphY())))):mxEvent.isTouchEvent(r)||this.bbox!=null&&mxUtils.contains(this.bbox,i.getGraphX(),i.getGraphY())?(this.setDisplay(""),this.repaint()):mxEvent.isTouchEvent(r)||this.reset();n=!1;this.resetActiveArrow()})})};HoverIcons.prototype.isResetEvent=function(n){return mxEvent.isAltDown(n)||this.activeArrow==null&&mxEvent.isShiftDown(n)||mxEvent.isMetaDown(n)||mxEvent.isPopupTrigger(n)&&!mxEvent.isControlDown(n)};HoverIcons.prototype.createArrow=function(n,t){var i=null;return mxClient.IS_IE&&!mxClient.IS_SVG?(mxClient.IS_IE6&&document.compatMode!="CSS1Compat"?(i=document.createElement(mxClient.VML_PREFIX+":image"),i.setAttribute("src",n.src),i.style.borderStyle="none"):(i=document.createElement("div"),i.style.backgroundImage="url("+n.src+")",i.style.backgroundPosition="center",i.style.backgroundRepeat="no-repeat"),i.style.width=n.width+4+"px",i.style.height=n.height+4+"px",i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block"):(i=mxUtils.createImage(n.src),i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.padding=this.tolerance+"px"),t!=null&&i.setAttribute("title",t),i.style.position="absolute",i.style.cursor=this.cssCursor,mxEvent.addGestureListeners(i,mxUtils.bind(this,function(n){this.currentState==null||this.isResetEvent(n)||(this.mouseDownPoint=mxUtils.convertPoint(this.graph.container,mxEvent.getClientX(n),mxEvent.getClientY(n)),this.drag(n,this.mouseDownPoint.x,this.mouseDownPoint.y),this.activeArrow=i,this.setDisplay("none"),mxEvent.consume(n))})),mxEvent.redirectMouseEvents(i,this.graph,this.currentState),mxEvent.addListener(i,"mouseenter",mxUtils.bind(this,function(n){mxEvent.isMouseEvent(n)&&(this.activeArrow!=null&&this.activeArrow!=i&&mxUtils.setOpacity(this.activeArrow,this.inactiveOpacity),this.graph.connectionHandler.constraintHandler.reset(),mxUtils.setOpacity(i,100),this.activeArrow=i)})),mxEvent.addListener(i,"mouseleave",mxUtils.bind(this,function(){this.graph.isMouseDown||this.resetActiveArrow()})),i};HoverIcons.prototype.resetActiveArrow=function(){this.activeArrow!=null&&(mxUtils.setOpacity(this.activeArrow,this.inactiveOpacity),this.activeArrow=null)};HoverIcons.prototype.getDirection=function(){var n=mxConstants.DIRECTION_EAST;return this.activeArrow==this.arrowUp?n=mxConstants.DIRECTION_NORTH:this.activeArrow==this.arrowDown?n=mxConstants.DIRECTION_SOUTH:this.activeArrow==this.arrowLeft&&(n=mxConstants.DIRECTION_WEST),n};HoverIcons.prototype.visitNodes=function(n){for(var t=0;t<this.elts.length;t++)this.elts[t]!=null&&n(this.elts[t])};HoverIcons.prototype.removeNodes=function(){this.visitNodes(function(n){n.parentNode!=null&&n.parentNode.removeChild(n)})};HoverIcons.prototype.setDisplay=function(n){this.visitNodes(function(t){t.style.display=n})};HoverIcons.prototype.isActive=function(){return this.activeArrow!=null&&this.currentState!=null};HoverIcons.prototype.drag=function(n,t,i){if(this.graph.popupMenuHandler.hideMenu(),this.graph.stopEditing(!1),this.currentState!=null){this.graph.connectionHandler.start(this.currentState,t,i);this.graph.isMouseTrigger=mxEvent.isMouseEvent(n);this.graph.isMouseDown=!0;var r=this.graph.selectionCellsHandler.getHandler(this.currentState.cell);r!=null&&r.setHandlesVisible(!1)}};HoverIcons.prototype.getStateAt=function(n,t,i){return this.graph.view.getState(this.graph.getCellAt(t,i))};HoverIcons.prototype.click=function(n,t,i){var f=i.getEvent(),e=i.getGraphX(),o=i.getGraphY(),u=this.getStateAt(n,e,o),r;u!=null&&this.graph.model.isEdge(u.cell)&&!mxEvent.isControlDown(f)&&(u.getVisibleTerminalState(!0)==n||u.getVisibleTerminalState(!1)==n)?(this.graph.setSelectionCell(u.cell),this.reset()):n!=null&&(r=this.graph.connectVertex(n.cell,t,this.graph.defaultEdgeLength,f),this.graph.selectCellsForConnectVertex(r,f,this),r.length==2&&this.graph.model.isVertex(r[1])?(this.graph.setSelectionCell(r[1]),mxEvent.isTouchEvent(f)?this.update(this.getState(this.graph.view.getState(r[1]))):this.reset(),this.graph.scrollCellToVisible(r[1])):this.graph.setSelectionCells(r));i.consume()};HoverIcons.prototype.reset=function(n){n=n==null?!0:n;n&&this.updateThread!=null&&window.clearTimeout(this.updateThread);this.mouseDownPoint=null;this.currentState=null;this.activeArrow=null;this.removeNodes();this.bbox=null};HoverIcons.prototype.repaint=function(){var n,t,e,i;if(this.bbox=null,this.currentState!=null){if(this.currentState=this.getState(this.currentState),this.currentState!=null&&this.graph.model.isVertex(this.currentState.cell)&&this.graph.isCellConnectable(this.currentState.cell)){if(n=mxRectangle.fromRectangle(this.currentState),this.currentState.shape!=null&&this.currentState.shape.boundingBox!=null&&(n=mxRectangle.fromRectangle(this.currentState.shape.boundingBox)),n.grow(this.graph.tolerance),n.grow(this.arrowSpacing),t=this.graph.selectionCellsHandler.getHandler(this.currentState.cell),t!=null&&(n.x-=t.horizontalOffset/2,n.y-=t.verticalOffset/2,n.width+=t.horizontalOffset,n.height+=t.verticalOffset,t.rotationShape!=null&&t.rotationShape.node!=null&&t.rotationShape.node.style.visibility!="hidden"&&t.rotationShape.node.style.display!="none"&&t.rotationShape.boundingBox!=null&&n.add(t.rotationShape.boundingBox)),this.arrowUp.style.left=Math.round(this.currentState.getCenterX()-this.triangleUp.width/2-this.tolerance)+"px",this.arrowUp.style.top=Math.round(n.y-this.triangleUp.height-this.tolerance)+"px",mxUtils.setOpacity(this.arrowUp,this.inactiveOpacity),this.arrowRight.style.left=Math.round(n.x+n.width-this.tolerance)+"px",this.arrowRight.style.top=Math.round(this.currentState.getCenterY()-this.triangleRight.height/2-this.tolerance)+"px",mxUtils.setOpacity(this.arrowRight,this.inactiveOpacity),this.arrowDown.style.left=this.arrowUp.style.left,this.arrowDown.style.top=Math.round(n.y+n.height-this.tolerance)+"px",mxUtils.setOpacity(this.arrowDown,this.inactiveOpacity),this.arrowLeft.style.left=Math.round(n.x-this.triangleLeft.width-this.tolerance)+"px",this.arrowLeft.style.top=this.arrowRight.style.top,mxUtils.setOpacity(this.arrowLeft,this.inactiveOpacity),this.checkCollisions){var r=this.graph.getCellAt(n.x+n.width+this.triangleRight.width/2,this.currentState.getCenterY()),u=this.graph.getCellAt(n.x-this.triangleLeft.width/2,this.currentState.getCenterY()),f=this.graph.getCellAt(this.currentState.getCenterX(),n.y-this.triangleUp.height/2),o=this.graph.getCellAt(this.currentState.getCenterX(),n.y+n.height+this.triangleDown.height/2);r!=null&&r==u&&u==f&&f==o&&(r=null,u=null,f=null,o=null);e=this.graph.getCellGeometry(this.currentState.cell);i=mxUtils.bind(this,function(n,t){var i=this.graph.model.isVertex(n)&&this.graph.getCellGeometry(n);t.style.visibility=n!=null&&!this.graph.model.isAncestor(n,this.currentState.cell)&&(i==null||e==null||i.height<6*e.height&&i.width<6*e.width)?"hidden":"visible"});i(r,this.arrowRight);i(u,this.arrowLeft);i(f,this.arrowUp);i(o,this.arrowDown)}else this.arrowLeft.style.visibility="visible",this.arrowRight.style.visibility="visible",this.arrowUp.style.visibility="visible",this.arrowDown.style.visibility="visible";this.graph.tooltipHandler.isEnabled()?(this.arrowLeft.setAttribute("title",mxResources.get("plusTooltip")),this.arrowRight.setAttribute("title",mxResources.get("plusTooltip")),this.arrowUp.setAttribute("title",mxResources.get("plusTooltip")),this.arrowDown.setAttribute("title",mxResources.get("plusTooltip"))):(this.arrowLeft.removeAttribute("title"),this.arrowRight.removeAttribute("title"),this.arrowUp.removeAttribute("title"),this.arrowDown.removeAttribute("title"))}else this.reset();this.currentState!=null&&(this.bbox=this.computeBoundingBox(),this.bbox!=null&&this.bbox.grow(10))}};HoverIcons.prototype.computeBoundingBox=function(){var n=this.graph.model.isEdge(this.currentState.cell)?null:mxRectangle.fromRectangle(this.currentState);return this.visitNodes(function(t){if(t.parentNode!=null){var i=new mxRectangle(t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight);n==null?n=i:n.add(i)}}),n};HoverIcons.prototype.getState=function(n){var t,i;return n!=null&&(t=n.cell,this.graph.getModel().isVertex(t)&&!this.graph.isCellConnectable(t)&&(i=this.graph.getModel().getParent(t),this.graph.getModel().isVertex(i)&&this.graph.isCellConnectable(i)&&(t=i)),(this.graph.isCellLocked(t)||this.graph.model.isEdge(t))&&(t=null),n=this.graph.view.getState(t)),n};HoverIcons.prototype.update=function(n,t,i){if(this.graph.connectionArrowsEnabled){var r=null;this.prev!=n||this.isActive()?(this.startTime=(new Date).getTime(),this.prev=n,r=0,this.updateThread!=null&&window.clearTimeout(this.updateThread),n!=null&&(this.updateThread=window.setTimeout(mxUtils.bind(this,function(){this.isActive()||this.graph.isMouseDown||this.graph.panningHandler.isActive()||(this.prev=n,this.update(n,t,i))}),this.updateDelay+10))):this.startTime!=null&&(r=(new Date).getTime()-this.startTime);this.setDisplay("");this.currentState!=null&&this.currentState!=n&&r<this.activationDelay&&this.bbox!=null&&!mxUtils.contains(this.bbox,t,i)?this.reset(!1):(this.currentState!=null||r>this.activationDelay)&&this.currentState!=n&&(r>this.updateDelay&&n!=null||this.bbox==null||t==null||i==null||!mxUtils.contains(this.bbox,t,i))&&(n!=null&&this.graph.isEnabled()?(this.removeNodes(),this.setCurrentState(n),this.repaint(),this.graph.connectionHandler.constraintHandler.currentFocus!=n&&this.graph.connectionHandler.constraintHandler.reset()):this.reset())}else this.reset()};HoverIcons.prototype.setCurrentState=function(n){n.style.portConstraint!="eastwest"&&(this.graph.container.appendChild(this.arrowUp),this.graph.container.appendChild(this.arrowDown));this.graph.container.appendChild(this.arrowRight);this.graph.container.appendChild(this.arrowLeft);this.currentState=n},function(){var o=mxGraphView.prototype.resetValidationState,n,t,i,r,u,f,e;mxGraphView.prototype.resetValidationState=function(){o.apply(this,arguments);this.validEdges=[]};n=mxGraphView.prototype.validateCellState;mxGraphView.prototype.validateCellState=function(t){var i=this.getState(t);return i!=null&&this.graph.model.isEdge(i.cell)&&i.style!=null&&i.style[mxConstants.STYLE_CURVED]!=1&&!i.invalid&&this.updateLineJumps(i)&&this.graph.cellRenderer.redraw(i,!1,this.isRendering()),i=n.apply(this,arguments),i!=null&&this.graph.model.isEdge(i.cell)&&i.style[mxConstants.STYLE_CURVED]!=1&&this.validEdges.push(i),i};t=mxCellRenderer.prototype.isShapeInvalid;mxCellRenderer.prototype.isShapeInvalid=function(n,i){return t.apply(this,arguments)||n.routedPoints!=null&&i.routedPoints!=null&&!mxUtils.equalPoints(i.routedPoints,n.routedPoints)};i=mxGraphView.prototype.updateCellState;mxGraphView.prototype.updateCellState=function(n){i.apply(this,arguments);this.graph.model.isEdge(n.cell)&&n.style[mxConstants.STYLE_CURVED]!=1&&this.updateLineJumps(n)};mxGraphView.prototype.updateLineJumps=function(n){var u=n.absolutePoints,f,v,y,e,b,k,h,c,l,w,t,i;if(Graph.lineJumpsEnabled){if(f=n.routedPoints!=null,v=null,u!=null&&this.validEdges!=null&&mxUtils.getValue(n.style,"jumpStyle","none")!=="none"){y=.5*this.scale;f=!1;v=[];function nt(t,i,r){var f=new mxPoint(i,r),u;return f.type=t,v.push(f),u=n.routedPoints!=null?n.routedPoints[v.length-1]:null,u==null||u.type!=t||u.x!=i||u.y!=r}for(e=0;e<u.length-1;e++){for(var p=u[e+1],s=u[e],r=[],o=u[e+2];e<u.length-2&&mxUtils.ptSegDistSq(s.x,s.y,o.x,o.y,p.x,p.y)<1*this.scale*this.scale;)p=o,e++,o=u[e+2];for(f=nt(0,s.x,s.y)||f,b=0;b<this.validEdges.length;b++)if(k=this.validEdges[b],h=k.absolutePoints,h!=null&&mxUtils.intersects(n,k))for(t=0;t<h.length-1;t++){for(c=h[t+1],l=h[t],o=h[t+2];t<h.length-2&&mxUtils.ptSegDistSq(l.x,l.y,o.x,o.y,c.x,c.y)<1*this.scale*this.scale;)c=o,t++,o=h[t+2];if(i=mxUtils.intersection(s.x,s.y,p.x,p.y,l.x,l.y,c.x,c.y),i!=null&&(Math.abs(i.x-l.x)>y||Math.abs(i.y-l.y)>y)&&(Math.abs(i.x-c.x)>y||Math.abs(i.y-c.y)>y)){var d=i.x-s.x,g=i.y-s.y,a={distSq:d*d+g*g,x:i.x,y:i.y};for(w=0;w<r.length;w++)if(r[w].distSq>a.distSq){r.splice(w,0,a);a=null;break}a!=null&&(r.length==0||r[r.length-1].x!==a.x||r[r.length-1].y!==a.y)&&r.push(a)}}for(t=0;t<r.length;t++)f=nt(1,r[t].x,r[t].y)||f}i=u[u.length-1];f=nt(0,i.x,i.y)||f}return n.routedPoints=v,f}return!1};r=mxConnector.prototype.paintLine;mxConnector.prototype.paintLine=function(n,t,i){var s,p,f,k,l,e,o;if(this.routedPoints=this.state!=null?this.state.routedPoints:null,this.outline||this.state==null||this.style==null||this.state.routedPoints==null||this.state.routedPoints.length==0)r.apply(this,arguments);else{var d=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2,h=(parseInt(mxUtils.getValue(this.style,"jumpSize",Graph.defaultJumpSize))-2)/2+this.strokewidth,g=mxUtils.getValue(this.style,"jumpStyle","none"),o=Editor.jumpSizeRatio,v=!0,c=null,y=null,a=[],u=null;for(n.begin(),s=0;s<this.state.routedPoints.length;s++){if(p=this.state.routedPoints[s],f=new mxPoint(p.x/this.scale,p.y/this.scale),s==0?f=t[0]:s==this.state.routedPoints.length-1&&(f=t[t.length-1]),k=!1,c!=null&&p.type==1){var nt=this.state.routedPoints[s+1],w=nt.x/this.scale-f.x,b=nt.y/this.scale-f.y,tt=w*w+b*b;if(u==null&&(u=new mxPoint(f.x-c.x,f.y-c.y),y=Math.sqrt(u.x*u.x+u.y*u.y),u.x=u.x*h/y,u.y=u.y*h/y),tt>h*h&&y>0){var w=c.x-f.x,b=c.y-f.y,tt=w*w+b*b;tt>h*h&&(l=new mxPoint(f.x-u.x,f.y-u.y),e=new mxPoint(f.x+u.x,f.y+u.y),a.push(l),this.addPoints(n,a,i,d,!1,null,v),o=Math.round(u.x)<0||Math.round(u.x)==0&&Math.round(u.y)<=0?1:-1,v=!1,g=="sharp"?(n.lineTo(l.x-u.y*o,l.y+u.x*o),n.lineTo(e.x-u.y*o,e.y+u.x*o),n.lineTo(e.x,e.y)):g=="arc"?(o*=1.3,n.curveTo(l.x-u.y*o,l.y+u.x*o,e.x-u.y*o,e.y+u.x*o,e.x,e.y)):(n.moveTo(e.x,e.y),v=!0),a=[e],k=!0)}}else u=null;k||(a.push(f),c=f)}this.addPoints(n,a,i,d,!1,null,v);n.stroke()}};u=mxGraphView.prototype.updateFloatingTerminalPoint;mxGraphView.prototype.updateFloatingTerminalPoint=function(n,t,i,r){var c,s,e,o;if(t!=null&&n!=null&&(t.style.snapToPoint=="1"||n.style.snapToPoint=="1")){t=this.getTerminalPort(n,t,r);var h=this.getNextPoint(n,i,r),a=this.graph.isOrthogonal(n),f=mxUtils.toRadians(Number(t.style[mxConstants.STYLE_ROTATION]||"0")),l=new mxPoint(t.getCenterX(),t.getCenterY());f!=0&&(e=Math.cos(-f),o=Math.sin(-f),h=mxUtils.getRotatedPoint(h,e,o,l));c=parseFloat(n.style[mxConstants.STYLE_PERIMETER_SPACING]||0);c+=parseFloat(n.style[r?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0);s=this.getPerimeterPoint(t,h,f==0&&a,c);f!=0&&(e=Math.cos(f),o=Math.sin(f),s=mxUtils.getRotatedPoint(s,e,o,l));n.setAbsoluteTerminalPoint(this.snapToAnchorPoint(n,t,i,r,s),r)}else u.apply(this,arguments)};mxGraphView.prototype.snapToAnchorPoint=function(n,t,i,r,u){var e,f,h;if(t!=null&&n!=null){var c=this.graph.getAllConnectionConstraints(t),o=null,s=null;for(e=0;e<c.length;e++)f=this.graph.getConnectionPoint(t,c[e]),f!=null&&(h=(f.x-u.x)*(f.x-u.x)+(f.y-u.y)*(f.y-u.y),(s==null||h<s)&&(o=f,s=h));o!=null&&(u=o)}return u};f=mxStencil.prototype.evaluateTextAttribute;mxStencil.prototype.evaluateTextAttribute=function(n,t,i){var r=f.apply(this,arguments),u=n.getAttribute("placeholders");return u=="1"&&i.state!=null&&(r=i.state.view.graph.replacePlaceholders(i.state.cell,r)),r};e=mxCellRenderer.prototype.createShape;mxCellRenderer.prototype.createShape=function(n){var t,i,r;if(n.style!=null&&typeof pako!="undefined"&&(t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null),t!=null&&t.substring(0,8)=="stencil("))try{return i=t.substring(8,t.length-1),r=mxUtils.parseXml(n.view.graph.decompress(i)),new mxShape(new mxStencil(r.documentElement))}catch(u){window.console!=null&&console.log("Error in shape: "+u)}return e.apply(this,arguments)}}();mxStencilRegistry.libraries={};mxStencilRegistry.dynamicLoading=!0;mxStencilRegistry.allowEval=!0;mxStencilRegistry.packages=[];mxStencilRegistry.getStencil=function(n){var e=mxStencilRegistry.stencils[n],i,u,f,t,r;if(e==null&&mxCellRenderer.defaultShapes[n]==null&&mxStencilRegistry.dynamicLoading&&(i=mxStencilRegistry.getBasenameForStencil(n),i!=null)){if(u=mxStencilRegistry.libraries[i],u!=null){if(mxStencilRegistry.packages[i]==null){for(f=0;f<u.length;f++)if(t=u[f],t.toLowerCase().substring(t.length-4,t.length)==".xml")mxStencilRegistry.loadStencilSet(t,null);else if(t.toLowerCase().substring(t.length-3,t.length)==".js")try{mxStencilRegistry.allowEval&&(r=mxUtils.load(t),r!=null&&r.getStatus()>=200&&r.getStatus()<=299&&eval.call(window,r.getText()))}catch(o){window.console!=null&&console.log("error in getStencil:",t,o)}mxStencilRegistry.packages[i]=1}}else i=i.replace("_-_","_"),mxStencilRegistry.loadStencilSet(STENCIL_PATH+"/"+i+".xml",null);e=mxStencilRegistry.stencils[n]}return e};mxStencilRegistry.getBasenameForStencil=function(n){var r=null,t,i;if(n!=null&&(t=n.split("."),t.length>0&&t[0]=="mxgraph"))for(r=t[1],i=2;i<t.length-1;i++)r+="/"+t[i];return r};mxStencilRegistry.loadStencilSet=function(n,t,i,r){var u,f;if(i=i!=null?i:!1,u=mxStencilRegistry.packages[n],i||u==null){if(f=!1,u==null)try{if(r){mxStencilRegistry.loadStencil(n,mxUtils.bind(this,function(i){i!=null&&i.documentElement!=null&&(mxStencilRegistry.packages[n]=i,f=!0,mxStencilRegistry.parseStencilSet(i.documentElement,t,f))}));return}u=mxStencilRegistry.loadStencil(n);mxStencilRegistry.packages[n]=u;f=!0}catch(e){window.console!=null&&console.log("error in loadStencilSet:",n,e)}u!=null&&u.documentElement!=null&&mxStencilRegistry.parseStencilSet(u.documentElement,t,f)}};mxStencilRegistry.loadStencil=function(n,t){if(t!=null)var i=mxUtils.get(n,mxUtils.bind(this,function(n){t(n.getStatus()>=200&&n.getStatus()<=299?n.getXml():null)}));else return mxUtils.load(n).getXml()};mxStencilRegistry.parseStencilSets=function(n){for(var t=0;t<n.length;t++)mxStencilRegistry.parseStencilSet(mxUtils.parseXml(n[t]).documentElement)};mxStencilRegistry.parseStencilSet=function(n,t,i){var u,h,o,s;if(n.nodeName=="stencils")for(u=n.firstChild;u!=null;)u.nodeName=="shapes"&&mxStencilRegistry.parseStencilSet(u,t,i),u=u.nextSibling;else{i=i!=null?i:!0;var r=n.firstChild,e="",f=n.getAttribute("name");for(f!=null&&(e=f+".");r!=null;)r.nodeType==mxConstants.NODETYPE_ELEMENT&&(f=r.getAttribute("name"),f!=null&&(e=e.toLowerCase(),h=f.replace(/ /g,"_"),i&&mxStencilRegistry.addStencil(e+h.toLowerCase(),new mxStencil(r)),t!=null&&(o=r.getAttribute("w"),s=r.getAttribute("h"),o=o==null?80:parseInt(o,10),s=s==null?80:parseInt(s,10),t(e,h,f,o,s)))),r=r.nextSibling}};typeof mxVertexHandler!="undefined"&&function(){function n(){var n=document.createElement("div");return n.className="geHint",n.style.whiteSpace="nowrap",n.style.position="absolute",n}var i,r,u,f,e,o,s,h,c,l,a,v,y,p,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt;mxConstants.HANDLE_FILLCOLOR="#99ccff";mxConstants.HANDLE_STROKECOLOR="#0088cf";mxConstants.VERTEX_SELECTION_COLOR="#00a8ff";mxConstants.OUTLINE_COLOR="#00a8ff";mxConstants.OUTLINE_HANDLE_FILLCOLOR="#99ccff";mxConstants.OUTLINE_HANDLE_STROKECOLOR="#00a8ff";mxConstants.CONNECT_HANDLE_FILLCOLOR="#cee7ff";mxConstants.EDGE_SELECTION_COLOR="#00a8ff";mxConstants.DEFAULT_VALID_COLOR="#00a8ff";mxConstants.LABEL_HANDLE_FILLCOLOR="#cee7ff";mxConstants.GUIDE_COLOR="#0088cf";mxConstants.HIGHLIGHT_OPACITY=30;mxConstants.HIGHLIGHT_SIZE=8;mxEdgeHandler.prototype.snapToTerminals=!0;mxGraphHandler.prototype.guidesEnabled=!0;mxRubberband.prototype.fadeOut=!0;mxGuide.prototype.isEnabledForEvent=function(n){return!mxEvent.isAltDown(n)};i=mxConnectionHandler.prototype.isCreateTarget;mxConnectionHandler.prototype.isCreateTarget=function(n){return mxEvent.isControlDown(n)||i.apply(this,arguments)};mxConstraintHandler.prototype.createHighlightShape=function(){var n=new mxEllipse(null,this.highlightColor,this.highlightColor,0);return n.opacity=mxConstants.HIGHLIGHT_OPACITY,n};mxConnectionHandler.prototype.livePreview=!0;mxConnectionHandler.prototype.cursor="crosshair";mxConnectionHandler.prototype.createEdgeState=function(){var r=this.graph.createCurrentEdgeStyle(),n=this.graph.createEdge(null,null,null,null,null,r),t=new mxCellState(this.graph.view,n,this.graph.getCellStyle(n));for(var i in this.graph.currentEdgeStyle)t.style[i]=this.graph.currentEdgeStyle[i];return t};r=mxConnectionHandler.prototype.createShape;mxConnectionHandler.prototype.createShape=function(){var n=r.apply(this,arguments);return n.isDashed=this.graph.currentEdgeStyle[mxConstants.STYLE_DASHED]=="1",n};mxConnectionHandler.prototype.updatePreview=function(){};u=mxConnectionHandler.prototype.createMarker;mxConnectionHandler.prototype.createMarker=function(){var n=u.apply(this,arguments),t=n.getCell;return n.getCell=mxUtils.bind(this,function(){var n=t.apply(this,arguments);return this.error=null,n}),n};Graph.prototype.defaultVertexStyle={};Graph.prototype.defaultEdgeStyle={edgeStyle:"elbowEdgeStyle",rounded:"1",endArrow:"classicThin",endFill:"1",strokeColor:"#808080",shadow:"1",jettySize:"auto",orthogonalLoop:"1"};Graph.prototype.createCurrentEdgeStyle=function(){var n="edgeStyle="+(this.currentEdgeStyle.edgeStyle||"none")+";";return this.currentEdgeStyle.shape!=null&&(n+="shape="+this.currentEdgeStyle.shape+";"),this.currentEdgeStyle.curved!=null&&(n+="curved="+this.currentEdgeStyle.curved+";"),this.currentEdgeStyle.rounded!=null&&(n+="rounded="+this.currentEdgeStyle.rounded+";"),this.currentEdgeStyle.comic!=null&&(n+="comic="+this.currentEdgeStyle.comic+";"),this.currentEdgeStyle.jumpStyle!=null&&(n+="jumpStyle="+this.currentEdgeStyle.jumpStyle+";"),this.currentEdgeStyle.jumpSize!=null&&(n+="jumpSize="+this.currentEdgeStyle.jumpSize+";"),this.currentEdgeStyle.edgeStyle=="elbowEdgeStyle"&&this.currentEdgeStyle.elbow!=null&&(n+="elbow="+this.currentEdgeStyle.elbow+";"),n+(this.currentEdgeStyle.html!=null?"html="+this.currentEdgeStyle.html+";":"html=1;")};Graph.prototype.getPagePadding=function(){return new mxPoint(0,0)};Graph.prototype.loadStylesheet=function(){var n=this.themes!=null?this.themes[this.defaultThemeName]:mxStyleRegistry.dynamicLoading?mxUtils.load(STYLE_PATH+"/default.xml").getDocumentElement():null,t;n!=null&&(t=new mxCodec(n.ownerDocument),t.decode(n,this.getStylesheet()))};Graph.prototype.importGraphModel=function(n,t,i,r){var c,v,l,s,e,o,h;t=t!=null?t:0;i=i!=null?i:0;var u=[],f=new mxGraphModel,a=new mxCodec(n.ownerDocument);a.decode(n,f);c=f.getChildCount(f.getRoot());v=this.model.getChildCount(this.model.getRoot());this.model.beginUpdate();try{for(l={},s=0;s<c;s++)e=f.getChildAt(f.getRoot(),s),c!=1||this.isCellLocked(this.getDefaultParent())?(e=this.importCells([e],0,0,this.model.getRoot(),null,l)[0],o=this.model.getChildren(e),this.moveCells(o,t,i),u=u.concat(o)):(o=f.getChildren(e),u=u.concat(this.importCells(o,t,i,this.getDefaultParent(),null,l)));r&&(this.isGridEnabled()&&(t=this.snap(t),i=this.snap(i)),h=this.getBoundingBoxFromGeometry(u,!0),h!=null&&this.moveCells(u,t-h.x,i-h.y))}finally{this.model.endUpdate()}return u};Graph.prototype.getAllConnectionConstraints=function(n){var r,u,f,i,t;if(n!=null){if(r=mxUtils.getValue(n.style,"points",null),r!=null){u=[];try{for(f=JSON.parse(r),i=0;i<f.length;i++)t=f[i],u.push(new mxConnectionConstraint(new mxPoint(t[0],t[1]),t.length>2?t[2]!="0":!0))}catch(e){}return u}if(n.shape!=null)if(n.shape.stencil!=null){if(n.shape.stencil!=null)return n.shape.stencil.constraints}else if(n.shape.constraints!=null)return n.shape.constraints}return null};Graph.prototype.flipEdge=function(n){var t,i,r,u;n!=null&&(t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n),i!=null&&(r=mxUtils.getValue(i,mxConstants.STYLE_ELBOW,mxConstants.ELBOW_HORIZONTAL),u=r==mxConstants.ELBOW_HORIZONTAL?mxConstants.ELBOW_VERTICAL:mxConstants.ELBOW_HORIZONTAL,this.setCellStyles(mxConstants.STYLE_ELBOW,u,[n])))};Graph.prototype.isValidRoot=function(n){for(var i,r,f=this.model.getChildCount(n),u=0,t=0;t<f;t++)i=this.model.getChildAt(n,t),this.model.isVertex(i)&&(r=this.getCellGeometry(i),r==null||r.relative||u++);return u>0||this.isContainer(n)};Graph.prototype.isValidDropTarget=function(n){var t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return mxUtils.getValue(i,"part","0")!="1"&&(this.isContainer(n)||mxGraph.prototype.isValidDropTarget.apply(this,arguments)&&mxUtils.getValue(i,"dropTarget","1")!="0")};Graph.prototype.createGroupCell=function(){var n=mxGraph.prototype.createGroupCell.apply(this,arguments);return n.setStyle("group"),n};Graph.prototype.isExtendParentsOnAdd=function(n){var t=mxGraph.prototype.isExtendParentsOnAdd.apply(this,arguments),i,r;return t&&n!=null&&this.layoutManager!=null&&(i=this.model.getParent(n),i!=null&&(r=this.layoutManager.getLayout(i),r!=null&&r.constructor==mxStackLayout&&(t=!1))),t};Graph.prototype.getPreferredSizeForCell=function(){var n=mxGraph.prototype.getPreferredSizeForCell.apply(this,arguments);return n!=null&&(n.width+=10,n.height+=4,this.gridEnabled&&(n.width=this.snap(n.width),n.height=this.snap(n.height))),n};Graph.prototype.turnShapes=function(n){var r=this.getModel(),s=[],f,i,e,o,l,a,p,w,t,b,c,u;r.beginUpdate();try{for(f=0;f<n.length;f++)if(i=n[f],r.isEdge(i)){if(e=r.getTerminal(i,!0),o=r.getTerminal(i,!1),r.setTerminal(i,o,!0),r.setTerminal(i,e,!1),t=r.getGeometry(i),t!=null){t=t.clone();t.points!=null&&t.points.reverse();l=t.getTerminalPoint(!0);a=t.getTerminalPoint(!1);t.setTerminalPoint(l,!1);t.setTerminalPoint(a,!0);r.setGeometry(i,t);var h=this.view.getState(i),v=this.view.getState(e),y=this.view.getState(o);h!=null&&(p=v!=null?this.getConnectionConstraint(h,v,!0):null,w=y!=null?this.getConnectionConstraint(h,y,!1):null,this.setConnectionConstraint(i,e,!0,w),this.setConnectionConstraint(i,o,!1,p));s.push(i)}}else r.isVertex(i)&&(t=this.getCellGeometry(i),t!=null&&(t=t.clone(),t.x+=t.width/2-t.height/2,t.y+=t.height/2-t.width/2,b=t.width,t.width=t.height,t.height=b,r.setGeometry(i,t),c=this.view.getState(i),c!=null&&(u=c.style[mxConstants.STYLE_DIRECTION]||"east",u=="east"?u="south":u=="south"?u="west":u=="west"?u="north":u=="north"&&(u="east"),this.setCellStyles(mxConstants.STYLE_DIRECTION,u,[i])),s.push(i)))}finally{r.endUpdate()}return s};Graph.prototype.processChange=function(n){var t,i;if(mxGraph.prototype.processChange.apply(this,arguments),n instanceof mxValueChange&&n.cell!=null&&n.cell.value!=null&&typeof n.cell.value=="object"&&(t=this.model.getDescendants(n.cell),t.length>0))for(i=0;i<t.length;i++)this.isReplacePlaceholders(t[i])&&this.view.invalidate(t[i],!1,!1)};Graph.prototype.replaceElement=function(n,t){for(var i=n.ownerDocument.createElement(t!=null?t:"span"),r=Array.prototype.slice.call(n.attributes);attr=r.pop();)i.setAttribute(attr.nodeName,attr.nodeValue);i.innerHTML=n.innerHTML;n.parentNode.replaceChild(i,n)};Graph.prototype.updateLabelElements=function(n,t,i){var u,r,f,o,e;for(n=n!=null?n:this.getSelectionCells(),u=document.createElement("div"),r=0;r<n.length;r++)if(this.isHtmlLabel(n[r])&&(f=this.convertValueToString(n[r]),f!=null&&f.length>0)){for(u.innerHTML=f,o=u.getElementsByTagName(i!=null?i:"*"),e=0;e<o.length;e++)t(o[e]);u.innerHTML!=f&&this.cellLabelChanged(n[r],u.innerHTML)}};Graph.prototype.cellLabelChanged=function(n,t){var r,i,u;t=this.zapGremlins(t);this.model.beginUpdate();try{if(n.value!=null&&typeof n.value=="object"){if(this.isReplacePlaceholders(n)&&n.getAttribute("placeholder")!=null)for(r=n.getAttribute("placeholder"),i=n;i!=null;){if(i==this.model.getRoot()||i.value!=null&&typeof i.value=="object"&&i.hasAttribute(r)){this.setAttributeForCell(i,r,t);break}i=this.model.getParent(i)}u=n.value.cloneNode(!0);u.setAttribute("label",t);t=u}mxGraph.prototype.cellLabelChanged.apply(this,arguments)}finally{this.model.endUpdate()}};Graph.prototype.cellsRemoved=function(n){var r,f,u,t,i,s,h,e,o;if(n!=null){for(r=new mxDictionary,t=0;t<n.length;t++)r.put(n[t],!0);for(f=[],t=0;t<n.length;t++)u=this.model.getParent(n[t]),u==null||r.get(u)||(r.put(u,!0),f.push(u));for(t=0;t<f.length;t++)if(i=this.view.getState(f[t]),i!=null&&(this.model.isEdge(i.cell)||this.model.isVertex(i.cell))&&this.isCellDeletable(i.cell)&&(s=mxUtils.getValue(i.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE),h=mxUtils.getValue(i.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE),s==mxConstants.NONE&&h==mxConstants.NONE)){for(e=!0,o=0;o<this.model.getChildCount(i.cell)&&e;o++)r.get(this.model.getChildAt(i.cell,o))||(e=!1);e&&n.push(i.cell)}}mxGraph.prototype.cellsRemoved.apply(this,arguments)};Graph.prototype.removeCellsAfterUngroup=function(n){for(var i,u,f,r=[],t=0;t<n.length;t++)this.isCellDeletable(n[t])&&(i=this.view.getState(n[t]),i!=null&&(u=mxUtils.getValue(i.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE),f=mxUtils.getValue(i.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE),u==mxConstants.NONE&&f==mxConstants.NONE&&r.push(n[t])));n=r;mxGraph.prototype.removeCellsAfterUngroup.apply(this,arguments)};Graph.prototype.setLinkForCell=function(n,t){this.setAttributeForCell(n,"link",t)};Graph.prototype.setTooltipForCell=function(n,t){this.setAttributeForCell(n,"tooltip",t)};Graph.prototype.setAttributeForCell=function(n,t,i){var r=null,u;n.value!=null&&typeof n.value=="object"?r=n.value.cloneNode(!0):(u=mxUtils.createXmlDocument(),r=u.createElement("UserObject"),r.setAttribute("label",n.value||""));i!=null&&i.length>0?r.setAttribute(t,i):r.removeAttribute(t);this.model.setValue(n,r)};Graph.prototype.getDropTarget=function(n,t){var r=this.getModel(),i;if(mxEvent.isAltDown(t))return null;for(i=0;i<n.length;i++)if(this.model.isEdge(this.model.getParent(n[i])))return null;return mxGraph.prototype.getDropTarget.apply(this,arguments)};Graph.prototype.click=function(n){mxGraph.prototype.click.call(this,n);this.firstClickState=n.getState();this.firstClickSource=n.getSource()};Graph.prototype.dblClick=function(n,t){var r,i,u;this.isEnabled()&&(r=mxUtils.convertPoint(this.container,mxEvent.getClientX(n),mxEvent.getClientY(n)),n==null||this.model.isVertex(t)||(i=this.model.isEdge(t)?this.view.getState(t):null,u=mxEvent.getSource(n),this.firstClickState==i&&this.firstClickSource==u&&(i!=null&&i.text!=null&&i.text.node!=null&&(mxUtils.contains(i.text.boundingBox,r.x,r.y)||mxUtils.isAncestorNode(i.text.node,mxEvent.getSource(n)))||(i!=null||this.isCellLocked(this.getDefaultParent()))&&(i==null||this.isCellLocked(i.cell))||(i!=null||mxClient.IS_VML&&u==this.view.getCanvas()||mxClient.IS_SVG&&u==this.view.getCanvas().ownerSVGElement)&&(t=this.addText(r.x,r.y,i)))),mxGraph.prototype.dblClick.call(this,n,t))};Graph.prototype.getInsertPoint=function(){var u=this.getGridSize(),n=this.container.scrollLeft/this.view.scale-this.view.translate.x,t=this.container.scrollTop/this.view.scale-this.view.translate.y,i,r;return this.pageVisible&&(i=this.getPageLayout(),r=this.getPageSize(),n=Math.max(n,i.x*r.width),t=Math.max(t,i.y*r.height)),new mxPoint(this.snap(n+u),this.snap(t+u))};Graph.prototype.getFreeInsertPoint=function(){var t=this.view,n=this.getGraphBounds(),i=this.getInsertPoint(),r=this.snap(Math.round(Math.max(i.x,n.x/t.scale-t.translate.x+(n.width==0?this.gridSize:0)))),u=this.snap(Math.round(Math.max(i.y,(n.y+n.height)/t.scale-t.translate.y+(n.height==0?1:2)*this.gridSize)));return new mxPoint(r,u)};Graph.prototype.isMouseInsertPoint=function(){return!1};Graph.prototype.addText=function(n,t,i){var r=new mxCell,u,f,e;r.value="Text";r.style="text;html=1;resizable=0;points=[];";r.geometry=new mxGeometry(0,0,0,0);r.vertex=!0;i!=null?(r.style+="align=center;verticalAlign=middle;labelBackgroundColor=#ffffff;",r.geometry.relative=!0,r.connectable=!1,u=this.view.getRelativePoint(i,n,t),r.geometry.x=Math.round(u.x*1e4)/1e4,r.geometry.y=Math.round(u.y),r.geometry.offset=new mxPoint(0,0),u=this.view.getPoint(i,r.geometry),f=this.view.scale,r.geometry.offset=new mxPoint(Math.round((n-u.x)/f),Math.round((t-u.y)/f))):(r.style+="autosize=1;align=left;verticalAlign=top;spacingTop=-4;",e=this.view.translate,r.geometry.width=40,r.geometry.height=20,r.geometry.x=Math.round(n/this.view.scale)-e.x,r.geometry.y=Math.round(t/this.view.scale)-e.y);this.getModel().beginUpdate();try{this.addCells([r],i!=null?i.cell:null);this.fireEvent(new mxEventObject("textInserted","cells",[r]));this.autoSizeCell(r)}finally{this.getModel().endUpdate()}return r};Graph.prototype.getAbsoluteUrl=function(n){return n!=null&&this.isRelativeUrl(n)&&(n=n.charAt(0)=="#"?this.baseUrl+n:n.charAt(0)=="/"?this.domainUrl+n:this.domainPathUrl+n),n};Graph.prototype.addClickHandler=function(n,t,i){var f=mxUtils.bind(this,function(){var i=this.container.getElementsByTagName("a"),n,r;if(i!=null)for(n=0;n<i.length;n++)r=this.getAbsoluteUrl(i[n].getAttribute("href")),r!=null&&(i[n].setAttribute("href",r),t!=null&&mxEvent.addGestureListeners(i[n],null,null,t))});this.model.addListener(mxEvent.CHANGE,f);f();var o=this.container.style.cursor,u=this.getTolerance(),r=this,e={currentState:null,currentLink:null,highlight:n!=null&&n!=""&&n!=mxConstants.NONE?new mxCellHighlight(r,n,4):null,startX:0,startY:0,scrollLeft:0,scrollTop:0,updateCurrentState:function(n){var t=r.view.getState(n.getCell());t!=this.currentState&&(this.currentState!=null&&this.clear(),this.currentState=t,this.currentState!=null&&this.activate(this.currentState))},mouseDown:function(n,t){this.startX=t.getGraphX();this.startY=t.getGraphY();this.scrollLeft=r.container.scrollLeft;this.scrollTop=r.container.scrollTop;this.currentLink==null&&r.container.style.overflow=="auto"&&(r.container.style.cursor="move");this.updateCurrentState(t)},mouseMove:function(n,t){var f,e,i;if(r.isMouseDown)this.currentLink!=null&&(f=Math.abs(this.startX-t.getGraphX()),e=Math.abs(this.startY-t.getGraphY()),(f>u||e>u)&&this.clear());else{for(i=t.getSource();i!=null&&i.nodeName.toLowerCase()!="a";)i=i.parentNode;if(i!=null)this.clear();else{if(this.currentState!=null&&(t.getState()==this.currentState||t.getState()==null)&&r.intersects(this.currentState,t.getGraphX(),t.getGraphY()))return;this.updateCurrentState(t)}}},mouseUp:function(n,f){for(var c=f.getSource(),e=f.getEvent(),o=c,h,s;o!=null&&o.nodeName.toLowerCase()!="a";)o=o.parentNode;o==null&&Math.abs(this.scrollLeft-r.container.scrollLeft)<u&&Math.abs(this.scrollTop-r.container.scrollTop)<u&&(f.getState()==null||!f.isSource(f.getState().control))&&(mxEvent.isLeftMouseButton(e)&&!mxEvent.isPopupTrigger(e)||mxEvent.isTouchEvent(e))&&(this.currentLink!=null?(h=r.isBlankLink(this.currentLink),this.currentLink.substring(0,5)!=="data:"&&h||t==null||t(e,this.currentLink),mxEvent.isConsumed(e)||(s=h?r.linkTarget:"_top",s=="_self"&&window!=window.top?window.location.href=this.currentLink:this.currentLink.substring(0,r.baseUrl.length)==r.baseUrl&&this.currentLink.charAt(r.baseUrl.length)=="#"&&s=="_top"&&window==window.top?window.location.hash=this.currentLink.split("#")[1]:window.open(this.currentLink,s),f.consume())):i!=null&&!f.isConsumed()&&Math.abs(this.scrollLeft-r.container.scrollLeft)<u&&Math.abs(this.scrollTop-r.container.scrollTop)<u&&Math.abs(this.startX-f.getGraphX())<u&&Math.abs(this.startY-f.getGraphY())<u&&i(f.getEvent()));this.clear()},activate:function(n){this.currentLink=r.getAbsoluteUrl(r.getLinkForCell(n.cell));this.currentLink!=null&&(r.container.style.cursor="pointer",this.highlight!=null&&this.highlight.highlight(n))},clear:function(){r.container!=null&&(r.container.style.cursor=o);this.currentState=null;this.currentLink=null;this.highlight!=null&&this.highlight.hide()}};r.click=function(){};r.addMouseListener(e);mxEvent.addListener(document,"mouseleave",function(){e.clear()})};Graph.prototype.duplicateCells=function(n,t){var f,i,u,s,h;n=n!=null?n:this.getSelectionCells();t=t!=null?t:!0;n=this.model.getTopmostCells(n);var r=this.getModel(),e=this.gridSize,o=[];r.beginUpdate();try{for(f=this.cloneCells(n,!1),i=0;i<n.length;i++)u=r.getParent(n[i]),s=this.moveCells([f[i]],e,e,!1,u)[0],o.push(s),t?r.add(u,f[i]):(h=u.getIndex(n[i]),r.add(u,f[i],h+1))}finally{r.endUpdate()}return o};Graph.prototype.insertImage=function(n,t,i){var e,f,u,r;if(n!=null){for(e=this.cellEditor.textarea.getElementsByTagName("img"),f=[],r=0;r<e.length;r++)f.push(e[r]);if(document.execCommand("insertimage",!1,n),u=this.cellEditor.textarea.getElementsByTagName("img"),u.length==f.length+1)for(r=u.length-1;r>=0;r--)if(r==0||u[r]!=f[r-1]){u[r].setAttribute("width",t);u[r].setAttribute("height",i);break}}};Graph.prototype.insertLink=function(n){n.length==0?document.execCommand("unlink",!1):document.execCommand("createlink",!1,mxUtils.trim(n))};Graph.prototype.isCellResizable=function(n){var r=mxGraph.prototype.isCellResizable.apply(this,arguments),t=this.view.getState(n),i=t!=null?t.style:this.getCellStyle(n);return r||mxUtils.getValue(i,mxConstants.STYLE_RESIZABLE,"1")!="0"&&i[mxConstants.STYLE_WHITE_SPACE]=="wrap"};Graph.prototype.distributeCells=function(n,t){var o,s,h,a,v,c,i,l,r;if(t==null&&(t=this.getSelectionCells()),t!=null&&t.length>1){var u=[],e=null,f=null;for(i=0;i<t.length;i++)this.getModel().isVertex(t[i])&&(o=this.view.getState(t[i]),o!=null&&(s=n?o.getCenterX():o.getCenterY(),e=e!=null?Math.max(e,s):s,f=f!=null?Math.min(f,s):s,u.push(o)));if(u.length>2){u.sort(function(t,i){return n?t.x-i.x:t.y-i.y});h=this.view.translate;a=this.view.scale;f=f/a-(n?h.x:h.y);e=e/a-(n?h.x:h.y);this.getModel().beginUpdate();try{for(v=(e-f)/(u.length-1),c=f,i=1;i<u.length-1;i++)l=this.view.getState(this.model.getParent(u[i].cell)),r=this.getCellGeometry(u[i].cell),c+=v,r!=null&&l!=null&&(r=r.clone(),n?r.x=Math.round(c-r.width/2)-l.origin.x:r.y=Math.round(c-r.height/2)-l.origin.y,this.getModel().setGeometry(u[i].cell,r))}finally{this.getModel().endUpdate()}}}return t};Graph.prototype.isCloneEvent=function(n){return mxClient.IS_MAC&&mxEvent.isMetaDown(n)||mxEvent.isControlDown(n)};Graph.prototype.encodeCells=function(n){for(var i,r,f=this.cloneCells(n),e=new mxDictionary,t=0;t<n.length;t++)e.put(n[t],!0);for(t=0;t<f.length;t++)i=this.view.getState(n[t]),i!=null&&(r=this.getCellGeometry(f[t]),r==null||!r.relative||this.model.isEdge(n[t])||e.get(this.model.getParent(n[t]))||(r.relative=!1,r.x=i.x/i.view.scale-i.view.translate.x,r.y=i.y/i.view.scale-i.view.translate.y));var o=new mxCodec,u=new mxGraphModel,s=u.getChildAt(u.getRoot(),0);for(t=0;t<n.length;t++)u.add(s,f[t]);return o.encode(u)};Graph.prototype.createSvgImageExport=function(){var n=new mxImageExport;return n.getLinkForCellState=mxUtils.bind(this,function(n){return this.getLinkForCell(n.cell)}),n};Graph.prototype.getSvg=function(n,t,i,r,u,f,e){var c,v,k,y,s,d,g,l,b,nt;if(t=t!=null?t:1,i=i!=null?i:0,u=u!=null?u:!0,f=f!=null?f:!0,e=e!=null?e:!0,c=f||r?this.getGraphBounds():this.getBoundingBox(this.getSelectionCells()),c==null)throw Error(mxResources.get("drawingEmpty"));var a=this.view.scale,h=mxUtils.createXmlDocument(),o=h.createElementNS!=null?h.createElementNS(mxConstants.NS_SVG,"svg"):h.createElement("svg");if(n!=null&&(o.style!=null?o.style.backgroundColor=n:o.setAttribute("style","background-color:"+n)),h.createElementNS==null?(o.setAttribute("xmlns",mxConstants.NS_SVG),o.setAttribute("xmlns:xlink",mxConstants.NS_XLINK)):o.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",mxConstants.NS_XLINK),v=t/a,o.setAttribute("width",Math.max(1,Math.ceil(c.width*v)+2*i)+"px"),o.setAttribute("height",Math.max(1,Math.ceil(c.height*v)+2*i)+"px"),o.setAttribute("version","1.1"),k=o,u?(y=h.createElementNS!=null?h.createElementNS(mxConstants.NS_SVG,"g"):h.createElement("g"),y.setAttribute("transform","translate(0.5,0.5)"),o.appendChild(y),h.appendChild(o),k=y):h.appendChild(o),s=this.createSvgCanvas(k),s.foOffset=u?-.5:0,s.textOffset=u?-.5:0,s.imageOffset=u?-.5:0,s.translate(Math.floor((i/t-c.x)/a),Math.floor((i/t-c.y)/a)),d=document.createElement("textarea"),g=s.createAlternateContent,s.createAlternateContent=function(n,t,i,r,u,f){var o=this.state,e;if(this.foAltText!=null&&(r==0||o.fontSize!=0&&f.length<r*5/o.fontSize)){e=this.createElement("text");e.setAttribute("x",Math.round(r/2));e.setAttribute("y",Math.round((u+o.fontSize)/2));e.setAttribute("fill",o.fontColor||"black");e.setAttribute("text-anchor","middle");e.setAttribute("font-size",Math.round(o.fontSize)+"px");e.setAttribute("font-family",o.fontFamily);(o.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD&&e.setAttribute("font-weight","bold");(o.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC&&e.setAttribute("font-style","italic");(o.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&e.setAttribute("text-decoration","underline");try{return d.innerHTML=f,e.textContent=d.value,e}catch(s){return g.apply(this,arguments)}}else return g.apply(this,arguments)},l=this.backgroundImage,l!=null){var p=a/t,w=this.view.translate,tt=new mxRectangle(w.x*p,w.y*p,l.width*p,l.height*p);mxUtils.intersects(c,tt)&&s.image(w.x,w.y,l.width,l.height,l.src,!0)}return s.scale(v),s.textEnabled=e,b=this.createSvgImageExport(),nt=b.drawCellState,b.drawCellState=function(n){(f||n.view.graph.isCellSelected(n.cell))&&nt.apply(this,arguments)},b.drawState(this.getView().getState(this.model.root),s),o};Graph.prototype.createSvgCanvas=function(n){return new mxSvgCanvas2D(n)};Graph.prototype.getSelectedElement=function(){var t=null,n,i;return window.getSelection?(n=window.getSelection(),n.getRangeAt&&n.rangeCount&&(i=n.getRangeAt(0),t=i.commonAncestorContainer)):document.selection&&(t=document.selection.createRange().parentElement()),t};Graph.prototype.getParentByName=function(n,t,i){while(n!=null){if(n.nodeName==t)return n;if(n==i)return null;n=n.parentNode}return n};Graph.prototype.selectNode=function(n){var t=null,r,i;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(i=document.createRange(),i.selectNode(n),t.removeAllRanges(),t.addRange(i))):(t=document.selection)&&t.type!="Control"&&(r=t.createRange(),r.collapse(!0),i=t.createRange(),i.setEndPoint("StartToStart",r),i.select())};Graph.prototype.insertRow=function(n,t){for(var i=n.tBodies[0],f=i.rows.length>0?i.rows[0].cells.length:1,r=i.insertRow(t),u=0;u<f;u++)mxUtils.br(r.insertCell(-1));return r.cells[0]};Graph.prototype.deleteRow=function(n,t){n.tBodies[0].deleteRow(t)};Graph.prototype.insertColumn=function(n,t){var f=n.tHead,r,e,i,u,o;if(f!=null)for(r=0;r<f.rows.length;r++)e=document.createElement("th"),f.rows[r].appendChild(e),mxUtils.br(e);for(i=n.tBodies[0],u=0;u<i.rows.length;u++)o=i.rows[u].insertCell(t),mxUtils.br(o);return i.rows[0].cells[t>=0?t:i.rows[0].cells.length-1]};Graph.prototype.deleteColumn=function(n,t){var u,r,i;if(t>=0)for(u=n.tBodies[0],r=u.rows,i=0;i<r.length;i++)r[i].cells.length>t&&r[i].deleteCell(t)};Graph.prototype.pasteHtmlAtCaret=function(n){var t,i,r,u,f;if(window.getSelection){if(t=window.getSelection(),t.getRangeAt&&t.rangeCount){for(i=t.getRangeAt(0),i.deleteContents(),r=document.createElement("div"),r.innerHTML=n,u=document.createDocumentFragment();f=r.firstChild;)lastNode=u.appendChild(f);i.insertNode(u)}}else(t=document.selection)&&t.type!="Control"&&t.createRange().pasteHTML(n)};Graph.prototype.createLinkForHint=function(n,t){var i;t=t!=null?t:n;i=document.createElement("a");i.setAttribute("href",this.getAbsoluteUrl(n));i.setAttribute("title",n);this.linkTarget!=null&&i.setAttribute("target",this.linkTarget);return t.length>40&&(t=t.substring(0,26)+"..."+t.substring(t.length-10)),mxUtils.write(i,t),i};Graph.prototype.initTouch=function(){var n;this.connectionHandler.marker.isEnabled=function(){return this.graph.connectionHandler.first!=null};this.addListener(mxEvent.START_EDITING,function(){this.popupMenuHandler.hideMenu()});n=this.updateMouseEvent;this.updateMouseEvent=function(t){if(t=n.apply(this,arguments),mxEvent.isTouchEvent(t.getEvent())&&t.getState()==null){var i=this.getCellAt(t.graphX,t.graphY);i!=null&&this.isSwimlane(i)&&this.hitsSwimlaneContent(i,t.graphX,t.graphY)?i=null:(t.state=this.view.getState(i),t.state!=null&&t.state.shape!=null&&(this.container.style.cursor=t.state.shape.node.style.cursor))}return t.getState()==null&&this.isEnabled()&&(this.container.style.cursor="default"),t};var t=!1,i=!1,r=!1,u=this.fireMouseEvent;this.fireMouseEvent=function(n,f){n==mxEvent.MOUSE_DOWN&&(f=this.updateMouseEvent(f),t=this.isCellSelected(f.getCell()),i=this.isSelectionEmpty(),r=this.popupMenuHandler.isMenuShowing());u.apply(this,arguments)};this.popupMenuHandler.mouseUp=mxUtils.bind(this,function(n,u){this.popupMenuHandler.popupTrigger=!this.isEditing()&&this.isEnabled()&&(u.getState()==null||!u.isSource(u.getState().control))&&(this.popupMenuHandler.popupTrigger||!r&&!mxEvent.isMouseEvent(u.getEvent())&&(i&&u.getCell()==null&&this.isSelectionEmpty()||t&&this.isCellSelected(u.getCell())));mxPopupMenuHandler.prototype.mouseUp.apply(this.popupMenuHandler,arguments)})};mxCellEditor.prototype.isContentEditing=function(){var n=this.graph.view.getState(this.editingCell);return n!=null&&n.style.html==1};mxCellEditor.prototype.saveSelection=function(){var n,i,t,r;if(window.getSelection){if(n=window.getSelection(),n.getRangeAt&&n.rangeCount){for(i=[],t=0,r=n.rangeCount;t<r;++t)i.push(n.getRangeAt(t));return i}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null};mxCellEditor.prototype.restoreSelection=function(n){try{if(n)if(window.getSelection){sel=window.getSelection();sel.removeAllRanges();for(var t=0,i=n.length;t<i;++t)sel.addRange(n[t])}else document.selection&&n.select&&n.select()}catch(r){}};f=mxCellRenderer.prototype.initializeLabel;mxCellRenderer.prototype.initializeLabel=function(n){n.text!=null&&(n.text.replaceLinefeeds=mxUtils.getValue(n.style,"nl2Br","1")!="0");f.apply(this,arguments)};e=mxConstraintHandler.prototype.update;mxConstraintHandler.prototype.update=function(n){this.isKeepFocusEvent(n)||!mxEvent.isAltDown(n.getEvent())?e.apply(this,arguments):this.reset()};mxGuide.prototype.createGuideShape=function(){return new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH)};mxCellEditor.prototype.escapeCancelsEditing=!1;o=mxCellEditor.prototype.startEditing;mxCellEditor.prototype.startEditing=function(n){var t,r,i;o.apply(this,arguments);t=this.graph.view.getState(n);this.textarea.className=t!=null&&t.style.html==1?"mxCellEditor geContentEditable":"mxCellEditor mxPlainTextEditor";this.codeViewMode=!1;this.switchSelectionState=null;this.graph.setSelectionCell(n);r=this.graph.getModel().getParent(n);i=this.graph.getCellGeometry(n);this.graph.getModel().isEdge(r)&&i!=null&&i.relative||this.graph.getModel().isEdge(n)?mxClient.IS_QUIRKS?this.textarea.style.border="gray dotted 1px":this.textarea.style.outline=mxClient.IS_IE||mxClient.IS_IE11||mxClient.IS_FF&&mxClient.IS_WIN?"gray dotted 1px":"":mxClient.IS_QUIRKS&&(this.textarea.style.outline="none",this.textarea.style.border="")};s=mxCellEditor.prototype.installListeners;mxCellEditor.prototype.installListeners=function(){function t(n,i){i.originalNode=n;n=n.firstChild;for(var r=i.firstChild;n!=null&&r!=null;)t(n,r),n=n.nextSibling,r=r.nextSibling;return i}function i(t,r){if(t!=null)if(r.originalNode!=t)n(t);else for(t=t.firstChild,r=r.firstChild;t!=null;){var u=t.nextSibling;r==null?n(t):(i(t,r),r=r.nextSibling);t=u}}function n(t){for(var i=t.firstChild,r;i!=null;)r=i.nextSibling,n(i),i=r;(t.nodeType!=1||t.nodeName!=="BR"&&t.firstChild==null)&&(t.nodeType!=3||mxUtils.trim(mxUtils.getTextContent(t)).length==0)?t.parentNode.removeChild(t):(t.nodeType==3&&mxUtils.setTextContent(t,mxUtils.getTextContent(t).replace(/\n|\r/g,"")),t.nodeType==1&&(t.removeAttribute("style"),t.removeAttribute("class"),t.removeAttribute("width"),t.removeAttribute("cellpadding"),t.removeAttribute("cellspacing"),t.removeAttribute("border")))}s.apply(this,arguments);mxClient.IS_QUIRKS||document.documentMode===7||document.documentMode===8||mxEvent.addListener(this.textarea,"paste",mxUtils.bind(this,function(){var n=t(this.textarea,this.textarea.cloneNode(!0));window.setTimeout(mxUtils.bind(this,function(){i(this.textarea,n)}),0)}))};mxCellEditor.prototype.toggleViewMode=function(){var t=this.graph.view.getState(this.editingCell),r=t!=null&&mxUtils.getValue(t.style,"nl2Br","1")!="0",u=this.saveSelection(),i,n;if(this.codeViewMode){n=mxUtils.extractTextWithWhitespace(this.textarea.childNodes);n.length>0&&n.charAt(n.length-1)=="\n"&&(n=n.substring(0,n.length-1));n=this.graph.sanitizeHtml(r?n.replace(/\n/g,"<br/>"):n,!0);this.textarea.className="mxCellEditor geContentEditable";var i=mxUtils.getValue(t.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE),f=mxUtils.getValue(t.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY),e=mxUtils.getValue(t.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT),o=(mxUtils.getValue(t.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD,s=(mxUtils.getValue(t.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC,h=(mxUtils.getValue(t.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE;this.textarea.style.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?Math.round(i*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT;this.textarea.style.fontSize=Math.round(i)+"px";this.textarea.style.textDecoration=h?"underline":"";this.textarea.style.fontWeight=o?"bold":"normal";this.textarea.style.fontStyle=s?"italic":"";this.textarea.style.fontFamily=f;this.textarea.style.textAlign=e;this.textarea.style.padding="0px";this.textarea.innerHTML!=n&&(this.textarea.innerHTML=n,this.textarea.innerHTML.length==0&&(this.textarea.innerHTML=this.getEmptyLabelText(),this.clearOnChange=this.textarea.innerHTML.length>0));this.codeViewMode=!1}else this.clearOnChange&&this.textarea.innerHTML==this.getEmptyLabelText()&&(this.clearOnChange=!1,this.textarea.innerHTML=""),n=mxUtils.htmlEntities(this.textarea.innerHTML),mxClient.IS_QUIRKS||document.documentMode==8||(n=mxUtils.replaceTrailingNewlines(n,"<div><br><\/div>")),n=this.graph.sanitizeHtml(r?n.replace(/\n/g,"").replace(/&lt;br\s*.?&gt;/g,"<br>"):n,!0),this.textarea.className="mxCellEditor mxPlainTextEditor",i=mxConstants.DEFAULT_FONTSIZE,this.textarea.style.lineHeight=mxConstants.ABSOLUTE_LINE_HEIGHT?Math.round(i*mxConstants.LINE_HEIGHT)+"px":mxConstants.LINE_HEIGHT,this.textarea.style.fontSize=Math.round(i)+"px",this.textarea.style.textDecoration="",this.textarea.style.fontWeight="normal",this.textarea.style.fontStyle="",this.textarea.style.fontFamily=mxConstants.DEFAULT_FONTFAMILY,this.textarea.style.textAlign="left",this.textarea.style.padding="2px",this.textarea.innerHTML!=n&&(this.textarea.innerHTML=n),this.codeViewMode=!0;this.textarea.focus();this.switchSelectionState!=null&&this.restoreSelection(this.switchSelectionState);this.switchSelectionState=u;this.resize()};h=mxCellEditor.prototype.resize;mxCellEditor.prototype.resize=function(n){var n,t,i;this.textarea!=null&&(n=this.graph.getView().getState(this.editingCell),this.codeViewMode&&n!=null?(t=n.view.scale,this.bounds=mxRectangle.fromRectangle(n),this.bounds.width==0&&this.bounds.height==0&&(this.bounds.width=160*t,this.bounds.height=60*t,i=n.text!=null?n.text.margin:null,i==null&&(i=mxUtils.getAlignmentAsPoint(mxUtils.getValue(n.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER),mxUtils.getValue(n.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE))),this.bounds.x+=i.x*this.bounds.width,this.bounds.y+=i.y*this.bounds.height),this.textarea.style.width=Math.round((this.bounds.width-4)/t)+"px",this.textarea.style.height=Math.round((this.bounds.height-4)/t)+"px",this.textarea.style.overflow="auto",this.textarea.clientHeight<this.textarea.offsetHeight&&(this.textarea.style.height=Math.round(this.bounds.height/t)+(this.textarea.offsetHeight-this.textarea.clientHeight)+"px",this.bounds.height=parseInt(this.textarea.style.height)*t),this.textarea.clientWidth<this.textarea.offsetWidth&&(this.textarea.style.width=Math.round(this.bounds.width/t)+(this.textarea.offsetWidth-this.textarea.clientWidth)+"px",this.bounds.width=parseInt(this.textarea.style.width)*t),this.textarea.style.left=Math.round(this.bounds.x)+"px",this.textarea.style.top=Math.round(this.bounds.y)+"px",mxClient.IS_VML?this.textarea.style.zoom=t:mxUtils.setPrefixedStyle(this.textarea.style,"transform","scale("+t+","+t+")")):(this.textarea.style.height="",this.textarea.style.overflow="",h.apply(this,arguments)))};mxCellEditorGetInitialValue=mxCellEditor.prototype.getInitialValue;mxCellEditor.prototype.getInitialValue=function(n,t){if(mxUtils.getValue(n.style,"html","0")=="0")return mxCellEditorGetInitialValue.apply(this,arguments);var i=this.graph.getEditingValue(n.cell,t);return mxUtils.getValue(n.style,"nl2Br","1")=="1"&&(i=i.replace(/\n/g,"<br/>")),this.graph.sanitizeHtml(i,!0)};mxCellEditorGetCurrentValue=mxCellEditor.prototype.getCurrentValue;mxCellEditor.prototype.getCurrentValue=function(n){if(mxUtils.getValue(n.style,"html","0")=="0")return mxCellEditorGetCurrentValue.apply(this,arguments);var t=this.graph.sanitizeHtml(this.textarea.innerHTML,!0);return mxUtils.getValue(n.style,"nl2Br","1")=="1"?t.replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>"):t.replace(/\r\n/g,"").replace(/\n/g,"")};c=mxCellEditor.prototype.stopEditing;mxCellEditor.prototype.stopEditing=function(){this.codeViewMode&&this.toggleViewMode();c.apply(this,arguments);this.focusContainer()};mxCellEditor.prototype.focusContainer=function(){try{this.graph.container.focus()}catch(n){}};l=mxCellEditor.prototype.applyValue;mxCellEditor.prototype.applyValue=function(n,t){this.graph.getModel().beginUpdate();try{if(l.apply(this,arguments),this.graph.isCellDeletable(n.cell)&&this.graph.model.getChildCount(n.cell)==0){var i=mxUtils.getValue(n.style,mxConstants.STYLE_STROKECOLOR,mxConstants.NONE),r=mxUtils.getValue(n.style,mxConstants.STYLE_FILLCOLOR,mxConstants.NONE);t==""&&i==mxConstants.NONE&&r==mxConstants.NONE&&this.graph.removeCells([n.cell],!1)}}finally{this.graph.getModel().endUpdate()}};mxCellEditor.prototype.getBackgroundColor=function(n){var t=null;return(this.graph.getModel().isEdge(n.cell)||this.graph.getModel().isEdge(this.graph.getModel().getParent(n.cell)))&&(t=mxUtils.getValue(n.style,mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,null),t==mxConstants.NONE&&(t=null)),t};mxCellEditor.prototype.getMinimumSize=function(n){var t=this.graph.getView().scale;return new mxRectangle(0,0,n.text==null?30:n.text.size*t+20,30)};a=mxGraphHandler.prototype.moveCells;mxGraphHandler.prototype.moveCells=function(n,t,i,r,u,f){mxEvent.isAltDown(f)&&(u=null);a.apply(this,arguments)};mxGraphHandler.prototype.updateHint=function(){if(this.shape!=null){this.hint==null&&(this.hint=n(),this.graph.container.appendChild(this.hint));var t=this.graph.view.translate,i=this.graph.view.scale,r=this.roundLength((this.bounds.x+this.currentDx)/i-t.x),u=this.roundLength((this.bounds.y+this.currentDy)/i-t.y);this.hint.innerHTML=r+", "+u;this.hint.style.left=this.shape.bounds.x+Math.round((this.shape.bounds.width-this.hint.clientWidth)/2)+"px";this.hint.style.top=this.shape.bounds.y+this.shape.bounds.height+12+"px"}};mxGraphHandler.prototype.removeHint=function(){this.hint!=null&&(this.hint.parentNode.removeChild(this.hint),this.hint=null)};mxVertexHandler.prototype.isRecursiveResize=function(n,t){return!this.graph.isSwimlane(n.cell)&&this.graph.model.getChildCount(n.cell)>0&&!mxEvent.isControlDown(t.getEvent())&&!this.graph.isCellCollapsed(n.cell)&&mxUtils.getValue(n.style,"recursiveResize","1")=="1"&&mxUtils.getValue(n.style,"childLayout",null)==null};mxVertexHandler.prototype.isCenteredEvent=function(n,t){return!(!this.graph.isSwimlane(n.cell)&&this.graph.model.getChildCount(n.cell)>0&&!this.graph.isCellCollapsed(n.cell)&&mxUtils.getValue(n.style,"recursiveResize","1")=="1"&&mxUtils.getValue(n.style,"childLayout",null)==null)&&mxEvent.isControlDown(t.getEvent())||mxEvent.isMetaDown(t.getEvent())};v=mxVertexHandler.prototype.getHandlePadding;mxVertexHandler.prototype.getHandlePadding=function(){var n=new mxPoint(0,0),t=this.tolerance;return this.graph.cellEditor.getEditingCell()==this.state.cell&&this.sizers!=null&&this.sizers.length>0&&this.sizers[0]!=null?(t/=2,n.x=this.sizers[0].bounds.width+t,n.y=this.sizers[0].bounds.height+t):n=v.apply(this,arguments),n};mxVertexHandler.prototype.updateHint=function(){var i,r,t;this.index!=mxEvent.LABEL_HANDLE&&(this.hint==null&&(this.hint=n(),this.state.view.graph.container.appendChild(this.hint)),this.index==mxEvent.ROTATION_HANDLE?this.hint.innerHTML=this.currentAlpha+"&deg;":(i=this.state.view.scale,this.hint.innerHTML=this.roundLength(this.bounds.width/i)+" x "+this.roundLength(this.bounds.height/i)),r=this.currentAlpha!=null?this.currentAlpha:this.state.style[mxConstants.STYLE_ROTATION]||"0",t=mxUtils.getBoundingBox(this.bounds,r),t==null&&(t=this.bounds),this.hint.style.left=t.x+Math.round((t.width-this.hint.clientWidth)/2)+"px",this.hint.style.top=t.y+t.height+12+"px",this.linkHint!=null&&(this.linkHint.style.display="none"))};mxVertexHandler.prototype.removeHint=function(){mxGraphHandler.prototype.removeHint.apply(this,arguments);this.linkHint!=null&&(this.linkHint.style.display="")};mxEdgeHandler.prototype.updateHint=function(t,i){var r;this.hint==null&&(this.hint=n(),this.state.view.graph.container.appendChild(this.hint));var u=this.graph.view.translate,f=this.graph.view.scale,e=this.roundLength(i.x/f-u.x),o=this.roundLength(i.y/f-u.y);this.hint.innerHTML=e+", "+o;this.hint.style.visibility="visible";(this.isSource||this.isTarget)&&(this.constraintHandler.currentConstraint!=null&&this.constraintHandler.currentFocus!=null?(r=this.constraintHandler.currentConstraint.point,this.hint.innerHTML="["+Math.round(r.x*100)+"%, "+Math.round(r.y*100)+"%]"):this.marker.hasValidState()&&(this.hint.style.visibility="hidden"));this.hint.style.left=Math.round(t.getGraphX()-this.hint.clientWidth/2)+"px";this.hint.style.top=Math.max(t.getGraphY(),i.y)+this.state.view.graph.gridSize+"px";this.linkHint!=null&&(this.linkHint.style.display="none")};mxEdgeHandler.prototype.removeHint=mxVertexHandler.prototype.removeHint;HoverIcons.prototype.mainHandle=mxClient.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="5" stroke="#fff" fill="#007dfc" stroke-width="1"/>'):new mxImage(IMAGE_PATH+"/handle-main.png",17,17);HoverIcons.prototype.secondaryHandle=mxClient.IS_SVG?Graph.createSvgImage(16,16,'<path d="m 8 3 L 13 8 L 8 13 L 3 8 z" stroke="#fff" fill="#fca000"/>'):new mxImage(IMAGE_PATH+"/handle-secondary.png",17,17);HoverIcons.prototype.fixedHandle=mxClient.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="5" stroke="#fff" fill="#007dfc" stroke-width="1"/><path d="m 7 7 L 11 11 M 7 11 L 11 7" stroke="#fff"/>'):new mxImage(IMAGE_PATH+"/handle-fixed.png",17,17);HoverIcons.prototype.terminalHandle=mxClient.IS_SVG?Graph.createSvgImage(18,18,'<circle cx="9" cy="9" r="5" stroke="#fff" fill="#007dfc" stroke-width="1"/><circle cx="9" cy="9" r="2" stroke="#fff" fill="transparent"/>'):new mxImage(IMAGE_PATH+"/handle-terminal.png",17,17);HoverIcons.prototype.rotationHandle=new mxImage(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAVCAYAAACkCdXRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAA6ZJREFUeNqM001IY1cUB/D/fYmm2sbR2lC1zYlgoRG6MpEyBlpxM9iFIGKFIm3s0lCKjOByhCLZCFqLBF1YFVJdSRbdFHRhBbULtRuFVBTzYRpJgo2mY5OX5N9Fo2TG+eiFA/dd3vvd8+65ByTxshARTdf1JySp6/oTEdFe9T5eg5lIcnBwkCSZyWS+exX40oyur68/KxaLf5Okw+H4X+A9JBaLfUySZ2dnnJqaosPhIAACeC34DJRKpb7IZrMcHx+nwWCgUopGo/EOKwf9fn/1CzERUevr6+9ls1mOjIwQAH0+H4PBIKPR6D2ofAQCgToRUeVYJUkuLy8TANfW1kiS8/PzCy84Mw4MDBAAZ2dnmc/nub+/X0MSEBF1cHDwMJVKsaGhgV6vl+l0mqOjo1+KyKfl1dze3l4NBoM/PZ+diFSLiIKIGBOJxA9bW1sEwNXVVSaTyQMRaRaRxrOzs+9J8ujoaE5EPhQRq67rcZ/PRwD0+/3Udf03EdEgIqZisZibnJykwWDg4eEhd3Z2xkXELCJvPpdBrYjUiEhL+Xo4HH4sIhUaAKNSqiIcDsNkMqG+vh6RSOQQQM7tdhsAQCkFAHC73UUATxcWFqypVApmsxnDw8OwWq2TADQNgAYAFosF+XweyWQSdru9BUBxcXFRB/4rEgDcPouIIx6P4+bmBi0tLSCpAzBqAIqnp6c/dnZ2IpfLYXNzE62traMADACKNputpr+/v8lms9UAKAAwiMjXe3t7KBQKqKurQy6Xi6K0i2l6evpROp1mbW0t29vbGY/Hb8/IVIqq2zlJXl1dsaOjg2azmefn5wwEAl+JSBVExCgi75PkzMwMlVJsbGxkIpFgPp8PX15ePopEIs3JZPITXdf/iEajbGpqolKKExMT1HWdHo/nIxGpgIgoEXnQ3d39kCTHxsYIgC6Xi3NzcwyHw8xkMozFYlxaWmJbWxuVUuzt7WUul6PX6/1cRN4WEe2uA0SkaWVl5XGpRVhdXU0A1DSNlZWVdz3qdDrZ09PDWCzG4+Pjn0XEWvp9KJKw2WwKwBsA3gHQHAqFfr24uMDGxgZ2d3cRiUQAAHa7HU6nE319fTg5Ofmlq6vrGwB/AngaCoWK6rbsNptNA1AJoA7Aux6Pp3NoaMhjsVg+QNmIRqO/u1yubwFEASRKUAEA7rASqABUAKgC8KAUb5XWCOAfAFcA/gJwDSB7C93DylCtdM8qABhLc5TumV6KQigUeubjfwcAHkQJ94ndWeYAAAAASUVORK5CYII=":IMAGE_PATH+"/handle-rotate.png",19,21);mxClient.IS_SVG&&(mxConstraintHandler.prototype.pointImage=Graph.createSvgImage(5,5,'<path d="m 0 0 L 5 5 M 0 5 L 5 0" stroke="#007dfc"/>'));mxVertexHandler.prototype.handleImage=HoverIcons.prototype.mainHandle;mxVertexHandler.prototype.secondaryHandleImage=HoverIcons.prototype.secondaryHandle;mxEdgeHandler.prototype.handleImage=HoverIcons.prototype.mainHandle;mxEdgeHandler.prototype.terminalHandleImage=HoverIcons.prototype.terminalHandle;mxEdgeHandler.prototype.fixedHandleImage=HoverIcons.prototype.fixedHandle;mxEdgeHandler.prototype.labelHandleImage=HoverIcons.prototype.secondaryHandle;mxOutline.prototype.sizerImage=HoverIcons.prototype.mainHandle;window.Sidebar!=null&&(Sidebar.prototype.triangleUp=HoverIcons.prototype.triangleUp,Sidebar.prototype.triangleRight=HoverIcons.prototype.triangleRight,Sidebar.prototype.triangleDown=HoverIcons.prototype.triangleDown,Sidebar.prototype.triangleLeft=HoverIcons.prototype.triangleLeft,Sidebar.prototype.refreshTarget=HoverIcons.prototype.refreshTarget,Sidebar.prototype.roundDrop=HoverIcons.prototype.roundDrop);mxClient.IS_SVG||((new Image).src=HoverIcons.prototype.mainHandle.src,(new Image).src=HoverIcons.prototype.fixedHandle.src,(new Image).src=HoverIcons.prototype.terminalHandle.src,(new Image).src=HoverIcons.prototype.secondaryHandle.src,(new Image).src=HoverIcons.prototype.rotationHandle.src,(new Image).src=HoverIcons.prototype.triangleUp.src,(new Image).src=HoverIcons.prototype.triangleRight.src,(new Image).src=HoverIcons.prototype.triangleDown.src,(new Image).src=HoverIcons.prototype.triangleLeft.src,(new Image).src=HoverIcons.prototype.refreshTarget.src,(new Image).src=HoverIcons.prototype.roundDrop.src);mxVertexHandler.prototype.rotationEnabled=!0;mxVertexHandler.prototype.manageSizers=!0;mxVertexHandler.prototype.livePreview=!0;mxRubberband.prototype.defaultOpacity=30;mxConnectionHandler.prototype.outlineConnect=!0;mxCellHighlight.prototype.keepOnTop=!0;mxVertexHandler.prototype.parentHighlightEnabled=!0;mxVertexHandler.prototype.rotationHandleVSpacing=-20;mxEdgeHandler.prototype.parentHighlightEnabled=!0;mxEdgeHandler.prototype.dblClickRemoveEnabled=!0;mxEdgeHandler.prototype.straightRemoveEnabled=!0;mxEdgeHandler.prototype.virtualBendsEnabled=!0;mxEdgeHandler.prototype.mergeRemoveEnabled=!0;mxEdgeHandler.prototype.manageLabelHandle=!0;mxEdgeHandler.prototype.outlineConnect=!0;mxEdgeHandler.prototype.isAddVirtualBendEvent=function(n){return!mxEvent.isShiftDown(n.getEvent())};mxEdgeHandler.prototype.isCustomHandleEvent=function(n){return!mxEvent.isShiftDown(n.getEvent())};Graph.touchStyle?((mxClient.IS_TOUCH||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(mxShape.prototype.svgStrokeTolerance=18,mxVertexHandler.prototype.tolerance=12,mxEdgeHandler.prototype.tolerance=12,Graph.prototype.tolerance=12,mxVertexHandler.prototype.rotationHandleVSpacing=-24,mxConstraintHandler.prototype.getTolerance=function(n){return mxEvent.isMouseEvent(n.getEvent())?4:this.graph.getTolerance()}),mxPanningHandler.prototype.isPanningTrigger=function(n){var t=n.getEvent();return n.getState()==null&&!mxEvent.isMouseEvent(t)||mxEvent.isPopupTrigger(t)&&(n.getState()==null||mxEvent.isControlDown(t)||mxEvent.isShiftDown(t))},y=mxGraphHandler.prototype.mouseDown,mxGraphHandler.prototype.mouseDown=function(n,t){y.apply(this,arguments);mxEvent.isTouchEvent(t.getEvent())&&this.graph.isCellSelected(t.getCell())&&this.graph.getSelectionCount()>1&&(this.delayedSelection=!1)}):mxPanningHandler.prototype.isPanningTrigger=function(n){var t=n.getEvent();return mxEvent.isLeftMouseButton(t)&&(this.useLeftButtonForPanning&&n.getState()==null||mxEvent.isControlDown(t)&&!mxEvent.isShiftDown(t))||this.usePopupTrigger&&mxEvent.isPopupTrigger(t)};mxRubberband.prototype.isSpaceEvent=function(n){return this.graph.isEnabled()&&!this.graph.isCellLocked(this.graph.getDefaultParent())&&mxEvent.isControlDown(n.getEvent())&&mxEvent.isShiftDown(n.getEvent())};mxRubberband.prototype.mouseUp=function(n,t){var l=this.div!=null&&this.div.style.display!="none",s=null,h=null,f=null,e=null,i,u,c,o,r;if(this.first!=null&&this.currentX!=null&&this.currentY!=null&&(s=this.first.x,h=this.first.y,f=(this.currentX-s)/this.graph.view.scale,e=(this.currentY-h)/this.graph.view.scale,mxEvent.isAltDown(t.getEvent())||(f=this.graph.snap(f),e=this.graph.snap(e),this.graph.isGridEnabled()||(Math.abs(f)<this.graph.tolerance&&(f=0),Math.abs(e)<this.graph.tolerance&&(e=0)))),this.reset(),l){if(mxEvent.isAltDown(t.getEvent())&&this.graph.isToggleEvent(t.getEvent()))r=new mxRectangle(this.x,this.y,this.width,this.height),i=this.graph.getCells(r.x,r.y,r.width,r.height),this.graph.removeSelectionCells(i);else if(this.isSpaceEvent(t)){this.graph.model.beginUpdate();try{for(i=this.graph.getCellsBeyond(s,h,this.graph.getDefaultParent(),!0,!0),u=0;u<i.length;u++)this.graph.isCellMovable(i[u])&&(c=this.graph.view.getState(i[u]),o=this.graph.getCellGeometry(i[u]),c!=null&&o!=null&&(o=o.clone(),o.translate(f,e),this.graph.model.setGeometry(i[u],o)))}finally{this.graph.model.endUpdate()}}else r=new mxRectangle(this.x,this.y,this.width,this.height),this.graph.selectRegion(r,t.getEvent());t.consume()}};mxRubberband.prototype.mouseMove=function(n,t){var i,u;if(!t.isConsumed()&&this.first!=null){i=mxUtils.getScrollOrigin(this.graph.container);u=mxUtils.getOffset(this.graph.container);i.x-=u.x;i.y-=u.y;var f=t.getX()+i.x,e=t.getY()+i.y,s=this.first.x-f,h=this.first.y-e,o=this.graph.tolerance;if(this.div!=null||Math.abs(s)>o||Math.abs(h)>o){if(this.div==null&&(this.div=this.createShape()),mxUtils.clearSelection(),this.update(f,e),this.isSpaceEvent(t)){var c=this.x+this.width,l=this.y+this.height,r=this.graph.view.scale;mxEvent.isAltDown(t.getEvent())||(this.width=this.graph.snap(this.width/r)*r,this.height=this.graph.snap(this.height/r)*r,this.graph.isGridEnabled()||(this.width<this.graph.tolerance&&(this.width=0),this.height<this.graph.tolerance&&(this.height=0)),this.x<this.first.x&&(this.x=c-this.width),this.y<this.first.y&&(this.y=l-this.height));this.div.style.borderStyle="dashed";this.div.style.backgroundColor="white";this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";this.div.style.width=Math.max(0,this.width)+"px";this.div.style.height=this.graph.container.clientHeight+"px";this.div.style.borderWidth=this.width<=0?"0px 1px 0px 0px":"0px 1px 0px 1px";this.secondDiv==null&&(this.secondDiv=this.div.cloneNode(!0),this.div.parentNode.appendChild(this.secondDiv));this.secondDiv.style.left=this.x+"px";this.secondDiv.style.top=this.y+"px";this.secondDiv.style.width=this.graph.container.clientWidth+"px";this.secondDiv.style.height=Math.max(0,this.height)+"px";this.secondDiv.style.borderWidth=this.height<=0?"1px 0px 0px 0px":"1px 0px 1px 0px"}else this.div.style.backgroundColor="",this.div.style.borderWidth="",this.div.style.borderStyle="",this.secondDiv!=null&&(this.secondDiv.parentNode.removeChild(this.secondDiv),this.secondDiv=null);t.consume()}}};p=mxRubberband.prototype.reset;mxRubberband.prototype.reset=function(){this.secondDiv!=null&&(this.secondDiv.parentNode.removeChild(this.secondDiv),this.secondDiv=null);p.apply(this,arguments)};var w=(new Date).getTime(),t=0,at=mxEdgeHandler.prototype.updatePreviewState;mxEdgeHandler.prototype.updatePreviewState=function(n,i,r){at.apply(this,arguments);r!=this.currentTerminalState?(w=(new Date).getTime(),t=0):t=(new Date).getTime()-w;this.currentTerminalState=r};b=mxEdgeHandler.prototype.isOutlineConnectEvent;mxEdgeHandler.prototype.isOutlineConnectEvent=function(n){return this.currentTerminalState!=null&&n.getState()==this.currentTerminalState&&t>2e3||(this.currentTerminalState==null||mxUtils.getValue(this.currentTerminalState.style,"outlineConnect","1")!="0")&&b.apply(this,arguments)};mxVertexHandler.prototype.isCustomHandleEvent=function(n){return!mxEvent.isShiftDown(n.getEvent())};mxEdgeHandler.prototype.createHandleShape=function(n){var r=n!=null&&n==0,e=this.state.getVisibleTerminalState(r),u=n!=null&&(n==0||n>=this.state.absolutePoints.length-1||this.constructor==mxElbowEdgeHandler&&n==2)?this.graph.getConnectionConstraint(this.state,e,r):null,o=u!=null?this.graph.getConnectionPoint(this.state.getVisibleTerminalState(r),u):null,t=o!=null?this.fixedHandleImage:u!=null&&e!=null?this.terminalHandleImage:this.handleImage,f,i;return t!=null?(f=new mxImageShape(new mxRectangle(0,0,t.width,t.height),t.src),f.preserveImageAspect=!1,f):(i=mxConstants.HANDLE_SIZE,this.preferHtml&&(i-=1),new mxRectangleShape(new mxRectangle(0,0,i,i),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR))};k=mxVertexHandler.prototype.createSizerShape;mxVertexHandler.prototype.createSizerShape=function(n,t){return this.handleImage=t==mxEvent.ROTATION_HANDLE?HoverIcons.prototype.rotationHandle:t==mxEvent.LABEL_HANDLE?this.secondaryHandleImage:this.handleImage,k.apply(this,arguments)};d=mxGraphHandler.prototype.getBoundingBox;mxGraphHandler.prototype.getBoundingBox=function(n){var t;if(n!=null&&n.length==1){var i=this.graph.getModel(),u=i.getParent(n[0]),r=this.graph.getCellGeometry(n[0]);if(i.isEdge(u)&&r!=null&&r.relative&&(t=this.graph.view.getState(n[0]),t!=null&&t.width<2&&t.height<2&&t.text!=null&&t.text.boundingBox!=null))return mxRectangle.fromRectangle(t.text.boundingBox)}return d.apply(this,arguments)};g=mxVertexHandler.prototype.getSelectionBounds;mxVertexHandler.prototype.getSelectionBounds=function(n){var i=this.graph.getModel(),u=i.getParent(n.cell),r=this.graph.getCellGeometry(n.cell),t;return i.isEdge(u)&&r!=null&&r.relative&&n.width<2&&n.height<2&&n.text!=null&&n.text.boundingBox!=null?(t=n.text.unrotatedBoundingBox||n.text.boundingBox,new mxRectangle(Math.round(t.x),Math.round(t.y),Math.round(t.width),Math.round(t.height))):g.apply(this,arguments)};nt=mxVertexHandler.prototype.mouseDown;mxVertexHandler.prototype.mouseDown=function(n,t){var i=this.graph.getModel(),u=i.getParent(this.state.cell),r=this.graph.getCellGeometry(this.state.cell),f=this.getHandleForEvent(t);(f==mxEvent.ROTATION_HANDLE||!i.isEdge(u)||r==null||!r.relative||this.state==null||this.state.width>=2||this.state.height>=2)&&nt.apply(this,arguments)};mxVertexHandler.prototype.isRotationHandleVisible=function(){return this.graph.isEnabled()&&this.rotationEnabled&&this.graph.isCellRotatable(this.state.cell)&&(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells)};mxVertexHandler.prototype.rotateClick=function(){this.state.view.graph.turnShapes([this.state.cell])};tt=mxVertexHandler.prototype.mouseMove;mxVertexHandler.prototype.mouseMove=function(){tt.apply(this,arguments);this.graph.graphHandler.first!=null&&this.rotationShape!=null&&this.rotationShape.node!=null&&(this.rotationShape.node.style.display="none")};it=mxVertexHandler.prototype.mouseUp;mxVertexHandler.prototype.mouseUp=function(){it.apply(this,arguments);this.rotationShape!=null&&this.rotationShape.node!=null&&(this.rotationShape.node.style.display=this.graph.getSelectionCount()==1?"":"none")};rt=mxVertexHandler.prototype.init;mxVertexHandler.prototype.init=function(){var t,i,r,n;rt.apply(this,arguments);t=!1;this.rotationShape!=null&&this.rotationShape.node.setAttribute("title",mxResources.get("rotateTooltip"));i=mxUtils.bind(this,function(){this.rotationShape!=null&&this.rotationShape.node!=null&&(this.rotationShape.node.style.display=this.graph.getSelectionCount()==1?"":"none");this.specialHandle!=null&&(this.specialHandle.node.style.display=this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells?"":"none");this.redrawHandles()});this.selectionHandler=mxUtils.bind(this,function(){i()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.selectionHandler);this.changeHandler=mxUtils.bind(this,function(){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell),this.graph.getLinksForState(this.state));i()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);this.editingHandler=mxUtils.bind(this,function(){this.redrawHandles()});this.graph.addListener(mxEvent.EDITING_STOPPED,this.editingHandler);r=this.graph.getLinkForCell(this.state.cell);n=this.graph.getLinksForState(this.state);this.updateLinkHint(r,n);(r!=null||n!=null&&n.length>0)&&(t=!0);t&&this.redrawHandles()};mxVertexHandler.prototype.updateLinkHint=function(t,i){var r,u,f,e;if(t==null&&(i==null||i.length==0)||this.graph.getSelectionCount()>1)this.linkHint!=null&&(this.linkHint.parentNode.removeChild(this.linkHint),this.linkHint=null);else if((t!=null||i!=null&&i.length>0)&&(this.linkHint==null&&(this.linkHint=n(),this.linkHint.style.padding="6px 8px 6px 8px",this.linkHint.style.fontSize="90%",this.linkHint.style.opacity="1",this.linkHint.style.filter="",this.graph.container.appendChild(this.linkHint)),this.linkHint.innerHTML="",t!=null&&(this.linkHint.appendChild(this.graph.createLinkForHint(t)),this.graph.isEnabled()&&typeof this.graph.editLink=="function"&&(r=document.createElement("img"),r.setAttribute("src",IMAGE_PATH+"/edit.gif"),r.setAttribute("title",mxResources.get("editLink")),r.setAttribute("width","11"),r.setAttribute("height","11"),r.style.marginLeft="10px",r.style.marginBottom="-1px",r.style.cursor="pointer",this.linkHint.appendChild(r),mxEvent.addListener(r,"click",mxUtils.bind(this,function(n){this.graph.setSelectionCell(this.state.cell);this.graph.editLink();mxEvent.consume(n)})),u=document.createElement("img"),u.setAttribute("src",Dialog.prototype.clearImage),u.setAttribute("title",mxResources.get("removeIt",[mxResources.get("link")])),u.setAttribute("width","13"),u.setAttribute("height","10"),u.style.marginLeft="4px",u.style.marginBottom="-1px",u.style.cursor="pointer",this.linkHint.appendChild(u),mxEvent.addListener(u,"click",mxUtils.bind(this,function(n){this.graph.setLinkForCell(this.state.cell,null);mxEvent.consume(n)})))),i!=null))for(f=0;f<i.length;f++)e=document.createElement("div"),e.style.marginTop=t!=null||f>0?"6px":"0px",e.appendChild(this.graph.createLinkForHint(i[f].getAttribute("href"),mxUtils.getTextContent(i[f]))),this.linkHint.appendChild(e)};mxEdgeHandler.prototype.updateLinkHint=mxVertexHandler.prototype.updateLinkHint;ut=mxEdgeHandler.prototype.init;mxEdgeHandler.prototype.init=function(){var t,i,n;ut.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,function(){return this.state.view.graph.connectionHandler.isEnabled()});t=mxUtils.bind(this,function(){this.linkHint!=null&&(this.linkHint.style.display=this.graph.getSelectionCount()==1?"":"none");this.labelShape!=null&&(this.labelShape.node.style.display=this.graph.isEnabled()&&this.graph.getSelectionCount()<this.graph.graphHandler.maxCells?"":"none")});this.selectionHandler=mxUtils.bind(this,function(){t()});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.selectionHandler);this.changeHandler=mxUtils.bind(this,function(){this.updateLinkHint(this.graph.getLinkForCell(this.state.cell),this.graph.getLinksForState(this.state));t();this.redrawHandles()});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);i=this.graph.getLinkForCell(this.state.cell);n=this.graph.getLinksForState(this.state);(i!=null||n!=null&&n.length>0)&&(this.updateLinkHint(i,n),this.redrawHandles())};ft=mxConnectionHandler.prototype.init;mxConnectionHandler.prototype.init=function(){ft.apply(this,arguments);this.constraintHandler.isEnabled=mxUtils.bind(this,function(){return this.graph.connectionHandler.isEnabled()})};et=mxVertexHandler.prototype.redrawHandles;mxVertexHandler.prototype.redrawHandles=function(){var t;if(et.apply(this),this.state!=null&&this.linkHint!=null){var u=new mxPoint(this.state.getCenterX(),this.state.getCenterY()),f=new mxRectangle(this.state.x,this.state.y-22,this.state.width+24,this.state.height+22),n=mxUtils.getBoundingBox(f,this.state.style[mxConstants.STYLE_ROTATION]||"0",u),r=n!=null?mxUtils.getBoundingBox(this.state,this.state.style[mxConstants.STYLE_ROTATION]||"0"):this.state,i=this.state.text!=null?this.state.text.boundingBox:null;n==null&&(n=this.state);t=n.y+n.height;i!=null&&(t=Math.max(t,i.y+i.height));this.linkHint.style.left=Math.max(0,Math.round(r.x+(r.width-this.linkHint.clientWidth)/2))+"px";this.linkHint.style.top=Math.round(t+this.verticalOffset/2+6+this.state.view.graph.tolerance)+"px"}};ot=mxVertexHandler.prototype.reset;mxVertexHandler.prototype.reset=function(){ot.apply(this,arguments);this.rotationShape!=null&&this.rotationShape.node!=null&&(this.rotationShape.node.style.display=this.graph.getSelectionCount()==1?"":"none")};st=mxVertexHandler.prototype.destroy;mxVertexHandler.prototype.destroy=function(){st.apply(this,arguments);this.linkHint!=null&&(this.linkHint.parentNode.removeChild(this.linkHint),this.linkHint=null);this.selectionHandler!=null&&(this.graph.getSelectionModel().removeListener(this.selectionHandler),this.selectionHandler=null);this.changeHandler!=null&&(this.graph.getModel().removeListener(this.changeHandler),this.changeHandler=null);this.editingHandler!=null&&(this.graph.removeListener(this.editingHandler),this.editingHandler=null)};ht=mxEdgeHandler.prototype.redrawHandles;mxEdgeHandler.prototype.redrawHandles=function(){if(this.marker!=null&&(ht.apply(this),this.state!=null&&this.linkHint!=null)){var n=this.state;this.state.text!=null&&this.state.text.bounds!=null&&(n=new mxRectangle(n.x,n.y,n.width,n.height),n.add(this.state.text.bounds));this.linkHint.style.left=Math.max(0,Math.round(n.x+(n.width-this.linkHint.clientWidth)/2))+"px";this.linkHint.style.top=Math.round(n.y+n.height+6+this.state.view.graph.tolerance)+"px"}};ct=mxEdgeHandler.prototype.reset;mxEdgeHandler.prototype.reset=function(){ct.apply(this,arguments);this.linkHint!=null&&(this.linkHint.style.visibility="")};lt=mxEdgeHandler.prototype.destroy;mxEdgeHandler.prototype.destroy=function(){lt.apply(this,arguments);this.linkHint!=null&&(this.linkHint.parentNode.removeChild(this.linkHint),this.linkHint=null);this.selectionHandler!=null&&(this.graph.getSelectionModel().removeListener(this.selectionHandler),this.selectionHandler=null);this.changeHandler!=null&&(this.graph.getModel().removeListener(this.changeHandler),this.changeHandler=null)}}();Format=function(n,t){this.editorUi=n;this.container=t};Format.prototype.labelIndex=0;Format.prototype.currentIndex=0;Format.prototype.showCloseButton=!0;Format.prototype.inactiveTabBackgroundColor="#d7d7d7";Format.prototype.init=function(){var t=this.editorUi,i=t.editor,n=i.graph;this.update=mxUtils.bind(this,function(){this.clearSelectionState();this.refresh()});n.getSelectionModel().addListener(mxEvent.CHANGE,this.update);n.addListener(mxEvent.EDITING_STARTED,this.update);n.addListener(mxEvent.EDITING_STOPPED,this.update);n.getModel().addListener(mxEvent.CHANGE,this.update);n.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()}));this.refresh()};Format.prototype.clearSelectionState=function(){this.selectionState=null};Format.prototype.getSelectionState=function(){return this.selectionState==null&&(this.selectionState=this.createSelectionState()),this.selectionState};Format.prototype.createSelectionState=function(){for(var n=this.editorUi.editor.graph.getSelectionCells(),i=this.initSelectionState(),t=0;t<n.length;t++)this.updateSelectionStateForCell(i,n[t],n);return i};Format.prototype.initSelectionState=function(){return{vertices:[],edges:[],x:null,y:null,width:null,height:null,style:{},containsImage:!1,containsLabel:!1,fill:!0,glass:!0,rounded:!0,comic:!0,autoSize:!1,image:!0,shadow:!0,lineJumps:!0}};Format.prototype.updateSelectionStateForCell=function(n,t){var f=this.editorUi.editor.graph,i,o,s,r,h,u,e;if(f.getModel().isVertex(t)?(n.vertices.push(t),i=f.getCellGeometry(t),i!=null&&(i.width>0?n.width==null?n.width=i.width:n.width!=i.width&&(n.width=""):n.containsLabel=!0,i.height>0?n.height==null?n.height=i.height:n.height!=i.height&&(n.height=""):n.containsLabel=!0,i.relative&&i.offset==null||(o=i.relative?i.offset.x:i.x,s=i.relative?i.offset.y:i.y,n.x==null?n.x=o:n.x!=o&&(n.x=""),n.y==null?n.y=s:n.y!=s&&(n.y="")))):f.getModel().isEdge(t)&&n.edges.push(t),r=f.view.getState(t),r!=null){n.autoSize=n.autoSize||this.isAutoSizeState(r);n.glass=n.glass&&this.isGlassState(r);n.rounded=n.rounded&&this.isRoundedState(r);n.lineJumps=n.lineJumps&&this.isLineJumpState(r);n.comic=n.comic&&this.isComicState(r);n.image=n.image&&this.isImageState(r);n.shadow=n.shadow&&this.isShadowState(r);n.fill=n.fill&&this.isFillState(r);h=mxUtils.getValue(r.style,mxConstants.STYLE_SHAPE,null);n.containsImage=n.containsImage||h=="image";for(u in r.style)e=r.style[u],e!=null&&(n.style[u]==null?n.style[u]=e:n.style[u]!=e&&(n.style[u]=""))}};Format.prototype.isFillState=function(n){return n.view.graph.model.isVertex(n.cell)||mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null)=="arrow"||mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null)=="filledEdge"||mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null)=="flexArrow"};Format.prototype.isGlassState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return t=="label"||t=="rectangle"||t=="internalStorage"||t=="ext"||t=="umlLifeline"||t=="swimlane"||t=="process"};Format.prototype.isRoundedState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return t=="label"||t=="rectangle"||t=="internalStorage"||t=="corner"||t=="parallelogram"||t=="swimlane"||t=="triangle"||t=="trapezoid"||t=="ext"||t=="step"||t=="tee"||t=="process"||t=="link"||t=="rhombus"||t=="offPageConnector"||t=="loopLimit"||t=="hexagon"||t=="manualInput"||t=="curlyBracket"||t=="singleArrow"||t=="callout"||t=="doubleArrow"||t=="flexArrow"||t=="card"||t=="umlLifeline"};Format.prototype.isLineJumpState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return t=="connector"||t=="filledEdge"};Format.prototype.isComicState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return mxUtils.indexOf(["label","rectangle","internalStorage","corner","parallelogram","note","collate","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","singleArrow","doubleArrow","flexArrow","filledEdge","card","umlLifeline","connector","folder","component","sortShape","cross","umlFrame","cube","isoCube","isoRectangle","partialRectangle"],t)>=0};Format.prototype.isAutoSizeState=function(n){return mxUtils.getValue(n.style,mxConstants.STYLE_AUTOSIZE,null)=="1"};Format.prototype.isImageState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return t=="label"||t=="image"};Format.prototype.isShadowState=function(n){var t=mxUtils.getValue(n.style,mxConstants.STYLE_SHAPE,null);return t!="image"};Format.prototype.clear=function(){if(this.container.innerHTML="",this.panels!=null)for(var n=0;n<this.panels.length;n++)this.panels[n].destroy();this.panels=[]};Format.prototype.refresh=function(){var n,l,v,y,u,i,b,k,o,d,s,f,c,p;if(this.container.style.width!="0px"){this.clear();var r=this.editorUi,e=r.editor.graph,t=document.createElement("div");if(t.style.whiteSpace="nowrap",t.style.color="rgb(112, 112, 112)",t.style.textAlign="left",t.style.cursor="default",n=document.createElement("div"),n.style.border="1px solid #c0c0c0",n.style.borderWidth="0px 0px 1px 0px",n.style.textAlign="center",n.style.fontWeight="bold",n.style.overflow="hidden",n.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",n.style.paddingTop="8px",n.style.height=mxClient.IS_QUIRKS?"34px":"25px",n.style.width="100%",this.container.appendChild(t),l=mxUtils.bind(this,function(n,t,i){var r=mxUtils.bind(this,function(){h!=n&&(w?this.labelIndex=i:this.currentIndex=i,h!=null&&(h.style.backgroundColor=this.inactiveTabBackgroundColor,h.style.borderBottomWidth="1px"),h=n,h.style.backgroundColor="",h.style.borderBottomWidth="0px",a!=t&&(a!=null&&(a.style.display="none"),a=t,a.style.display=""))});mxEvent.addListener(n,"click",r);i==(w?this.labelIndex:this.currentIndex)&&r()}),e.isSelectionEmpty()){var w=this.getSelectionState().containsLabel,h=null,a=null;let i=0;n.style.backgroundColor=this.inactiveTabBackgroundColor;n.style.borderLeftWidth="1px";n.style.width="50%";f=n.cloneNode(!1);f.style.backgroundColor=this.inactiveTabBackgroundColor;w?f.style.borderLeftWidth="0px":(n.style.borderLeftWidth="0px",mxUtils.write(n,mxResources.get("diagram")),t.appendChild(n),v=t.cloneNode(!1),v.style.display="none",this.panels.push(new DiagramFormatPanel(this,r,v)),this.container.appendChild(v),l(n,v,i++));mxUtils.write(f,"样式");t.appendChild(f);y=t.cloneNode(!1);y.style.display="none";this.panels.push(new StyleFormatPanel(this,r,y));this.container.appendChild(y);l(f,y,i++)}else if(!e.isEditing()&&(u=e.getSelectionCell(),e.getSelectionCount()==1))if(e.getModel().isEdge(u)){if(mxUtils.write(n,"流转设置"),this.showCloseButton&&(i=document.createElement("img"),i.setAttribute("border","0"),i.setAttribute("src",Dialog.prototype.closeImage),i.setAttribute("title",mxResources.get("hide")),i.style.position="absolute",i.style.display="block",i.style.right="0px",i.style.top="8px",i.style.cursor="pointer",i.style.marginTop="1px",i.style.marginRight="17px",i.style.border="1px solid transparent",i.style.padding="1px",i.style.opacity=.5,n.appendChild(i),mxEvent.addListener(i,"click",function(){r.actions.get("formatPanel").funct()})),b=u.value,b==null){k=mxUtils.createXmlDocument();o=k.createElement("transition");o.setAttribute("label","无");o.setAttribute("placeholders","1");o.setAttribute("nodeName","流转设置");o.setAttribute("nodeDesc","");o.setAttribute("nodeType","100");o.setAttribute("priority","1");o.setAttribute("condition","");o.setAttribute("conditionDesc","");e.getModel().beginUpdate();u.value=o;try{d=new mxCellAttributeChange(u,"label","无");e.getModel().execute(d);e.updateCellSize(u)}finally{e.getModel().endUpdate()}}t.appendChild(n);this.panels.push(new TransferFormatPanel(this,r,t))}else if(e.getModel().isVertex(u)){if(u.value===""){e.setSelectionCell(u.parent);return}if(!mxUtils.isNode(u.value))return;if(u.value.nodeName==="swimlane")mxUtils.write(n,"泳道设置"),t.appendChild(n),this.panels.push(new SwimlaneFormatPanel(this,r,t));else if(u.value.nodeName==="activity"){mxUtils.write(n,"节点设置");t.appendChild(n);let i=0;s=u.value.getAttribute("nodeType");s=="0"?this.panels.push(new StartFormatPanel(this,r,t)):s=="99"?this.panels.push(new EndFormatPanel(this,r,t)):s==="98"?this.panels.push(new SubProcessFormatPanel(this,r,t)):s==="8"?this.panels.push(new GatewayFormatPanel(this,r,t)):(n.style.backgroundColor=this.inactiveTabBackgroundColor,n.style.borderLeftWidth="1px",n.style.width="50%",f=n.cloneNode(!1),f.style.backgroundColor=this.inactiveTabBackgroundColor,w?f.style.borderLeftWidth="0px":(n.style.borderLeftWidth="0px",c=t.cloneNode(!1),c.style.display="none",s=="2"?this.panels.push(new CounterTaskFormatPanel(this,r,c)):s=="1"?this.panels.push(new TaskFormatPanel(this,r,c)):s=="3"&&this.panels.push(new TimerTaskFormatPanel(this,r,c)),this.container.appendChild(c),l(n,c,i++)),mxUtils.write(f,"单据权限"),t.appendChild(f),p=t.cloneNode(!1),p.style.display="none",this.panels.push(new TaskBillFormatPanel(this,r,p)),this.container.appendChild(p),l(f,p,i++))}}}};BaseFormatPanel=function(n,t,i){this.format=n;this.editorUi=t;this.container=i;this.listeners=[]};BaseFormatPanel.prototype.buttonBackgroundColor="white";BaseFormatPanel.prototype.getSelectionState=function(){for(var r,t,u=this.editorUi.editor.graph,f=u.getSelectionCells(),n=null,i=0;i<f.length;i++)if(r=u.view.getState(f[i]),r!=null&&(t=mxUtils.getValue(r.style,mxConstants.STYLE_SHAPE,null),t!=null))if(n==null)n=t;else if(n!=t)return null;return n};BaseFormatPanel.prototype.installInputHandler=function(n,t,i,r,u,f,e,o){var c,s;f=f!=null?f:"";o=o!=null?o:!1;c=this.editorUi;s=c.editor.graph;r=r!=null?r:1;u=u!=null?u:999;var h=null,l=!1,a=mxUtils.bind(this,function(a){var v=o?parseFloat(n.value):parseInt(n.value);if(isNaN(v)||t!=mxConstants.STYLE_ROTATION||(v=mxUtils.mod(Math.round(v*100),36e3)/100),v=Math.min(u,Math.max(r,isNaN(v)?i:v)),s.cellEditor.isContentEditing()&&e)l||(l=!0,h!=null&&(s.cellEditor.restoreSelection(h),h=null),e(v),n.value=v+f,l=!1);else if(v!=mxUtils.getValue(this.format.getSelectionState().style,t,i)){s.isEditing()&&s.stopEditing(!0);s.getModel().beginUpdate();try{s.setCellStyles(t,v,s.getSelectionCells());t==mxConstants.STYLE_FONTSIZE&&s.updateLabelElements(s.getSelectionCells(),function(n){n.style.fontSize=v+"px";n.removeAttribute("size")});c.fireEvent(new mxEventObject("styleChanged","keys",[t],"values",[v],"cells",s.getSelectionCells()))}finally{s.getModel().endUpdate()}}n.value=v+f;mxEvent.consume(a)});return e&&s.cellEditor.isContentEditing()&&(mxEvent.addListener(n,"mousedown",function(){document.activeElement==s.cellEditor.textarea&&(h=s.cellEditor.saveSelection())}),mxEvent.addListener(n,"touchstart",function(){document.activeElement==s.cellEditor.textarea&&(h=s.cellEditor.saveSelection())})),mxEvent.addListener(n,"change",a),mxEvent.addListener(n,"blur",a),a};BaseFormatPanel.prototype.createPanel=function(){var n=document.createElement("div");return n.style.padding="12px 0px 12px 18px",n.style.borderBottom="1px solid #c0c0c0",n};BaseFormatPanel.prototype.createLabel=function(n,t){var i=document.createElement("div");mxUtils.write(i,t);i.style.marginTop="6px";n.appendChild(i)};BaseFormatPanel.prototype.createTextbox=function(n,t,i,r){function f(n){var t=u.value;r&&r(t);mxEvent.consume(n)}var u=document.createElement("input");return u.style.marginTop="6px",u.style.width="90%",u.placeholder=t,u.value=i,mxEvent.addListener(u,"blur",f),mxEvent.addListener(u,"change",f),n.appendChild(u),u};BaseFormatPanel.prototype.createSelect=function(n,t,i,r){function c(){var n=u.value;r&&r(n)}var o,s,f;n.style.marginLeft="0px";n.style.paddingTop="4px";n.style.paddingBottom="4px";n.style.fontWeight="normal";var h=t.getSelectionCell(),u=document.createElement("select"),e=document.createElement("option");e.value="-1";e.text="--请选择--";u.appendChild(e);u.style.width="200px";u.style.marginTop="2px";o=t.getModel().cells;for(s in o){let n=o[s],t=n.getAttribute("nodeType");t&&h.id!=n.id&&(t=="1"||t=="2"||t=="3")&&(f=document.createElement("option"),f.value=n.id,n.id==i&&(f.selected=!0),f.text=n.getAttribute("label"),u.add(f))}return n.appendChild(u),mxEvent.addListener(u,"change",c),this.listeners.push({destroy:function(){mxEvent.removeListener(u,"change")}}),u};BaseFormatPanel.prototype.createTextarea=function(n,t,i,r){function f(n){var t=u.value;r&&r(t);mxEvent.consume(n)}var u=document.createElement("textarea");u.style.marginTop="2px";u.style.width="90%";u.placeholder=t;u.rows=3;u.value=i;mxEvent.addListener(u,"blur",f);mxEvent.addListener(u,"change",f);mxEvent.addListener(u,"mouseup",function(n){u.focus();mxEvent.consume(n)});mxEvent.addListener(u,"touchend",function(n){u.focus();mxEvent.consume(n)});this.listeners.push({destroy:function(){}});n.appendChild(u)};var createParticipantTags=function(n,t,i){if(t)for(let r=0;r<t.length;r++){let o=t[r],f=document.createElement("div");f.style.position="relative";f.style.fontSize="13px";f.style.fontWeight="normal";f.style.verticalAlign="baseline";f.style.whiteSpace="nowrap";let e=o.name;f.title=e;e.length>7&&(e=e.substring(0,7)+"...");o.type=="1"?(f.style.backgroundColor="rgb(148, 142, 142)",f.innerHTML="用户: "+e):o.type=="2"?(f.style.backgroundColor="#797979",f.innerHTML="指派角色: "+e):(f.style.backgroundColor="#444444",f.innerHTML="动态角色: "+e);f.style.color="#FFF";f.style.textShadow="1px 1px 1px rgba(0, 0, 0, 0.15)";f.style.padding="4px 22px 5px 9px";f.style.marginBottom="3px";f.style.marginRight="3px";f.style.webkitTransition="all 0.2s";f.style.transition="all 0.2s";let u=document.createElement("button");u.innerHTML="×";u.style.fontSize="15px";u.style.opacity="1";u.style.filter="alpha(opacity = 100)";u.style.color="#FFF";u.style.textShadow="none";u.style.float="none";u.style.position="absolute";u.style.right="0";u.style.top="0";u.style.bottom="0";u.style.width="18px";u.style.lineHeight="20px";u.style.textAlign="center";u.style.padding="0";u.style.cursor="pointer";u.style.background="transparent";u.style.border="0";u.style.fontWeight="bold";f.appendChild(u);mxEvent.addListener(u,"click",function(){u.parentNode.remove();t.splice(r,1);i&&i(t)});n.appendChild(f)}},createTransitionTags=function(n,t,i){if(t){let u=document.createElement("div");u.style.position="relative";u.style.fontSize="13px";u.style.fontWeight="normal";u.style.verticalAlign="baseline";u.style.whiteSpace="nowrap";u.title=t;t.length>20&&(t=t.substring(0,20)+"...");u.style.backgroundColor="rgb(148, 142, 142)";u.innerHTML=t;u.style.color="#FFF";u.style.textShadow="1px 1px 1px rgba(0, 0, 0, 0.15)";u.style.padding="4px 22px 5px 9px";u.style.marginBottom="3px";u.style.marginRight="3px";u.style.webkitTransition="all 0.2s";u.style.transition="all 0.2s";let r=document.createElement("button");r.innerHTML="×";r.style.fontSize="15px";r.style.opacity="1";r.style.filter="alpha(opacity = 100)";r.style.color="#FFF";r.style.textShadow="none";r.style.float="none";r.style.position="absolute";r.style.right="0";r.style.top="0";r.style.bottom="0";r.style.width="18px";r.style.lineHeight="20px";r.style.textAlign="center";r.style.padding="0";r.style.cursor="pointer";r.style.background="transparent";r.style.border="0";r.style.fontWeight="bold";u.appendChild(r);mxEvent.addListener(r,"click",function(){r.parentNode.remove();i&&i(t)});n.appendChild(u)}},participantsRefresh=function(n,t){var f=n,u=f.childNodes,e=mxUtils.createXmlDocument(),i,r;if(u)for(i=u.length-1;i>=0;i--){let n=u[i];if(n.nodeType==1){let t=n.getAttribute("pType");(t==="1"||t==="2"||t==="3")&&n.parentNode.removeChild(n)}}if(t)for(i=0;i<t.length;i++){r=t[i];let n=e.createElement("participant");f.appendChild(n);n.setAttribute("pValue",r.id);n.setAttribute("pName",r.name);n.setAttribute("pType",r.type);n.setAttribute("pColumn",r.colname)}};BaseFormatPanel.prototype.createTitle=function(n){var t=document.createElement("div");return t.style.padding="0px 0px 6px 0px",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.width="200px",t.style.fontWeight="bold",mxUtils.write(t,n),t};BaseFormatPanel.prototype.createStepper=function(n,t,i,r,u,f){var o,e,s,h;return i=i!=null?i:1,r=r!=null?r:8,mxClient.IS_QUIRKS?r=r-2:(mxClient.IS_MT||document.documentMode>=8)&&(r=r+1),o=document.createElement("div"),mxUtils.setPrefixedStyle(o.style,"borderRadius","3px"),o.style.border="1px solid rgb(192, 192, 192)",o.style.position="absolute",e=document.createElement("div"),e.style.borderBottom="1px solid rgb(192, 192, 192)",e.style.position="relative",e.style.height=r+"px",e.style.width="10px",e.className="geBtnUp",o.appendChild(e),s=e.cloneNode(!1),s.style.border="none",s.style.height=r+"px",s.className="geBtnDown",o.appendChild(s),mxEvent.addListener(s,"click",function(r){n.value==""&&(n.value=f||"2");var u=parseInt(n.value);isNaN(u)||(n.value=u-i,t!=null&&t(r));mxEvent.consume(r)}),mxEvent.addListener(e,"click",function(r){n.value==""&&(n.value=f||"0");var u=parseInt(n.value);isNaN(u)||(n.value=u+i,t!=null&&t(r));mxEvent.consume(r)}),u&&(h=null,mxEvent.addGestureListeners(o,function(n){(mxClient.IS_QUIRKS||document.documentMode==8)&&(h=document.selection.createRange());mxEvent.consume(n)},null,function(n){if(h!=null){try{h.select()}catch(t){}h=null;mxEvent.consume(n)}})),o};BaseFormatPanel.prototype.createOption=function(n,t,i,r){var f=document.createElement("div"),u,o;f.style.padding="6px 0px 1px 0px";f.style.whiteSpace="nowrap";f.style.overflow="hidden";f.style.width="200px";f.style.height=mxClient.IS_QUIRKS?"27px":"18px";u=document.createElement("input");u.setAttribute("type","checkbox");u.style.margin="0px 6px 0px 0px";f.appendChild(u);o=document.createElement("span");mxUtils.write(o,n);f.appendChild(o);var s=!1,e=t(),h=function(n){s||(s=!0,n=="1"?(u.setAttribute("checked","checked"),u.defaultChecked=!0,u.checked=!0):(u.removeAttribute("checked"),u.defaultChecked=!1,u.checked=!1),e!=n&&(e=n,t()!=e&&i(e?1:0)),s=!1)};return mxEvent.addListener(f,"click",function(n){if(u.getAttribute("disabled")!="disabled"){var t=mxEvent.getSource(n);(t==f||t==o)&&(u.checked=!u.checked);h(u.checked)}mxEvent.consume(n)}),h(e),r!=null&&(r.install(h),this.listeners.push(r)),f};BaseFormatPanel.prototype.createCellOption=function(n,t,i,r,u,f,e,o){r=r!=null?r=="null"?null:r:"1";u=u!=null?u=="null"?null:u:"0";var h=this.editorUi,c=h.editor,s=c.graph;return this.createOption(n,function(){var n=s.view.getState(s.getSelectionCell());return n!=null?mxUtils.getValue(n.style,t,i)!=u:null},function(n){if(o&&s.stopEditing(),e!=null)e.funct();else{s.getModel().beginUpdate();try{var i=n?r:u;s.setCellStyles(t,i,s.getSelectionCells());f!=null&&f(s.getSelectionCells(),i);h.fireEvent(new mxEventObject("styleChanged","keys",[t],"values",[i],"cells",s.getSelectionCells()))}finally{s.getModel().endUpdate()}}},{install:function(n){this.listener=function(){var r=s.view.getState(s.getSelectionCell());r!=null&&n(mxUtils.getValue(r.style,t,i)!=u)};s.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){s.getModel().removeListener(this.listener)}})};BaseFormatPanel.prototype.createColorOption=function(n,t,i,r,u,f,e){var h=document.createElement("div"),o,a;h.style.padding="6px 0px 1px 0px";h.style.whiteSpace="nowrap";h.style.overflow="hidden";h.style.width="200px";h.style.height=mxClient.IS_QUIRKS?"27px":"18px";o=document.createElement("input");o.setAttribute("type","checkbox");o.style.margin="0px 6px 0px 0px";e||h.appendChild(o);a=document.createElement("span");mxUtils.write(a,n);h.appendChild(a);var v=!1,c=t(),s=null,l=function(n,u,h){v||(v=!0,s.innerHTML='<div style="width:'+(mxClient.IS_QUIRKS?"30":"36")+"px;height:12px;margin:3px;border:1px solid black;background-color:"+(n!=null&&n!=mxConstants.NONE?n:r)+';"><\/div>',(mxClient.IS_QUIRKS||document.documentMode==8)&&(s.firstChild.style.margin="0px"),n!=null&&n!=mxConstants.NONE?(o.setAttribute("checked","checked"),o.defaultChecked=!0,o.checked=!0):(o.removeAttribute("checked"),o.defaultChecked=!1,o.checked=!1),s.style.display=o.checked||e?"":"none",f!=null&&f(n),u||(c=n,(h||e||t()!=c)&&i(c)),v=!1)};return s=mxUtils.button("",mxUtils.bind(this,function(n){this.editorUi.pickColor(c,function(n){l(n,null,!0)});mxEvent.consume(n)})),s.style.position="absolute",s.style.marginTop="-4px",s.style.right=mxClient.IS_QUIRKS?"0px":"20px",s.style.height="22px",s.className="geColorBtn",s.style.display=o.checked||e?"":"none",h.appendChild(s),mxEvent.addListener(h,"click",function(n){var t=mxEvent.getSource(n);(t==o||t.nodeName!="INPUT")&&(t!=o&&(o.checked=!o.checked),o.checked||c==null||c==mxConstants.NONE||r==mxConstants.NONE||(r=c),l(o.checked?r:mxConstants.NONE))}),l(c,!0),u!=null&&(u.install(l),this.listeners.push(u)),h};BaseFormatPanel.prototype.createCellColorOption=function(n,t,i,r,u){var e=this.editorUi,o=e.editor,f=o.graph;return this.createColorOption(n,function(){var n=f.view.getState(f.getSelectionCell());return n!=null?mxUtils.getValue(n.style,t,null):null},function(n){f.getModel().beginUpdate();try{u!=null&&u(n);f.setCellStyles(t,n,f.getSelectionCells());e.fireEvent(new mxEventObject("styleChanged","keys",[t],"values",[n],"cells",f.getSelectionCells()))}finally{f.getModel().endUpdate()}},i||mxConstants.NONE,{install:function(n){this.listener=function(){var i=f.view.getState(f.getSelectionCell());i!=null&&n(mxUtils.getValue(i.style,t,null))};f.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){f.getModel().removeListener(this.listener)}},r)};BaseFormatPanel.prototype.addArrow=function(n,t){var i,u,r;return t=t!=null?t:10,i=document.createElement("div"),i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",i.style.padding="6px",i.style.paddingRight="4px",u=10-t,u==2?i.style.paddingTop="6px":u>0?i.style.paddingTop=6-u+"px":i.style.marginTop="-2px",i.style.height=t+"px",i.style.borderLeft="1px solid #a0a0a0",i.innerHTML='<img border="0" src="'+(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUeNpidHB2ZyAGsACxDRBPIKCuA6TwCBB/h2rABu4A8SYmKCcXiP/iUFgAxL9gCi8A8SwsirZCMQMTkmANEH9E4v+CmsaArvAdyNFI/FlQ92EoBIE+qCRIUz168DBgsU4OqhinQpgHMABAgAEALY4XLIsJ20oAAAAASUVORK5CYII=":IMAGE_PATH+"/dropdown.png")+'" style="margin-bottom:4px;">',mxUtils.setOpacity(i,70),r=n.getElementsByTagName("div")[0],r!=null&&(r.style.paddingRight="6px",r.style.marginLeft="4px",r.style.marginTop="-1px",r.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",mxUtils.setOpacity(r,60)),mxUtils.setOpacity(n,100),n.style.border="1px solid #a0a0a0",n.style.backgroundColor=this.buttonBackgroundColor,n.style.backgroundImage="none",n.style.width="auto",n.className+=" geColorBtn",mxUtils.setPrefixedStyle(n.style,"borderRadius","3px"),n.appendChild(i),r};BaseFormatPanel.prototype.addUnitInput=function(n,t,i,r,u,f,e,o){var s,h;return e=e!=null?e:0,s=document.createElement("input"),s.style.position="absolute",s.style.textAlign="right",s.style.marginTop="-2px",s.style.right=i+12+"px",s.style.width=r+"px",n.appendChild(s),h=this.createStepper(s,u,f,null,o),h.style.marginTop=e-2+"px",h.style.right=i+"px",n.appendChild(h),s};BaseFormatPanel.prototype.createRelativeOption=function(n,t,i,r){function e(n){i!=null&&i(f);mxEvent.consume(n)}var u,f;return t=t!=null?t:44,u=this.createPanel(),u.style.paddingTop="10px",u.style.paddingBottom="10px",mxUtils.write(u,n),u.style.fontWeight="bold",f=this.addUnitInput(u,"%",20,t,e,10,-15,i!=null),mxEvent.addListener(f,"blur",e),mxEvent.addListener(f,"change",e),r!=null&&r(f),u};BaseFormatPanel.prototype.addLabel=function(n,t,i,r){r=r!=null?r:61;var u=document.createElement("div");mxUtils.write(u,t);u.style.position="absolute";u.style.right=i+"px";u.style.width=r+"px";u.style.marginTop="6px";u.style.textAlign="center";n.appendChild(u)};BaseFormatPanel.prototype.addKeyHandler=function(n,t){mxEvent.addListener(n,"keydown",mxUtils.bind(this,function(n){n.keyCode==13?(this.editorUi.editor.graph.container.focus(),mxEvent.consume(n)):n.keyCode==27&&(t!=null&&t(null,null,!0),this.editorUi.editor.graph.container.focus(),mxEvent.consume(n))}))};BaseFormatPanel.prototype.styleButtons=function(n){for(var t=0;t<n.length;t++)mxUtils.setPrefixedStyle(n[t].style,"borderRadius","3px"),mxUtils.setOpacity(n[t],100),n[t].style.border="1px solid #a0a0a0",n[t].style.padding="4px",n[t].style.paddingTop="3px",n[t].style.paddingRight="1px",n[t].style.margin="1px",n[t].style.width="24px",n[t].style.height="20px",n[t].className+=" geColorBtn"};BaseFormatPanel.prototype.destroy=function(){if(this.listeners!=null){for(var n=0;n<this.listeners.length;n++)this.listeners[n].destroy();this.listeners=null}};ArrangePanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(ArrangePanel,BaseFormatPanel);ArrangePanel.prototype.init=function(){var t=this.editorUi.editor.graph,n=this.format.getSelectionState();this.container.appendChild(this.addLayerOps(this.createPanel()));this.addGeometry(this.container);this.addEdgeGeometry(this.container);n.containsLabel&&n.edges.length!=0||this.container.appendChild(this.addAngle(this.createPanel()));n.containsLabel||n.edges.length!=0||this.container.appendChild(this.addFlip(this.createPanel()));n.vertices.length>1&&(this.container.appendChild(this.addAlign(this.createPanel())),this.container.appendChild(this.addDistribute(this.createPanel())));this.container.appendChild(this.addGroupOps(this.createPanel()))};ArrangePanel.prototype.addLayerOps=function(n){var i=this.editorUi,t=mxUtils.button(mxResources.get("toFront"),function(){i.actions.get("toFront").funct()});return t.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")"),t.style.width="100px",t.style.marginRight="2px",n.appendChild(t),t=mxUtils.button(mxResources.get("toBack"),function(){i.actions.get("toBack").funct()}),t.setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")"),t.style.width="100px",n.appendChild(t),n};ArrangePanel.prototype.addGroupOps=function(n){var f=this.editorUi,i=f.editor.graph,u=i.getSelectionCell(),e=this.format.getSelectionState(),r=0,t=null;return n.style.paddingTop="8px",n.style.paddingBottom="6px",i.getSelectionCount()>1?(t=mxUtils.button(mxResources.get("group"),function(){f.actions.get("group").funct()}),t.setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")"),t.style.width="202px",t.style.marginBottom="2px",n.appendChild(t),r++):i.getSelectionCount()==1&&!i.getModel().isEdge(u)&&!i.isSwimlane(u)&&i.getModel().getChildCount(u)>0&&(t=mxUtils.button(mxResources.get("ungroup"),function(){f.actions.get("ungroup").funct()}),t.setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")"),t.style.width="202px",t.style.marginBottom="2px",n.appendChild(t),r++),i.getSelectionCount()==1&&i.getModel().isVertex(u)&&i.getModel().isVertex(i.getModel().getParent(u))?(r>0&&mxUtils.br(n),t=mxUtils.button(mxResources.get("removeFromGroup"),function(){f.actions.get("removeFromGroup").funct()}),t.setAttribute("title",mxResources.get("removeFromGroup")),t.style.width="202px",t.style.marginBottom="2px",n.appendChild(t),r++):i.getSelectionCount()>0&&(r>0&&mxUtils.br(n),t=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(){this.editorUi.actions.get("clearWaypoints").funct()})),t.setAttribute("title",mxResources.get("clearWaypoints")+" ("+this.editorUi.actions.get("clearWaypoints").shortcut+")"),t.style.width="202px",t.style.marginBottom="2px",n.appendChild(t),r++),i.getSelectionCount()==1&&(r>0&&mxUtils.br(n),t=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(){this.editorUi.actions.get("editData").funct()})),t.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),t.style.width="100px",t.style.marginBottom="2px",n.appendChild(t),r++,t=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(){this.editorUi.actions.get("editLink").funct()})),t.setAttribute("title",mxResources.get("editLink")),t.style.width="100px",t.style.marginLeft="2px",t.style.marginBottom="2px",n.appendChild(t),r++),r==0&&(n.style.display="none"),n};ArrangePanel.prototype.addAlign=function(n){var i=this.editorUi.editor.graph,t;n.style.paddingTop="6px";n.style.paddingBottom="12px";n.appendChild(this.createTitle(mxResources.get("align")));t=document.createElement("div");t.style.position="relative";t.style.paddingLeft="0px";t.style.borderWidth="0px";t.className="geToolbarContainer";mxClient.IS_QUIRKS&&(n.style.height="60px");var u=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){i.alignCells(mxConstants.ALIGN_LEFT)},t),f=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){i.alignCells(mxConstants.ALIGN_CENTER)},t),r=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){i.alignCells(mxConstants.ALIGN_RIGHT)},t),e=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){i.alignCells(mxConstants.ALIGN_TOP)},t),o=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){i.alignCells(mxConstants.ALIGN_MIDDLE)},t),s=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){i.alignCells(mxConstants.ALIGN_BOTTOM)},t);return this.styleButtons([u,f,r,e,o,s]),r.style.marginRight="6px",n.appendChild(t),n};ArrangePanel.prototype.addFlip=function(n){var u=this.editorUi,f=u.editor,r=f.graph,i,t;return n.style.paddingTop="6px",n.style.paddingBottom="10px",i=document.createElement("div"),i.style.marginTop="2px",i.style.marginBottom="8px",i.style.fontWeight="bold",mxUtils.write(i,mxResources.get("flip")),n.appendChild(i),t=mxUtils.button(mxResources.get("horizontal"),function(){r.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)}),t.setAttribute("title",mxResources.get("horizontal")),t.style.width="100px",t.style.marginRight="2px",n.appendChild(t),t=mxUtils.button(mxResources.get("vertical"),function(){r.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)}),t.setAttribute("title",mxResources.get("vertical")),t.style.width="100px",n.appendChild(t),n};ArrangePanel.prototype.addDistribute=function(n){var r=this.editorUi,u=r.editor,i=u.graph,t;return n.style.paddingTop="6px",n.style.paddingBottom="12px",n.appendChild(this.createTitle(mxResources.get("distribute"))),t=mxUtils.button(mxResources.get("horizontal"),function(){i.distributeCells(!0)}),t.setAttribute("title",mxResources.get("horizontal")),t.style.width="100px",t.style.marginRight="2px",n.appendChild(t),t=mxUtils.button(mxResources.get("vertical"),function(){i.distributeCells(!1)}),t.setAttribute("title",mxResources.get("vertical")),t.style.width="100px",n.appendChild(t),n};ArrangePanel.prototype.addAngle=function(n){var o=this.editorUi,c=o.editor,s=c.graph,t=this.format.getSelectionState(),i,u,e;n.style.paddingBottom="8px";i=document.createElement("div");i.style.position="absolute";i.style.width="70px";i.style.marginTop="0px";i.style.fontWeight="bold";var r=null,h=null,f=null;return t.edges.length==0?(mxUtils.write(i,mxResources.get("angle")),n.appendChild(i),r=this.addUnitInput(n,"°",20,44,function(){h.apply(this,arguments)}),mxUtils.br(n),n.style.paddingTop="10px"):n.style.paddingTop="8px",t.containsLabel||(u=mxResources.get("reverse"),t.vertices.length>0&&t.edges.length>0?u=mxResources.get("turn")+" / "+u:t.vertices.length>0&&(u=mxResources.get("turn")),f=mxUtils.button(u,function(){o.actions.get("turn").funct()}),f.setAttribute("title",u+" ("+this.editorUi.actions.get("turn").shortcut+")"),f.style.width="202px",n.appendChild(f),r!=null&&(f.style.marginTop="8px")),r!=null&&(e=mxUtils.bind(this,function(n,i,u){if(u||document.activeElement!=r){t=this.format.getSelectionState();var f=parseFloat(mxUtils.getValue(t.style,mxConstants.STYLE_ROTATION,0));r.value=isNaN(f)?"":f+"°"}}),h=this.installInputHandler(r,mxConstants.STYLE_ROTATION,0,0,360,"°",null,!0),this.addKeyHandler(r,e),s.getModel().addListener(mxEvent.CHANGE,e),this.listeners.push({destroy:function(){s.getModel().removeListener(e)}}),e()),n};ArrangePanel.prototype.addGeometry=function(n){var p=this.editorUi,c=p.editor.graph,t=this.format.getSelectionState(),u=this.createPanel(),o,v,y,f,i,s,h,e;u.style.paddingBottom="8px";i=document.createElement("div");i.style.position="absolute";i.style.width="50px";i.style.marginTop="0px";i.style.fontWeight="bold";mxUtils.write(i,mxResources.get("size"));u.appendChild(i);var w,b,k,d,l=this.addUnitInput(u,"pt",84,44,function(){w.apply(this,arguments)}),a=this.addUnitInput(u,"pt",20,44,function(){b.apply(this,arguments)}),r=document.createElement("div");r.className="geSprite geSprite-fit";r.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")");r.style.position="relative";r.style.cursor="pointer";r.style.marginTop="-3px";r.style.border="0px";r.style.left="52px";mxUtils.setOpacity(r,50);mxEvent.addListener(r,"mouseenter",function(){mxUtils.setOpacity(r,100)});mxEvent.addListener(r,"mouseleave",function(){mxUtils.setOpacity(r,50)});mxEvent.addListener(r,"click",function(){p.actions.get("autosize").funct()});u.appendChild(r);this.addLabel(u,mxResources.get("width"),84);this.addLabel(u,mxResources.get("height"),20);mxUtils.br(u);o=document.createElement("div");o.style.paddingTop="8px";o.style.paddingRight="20px";o.style.whiteSpace="nowrap";o.style.textAlign="right";v=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");v.style.width="100%";o.appendChild(v);u.appendChild(o);y=v.getElementsByTagName("input")[0];this.addKeyHandler(l,e);this.addKeyHandler(a,e);w=this.addGeometryHandler(l,function(n,t){if(n.width>0){var t=Math.max(1,t);y.checked&&(n.height=Math.round(n.height*t*100/n.width)/100);n.width=t}});b=this.addGeometryHandler(a,function(n,t){if(n.height>0){var t=Math.max(1,t);y.checked&&(n.width=Math.round(n.width*t*100/n.height)/100);n.height=t}});n.appendChild(u);f=this.createPanel();f.style.paddingBottom="30px";i=document.createElement("div");i.style.position="absolute";i.style.width="70px";i.style.marginTop="0px";i.style.fontWeight="bold";mxUtils.write(i,mxResources.get("position"));f.appendChild(i);s=this.addUnitInput(f,"pt",84,44,function(){k.apply(this,arguments)});h=this.addUnitInput(f,"pt",20,44,function(){d.apply(this,arguments)});mxUtils.br(f);this.addLabel(f,mxResources.get("left"),84);this.addLabel(f,mxResources.get("top"),20);e=mxUtils.bind(this,function(n,i,r){t=this.format.getSelectionState();t.containsLabel||t.vertices.length!=c.getSelectionCount()||t.width==null||t.height==null?u.style.display="none":(u.style.display="",(r||document.activeElement!=l)&&(l.value=t.width+(t.width==""?"":" pt")),(r||document.activeElement!=a)&&(a.value=t.height+(t.height==""?"":" pt")));t.vertices.length==c.getSelectionCount()&&t.x!=null&&t.y!=null?(f.style.display="",(r||document.activeElement!=s)&&(s.value=t.x+(t.x==""?"":" pt")),(r||document.activeElement!=h)&&(h.value=t.y+(t.y==""?"":" pt"))):f.style.display="none"});this.addKeyHandler(s,e);this.addKeyHandler(h,e);c.getModel().addListener(mxEvent.CHANGE,e);this.listeners.push({destroy:function(){c.getModel().removeListener(e)}});e();k=this.addGeometryHandler(s,function(n,t){n.relative?n.offset.x=t:n.x=t});d=this.addGeometryHandler(h,function(n,t){n.relative?n.offset.y=t:n.y=t});n.appendChild(f)};ArrangePanel.prototype.addGeometryHandler=function(n,t){function u(u){var f,s,e,o;if(n.value!="")if(f=parseFloat(n.value),f!=r){i.getModel().beginUpdate();try{for(s=i.getSelectionCells(),e=0;e<s.length;e++)i.getModel().isVertex(s[e])&&(o=i.getCellGeometry(s[e]),o!=null&&(o=o.clone(),t(o,f),i.getModel().setGeometry(s[e],o)))}finally{i.getModel().endUpdate()}r=f;n.value=f+" pt"}else isNaN(f)&&(n.value=r+" pt");mxEvent.consume(u)}var f=this.editorUi,i=f.editor.graph,r=null;return mxEvent.addListener(n,"blur",u),mxEvent.addListener(n,"change",u),mxEvent.addListener(n,"focus",function(){r=n.value}),u};ArrangePanel.prototype.addEdgeGeometryHandler=function(n,t){function u(u){var f,s,e,o;if(n.value!="")if(f=parseFloat(n.value),isNaN(f))n.value=r+" pt";else if(f!=r){i.getModel().beginUpdate();try{for(s=i.getSelectionCells(),e=0;e<s.length;e++)i.getModel().isEdge(s[e])&&(o=i.getCellGeometry(s[e]),o!=null&&(o=o.clone(),t(o,f),i.getModel().setGeometry(s[e],o)))}finally{i.getModel().endUpdate()}r=f;n.value=f+" pt"}mxEvent.consume(u)}var f=this.editorUi,i=f.editor.graph,r=null;return mxEvent.addListener(n,"blur",u),mxEvent.addListener(n,"change",u),mxEvent.addListener(n,"focus",function(){r=n.value}),u};ArrangePanel.prototype.addEdgeGeometry=function(n){function v(n){var t=parseInt(e.value);t=Math.min(999,Math.max(1,isNaN(t)?1:t));t!=mxUtils.getValue(s.style,"width",mxCellRenderer.defaultShapes.flexArrow.prototype.defaultWidth)&&(i.setCellStyles("width",t,i.getSelectionCells()),y.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[t],"cells",i.getSelectionCells())));e.value=t+" pt";mxEvent.consume(n)}var y=this.editorUi,i=y.editor.graph,s=this.format.getSelectionState(),o=this.createPanel(),t=document.createElement("div"),v,p,w,b,k,e,r,h,c,u,l,a,f;t.style.position="absolute";t.style.width="70px";t.style.marginTop="0px";t.style.fontWeight="bold";mxUtils.write(t,mxResources.get("width"));o.appendChild(t);e=this.addUnitInput(o,"pt",20,44,function(){v.apply(this,arguments)});mxUtils.br(o);this.addKeyHandler(e,f);mxEvent.addListener(e,"blur",v);mxEvent.addListener(e,"change",v);n.appendChild(o);r=this.createPanel();r.style.paddingBottom="30px";t=document.createElement("div");t.style.position="absolute";t.style.width="70px";t.style.marginTop="0px";t.style.fontWeight="bold";mxUtils.write(t,"Start");r.appendChild(t);h=this.addUnitInput(r,"pt",84,44,function(){b.apply(this,arguments)});c=this.addUnitInput(r,"pt",20,44,function(){k.apply(this,arguments)});mxUtils.br(r);this.addLabel(r,mxResources.get("left"),84);this.addLabel(r,mxResources.get("top"),20);n.appendChild(r);this.addKeyHandler(h,f);this.addKeyHandler(c,f);u=this.createPanel();u.style.paddingBottom="30px";t=document.createElement("div");t.style.position="absolute";t.style.width="70px";t.style.marginTop="0px";t.style.fontWeight="bold";mxUtils.write(t,"End");u.appendChild(t);l=this.addUnitInput(u,"pt",84,44,function(){p.apply(this,arguments)});a=this.addUnitInput(u,"pt",20,44,function(){w.apply(this,arguments)});mxUtils.br(u);this.addLabel(u,mxResources.get("left"),84);this.addLabel(u,mxResources.get("top"),20);n.appendChild(u);this.addKeyHandler(l,f);this.addKeyHandler(a,f);f=mxUtils.bind(this,function(n,t,f){var y,p,v;s=this.format.getSelectionState();y=i.getSelectionCell();s.style.shape=="link"||s.style.shape=="flexArrow"?(o.style.display="",(f||document.activeElement!=e)&&(p=mxUtils.getValue(s.style,"width",mxCellRenderer.defaultShapes.flexArrow.prototype.defaultWidth),e.value=p+" pt")):o.style.display="none";i.getSelectionCount()==1&&i.model.isEdge(y)?(v=i.model.getGeometry(y),v.sourcePoint!=null&&i.model.getTerminal(y,!0)==null?(h.value=v.sourcePoint.x,c.value=v.sourcePoint.y):r.style.display="none",v.targetPoint!=null&&i.model.getTerminal(y,!1)==null?(l.value=v.targetPoint.x,a.value=v.targetPoint.y):u.style.display="none"):(r.style.display="none",u.style.display="none")});b=this.addEdgeGeometryHandler(h,function(n,t){n.sourcePoint.x=t});k=this.addEdgeGeometryHandler(c,function(n,t){n.sourcePoint.y=t});p=this.addEdgeGeometryHandler(l,function(n,t){n.targetPoint.x=t});w=this.addEdgeGeometryHandler(a,function(n,t){n.targetPoint.y=t});i.getModel().addListener(mxEvent.CHANGE,f);this.listeners.push({destroy:function(){i.getModel().removeListener(f)}});f()};TransferFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(TransferFormatPanel,BaseFormatPanel);TransferFormatPanel.prototype.init=function(){this.addTransfer(this.container)};TransferFormatPanel.prototype.addTransfer=function(n){function v(){var n=parseInt(o.value);n=Math.min(10,Math.max(1,isNaN(n)?1:n));o.value=n;t.setAttribute("priority",n)}var b=this.editorUi,k=b.editor,u=k.graph,l=this.createPanel(),h,e,s,c,i,a,r,f,w,v,o;this.createLabel(l,"流转描述");var t=u.getSelectionCell(),d=t.getAttribute("condition")||"",y=t.getAttribute("conditionDesc")||"",p=t.getAttribute("label");return this.createTextbox(l,p,p,function(n){t.setAttribute("label",n);u.getModel().beginUpdate();try{var i=new mxCellAttributeChange(t,"label",n);u.getModel().execute(i);u.updateCellSize(t)}finally{u.getModel().endUpdate()}}),this.container.appendChild(l),h=this.createPanel(),e=document.createElement("div"),e.style.marginLeft="0px",e.style.paddingTop="4px",e.style.paddingBottom="4px",e.style.fontWeight="normal",s=mxUtils.button("流转条件设置",function(){var n=u.billTable||"";if(n===""){mxUtils.alert("请在流程图那里设置业务单据");return}layer.open({type:2,title:"流转条件设置",shadeClose:!0,shade:.8,area:["800px","600px"],content:TRANSITION_URL+"?billTable="+encodeURIComponent(n),btn:["确定","关闭"],success:function(n){var t=window[n.find("iframe")[0].name],i=t.setTransition(y)},yes:function(n,r){var o=window[r.find("iframe")[0].name],f=o.getTransition(),e;if(f){while(i.hasChildNodes())i.removeChild(i.firstChild);createTransitionTags(i,f,function(){t.setAttribute("condition","")});t.setAttribute("condition",f.value);t.setAttribute("conditionDesc",f.text);u.getModel().beginUpdate();try{e=new mxCellAttributeChange(t,"label",f.desc);u.getModel().execute(e);u.updateCellSize(t)}finally{u.getModel().endUpdate()}}layer.close(n)}})}),s.setAttribute("title","设置流转条件"),s.style.width="205px",s.style.marginRight="2px",e.appendChild(s),h.appendChild(e),c=document.createElement("div"),c.style.display="inline-block !important",i=document.createElement("div"),i.style.display="block",i.style.width="180px",i.style.padding="4px 6px",i.style.color="#777777",i.style.verticalAlign="middle",i.style.backgroundColor="#FFF",i.style.border="1px solid #d5d5d5",c.appendChild(i),createTransitionTags(i,y,function(){t.setAttribute("condition","")}),h.appendChild(c),n.appendChild(h),a=this.createPanel(),r=document.createElement("div"),r.style.fontWeight="normal",r.style.position="relative",r.style.paddingLeft="16px",r.style.marginBottom="2px",r.style.marginTop="6px",r.style.borderWidth="0px",r.style.paddingBottom="18px",a.appendChild(r),f=document.createElement("div"),f.style.position="absolute",f.style.marginLeft="3px",f.style.marginBottom="12px",f.style.marginTop="1px",f.style.fontWeight="normal",f.style.width="120px",mxUtils.write(f,"优先级"),r.appendChild(f),w=t.getAttribute("priority")||1,o=this.addUnitInput(r,"",20,41,function(){v.apply(this,arguments)}),mxEvent.addListener(o,"blur",v),mxEvent.addListener(o,"change",v),o.value=w,n.appendChild(a),n};StartFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(StartFormatPanel,BaseFormatPanel);StartFormatPanel.prototype.init=function(){var r=this.editorUi,u=r.editor,f=u.graph,e=f.getSelectionCell(),t=e.getAttribute("nodeName")||"流程开始",n=this.createPanel(),i;this.createLabel(n,"节点名称");i=this.createTextbox(n,t,t,function(){});i.disabled=!0;this.container.appendChild(n)};EndFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(EndFormatPanel,BaseFormatPanel);EndFormatPanel.prototype.init=function(){var r=this.editorUi,u=r.editor,f=u.graph,e=f.getSelectionCell(),t=e.getAttribute("nodeName")||"流程结束",n=this.createPanel(),i;this.createLabel(n,"节点名称");i=this.createTextbox(n,t,t,function(){});i.disabled=!0;this.container.appendChild(n)};GatewayFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(GatewayFormatPanel,BaseFormatPanel);GatewayFormatPanel.prototype.init=function(){var h=this.editorUi,c=h.editor,l=c.graph,t=l.getSelectionCell(),v=t.getAttribute("nodeName")||"流程结束",a=t.getAttribute("gateway")||"split",i=t.getAttribute("direction"),s=this.createPanel(),n,o,r,u,f,e;this.createLabel(s,"路由选择");n=document.createElement("select");n.style.marginTop="8px";n.style.width="202px";n.options.length=0;o=document.createElement("option");o.setAttribute("value","");mxUtils.write(o,"---请选择---");n.appendChild(o);a==="1"?(i||(i="1"),r=document.createElement("option"),r.setAttribute("value","1"),i=="1"&&(r.setAttribute("selected",!0),t.setAttribute("direction","1")),mxUtils.write(r,"或分支"),n.appendChild(r),u=document.createElement("option"),u.setAttribute("value","4"),i=="4"&&(u.setAttribute("selected",!0),t.setAttribute("direction","4")),mxUtils.write(u,"并行分支"),n.appendChild(u)):(i||(i="16"),f=document.createElement("option"),f.setAttribute("value","16"),i=="16"&&(f.setAttribute("selected",!0),t.setAttribute("direction","16")),mxUtils.write(f,"或合并"),n.appendChild(f),e=document.createElement("option"),e.setAttribute("value","64"),i=="64"&&(e.setAttribute("selected",!0),t.setAttribute("direction","64")),mxUtils.write(e,"并行合并"),n.appendChild(e));mxEvent.addListener(n,"change",function(){var i=n.value;t.setAttribute("direction",i)});s.appendChild(n);this.container.appendChild(s)};SubProcessFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(SubProcessFormatPanel,BaseFormatPanel);SubProcessFormatPanel.prototype.init=function(){var f=this.editorUi,e=f.editor,o=e.graph,i=o.getSelectionCell(),u=i.getAttribute("subProcess")||"",r=this.createPanel(),n,t;this.createLabel(r,"子流程");n=document.createElement("select");n.style.marginTop="8px";n.style.width="202px";n.options.length=0;t=document.createElement("option");t.setAttribute("value","");mxUtils.write(t,"---请选择---");n.appendChild(t);$.get(window.SUBPROCESS_URL,function(t){$.each(t,function(t,r){var f=document.createElement("option");f.setAttribute("value",r.Fid);u==r.Fid&&(f.setAttribute("selected",!0),i.setAttribute("subProcess",u));mxUtils.write(f,r.TemplateName);n.appendChild(f)})});mxEvent.addListener(n,"change",function(){var t=n.value;i.setAttribute("subProcess",t)});r.appendChild(n);this.container.appendChild(r)};SwimlaneFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(SwimlaneFormatPanel,BaseFormatPanel);SwimlaneFormatPanel.prototype.init=function(){var u=this.editorUi,f=u.editor,n=f.graph,t=n.getSelectionCell(),r=t.getAttribute("label")||"泳道",i=this.createPanel(),e;this.createLabel(i,"泳道名称");e=this.createTextbox(i,r,r,function(i){t.setAttribute("label",i);n.getModel().beginUpdate();try{var r=new mxCellAttributeChange(t,"label",i);n.getModel().execute(r)}finally{n.getModel().endUpdate()}});this.container.appendChild(i)};TaskFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(TaskFormatPanel,BaseFormatPanel);TaskFormatPanel.prototype.init=function(){var f=this.editorUi,e=f.editor,i=e.graph,n=i.getSelectionCell(),u=n.getAttribute("label")||"普通任务",t=this.createPanel(),r;this.createLabel(t,"节点名称");this.createTextbox(t,u,u,function(t){n.setAttribute("label",t);i.getModel().beginUpdate();try{var r=new mxCellAttributeChange(n,"label",t);i.getModel().execute(r)}finally{i.getModel().endUpdate()}});this.createLabel(t,"描述");r=n.getAttribute("nodeDesc")||"";this.createTextarea(t,r,r,function(t){n.setAttribute("nodeDesc",t)});this.container.appendChild(t);this.container.appendChild(this.addParamOption(this.createPanel()));this.container.appendChild(this.addApplierOption(this.createPanel()));this.container.appendChild(this.addMessageOption(this.createPanel()));this.container.appendChild(this.addMessageMethodOption(this.createPanel()))};TaskFormatPanel.prototype.addParamOption=function(n){var f=this.editorUi,e=f.editor,o=e.graph,i=o.getSelectionCell(),s=i.getAttribute("isAssign")||0,r=i.getAttribute("approverMethod")||"1",t,u;return n.appendChild(this.createTitle("参数设置")),n.appendChild(this.createOption("启用加签",function(){return parseInt(s)},function(n){i.setAttribute("isAssign",n)})),t=document.createElement("select"),t.style.marginTop="8px",t.style.marginBottom="8px",t.style.width="202px",t.options.length=0,u=[{v:"0",n:"顺序审批"},{v:"1",n:"任意人审批"}],$.each(u,function(n,u){var f=document.createElement("option");f.setAttribute("value",u.v);r==u.v&&(f.setAttribute("selected",!0),i.setAttribute("approverMethod",r));mxUtils.write(f,u.n);t.appendChild(f)}),mxEvent.addListener(t,"change",function(){var n=t.value;i.setAttribute("approverMethod",n)}),this.createLabel(n,"审批方式"),n.appendChild(t),n};CounterTaskFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(CounterTaskFormatPanel,BaseFormatPanel);CounterTaskFormatPanel.prototype.init=function(){var e=this.editorUi,o=e.editor,i=o.graph,n=i.getSelectionCell(),r=n.getAttribute("label")||"会签任务",t=this.createPanel(),u,f;t.appendChild(this.createTitle("基础设置"));this.createLabel(t,"节点名称");this.createTextbox(t,r,r,function(t){n.setAttribute("label",t);i.getModel().beginUpdate();try{var r=new mxCellAttributeChange(n,"label",t);i.getModel().execute(r)}finally{i.getModel().endUpdate()}});this.createLabel(t,"描述");u=n.getAttribute("nodeDesc")||"";this.createTextarea(t,u,"",function(t){n.setAttribute("nodeDesc",t)});this.container.appendChild(t);f=n.getAttribute("passRate")||100;this.container.appendChild(this.createRelativeOption("通过率",44,function(t){var i=parseInt(t.value);i=Math.min(100,Math.max(0,isNaN(i)?100:i));t.value=(i!=null?i:"100")+" %";n.setAttribute("passRate",i)},function(n){n.value=f+"%"}));this.container.appendChild(this.addApplierOption(this.createPanel()));this.container.appendChild(this.addMessageOption(this.createPanel()));this.container.appendChild(this.addMessageMethodOption(this.createPanel()))};BaseFormatPanel.prototype.addApplierOption=function(n){function y(){if(u=[],c)for(var n=0;n<c.length;n++){let t=c[n];if(t.nodeType==1){let n=t.getAttribute("pType"),r=t.getAttribute("pValue"),f=t.getAttribute("pName"),e=t.getAttribute("pColumn");n=="1"?(u.push({id:r,name:f,type:"1",colname:e}),l.push(t)):n=="2"?(u.push({id:r,name:f,type:"2",colname:e}),l.push(t)):n=="3"?(u.push({id:r,name:f,type:"3",colname:e}),l.push(t)):n=="4"&&(v=r,i=t)}}return u}var w=this.editorUi,b=w.editor,s=b.graph,k=mxUtils.createXmlDocument(),h=s.getSelectionCell(),f=h.value.getElementsByTagName("participants")[0],c=f.childNodes,u,v,l=[],i,p,r,e,o,t,a;return y(),p=h.getAttribute("isAppoint")||0,n.appendChild(this.createTitle("审批人设置")),n.appendChild(this.createOption("是否由上级手工指定",function(){return parseInt(p)},function(n){h.setAttribute("isAppoint",n)})),r=document.createElement("div"),r.style.marginLeft="0px",r.style.paddingTop="4px",r.style.paddingBottom="4px",r.style.fontWeight="normal",e=mxUtils.button("设置审批人",function(){var n=s.billTable||"";if(n===""){mxUtils.alert("请在流程图那里设置业务单据");return}layer.open({type:2,title:"审批人选择",shadeClose:!0,shade:.8,area:["800px","600px"],content:APPROVER_URL+"?billTable="+encodeURIComponent(n),btn:["确定","关闭"],success:function(n){var i=window[n.find("iframe")[0].name],t=y();t&&t.length>0&&i.addApprovers(t)},yes:function(n,i){for(var u=window[i.find("iframe")[0].name],r=u.getApprover();t.hasChildNodes();)t.removeChild(t.firstChild);createParticipantTags(t,r,function(n){participantsRefresh(f,n)});participantsRefresh(f,r);layer.close(n)}})}),e.setAttribute("title","设置审批人"),e.style.width="195px",e.style.marginRight="2px",r.appendChild(e),n.appendChild(r),o=document.createElement("div"),o.style.display="inline-block !important",t=document.createElement("div"),t.style.display="block",t.style.width="180px",t.style.padding="4px 6px",t.style.color="#777777",t.style.verticalAlign="middle",t.style.backgroundColor="#FFF",t.style.border="1px solid #d5d5d5",o.appendChild(t),createParticipantTags(t,u,function(n){participantsRefresh(f,n)}),n.appendChild(o),this.createLabel(n,"同其他节点审批人"),a=r.cloneNode(!1),this.createSelect(a,s,v,function(n){n!="-1"&&(i?i.setAttribute("pValue",n):(i=k.createElement("participant"),f.appendChild(i),i.setAttribute("pValue",n),i.setAttribute("pName","同其它节点"),i.setAttribute("pType","4"),i.setAttribute("pColumn","")))}),n.appendChild(a),n};BaseFormatPanel.prototype.addMessageOption=function(n){var r=this.editorUi,u=r.editor,f=u.graph,t=f.getSelectionCell(),e=t.getAttribute("noticeApprover")||1,i;return n.appendChild(this.createTitle("消息设置")),n.appendChild(this.createOption("通知处理人",function(){return parseInt(e)},function(n){t.setAttribute("noticeApprover",n)})),i=t.getAttribute("noticeApplicant")||0,n.appendChild(this.createOption("通知申请人",function(){return parseInt(i)},function(n){t.setAttribute("noticeApplicant",n)})),n};BaseFormatPanel.prototype.addMessageMethodOption=function(n){var r=this.editorUi,u=r.editor,f=u.graph,t=f.getSelectionCell(),e=t.getAttribute("isMail")||1,i;return n.appendChild(this.createTitle("通知方式")),n.appendChild(this.createOption("邮件",function(){return parseInt(e)},function(n){t.setAttribute("isMail",n)})),i=t.getAttribute("isMessage")||1,n.appendChild(this.createOption("站内信",function(){return parseInt(i)},function(n){t.setAttribute("isMessage",n)})),n};TimerTaskFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(TimerTaskFormatPanel,BaseFormatPanel);TimerTaskFormatPanel.prototype.init=function(){var f=this.editorUi,e=f.editor,i=e.graph,t=this.createPanel(),n,r,u;this.createLabel(t,"节点名称");n=i.getSelectionCell();r=n.getAttribute("label")||"";this.createTextbox(t,r,r,function(t){n.setAttribute("label",t);i.getModel().beginUpdate();try{var r=new mxCellAttributeChange(n,"label",t);i.getModel().execute(r)}finally{i.getModel().endUpdate()}});this.createLabel(t,"描述");u=n.getAttribute("nodeDesc")||"";this.createTextarea(t,u,u,function(t){n.setAttribute("nodeDesc",t)});this.container.appendChild(t);this.container.appendChild(this.addParamOption(this.createPanel()));this.container.appendChild(this.addApplierOption(this.createPanel()));this.container.appendChild(this.addMessageOption(this.createPanel()));this.container.appendChild(this.addMessageMethodOption(this.createPanel()))};TimerTaskFormatPanel.prototype.addParamOption=function(n){function u(n){var t=parseInt(r.value);t=Math.min(999,Math.max(1,isNaN(t)?1:t));r.value=t+" h";f.setAttribute("expiration",t);mxEvent.consume(n)}var e=this.editorUi,o=e.editor,s=o.graph,t=document.createElement("div"),i;t.style.fontWeight="normal";t.style.position="relative";t.style.paddingLeft="16px";t.style.marginBottom="2px";t.style.marginTop="6px";t.style.borderWidth="0px";t.style.paddingBottom="18px";i=document.createElement("div");i.style.position="absolute";i.style.marginLeft="3px";i.style.marginBottom="12px";i.style.marginTop="1px";i.style.fontWeight="normal";i.style.width="120px";mxUtils.write(i,"超期时间(小时)");t.appendChild(i);var f=s.getSelectionCell(),h=f.getAttribute("expiration"),r=this.addUnitInput(t,"h",20,41,function(){u.apply(this,arguments)});return mxEvent.addListener(r,"blur",u),mxEvent.addListener(r,"change",u),r.value=h+"h",n.appendChild(t),n};StyleFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(StyleFormatPanel,BaseFormatPanel);StyleFormatPanel.showPageView=!0;StyleFormatPanel.prototype.showBackgroundImageOption=!0;StyleFormatPanel.prototype.init=function(){var n=this.editorUi,t=n.editor,i=t.graph;this.container.appendChild(this.addView(this.createPanel()));i.isEnabled()&&this.container.appendChild(this.addPaperSize(this.createPanel()))};TaskBillFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(TaskBillFormatPanel,BaseFormatPanel);TaskBillFormatPanel.showPageView=!0;TaskBillFormatPanel.prototype.showBackgroundImageOption=!0;TaskBillFormatPanel.prototype.init=function(){var n=this.editorUi,t=n.editor,i=t.graph;this.container.appendChild(this.addBillTemplate(this.createPanel()));this.container.appendChild(this.addBillForm(this.createPanel()))};TaskBillFormatPanel.prototype.addBillTemplate=function(n){var f=this.editorUi,e=f.editor,i=e.graph;n.style.display=i.frmType=="FreeForm"?"inline-block":"none";var r=i.getSelectionCell(),u=r.getAttribute("billTemplate")||i.billTemplate,t=document.createElement("select");return t.style.marginBottom="8px",t.style.width="202px",t.options.length=0,$.each(billTemplates,function(n,i){var f=document.createElement("option");f.setAttribute("value",i.Fid);u==i.Fid&&(f.setAttribute("selected",!0),r.setAttribute("billTemplate",u));mxUtils.write(f,i.FFName);t.appendChild(f)}),mxEvent.addListener(t,"change",function(){var n=t.value;r.setAttribute("billTemplate",n)}),n.appendChild(this.createTitle("单据模板")),n.appendChild(t),n};TaskBillFormatPanel.prototype.addBillForm=function(n){function e(n,t){for(var i=0;i<n.length;i++)if(n[i].nodeType==1&&n[i].getAttribute("name")==t)return n[i];return null}var o=this.editorUi,s=o.editor,h=s.graph,f=mxUtils.createXmlDocument(),c=h.getSelectionCell(),i=c.value.getElementsByTagName("fields")[0],t,r,u;if(i&&(t=i.childNodes),n.appendChild(this.createTitle("字段权限")),r=document.createElement("table"),r.setAttribute("width","100%"),r.setAttribute("height","100%"),u=document.createElement("tbody"),columns&&columns.length>0)$.each(columns,function(n,r){function l(){var r="2",n;r=c.checked==!0?"0":s.checked==!0?"1":"2";t&&t.length>0?(n=e(t,a),n!=null?r==="2"?i.removeChild(n):n.setAttribute("property",r):r!=="2"&&(n=f.createElement("field"),n.setAttribute("name",a),n.setAttribute("property",r),i.appendChild(n))):r!=="2"&&(n=f.createElement("field"),n.setAttribute("name",a),n.setAttribute("property",r),i.appendChild(n))}var k,d;let g=document.createElement("tr"),w=document.createElement("td");w.style.verticalAlign="middle";let it=r.name,a=r.key;mxUtils.write(w,it);g.appendChild(w);u.appendChild(g);let nt=document.createElement("tr"),tt=document.createElement("td"),b="format-billform"+n,c=document.createElement("input");c.setAttribute("name",b);c.setAttribute("type","radio");c.setAttribute("value","0");let s=document.createElement("input");s.setAttribute("name",b);s.setAttribute("type","radio");s.setAttribute("value","1");let o=document.createElement("input");o.setAttribute("name",b);o.setAttribute("type","radio");o.setAttribute("value","2");t&&t.length>0?(k=e(t,a),k!=null?(d=k.getAttribute("property"),d==="0"?c.checked=!0:d==="1"?s.checked=!0:o.checked=!0):o.checked=!0):o.checked=!0;let h=document.createElement("div");h.style.marginLeft="4px";h.style.width="210px";h.style.height="24px";c.style.marginRight="6px";h.appendChild(c);let v=document.createElement("span");v.style.maxWidth="100px";mxUtils.write(v,"隐藏");h.appendChild(v);s.style.marginLeft="10px";s.style.marginRight="6px";h.appendChild(s);let y=document.createElement("span");y.style.width="100px";mxUtils.write(y,"编辑");h.appendChild(y);o.style.marginLeft="10px";o.style.marginRight="6px";h.appendChild(o);let p=document.createElement("span");p.style.width="100px";mxUtils.write(p,"只读");h.appendChild(p);mxEvent.addListener(v,"click",function(){c.checked=!0;l()});mxEvent.addListener(y,"click",function(){s.checked=!0;l()});mxEvent.addListener(p,"click",function(){o.checked=!0;l()});mxEvent.addListener(c,"change",l);mxEvent.addListener(s,"change",l);mxEvent.addListener(o,"change",l);tt.appendChild(h);nt.appendChild(tt);u.appendChild(nt)});else{let t=document.createElement("tr"),n=document.createElement("td");n.style.verticalAlign="middle";mxUtils.write(n,"请在流程图那里设置业务单据！");t.appendChild(n);u.appendChild(t)}return r.appendChild(u),n.appendChild(r),n};DiagramFormatPanel=function(n,t,i){BaseFormatPanel.call(this,n,t,i);this.init()};mxUtils.extend(DiagramFormatPanel,BaseFormatPanel);DiagramFormatPanel.showPageView=!0;DiagramFormatPanel.prototype.showBackgroundImageOption=!0;DiagramFormatPanel.prototype.init=function(){var n=this.editorUi,t=n.editor,i=t.graph;i.isEnabled()&&(this.container.appendChild(this.addDiagram(this.createPanel())),this.container.appendChild(this.addBillForm(this.createPanel())),this.container.appendChild(this.addDiagramMessage(this.createPanel())),this.container.appendChild(this.addDiagramMessageMethod(this.createPanel())))};DiagramFormatPanel.prototype.addDiagram=function(n){var t=this.editorUi,i=t.editor,r=i.graph;return n.appendChild(this.createTitle("基础设置")),this.addDiagramOption(n),n};DiagramFormatPanel.prototype.addDiagramMessage=function(n){var t=this.editorUi,i=t.editor,r=i.graph;return n.appendChild(this.createTitle("消息设置")),this.addDiagramMessageOption(n),n};DiagramFormatPanel.prototype.addDiagramMessageMethod=function(n){var t=this.editorUi,i=t.editor,r=i.graph;return n.appendChild(this.createTitle("通知方式")),this.addDiagramMessageMethodOption(n),n};DiagramFormatPanel.prototype.addBillForm=function(n){function g(){t.frmType=i.checked==!0?"Internal":"FreeForm"}function y(){i.checked==!0?(t.frmType="Internal",r.style.display="none"):(t.frmType="FreeForm",r.style.display="inline")}var nt=this.editorUi,tt=nt.editor,t=tt.graph,it=t.frmType||"Internal",d=t.billTable||"",rt=t.billTemplate||"",p,i,u,e,r,l,o,f,s,h,w,a,v,c,ut,k;n.appendChild(this.createTitle("业务单据"));p="format-billform";i=document.createElement("input");i.setAttribute("name",p);i.setAttribute("type","radio");i.setAttribute("value","Internal");u=document.createElement("input");u.setAttribute("name",p);u.setAttribute("type","radio");u.setAttribute("value","FreeForm");e=document.createElement("select");e.style.marginLeft="8px";e.style.width="142px";r=document.createElement("div");r.style.marginLeft="4px";r.style.width="210px";r.style.height="24px";l=document.createElement("span");l.style.maxWidth="100px";mxUtils.write(l,"单据模板");r.appendChild(l);r.appendChild(e);n.appendChild(r);it=="Internal"?(i.checked=!0,t.frmType="Internal",r.style.display="none"):(u.checked=!0,t.frmType="FreeForm",r.style.display="inline");o=document.createElement("select");o.style.marginBottom="8px";o.style.width="202px";f=document.createElement("div");f.style.marginLeft="4px";f.style.width="210px";f.style.height="24px";i.style.marginRight="6px";f.appendChild(i);s=document.createElement("span");s.style.maxWidth="100px";mxUtils.write(s,"系统表单");f.appendChild(s);u.style.marginLeft="10px";u.style.marginRight="6px";f.appendChild(u);h=document.createElement("span");h.style.width="100px";mxUtils.write(h,"自由表单");f.appendChild(h);w=billTables;let b=document.createElement("option");for(b.setAttribute("value",""),mxUtils.write(b,"--请选择--"),o.appendChild(b),a=0;a<w.length;a++)v=w[a],c=document.createElement("option"),c.setAttribute("value",v.key),d==v.key&&c.setAttribute("selected",!0),mxUtils.write(c,v.name),o.appendChild(c);return ut=!1,n.appendChild(o),mxUtils.br(n),n.appendChild(f),n.appendChild(r),k=function(){var r=t.billTable,u=o.value,i,f,n;if(t.billTable=u,$.get(window.FIELDLIST_URL+"/"+t.billTable,function(n){columns=[];$.each(n,function(n,t){if((t.isDefaultCol==1||t.colProperty==3)&&t.colName!=="EffectiveTime")return!0;columns.push({key:t.colName,name:t.colComment,property:2})})}),r!=""&&r!=u){i=t.getModel().cells;for(f in i){let r=i[f],t=r.getAttribute("nodeType");if(t&&(t=="1"||t=="2"||t=="3")&&(n=r.value.getElementsByTagName("fields")[0],n))while(n.hasChildNodes())n.removeChild(n.firstChild)}}$.get(window.BILLTEMPLATE_URL,{tableName:t.billTable},function(n){billTemplates=n;n.length>0&&t.billTemplate===""&&(t.billTemplate=n[0].Fid);e.options.length=0;$.each(n,function(n,t){var i=document.createElement("option");i.setAttribute("value",t.Fid);rt==t.Fid&&i.setAttribute("selected",!0);mxUtils.write(i,t.FFName);e.appendChild(i)})})},mxEvent.addListener(s,"click",function(){i.checked=!0;y()}),mxEvent.addListener(h,"click",function(){u.checked=!0;y()}),mxEvent.addListener(i,"click",function(){y()}),mxEvent.addListener(u,"click",function(){y()}),mxEvent.addListener(i,"change",g),mxEvent.addListener(u,"change",g),mxEvent.addListener(o,"change",function(n){k(n,!0)}),mxEvent.addListener(e,"change",function(){var n=e.value;t.billTemplate=n}),d!==""&&k(),n};StyleFormatPanel.prototype.addView=function(n){var t=this.editorUi,r=t.editor,i=r.graph;return n.appendChild(this.createTitle(mxResources.get("view"))),this.addGridOption(n),i.isEnabled()&&DiagramFormatPanel.showPageView&&n.appendChild(this.createOption(mxResources.get("pageView"),function(){return i.pageVisible},function(){t.actions.get("pageView").funct()},{install:function(n){this.listener=function(){n(i.pageVisible)};t.addListener("pageViewChanged",this.listener)},destroy:function(){t.removeListener(this.listener)}})),n};DiagramFormatPanel.prototype.addOptions=function(n){var t=this.editorUi,r=t.editor,i=r.graph;return n.appendChild(this.createTitle(mxResources.get("options"))),i.isEnabled()&&(n.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return i.connectionArrowsEnabled},function(){t.actions.get("connectionArrows").funct()},{install:function(n){this.listener=function(){n(i.connectionArrowsEnabled)};t.addListener("connectionArrowsChanged",this.listener)},destroy:function(){t.removeListener(this.listener)}})),n.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return i.connectionHandler.isEnabled()},function(){t.actions.get("connectionPoints").funct()},{install:function(n){this.listener=function(){n(i.connectionHandler.isEnabled())};t.addListener("connectionPointsChanged",this.listener)},destroy:function(){t.removeListener(this.listener)}})),n.appendChild(this.createOption(mxResources.get("guides"),function(){return i.graphHandler.guidesEnabled},function(){t.actions.get("guides").funct()},{install:function(n){this.listener=function(){n(i.graphHandler.guidesEnabled)};t.addListener("guidesEnabledChanged",this.listener)},destroy:function(){t.removeListener(this.listener)}}))),n};DiagramFormatPanel.prototype.addDiagramOption=function(n){var r=this.editorUi,t=r.editor.graph,u=t.wfDiagramUid||"",f=t.wfDiagramName||"",e=t.wfDesc||"",i;this.createLabel(n,"流程UID");i=this.createTextbox(n,"流程UID",u,function(n){t.wfDiagramUid=n});i.disabled=!0;this.createLabel(n,"流程名称");this.createTextbox(n,"流程名称",f,function(n){t.wfDiagramName=n});this.createLabel(n,"描述");this.createTextarea(n,"描述",e,function(n){t.wfDesc=n})};DiagramFormatPanel.prototype.addDiagramMessageOption=function(n){var i=this.editorUi,t=i.editor.graph;t.isEnabled()&&(n.appendChild(this.createOption("结果反馈给申请人",function(){return parseInt(t.wfResultNotice)},function(n){t.wfResultNotice=n})),n.appendChild(this.createOption("流程中断，通知申请人和处理人",function(){return parseInt(t.wfSuspendNotice)},function(n){t.wfSuspendNotice=n})))};DiagramFormatPanel.prototype.addDiagramMessageMethodOption=function(n){var i=this.editorUi,t=i.editor.graph;t.isEnabled()&&(n.appendChild(this.createOption("邮件",function(){return parseInt(t.wfMail)},function(n){t.wfMail=n})),n.appendChild(this.createOption("站内信",function(){return parseInt(t.wfMessage)},function(n){t.wfMessage=n})))};StyleFormatPanel.prototype.addGridOption=function(n){function e(n){var r=parseInt(t.value);r=Math.max(1,isNaN(r)?10:r);r!=i.getGridSize()&&i.setGridSize(r);t.value=r+" pt";mxEvent.consume(n)}var u=this.editorUi,i=u.editor.graph,t=document.createElement("input"),r,f;t.style.position="absolute";t.style.textAlign="right";t.style.width="38px";t.value=i.getGridSize()+" pt";r=this.createStepper(t,e);t.style.display=i.isGridEnabled()?"":"none";r.style.display=t.style.display;mxEvent.addListener(t,"keydown",function(n){n.keyCode==13?(i.container.focus(),mxEvent.consume(n)):n.keyCode==27&&(t.value=i.getGridSize(),i.container.focus(),mxEvent.consume(n))});mxEvent.addListener(t,"blur",e);mxEvent.addListener(t,"change",e);mxClient.IS_SVG?(t.style.marginTop="-2px",t.style.right="84px",r.style.marginTop="-16px",r.style.right="72px",f=this.createColorOption(mxResources.get("grid"),function(){var n=i.view.gridColor;return i.isGridEnabled()?n:null},function(n){n==mxConstants.NONE?(i.setGridEnabled(!1),u.fireEvent(new mxEventObject("gridEnabledChanged"))):(i.setGridEnabled(!0),u.setGridColor(n));t.style.display=i.isGridEnabled()?"":"none";r.style.display=t.style.display},"#e0e0e0",{install:function(n){this.listener=function(){n(i.isGridEnabled()?i.view.gridColor:null)};u.addListener("gridColorChanged",this.listener);u.addListener("gridEnabledChanged",this.listener)},destroy:function(){u.removeListener(this.listener)}}),f.appendChild(t),f.appendChild(r),n.appendChild(f)):(t.style.marginTop="2px",t.style.right="32px",r.style.marginTop="2px",r.style.right="20px",n.appendChild(t),n.appendChild(r),n.appendChild(this.createOption(mxResources.get("grid"),function(){return i.isGridEnabled()},function(n){i.setGridEnabled(n);i.isGridEnabled()&&(i.view.gridColor="#e0e0e0");u.fireEvent(new mxEventObject("gridEnabledChanged"))},{install:function(n){this.listener=function(){t.style.display=i.isGridEnabled()?"":"none";r.style.display=t.style.display;n(i.isGridEnabled())};u.addListener("gridEnabledChanged",this.listener)},destroy:function(){u.removeListener(this.listener)}})))};DiagramFormatPanel.prototype.addDocumentProperties=function(n){var t=this.editorUi,i=t.editor,r=i.graph;return n.appendChild(this.createTitle(mxResources.get("options"))),n};StyleFormatPanel.prototype.addPaperSize=function(n){var u=this.editorUi,f=u.editor,t=f.graph,i,r;return n.appendChild(this.createTitle(mxResources.get("paperSize"))),i=PageSetupDialog.addPageFormatPanel(n,"formatpanel",t.pageFormat,function(n){if(t.pageFormat==null||t.pageFormat.width!=n.width||t.pageFormat.height!=n.height){var i=new ChangePageSetup(u,null,null,n);i.ignoreColor=!0;i.ignoreImage=!0;t.model.execute(i)}}),this.addKeyHandler(i.widthInput,function(){i.set(t.pageFormat)}),this.addKeyHandler(i.heightInput,function(){i.set(t.pageFormat)}),r=function(){i.set(t.pageFormat)},u.addListener("pageFormatChanged",r),this.listeners.push({destroy:function(){u.removeListener(r)}}),t.getModel().addListener(mxEvent.CHANGE,r),this.listeners.push({destroy:function(){t.getModel().removeListener(r)}}),n};DiagramFormatPanel.prototype.addStyleOps=function(n){var t=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(){this.editorUi.actions.get("editData").funct()}));return t.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),t.style.width="202px",t.style.marginBottom="2px",n.appendChild(t),mxUtils.br(n),t=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(){this.editorUi.actions.get("clearDefaultStyle").funct()})),t.setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")"),t.style.width="202px",n.appendChild(t),n};DiagramFormatPanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments);this.gridEnabledListener&&(this.editorUi.removeListener(this.gridEnabledListener),this.gridEnabledListener=null)},function(){function l(){mxCylinder.call(this)}function ct(){mxActor.call(this)}function lt(){mxCylinder.call(this)}function dt(){mxCylinder.call(this)}function k(){mxCylinder.call(this)}function gt(){mxActor.call(this)}function r(){mxCylinder.call(this)}function d(){mxActor.call(this)}function a(){mxActor.call(this)}function v(){mxActor.call(this)}function g(){mxActor.call(this)}function y(){mxActor.call(this)}function at(){mxActor.call(this)}function pi(){mxActor.call(this)}function t(n,i){this.canvas=n;this.canvas.setLineJoin("round");this.canvas.setLineCap("round");this.defaultVariation=i;this.originalLineTo=this.canvas.lineTo;this.canvas.lineTo=mxUtils.bind(this,t.prototype.lineTo);this.originalMoveTo=this.canvas.moveTo;this.canvas.moveTo=mxUtils.bind(this,t.prototype.moveTo);this.originalClose=this.canvas.close;this.canvas.close=mxUtils.bind(this,t.prototype.close);this.originalQuadTo=this.canvas.quadTo;this.canvas.quadTo=mxUtils.bind(this,t.prototype.quadTo);this.originalCurveTo=this.canvas.curveTo;this.canvas.curveTo=mxUtils.bind(this,t.prototype.curveTo);this.originalArcTo=this.canvas.arcTo;this.canvas.arcTo=mxUtils.bind(this,t.prototype.arcTo)}function p(){mxRectangleShape.call(this)}function ni(){mxRectangleShape.call(this)}function n(){mxActor.call(this)}function f(){mxActor.call(this)}function nt(){mxActor.call(this)}function vt(){mxRectangleShape.call(this)}function yt(){mxRectangleShape.call(this)}function bi(){mxCylinder.call(this)}function ti(){mxShape.call(this)}function ii(){mxShape.call(this)}function ki(){mxEllipse.call(this)}function di(){mxShape.call(this)}function pt(){mxShape.call(this)}function u(){mxRectangleShape.call(this)}function i(){mxShape.call(this)}function wt(){mxShape.call(this)}function bt(){mxShape.call(this)}function tt(){mxCylinder.call(this)}function it(){mxDoubleEllipse.call(this)}function gi(){it.call(this)}function rt(){mxArrowConnector.call(this);this.spacing=0}function w(){mxArrowConnector.call(this);this.spacing=0}function ut(){mxActor.call(this)}function o(){mxRectangleShape.call(this)}function h(){mxActor.call(this)}function ri(){mxActor.call(this)}function c(){mxActor.call(this)}function e(){mxActor.call(this)}function ui(){mxActor.call(this)}function ft(){mxActor.call(this)}function fi(){mxActor.call(this)}function ei(){mxActor.call(this)}function et(){mxActor.call(this)}function ot(){mxActor.call(this)}function oi(){mxEllipse.call(this)}function si(){mxEllipse.call(this)}function hi(){mxEllipse.call(this)}function nr(){mxRhombus.call(this)}function tr(){mxEllipse.call(this)}function ir(){mxEllipse.call(this)}function rr(){mxEllipse.call(this)}function ci(){mxEllipse.call(this)}function li(){mxActor.call(this)}function st(){mxActor.call(this)}function ht(){mxActor.call(this)}function b(){mxConnector.call(this)}function sr(n,t,i,r,u,f,e,o,s,h){var l=e/2,e=e+s,c=r.clone();return r.x-=u*(2*e+s),r.y-=f*(2*e+s),u=u*(e+s),f=f*(e+s),function(){n.ellipse(c.x-u-e,c.y-f-e,2*e,2*e);h?n.fillAndStroke():n.stroke()}}function ar(n){return n=n!=null?n:2,function(t,i,r,u,f,e,o,s,h){f=f*(o+h);e=e*(o+h);var c=u.clone();return function(){t.begin();t.moveTo(c.x,c.y);s?t.lineTo(c.x-f-e/n,c.y-e+f/n):t.lineTo(c.x+e/n-f,c.y-e-f/n);t.stroke()}}}var kt,s,ur,fr,er,or,wi,ai,lr;if(mxUtils.extend(l,mxCylinder),l.prototype.size=20,l.prototype.redrawPath=function(n,t,i,r,u,f){var e=Math.max(0,Math.min(r,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));f?(n.moveTo(e,u),n.lineTo(e,e),n.lineTo(0,0),n.moveTo(e,e),n.lineTo(r,e),n.end()):(n.moveTo(0,0),n.lineTo(r-e,0),n.lineTo(r,e),n.lineTo(r,u),n.lineTo(e,u),n.lineTo(0,u-e),n.lineTo(0,0),n.close(),n.end())},l.prototype.getLabelMargins=function(){if(mxUtils.getValue(this.style,"boundedLbl",!1)){var n=parseFloat(mxUtils.getValue(this.style,"size",this.size))*this.scale;return new mxRectangle(n,n,0,0)}return null},mxCellRenderer.registerShape("cube",l),kt=Math.tan(mxUtils.toRadians(30)),s=(.5-kt)/2,mxUtils.extend(ct,mxActor),ct.prototype.size=20,ct.prototype.redrawPath=function(n,t,i,r,u){var f=Math.min(r,u/kt);n.translate((r-f)/2,(u-f)/2+f/4);n.moveTo(0,.25*f);n.lineTo(.5*f,f*s);n.lineTo(f,.25*f);n.lineTo(.5*f,(.5-s)*f);n.lineTo(0,.25*f);n.close();n.end()},mxCellRenderer.registerShape("isoRectangle",ct),mxUtils.extend(lt,mxCylinder),lt.prototype.size=20,lt.prototype.redrawPath=function(n,t,i,r,u,f){var e=Math.min(r,u/(.5+kt));f?(n.moveTo(0,.25*e),n.lineTo(.5*e,(.5-s)*e),n.lineTo(e,.25*e),n.moveTo(.5*e,(.5-s)*e),n.lineTo(.5*e,(1-s)*e),n.end()):(n.translate((r-e)/2,(u-e)/2),n.moveTo(0,.25*e),n.lineTo(.5*e,e*s),n.lineTo(e,.25*e),n.lineTo(e,.75*e),n.lineTo(.5*e,(1-s)*e),n.lineTo(0,.75*e),n.close(),n.end())},mxCellRenderer.registerShape("isoCube",lt),mxUtils.extend(dt,mxCylinder),dt.prototype.redrawPath=function(n,t,i,r,u,f){var e=Math.min(u/2,Math.round(u/8)+this.strokewidth-1);(f&&this.fill!=null||!f&&this.fill==null)&&(n.moveTo(0,e),n.curveTo(0,2*e,r,2*e,r,e),f||(n.stroke(),n.begin()),n.translate(0,e/2),n.moveTo(0,e),n.curveTo(0,2*e,r,2*e,r,e),f||(n.stroke(),n.begin()),n.translate(0,e/2),n.moveTo(0,e),n.curveTo(0,2*e,r,2*e,r,e),f||(n.stroke(),n.begin()),n.translate(0,-e));f||(n.moveTo(0,e),n.curveTo(0,-e/3,r,-e/3,r,e),n.lineTo(r,u-e),n.curveTo(r,u+e/3,0,u+e/3,0,u-e),n.close())},dt.prototype.getLabelMargins=function(n){return new mxRectangle(0,2.5*Math.min(n.height/2,Math.round(n.height/8)+this.strokewidth-1)*this.scale,0,0)},mxCellRenderer.registerShape("datastore",dt),mxUtils.extend(k,mxCylinder),k.prototype.size=30,k.prototype.redrawPath=function(n,t,i,r,u,f){var e=Math.max(0,Math.min(r,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))));f?(n.moveTo(r-e,0),n.lineTo(r-e,e),n.lineTo(r,e),n.end()):(n.moveTo(0,0),n.lineTo(r-e,0),n.lineTo(r,e),n.lineTo(r,u),n.lineTo(0,u),n.lineTo(0,0),n.close(),n.end())},mxCellRenderer.registerShape("note",k),mxUtils.extend(gt,mxActor),gt.prototype.redrawPath=function(n,t,i,r,u){var f=.5;n.moveTo(0,0);n.quadTo(r/2,u*f,r,0);n.quadTo(r*(1-f),u/2,r,u);n.quadTo(r/2,u*(1-f),0,u);n.quadTo(r*f,u/2,0,0);n.end()},mxCellRenderer.registerShape("switch",gt),mxUtils.extend(r,mxCylinder),r.prototype.tabWidth=60,r.prototype.tabHeight=20,r.prototype.tabPosition="right",r.prototype.redrawPath=function(n,t,i,r,u,f){var o=Math.max(0,Math.min(r,parseFloat(mxUtils.getValue(this.style,"tabWidth",this.tabWidth)))),e=Math.max(0,Math.min(u,parseFloat(mxUtils.getValue(this.style,"tabHeight",this.tabHeight)))),s=mxUtils.getValue(this.style,"tabPosition",this.tabPosition);f?(s=="left"?(n.moveTo(0,e),n.lineTo(o,e)):(n.moveTo(r-o,e),n.lineTo(r,e)),n.end()):(s=="left"?(n.moveTo(0,0),n.lineTo(o,0),n.lineTo(o,e),n.lineTo(r,e)):(n.moveTo(0,e),n.lineTo(r-o,e),n.lineTo(r-o,0),n.lineTo(r,0)),n.lineTo(r,u),n.lineTo(0,u),n.lineTo(0,e),n.close(),n.end())},mxCellRenderer.registerShape("folder",r),mxUtils.extend(d,mxActor),d.prototype.size=30,d.prototype.redrawPath=function(n,t,i,r,u){var f=Math.max(0,Math.min(r,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size))))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(f,0),new mxPoint(r,0),new mxPoint(r,u),new mxPoint(0,u),new mxPoint(0,f)],this.isRounded,e,!0);n.end()},mxCellRenderer.registerShape("card",d),mxUtils.extend(a,mxActor),a.prototype.size=.4,a.prototype.redrawPath=function(n,t,i,r,u){var f=u*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=1.4;n.moveTo(0,f/2);n.quadTo(r/4,f*e,r/2,f/2);n.quadTo(r*3/4,f*(1-e),r,f/2);n.lineTo(r,u-f/2);n.quadTo(r*3/4,u-f*e,r/2,u-f/2);n.quadTo(r/4,u-f*(1-e),0,u-f/2);n.lineTo(0,f/2);n.close();n.end()},a.prototype.getLabelBounds=function(n){var r,u;if(mxUtils.getValue(this.style,"boundedLbl",!1)){var f=mxUtils.getValue(this.style,"size",this.size),t=n.width,i=n.height;return this.direction==null||this.direction==mxConstants.DIRECTION_EAST||this.direction==mxConstants.DIRECTION_WEST?(r=i*f,new mxRectangle(n.x,n.y+r,t,i-2*r)):(u=t*f,new mxRectangle(n.x+u,n.y,t-2*u,i))}return n},mxCellRenderer.registerShape("tape",a),mxUtils.extend(v,mxActor),v.prototype.size=.3,v.prototype.getLabelMargins=function(n){return mxUtils.getValue(this.style,"boundedLbl",!1)?new mxRectangle(0,0,0,parseFloat(mxUtils.getValue(this.style,"size",this.size))*n.height):null},v.prototype.redrawPath=function(n,t,i,r,u){var f=u*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=1.4;n.moveTo(0,0);n.lineTo(r,0);n.lineTo(r,u-f/2);n.quadTo(r*3/4,u-f*e,r/2,u-f/2);n.quadTo(r/4,u-f*(1-e),0,u-f/2);n.lineTo(0,f/2);n.close();n.end()},mxCellRenderer.registerShape("document",v),mxCylinder.prototype.getLabelMargins=function(n){return mxUtils.getValue(this.style,"boundedLbl",!1)?new mxRectangle(0,Math.min(this.maxHeight*this.scale,n.height*.3),0,0):null},mxUtils.extend(g,mxActor),g.prototype.size=.2,g.prototype.redrawPath=function(n,t,i,r,u){var f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,u),new mxPoint(f,0),new mxPoint(r,0),new mxPoint(r-f,u)],this.isRounded,e,!0);n.end()},mxCellRenderer.registerShape("parallelogram",g),mxUtils.extend(y,mxActor),y.prototype.size=.2,y.prototype.redrawPath=function(n,t,i,r,u){var f=r*Math.max(0,Math.min(.5,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,u),new mxPoint(f,0),new mxPoint(r-f,0),new mxPoint(r,u)],this.isRounded,e,!0)},mxCellRenderer.registerShape("trapezoid",y),mxUtils.extend(at,mxActor),at.prototype.size=.5,at.prototype.redrawPath=function(n,t,i,r,u){n.setFillColor(null);var f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(r,0),new mxPoint(f,0),new mxPoint(f,u/2),new mxPoint(0,u/2),new mxPoint(f,u/2),new mxPoint(f,u),new mxPoint(r,u)],this.isRounded,e,!1);n.end()},mxCellRenderer.registerShape("curlyBracket",at),mxUtils.extend(pi,mxActor),pi.prototype.redrawPath=function(n,t,i,r,u){n.setStrokeWidth(1);n.setFillColor(this.stroke);var f=r/5;n.rect(0,0,f,u);n.fillAndStroke();n.rect(2*f,0,f,u);n.fillAndStroke();n.rect(4*f,0,f,u);n.fillAndStroke()},mxCellRenderer.registerShape("parallelMarker",pi),t.prototype.moveTo=function(n,t){this.originalMoveTo.apply(this.canvas,arguments);this.lastX=n;this.lastY=t;this.firstX=n;this.firstY=t},t.prototype.close=function(){this.firstX!=null&&this.firstY!=null&&(this.lineTo(this.firstX,this.firstY),this.originalClose.apply(this.canvas,arguments));this.originalClose.apply(this.canvas,arguments)},t.prototype.quadTo=function(n,t,i,r){this.originalQuadTo.apply(this.canvas,arguments);this.lastX=i;this.lastY=r},t.prototype.curveTo=function(n,t,i,r,u,f){this.originalCurveTo.apply(this.canvas,arguments);this.lastX=u;this.lastY=f},t.prototype.arcTo=function(n,t,i,r,u,f,e){this.originalArcTo.apply(this.canvas,arguments);this.lastX=f;this.lastY=e},t.prototype.lineTo=function(n,t){var i,o,r;if(this.lastX!=null&&this.lastY!=null){var u=Math.abs(n-this.lastX),f=Math.abs(t-this.lastY),e=Math.sqrt(u*u+f*f);if(e<2){this.originalLineTo.apply(this.canvas,arguments);this.lastX=n;this.lastY=t;return}i=Math.round(e/10);o=this.defaultVariation;i<5&&(i=5,o/=3);function p(n){return typeof n=="number"?n?n<0?-1:1:n===n?0:NaN:NaN}var h=p(n-this.lastX)*u/i,c=p(t-this.lastY)*f/i,l=u/e,a=f/e;for(r=0;r<i;r++){var v=h*r+this.lastX,y=c*r+this.lastY,s=(Math.random()-.5)*o;this.originalLineTo.call(this.canvas,v-s*a,y-s*l)}this.originalLineTo.call(this.canvas,n,t);this.lastX=n;this.lastY=t}else this.originalLineTo.apply(this.canvas,arguments),this.lastX=n,this.lastY=t},t.prototype.destroy=function(){this.canvas.lineTo=this.originalLineTo;this.canvas.moveTo=this.originalMoveTo;this.canvas.close=this.originalClose;this.canvas.quadTo=this.originalQuadTo;this.canvas.curveTo=this.originalCurveTo;this.canvas.arcTo=this.originalArcTo},ur=mxShape.prototype.paint,mxShape.prototype.defaultJiggle=1.5,mxShape.prototype.paint=function(n){this.style!=null&&mxUtils.getValue(this.style,"comic","0")!="0"&&n.handHiggle==null&&(n.handJiggle=new t(n,mxUtils.getValue(this.style,"jiggle",this.defaultJiggle)));ur.apply(this,arguments);n.handJiggle!=null&&(n.handJiggle.destroy(),delete n.handJiggle)},mxRhombus.prototype.defaultJiggle=2,fr=mxRectangleShape.prototype.isHtmlAllowed,mxRectangleShape.prototype.isHtmlAllowed=function(){return(this.style==null||mxUtils.getValue(this.style,"comic","0")=="0")&&fr.apply(this,arguments)},er=mxRectangleShape.prototype.paintBackground,mxRectangleShape.prototype.paintBackground=function(n,t,i,r,u){var e,f,o;n.handJiggle==null?er.apply(this,arguments):(e=!0,this.style!=null&&(e=mxUtils.getValue(this.style,mxConstants.STYLE_POINTER_EVENTS,"1")=="1"),(e||this.fill!=null&&this.fill!=mxConstants.NONE||this.stroke!=null&&this.stroke!=mxConstants.NONE)&&(e||this.fill!=null&&this.fill!=mxConstants.NONE||(n.pointerEvents=!1),n.begin(),this.isRounded?(f=0,mxUtils.getValue(this.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0)=="1"?f=Math.min(r/2,Math.min(u/2,mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2)):(o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,f=Math.min(r*o,u*o)),n.moveTo(t+f,i),n.lineTo(t+r-f,i),n.quadTo(t+r,i,t+r,i+f),n.lineTo(t+r,i+u-f),n.quadTo(t+r,i+u,t+r-f,i+u),n.lineTo(t+f,i+u),n.quadTo(t,i+u,t,i+u-f),n.lineTo(t,i+f),n.quadTo(t,i,t+f,i)):(n.moveTo(t,i),n.lineTo(t+r,i),n.lineTo(t+r,i+u),n.lineTo(t,i+u),n.lineTo(t,i)),n.close(),n.end(),n.fillAndStroke()))},or=mxRectangleShape.prototype.paintForeground,mxRectangleShape.prototype.paintForeground=function(n){n.handJiggle==null&&or.apply(this,arguments)},mxUtils.extend(p,mxRectangleShape),p.prototype.size=.1,p.prototype.isHtmlAllowed=function(){return!1},p.prototype.getLabelBounds=function(n){var u;if(mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,!0)==(this.direction==null||this.direction==mxConstants.DIRECTION_EAST||this.direction==mxConstants.DIRECTION_WEST)){var i=n.width,f=n.height,r=new mxRectangle(n.x,n.y,i,f),t=i*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));return this.isRounded&&(u=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,t=Math.max(t,Math.min(i*u,f*u))),r.x+=Math.round(t),r.width-=Math.round(2*t),r}return n},p.prototype.paintForeground=function(n,t,i,r,u){var f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e;this.isRounded&&(e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,f=Math.max(f,Math.min(r*e,u*e)));f=Math.round(f);n.begin();n.moveTo(t+f,i);n.lineTo(t+f,i+u);n.moveTo(t+r-f,i);n.lineTo(t+r-f,i+u);n.end();n.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxCellRenderer.registerShape("process",p),mxUtils.extend(ni,mxRectangleShape),ni.prototype.paintBackground=function(n,t,i,r,u){n.setFillColor(mxConstants.NONE);n.rect(t,i,r,u);n.fill()},ni.prototype.paintForeground=function(){},mxCellRenderer.registerShape("transparent",ni),mxUtils.extend(n,mxHexagon),n.prototype.size=30,n.prototype.position=.5,n.prototype.position2=.5,n.prototype.base=20,n.prototype.getLabelMargins=function(){return new mxRectangle(0,0,0,parseFloat(mxUtils.getValue(this.style,"size",this.size))*this.scale)},n.prototype.redrawPath=function(n,t,i,r,u){var o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2,f=Math.max(0,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"position",this.position)))),s=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"position2",this.position2)))),h=Math.max(0,Math.min(r,parseFloat(mxUtils.getValue(this.style,"base",this.base))));this.addPoints(n,[new mxPoint(0,0),new mxPoint(r,0),new mxPoint(r,u-f),new mxPoint(Math.min(r,e+h),u-f),new mxPoint(s,u),new mxPoint(Math.max(0,e),u-f),new mxPoint(0,u-f)],this.isRounded,o,!0,[4])},mxCellRenderer.registerShape("callout",n),mxUtils.extend(f,mxActor),f.prototype.size=.2,f.prototype.fixedSize=20,f.prototype.redrawPath=function(n,t,i,r,u){var e=mxUtils.getValue(this.style,"fixedSize","0")!="0",f=e?Math.max(0,Math.min(r,parseFloat(mxUtils.getValue(this.style,"size",this.fixedSize)))):r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,0),new mxPoint(r-f,0),new mxPoint(r,u/2),new mxPoint(r-f,u),new mxPoint(0,u),new mxPoint(f,u/2)],this.isRounded,o,!0);n.end()},mxCellRenderer.registerShape("step",f),mxUtils.extend(nt,mxHexagon),nt.prototype.size=.25,nt.prototype.redrawPath=function(n,t,i,r,u){var f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(f,0),new mxPoint(r-f,0),new mxPoint(r,.5*u),new mxPoint(r-f,u),new mxPoint(f,u),new mxPoint(0,.5*u)],this.isRounded,e,!0)},mxCellRenderer.registerShape("hexagon",nt),mxUtils.extend(vt,mxRectangleShape),vt.prototype.isHtmlAllowed=function(){return!1},vt.prototype.paintForeground=function(n,t,i,r,u){var f=Math.min(r/5,u/5)+1;n.begin();n.moveTo(t+r/2,i+f);n.lineTo(t+r/2,i+u-f);n.moveTo(t+f,i+u/2);n.lineTo(t+r-f,i+u/2);n.end();n.stroke();mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxCellRenderer.registerShape("plus",vt),wi=mxRhombus.prototype.paintVertexShape,mxRhombus.prototype.getLabelBounds=function(n){if(this.style.double==1){var t=(Math.max(2,this.strokewidth+1)*2+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0))*this.scale;return new mxRectangle(n.x+t,n.y+t,n.width-2*t,n.height-2*t)}return n},mxRhombus.prototype.paintVertexShape=function(n,t,i,r,u){if(wi.apply(this,arguments),!this.outline&&this.style.double==1){var f=Math.max(2,this.strokewidth+1)*2+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0);t+=f;i+=f;r-=2*f;u-=2*f;r>0&&u>0&&(n.setShadow(!1),wi.apply(this,[n,t,i,r,u]))}},mxUtils.extend(yt,mxRectangleShape),yt.prototype.isHtmlAllowed=function(){return!1},yt.prototype.getLabelBounds=function(n){if(this.style.double==1){var t=(Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0))*this.scale;return new mxRectangle(n.x+t,n.y+t,n.width-2*t,n.height-2*t)}return n},yt.prototype.paintForeground=function(n,t,i,r,u){var o,f,e,a,v,y,p;if(this.style!=null){this.outline||this.style.double!=1||(o=Math.max(2,this.strokewidth+1)+parseFloat(this.style[mxConstants.STYLE_MARGIN]||0),t+=o,i+=o,r-=2*o,u-=2*o,r>0&&u>0&&mxRectangleShape.prototype.paintBackground.apply(this,arguments));n.setDashed(!1);f=0;e=null;do{if(e=mxCellRenderer.defaultShapes[this.style["symbol"+f]],e!=null){var w=this.style["symbol"+f+"Align"],b=this.style["symbol"+f+"VerticalAlign"],h=this.style["symbol"+f+"Width"],c=this.style["symbol"+f+"Height"],s=this.style["symbol"+f+"Spacing"]||0,l=this.style["symbol"+f+"VSpacing"]||s,k=this.style["symbol"+f+"ArcSpacing"];k!=null&&(a=this.getArcSize(r+this.strokewidth,u+this.strokewidth)*k,s+=a,l+=a);v=t;y=i;v+=w==mxConstants.ALIGN_CENTER?(r-h)/2:w==mxConstants.ALIGN_RIGHT?r-h-s:s;y+=b==mxConstants.ALIGN_MIDDLE?(u-c)/2:b==mxConstants.ALIGN_BOTTOM?u-c-l:l;n.save();p=new e;p.style=this.style;e.prototype.paintVertexShape.call(p,n,v,y,h,c);n.restore()}f++}while(e!=null)}mxRectangleShape.prototype.paintForeground.apply(this,arguments)},mxCellRenderer.registerShape("ext",yt),mxUtils.extend(bi,mxCylinder),bi.prototype.redrawPath=function(n,t,i,r,u,f){f?(n.moveTo(0,0),n.lineTo(r/2,u/2),n.lineTo(r,0),n.end()):(n.moveTo(0,0),n.lineTo(r,0),n.lineTo(r,u),n.lineTo(0,u),n.close())},mxCellRenderer.registerShape("message",bi),mxUtils.extend(ti,mxShape),ti.prototype.paintBackground=function(n,t,i,r,u){n.translate(t,i);n.ellipse(r/4,0,r/2,u/4);n.fillAndStroke();n.begin();n.moveTo(r/2,u/4);n.lineTo(r/2,2*u/3);n.moveTo(r/2,u/3);n.lineTo(0,u/3);n.moveTo(r/2,u/3);n.lineTo(r,u/3);n.moveTo(r/2,2*u/3);n.lineTo(0,u);n.moveTo(r/2,2*u/3);n.lineTo(r,u);n.end();n.stroke()},mxCellRenderer.registerShape("umlActor",ti),mxUtils.extend(ii,mxShape),ii.prototype.getLabelMargins=function(n){return new mxRectangle(n.width/6,0,0,0)},ii.prototype.paintBackground=function(n,t,i,r,u){n.translate(t,i);n.begin();n.moveTo(0,u/4);n.lineTo(0,u*3/4);n.end();n.stroke();n.begin();n.moveTo(0,u/2);n.lineTo(r/6,u/2);n.end();n.stroke();n.ellipse(r/6,0,r*5/6,u);n.fillAndStroke()},mxCellRenderer.registerShape("umlBoundary",ii),mxUtils.extend(ki,mxEllipse),ki.prototype.paintVertexShape=function(n,t,i,r,u){mxEllipse.prototype.paintVertexShape.apply(this,arguments);n.begin();n.moveTo(t+r/8,i+u);n.lineTo(t+r*7/8,i+u);n.end();n.stroke()},mxCellRenderer.registerShape("umlEntity",ki),mxUtils.extend(di,mxShape),di.prototype.paintVertexShape=function(n,t,i,r,u){n.translate(t,i);n.begin();n.moveTo(r,0);n.lineTo(0,u);n.moveTo(0,0);n.lineTo(r,u);n.end();n.stroke()},mxCellRenderer.registerShape("umlDestroy",di),mxUtils.extend(pt,mxShape),pt.prototype.getLabelBounds=function(n){return new mxRectangle(n.x,n.y+n.height/8,n.width,n.height*7/8)},pt.prototype.paintBackground=function(n,t,i,r,u){n.translate(t,i);n.begin();n.moveTo(r*3/8,u/8*1.1);n.lineTo(r*5/8,0);n.end();n.stroke();n.ellipse(0,u/8,r,u*7/8);n.fillAndStroke()},pt.prototype.paintForeground=function(n,t,i,r,u){n.begin();n.moveTo(r*3/8,u/8*1.1);n.lineTo(r*5/8,u/4);n.end();n.stroke()},mxCellRenderer.registerShape("umlControl",pt),mxUtils.extend(u,mxRectangleShape),u.prototype.size=40,u.prototype.isHtmlAllowed=function(){return!1},u.prototype.getLabelBounds=function(n){var t=Math.max(0,Math.min(n.height,parseFloat(mxUtils.getValue(this.style,"size",this.size))*this.scale));return new mxRectangle(n.x,n.y,n.width,t)},u.prototype.paintBackground=function(n,t,i,r,f){var e=Math.max(0,Math.min(f,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),h=mxUtils.getValue(this.style,"participant"),o,s;h==null||this.state==null?mxRectangleShape.prototype.paintBackground.call(this,n,t,i,r,e):(o=this.state.view.graph.cellRenderer.getShape(h),o!=null&&o!=u&&(s=new o,s.apply(this.state),n.save(),s.paintVertexShape(n,t,i,r,e),n.restore()));e<f&&(n.setDashed(!0),n.begin(),n.moveTo(t+r/2,i+e),n.lineTo(t+r/2,i+f),n.end(),n.stroke())},u.prototype.paintForeground=function(n,t,i,r,u){var f=Math.max(0,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size))));mxRectangleShape.prototype.paintForeground.call(this,n,t,i,r,Math.min(u,f))},mxCellRenderer.registerShape("umlLifeline",u),mxUtils.extend(i,mxShape),i.prototype.width=60,i.prototype.height=30,i.prototype.corner=10,i.prototype.getLabelMargins=function(n){return new mxRectangle(0,0,n.width-parseFloat(mxUtils.getValue(this.style,"width",this.width)*this.scale),n.height-parseFloat(mxUtils.getValue(this.style,"height",this.height)*this.scale))},i.prototype.paintBackground=function(n,t,i,r,u){var f=this.corner,e=Math.min(r,Math.max(f,parseFloat(mxUtils.getValue(this.style,"width",this.width)))),o=Math.min(u,Math.max(f*1.5,parseFloat(mxUtils.getValue(this.style,"height",this.height)))),s=mxUtils.getValue(this.style,mxConstants.STYLE_SWIMLANE_FILLCOLOR,mxConstants.NONE),h;s!=mxConstants.NONE&&(n.setFillColor(s),n.rect(t,i,r,u),n.fill());this.fill!=null&&this.fill!=mxConstants.NONE&&this.gradient&&this.gradient!=mxConstants.NONE?(h=this.getGradientBounds(n,t,i,r,u),n.setGradient(this.fill,this.gradient,t,i,r,u,this.gradientDirection)):n.setFillColor(this.fill);n.begin();n.moveTo(t,i);n.lineTo(t+e,i);n.lineTo(t+e,i+Math.max(0,o-f*1.5));n.lineTo(t+Math.max(0,e-f),i+o);n.lineTo(t,i+o);n.close();n.fillAndStroke();n.begin();n.moveTo(t+e,i);n.lineTo(t+r,i);n.lineTo(t+r,i+u);n.lineTo(t,i+u);n.lineTo(t,i+o);n.stroke()},mxCellRenderer.registerShape("umlFrame",i),mxPerimeter.LifelinePerimeter=function(n,t,i){var f=u.prototype.size,r;return t!=null&&(f=mxUtils.getValue(t.style,"size",f)*t.view.scale),r=parseFloat(t.style[mxConstants.STYLE_STROKEWIDTH]||1)*t.view.scale/2-1,i.x<n.getCenterX()&&(r+=1,r*=-1),new mxPoint(n.getCenterX()+r,Math.min(n.y+n.height,Math.max(n.y+f,i.y)))},mxStyleRegistry.putValue("lifelinePerimeter",mxPerimeter.LifelinePerimeter),mxPerimeter.OrthogonalPerimeter=function(n,t,i,r){return r=!0,mxPerimeter.RectanglePerimeter.apply(this,arguments)},mxStyleRegistry.putValue("orthogonalPerimeter",mxPerimeter.OrthogonalPerimeter),mxPerimeter.BackbonePerimeter=function(n,t,i){var r=parseFloat(t.style[mxConstants.STYLE_STROKEWIDTH]||1)*t.view.scale/2-1;return t.style.backboneSize!=null&&(r+=parseFloat(t.style.backboneSize)*t.view.scale/2-1),t.style[mxConstants.STYLE_DIRECTION]=="south"||t.style[mxConstants.STYLE_DIRECTION]=="north"?(i.x<n.getCenterX()&&(r+=1,r*=-1),new mxPoint(n.getCenterX()+r,Math.min(n.y+n.height,Math.max(n.y,i.y)))):(i.y<n.getCenterY()&&(r+=1,r*=-1),new mxPoint(Math.min(n.x+n.width,Math.max(n.x,i.x)),n.getCenterY()+r))},mxStyleRegistry.putValue("backbonePerimeter",mxPerimeter.BackbonePerimeter),mxPerimeter.CalloutPerimeter=function(t,i,r,u){return mxPerimeter.RectanglePerimeter(mxUtils.getDirectedBounds(t,new mxRectangle(0,0,0,Math.max(0,Math.min(t.height,parseFloat(mxUtils.getValue(i.style,"size",n.prototype.size))*i.view.scale))),i.style),i,r,u)},mxStyleRegistry.putValue("calloutPerimeter",mxPerimeter.CalloutPerimeter),mxPerimeter.ParallelogramPerimeter=function(n,t,i,r){var s=g.prototype.size,l,h;t!=null&&(s=mxUtils.getValue(t.style,"size",s));var u=n.x,f=n.y,e=n.width,o=n.height,v=t!=null?mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST,y=v==mxConstants.DIRECTION_NORTH||v==mxConstants.DIRECTION_SOUTH,c;y?(l=o*Math.max(0,Math.min(1,s)),c=[new mxPoint(u,f),new mxPoint(u+e,f+l),new mxPoint(u+e,f+o),new mxPoint(u,f+o-l),new mxPoint(u,f)]):(h=e*Math.max(0,Math.min(1,s)),c=[new mxPoint(u+h,f),new mxPoint(u+e,f),new mxPoint(u+e-h,f+o),new mxPoint(u,f+o),new mxPoint(u+h,f)]);var p=n.getCenterX(),w=n.getCenterY(),a=new mxPoint(p,w);return r&&(i.x<u||i.x>u+e?a.y=i.y:a.x=i.x),mxUtils.getPerimeterPoint(c,a,i)},mxStyleRegistry.putValue("parallelogramPerimeter",mxPerimeter.ParallelogramPerimeter),mxPerimeter.TrapezoidPerimeter=function(n,t,i,r){var c=y.prototype.size,s,h;t!=null&&(c=mxUtils.getValue(t.style,"size",c));var u=n.x,f=n.y,e=n.width,o=n.height,a=t!=null?mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST,l;a==mxConstants.DIRECTION_EAST?(s=e*Math.max(0,Math.min(1,c)),l=[new mxPoint(u+s,f),new mxPoint(u+e-s,f),new mxPoint(u+e,f+o),new mxPoint(u,f+o),new mxPoint(u+s,f)]):a==mxConstants.DIRECTION_WEST?(s=e*Math.max(0,Math.min(1,c)),l=[new mxPoint(u,f),new mxPoint(u+e,f),new mxPoint(u+e-s,f+o),new mxPoint(u+s,f+o),new mxPoint(u,f)]):a==mxConstants.DIRECTION_NORTH?(h=o*Math.max(0,Math.min(1,c)),l=[new mxPoint(u,f+h),new mxPoint(u+e,f),new mxPoint(u+e,f+o),new mxPoint(u,f+o-h),new mxPoint(u,f+h)]):(h=o*Math.max(0,Math.min(1,c)),l=[new mxPoint(u,f),new mxPoint(u+e,f+h),new mxPoint(u+e,f+o-h),new mxPoint(u,f+o),new mxPoint(u,f)]);var p=n.getCenterX(),w=n.getCenterY(),v=new mxPoint(p,w);return r&&(i.x<u||i.x>u+e?v.y=i.y:v.x=i.x),mxUtils.getPerimeterPoint(l,v,i)},mxStyleRegistry.putValue("trapezoidPerimeter",mxPerimeter.TrapezoidPerimeter),mxPerimeter.StepPerimeter=function(n,t,i,r){var a=mxUtils.getValue(t.style,"fixedSize","0")!="0",h=a?f.prototype.fixedSize:f.prototype.size,c,l,w;t!=null&&(h=mxUtils.getValue(t.style,"size",h));var u=n.x,e=n.y,o=n.width,s=n.height,v=n.getCenterX(),y=n.getCenterY(),b=t!=null?mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST,p;return b==mxConstants.DIRECTION_EAST?(c=a?Math.max(0,Math.min(o,h)):o*Math.max(0,Math.min(1,h)),p=[new mxPoint(u,e),new mxPoint(u+o-c,e),new mxPoint(u+o,y),new mxPoint(u+o-c,e+s),new mxPoint(u,e+s),new mxPoint(u+c,y),new mxPoint(u,e)]):b==mxConstants.DIRECTION_WEST?(c=a?Math.max(0,Math.min(o,h)):o*Math.max(0,Math.min(1,h)),p=[new mxPoint(u+c,e),new mxPoint(u+o,e),new mxPoint(u+o-c,y),new mxPoint(u+o,e+s),new mxPoint(u+c,e+s),new mxPoint(u,y),new mxPoint(u+c,e)]):b==mxConstants.DIRECTION_NORTH?(l=a?Math.max(0,Math.min(s,h)):s*Math.max(0,Math.min(1,h)),p=[new mxPoint(u,e+l),new mxPoint(v,e),new mxPoint(u+o,e+l),new mxPoint(u+o,e+s),new mxPoint(v,e+s-l),new mxPoint(u,e+s),new mxPoint(u,e+l)]):(l=a?Math.max(0,Math.min(s,h)):s*Math.max(0,Math.min(1,h)),p=[new mxPoint(u,e),new mxPoint(v,e+l),new mxPoint(u+o,e),new mxPoint(u+o,e+s-l),new mxPoint(v,e+s),new mxPoint(u,e+s-l),new mxPoint(u,e)]),w=new mxPoint(v,y),r&&(i.x<u||i.x>u+o?w.y=i.y:w.x=i.x),mxUtils.getPerimeterPoint(p,w,i)},mxStyleRegistry.putValue("stepPerimeter",mxPerimeter.StepPerimeter),mxPerimeter.HexagonPerimeter2=function(n,t,i,r){var c=nt.prototype.size,h,s,a;t!=null&&(c=mxUtils.getValue(t.style,"size",c));var u=n.x,f=n.y,e=n.width,o=n.height,l=n.getCenterX(),v=n.getCenterY(),p=t!=null?mxUtils.getValue(t.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_EAST):mxConstants.DIRECTION_EAST,w=p==mxConstants.DIRECTION_NORTH||p==mxConstants.DIRECTION_SOUTH,y;return w?(h=o*Math.max(0,Math.min(1,c)),y=[new mxPoint(l,f),new mxPoint(u+e,f+h),new mxPoint(u+e,f+o-h),new mxPoint(l,f+o),new mxPoint(u,f+o-h),new mxPoint(u,f+h),new mxPoint(l,f)]):(s=e*Math.max(0,Math.min(1,c)),y=[new mxPoint(u+s,f),new mxPoint(u+e-s,f),new mxPoint(u+e,v),new mxPoint(u+e-s,f+o),new mxPoint(u+s,f+o),new mxPoint(u,v),new mxPoint(u+s,f)]),a=new mxPoint(l,v),r&&(i.x<u||i.x>u+e?a.y=i.y:a.x=i.x),mxUtils.getPerimeterPoint(y,a,i)},mxStyleRegistry.putValue("hexagonPerimeter2",mxPerimeter.HexagonPerimeter2),mxUtils.extend(wt,mxShape),wt.prototype.size=10,wt.prototype.paintBackground=function(n,t,i,r,u){var f=parseFloat(mxUtils.getValue(this.style,"size",this.size));n.translate(t,i);n.ellipse((r-f)/2,0,f,f);n.fillAndStroke();n.begin();n.moveTo(r/2,f);n.lineTo(r/2,u);n.end();n.stroke()},mxCellRenderer.registerShape("lollipop",wt),mxUtils.extend(bt,mxShape),bt.prototype.size=10,bt.prototype.inset=2,bt.prototype.paintBackground=function(n,t,i,r,u){var f=parseFloat(mxUtils.getValue(this.style,"size",this.size)),e=parseFloat(mxUtils.getValue(this.style,"inset",this.inset))+this.strokewidth;n.translate(t,i);n.begin();n.moveTo(r/2,f+e);n.lineTo(r/2,u);n.end();n.stroke();n.begin();n.moveTo((r-f)/2-e,f/2);n.quadTo((r-f)/2-e,f+e,r/2,f+e);n.quadTo((r+f)/2+e,f+e,(r+f)/2+e,f/2);n.end();n.stroke()},mxCellRenderer.registerShape("requires",bt),mxUtils.extend(tt,mxCylinder),tt.prototype.jettyWidth=32,tt.prototype.jettyHeight=12,tt.prototype.redrawPath=function(n,t,i,r,u,f){var l=parseFloat(mxUtils.getValue(this.style,"jettyWidth",this.jettyWidth)),o=parseFloat(mxUtils.getValue(this.style,"jettyHeight",this.jettyHeight)),e=l/2,c=e+l/2,s=.3*u-o/2,h=.7*u-o/2;f?(n.moveTo(e,s),n.lineTo(c,s),n.lineTo(c,s+o),n.lineTo(e,s+o),n.moveTo(e,h),n.lineTo(c,h),n.lineTo(c,h+o),n.lineTo(e,h+o),n.end()):(n.moveTo(e,0),n.lineTo(r,0),n.lineTo(r,u),n.lineTo(e,u),n.lineTo(e,h+o),n.lineTo(0,h+o),n.lineTo(0,h),n.lineTo(e,h),n.lineTo(e,s+o),n.lineTo(0,s+o),n.lineTo(0,s),n.lineTo(e,s),n.close(),n.end())},mxCellRenderer.registerShape("component",tt),mxUtils.extend(it,mxDoubleEllipse),it.prototype.outerStroke=!0,it.prototype.paintVertexShape=function(n,t,i,r,u){var f=Math.min(4,Math.min(r/5,u/5));r>0&&u>0&&(n.ellipse(t+f,i+f,r-2*f,u-2*f),n.fillAndStroke());n.setShadow(!1);this.outerStroke&&(n.ellipse(t,i,r,u),n.stroke())},mxCellRenderer.registerShape("endState",it),mxUtils.extend(gi,it),gi.prototype.outerStroke=!1,mxCellRenderer.registerShape("startState",gi),mxUtils.extend(rt,mxArrowConnector),rt.prototype.defaultWidth=4,rt.prototype.isOpenEnded=function(){return!0},rt.prototype.getEdgeWidth=function(){return mxUtils.getNumber(this.style,"width",this.defaultWidth)+Math.max(0,this.strokewidth-1)},rt.prototype.isArrowRounded=function(){return this.isRounded},mxCellRenderer.registerShape("link",rt),mxUtils.extend(w,mxArrowConnector),w.prototype.defaultWidth=10,w.prototype.defaultArrowWidth=20,w.prototype.getStartArrowWidth=function(){return this.getEdgeWidth()+mxUtils.getNumber(this.style,"startWidth",this.defaultArrowWidth)},w.prototype.getEndArrowWidth=function(){return this.getEdgeWidth()+mxUtils.getNumber(this.style,"endWidth",this.defaultArrowWidth)},w.prototype.getEdgeWidth=function(){return mxUtils.getNumber(this.style,"width",this.defaultWidth)+Math.max(0,this.strokewidth-1)},mxCellRenderer.registerShape("flexArrow",w),mxUtils.extend(ut,mxActor),ut.prototype.size=30,ut.prototype.redrawPath=function(n,t,i,r,u){var f=Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,u),new mxPoint(0,f),new mxPoint(r,0),new mxPoint(r,u)],this.isRounded,e,!0);n.end()},mxCellRenderer.registerShape("manualInput",ut),mxUtils.extend(o,mxRectangleShape),o.prototype.dx=20,o.prototype.dy=20,o.prototype.isHtmlAllowed=function(){return!1},o.prototype.paintForeground=function(n,t,i,r,u){var f,e,o,s;mxRectangleShape.prototype.paintForeground.apply(this,arguments);f=0;this.isRounded&&(e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100,f=Math.max(f,Math.min(r*e,u*e)));o=Math.max(f,Math.min(r,parseFloat(mxUtils.getValue(this.style,"dx",this.dx))));s=Math.max(f,Math.min(u,parseFloat(mxUtils.getValue(this.style,"dy",this.dy))));n.begin();n.moveTo(t,i+s);n.lineTo(t+r,i+s);n.end();n.stroke();n.begin();n.moveTo(t+o,i);n.lineTo(t+o,i+u);n.end();n.stroke()},mxCellRenderer.registerShape("internalStorage",o),mxUtils.extend(h,mxActor),h.prototype.dx=20,h.prototype.dy=20,h.prototype.redrawPath=function(n,t,i,r,u){var f=Math.max(0,Math.min(r,parseFloat(mxUtils.getValue(this.style,"dx",this.dx)))),e=Math.max(0,Math.min(u,parseFloat(mxUtils.getValue(this.style,"dy",this.dy)))),s=Math.min(r/2,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,0),new mxPoint(r,0),new mxPoint(r,e),new mxPoint(f,e),new mxPoint(f,u),new mxPoint(0,u)],this.isRounded,o,!0);n.end()},mxCellRenderer.registerShape("corner",h),mxUtils.extend(ri,mxActor),ri.prototype.redrawPath=function(n,t,i,r,u){n.moveTo(0,0);n.lineTo(0,u);n.end();n.moveTo(r,0);n.lineTo(r,u);n.end();n.moveTo(0,u/2);n.lineTo(r,u/2);n.end()},mxCellRenderer.registerShape("crossbar",ri),mxUtils.extend(c,mxActor),c.prototype.dx=20,c.prototype.dy=20,c.prototype.redrawPath=function(n,t,i,r,u){var f=Math.max(0,Math.min(r,parseFloat(mxUtils.getValue(this.style,"dx",this.dx)))),e=Math.max(0,Math.min(u,parseFloat(mxUtils.getValue(this.style,"dy",this.dy)))),s=Math.abs(r-f)/2,h=Math.min(r/2,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),o=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,0),new mxPoint(r,0),new mxPoint(r,e),new mxPoint((r+f)/2,e),new mxPoint((r+f)/2,u),new mxPoint((r-f)/2,u),new mxPoint((r-f)/2,e),new mxPoint(0,e)],this.isRounded,o,!0);n.end()},mxCellRenderer.registerShape("tee",c),mxUtils.extend(e,mxActor),e.prototype.arrowWidth=.3,e.prototype.arrowSize=.2,e.prototype.redrawPath=function(n,t,i,r,u){var o=u*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",this.arrowWidth)))),f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",this.arrowSize)))),e=(u-o)/2,s=e+o,h=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,e),new mxPoint(r-f,e),new mxPoint(r-f,0),new mxPoint(r,u/2),new mxPoint(r-f,u),new mxPoint(r-f,s),new mxPoint(0,s)],this.isRounded,h,!0);n.end()},mxCellRenderer.registerShape("singleArrow",e),mxUtils.extend(ui,mxActor),ui.prototype.redrawPath=function(n,t,i,r,u){var s=u*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowWidth",e.prototype.arrowWidth)))),f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"arrowSize",e.prototype.arrowSize)))),o=(u-s)/2,h=o+s,c=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,u/2),new mxPoint(f,0),new mxPoint(f,o),new mxPoint(r-f,o),new mxPoint(r-f,0),new mxPoint(r,u/2),new mxPoint(r-f,u),new mxPoint(r-f,h),new mxPoint(f,h),new mxPoint(f,u)],this.isRounded,c,!0);n.end()},mxCellRenderer.registerShape("doubleArrow",ui),mxUtils.extend(ft,mxActor),ft.prototype.size=.1,ft.prototype.redrawPath=function(n,t,i,r,u){var f=r*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size))));n.moveTo(f,0);n.lineTo(r,0);n.quadTo(r-f*2,u/2,r,u);n.lineTo(f,u);n.quadTo(f-f*2,u/2,f,0);n.close();n.end()},mxCellRenderer.registerShape("dataStorage",ft),mxUtils.extend(fi,mxActor),fi.prototype.redrawPath=function(n,t,i,r,u){n.moveTo(0,0);n.quadTo(r,0,r,u/2);n.quadTo(r,u,0,u);n.close();n.end()},mxCellRenderer.registerShape("or",fi),mxUtils.extend(ei,mxActor),ei.prototype.redrawPath=function(n,t,i,r,u){n.moveTo(0,0);n.quadTo(r,0,r,u/2);n.quadTo(r,u,0,u);n.quadTo(r/2,u/2,0,0);n.close();n.end()},mxCellRenderer.registerShape("xor",ei),mxUtils.extend(et,mxActor),et.prototype.size=20,et.prototype.redrawPath=function(n,t,i,r,u){var f=Math.min(r/2,Math.min(u,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(f,0),new mxPoint(r-f,0),new mxPoint(r,f*.8),new mxPoint(r,u),new mxPoint(0,u),new mxPoint(0,f*.8)],this.isRounded,e,!0);n.end()},mxCellRenderer.registerShape("loopLimit",et),mxUtils.extend(ot,mxActor),ot.prototype.size=3/8,ot.prototype.redrawPath=function(n,t,i,r,u){var f=u*Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.style,"size",this.size)))),e=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2;this.addPoints(n,[new mxPoint(0,0),new mxPoint(r,0),new mxPoint(r,u-f),new mxPoint(r/2,u),new mxPoint(0,u-f)],this.isRounded,e,!0);n.end()},mxCellRenderer.registerShape("offPageConnector",ot),mxUtils.extend(oi,mxEllipse),oi.prototype.paintVertexShape=function(n,t,i,r,u){mxEllipse.prototype.paintVertexShape.apply(this,arguments);n.begin();n.moveTo(t+r/2,i+u);n.lineTo(t+r,i+u);n.end();n.stroke()},mxCellRenderer.registerShape("tapeData",oi),mxUtils.extend(si,mxEllipse),si.prototype.paintVertexShape=function(n,t,i,r,u){mxEllipse.prototype.paintVertexShape.apply(this,arguments);n.setShadow(!1);n.begin();n.moveTo(t,i+u/2);n.lineTo(t+r,i+u/2);n.end();n.stroke();n.begin();n.moveTo(t+r/2,i);n.lineTo(t+r/2,i+u);n.end();n.stroke()},mxCellRenderer.registerShape("orEllipse",si),mxUtils.extend(hi,mxEllipse),hi.prototype.paintVertexShape=function(n,t,i,r,u){mxEllipse.prototype.paintVertexShape.apply(this,arguments);var f=.145;n.setShadow(!1);n.begin();n.moveTo(t+r*f,i+u*f);n.lineTo(t+r*(1-f),i+u*(1-f));n.end();n.stroke();n.begin();n.moveTo(t+r*(1-f),i+u*f);n.lineTo(t+r*f,i+u*(1-f));n.end();n.stroke()},mxCellRenderer.registerShape("sumEllipse",hi),mxUtils.extend(nr,mxRhombus),nr.prototype.paintVertexShape=function(n,t,i,r,u){mxRhombus.prototype.paintVertexShape.apply(this,arguments);n.setShadow(!1);n.begin();n.moveTo(t,i+u/2);n.lineTo(t+r,i+u/2);n.end();n.stroke()},mxCellRenderer.registerShape("sortShape",nr),mxUtils.extend(tr,mxEllipse),tr.prototype.paintVertexShape=function(n,t,i,r,u){n.begin();n.moveTo(t,i);n.lineTo(t+r,i);n.lineTo(t+r/2,i+u/2);n.close();n.fillAndStroke();n.begin();n.moveTo(t,i+u);n.lineTo(t+r,i+u);n.lineTo(t+r/2,i+u/2);n.close();n.fillAndStroke()},mxCellRenderer.registerShape("collate",tr),mxUtils.extend(ir,mxEllipse),ir.prototype.paintVertexShape=function(n,t,i,r,u){var e=10,f=i+u-e/2;n.begin();n.moveTo(t,i);n.lineTo(t,i+u);n.moveTo(t,f);n.lineTo(t+e,f-e/2);n.moveTo(t,f);n.lineTo(t+e,f+e/2);n.moveTo(t,f);n.lineTo(t+r,f);n.moveTo(t+r,i);n.lineTo(t+r,i+u);n.moveTo(t+r,f);n.lineTo(t+r-e,f-e/2);n.moveTo(t+r,f);n.lineTo(t+r-e,f+e/2);n.end();n.stroke()},mxCellRenderer.registerShape("dimension",ir),mxUtils.extend(rr,mxEllipse),rr.prototype.paintVertexShape=function(n,t,i,r,u){this.outline||n.setStrokeColor(null);mxRectangleShape.prototype.paintBackground.apply(this,arguments);this.style!=null&&(n.setStrokeColor(this.stroke),n.rect(t,i,r,u),n.fill(),n.begin(),n.moveTo(t,i),mxUtils.getValue(this.style,"top","1")=="1"?n.lineTo(t+r,i):n.moveTo(t+r,i),mxUtils.getValue(this.style,"right","1")=="1"?n.lineTo(t+r,i+u):n.moveTo(t+r,i+u),mxUtils.getValue(this.style,"bottom","1")=="1"?n.lineTo(t,i+u):n.moveTo(t,i+u),mxUtils.getValue(this.style,"left","1")=="1"&&n.lineTo(t,i-this.strokewidth/2),n.end(),n.stroke())},mxCellRenderer.registerShape("partialRectangle",rr),mxUtils.extend(ci,mxEllipse),ci.prototype.paintVertexShape=function(n,t,i,r,u){mxEllipse.prototype.paintVertexShape.apply(this,arguments);n.setShadow(!1);n.begin();mxUtils.getValue(this.style,"line")=="vertical"?(n.moveTo(t+r/2,i),n.lineTo(t+r/2,i+u)):(n.moveTo(t,i+u/2),n.lineTo(t+r,i+u/2));n.end();n.stroke()},mxCellRenderer.registerShape("lineEllipse",ci),mxUtils.extend(li,mxActor),li.prototype.redrawPath=function(n,t,i,r,u){var f=Math.min(r,u/2);n.moveTo(0,0);n.lineTo(r-f,0);n.quadTo(r,0,r,u/2);n.quadTo(r,u,r-f,u);n.lineTo(0,u);n.close();n.end()},mxCellRenderer.registerShape("delay",li),mxUtils.extend(st,mxActor),st.prototype.size=.2,st.prototype.redrawPath=function(n,t,i,r,u){var c=Math.min(u,r),o=Math.max(0,Math.min(c,c*parseFloat(mxUtils.getValue(this.style,"size",this.size)))),f=(u-o)/2,s=f+o,e=(r-o)/2,h=e+o;n.moveTo(0,f);n.lineTo(e,f);n.lineTo(e,0);n.lineTo(h,0);n.lineTo(h,f);n.lineTo(r,f);n.lineTo(r,s);n.lineTo(h,s);n.lineTo(h,u);n.lineTo(e,u);n.lineTo(e,s);n.lineTo(0,s);n.close();n.end()},mxCellRenderer.registerShape("cross",st),mxUtils.extend(ht,mxActor),ht.prototype.size=.25,ht.prototype.redrawPath=function(n,t,i,r,u){var f=Math.min(r,u/2),e=Math.min(r-f,Math.max(0,parseFloat(mxUtils.getValue(this.style,"size",this.size)))*r);n.moveTo(0,u/2);n.lineTo(e,0);n.lineTo(r-f,0);n.quadTo(r,0,r,u/2);n.quadTo(r,u,r-f,u);n.lineTo(e,u);n.close();n.end()},mxCellRenderer.registerShape("display",ht),mxUtils.extend(b,mxConnector),b.prototype.origPaintEdgeShape=b.prototype.paintEdgeShape,b.prototype.paintEdgeShape=function(n,t,i){for(var e,o,u,f=[],r=0;r<t.length;r++)f.push(mxUtils.clone(t[r]));e=n.state.dashed;o=n.state.fixDash;b.prototype.origPaintEdgeShape.apply(this,[n,f,i]);n.state.strokeWidth>=3&&(u=mxUtils.getValue(this.style,"fillColor",null),u!=null&&(n.setStrokeColor(u),n.setStrokeWidth(n.state.strokeWidth-2),n.setDashed(e,o),b.prototype.origPaintEdgeShape.apply(this,[n,t,i])))},mxCellRenderer.registerShape("filledEdge",b),typeof StyleFormatPanel!="undefined"&&function(){var n=StyleFormatPanel.prototype.getCustomColors;StyleFormatPanel.prototype.getCustomColors=function(){var i=this.format.getSelectionState(),t=n.apply(this,arguments);return i.style.shape=="umlFrame"&&t.push({title:mxResources.get("laneColor"),key:"swimlaneFillColor",defaultValue:"#ffffff"}),t}}(),mxMarker.addMarker("dash",function(n,t,i,r,u,f,e,o,s){var h=u*(e+s+1),c=f*(e+s+1);return function(){n.begin();n.moveTo(r.x-h/2-c/2,r.y-c/2+h/2);n.lineTo(r.x+c/2-3*h/2,r.y-3*c/2-h/2);n.stroke()}}),mxMarker.addMarker("cross",function(n,t,i,r,u,f,e,o,s){var h=u*(e+s+1),c=f*(e+s+1);return function(){n.begin();n.moveTo(r.x-h/2-c/2,r.y-c/2+h/2);n.lineTo(r.x+c/2-3*h/2,r.y-3*c/2-h/2);n.moveTo(r.x-h/2+c/2,r.y-c/2-h/2);n.lineTo(r.x-c/2-3*h/2,r.y-3*c/2+h/2);n.stroke()}}),mxMarker.addMarker("circle",sr),mxMarker.addMarker("circlePlus",function(n,t,i,r,u,f,e,o,s){var h=r.clone(),a=sr.apply(this,arguments),c=u*(e+2*s),l=f*(e+2*s);return function(){a.apply(this,arguments);n.begin();n.moveTo(h.x-u*s,h.y-f*s);n.lineTo(h.x-2*c+u*s,h.y-2*l+f*s);n.moveTo(h.x-c-l+f*s,h.y-l+c-u*s);n.lineTo(h.x+l-c-f*s,h.y-l-c+u*s);n.stroke()}}),mxMarker.addMarker("async",function(n,t,i,r,u,f,e,o,s,h){var a=u*s*1.118,v=f*s*1.118,c,l;return u=u*(e+s),f=f*(e+s),c=r.clone(),c.x-=a,c.y-=v,l=1,r.x+=-u*l-a,r.y+=-f*l-v,function(){n.begin();n.moveTo(c.x,c.y);o?n.lineTo(c.x-u-f/2,c.y-f+u/2):n.lineTo(c.x+f/2-u,c.y-f-u/2);n.lineTo(c.x-u,c.y-f);n.close();h?n.fillAndStroke():n.stroke()}}),mxMarker.addMarker("openAsync",ar(2)),typeof mxVertexHandler!="undefined"){function t(n,t,i,r,u,f){var e=new mxHandle(n,null,mxVertexHandler.prototype.secondaryHandleImage),o;return e.execute=function(){for(var n=0;n<t.length;n++)this.copyStyle(t[n])},e.getPosition=i,e.setPosition=r,e.ignoreGrid=u!=null?u:!0,f&&(o=e.positionChanged,e.positionChanged=function(){o.apply(this,arguments);n.view.invalidate(this.state.cell);n.view.validate()}),e}function s(n,i){return t(n,[mxConstants.STYLE_ARCSIZE],function(t){var u=i!=null?i:t.height/8,r;return mxUtils.getValue(n.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0)=="1"?(r=mxUtils.getValue(n.style,mxConstants.STYLE_ARCSIZE,mxConstants.LINE_ARCSIZE)/2,new mxPoint(t.x+t.width-Math.min(t.width/2,r),t.y+u)):(r=Math.max(0,parseFloat(mxUtils.getValue(n.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)))/100,new mxPoint(t.x+t.width-Math.min(Math.max(t.width/2,t.height/2),Math.min(t.width,t.height)*r),t.y+u))},function(t,i){if(mxUtils.getValue(n.style,mxConstants.STYLE_ABSOLUTE_ARCSIZE,0)=="1")this.state.style[mxConstants.STYLE_ARCSIZE]=Math.round(Math.max(0,Math.min(t.width,(t.x+t.width-i.x)*2)));else{var r=Math.min(50,Math.max(0,(t.width-i.x+t.x)*100/Math.min(t.width,t.height)));this.state.style[mxConstants.STYLE_ARCSIZE]=Math.round(r)}})}function w(){return function(n){var t=[];return mxUtils.getValue(n.style,mxConstants.STYLE_ROUNDED,!1)&&t.push(s(n)),t}}function it(n){return function(i){var r=[t(i,["size"],function(t){var i=Math.max(0,Math.min(n,parseFloat(mxUtils.getValue(this.state.style,"size",y.prototype.size))));return new mxPoint(t.x+i*t.width*.75,t.y+t.height/4)},function(t,i){this.state.style.size=Math.max(0,Math.min(n,(i.x-t.x)/(t.width*.75)))},null,!0)];return mxUtils.getValue(i.style,mxConstants.STYLE_ROUNDED,!1)&&r.push(s(i)),r}}function g(n,i,r,u,f){return r=r!=null?r:1,function(e){var o=[t(e,["size"],function(t){var i=f!=null?mxUtils.getValue(this.state.style,"fixedSize","0")!="0":null,r=parseFloat(mxUtils.getValue(this.state.style,"size",i?f:n));return new mxPoint(t.x+Math.max(0,Math.min(t.width,r*(i?1:t.width))),t.getCenterY())},function(n,t,i){var o=f!=null?mxUtils.getValue(this.state.style,"fixedSize","0")!="0":null,u=o?t.x-n.x:Math.max(0,Math.min(r,(t.x-n.x)/n.width));o&&!mxEvent.isAltDown(i.getEvent())&&(u=e.view.graph.snap(u));this.state.style.size=u},null,u)];return i&&mxUtils.getValue(e.style,mxConstants.STYLE_ROUNDED,!1)&&o.push(s(e)),o}}function tt(n,i,r){return function(u){var f=[t(u,["size"],function(t){var r=Math.max(0,Math.min(t.width,Math.min(t.height,parseFloat(mxUtils.getValue(this.state.style,"size",i)))))*n;return new mxPoint(t.x+r,t.y+r)},function(t,i){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(t.width,i.x-t.x),Math.min(t.height,i.y-t.y)))/n)})];return r&&mxUtils.getValue(u.style,mxConstants.STYLE_ROUNDED,!1)&&f.push(s(u)),f}}function rt(n){return function(i){return[t(i,["arrowWidth","arrowSize"],function(t){var i=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"arrowWidth",e.prototype.arrowWidth))),r=Math.max(0,Math.min(n,mxUtils.getValue(this.state.style,"arrowSize",e.prototype.arrowSize)));return new mxPoint(t.x+(1-r)*t.width,t.y+(1-i)*t.height/2)},function(t,i){this.state.style.arrowWidth=Math.max(0,Math.min(1,Math.abs(t.y+t.height/2-i.y)/t.height*2));this.state.style.arrowSize=Math.max(0,Math.min(n,(t.x+t.width-i.x)/t.width))})]}}function b(n,i,r,u,f){return t(n,i,function(){var t=n.absolutePoints,h=t.length-1,c=n.view.translate,l=n.view.scale,i=r?t[0]:t[h],f=r?t[1]:t[h-1],e=r?f.x-i.x:f.x-i.x,o=r?f.y-i.y:f.y-i.y,s=Math.sqrt(e*e+o*o),a=u.call(this,s,e/s,o/s,i,f);return new mxPoint(a.x/l-c.x,a.y/l-c.y)},function(t,i,u){var e=n.absolutePoints,a=e.length-1,v=n.view.translate,y=n.view.scale,o=r?e[0]:e[a],s=r?e[1]:e[a-1],h=r?s.x-o.x:s.x-o.x,c=r?s.y-o.y:s.y-o.y,l=Math.sqrt(h*h+c*c);i.x=(i.x+v.x)*y;i.y=(i.y+v.y)*y;f.call(this,l,h/l,c/l,o,s,i,u)})}function ct(n,t,i){return b(n,["width"],t,function(t,r,u,f){var e=n.shape.getEdgeWidth()*n.view.scale+i;return new mxPoint(f.x+r*t/4+u*e/2,f.y+u*t/4-r*e/2)},function(t,r,u,f,e,o){var s=Math.sqrt(mxUtils.ptSegDistSq(f.x,f.y,e.x,e.y,o.x,o.y));n.style.width=Math.round(s*2)/n.view.scale-i})}function lt(n,t,i,r,u,f){return Math.abs((r-t)*u-(i-n)*f+i*t-r*n)/Math.sqrt((r-t)*(r-t)+(i-n)*(i-n))}ai={link:function(n){var t=10;return[ct(n,!0,t),ct(n,!1,t)]},flexArrow:function(n){var t=n.view.graph.gridSize/n.view.scale,i=[];return mxUtils.getValue(n.style,mxConstants.STYLE_STARTARROW,mxConstants.NONE)!=mxConstants.NONE&&(i.push(b(n,["width",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],!0,function(t,i,r,u){var f=(n.shape.getEdgeWidth()-n.shape.strokewidth)*n.view.scale,e=mxUtils.getNumber(n.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3*n.view.scale;return new mxPoint(u.x+i*(e+n.shape.strokewidth*n.view.scale)+r*f/2,u.y+r*(e+n.shape.strokewidth*n.view.scale)-i*f/2)},function(i,r,u,f,e,o,s){var h=Math.sqrt(mxUtils.ptSegDistSq(f.x,f.y,e.x,e.y,o.x,o.y)),c=mxUtils.ptLineDist(f.x,f.y,f.x+u,f.y-r,o.x,o.y);n.style[mxConstants.STYLE_STARTSIZE]=Math.round((c-n.shape.strokewidth)*100/3)/100/n.view.scale;n.style.width=Math.round(h*2)/n.view.scale;mxEvent.isControlDown(s.getEvent())&&(n.style[mxConstants.STYLE_ENDSIZE]=n.style[mxConstants.STYLE_STARTSIZE]);mxEvent.isAltDown(s.getEvent())||Math.abs(parseFloat(n.style[mxConstants.STYLE_STARTSIZE])-parseFloat(n.style[mxConstants.STYLE_ENDSIZE]))<t/6&&(n.style[mxConstants.STYLE_STARTSIZE]=n.style[mxConstants.STYLE_ENDSIZE])})),i.push(b(n,["startWidth","endWidth",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],!0,function(t,i,r,u){var f=(n.shape.getStartArrowWidth()-n.shape.strokewidth)*n.view.scale,e=mxUtils.getNumber(n.style,mxConstants.STYLE_STARTSIZE,mxConstants.ARROW_SIZE/5)*3*n.view.scale;return new mxPoint(u.x+i*(e+n.shape.strokewidth*n.view.scale)+r*f/2,u.y+r*(e+n.shape.strokewidth*n.view.scale)-i*f/2)},function(i,r,u,f,e,o,s){var h=Math.sqrt(mxUtils.ptSegDistSq(f.x,f.y,e.x,e.y,o.x,o.y)),c=mxUtils.ptLineDist(f.x,f.y,f.x+u,f.y-r,o.x,o.y);n.style[mxConstants.STYLE_STARTSIZE]=Math.round((c-n.shape.strokewidth)*100/3)/100/n.view.scale;n.style.startWidth=Math.max(0,Math.round(h*2)-n.shape.getEdgeWidth())/n.view.scale;mxEvent.isControlDown(s.getEvent())&&(n.style[mxConstants.STYLE_ENDSIZE]=n.style[mxConstants.STYLE_STARTSIZE],n.style.endWidth=n.style.startWidth);mxEvent.isAltDown(s.getEvent())||(Math.abs(parseFloat(n.style[mxConstants.STYLE_STARTSIZE])-parseFloat(n.style[mxConstants.STYLE_ENDSIZE]))<t/6&&(n.style[mxConstants.STYLE_STARTSIZE]=n.style[mxConstants.STYLE_ENDSIZE]),Math.abs(parseFloat(n.style.startWidth)-parseFloat(n.style.endWidth))<t&&(n.style.startWidth=n.style.endWidth))}))),mxUtils.getValue(n.style,mxConstants.STYLE_ENDARROW,mxConstants.NONE)!=mxConstants.NONE&&(i.push(b(n,["width",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],!1,function(t,i,r,u){var f=(n.shape.getEdgeWidth()-n.shape.strokewidth)*n.view.scale,e=mxUtils.getNumber(n.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3*n.view.scale;return new mxPoint(u.x+i*(e+n.shape.strokewidth*n.view.scale)-r*f/2,u.y+r*(e+n.shape.strokewidth*n.view.scale)+i*f/2)},function(i,r,u,f,e,o,s){var h=Math.sqrt(mxUtils.ptSegDistSq(f.x,f.y,e.x,e.y,o.x,o.y)),c=mxUtils.ptLineDist(f.x,f.y,f.x+u,f.y-r,o.x,o.y);n.style[mxConstants.STYLE_ENDSIZE]=Math.round((c-n.shape.strokewidth)*100/3)/100/n.view.scale;n.style.width=Math.round(h*2)/n.view.scale;mxEvent.isControlDown(s.getEvent())&&(n.style[mxConstants.STYLE_STARTSIZE]=n.style[mxConstants.STYLE_ENDSIZE]);mxEvent.isAltDown(s.getEvent())||Math.abs(parseFloat(n.style[mxConstants.STYLE_ENDSIZE])-parseFloat(n.style[mxConstants.STYLE_STARTSIZE]))<t/6&&(n.style[mxConstants.STYLE_ENDSIZE]=n.style[mxConstants.STYLE_STARTSIZE])})),i.push(b(n,["startWidth","endWidth",mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE],!1,function(t,i,r,u){var f=(n.shape.getEndArrowWidth()-n.shape.strokewidth)*n.view.scale,e=mxUtils.getNumber(n.style,mxConstants.STYLE_ENDSIZE,mxConstants.ARROW_SIZE/5)*3*n.view.scale;return new mxPoint(u.x+i*(e+n.shape.strokewidth*n.view.scale)-r*f/2,u.y+r*(e+n.shape.strokewidth*n.view.scale)+i*f/2)},function(i,r,u,f,e,o,s){var h=Math.sqrt(mxUtils.ptSegDistSq(f.x,f.y,e.x,e.y,o.x,o.y)),c=mxUtils.ptLineDist(f.x,f.y,f.x+u,f.y-r,o.x,o.y);n.style[mxConstants.STYLE_ENDSIZE]=Math.round((c-n.shape.strokewidth)*100/3)/100/n.view.scale;n.style.endWidth=Math.max(0,Math.round(h*2)-n.shape.getEdgeWidth())/n.view.scale;mxEvent.isControlDown(s.getEvent())&&(n.style[mxConstants.STYLE_STARTSIZE]=n.style[mxConstants.STYLE_ENDSIZE],n.style.startWidth=n.style.endWidth);mxEvent.isAltDown(s.getEvent())||(Math.abs(parseFloat(n.style[mxConstants.STYLE_ENDSIZE])-parseFloat(n.style[mxConstants.STYLE_STARTSIZE]))<t/6&&(n.style[mxConstants.STYLE_ENDSIZE]=n.style[mxConstants.STYLE_STARTSIZE]),Math.abs(parseFloat(n.style.endWidth)-parseFloat(n.style.startWidth))<t&&(n.style.endWidth=n.style.startWidth))}))),i},swimlane:function(n){var i=[t(n,[mxConstants.STYLE_STARTSIZE],function(t){var i=parseFloat(mxUtils.getValue(n.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));return mxUtils.getValue(n.style,mxConstants.STYLE_HORIZONTAL,1)==1?new mxPoint(t.getCenterX(),t.y+Math.max(0,Math.min(t.height,i))):new mxPoint(t.x+Math.max(0,Math.min(t.width,i)),t.getCenterY())},function(t,i){n.style[mxConstants.STYLE_STARTSIZE]=mxUtils.getValue(this.state.style,mxConstants.STYLE_HORIZONTAL,1)==1?Math.round(Math.max(0,Math.min(t.height,i.y-t.y))):Math.round(Math.max(0,Math.min(t.width,i.x-t.x)))})],r;return mxUtils.getValue(n.style,mxConstants.STYLE_ROUNDED)&&(r=parseFloat(mxUtils.getValue(n.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)),i.push(s(n,r/2))),i},label:w(),ext:w(),rectangle:w(),triangle:w(),rhombus:w(),umlLifeline:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(n.height,parseFloat(mxUtils.getValue(this.state.style,"size",u.prototype.size))));return new mxPoint(n.getCenterX(),n.y+t)},function(n,t){this.state.style.size=Math.round(Math.max(0,Math.min(n.height,t.y-n.y)))},!1)]},umlFrame:function(n){return[t(n,["width","height"],function(n){var t=Math.max(i.prototype.corner,Math.min(n.width,mxUtils.getValue(this.state.style,"width",i.prototype.width))),r=Math.max(i.prototype.corner*1.5,Math.min(n.height,mxUtils.getValue(this.state.style,"height",i.prototype.height)));return new mxPoint(n.x+t,n.y+r)},function(n,t){this.state.style.width=Math.round(Math.max(i.prototype.corner,Math.min(n.width,t.x-n.x)));this.state.style.height=Math.round(Math.max(i.prototype.corner*1.5,Math.min(n.height,t.y-n.y)))},!1)]},process:function(n){var i=[t(n,["size"],function(n){var t=Math.max(0,Math.min(.5,parseFloat(mxUtils.getValue(this.state.style,"size",p.prototype.size))));return new mxPoint(n.x+n.width*t,n.y+n.height/4)},function(n,t){this.state.style.size=Math.max(0,Math.min(.5,(t.x-n.x)/n.width))})];return mxUtils.getValue(n.style,mxConstants.STYLE_ROUNDED,!1)&&i.push(s(n)),i},cross:function(n){return[t(n,["size"],function(n){var i=Math.min(n.width,n.height),t=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"size",st.prototype.size)))*i/2;return new mxPoint(n.getCenterX()-t,n.getCenterY()-t)},function(n,t){var i=Math.min(n.width,n.height);this.state.style.size=Math.max(0,Math.min(1,Math.min(Math.max(0,n.getCenterY()-t.y)/i*2,Math.max(0,n.getCenterX()-t.x)/i*2)))})]},note:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(n.width,Math.min(n.height,parseFloat(mxUtils.getValue(this.state.style,"size",k.prototype.size)))));return new mxPoint(n.x+n.width-t,n.y+t)},function(n,t){this.state.style.size=Math.round(Math.max(0,Math.min(Math.min(n.width,n.x+n.width-t.x),Math.min(n.height,t.y-n.y))))})]},manualInput:function(n){var i=[t(n,["size"],function(n){var t=Math.max(0,Math.min(n.height,mxUtils.getValue(this.state.style,"size",ut.prototype.size)));return new mxPoint(n.x+n.width/4,n.y+t*3/4)},function(n,t){this.state.style.size=Math.round(Math.max(0,Math.min(n.height,(t.y-n.y)*4/3)))})];return mxUtils.getValue(n.style,mxConstants.STYLE_ROUNDED,!1)&&i.push(s(n)),i},dataStorage:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",ft.prototype.size))));return new mxPoint(n.x+(1-t)*n.width,n.getCenterY())},function(n,t){this.state.style.size=Math.max(0,Math.min(1,(n.x+n.width-t.x)/n.width))})]},callout:function(i){var r=[t(i,["size","position"],function(t){var i=Math.max(0,Math.min(t.height,mxUtils.getValue(this.state.style,"size",n.prototype.size))),r=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"position",n.prototype.position))),u=Math.max(0,Math.min(t.width,mxUtils.getValue(this.state.style,"base",n.prototype.base)));return new mxPoint(t.x+r*t.width,t.y+t.height-i)},function(t,i){var r=Math.max(0,Math.min(t.width,mxUtils.getValue(this.state.style,"base",n.prototype.base)));this.state.style.size=Math.round(Math.max(0,Math.min(t.height,t.y+t.height-i.y)));this.state.style.position=Math.round(Math.max(0,Math.min(1,(i.x-t.x)/t.width))*100)/100}),t(i,["position2"],function(t){var i=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"position2",n.prototype.position2)));return new mxPoint(t.x+i*t.width,t.y+t.height)},function(n,t){this.state.style.position2=Math.round(Math.max(0,Math.min(1,(t.x-n.x)/n.width))*100)/100}),t(i,["base"],function(t){var i=Math.max(0,Math.min(t.height,mxUtils.getValue(this.state.style,"size",n.prototype.size))),r=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"position",n.prototype.position))),u=Math.max(0,Math.min(t.width,mxUtils.getValue(this.state.style,"base",n.prototype.base)));return new mxPoint(t.x+Math.min(t.width,r*t.width+u),t.y+t.height-i)},function(t,i){var r=Math.max(0,Math.min(1,mxUtils.getValue(this.state.style,"position",n.prototype.position)));this.state.style.base=Math.round(Math.max(0,Math.min(t.width,i.x-t.x-r*t.width)))})];return mxUtils.getValue(i.style,mxConstants.STYLE_ROUNDED,!1)&&r.push(s(i)),r},internalStorage:function(n){var i=[t(n,["dx","dy"],function(n){var t=Math.max(0,Math.min(n.width,mxUtils.getValue(this.state.style,"dx",o.prototype.dx))),i=Math.max(0,Math.min(n.height,mxUtils.getValue(this.state.style,"dy",o.prototype.dy)));return new mxPoint(n.x+t,n.y+i)},function(n,t){this.state.style.dx=Math.round(Math.max(0,Math.min(n.width,t.x-n.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(n.height,t.y-n.y)))})];return mxUtils.getValue(n.style,mxConstants.STYLE_ROUNDED,!1)&&i.push(s(n)),i},corner:function(n){return[t(n,["dx","dy"],function(n){var t=Math.max(0,Math.min(n.width,mxUtils.getValue(this.state.style,"dx",h.prototype.dx))),i=Math.max(0,Math.min(n.height,mxUtils.getValue(this.state.style,"dy",h.prototype.dy)));return new mxPoint(n.x+t,n.y+i)},function(n,t){this.state.style.dx=Math.round(Math.max(0,Math.min(n.width,t.x-n.x)));this.state.style.dy=Math.round(Math.max(0,Math.min(n.height,t.y-n.y)))})]},tee:function(n){return[t(n,["dx","dy"],function(n){var t=Math.max(0,Math.min(n.width,mxUtils.getValue(this.state.style,"dx",c.prototype.dx))),i=Math.max(0,Math.min(n.height,mxUtils.getValue(this.state.style,"dy",c.prototype.dy)));return new mxPoint(n.x+(n.width+t)/2,n.y+i)},function(n,t){this.state.style.dx=Math.round(Math.max(0,Math.min(n.width/2,t.x-n.x-n.width/2)*2));this.state.style.dy=Math.round(Math.max(0,Math.min(n.height,t.y-n.y)))})]},singleArrow:rt(1),doubleArrow:rt(.5),folder:function(n){return[t(n,["tabWidth","tabHeight"],function(n){var t=Math.max(0,Math.min(n.width,mxUtils.getValue(this.state.style,"tabWidth",r.prototype.tabWidth))),i=Math.max(0,Math.min(n.height,mxUtils.getValue(this.state.style,"tabHeight",r.prototype.tabHeight)));return mxUtils.getValue(this.state.style,"tabPosition",r.prototype.tabPosition)==mxConstants.ALIGN_RIGHT&&(t=n.width-t),new mxPoint(n.x+t,n.y+i)},function(n,t){var i=Math.max(0,Math.min(n.width,t.x-n.x));mxUtils.getValue(this.state.style,"tabPosition",r.prototype.tabPosition)==mxConstants.ALIGN_RIGHT&&(i=n.width-i);this.state.style.tabWidth=Math.round(i);this.state.style.tabHeight=Math.round(Math.max(0,Math.min(n.height,t.y-n.y)))})]},document:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",v.prototype.size))));return new mxPoint(n.x+3*n.width/4,n.y+(1-t)*n.height)},function(n,t){this.state.style.size=Math.max(0,Math.min(1,(n.y+n.height-t.y)/n.height))})]},tape:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",a.prototype.size))));return new mxPoint(n.getCenterX(),n.y+t*n.height/2)},function(n,t){this.state.style.size=Math.max(0,Math.min(1,(t.y-n.y)/n.height*2))})]},offPageConnector:function(n){return[t(n,["size"],function(n){var t=Math.max(0,Math.min(1,parseFloat(mxUtils.getValue(this.state.style,"size",ot.prototype.size))));return new mxPoint(n.getCenterX(),n.y+(1-t)*n.height)},function(n,t){this.state.style.size=Math.max(0,Math.min(1,(n.y+n.height-t.y)/n.height))})]},step:g(f.prototype.size,!0,null,!0,f.prototype.fixedSize),hexagon:g(nt.prototype.size,!0,.5,!0),curlyBracket:g(at.prototype.size,!1),display:g(ht.prototype.size,!1),cube:tt(1,l.prototype.size,!1),card:tt(.5,d.prototype.size,!0),loopLimit:tt(.5,et.prototype.size,!0),trapezoid:it(.5),parallelogram:it(1)};Graph.createHandle=t;Graph.handleFactory=ai;mxVertexHandler.prototype.createCustomHandles=function(){var n,t;return this.state.view.graph.getSelectionCount()==1&&this.graph.isCellRotatable(this.state.cell)&&(n=this.state.style.shape,mxCellRenderer.defaultShapes[n]==null&&mxStencilRegistry.getStencil(n)==null&&(n=mxConstants.SHAPE_RECTANGLE),t=ai[n],t!=null)?t(this.state):null};mxEdgeHandler.prototype.createCustomHandles=function(){var n,t;return this.state.view.graph.getSelectionCount()==1&&(n=this.state.style.shape,mxCellRenderer.defaultShapes[n]==null&&mxStencilRegistry.getStencil(n)==null&&(n=mxConstants.SHAPE_CONNECTOR),t=ai[n],t!=null)?t(this.state):null}}else Graph.createHandle=function(){},Graph.handleFactory={};var vi=new mxPoint(1,0),yi=new mxPoint(1,0),hr=mxUtils.toRadians(-30),vr=Math.cos(hr),yr=Math.sin(hr);vi=mxUtils.getRotatedPoint(vi,vr,yr);var cr=mxUtils.toRadians(-150),pr=Math.cos(cr),wr=Math.sin(cr);yi=mxUtils.getRotatedPoint(yi,pr,wr);mxEdgeStyle.IsometricConnector=function(n,t,i,r,u){var y=n.view,o=r!=null&&r.length>0?r[0]:null,v=n.absolutePoints,e=v[0],s=v[v.length-1],f;o!=null&&(o=y.transformControlPoint(n,o));e==null&&t!=null&&(e=new mxPoint(t.getCenterX(),t.getCenterY()));s==null&&i!=null&&(s=new mxPoint(i.getCenterX(),i.getCenterY()));var h=vi.x,c=vi.y,l=yi.x,a=yi.y,p=mxUtils.getValue(n.style,"elbow","horizontal")=="horizontal";if(s!=null&&e!=null){f=e;function n(n,t,i){var o=n-f.x,s=t-f.y,r=(a*o-l*s)/(h*a-c*l),e=(c*o-h*s)/(c*l-h*a);p?(i&&(f=new mxPoint(f.x+h*r,f.y+c*r),u.push(f)),f=new mxPoint(f.x+l*e,f.y+a*e),u.push(f)):(i&&(f=new mxPoint(f.x+l*e,f.y+a*e),u.push(f)),f=new mxPoint(f.x+h*r,f.y+c*r),u.push(f))}o==null&&(o=new mxPoint(e.x+(s.x-e.x)/2,e.y+(s.y-e.y)/2));n(o.x,o.y,!0);n(s.x,s.y,!1)}};mxStyleRegistry.putValue("isometricEdgeStyle",mxEdgeStyle.IsometricConnector);lr=Graph.prototype.createEdgeHandler;Graph.prototype.createEdgeHandler=function(n,t){if(t==mxEdgeStyle.IsometricConnector){var i=new mxElbowEdgeHandler(n);return i.snapToTerminals=!1,i}return lr.apply(this,arguments)};ct.prototype.constraints=[];lt.prototype.constraints=[];n.prototype.constraints=[];mxRectangleShape.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)];mxEllipse.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),!0),new mxConnectionConstraint(new mxPoint(1,0),!0),new mxConnectionConstraint(new mxPoint(0,1),!0),new mxConnectionConstraint(new mxPoint(1,1),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(1,.5))];mxLabel.prototype.constraints=mxRectangleShape.prototype.constraints;mxImageShape.prototype.constraints=mxRectangleShape.prototype.constraints;mxSwimlane.prototype.constraints=mxRectangleShape.prototype.constraints;vt.prototype.constraints=mxRectangleShape.prototype.constraints;k.prototype.constraints=mxRectangleShape.prototype.constraints;d.prototype.constraints=mxRectangleShape.prototype.constraints;l.prototype.constraints=mxRectangleShape.prototype.constraints;r.prototype.constraints=mxRectangleShape.prototype.constraints;o.prototype.constraints=mxRectangleShape.prototype.constraints;ft.prototype.constraints=mxRectangleShape.prototype.constraints;oi.prototype.constraints=mxEllipse.prototype.constraints;si.prototype.constraints=mxEllipse.prototype.constraints;hi.prototype.constraints=mxEllipse.prototype.constraints;ci.prototype.constraints=mxEllipse.prototype.constraints;ut.prototype.constraints=mxRectangleShape.prototype.constraints;li.prototype.constraints=mxRectangleShape.prototype.constraints;ht.prototype.constraints=mxRectangleShape.prototype.constraints;et.prototype.constraints=mxRectangleShape.prototype.constraints;ot.prototype.constraints=mxRectangleShape.prototype.constraints;mxCylinder.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.15,.05),!1),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.85,.05),!1),new mxConnectionConstraint(new mxPoint(0,.3),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.7),!0),new mxConnectionConstraint(new mxPoint(1,.3),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.7),!0),new mxConnectionConstraint(new mxPoint(.15,.95),!1),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.85,.95),!1)];ti.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,.1),!1),new mxConnectionConstraint(new mxPoint(.5,0),!1),new mxConnectionConstraint(new mxPoint(.75,.1),!1),new mxConnectionConstraint(new mxPoint(0,1/3),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(1,1/3),!1),new mxConnectionConstraint(new mxPoint(1,1),!1),new mxConnectionConstraint(new mxPoint(.5,.5),!1)];tt.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.3),!0),new mxConnectionConstraint(new mxPoint(0,.7),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)];mxActor.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.25,.2),!1),new mxConnectionConstraint(new mxPoint(.1,.5),!1),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(.75,.25),!1),new mxConnectionConstraint(new mxPoint(.9,.5),!1),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0)];gt.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),!1),new mxConnectionConstraint(new mxPoint(.5,.25),!1),new mxConnectionConstraint(new mxPoint(1,0),!1),new mxConnectionConstraint(new mxPoint(.25,.5),!1),new mxConnectionConstraint(new mxPoint(.75,.5),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(.5,.75),!1),new mxConnectionConstraint(new mxPoint(1,1),!1)];a.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.35),!1),new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(0,.65),!1),new mxConnectionConstraint(new mxPoint(1,.35),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(1,.65),!1),new mxConnectionConstraint(new mxPoint(.25,1),!1),new mxConnectionConstraint(new mxPoint(.75,0),!1)];f.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(.25,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.75,1),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0)];mxLine.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(.25,.5),!1),new mxConnectionConstraint(new mxPoint(.75,.5),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1)];wt.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.5,0),!1),new mxConnectionConstraint(new mxPoint(.5,1),!1)];mxDoubleEllipse.prototype.constraints=mxEllipse.prototype.constraints;mxRhombus.prototype.constraints=mxEllipse.prototype.constraints;mxTriangle.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0)];mxHexagon.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.375,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.625,0),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0),new mxConnectionConstraint(new mxPoint(.375,1),!0),new mxConnectionConstraint(new mxPoint(.5,1),!0),new mxConnectionConstraint(new mxPoint(.625,1),!0)];mxCloud.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,.25),!1),new mxConnectionConstraint(new mxPoint(.4,.1),!1),new mxConnectionConstraint(new mxPoint(.16,.55),!1),new mxConnectionConstraint(new mxPoint(.07,.4),!1),new mxConnectionConstraint(new mxPoint(.31,.8),!1),new mxConnectionConstraint(new mxPoint(.13,.77),!1),new mxConnectionConstraint(new mxPoint(.8,.8),!1),new mxConnectionConstraint(new mxPoint(.55,.95),!1),new mxConnectionConstraint(new mxPoint(.875,.5),!1),new mxConnectionConstraint(new mxPoint(.96,.7),!1),new mxConnectionConstraint(new mxPoint(.625,.2),!1),new mxConnectionConstraint(new mxPoint(.88,.25),!1)];g.prototype.constraints=mxRectangleShape.prototype.constraints;y.prototype.constraints=mxRectangleShape.prototype.constraints;v.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.25,0),!0),new mxConnectionConstraint(new mxPoint(.5,0),!0),new mxConnectionConstraint(new mxPoint(.75,0),!0),new mxConnectionConstraint(new mxPoint(0,.25),!0),new mxConnectionConstraint(new mxPoint(0,.5),!0),new mxConnectionConstraint(new mxPoint(0,.75),!0),new mxConnectionConstraint(new mxPoint(1,.25),!0),new mxConnectionConstraint(new mxPoint(1,.5),!0),new mxConnectionConstraint(new mxPoint(1,.75),!0)];mxArrow.prototype.constraints=null;c.prototype.constraints=null;h.prototype.constraints=null;ri.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,0),!1),new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(0,1),!1),new mxConnectionConstraint(new mxPoint(.25,.5),!1),new mxConnectionConstraint(new mxPoint(.5,.5),!1),new mxConnectionConstraint(new mxPoint(.75,.5),!1),new mxConnectionConstraint(new mxPoint(1,0),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(1,1),!1)];e.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1)];ui.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1)];st.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(.5,0),!1),new mxConnectionConstraint(new mxPoint(.5,1),!1)];u.prototype.constraints=null;fi.prototype.constraints=[new mxConnectionConstraint(new mxPoint(0,.25),!1),new mxConnectionConstraint(new mxPoint(0,.5),!1),new mxConnectionConstraint(new mxPoint(0,.75),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(.7,.1),!1),new mxConnectionConstraint(new mxPoint(.7,.9),!1)];ei.prototype.constraints=[new mxConnectionConstraint(new mxPoint(.175,.25),!1),new mxConnectionConstraint(new mxPoint(.25,.5),!1),new mxConnectionConstraint(new mxPoint(.175,.75),!1),new mxConnectionConstraint(new mxPoint(1,.5),!1),new mxConnectionConstraint(new mxPoint(.7,.1),!1),new mxConnectionConstraint(new mxPoint(.7,.9),!1)]}();Actions.prototype.init=function(){function o(t){var u,i,f,r;if(n.escape(),u=n.getDeletableCells(n.getSelectionCells()),u!=null&&u.length>0&&(i=n.model.getParents(u),n.removeCells(u,t),i!=null)){for(f=[],r=0;r<i.length;r++)n.model.contains(i[r])&&(n.model.isVertex(i[r])||n.model.isEdge(i[r]))&&f.push(i[r]);n.setSelectionCells(f)}}var t=this.editorUi,u=t.editor,n=u.graph,r=function(){return Action.prototype.isEnabled.apply(this,arguments)&&n.isEnabled()},i,f,e;this.addAction("new...",function(){n.removeCells(n.getChildVertices(n.getDefaultParent()))});this.addAction("open...",function(){window.openNew=!1;window.openKey="open";t.openFile()});this.addAction("import...",function(){window.openNew=!1;window.openKey="import";window.openFile=new OpenFile(mxUtils.bind(this,function(){t.hideDialog()}));window.openFile.setConsumer(mxUtils.bind(this,function(n){try{var t=mxUtils.parseXml(n);u.graph.setSelectionCells(u.graph.importGraphModel(t.documentElement))}catch(i){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+i.message)}}));t.showDialog(new OpenDialog(this).container,320,220,!0,!0,function(){window.openFile=null})}).isEnabled=r;this.addAction("save",function(){t.saveFile(!1)},null,null,Editor.ctrlKey+"+S").isEnabled=r;this.addAction("saveAs...",function(){t.saveFile(!0)},null,null,Editor.ctrlKey+"+Shift+S").isEnabled=r;this.addAction("export...",function(){t.showDialog(new ExportDialog(t).container,300,230,!0,!0)});this.addAction("editDiagram...",function(){var n=new EditDiagramDialog(t);t.showDialog(n.container,620,420,!0,!1);n.init()});this.addAction("pageSetup...",function(){t.showDialog(new PageSetupDialog(t).container,320,220,!0,!0)}).isEnabled=r;this.addAction("print...",function(){t.showDialog(new PrintDialog(t).container,300,180,!0,!0)},null,"sprite-print",Editor.ctrlKey+"+P");this.addAction("preview",function(){mxUtils.show(n,null,10,10)});this.addAction("undo",function(){t.undo()},null,"sprite-undo",Editor.ctrlKey+"+Z");this.addAction("redo",function(){t.redo()},null,"sprite-redo",mxClient.IS_WIN?Editor.ctrlKey+"+Y":Editor.ctrlKey+"+Shift+Z");this.addAction("cut",function(){mxClipboard.cut(n)},null,"sprite-cut",Editor.ctrlKey+"+X");this.addAction("copy",function(){mxClipboard.copy(n)},null,"sprite-copy",Editor.ctrlKey+"+C");this.addAction("paste",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&mxClipboard.paste(n)},!1,"sprite-paste",Editor.ctrlKey+"+V");this.addAction("pasteHere",function(){var t,r,u,f,s,h;if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){n.getModel().beginUpdate();try{if(t=mxClipboard.paste(n),t!=null){for(r=!0,u=0;u<t.length&&r;u++)r=r&&n.model.isEdge(t[u]);var e=n.view.translate,o=n.view.scale,c=e.x,l=e.y,i=null;t.length==1&&r&&(f=n.getCellGeometry(t[0]),f!=null&&(i=f.getTerminalPoint(!0)));i=i!=null?i:n.getBoundingBoxFromGeometry(t,r);i!=null&&(s=Math.round(n.snap(n.popupMenuHandler.triggerX/o-c)),h=Math.round(n.snap(n.popupMenuHandler.triggerY/o-l)),n.cellsMoved(t,s-i.x,h-i.y))}}finally{n.getModel().endUpdate()}}});this.addAction("delete",function(n){o(n!=null&&mxEvent.isShiftDown(n))},null,null,"Delete");this.addAction("deleteAll",function(){o(!0)},null,null,Editor.ctrlKey+"+Delete");this.addAction("duplicate",function(){n.setSelectionCells(n.duplicateCells())},null,null,Editor.ctrlKey+"+D");this.put("turn",new Action(mxResources.get("turn")+" / "+mxResources.get("reverse"),function(){n.turnShapes(n.getSelectionCells())},null,null,Editor.ctrlKey+"+R"));this.addAction("selectVertices",function(){n.selectVertices()},null,null,Editor.ctrlKey+"+Shift+I");this.addAction("selectEdges",function(){n.selectEdges()},null,null,Editor.ctrlKey+"+Shift+E");this.addAction("selectAll",function(){n.selectAll(null,!0)},null,null,Editor.ctrlKey+"+A");this.addAction("selectNone",function(){n.clearSelection()},null,null,Editor.ctrlKey+"+Shift+A");this.addAction("lockUnlock",function(){if(!n.isSelectionEmpty()){n.getModel().beginUpdate();try{var t=n.isCellMovable(n.getSelectionCell())?1:0;n.toggleCellStyles(mxConstants.STYLE_MOVABLE,t);n.toggleCellStyles(mxConstants.STYLE_RESIZABLE,t);n.toggleCellStyles(mxConstants.STYLE_ROTATABLE,t);n.toggleCellStyles(mxConstants.STYLE_DELETABLE,t);n.toggleCellStyles(mxConstants.STYLE_EDITABLE,t);n.toggleCellStyles("connectable",t)}finally{n.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+L");this.addAction("home",function(){n.home()},null,null,"Home");this.addAction("exitGroup",function(){n.exitGroup()},null,null,Editor.ctrlKey+"+Shift+Home");this.addAction("enterGroup",function(){n.enterGroup()},null,null,Editor.ctrlKey+"+Shift+End");this.addAction("collapse",function(){n.foldCells(!0)},null,null,Editor.ctrlKey+"+Home");this.addAction("expand",function(){n.foldCells(!1)},null,null,Editor.ctrlKey+"+End");this.addAction("toFront",function(){n.orderCells(!1)},null,null,Editor.ctrlKey+"+Shift+F");this.addAction("toBack",function(){n.orderCells(!0)},null,null,Editor.ctrlKey+"+Shift+B");this.addAction("group",function(){n.getSelectionCount()==1?n.setCellStyles("container","1"):n.setSelectionCell(n.groupCells(null,0))},null,null,Editor.ctrlKey+"+G");this.addAction("ungroup",function(){n.getSelectionCount()==1&&n.getModel().getChildCount(n.getSelectionCell())==0?n.setCellStyles("container","0"):n.setSelectionCells(n.ungroupCells())},null,null,Editor.ctrlKey+"+Shift+U");this.addAction("removeFromGroup",function(){n.removeCellsFromParent()});this.addAction("edit",function(){n.isEnabled()&&n.startEditingAtCell()},null,null,"F2/Enter");this.addAction("editData...",function(){var r=n.getSelectionCell()||n.getModel().getRoot(),i;r!=null&&(i=new EditDataDialog(t,r),t.showDialog(i.container,320,320,!0,!1,null,!1),i.init())},null,null,Editor.ctrlKey+"+M");this.addAction("editTooltip...",function(){var n=t.editor.graph,i,r,u,f;n.isEnabled()&&!n.isSelectionEmpty()&&(i=n.getSelectionCell(),r="",mxUtils.isNode(i.value)&&(u=i.value.getAttribute("tooltip"),u!=null&&(r=u)),f=new TextareaDialog(t,mxResources.get("editTooltip")+":",r,function(t){n.setTooltipForCell(i,t)}),t.showDialog(f.container,320,200,!0,!0),f.init())});this.addAction("openLink",function(){var t=n.getLinkForCell(n.getSelectionCell());t!=null&&window.open(t)});this.addAction("editLink...",function(){var n=t.editor.graph,i,r;n.isEnabled()&&!n.isSelectionEmpty()&&(i=n.getSelectionCell(),r=n.getLinkForCell(i)||"",t.showLinkDialog(r,mxResources.get("apply"),function(t){t=mxUtils.trim(t);n.setLinkForCell(i,t.length>0?t:null)}))});this.addAction("insertLink...",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&t.showLinkDialog("",mxResources.get("insert"),function(i,r){var o,s,h,f;if(i=mxUtils.trim(i),i.length>0){var e=null,u=i.substring(i.lastIndexOf("/")+1),c=n.isPageLink(i);c&&(o=i.indexOf(","),o>0&&(s=t.getPageById(i.substring(o+1)),u=s!=null?s.getName():mxResources.get("pageNotFound")));r!=null&&r.length>0&&(e=r[0].iconUrl,u=r[0].name||r[0].type,u=u.charAt(0).toUpperCase()+u.substring(1),u.length>30&&(u=u.substring(0,30)+"..."));h=n.getFreeInsertPoint();f=new mxCell(u,new mxGeometry(h.x,h.y,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+(e!=null?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+e:"spacing=10;"));f.vertex=!0;n.setLinkForCell(f,i);n.cellSizeUpdated(f,!0);n.getModel().beginUpdate();try{f=n.addCell(f);n.fireEvent(new mxEventObject("cellsInserted","cells",[f]))}finally{n.getModel().endUpdate()}n.setSelectionCell(f);n.scrollCellToVisible(n.getSelectionCell())}})}).isEnabled=r;this.addAction("link...",mxUtils.bind(this,function(){var n=t.editor.graph,i,r,u;n.isEnabled()&&(n.cellEditor.isContentEditing()?(i=n.getParentByName(n.getSelectedElement(),"A",n.cellEditor.textarea),r="",i!=null&&(r=i.getAttribute("href")||""),u=n.cellEditor.saveSelection(),t.showLinkDialog(r,mxResources.get("apply"),mxUtils.bind(this,function(t){n.cellEditor.restoreSelection(u);t!=null&&n.insertLink(t)}))):n.isSelectionEmpty()?this.get("insertLink").funct():this.get("editLink").funct())})).isEnabled=r;this.addAction("autosize",function(){var f=n.getSelectionCells(),r,t,u,i;if(f!=null){n.getModel().beginUpdate();try{for(r=0;r<f.length;r++)t=f[r],n.getModel().getChildCount(t)?n.updateGroupBounds([t],20):(u=n.view.getState(t),i=n.getCellGeometry(t),n.getModel().isVertex(t)&&u!=null&&u.text!=null&&i!=null&&n.isWrapping(t)?(i=i.clone(),i.height=u.text.boundingBox.height/n.view.scale,n.getModel().setGeometry(t,i)):n.updateCellSize(t))}finally{n.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+Shift+Y");this.addAction("formattedText",function(){var r=n.getView().getState(n.getSelectionCell()),u,f,i;if(r!=null){u="1";n.stopEditing();n.getModel().beginUpdate();try{r.style.html=="1"?(u=null,i=n.convertValueToString(r.cell),mxUtils.getValue(r.style,"nl2Br","1")!="0"&&(i=i.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n")),f=document.createElement("div"),f.innerHTML=i,i=mxUtils.extractTextWithWhitespace(f.childNodes),n.cellLabelChanged(r.cell,i)):(i=mxUtils.htmlEntities(n.convertValueToString(r.cell),!1),mxUtils.getValue(r.style,"nl2Br","1")!="0"&&(i=i.replace(/\n/g,"<br/>")),n.cellLabelChanged(r.cell,n.sanitizeHtml(i)));n.setCellStyles("html",u);t.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[u!=null?u:"0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}});this.addAction("wordWrap",function(){var t=n.getView().getState(n.getSelectionCell()),i="wrap";n.stopEditing();t!=null&&t.style[mxConstants.STYLE_WHITE_SPACE]=="wrap"&&(i=null);n.setCellStyles(mxConstants.STYLE_WHITE_SPACE,i)});this.addAction("rotation",function(){var i="0",u=n.getView().getState(n.getSelectionCell()),r;u!=null&&(i=u.style[mxConstants.STYLE_ROTATION]||i);r=new FilenameDialog(t,i,mxResources.get("apply"),function(t){t!=null&&t.length>0&&n.setCellStyles(mxConstants.STYLE_ROTATION,t)},mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");t.showDialog(r.container,375,80,!0,!0);r.init()});this.addAction("resetView",function(){n.zoomTo(1);t.resetScrollbars()},null,null,Editor.ctrlKey+"+H");this.addAction("zoomIn",function(){n.zoomIn()},null,null,Editor.ctrlKey+" + (Numpad) / Alt+Mousewheel");this.addAction("zoomOut",function(){n.zoomOut()},null,null,Editor.ctrlKey+" - (Numpad) / Alt+Mousewheel");this.addAction("fitWindow",function(){n.fit()},null,null,Editor.ctrlKey+"+Shift+H");this.addAction("fitPage",mxUtils.bind(this,function(){var t;n.pageVisible||this.get("pageView").funct();var i=n.pageFormat,r=n.pageScale,u=n.container.clientWidth-10,f=n.container.clientHeight-10,e=Math.floor(20*Math.min(u/i.width/r,f/i.height/r))/20;n.zoomTo(e);mxUtils.hasScrollbars(n.container)&&(t=n.getPagePadding(),n.container.scrollTop=t.y*n.view.scale,n.container.scrollLeft=Math.min(t.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2))}),null,null,Editor.ctrlKey+"+J");this.addAction("fitTwoPages",mxUtils.bind(this,function(){var t;n.pageVisible||this.get("pageView").funct();var i=n.pageFormat,r=n.pageScale,u=n.container.clientWidth-10,f=n.container.clientHeight-10,e=Math.floor(20*Math.min(u/(2*i.width)/r,f/i.height/r))/20;n.zoomTo(e);mxUtils.hasScrollbars(n.container)&&(t=n.getPagePadding(),n.container.scrollTop=Math.min(t.y,(n.container.scrollHeight-n.container.clientHeight)/2),n.container.scrollLeft=Math.min(t.x,(n.container.scrollWidth-n.container.clientWidth)/2))}),null,null,Editor.ctrlKey+"+Shift+J");this.addAction("fitPageWidth",mxUtils.bind(this,function(){var t;n.pageVisible||this.get("pageView").funct();var i=n.pageFormat,r=n.pageScale,u=n.container.clientWidth-10,f=Math.floor(20*u/i.width/r)/20;n.zoomTo(f);mxUtils.hasScrollbars(n.container)&&(t=n.getPagePadding(),n.container.scrollLeft=Math.min(t.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2))}));this.put("customZoom",new Action(mxResources.get("custom")+"...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(n.getView().getScale()*100),mxResources.get("apply"),mxUtils.bind(this,function(t){var i=parseInt(t);!isNaN(i)&&i>0&&n.zoomTo(i/100)}),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0);t.init()}),null,null,Editor.ctrlKey+"+0"));this.addAction("pageScale...",mxUtils.bind(this,function(){var i=new FilenameDialog(this.editorUi,parseInt(n.pageScale*100),mxResources.get("apply"),mxUtils.bind(this,function(n){var i=parseInt(n);!isNaN(i)&&i>0&&t.setPageScale(i/100)}),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(i.container,300,80,!0,!0);i.init()}));i=null;i=this.addAction("grid",function(){n.setGridEnabled(!n.isGridEnabled());t.fireEvent(new mxEventObject("gridEnabledChanged"))},null,null,Editor.ctrlKey+"+Shift+G");i.setToggleAction(!0);i.setSelectedCallback(function(){return n.isGridEnabled()});i.setEnabled(!1);i=this.addAction("guides",function(){n.graphHandler.guidesEnabled=!n.graphHandler.guidesEnabled;t.fireEvent(new mxEventObject("guidesEnabledChanged"))});i.setToggleAction(!0);i.setSelectedCallback(function(){return n.graphHandler.guidesEnabled});i.setEnabled(!1);i=this.addAction("tooltips",function(){n.tooltipHandler.setEnabled(!n.tooltipHandler.isEnabled())});i.setToggleAction(!0);i.setSelectedCallback(function(){return n.tooltipHandler.isEnabled()});i=this.addAction("collapseExpand",function(){var i=new ChangePageSetup(t);i.ignoreColor=!0;i.ignoreImage=!0;i.foldingEnabled=!n.foldingEnabled;n.model.execute(i)});i.setToggleAction(!0);i.setSelectedCallback(function(){return n.foldingEnabled});i.isEnabled=r;i=this.addAction("scrollbars",function(){t.setScrollbars(!t.hasScrollbars())});i.setToggleAction(!0);i.setSelectedCallback(function(){return n.scrollbars});i=this.addAction("pageView",mxUtils.bind(this,function(){t.setPageVisible(!n.pageVisible)}));i.setToggleAction(!0);i.setSelectedCallback(function(){return n.pageVisible});i=this.addAction("connectionArrows",function(){n.connectionArrowsEnabled=!n.connectionArrowsEnabled;t.fireEvent(new mxEventObject("connectionArrowsChanged"))},null,null,"Alt+Shift+A");i.setToggleAction(!0);i.setSelectedCallback(function(){return n.connectionArrowsEnabled});i=this.addAction("connectionPoints",function(){n.setConnectable(!n.connectionHandler.isEnabled());t.fireEvent(new mxEventObject("connectionPointsChanged"))},null,null,"Alt+Shift+P");i.setToggleAction(!0);i.setSelectedCallback(function(){return n.connectionHandler.isEnabled()});i=this.addAction("copyConnect",function(){n.connectionHandler.setCreateTarget(!n.connectionHandler.isCreateTarget());t.fireEvent(new mxEventObject("copyConnectChanged"))});i.setToggleAction(!0);i.setSelectedCallback(function(){return n.connectionHandler.isCreateTarget()});i.isEnabled=r;i=this.addAction("autosave",function(){t.editor.setAutosave(!t.editor.autosave)});i.setToggleAction(!0);i.setSelectedCallback(function(){return t.editor.autosave});i.isEnabled=r;i.visible=!1;this.addAction("help",function(){var n="";mxResources.isLanguageSupported(mxClient.language)&&(n="_"+mxClient.language);window.open(RESOURCES_PATH+"/help"+n+".html")});f=!1;this.put("about",new Action(mxResources.get("about")+" 流程设计器...",function(){f||(t.showDialog(new AboutDialog(t).container,320,280,!0,!0,function(){f=!1}),f=!0)},null,null,"F1"));e=mxUtils.bind(this,function(t,i,r,u){return this.addAction(t,function(){if(r!=null&&n.cellEditor.isContentEditing())r();else{n.stopEditing(!1);n.getModel().beginUpdate();try{n.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,i);(i&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?n.updateLabelElements(n.getSelectionCells(),function(t){t.style.fontWeight=null;t.nodeName=="B"&&n.replaceElement(t)}):(i&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?n.updateLabelElements(n.getSelectionCells(),function(t){t.style.fontStyle=null;t.nodeName=="I"&&n.replaceElement(t)}):(i&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&n.updateLabelElements(n.getSelectionCells(),function(t){t.style.textDecoration=null;t.nodeName=="U"&&n.replaceElement(t)})}finally{n.getModel().endUpdate()}}},null,null,u)});e("bold",mxConstants.FONT_BOLD,function(){document.execCommand("bold",!1,null)},Editor.ctrlKey+"+B");e("italic",mxConstants.FONT_ITALIC,function(){document.execCommand("italic",!1,null)},Editor.ctrlKey+"+I");e("underline",mxConstants.FONT_UNDERLINE,function(){document.execCommand("underline",!1,null)},Editor.ctrlKey+"+U");this.addAction("fontColor...",function(){t.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")});this.addAction("strokeColor...",function(){t.menus.pickColor(mxConstants.STYLE_STROKECOLOR)});this.addAction("fillColor...",function(){t.menus.pickColor(mxConstants.STYLE_FILLCOLOR)});this.addAction("gradientColor...",function(){t.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)});this.addAction("backgroundColor...",function(){t.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")});this.addAction("borderColor...",function(){t.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)});this.addAction("vertical",function(){t.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,!0)});this.addAction("shadow",function(){t.menus.toggleStyle(mxConstants.STYLE_SHADOW)});this.addAction("solid",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,null);n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null);t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("dashed",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1");n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null);t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("dotted",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1");n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4");t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("sharp",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0");n.setCellStyles(mxConstants.STYLE_CURVED,"0");t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("rounded",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"1");n.setCellStyles(mxConstants.STYLE_CURVED,"0");t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("toggleRounded",function(){if(!n.isSelectionEmpty()&&n.isEnabled()){n.getModel().beginUpdate();try{var i=n.getSelectionCells(),r=n.view.getState(i[0]),f=r!=null?r.style:n.getCellStyle(i[0]),u=mxUtils.getValue(f,mxConstants.STYLE_ROUNDED,"0")=="1"?"0":"1";n.setCellStyles(mxConstants.STYLE_ROUNDED,u);n.setCellStyles(mxConstants.STYLE_CURVED,null);t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[u,"0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}});this.addAction("curved",function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0");n.setCellStyles(mxConstants.STYLE_CURVED,"1");t.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}});this.addAction("collapsible",function(){var r=n.view.getState(n.getSelectionCell()),i="1";r!=null&&n.getFoldingImage(r)!=null&&(i="0");n.setCellStyles("collapsible",i);t.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[i],"cells",n.getSelectionCells()))});this.addAction("editStyle...",mxUtils.bind(this,function(){var t=n.getSelectionCells(),r,i;t!=null&&t.length>0&&(r=n.getModel(),i=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",r.getStyle(t[0])||"",function(i){i!=null&&n.setCellStyle(mxUtils.trim(i),t)},null,null,400,220),this.editorUi.showDialog(i.container,420,300,!0,!0),i.init())}),null,null,Editor.ctrlKey+"+E");this.addAction("setAsDefaultStyle",function(){n.isEnabled()&&!n.isSelectionEmpty()&&t.setDefaultStyle(n.getSelectionCell())},null,null,Editor.ctrlKey+"+Shift+D");this.addAction("clearDefaultStyle",function(){n.isEnabled()&&t.clearDefaultStyle()},null,null,Editor.ctrlKey+"+Shift+R");this.addAction("addWaypoint",function(){var i=n.getSelectionCell(),r,c,l;if(i!=null&&n.getModel().isEdge(i)&&(r=u.graph.selectionCellsHandler.getHandler(i),r instanceof mxEdgeHandler)){for(var e=n.view.translate,o=n.view.scale,s=e.x,h=e.y,t=n.getModel().getParent(i),f=n.getCellGeometry(t);n.getModel().isVertex(t)&&f!=null;)s+=f.x,h+=f.y,t=n.getModel().getParent(t),f=n.getCellGeometry(t);c=Math.round(n.snap(n.popupMenuHandler.triggerX/o-s));l=Math.round(n.snap(n.popupMenuHandler.triggerY/o-h));r.addPointAt(r.state,c,l)}});this.addAction("removeWaypoint",function(){var n=t.actions.get("removeWaypoint");n.handler!=null&&n.handler.removePoint(n.handler.state,n.index)});this.addAction("clearWaypoints",function(){var i=n.getSelectionCells(),r,u,t;if(i!=null){i=n.addAllEdges(i);n.getModel().beginUpdate();try{for(r=0;r<i.length;r++)u=i[r],n.getModel().isEdge(u)&&(t=n.getCellGeometry(u),t!=null&&(t=t.clone(),t.points=null,n.getModel().setGeometry(u,t)))}finally{n.getModel().endUpdate()}}},null,null,"Alt+Shift+C");i=this.addAction("subscript",mxUtils.bind(this,function(){n.cellEditor.isContentEditing()&&document.execCommand("subscript",!1,null)}),null,null,Editor.ctrlKey+"+,");i=this.addAction("superscript",mxUtils.bind(this,function(){n.cellEditor.isContentEditing()&&document.execCommand("superscript",!1,null)}),null,null,Editor.ctrlKey+"+.");this.addAction("image...",function(){var u;if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){var f=mxResources.get("image")+" ("+mxResources.get("url")+"):",r=n.getView().getState(n.getSelectionCell()),i="";r!=null&&(i=r.style[mxConstants.STYLE_IMAGE]||i);u=n.cellEditor.saveSelection();t.showImageDialog(f,i,function(t,i,r){var f,o,s,h,c,l,e;if(n.cellEditor.isContentEditing())n.cellEditor.restoreSelection(u),n.insertImage(t,i,r);else if(f=n.getSelectionCells(),t!=null&&(t.length>0||f.length>0)){o=null;n.getModel().beginUpdate();try{f.length==0&&(s=n.getFreeInsertPoint(),f=[n.insertVertex(n.getDefaultParent(),null,"",s.x,s.y,i,r,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")],o=f,n.fireEvent(new mxEventObject("cellsInserted","cells",o)));n.setCellStyles(mxConstants.STYLE_IMAGE,t.length>0?t:null,f);h=n.view.getState(f[0]);c=h!=null?h.style:n.getCellStyle(f[0]);c[mxConstants.STYLE_SHAPE]!="image"&&c[mxConstants.STYLE_SHAPE]!="label"?n.setCellStyles(mxConstants.STYLE_SHAPE,"image",f):t.length==0&&n.setCellStyles(mxConstants.STYLE_SHAPE,null,f);n.getSelectionCount()==1&&i!=null&&r!=null&&(l=f[0],e=n.getModel().getGeometry(l),e!=null&&(e=e.clone(),e.width=i,e.height=r,n.getModel().setGeometry(l,e)))}finally{n.getModel().endUpdate()}o!=null&&(n.setSelectionCells(o),n.scrollCellToVisible(o[0]))}},n.cellEditor.isContentEditing(),!n.cellEditor.isContentEditing())}}).isEnabled=r;this.addAction("insertImage...",function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&(n.clearSelection(),t.actions.get("image").funct())}).isEnabled=r;i=this.addAction("layers",mxUtils.bind(this,function(){this.layersWindow==null?(this.layersWindow=new LayersWindow(t,document.body.offsetWidth-280,120,220,180),this.layersWindow.window.addListener("show",function(){t.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.addListener("hide",function(){t.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.setVisible(!0),t.fireEvent(new mxEventObject("layers"))):this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())}),null,null,Editor.ctrlKey+"+Shift+L");i.setToggleAction(!0);i.setSelectedCallback(mxUtils.bind(this,function(){return this.layersWindow!=null&&this.layersWindow.window.isVisible()}));i=this.addAction("formatPanel",mxUtils.bind(this,function(){t.toggleFormatPanel()}),null,null,Editor.ctrlKey+"+Shift+P");i.setToggleAction(!0);i.setSelectedCallback(mxUtils.bind(this,function(){return t.formatWidth>0}));i=this.addAction("outline",mxUtils.bind(this,function(){this.outlineWindow==null?(this.outlineWindow=new OutlineWindow(t,document.body.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",function(){t.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.addListener("hide",function(){t.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.setVisible(!0),t.fireEvent(new mxEventObject("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible())}),null,null,Editor.ctrlKey+"+Shift+O");i.setToggleAction(!0);i.setSelectedCallback(mxUtils.bind(this,function(){return this.outlineWindow!=null&&this.outlineWindow.window.isVisible()}))};Actions.prototype.addAction=function(n,t,i,r,u){var f;return n.substring(n.length-3)=="..."?(n=n.substring(0,n.length-3),f=mxResources.get(n)+"..."):f=mxResources.get(n),this.put(n,new Action(f,t,i,r,u))};Actions.prototype.put=function(n,t){return this.actions[n]=t,t};Actions.prototype.get=function(n){return this.actions[n]};mxUtils.extend(Action,mxEventSource);Action.prototype.createFunction=function(n){return n};Action.prototype.setEnabled=function(n){this.enabled!=n&&(this.enabled=n,this.fireEvent(new mxEventObject("stateChanged")))};Action.prototype.isEnabled=function(){return this.enabled};Action.prototype.setToggleAction=function(n){this.toggleAction=n};Action.prototype.setSelectedCallback=function(n){this.selectedCallback=n};Action.prototype.isSelected=function(){return this.selectedCallback()};Menus=function(n){this.editorUi=n;this.menus={};this.init();mxClient.IS_SVG||((new Image).src=this.checkmarkImage)};Menus.prototype.defaultFont="Helvetica";Menus.prototype.defaultFontSize="12";Menus.prototype.defaultMenuItems=["file","extras","help"];Menus.prototype.defaultFonts=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"];Menus.prototype.init=function(){var n=this.editorUi.editor.graph,t=mxUtils.bind(n,n.isEnabled);this.customFonts=[];this.customFontSizes=[];this.put("fontFamily",new Menu(mxUtils.bind(this,function(t,i){for(var u=mxUtils.bind(this,function(r){var u=this.styleChange(t,r,[mxConstants.STYLE_FONTFAMILY],[r],null,i,function(){document.execCommand("fontname",!1,r)},function(){n.updateLabelElements(n.getSelectionCells(),function(t){t.removeAttribute("face");t.style.fontFamily=null;t.nodeName=="PRE"&&n.replaceElement(t,"div")})});u.firstChild.nextSibling.style.fontFamily=r}),r=0;r<this.defaultFonts.length;r++)u(this.defaultFonts[r]);if(t.addSeparator(i),this.customFonts.length>0){for(r=0;r<this.customFonts.length;r++)u(this.customFonts[r]);t.addSeparator(i);t.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFonts=[]}),i);t.addSeparator(i)}this.promptChange(t,mxResources.get("custom")+"...","",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,i,!0,mxUtils.bind(this,function(n){this.customFonts.push(n)}))})));this.put("formatBlock",new Menu(mxUtils.bind(this,function(t,i){function r(r,u){return t.addItem(r,null,mxUtils.bind(this,function(){n.cellEditor.textarea.focus();document.execCommand("formatBlock",!1,"<"+u+">")}),i)}r(mxResources.get("normal"),"p");r("","h1").firstChild.nextSibling.innerHTML='<h1 style="margin:0px;">'+mxResources.get("heading")+" 1<\/h1>";r("","h2").firstChild.nextSibling.innerHTML='<h2 style="margin:0px;">'+mxResources.get("heading")+" 2<\/h2>";r("","h3").firstChild.nextSibling.innerHTML='<h3 style="margin:0px;">'+mxResources.get("heading")+" 3<\/h3>";r("","h4").firstChild.nextSibling.innerHTML='<h4 style="margin:0px;">'+mxResources.get("heading")+" 4<\/h4>";r("","h5").firstChild.nextSibling.innerHTML='<h5 style="margin:0px;">'+mxResources.get("heading")+" 5<\/h5>";r("","h6").firstChild.nextSibling.innerHTML='<h6 style="margin:0px;">'+mxResources.get("heading")+" 6<\/h6>";r("","pre").firstChild.nextSibling.innerHTML='<pre style="margin:0px;">'+mxResources.get("formatted")+"<\/pre>";r("","blockquote").firstChild.nextSibling.innerHTML='<blockquote style="margin-top:0px;margin-bottom:0px;">'+mxResources.get("blockquote")+"<\/blockquote>"})));this.put("fontSize",new Menu(mxUtils.bind(this,function(t,i){for(var u=[6,8,9,10,11,12,14,18,24,36,48,72],f=mxUtils.bind(this,function(r){this.styleChange(t,r,[mxConstants.STYLE_FONTSIZE],[r],null,i,function(){var i,t;for(document.execCommand("fontSize",!1,"3"),i=n.cellEditor.textarea.getElementsByTagName("font"),t=0;t<i.length;t++)if(i[t].getAttribute("size")=="3"){i[t].removeAttribute("size");i[t].style.fontSize=r+"px";break}})}),r=0;r<u.length;r++)f(u[r]);if(t.addSeparator(i),this.customFontSizes.length>0){for(r=0;r<this.customFontSizes.length;r++)f(this.customFontSizes[r]);t.addSeparator(i);t.addItem(mxResources.get("reset"),null,mxUtils.bind(this,function(){this.customFontSizes=[]}),i);t.addSeparator(i)}this.promptChange(t,mxResources.get("custom")+"...","(pt)","12",mxConstants.STYLE_FONTSIZE,i,!0,mxUtils.bind(this,function(n){this.customFontSizes.push(n)}))})));this.put("direction",new Menu(mxUtils.bind(this,function(t,i){t.addItem(mxResources.get("flipH"),null,function(){n.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)},i);t.addItem(mxResources.get("flipV"),null,function(){n.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)},i);this.addMenuItems(t,["-","rotation"],i)})));this.put("align",new Menu(mxUtils.bind(this,function(t,i){t.addItem(mxResources.get("leftAlign"),null,function(){n.alignCells(mxConstants.ALIGN_LEFT)},i);t.addItem(mxResources.get("center"),null,function(){n.alignCells(mxConstants.ALIGN_CENTER)},i);t.addItem(mxResources.get("rightAlign"),null,function(){n.alignCells(mxConstants.ALIGN_RIGHT)},i);t.addSeparator(i);t.addItem(mxResources.get("topAlign"),null,function(){n.alignCells(mxConstants.ALIGN_TOP)},i);t.addItem(mxResources.get("middle"),null,function(){n.alignCells(mxConstants.ALIGN_MIDDLE)},i);t.addItem(mxResources.get("bottomAlign"),null,function(){n.alignCells(mxConstants.ALIGN_BOTTOM)},i)})));this.put("distribute",new Menu(mxUtils.bind(this,function(t,i){t.addItem(mxResources.get("horizontal"),null,function(){n.distributeCells(!0)},i);t.addItem(mxResources.get("vertical"),null,function(){n.distributeCells(!1)},i)})));this.put("layout",new Menu(mxUtils.bind(this,function(t,i){var r=mxUtils.bind(this,function(n,t){var i=new FilenameDialog(this.editorUi,n,mxResources.get("apply"),function(n){t(parseFloat(n))},mxResources.get("spacing"));this.editorUi.showDialog(i.container,300,80,!0,!0);i.init()});t.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,function(){var t=new mxHierarchicalLayout(n,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout(function(){var i=n.getSelectionCells();t.execute(n.getDefaultParent(),i.length==0?null:i)},!0)}),i);t.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,function(){var t=new mxHierarchicalLayout(n,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout(function(){var i=n.getSelectionCells();t.execute(n.getDefaultParent(),i.length==0?null:i)},!0)}),i);t.addSeparator(i);t.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,function(){var t=n.getSelectionCell(),u=null,i;t==null||n.getModel().getChildCount(t)==0?n.getModel().getEdgeCount(t)==0&&(u=n.findTreeRoots(n.getDefaultParent())):u=n.findTreeRoots(t);u!=null&&u.length>0&&(t=u[0]);t!=null&&(i=new mxCompactTreeLayout(n,!0),i.edgeRouting=!1,i.levelDistance=30,r(i.levelDistance,mxUtils.bind(this,function(r){i.levelDistance=r;this.editorUi.executeLayout(function(){i.execute(n.getDefaultParent(),t)},!0)})))}),i);t.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,function(){var t=n.getSelectionCell(),u=null,i;t==null||n.getModel().getChildCount(t)==0?n.getModel().getEdgeCount(t)==0&&(u=n.findTreeRoots(n.getDefaultParent())):u=n.findTreeRoots(t);u!=null&&u.length>0&&(t=u[0]);t!=null&&(i=new mxCompactTreeLayout(n,!1),i.edgeRouting=!1,i.levelDistance=30,r(i.levelDistance,mxUtils.bind(this,function(r){i.levelDistance=r;this.editorUi.executeLayout(function(){i.execute(n.getDefaultParent(),t)},!0)})))}),i);t.addItem(mxResources.get("radialTree"),null,mxUtils.bind(this,function(){var t=n.getSelectionCell(),u=null,i;t==null||n.getModel().getChildCount(t)==0?n.getModel().getEdgeCount(t)==0&&(u=n.findTreeRoots(n.getDefaultParent())):u=n.findTreeRoots(t);u!=null&&u.length>0&&(t=u[0]);t!=null&&(i=new mxRadialTreeLayout(n,!1),i.levelDistance=80,i.autoRadius=!0,r(i.levelDistance,mxUtils.bind(this,function(r){i.levelDistance=r;this.editorUi.executeLayout(function(){i.execute(n.getDefaultParent(),t);n.isSelectionEmpty()||(t=n.getModel().getParent(t),n.getModel().isVertex(t)&&n.updateGroupBounds([t],n.gridSize*2,!0))},!0)})))}),i);t.addSeparator(i);t.addItem(mxResources.get("organic"),null,mxUtils.bind(this,function(){var t=new mxFastOrganicLayout(n);r(t.forceConstant,mxUtils.bind(this,function(i){t.forceConstant=i;this.editorUi.executeLayout(function(){var i=n.getSelectionCell();(i==null||n.getModel().getChildCount(i)==0)&&(i=n.getDefaultParent());t.execute(i);n.getModel().isVertex(i)&&n.updateGroupBounds([i],n.gridSize*2,!0)},!0)}))}),i);t.addItem(mxResources.get("circle"),null,mxUtils.bind(this,function(){var t=new mxCircleLayout(n);this.editorUi.executeLayout(function(){var i=n.getSelectionCell();(i==null||n.getModel().getChildCount(i)==0)&&(i=n.getDefaultParent());t.execute(i);n.getModel().isVertex(i)&&n.updateGroupBounds([i],n.gridSize*2,!0)},!0)}),i)})));this.put("navigation",new Menu(mxUtils.bind(this,function(n,t){this.addMenuItems(n,["home","-","exitGroup","enterGroup","-","expand","collapse","-","collapsible"],t)})));this.put("arrange",new Menu(mxUtils.bind(this,function(n,t){this.addMenuItems(n,["toFront","toBack","-"],t);this.addSubmenu("direction",n,t);this.addMenuItems(n,["turn","-"],t);this.addSubmenu("align",n,t);this.addSubmenu("distribute",n,t);n.addSeparator(t);this.addSubmenu("navigation",n,t);this.addSubmenu("insert",n,t);this.addSubmenu("layout",n,t);this.addMenuItems(n,["-","group","ungroup","removeFromGroup","-","clearWaypoints","autosize"],t)}))).isEnabled=t;this.put("insert",new Menu(mxUtils.bind(this,function(n,t){this.addMenuItems(n,["insertLink","insertImage"],t)})));this.put("view",new Menu(mxUtils.bind(this,function(n,t){this.addMenuItems(n,(this.editorUi.format!=null?["formatPanel"]:[]).concat(["outline","layers","-","pageView","pageScale","-","scrollbars","tooltips","-","grid","guides","-","connectionArrows","connectionPoints","-","resetView","zoomIn","zoomOut"],t))})));this.put("viewPanels",new Menu(mxUtils.bind(this,function(n,t){this.editorUi.format!=null&&this.addMenuItems(n,["formatPanel"],t);this.addMenuItems(n,["outline","layers"],t)})));this.put("viewZoom",new Menu(mxUtils.bind(this,function(t,i){var u,r;for(this.addMenuItems(t,["resetView","-"],i),u=[.25,.5,.75,1,1.25,1.5,2,3,4],r=0;r<u.length;r++)(function(r){t.addItem(r*100+"%",null,function(){n.zoomTo(r)},i)})(u[r]);this.addMenuItems(t,["-","fitWindow","fitPageWidth","fitPage","fitTwoPages","-","customZoom"],i)})));this.put("file",new Menu(mxUtils.bind(this,function(n,t){this.addMenuItems(n,["new","-","save","saveAs","-","import","-","pageSetup","print"],t)})));this.put("edit",new Menu(mxUtils.bind(this,function(n){this.addMenuItems(n,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editData","editTooltip","editStyle","-","edit","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","selectNone","-","lockUnlock"])})));this.put("extras",new Menu(mxUtils.bind(this,function(n){this.addMenuItems(n,["editDiagram"])})));this.put("help",new Menu(mxUtils.bind(this,function(n){this.addMenuItems(n,["about"])})))};Menus.prototype.put=function(n,t){return this.menus[n]=t,t};Menus.prototype.get=function(n){return this.menus[n]};Menus.prototype.addSubmenu=function(n,t,i){var r=this.get(n).isEnabled(),u;(t.showDisabled||r)&&(u=t.addItem(mxResources.get(n),null,null,i,null,r),this.addMenu(n,t,u))};Menus.prototype.addMenu=function(n,t,i){var r=this.get(n);r!=null&&(t.showDisabled||r.isEnabled())&&this.get(n).execute(t,i)};Menus.prototype.addInsertTableItem=function(n){function e(n,t){for(var r,i=["<table>"],u=0;u<n;u++){for(i.push("<tr>"),r=0;r<t;r++)i.push("<td><br><\/td>");i.push("<\/tr>")}return i.push("<\/table>"),i.join("")}function o(n,t){var i=document.createElement("table"),r,e,u,o;for(i.setAttribute("border","1"),i.style.borderCollapse="collapse",mxClient.IS_QUIRKS||i.setAttribute("cellPadding","8"),r=0;r<n;r++)for(e=i.insertRow(r),u=0;u<t;u++)o=e.insertCell(-1),mxClient.IS_QUIRKS&&(o.innerHTML=f);return i}function s(n,t,i){for(var e,u,o,r=n.rows.length;r<t;r++)for(e=n.insertRow(r),u=0;u<n.rows[0].cells.length;u++)o=e.insertCell(-1),mxClient.IS_QUIRKS&&(o.innerHTML=f);for(r=0;r<n.rows.length;r++)for(e=n.rows[r],u=e.cells.length;u<i;u++)o=e.insertCell(-1),mxClient.IS_QUIRKS&&(o.innerHTML=f)}var t=this.editorUi.editor.graph,u=n.addItem("",null,mxUtils.bind(this,function(n){var u=t.getParentByName(mxEvent.getSource(n),"TD"),r,i;if(u!=null){var s=t.getParentByName(u,"TR"),o=t.cellEditor.textarea.getElementsByTagName("table"),f=[];for(i=0;i<o.length;i++)f.push(o[i]);if(t.container.focus(),t.pasteHtmlAtCaret(e(s.sectionRowIndex+1,u.cellIndex+1)),r=t.cellEditor.textarea.getElementsByTagName("table"),r.length==f.length+1)for(i=r.length-1;i>=0;i--)if(i==0||r[i]!=f[i-1]){t.selectNode(r[i].rows[0].cells[0]);break}}})),f='<img src="'+mxClient.imageBasePath+'/transparent.gif" width="16" height="16"/>',i,r;u.firstChild.innerHTML="";i=o(5,5);u.firstChild.appendChild(i);r=document.createElement("div");r.style.padding="4px";r.style.fontSize=Menus.prototype.defaultFontSize+"px";r.innerHTML="1x1";u.firstChild.appendChild(r);mxEvent.addListener(i,"mouseover",function(n){var u=t.getParentByName(mxEvent.getSource(n),"TD"),o,f,h,e,c;if(u!=null){for(o=t.getParentByName(u,"TR"),s(i,Math.min(20,o.sectionRowIndex+2),Math.min(20,u.cellIndex+2)),r.innerHTML=u.cellIndex+1+"x"+(o.sectionRowIndex+1),f=0;f<i.rows.length;f++)for(h=i.rows[f],e=0;e<h.cells.length;e++)c=h.cells[e],c.style.backgroundColor=f<=o.sectionRowIndex&&e<=u.cellIndex?"blue":"white";mxEvent.consume(n)}})};Menus.prototype.edgeStyleChange=function(n,t,i,r,u,f,e){return n.addItem(t,null,mxUtils.bind(this,function(){var n=this.editorUi.editor.graph,s,h,o,t,u,f;n.stopEditing(!1);n.getModel().beginUpdate();try{for(s=n.getSelectionCells(),h=[],o=0;o<s.length;o++)if(t=s[o],n.getModel().isEdge(t)){for(e&&(u=n.getCellGeometry(t),u!=null&&(u=u.clone(),u.points=null,n.getModel().setGeometry(t,u))),f=0;f<i.length;f++)n.setCellStyles(i[f],r[f],[t]);h.push(t)}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",i,"values",r,"cells",h))}finally{n.getModel().endUpdate()}}),f,u)};Menus.prototype.styleChange=function(n,t,i,r,u,f,e,o){var s=this.createStyleChangeFunction(i,r);return n.addItem(t,null,mxUtils.bind(this,function(){var n=this.editorUi.editor.graph;e!=null&&n.cellEditor.isContentEditing()?e():s(o)}),f,u)};Menus.prototype.createStyleChangeFunction=function(n,t){return mxUtils.bind(this,function(i){var r=this.editorUi.editor.graph,u;r.stopEditing(!1);r.getModel().beginUpdate();try{for(u=0;u<n.length;u++)r.setCellStyles(n[u],t[u]);i!=null&&i();this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",n,"values",t,"cells",r.getSelectionCells()))}finally{r.getModel().endUpdate()}})};Menus.prototype.promptChange=function(n,t,i,r,u,f,e,o,s){return n.addItem(t,null,mxUtils.bind(this,function(){var n=this.editorUi.editor.graph,t=r,e=n.getView().getState(n.getSelectionCell()),f;e!=null&&(t=e.style[u]||t);f=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),mxUtils.bind(this,function(t){if(t!=null&&t.length>0){n.getModel().beginUpdate();try{n.stopEditing(!1);n.setCellStyles(u,t)}finally{n.getModel().endUpdate()}o!=null&&o(t)}}),mxResources.get("enterValue")+(i.length>0?" "+i:""));this.editorUi.showDialog(f.container,300,80,!0,!0);f.init()}),f,s,e)};Menus.prototype.pickColor=function(n,t,i){var r=this.editorUi.editor.graph,f,e,o,u;t!=null&&r.cellEditor.isContentEditing()?(f=r.cellEditor.saveSelection(),e=new ColorDialog(this.editorUi,i||"000000",mxUtils.bind(this,function(n){r.cellEditor.restoreSelection(f);document.execCommand(t,!1,n!=mxConstants.NONE?n:"transparent")}),function(){r.cellEditor.restoreSelection(f)}),this.editorUi.showDialog(e.container,230,430,!0,!0),e.init()):(this.colorDialog==null&&(this.colorDialog=new ColorDialog(this.editorUi)),this.colorDialog.currentColorKey=n,o=r.getView().getState(r.getSelectionCell()),u="none",o!=null&&(u=o.style[n]||u),u=="none"?(u="ffffff",this.colorDialog.picker.fromString("ffffff"),this.colorDialog.colorInput.value="none"):this.colorDialog.picker.fromString(u),this.editorUi.showDialog(this.colorDialog.container,230,430,!0,!0),this.colorDialog.init())};Menus.prototype.toggleStyle=function(n,t){var i=this.editorUi.editor.graph,r=i.toggleCellStyles(n,t);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[n],"values",[r],"cells",i.getSelectionCells()))};Menus.prototype.addMenuItem=function(n,t,i,r,u){var f=this.editorUi.actions.get(t),e;return f!=null&&(n.showDisabled||f.isEnabled())&&f.visible?(e=n.addItem(f.label,null,function(){f.funct(r)},i,u,f.isEnabled()),f.toggleAction&&f.isSelected()&&n.addCheckmark(e,Editor.checkmarkImage),this.addShortcut(e,f),e):null};Menus.prototype.addShortcut=function(n,t){if(t.shortcut!=null){var r=n.firstChild.nextSibling.nextSibling,i=document.createElement("span");i.style.color="gray";mxUtils.write(i,t.shortcut);r.appendChild(i)}};Menus.prototype.addMenuItems=function(n,t,i,r,u){for(var f=0;f<t.length;f++)t[f]=="-"?n.addSeparator(i):this.addMenuItem(n,t[f],i,r,u!=null?u[f]:null)};Menus.prototype.createPopupMenu=function(n,t,i){var r=this.editorUi.editor.graph,f,s,u,h,e,c,o;n.smartSeparators=!0;r.isSelectionEmpty()?this.addMenuItems(n,["undo","redo","pasteHere"],null,i):this.addMenuItems(n,["delete","-","cut","copy","-","duplicate"],null,i);r.isSelectionEmpty()?this.addMenuItems(n,["-","selectVertices","selectEdges","selectAll","-","clearDefaultStyle"],null,i):(r.getSelectionCount()==1&&this.addMenuItems(n,["setAsDefaultStyle"],null,i),n.addSeparator(),t=r.getSelectionCell(),f=r.view.getState(t),f!=null&&(s=!1,this.addMenuItems(n,["toFront","toBack","-"],null,i),r.getModel().isEdge(t)&&mxUtils.getValue(f.style,mxConstants.STYLE_EDGE,null)!="entityRelationEdgeStyle"&&mxUtils.getValue(f.style,mxConstants.STYLE_SHAPE,null)!="arrow"&&(u=r.selectionCellsHandler.getHandler(t),h=!1,u instanceof mxEdgeHandler&&u.bends!=null&&u.bends.length>2&&(e=u.getHandleForEvent(r.updateMouseEvent(new mxMouseEvent(i))),c=this.editorUi.actions.get("removeWaypoint"),c.handler=u,c.index=e,h=e>0&&e<u.bends.length-1),this.addMenuItems(n,["-",h?"removeWaypoint":"addWaypoint"],null,i),o=r.getModel().getGeometry(t),s=o!=null&&o.points!=null&&o.points.length>0),r.getSelectionCount()==1&&(s||r.getModel().isVertex(t)&&r.getModel().getEdgeCount(t)>0)&&this.addMenuItems(n,["clearWaypoints"],null,i),r.getSelectionCount()>1?(n.addSeparator(),this.addMenuItems(n,["group"],null,i)):r.getSelectionCount()==1&&!r.getModel().isEdge(t)&&!r.isSwimlane(t)&&r.getModel().getChildCount(t)>0&&(n.addSeparator(),this.addMenuItems(n,["ungroup"],null,i)),r.getSelectionCount()==1&&(n.addSeparator(),this.addMenuItems(n,["edit","-","editData","editLink"],null,i),r.getModel().isVertex(t)&&mxUtils.getValue(f.style,mxConstants.STYLE_IMAGE,null)!=null&&(n.addSeparator(),this.addMenuItem(n,"image",null,i).firstChild.nextSibling.innerHTML=mxResources.get("editImage")+"..."))))};Menus.prototype.createMenubar=function(n){for(var r=new Menubar(this.editorUi,n),i=this.defaultMenuItems,t=0;t<i.length;t++)mxUtils.bind(this,function(n){var u=r.addMenu(mxResources.get(i[t]),mxUtils.bind(this,function(){n.funct.apply(this,arguments)}));this.menuCreated(n,u)})(this.get(i[t]));return r};Menus.prototype.menuCreated=function(n,t){t!=null&&n.addListener("stateChanged",function(){t.enabled=n.enabled;n.enabled?(t.className="geItem",document.documentMode==8&&(t.style.color="")):(t.className="geItem mxDisabled",document.documentMode==8&&(t.style.color="#c3c3c3"))})};Menubar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()};Menubar.prototype.addMenu=function(n,t){var i=document.createElement("a");return i.setAttribute("href","javascript:void(0);"),i.className="geItem",mxUtils.write(i,n),this.addMenuHandler(i,t),this.container.appendChild(i),i};Menubar.prototype.addMenuHandler=function(n,t){if(t!=null){var i=!0,r=mxUtils.bind(this,function(r){var u,f;(i&&n.enabled==null||n.enabled)&&(this.editorUi.editor.graph.popupMenuHandler.hideMenu(),u=new mxPopupMenu(t),u.div.className+=" geMenubarMenu",u.smartSeparators=!0,u.showDisabled=!0,u.autoExpand=!0,u.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(u,arguments);this.editorUi.resetCurrentMenu();u.destroy()}),f=mxUtils.getOffset(n),u.popup(f.x,f.y+n.offsetHeight,null,r),this.editorUi.setCurrentMenu(u,n));mxEvent.consume(r)});mxEvent.addListener(n,"mousemove",mxUtils.bind(this,function(t){this.editorUi.currentMenu!=null&&this.editorUi.currentMenuElt!=n&&(this.editorUi.hideCurrentMenu(),r(t))}));mxEvent.addListener(n,"mousedown",mxUtils.bind(this,function(){i=this.currentElt!=n}));mxEvent.addListener(n,"click",mxUtils.bind(this,function(n){r(n);i=!0}))}};Menubar.prototype.destroy=function(){};mxUtils.extend(Menu,mxEventSource);Menu.prototype.isEnabled=function(){return this.enabled};Menu.prototype.setEnabled=function(n){this.enabled!=n&&(this.enabled=n,this.fireEvent(new mxEventObject("stateChanged")))};Menu.prototype.execute=function(n,t){this.funct(n,t)};EditorUi.prototype.createMenus=function(){return new Menus(this)};Toolbar.prototype.dropdownImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/dropdown.gif";Toolbar.prototype.dropdownImageHtml='<img border="0" style="position:absolute;right:4px;top:'+(EditorUi.compactUi?6:8)+'px;" src="'+Toolbar.prototype.dropdownImage+'" valign="middle"/>';Toolbar.prototype.selectedBackground="#d0d0d0";Toolbar.prototype.unselectedBackground="none";Toolbar.prototype.staticElements=null;Toolbar.prototype.init=function(){var n=screen.width,r,t,i;n-=screen.height>740?56:0;n>=700&&(r=this.addMenu("",mxResources.get("view")+" ("+mxResources.get("panTooltip")+")",!0,"viewPanels",null,!0),this.addDropDownArrow(r,"geSprite-formatpanel",38,50,-4,-3,36,-8),this.addSeparator());t=this.addMenu("",mxResources.get("zoom")+" (Alt+Mousewheel)",!0,"viewZoom",null,!0);t.showDisabled=!0;t.style.whiteSpace="nowrap";t.style.position="relative";t.style.overflow="hidden";t.style.width=EditorUi.compactUi?mxClient.IS_QUIRKS?"58px":"50px":mxClient.IS_QUIRKS?"62px":"36px";n>=420&&(this.addSeparator(),i=this.addItems(["zoomIn","zoomOut"]),i[0].setAttribute("title",mxResources.get("zoomIn")+" ("+this.editorUi.actions.get("zoomIn").shortcut+")"),i[1].setAttribute("title",mxResources.get("zoomOut")+" ("+this.editorUi.actions.get("zoomOut").shortcut+")"));this.updateZoom=mxUtils.bind(this,function(){t.innerHTML=Math.round(this.editorUi.editor.graph.view.scale*100)+"%"+this.dropdownImageHtml;EditorUi.compactUi&&(t.getElementsByTagName("img")[0].style.right="1px",t.getElementsByTagName("img")[0].style.top="5px")});this.editorUi.editor.graph.view.addListener(mxEvent.EVENT_SCALE,this.updateZoom);this.editorUi.editor.addListener("resetGraphView",this.updateZoom);i=this.addItems(["-","undo","redo"]);i[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")");i[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")");n>=320&&(i=this.addItems(["-","delete"]),i[1].setAttribute("title",mxResources.get("delete")+" ("+this.editorUi.actions.get("delete").shortcut+")"));n>=550&&this.addItems(["-","toFront","toBack"]);n>=740&&(this.addItems(["-","fillColor"]),n>=780&&(this.addItems(["strokeColor"]),n>=820&&this.addItems(["shadow"])));n>=400&&(this.addSeparator(),n>=440&&(this.edgeShapeMenu=this.addMenuFunction("",mxResources.get("connection"),!1,mxUtils.bind(this,function(n){this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_SHAPE,"width"],[null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_SHAPE,"width"],["link",null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_SHAPE,"width"],["flexArrow",null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_SHAPE,"width"],["arrow",null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),this.addDropDownArrow(this.edgeShapeMenu,"geSprite-connection",44,50,0,0,22,-4)),this.edgeStyleMenu=this.addMenuFunction("geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(n){this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved"));this.editorUi.menus.edgeStyleChange(n,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation"))})),this.addDropDownArrow(this.edgeStyleMenu,"geSprite-orthogonal",44,50,0,0,22,-4))};Toolbar.prototype.addDropDownArrow=function(n,t,i,r,u,f,e,o){e=e!=null?e:32;u=EditorUi.compactUi?u:o;n.style.whiteSpace="nowrap";n.style.overflow="hidden";n.style.position="relative";n.innerHTML='<div class="geSprite '+t+'" style="margin-left:'+u+"px;margin-top:"+f+'px;"><\/div>'+this.dropdownImageHtml;n.style.width=mxClient.IS_QUIRKS?r+"px":r-e+"px";mxClient.IS_QUIRKS&&(n.style.height=EditorUi.compactUi?"24px":"26px");EditorUi.compactUi&&(n.getElementsByTagName("img")[0].style.left="24px",n.getElementsByTagName("img")[0].style.top="5px",n.style.width=mxClient.IS_QUIRKS?i+"px":i-10+"px")};Toolbar.prototype.setFontName=function(n){this.fontMenu!=null&&(this.fontMenu.innerHTML='<div style="width:60px;overflow:hidden;display:inline-block;">'+mxUtils.htmlEntities(n)+"<\/div>"+this.dropdownImageHtml)};Toolbar.prototype.setFontSize=function(n){this.sizeMenu!=null&&(this.sizeMenu.innerHTML='<div style="width:24px;overflow:hidden;display:inline-block;">'+n+"<\/div>"+this.dropdownImageHtml)};Toolbar.prototype.createTextToolbar=function(){var t=this.editorUi.editor.graph,f=this.addMenu("",mxResources.get("style"),!0,"formatBlock"),e,r,u,i,n;f.style.position="relative";f.style.whiteSpace="nowrap";f.style.overflow="hidden";f.innerHTML=mxResources.get("style")+this.dropdownImageHtml;EditorUi.compactUi&&(f.style.paddingRight="18px",f.getElementsByTagName("img")[0].style.right="1px",f.getElementsByTagName("img")[0].style.top="5px");this.addSeparator();this.fontMenu=this.addMenu("",mxResources.get("fontFamily"),!0,"fontFamily");this.fontMenu.style.position="relative";this.fontMenu.style.whiteSpace="nowrap";this.fontMenu.style.overflow="hidden";this.fontMenu.style.width=mxClient.IS_QUIRKS?"80px":"60px";this.setFontName(Menus.prototype.defaultFont);EditorUi.compactUi&&(this.fontMenu.style.paddingRight="18px",this.fontMenu.getElementsByTagName("img")[0].style.right="1px",this.fontMenu.getElementsByTagName("img")[0].style.top="5px");this.addSeparator();this.sizeMenu=this.addMenu(Menus.prototype.defaultFontSize,mxResources.get("fontSize"),!0,"fontSize");this.sizeMenu.style.position="relative";this.sizeMenu.style.whiteSpace="nowrap";this.sizeMenu.style.overflow="hidden";this.sizeMenu.style.width=mxClient.IS_QUIRKS?"44px":"24px";this.setFontSize(Menus.prototype.defaultFontSize);EditorUi.compactUi&&(this.sizeMenu.style.paddingRight="18px",this.sizeMenu.getElementsByTagName("img")[0].style.right="1px",this.sizeMenu.getElementsByTagName("img")[0].style.top="5px");e=this.addItems(["-","undo","redo","-","bold","italic","underline"]);e[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")");e[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")");e[4].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")");e[5].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")");e[6].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");r=this.addMenuFunction("",mxResources.get("align"),!1,mxUtils.bind(this,function(t){n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyleft",!1,null)}),null,"geIcon geSprite geSprite-left");n.setAttribute("title",mxResources.get("left"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifycenter",!1,null)}),null,"geIcon geSprite geSprite-center");n.setAttribute("title",mxResources.get("center"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyright",!1,null)}),null,"geIcon geSprite geSprite-right");n.setAttribute("title",mxResources.get("right"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("justifyfull",!1,null)}),null,"geIcon geSprite geSprite-justifyfull");n.setAttribute("title",mxResources.get("justifyfull"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertorderedlist",!1,null)}),null,"geIcon geSprite geSprite-orderedlist");n.setAttribute("title",mxResources.get("numberedList"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("insertunorderedlist",!1,null)}),null,"geIcon geSprite geSprite-unorderedlist");n.setAttribute("title",mxResources.get("bulletedList"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("outdent",!1,null)}),null,"geIcon geSprite geSprite-outdent");n.setAttribute("title",mxResources.get("decreaseIndent"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("indent",!1,null)}),null,"geIcon geSprite geSprite-indent");n.setAttribute("title",mxResources.get("increaseIndent"))}));r.style.position="relative";r.style.whiteSpace="nowrap";r.style.overflow="hidden";r.innerHTML='<div class="geSprite geSprite-left" style="margin-left:-2px;"><\/div>'+this.dropdownImageHtml;r.style.width=mxClient.IS_QUIRKS?"50px":"30px";EditorUi.compactUi&&(r.getElementsByTagName("img")[0].style.left="22px",r.getElementsByTagName("img")[0].style.top="5px");u=this.addMenuFunction("",mxResources.get("format"),!1,mxUtils.bind(this,function(t){n=t.addItem("",null,this.editorUi.actions.get("subscript").funct,null,"geIcon geSprite geSprite-subscript");n.setAttribute("title",mxResources.get("subscript")+" ("+Editor.ctrlKey+"+,)");n=t.addItem("",null,this.editorUi.actions.get("superscript").funct,null,"geIcon geSprite geSprite-superscript");n.setAttribute("title",mxResources.get("superscript")+" ("+Editor.ctrlKey+"+.)");n=t.addItem("",null,this.editorUi.actions.get("fontColor").funct,null,"geIcon geSprite geSprite-fontcolor");n.setAttribute("title",mxResources.get("fontColor"));n=t.addItem("",null,this.editorUi.actions.get("backgroundColor").funct,null,"geIcon geSprite geSprite-fontbackground");n.setAttribute("title",mxResources.get("backgroundColor"));n=t.addItem("",null,mxUtils.bind(this,function(){document.execCommand("removeformat",!1,null)}),null,"geIcon geSprite geSprite-removeformat");n.setAttribute("title",mxResources.get("removeFormat"))}));u.style.position="relative";u.style.whiteSpace="nowrap";u.style.overflow="hidden";u.innerHTML='<div class="geSprite geSprite-dots" style="margin-left:-2px;"><\/div>'+this.dropdownImageHtml;u.style.width=mxClient.IS_QUIRKS?"50px":"30px";EditorUi.compactUi&&(u.getElementsByTagName("img")[0].style.left="22px",u.getElementsByTagName("img")[0].style.top="5px");this.addSeparator();this.addButton("geIcon geSprite geSprite-code",mxResources.get("html"),function(){t.cellEditor.toggleViewMode();t.cellEditor.textarea.innerHTML.length>0&&(t.cellEditor.textarea.innerHTML!="&nbsp;"||!t.cellEditor.clearOnChange)&&window.setTimeout(function(){document.execCommand("selectAll",!1,null)})});this.addSeparator();i=this.addMenuFunction("",mxResources.get("insert"),!0,mxUtils.bind(this,function(n){n.addItem(mxResources.get("insertLink"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("link").funct()}));n.addItem(mxResources.get("insertImage"),null,mxUtils.bind(this,function(){this.editorUi.actions.get("image").funct()}));n.addItem(mxResources.get("insertHorizontalRule"),null,mxUtils.bind(this,function(){document.execCommand("inserthorizontalrule",!1,null)}))}));i.style.whiteSpace="nowrap";i.style.overflow="hidden";i.style.position="relative";i.innerHTML='<div class="geSprite geSprite-plus" style="margin-left:-4px;margin-top:-3px;"><\/div>'+this.dropdownImageHtml;i.style.width=mxClient.IS_QUIRKS?"36px":"16px";EditorUi.compactUi&&(i.getElementsByTagName("img")[0].style.left="24px",i.getElementsByTagName("img")[0].style.top="5px",i.style.width=mxClient.IS_QUIRKS?"50px":"30px");this.addSeparator();n=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(n){var i=t.getSelectedElement(),u=t.getParentByName(i,"TD",t.cellEditor.text2),f=t.getParentByName(i,"TR",t.cellEditor.text2),r;f==null?this.editorUi.menus.addInsertTableItem(n):(r=t.getParentByName(f,"TABLE",t.cellEditor.text2),i=n.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertColumn(r,u!=null?u.cellIndex:0))}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-insertcolumnbefore"),i.setAttribute("title",mxResources.get("insertColumnBefore")),i=n.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertColumn(r,u!=null?u.cellIndex+1:-1))}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-insertcolumnafter"),i.setAttribute("title",mxResources.get("insertColumnAfter")),i=n.addItem("Delete column",null,mxUtils.bind(this,function(){if(u!=null)try{t.deleteColumn(r,u.cellIndex)}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-deletecolumn"),i.setAttribute("title",mxResources.get("deleteColumn")),i=n.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertRow(r,f.sectionRowIndex))}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-insertrowbefore"),i.setAttribute("title",mxResources.get("insertRowBefore")),i=n.addItem("",null,mxUtils.bind(this,function(){try{t.selectNode(t.insertRow(r,f.sectionRowIndex+1))}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-insertrowafter"),i.setAttribute("title",mxResources.get("insertRowAfter")),i=n.addItem("",null,mxUtils.bind(this,function(){try{t.deleteRow(r,f.sectionRowIndex)}catch(n){mxUtils.alert(mxResources.get("error")+": "+n.message)}}),null,"geIcon geSprite geSprite-deleterow"),i.setAttribute("title",mxResources.get("deleteRow")),i=n.addItem("",null,mxUtils.bind(this,function(){var n=r.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(n,t,i,r){return"#"+("0"+Number(t).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(r).toString(16)).substr(-2)});this.editorUi.pickColor(n,function(n){n==null||n==mxConstants.NONE?(r.removeAttribute("border"),r.style.border="",r.style.borderCollapse=""):(r.setAttribute("border","1"),r.style.border="1px solid "+n,r.style.borderCollapse="collapse")})}),null,"geIcon geSprite geSprite-strokecolor"),i.setAttribute("title",mxResources.get("borderColor")),i=n.addItem("",null,mxUtils.bind(this,function(){var n=r.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(n,t,i,r){return"#"+("0"+Number(t).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(r).toString(16)).substr(-2)});this.editorUi.pickColor(n,function(n){r.style.backgroundColor=n==null||n==mxConstants.NONE?"":n})}),null,"geIcon geSprite geSprite-fillcolor"),i.setAttribute("title",mxResources.get("backgroundColor")),i=n.addItem("",null,mxUtils.bind(this,function(){var t=r.getAttribute("cellPadding")||0,n=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),mxUtils.bind(this,function(n){n!=null&&n.length>0?r.setAttribute("cellPadding",n):r.removeAttribute("cellPadding")}),mxResources.get("spacing"));this.editorUi.showDialog(n.container,300,80,!0,!0);n.init()}),null,"geIcon geSprite geSprite-fit"),i.setAttribute("title",mxResources.get("spacing")),i=n.addItem("",null,mxUtils.bind(this,function(){r.setAttribute("align","left")}),null,"geIcon geSprite geSprite-left"),i.setAttribute("title",mxResources.get("left")),i=n.addItem("",null,mxUtils.bind(this,function(){r.setAttribute("align","center")}),null,"geIcon geSprite geSprite-center"),i.setAttribute("title",mxResources.get("center")),i=n.addItem("",null,mxUtils.bind(this,function(){r.setAttribute("align","right")}),null,"geIcon geSprite geSprite-right"),i.setAttribute("title",mxResources.get("right")))}));n.style.position="relative";n.style.whiteSpace="nowrap";n.style.overflow="hidden";n.innerHTML='<div class="geSprite geSprite-table" style="margin-left:-2px;"><\/div>'+this.dropdownImageHtml;n.style.width=mxClient.IS_QUIRKS?"50px":"30px";EditorUi.compactUi&&(n.getElementsByTagName("img")[0].style.left="22px",n.getElementsByTagName("img")[0].style.top="5px")};Toolbar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()};Toolbar.prototype.addMenu=function(n,t,i,r,u,f){var e=this.editorUi.menus.get(r),o=this.addMenuFunction(n,t,i,function(){e.funct.apply(e,arguments)},u,f);return e.addListener("stateChanged",function(){o.setEnabled(e.enabled)}),o};Toolbar.prototype.addMenuFunction=function(n,t,i,r,u,f){return this.addMenuFunctionInContainer(u!=null?u:this.container,n,t,i,r,f)};Toolbar.prototype.addMenuFunctionInContainer=function(n,t,i,r,u,f){var e=r?this.createLabel(t):this.createButton(t);return this.initElement(e,i),this.addMenuHandler(e,r,u,f),n.appendChild(e),e};Toolbar.prototype.addSeparator=function(n){n=n!=null?n:this.container;var t=document.createElement("div");return t.className="geSeparator",n.appendChild(t),t};Toolbar.prototype.addItems=function(n,t,i){for(var r,u=[],f=0;f<n.length;f++)r=n[f],r=="-"?u.push(this.addSeparator(t)):u.push(this.addItem("geSprite-"+r.toLowerCase(),r,t,i));return u};Toolbar.prototype.addItem=function(n,t,i,r){var u=this.editorUi.actions.get(t),f=null,e;return u!=null&&(e=u.label,u.shortcut!=null&&(e+=" ("+u.shortcut+")"),f=this.addButton(n,e,u.funct,i),r||(f.setEnabled(u.enabled),u.addListener("stateChanged",function(){f.setEnabled(u.enabled)}))),f};Toolbar.prototype.addButton=function(n,t,i,r){var u=this.createButton(n);return r=r!=null?r:this.container,this.initElement(u,t),this.addClickHandler(u,i),r.appendChild(u),u};Toolbar.prototype.initElement=function(n,t){t!=null&&n.setAttribute("title",t);this.addEnabledState(n)};Toolbar.prototype.addEnabledState=function(n){var t=n.className;n.setEnabled=function(i){n.enabled=i;n.className=i?t:t+" mxDisabled"};n.setEnabled(!0)};Toolbar.prototype.addClickHandler=function(n,t){t!=null&&(mxEvent.addListener(n,"click",function(i){n.enabled&&t(i);mxEvent.consume(i)}),document.documentMode!=null&&document.documentMode>=9&&mxEvent.addListener(n,"mousedown",function(n){n.preventDefault()}))};Toolbar.prototype.createButton=function(n){var t=document.createElement("a"),i;return t.setAttribute("href","javascript:void(0);"),t.className="geButton",i=document.createElement("div"),n!=null&&(i.className="geSprite "+n),t.appendChild(i),t};Toolbar.prototype.createLabel=function(n){var t=document.createElement("a");return t.setAttribute("href","javascript:void(0);"),t.className="geLabel",mxUtils.write(t,n),t};Toolbar.prototype.addMenuHandler=function(n,t,i,r){if(i!=null){var e=this.editorUi.editor.graph,u=null,f=!0;mxEvent.addListener(n,"click",mxUtils.bind(this,function(o){if(f&&(n.enabled==null||n.enabled)){e.popupMenuHandler.hideMenu();u=new mxPopupMenu(i);u.div.className+=" geToolbarMenu";u.showDisabled=r;u.labels=t;u.autoExpand=!0;var s=mxUtils.getOffset(n);u.popup(s.x,s.y+n.offsetHeight,null,o);this.editorUi.setCurrentMenu(u,n);!t&&u.div.scrollHeight>u.div.clientHeight&&(u.div.style.width="40px");u.hideMenu=mxUtils.bind(this,function(){mxPopupMenu.prototype.hideMenu.apply(u,arguments);this.editorUi.resetCurrentMenu();u.destroy()});u.addListener(mxEvent.EVENT_HIDE,mxUtils.bind(this,function(){this.currentElt=null}))}f=!0;mxEvent.consume(o)}));mxEvent.addListener(n,"mousedown",mxUtils.bind(this,function(t){f=this.currentElt!=n;document.documentMode!=null&&document.documentMode>=9&&t.preventDefault()}))}};Toolbar.prototype.destroy=function(){this.gestureHandler!=null&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null)};OpenDialog=function(){var n=document.createElement("iframe"),t;n.style.backgroundColor="transparent";n.allowTransparency="true";n.style.borderStyle="none";n.style.borderWidth="0px";n.style.overflow="hidden";n.frameBorder="0";t=mxClient.IS_VML&&(document.documentMode==null||document.documentMode<8)?20:0;n.setAttribute("width",(Editor.useLocalStorage?640:320)+t+"px");n.setAttribute("height",(Editor.useLocalStorage?480:220)+t+"px");n.setAttribute("src",OPEN_FORM);this.container=n};ColorDialog=function(n,t,i,r){function v(){var n=l(ColorDialog.recentColors.length==0?["FFFFFF"]:ColorDialog.recentColors,11,"FFFFFF",!0);return n.style.marginBottom="8px",n}function l(n,t,i,r){var o,a,y,s,h,l,e;for(t=t!=null?t:12,o=document.createElement("table"),o.style.borderCollapse="collapse",o.setAttribute("cellspacing","0"),o.style.marginBottom="20px",o.style.cellSpacing="0px",a=document.createElement("tbody"),o.appendChild(a),y=n.length/t,s=0;s<y;s++){for(h=document.createElement("tr"),l=0;l<t;l++)(function(n){var t=document.createElement("td");t.style.border="1px solid black";t.style.padding="0px";t.style.width="16px";t.style.height="16px";n==null&&(n=i);n=="none"?t.style.background="url('"+Dialog.prototype.noColorImage+"')":t.style.backgroundColor="#"+n;h.appendChild(t);n!=null&&(t.style.cursor="pointer",mxEvent.addListener(t,"click",function(){n=="none"?(f.fromString("ffffff"),u.value="none"):f.fromString(n)}))})(n[s*t+l]);a.appendChild(h)}return r&&(e=document.createElement("td"),e.setAttribute("title",mxResources.get("reset")),e.style.border="1px solid black",e.style.padding="0px",e.style.width="16px",e.style.height="16px",e.style.backgroundImage="url('"+Dialog.prototype.closeImage+"')",e.style.backgroundPosition="center center",e.style.backgroundRepeat="no-repeat",e.style.cursor="pointer",h.appendChild(e),mxEvent.addListener(e,"click",function(){ColorDialog.resetRecentColors();o.parentNode.replaceChild(v(),o)})),c.appendChild(o),o}var u,f,e,c,s,o,h,y,a;this.editorUi=n;u=document.createElement("input");u.style.marginBottom="10px";u.style.width="216px";mxClient.IS_IE&&(u.style.marginTop="10px",document.body.appendChild(u));this.init=function(){mxClient.IS_TOUCH||u.focus()};f=new jscolor.color(u);f.pickerOnfocus=!1;f.showPicker();e=document.createElement("div");jscolor.picker.box.style.position="relative";jscolor.picker.box.style.width="230px";jscolor.picker.box.style.height="100px";jscolor.picker.box.style.paddingBottom="10px";e.appendChild(jscolor.picker.box);c=document.createElement("center");e.appendChild(u);mxUtils.br(e);v();s=l(this.presetColors);s.style.marginBottom="8px";s=l(this.defaultColors);s.style.marginBottom="16px";e.appendChild(c);o=document.createElement("div");o.style.textAlign="right";o.style.whiteSpace="nowrap";h=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog();r!=null&&r()});h.className="geBtn";n.editor.cancelFirst&&o.appendChild(h);y=i!=null?i:this.createApplyFunction();a=mxUtils.button(mxResources.get("apply"),function(){var t=u.value;ColorDialog.addRecentColor(t,12);t!="none"&&t.charAt(0)!="#"&&(t="#"+t);y(t);n.hideDialog()});a.className="geBtn gePrimaryBtn";o.appendChild(a);n.editor.cancelFirst||o.appendChild(h);t!=null&&(t=="none"?(f.fromString("ffffff"),u.value="none"):f.fromString(t));e.appendChild(o);this.picker=f;this.colorInput=u;mxEvent.addListener(e,"keydown",function(t){t.keyCode==27&&(n.hideDialog(),r!=null&&r(),mxEvent.consume(t))});this.container=e};ColorDialog.prototype.presetColors=["E6D0DE","CDA2BE","B5739D","E1D5E7","C3ABD0","A680B8","D4E1F5","A9C4EB","7EA6E0","D5E8D4","9AC7BF","67AB9F","D5E8D4","B9E0A5","97D077","FFF2CC","FFE599","FFD966","FFF4C3","FFCE9F","FFB570","F8CECC","F19C99","EA6B66"];ColorDialog.prototype.defaultColors=["none","FFFFFF","E6E6E6","CCCCCC","B3B3B3","999999","808080","666666","4D4D4D","333333","1A1A1A","000000","FFCCCC","FFE6CC","FFFFCC","E6FFCC","CCFFCC","CCFFE6","CCFFFF","CCE5FF","CCCCFF","E5CCFF","FFCCFF","FFCCE6","FF9999","FFCC99","FFFF99","CCFF99","99FF99","99FFCC","99FFFF","99CCFF","9999FF","CC99FF","FF99FF","FF99CC","FF6666","FFB366","FFFF66","B3FF66","66FF66","66FFB3","66FFFF","66B2FF","6666FF","B266FF","FF66FF","FF66B3","FF3333","FF9933","FFFF33","99FF33","33FF33","33FF99","33FFFF","3399FF","3333FF","9933FF","FF33FF","FF3399","FF0000","FF8000","FFFF00","80FF00","00FF00","00FF80","00FFFF","007FFF","0000FF","7F00FF","FF00FF","FF0080","CC0000","CC6600","CCCC00","66CC00","00CC00","00CC66","00CCCC","0066CC","0000CC","6600CC","CC00CC","CC0066","990000","994C00","999900","4D9900","009900","00994D","009999","004C99","000099","4C0099","990099","99004D","660000","663300","666600","336600","006600","006633","006666","003366","000066","330066","660066","660033","330000","331A00","333300","1A3300","003300","00331A","003333","001933","000033","190033","330033","33001A"];ColorDialog.prototype.createApplyFunction=function(){return mxUtils.bind(this,function(n){var t=this.editorUi.editor.graph;t.getModel().beginUpdate();try{t.setCellStyles(this.currentColorKey,n);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[this.currentColorKey],"values",[n],"cells",t.getSelectionCells()))}finally{t.getModel().endUpdate()}})};ColorDialog.recentColors=[];ColorDialog.addRecentColor=function(n,t){n!=null&&(mxUtils.remove(n,ColorDialog.recentColors),ColorDialog.recentColors.splice(0,0,n),ColorDialog.recentColors.length>=t&&ColorDialog.recentColors.pop())};ColorDialog.resetRecentColors=function(){ColorDialog.recentColors=[]};var AboutDialog=function(n){var t=document.createElement("div"),u,i,r,f;t.setAttribute("align","center");u=document.createElement("h3");mxUtils.write(u,mxResources.get("about")+" 流程设计器");t.appendChild(u);i=document.createElement("img");i.style.border="0px";i.setAttribute("width","176");i.setAttribute("width","151");i.setAttribute("src",IMAGE_PATH+"/logo.png");t.appendChild(i);mxUtils.br(t);mxUtils.write(t,"Powered by wyf v1.0 基于mxGraph v"+mxClient.VERSION);mxUtils.br(t);r=document.createElement("a");r.setAttribute("href","#");r.setAttribute("target","_blank");t.appendChild(r);mxUtils.br(t);mxUtils.br(t);f=mxUtils.button(mxResources.get("close"),function(){n.hideDialog()});f.className="geBtn gePrimaryBtn";t.appendChild(f);this.container=t},FilenameDialog=function(n,t,i,r,u,f,e,o,s,h){var a,c,v,y,l,p,w,b;s=s!=null?s:!0;v=document.createElement("table");y=document.createElement("tbody");v.style.marginTop="8px";a=document.createElement("tr");c=document.createElement("td");c.style.whiteSpace="nowrap";c.style.fontSize="10pt";c.style.width="120px";mxUtils.write(c,(u||mxResources.get("filename"))+":");a.appendChild(c);l=document.createElement("input");l.setAttribute("value",t||"");l.style.marginLeft="4px";l.style.width="180px";p=mxUtils.button(i,function(){(f==null||f(l.value))&&(s&&n.hideDialog(),r(l.value))});p.className="geBtn gePrimaryBtn";this.init=function(){if((u!=null||e==null)&&(l.focus(),mxClient.IS_GC||mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS?l.select():document.execCommand("selectAll",!1,null),Graph.fileSupport)){var i=v.parentNode,r=n.editor.graph,t=null;mxEvent.addListener(i,"dragleave",function(n){t!=null&&(t.style.backgroundColor="",t=null);n.stopPropagation();n.preventDefault()});mxEvent.addListener(i,"dragover",mxUtils.bind(this,function(n){t==null&&(!mxClient.IS_IE||document.documentMode>10)&&(t=l,t.style.backgroundColor="#ebf2f9");n.stopPropagation();n.preventDefault()}));mxEvent.addListener(i,"drop",mxUtils.bind(this,function(n){t!=null&&(t.style.backgroundColor="",t=null);mxUtils.indexOf(n.dataTransfer.types,"text/uri-list")>=0&&(l.value=decodeURIComponent(n.dataTransfer.getData("text/uri-list")),p.click());n.stopPropagation();n.preventDefault()}))}};c=document.createElement("td");c.appendChild(l);a.appendChild(c);(u!=null||e==null)&&y.appendChild(a);e!=null&&(a=document.createElement("tr"),c=document.createElement("td"),c.colSpan=2,c.appendChild(e),a.appendChild(c),y.appendChild(a));a=document.createElement("tr");c=document.createElement("td");c.colSpan=2;c.style.paddingTop="20px";c.style.whiteSpace="nowrap";c.setAttribute("align","right");w=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog();h!=null&&h()});w.className="geBtn";n.editor.cancelFirst&&c.appendChild(w);o!=null&&(b=mxUtils.button(mxResources.get("help"),function(){window.open(o)}),b.className="geBtn",c.appendChild(b));mxEvent.addListener(l,"keypress",function(n){n.keyCode==13&&p.click()});c.appendChild(p);n.editor.cancelFirst||c.appendChild(w);a.appendChild(c);y.appendChild(a);v.appendChild(y);this.container=v},TextareaDialog=function(n,t,i,r,u,f,e,o,s,h,c,l){var y,a,b,p,v,w,k;e=e!=null?e:300;o=o!=null?o:120;h=h!=null?h:!1;b=document.createElement("table");p=document.createElement("tbody");y=document.createElement("tr");a=document.createElement("td");a.style.fontSize="10pt";a.style.width="100px";mxUtils.write(a,t);y.appendChild(a);p.appendChild(y);y=document.createElement("tr");a=document.createElement("td");v=document.createElement("textarea");c&&v.setAttribute("wrap","off");v.setAttribute("spellcheck","false");v.setAttribute("autocorrect","off");v.setAttribute("autocomplete","off");v.setAttribute("autocapitalize","off");mxUtils.write(v,i||"");v.style.resize="none";v.style.width=e+"px";v.style.height=o+"px";this.textarea=v;this.init=function(){v.focus();v.scrollTop=0};a.appendChild(v);y.appendChild(a);p.appendChild(y);y=document.createElement("tr");a=document.createElement("td");a.style.paddingTop="14px";a.style.whiteSpace="nowrap";a.setAttribute("align","right");w=mxUtils.button(f||mxResources.get("cancel"),function(){n.hideDialog();u!=null&&u()});w.className="geBtn";n.editor.cancelFirst&&a.appendChild(w);s!=null&&s(a);r!=null&&(k=mxUtils.button(l||mxResources.get("apply"),function(){h||n.hideDialog();r(v.value)}),k.className="geBtn gePrimaryBtn",a.appendChild(k));n.editor.cancelFirst||a.appendChild(w);y.appendChild(a);p.appendChild(y);b.appendChild(p);this.container=b},EditDiagramDialog=function(n){var i=document.createElement("div"),t,r,u;if(i.style.textAlign="right",t=document.createElement("textarea"),t.setAttribute("wrap","off"),t.setAttribute("spellcheck","false"),t.setAttribute("autocorrect","off"),t.setAttribute("autocomplete","off"),t.setAttribute("autocapitalize","off"),t.style.overflow="auto",t.style.resize="none",t.style.width="600px",t.style.height="360px",t.style.marginBottom="16px",t.value=mxUtils.getPrettyXml(n.editor.getGraphXml()),i.appendChild(t),this.init=function(){t.focus()},Graph.fileSupport){function i(i){if(i.stopPropagation(),i.preventDefault(),i.dataTransfer.files.length>0){var u=i.dataTransfer.files[0],r=new FileReader;r.onload=function(n){t.value=n.target.result};r.readAsText(u)}else t.value=n.extractGraphModelFromEvent(i)}function r(n){n.stopPropagation();n.preventDefault()}t.addEventListener("dragover",r,!1);t.addEventListener("drop",i,!1)}r=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});r.className="geBtn";n.editor.cancelFirst&&i.appendChild(r);u=mxUtils.button(mxResources.get("ok"),function(){var r=n.editor.graph.zapGremlins(mxUtils.trim(t.value)),i=null;n.editor.graph.model.beginUpdate();try{n.editor.setGraphXml(mxUtils.parseXml(r).documentElement);n.hideDialog()}catch(u){i=u}finally{n.editor.graph.model.endUpdate()}i!=null&&mxUtils.alert(i.message)});u.className="geBtn gePrimaryBtn";i.appendChild(u);n.editor.cancelFirst||i.appendChild(r);this.container=i};EditDiagramDialog.showNewWindowOption=!0;ExportDialog=function(n){function ft(){var n=h.value,t=n.lastIndexOf(".");h.value=t>0?n.substring(0,t+1)+e.value:n+"."+e.value;e.value==="xml"?(f.setAttribute("disabled","true"),r.setAttribute("disabled","true"),u.setAttribute("disabled","true"),c.setAttribute("disabled","true")):(f.removeAttribute("disabled"),r.removeAttribute("disabled"),u.removeAttribute("disabled"),c.removeAttribute("disabled"));e.value==="png"||e.value==="svg"?a.removeAttribute("disabled"):a.setAttribute("disabled","disabled")}function it(){r.style.backgroundColor=r.value*u.value>MAX_AREA||r.value<=0?"red":"";u.style.backgroundColor=r.value*u.value>MAX_AREA||u.value<=0?"red":""}var v=n.editor.graph,rt=v.getGraphBounds(),ut=v.view.scale,s=Math.ceil(rt.width/ut),l=Math.ceil(rt.height/ut),i,t,y=document.createElement("table"),o=document.createElement("tbody"),h,e,p,w,b,k,d,g,f,r,u,a,c,nt,tt;y.setAttribute("cellpadding",mxClient.IS_SF?"0":"2");i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";t.style.width="100px";mxUtils.write(t,mxResources.get("filename")+":");i.appendChild(t);h=document.createElement("input");h.setAttribute("value",n.editor.getOrCreateFilename());h.style.width="180px";t=document.createElement("td");t.appendChild(h);i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("format")+":");i.appendChild(t);e=document.createElement("select");e.style.width="180px";p=document.createElement("option");p.setAttribute("value","png");mxUtils.write(p,mxResources.get("formatPng"));e.appendChild(p);w=document.createElement("option");ExportDialog.showGifOption&&(w.setAttribute("value","gif"),mxUtils.write(w,mxResources.get("formatGif")),e.appendChild(w));b=document.createElement("option");b.setAttribute("value","jpg");mxUtils.write(b,mxResources.get("formatJpg"));e.appendChild(b);k=document.createElement("option");k.setAttribute("value","pdf");mxUtils.write(k,mxResources.get("formatPdf"));e.appendChild(k);d=document.createElement("option");d.setAttribute("value","svg");mxUtils.write(d,mxResources.get("formatSvg"));e.appendChild(d);ExportDialog.showXmlOption&&(g=document.createElement("option"),g.setAttribute("value","xml"),mxUtils.write(g,mxResources.get("formatXml")),e.appendChild(g));t=document.createElement("td");t.appendChild(e);i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("zoom")+" (%):");i.appendChild(t);f=document.createElement("input");f.setAttribute("type","number");f.setAttribute("value","100");f.style.width="180px";t=document.createElement("td");t.appendChild(f);i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("width")+":");i.appendChild(t);r=document.createElement("input");r.setAttribute("value",s);r.style.width="180px";t=document.createElement("td");t.appendChild(r);i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("height")+":");i.appendChild(t);u=document.createElement("input");u.setAttribute("value",l);u.style.width="180px";t=document.createElement("td");t.appendChild(u);i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("background")+":");i.appendChild(t);a=document.createElement("input");a.setAttribute("type","checkbox");a.checked=v.background==null||v.background==mxConstants.NONE;t=document.createElement("td");t.appendChild(a);mxUtils.write(t,mxResources.get("transparent"));i.appendChild(t);o.appendChild(i);i=document.createElement("tr");t=document.createElement("td");t.style.fontSize="10pt";mxUtils.write(t,mxResources.get("borderWidth")+":");i.appendChild(t);c=document.createElement("input");c.setAttribute("type","number");c.setAttribute("value",ExportDialog.lastBorderValue);c.style.width="180px";t=document.createElement("td");t.appendChild(c);i.appendChild(t);o.appendChild(i);y.appendChild(o);mxEvent.addListener(e,"change",ft);ft();mxEvent.addListener(f,"change",function(){var n=Math.max(0,parseFloat(f.value)||100)/100;f.value=parseFloat((n*100).toFixed(2));s>0?(r.value=Math.floor(s*n),u.value=Math.floor(l*n)):(f.value="100",r.value=s,u.value=l);it()});mxEvent.addListener(r,"change",function(){var n=parseInt(r.value)/s;n>0?(f.value=parseFloat((n*100).toFixed(2)),u.value=Math.floor(l*n)):(f.value="100",r.value=s,u.value=l);it()});mxEvent.addListener(u,"change",function(){var n=parseInt(u.value)/l;n>0?(f.value=parseFloat((n*100).toFixed(2)),r.value=Math.floor(s*n)):(f.value="100",r.value=s,u.value=l);it()});i=document.createElement("tr");t=document.createElement("td");t.setAttribute("align","right");t.style.paddingTop="22px";t.colSpan=2;nt=mxUtils.button(mxResources.get("export"),mxUtils.bind(this,function(){if(parseInt(f.value)<=0)mxUtils.alert(mxResources.get("drawingEmpty"));else{var u=h.value,i=e.value,o=Math.max(0,parseFloat(f.value)||100)/100,r=Math.max(0,parseInt(c.value)),t=v.background;(i=="svg"||i=="png")&&a.checked?t=null:(t==null||t==mxConstants.NONE)&&(t="#ffffff");ExportDialog.lastBorderValue=r;ExportDialog.exportFile(n,u,i,t,o,r)}}));nt.className="geBtn gePrimaryBtn";tt=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});tt.className="geBtn";n.editor.cancelFirst?(t.appendChild(tt),t.appendChild(nt)):(t.appendChild(nt),t.appendChild(tt));i.appendChild(t);o.appendChild(i);y.appendChild(o);this.container=y};ExportDialog.lastBorderValue=0;ExportDialog.showGifOption=!0;ExportDialog.showXmlOption=!0;ExportDialog.exportFile=function(n,t,i,r,u,f){var e=n.editor.graph,s,l,p;if(i=="xml")ExportDialog.saveLocalFile(n,mxUtils.getXml(n.editor.getGraphXml()),t,i);else if(i=="svg")ExportDialog.saveLocalFile(n,mxUtils.getXml(e.getSvg(r,u,f)),t,i);else{var o=e.getGraphBounds(),c=mxUtils.createXmlDocument(),h=c.createElement("output");c.appendChild(h);s=new mxXmlCanvas2D(h);s.translate(Math.floor((f/u-o.x)/e.view.scale),Math.floor((f/u-o.y)/e.view.scale));s.scale(u/e.view.scale);l=new mxImageExport;l.drawState(e.getView().getState(e.model.root),s);var a="xml="+encodeURIComponent(mxUtils.getXml(h)),v=Math.ceil(o.width*u/e.view.scale+2*f),y=Math.ceil(o.height*u/e.view.scale+2*f);a.length<=MAX_REQUEST_SIZE&&v*y<MAX_AREA?(n.hideDialog(),p=new mxXmlRequest(EXPORT_URL,"format="+i+"&filename="+encodeURIComponent(t)+"&bg="+(r!=null?r:"none")+"&w="+v+"&h="+y+"&"+a),p.simulate(document,"_blank")):mxUtils.alert(mxResources.get("drawingTooLarge"))}};ExportDialog.saveLocalFile=function(n,t,i,r){if(t.length<MAX_REQUEST_SIZE){n.hideDialog();var u=new mxXmlRequest(SAVE_URL,"xml="+encodeURIComponent(t)+"&filename="+encodeURIComponent(i)+"&format="+r);u.simulate(document,"_blank")}else mxUtils.alert(mxResources.get("drawingTooLarge")),mxUtils.popup(xml)};EditDataDialog=function(n,t){function ft(){f.value.length>0?h.removeAttribute("disabled"):h.setAttribute("disabled","disabled")}var g=document.createElement("div"),it=n.editor.graph,i=it.getModel().getValue(t),rt,nt,l,u,b,a,f,h,k,d,o,v,c,s,y;mxUtils.isNode(i)||(rt=mxUtils.createXmlDocument(),nt=rt.createElement("object"),nt.setAttribute("label",i||""),i=nt);l=new mxForm("properties");l.table.style.width="100%";var p=i.attributes,e=[],r=[],tt=0,ut=function(n,t){var u=document.createElement("div"),i,f,o,s;u.style.position="relative";u.style.paddingRight="20px";u.style.boxSizing="border-box";u.style.width="100%";i=document.createElement("a");f=mxUtils.createImage(Dialog.prototype.closeImage);f.style.height="9px";f.style.fontSize="9px";f.style.marginBottom=mxClient.IS_IE11?"-1px":"5px";i.className="geButton";i.setAttribute("title",mxResources.get("delete"));i.style.position="absolute";i.style.top="4px";i.style.right="0px";i.style.margin="0px";i.style.width="9px";i.style.height="9px";i.style.cursor="pointer";i.appendChild(f);o=function(n){return function(){for(var i=0,t=0;t<e.length;t++){if(e[t]==n){r[t]=null;l.table.deleteRow(i);break}r[t]!=null&&i++}}}(t);mxEvent.addListener(i,"click",o);s=n.parentNode;u.appendChild(n);u.appendChild(i);s.appendChild(u)},et=function(n,t,i){e[n]=t;r[n]=l.addTextarea(e[tt]+":",i,2);r[n].style.width="100%";ut(r[n],t)},w=[];for(u=0;u<p.length;u++)p[u].nodeName!="label"&&p[u].nodeName!="placeholders"&&w.push({name:p[u].nodeName,value:p[u].nodeValue});for(w.sort(function(n,t){return n.name<t.name?-1:n.name>t.name?1:0}),u=0;u<w.length;u++)et(tt,w[u].name,w[u].value),tt++;b=document.createElement("div");b.style.cssText="position:absolute;left:30px;right:30px;overflow-y:auto;top:30px;bottom:80px;";b.appendChild(l.table);a=document.createElement("div");a.style.whiteSpace="nowrap";a.style.marginTop="6px";f=document.createElement("input");f.setAttribute("placeholder",mxResources.get("enterPropertyName"));f.setAttribute("type","text");f.setAttribute("size",mxClient.IS_IE||mxClient.IS_IE11?"18":"22");f.style.marginLeft="2px";a.appendChild(f);b.appendChild(a);g.appendChild(b);h=mxUtils.button(mxResources.get("addProperty"),function(){var n=f.value,t,o,u;if(n.length>0&&n!="label"&&n!="placeholders"&&n.indexOf(":")<0)try{t=mxUtils.indexOf(e,n);t>=0&&r[t]!=null?r[t].focus():(o=i.cloneNode(!1),o.setAttribute(n,""),t>=0&&(e.splice(t,1),r.splice(t,1)),e.push(n),u=l.addTextarea(n+":","",2),u.style.width="100%",r.push(u),ut(u,n),u.focus());f.value=""}catch(s){mxUtils.alert(s)}else mxUtils.alert(mxResources.get("invalidName"))});this.init=function(){r.length>0?r[0].focus():f.focus()};h.setAttribute("disabled","disabled");h.style.marginLeft="10px";h.style.width="144px";a.appendChild(h);k=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog.apply(n,arguments)});k.className="geBtn";d=mxUtils.button(mxResources.get("apply"),function(){var f,u;try{for(n.hideDialog.apply(n,arguments),i=i.cloneNode(!0),f=!1,u=0;u<e.length;u++)r[u]==null?i.removeAttribute(e[u]):(i.setAttribute(e[u],r[u].value),f=f||e[u]=="placeholder"&&i.getAttribute("placeholders")=="1");f&&i.removeAttribute("label");it.getModel().setValue(t,i)}catch(o){mxUtils.alert(o)}});d.className="geBtn gePrimaryBtn";mxEvent.addListener(f,"keyup",ft);mxEvent.addListener(f,"change",ft);o=document.createElement("div");o.style.cssText="position:absolute;left:30px;right:30px;text-align:right;bottom:30px;height:40px;";(n.editor.graph.getModel().isVertex(t)||n.editor.graph.getModel().isEdge(t))&&(v=document.createElement("span"),v.style.marginRight="10px",c=document.createElement("input"),c.setAttribute("type","checkbox"),c.style.marginRight="6px",i.getAttribute("placeholders")=="1"&&(c.setAttribute("checked","checked"),c.defaultChecked=!0),mxEvent.addListener(c,"click",function(){i.getAttribute("placeholders")=="1"?i.removeAttribute("placeholders"):i.setAttribute("placeholders","1")}),v.appendChild(c),mxUtils.write(v,mxResources.get("placeholders")),EditDataDialog.placeholderHelpLink!=null&&(s=document.createElement("a"),s.setAttribute("href",EditDataDialog.placeholderHelpLink),s.setAttribute("title",mxResources.get("help")),s.setAttribute("target","_blank"),s.style.marginLeft="10px",s.style.cursor="help",y=document.createElement("img"),y.setAttribute("border","0"),y.setAttribute("valign","middle"),y.style.marginTop=mxClient.IS_IE11?"0px":"-4px",y.setAttribute("src",Editor.helpImage),s.appendChild(y),v.appendChild(s)),o.appendChild(v));n.editor.cancelFirst?(o.appendChild(k),o.appendChild(d)):(o.appendChild(d),o.appendChild(k));g.appendChild(o);this.container=g};EditDataDialog.placeholderHelpLink=null;var LinkDialog=function(n,t,i,r){var s=document.createElement("div"),e,u,f,o,h,c;mxUtils.write(s,mxResources.get("editLink")+":");e=document.createElement("div");e.className="geTitle";e.style.backgroundColor="transparent";e.style.borderColor="transparent";e.style.whiteSpace="nowrap";e.style.textOverflow="clip";e.style.cursor="default";mxClient.IS_VML||(e.style.paddingRight="20px");u=document.createElement("input");u.setAttribute("value",t);u.setAttribute("placeholder","http://www.example.com/");u.setAttribute("type","text");u.style.marginTop="6px";u.style.width="400px";u.style.backgroundImage="url('"+Dialog.prototype.clearImage+"')";u.style.backgroundRepeat="no-repeat";u.style.backgroundPosition="100% 50%";u.style.paddingRight="14px";f=document.createElement("div");f.setAttribute("title",mxResources.get("reset"));f.style.position="relative";f.style.left="-16px";f.style.width="12px";f.style.height="14px";f.style.cursor="pointer";f.style.display=mxClient.IS_VML?"inline":"inline-block";f.style.top=(mxClient.IS_VML?0:3)+"px";f.style.background="url("+IMAGE_PATH+"/transparent.gif)";mxEvent.addListener(f,"click",function(){u.value="";u.focus()});e.appendChild(u);e.appendChild(f);s.appendChild(e);this.init=function(){u.focus();mxClient.IS_GC||mxClient.IS_FF||document.documentMode>=5||mxClient.IS_QUIRKS?u.select():document.execCommand("selectAll",!1,null)};o=document.createElement("div");o.style.marginTop="18px";o.style.textAlign="right";mxEvent.addListener(u,"keypress",function(t){t.keyCode==13&&(n.hideDialog(),r(u.value))});h=mxUtils.button(mxResources.get("cancel"),function(){n.hideDialog()});h.className="geBtn";n.editor.cancelFirst&&o.appendChild(h);c=mxUtils.button(i,function(){n.hideDialog();r(u.value)});c.className="geBtn gePrimaryBtn";o.appendChild(c);n.editor.cancelFirst||o.appendChild(h);s.appendChild(o);this.container=s},OutlineWindow=function(n,t,i,r,u){function s(){f.outline.pageScale=e.pageScale;f.outline.pageFormat=e.pageFormat;f.outline.pageVisible=e.pageVisible;f.outline.background=e.background==null||e.background==mxConstants.NONE?e.defaultPageBackgroundColor:e.background;var n=mxUtils.getCurrentStyle(e.container);o.style.backgroundColor=n.backgroundColor;e.view.backgroundPageShape!=null&&f.outline.view.backgroundPageShape!=null&&(f.outline.view.backgroundPageShape.fill=e.view.backgroundPageShape.fill);f.outline.refresh()}var e=n.editor.graph,o=document.createElement("div"),f,h,c,l;o.style.position="absolute";o.style.width="100%";o.style.height="100%";o.style.border="1px solid whiteSmoke";o.style.overflow="hidden";this.window=new mxWindow(mxResources.get("outline"),o,t,i,r,u,!0,!0);this.window.destroyOnClose=!1;this.window.setMaximizable(!1);this.window.setResizable(!0);this.window.setClosable(!0);this.window.setVisible(!0);this.window.setLocation=function(n,t){var i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;n=Math.max(0,Math.min(n,i-this.table.clientWidth));t=Math.max(0,Math.min(t,r-this.table.clientHeight-48));(this.getX()!=n||this.getY()!=t)&&mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var n=this.window.getX(),t=this.window.getY();this.window.setLocation(n,t)}));f=n.createOutline(this.window);this.window.addListener(mxEvent.RESIZE,mxUtils.bind(this,function(){f.update(!1);f.outline.sizeDidChange()}));this.window.addListener(mxEvent.SHOW,mxUtils.bind(this,function(){f.suspended=!1;f.outline.refresh();f.update()}));this.window.addListener(mxEvent.HIDE,mxUtils.bind(this,function(){f.suspended=!0}));this.window.addListener(mxEvent.NORMALIZE,mxUtils.bind(this,function(){f.suspended=!1;f.update()}));this.window.addListener(mxEvent.MINIMIZE,mxUtils.bind(this,function(){f.suspended=!0}));h=f.createGraph;f.createGraph=function(){var n=h.apply(this,arguments),t;return n.gridEnabled=!1,n.pageScale=e.pageScale,n.pageFormat=e.pageFormat,n.background=e.background==null||e.background==mxConstants.NONE?e.defaultPageBackgroundColor:e.background,n.pageVisible=e.pageVisible,t=mxUtils.getCurrentStyle(e.container),o.style.backgroundColor=t.backgroundColor,n};f.init(o);n.editor.addListener("resetGraphView",s);n.addListener("pageFormatChanged",s);n.addListener("backgroundColorChanged",s);n.addListener("backgroundImageChanged",s);n.addListener("pageViewChanged",function(){s();f.update(!0)});f.outline.dialect==mxConstants.DIALECT_SVG&&(c=n.actions.get("zoomIn"),l=n.actions.get("zoomOut"),mxEvent.addMouseWheelListener(function(n,t){for(var r=!1,i=mxEvent.getSource(n);i!=null;){if(i==f.outline.view.canvas.ownerSVGElement){r=!0;break}i=i.parentNode}r&&(t?c.funct():l.funct(),mxEvent.consume(n))}))},LayersWindow=function(n,t,i,r,u){function nt(t){if(f.isEnabled()&&t!=null){var i=new FilenameDialog(n,t.value||mxResources.get("background"),mxResources.get("rename"),mxUtils.bind(this,function(n){n!=null&&f.getModel().setValue(t,n)}),mxResources.get("enterName"));n.showDialog(i.container,300,100,!0,!0);i.init()}}function k(){function t(n,t,i,r){var u=document.createElement("div"),y,c,p,w,l,a,e,o;u.className="geToolbarContainer";u.style.overflow="hidden";u.style.position="relative";u.style.padding="4px";u.style.height="22px";u.style.display="block";u.style.backgroundColor="whiteSmoke";u.style.borderWidth="0px 0px 1px 0px";u.style.borderColor="#c3c3c3";u.style.borderStyle="solid";u.style.whiteSpace="nowrap";y=document.createElement("div");y.style.display="inline-block";y.style.width="100%";y.style.textOverflow="ellipsis";y.style.overflow="hidden";mxEvent.addListener(u,"dragover",function(t){t.dataTransfer.dropEffect="move";v=n;t.stopPropagation();t.preventDefault()});mxEvent.addListener(u,"dragstart",function(n){b=u;mxClient.IS_FF&&n.dataTransfer.setData("Text","<layer/>")});mxEvent.addListener(u,"dragend",function(n){b!=null&&v!=null&&f.addCell(i,f.model.root,v);b=null;v=null;n.stopPropagation();n.preventDefault()});c=document.createElement("img");c.setAttribute("draggable","false");c.setAttribute("align","top");c.setAttribute("border","0");c.style.padding="4px";c.setAttribute("title",mxResources.get("lockUnlock"));p=f.view.getState(i);w=p!=null?p.style:f.getCellStyle(i);mxUtils.getValue(w,"locked","0")=="1"?c.setAttribute("src",Dialog.prototype.lockedImage):c.setAttribute("src",Dialog.prototype.unlockedImage);f.isEnabled()&&(c.style.cursor="pointer");mxEvent.addListener(c,"click",function(n){if(f.isEnabled()){var t=null;f.getModel().beginUpdate();try{t=mxUtils.getValue(w,"locked","0")=="1"?null:"1";f.setCellStyles("locked",t,[i])}finally{f.getModel().endUpdate()}t=="1"&&f.removeSelectionCells(f.getModel().getDescendants(i));mxEvent.consume(n)}});y.appendChild(c);l=document.createElement("input");l.setAttribute("type","checkbox");l.setAttribute("title",mxResources.get("hideIt",[i.value||mxResources.get("background")]));l.style.marginLeft="4px";l.style.marginRight="6px";l.style.marginTop="4px";y.appendChild(l);f.model.isVisible(i)&&(l.setAttribute("checked","checked"),l.defaultChecked=!0);mxEvent.addListener(l,"click",function(n){f.model.setVisible(i,!f.model.isVisible(i));mxEvent.consume(n)});mxUtils.write(y,t);u.appendChild(y);f.isEnabled()&&((mxClient.IS_TOUCH||mxClient.IS_POINTER||mxClient.IS_VML||mxClient.IS_IE&&document.documentMode<10)&&(a=document.createElement("div"),a.style.display="block",a.style.textAlign="right",a.style.whiteSpace="nowrap",a.style.position="absolute",a.style.right="6px",a.style.top="6px",n>0&&(e=document.createElement("a"),e.setAttribute("title",mxResources.get("toBack")),e.className="geButton",e.style.cssFloat="none",e.innerHTML="&#9660;",e.style.width="14px",e.style.height="14px",e.style.fontSize="14px",e.style.margin="0px",e.style.marginTop="-1px",a.appendChild(e),mxEvent.addListener(e,"click",function(t){f.isEnabled()&&f.addCell(i,f.model.root,n-1);mxEvent.consume(t)})),n>=0&&n<g-1&&(o=document.createElement("a"),o.setAttribute("title",mxResources.get("toFront")),o.className="geButton",o.style.cssFloat="none",o.innerHTML="&#9650;",o.style.width="14px",o.style.height="14px",o.style.fontSize="14px",o.style.margin="0px",o.style.marginTop="-1px",a.appendChild(o),mxEvent.addListener(o,"click",function(t){f.isEnabled()&&f.addCell(i,f.model.root,n+1);mxEvent.consume(t)})),u.appendChild(a)),mxClient.IS_SVG&&(!mxClient.IS_IE||document.documentMode>=10)&&(u.setAttribute("draggable","true"),u.style.cursor="move"));mxEvent.addListener(u,"dblclick",function(n){var t=mxEvent.getSource(n).nodeName;t!="INPUT"&&t!="IMG"&&(nt(i),mxEvent.consume(n))});f.getDefaultParent()==i?(u.style.background="#e6eff8",u.style.fontWeight=f.isEnabled()?"bold":"",h=i):mxEvent.addListener(u,"click",function(){f.isEnabled()&&(f.setDefaultParent(r),f.view.setCurrentRoot(null),k())});s.appendChild(u)}g=f.model.getChildCount(f.model.root);s.innerHTML="";for(var n=g-1;n>=0;n--)mxUtils.bind(this,function(i){t(n,i.value||mxResources.get("background"),i,i)})(f.model.getChildAt(f.model.root,n));y.setAttribute("title",mxResources.get("removeIt",[h.value||mxResources.get("background")]));l.setAttribute("title",mxResources.get("moveSelectionTo",[h.value||mxResources.get("background")]));p.setAttribute("title",mxResources.get("duplicateIt",[h.value||mxResources.get("background")]));a.setAttribute("title",mxResources.get("renameIt",[h.value||mxResources.get("background")]));f.isSelectionEmpty()&&(l.className="geButton mxDisabled")}var f=n.editor.graph,o=document.createElement("div"),d,s,b,v,c,y,l,a,p,w;o.style.userSelect="none";o.style.background=Dialog.backdropColor=="white"?"whiteSmoke":Dialog.backdropColor;o.style.border="1px solid whiteSmoke";o.style.height="100%";o.style.marginBottom="10px";o.style.overflow="auto";d=EditorUi.compactUi?"26px":"30px";s=document.createElement("div");s.style.backgroundColor=Dialog.backdropColor=="white"?"#a2a2a2":"#e5e5e5";s.style.position="absolute";s.style.overflow="auto";s.style.left="0px";s.style.right="0px";s.style.top="0px";s.style.bottom=parseInt(d)+7+"px";o.appendChild(s);b=null;v=null;mxEvent.addListener(o,"dragover",function(n){n.dataTransfer.dropEffect="move";v=0;n.stopPropagation();n.preventDefault()});mxEvent.addListener(o,"drop",function(n){n.stopPropagation();n.preventDefault()});var g=null,h=null,e=document.createElement("div");e.className="geToolbarContainer";e.style.position="absolute";e.style.bottom="0px";e.style.left="0px";e.style.right="0px";e.style.height=d;e.style.overflow="hidden";e.style.padding=EditorUi.compactUi?"4px 0px 3px 0px":"1px";e.style.backgroundColor=Dialog.backdropColor=="white"?"whiteSmoke":Dialog.backdropColor;e.style.borderWidth="1px 0px 0px 0px";e.style.borderColor="#c3c3c3";e.style.borderStyle="solid";e.style.display="block";e.style.whiteSpace="nowrap";mxClient.IS_QUIRKS&&(e.style.filter="none");c=document.createElement("a");c.className="geButton";mxClient.IS_QUIRKS&&(c.style.filter="none");y=c.cloneNode();y.innerHTML='<div class="geSprite geSprite-delete" style="display:inline-block;"><\/div>';mxEvent.addListener(y,"click",function(n){if(f.isEnabled()){f.model.beginUpdate();try{var t=f.model.root.getIndex(h);f.removeCells([h],!1);f.model.getChildCount(f.model.root)==0?(f.model.add(f.model.root,new mxCell),f.setDefaultParent(null)):t>0&&t<=f.model.getChildCount(f.model.root)?f.setDefaultParent(f.model.getChildAt(f.model.root,t-1)):f.setDefaultParent(null)}finally{f.model.endUpdate()}}mxEvent.consume(n)});f.isEnabled()||(y.className="geButton mxDisabled");e.appendChild(y);l=c.cloneNode();l.innerHTML='<div class="geSprite geSprite-insert" style="display:inline-block;"><\/div>';mxEvent.addListener(l,"click",function(){f.isEnabled()&&!f.isSelectionEmpty()&&f.moveCells(f.getSelectionCells(),0,0,!1,h)});e.appendChild(l);a=c.cloneNode();a.innerHTML='<div class="geSprite geSprite-dots" style="display:inline-block;"><\/div>';a.setAttribute("title",mxResources.get("rename"));mxEvent.addListener(a,"click",function(n){f.isEnabled()&&nt(h);mxEvent.consume(n)});f.isEnabled()||(a.className="geButton mxDisabled");e.appendChild(a);p=c.cloneNode();p.innerHTML='<div class="geSprite geSprite-duplicate" style="display:inline-block;"><\/div>';mxEvent.addListener(p,"click",function(){if(f.isEnabled()){var n=null;f.model.beginUpdate();try{n=f.cloneCells([h])[0];n.value=mxResources.get("untitledLayer");n.setVisible(!0);n=f.addCell(n,f.model.root);f.setDefaultParent(n)}finally{f.model.endUpdate()}n==null||f.isCellLocked(n)||f.selectAll(n)}});f.isEnabled()||(p.className="geButton mxDisabled");e.appendChild(p);w=c.cloneNode();w.innerHTML='<div class="geSprite geSprite-plus" style="display:inline-block;"><\/div>';w.setAttribute("title",mxResources.get("addLayer"));mxEvent.addListener(w,"click",function(n){if(f.isEnabled()){f.model.beginUpdate();try{var t=f.addCell(new mxCell(mxResources.get("untitledLayer")),f.model.root);f.setDefaultParent(t)}finally{f.model.endUpdate()}}mxEvent.consume(n)});f.isEnabled()||(w.className="geButton mxDisabled");e.appendChild(w);o.appendChild(e);k();f.model.addListener(mxEvent.CHANGE,function(){k()});f.selectionModel.addListener(mxEvent.CHANGE,function(){l.className=f.isSelectionEmpty()?"geButton mxDisabled":"geButton"});this.window=new mxWindow(mxResources.get("layers"),o,t,i,r,u,!0,!0);this.window.destroyOnClose=!1;this.window.setMaximizable(!1);this.window.setResizable(!0);this.window.setClosable(!0);this.window.setVisible(!0);this.refreshLayers=k;this.window.setLocation=function(n,t){var i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;n=Math.max(0,Math.min(n,i-this.table.clientWidth));t=Math.max(0,Math.min(t,r-this.table.clientHeight-48));(this.getX()!=n||this.getY()!=t)&&mxWindow.prototype.setLocation.apply(this,arguments)};mxEvent.addListener(window,"resize",mxUtils.bind(this,function(){var n=this.window.getX(),t=this.window.getY();this.window.setLocation(n,t)}))};