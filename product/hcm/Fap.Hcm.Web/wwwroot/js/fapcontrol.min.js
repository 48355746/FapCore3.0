/**
*
* @license Guriddo jqGrid JS - v5.2.0 - 2016-11-21
* Copyright(c) 2008, Tony Tomov, tony@trirand.com
* 
* License: http://guriddo.net/?page_id=103334
*/
function getSelectedRows(n){var i=$("#"+n),e=i.getGridParam("selrow"),r,u,t,f;if(e){for(r=i.getGridParam("selarrrow"),u=[],t=0;t<r.length;t++)f=i.jqGrid("getRowData",r[t]),u.push(f);return u}return $.msg("没有行被选中！"),null}function getSelectedRow(n){var t=$("#"+n),i=t.getGridParam("selrow");return i?t.jqGrid("getRowData",i):($.msg("没有行被选中！"),null)}function refreshBaseJqGrid(n){var t=$("#"+n);t.jqGrid("setGridParam",{}).trigger("reloadGrid")}function updatePagerIcons(){var n={"ui-icon-seek-first":"ace-icon fa fa-angle-double-left bigger-140","ui-icon-seek-prev":"ace-icon fa fa-angle-left bigger-140","ui-icon-seek-next":"ace-icon fa fa-angle-right bigger-140","ui-icon-seek-end":"ace-icon fa fa-angle-double-right bigger-140"};$(".ui-pg-table:not(.navtable) > tbody > tr > .ui-pg-button > .ui-icon").each(function(){var t=$(this),i=$.trim(t.attr("class").replace("ui-icon",""));i in n&&t.attr("class","ui-icon "+n[i])})}function enableTooltips(n){$(".navtable .ui-pg-button").tooltip({container:"body"});$(n).find(".ui-pg-div").tooltip({container:"body"})}function style_edit_form(n){var t=n.next().find(".EditButton .fm-button");t.addClass("btn btn-sm").find('[class*="-icon"]').hide();t.eq(0).addClass("btn-primary").prepend('<i class="ace-icon fa fa-check"><\/i>');t.eq(1).prepend('<i class="ace-icon fa fa-times"><\/i>');t=n.next().find(".navButton a");t.find(".ui-icon").hide();t.eq(0).append('<i class="ace-icon fa fa-chevron-left"><\/i>');t.eq(1).append('<i class="ace-icon fa fa-chevron-right"><\/i>')}function style_delete_form(n){var t=n.next().find(".EditButton .fm-button");t.addClass("btn btn-sm btn-white btn-round").find('[class*="-icon"]').hide();t.eq(0).addClass("btn-danger").prepend('<i class="ace-icon fa fa-trash-o"><\/i>');t.eq(1).addClass("btn-default").prepend('<i class="ace-icon fa fa-times"><\/i>')}function style_search_filters(n){n.find(".delete-rule").val("X");n.find(".add-rule").addClass("btn btn-xs btn-primary");n.find(".add-group").addClass("btn btn-xs btn-success");n.find(".delete-group").addClass("btn btn-xs btn-danger")}function style_search_form(n){var i=n.closest(".ui-jqdialog"),t=i.find(".EditTable");t.find('.EditButton a[id*="_reset"]').addClass("btn btn-sm btn-info").find(".ui-icon").attr("class","ace-icon fa fa-retweet");t.find('.EditButton a[id*="_query"]').addClass("btn btn-sm btn-inverse").find(".ui-icon").attr("class","ace-icon fa fa-comment-o");t.find('.EditButton a[id*="_search"]').addClass("btn btn-sm btn-purple").find(".ui-icon").attr("class","ace-icon fa fa-search")}function beforeDeleteCallback(n){var t=$(n[0]);if(t.data("styled"))return!1;t.closest(".ui-jqdialog").find(".ui-jqdialog-titlebar").wrapInner('<div class="widget-header" />');style_delete_form(t);t.data("styled",!0)}function beforeEditCallback(n){var t=$(n[0]);t.closest(".ui-jqdialog").find(".ui-jqdialog-titlebar").wrapInner('<div class="widget-header" />');style_edit_form(t)}function formatRating(n){var t=parseInt(n)>0?"green":"red";return"<span style='color:"+t+"' originalValue='"+n+"'>"+n+"<\/span>"}function unformatRating(n,t,i){return $(i.html()).attr("originalValue")}function formatCheckboxList(n){var r,u,f,e,t,i;if(!n)return"<span  originalValue=''><\/span>";if(r=n.split(";"),u=r.length,u<1)return"<span  originalValue='"+n+"'>"+n+"<\/span>";for(f=[],e=[],t=0;t<u;t++)i=r[t].split(":"),i.length>0&&(f.push(i[0]),e.push(i[1]));return"<span  originalValue='"+f.join()+"'>"+e.join()+"<\/span>"}function unformatCheckboxList(n,t,i){return $(i.html()).attr("originalValue")}function createReferenceEditElement(n,t,i){var r=t.name+"MC",u=i[r];return $('<span class="col-sm-11"><span class="input-icon input-icon-right"><input type="text" id="form-field-icon-2" data-value="'+n+'" value="'+u+'" /> <i class="ace-icon fa fa-search block"><\/i>        <\/span><\/span >')}function getReferenceElementValue(n,t,i){if(t==="set"){var r=$(n).find("input:text");r.val(i).data("value",i)}if(t==="get")return $(n).find("input:text").data("value")===undefined?"":$(n).find("input:text").data("value")}var extendToolBar;(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){"use strict";function nt(n,t){var i,r,u=[],f;if(!this||typeof n!="function"||n instanceof RegExp)throw new TypeError;for(f=this.length,i=0;i<f;i++)if(this.hasOwnProperty(i)&&(r=this[i],n.call(t,r,i,this))){u.push(r);break}return u}var t,w,r,o;n.jgrid=n.jgrid||{};n.jgrid.hasOwnProperty("defaults")||(n.jgrid.defaults={});n.extend(n.jgrid,{version:"5.2.0",htmlDecode:function(n){return n&&(n==="&nbsp;"||n==="&#160;"||n.length===1&&n.charCodeAt(0)===160)?"":n?String(n).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&"):n},htmlEncode:function(n){return n?String(n).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n},template:function(t){var r=n.makeArray(arguments).slice(1),i,u=r.length;return t==null&&(t=""),t.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(t,f){if(!isNaN(parseInt(f,10)))return r[parseInt(f,10)];for(i=0;i<u;i++)if(n.isArray(r[i]))for(var e=r[i],o=e.length;o--;)if(f===e[o].nm)return e[o].v})},msie:function(){return n.jgrid.msiever()>0},msiever:function(){var n=0,t=window.navigator.userAgent,i=t.indexOf("MSIE");return i>0?n=parseInt(t.substring(i+5,t.indexOf(".",i))):!navigator.userAgent.match(/Trident\/7\./)||(n=11),n},getCellIndex:function(t){var i=n(t);return i.is("tr")?-1:(i=(!i.is("td")&&!i.is("th")?i.closest("td,th"):i)[0],n.jgrid.msie())?n.inArray(i,i.parentNode.cells):i.cellIndex},stripHtml:function(n){n=String(n);return n?(n=n.replace(/<("[^"]*"|'[^']*'|[^'">])*>/gi,""),n&&n!=="&nbsp;"&&n!=="&#160;"?n.replace(/\"/g,"'"):""):n},stripPref:function(t,i){var r=n.type(t);return(r==="string"||r==="number")&&(t=String(t),i=t!==""?String(i).replace(String(t),""):i),i},useJSON:!0,parse:function(t){var i=t;return i.substr(0,9)==="while(1);"&&(i=i.substr(9)),i.substr(0,2)==="/*"&&(i=i.substr(2,i.length-4)),i||(i="{}"),n.jgrid.useJSON===!0&&typeof JSON=="object"&&typeof JSON.parse=="function"?JSON.parse(i):eval("("+i+")")},parseDate:function(t,i,r,u){var rt=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),l=typeof i=="string"?i.match(rt):null,c=function(n,t){for(n=String(n),t=parseInt(t,10)||2;n.length<t;)n="0"+n;return n},f={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},e=0,s,o,nt,tt=function(n,t){return n===0?t===12&&(t=0):t!==12&&(t+=12),t},h=0,v;if(u===undefined&&(u=n.jgrid.getRegional(this,"formatter.date")),u.parseRe===undefined&&(u.parseRe=/[#%\\\/:_;.,\t\s-]/),u.masks.hasOwnProperty(t)&&(t=u.masks[t]),i&&i!=null)if(isNaN(+i)||String(t).toLowerCase()!=="u")if(i.constructor===Date)e=i;else if(l!==null)e=new Date(parseInt(l[1],10)),l[3]&&(h=Number(l[5])*60+Number(l[6]),h*=l[4]==="-"?1:-1,h-=e.getTimezoneOffset(),e.setTime(Number(Number(e)+h*6e4)));else{for(u.srcformat==="ISO8601Long"&&i.charAt(i.length-1)==="Z"&&(h-=(new Date).getTimezoneOffset()),i=String(i).replace(/\T/g,"#").replace(/\t/,"%").split(u.parseRe),t=t.replace(/\T/g,"#").replace(/\t/,"%").split(u.parseRe),o=0,nt=t.length;o<nt;o++){switch(t[o]){case"M":s=n.inArray(i[o],u.monthNames);s!==-1&&s<12&&(i[o]=s+1,f.m=i[o]);break;case"F":s=n.inArray(i[o],u.monthNames,12);s!==-1&&s>11&&(i[o]=s+1-12,f.m=i[o]);break;case"n":t[o]="m";break;case"j":t[o]="d";break;case"a":s=n.inArray(i[o],u.AmPm);s!==-1&&s<2&&i[o]===u.AmPm[s]&&(i[o]=s,f.h=tt(i[o],f.h));break;case"A":s=n.inArray(i[o],u.AmPm);s!==-1&&s>1&&i[o]===u.AmPm[s]&&(i[o]=s-2,f.h=tt(i[o],f.h));break;case"g":f.h=parseInt(i[o],10)}i[o]!==undefined&&(f[t[o].toLowerCase()]=parseInt(i[o],10))}if(f.f&&(f.m=f.f),f.m===0&&f.y===0&&f.d===0)return"&#160;";f.m=parseInt(f.m,10)-1;v=f.y;v>=70&&v<=99?f.y=1900+f.y:v>=0&&v<=69&&(f.y=2e3+f.y);e=new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u);h>0&&e.setTime(Number(Number(e)+h*6e4))}else e=new Date(parseFloat(i)*1e3);else e=new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u);if(u.userLocalTime&&h===0&&(h-=(new Date).getTimezoneOffset(),h>0&&e.setTime(Number(Number(e)+h*6e4))),r===undefined)return e;u.masks.hasOwnProperty(r)?r=u.masks[r]:r||(r="Y-m-d");var a=e.getHours(),ut=e.getMinutes(),w=e.getDate(),y=e.getMonth()+1,d=e.getTimezoneOffset(),ft=e.getSeconds(),et=e.getMilliseconds(),b=e.getDay(),p=e.getFullYear(),k=(b+6)%7+1,g=(new Date(p,y-1,w)-new Date(p,0,1))/864e5,it={d:c(w),D:u.dayNames[b],j:w,l:u.dayNames[b+7],N:k,S:u.S(w),w:b,z:g,W:k<5?Math.floor((g+k-1)/7)+1:Math.floor((g+k-1)/7)||((new Date(p-1,0,1).getDay()+6)%7<4?53:52),F:u.monthNames[y- -11],m:c(y),M:u.monthNames[y-1],n:y,t:"?",L:"?",o:"?",Y:p,y:String(p).substring(2),a:a<12?u.AmPm[0]:u.AmPm[1],A:a<12?u.AmPm[2]:u.AmPm[3],B:"?",g:a%12||12,G:a,h:c(a%12||12),H:c(a),i:c(ut),s:c(ft),u:et,e:"?",I:"?",O:(d>0?"-":"+")+c(Math.floor(Math.abs(d)/60)*100+Math.abs(d)%60,4),P:"?",T:(String(e).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(e/1e3)};return r.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(n){return it.hasOwnProperty(n)?it[n]:n.substring(1)})},jqID:function(n){return String(n).replace(/[!"#$%&'()*+,.\/:; <=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(t){return(t||n.jgrid.uidPref)+n.jgrid.guid++},getAccessor:function(n,t){var i,f,r=[],u;if(typeof t=="function")return t(n);if(i=n[t],i===undefined)try{if(typeof t=="string"&&(r=t.split(".")),u=r.length,u)for(i=n;i&&u--;)f=r.shift(),i=i[f]}catch(e){}return i},getXmlData:function(t,i,r){var f,u=typeof i=="string"?i.match(/^(.*)\[(\w+)\]$/):null;return typeof i=="function"?i(t):u&&u[2]?u[1]?n(u[1],t).attr(u[2]):n(t).attr(u[2]):(f=n(i,t),r)?f:f.length>0?n(f).text():undefined},cellWidth:function(){var t=n("<div class='ui-jqgrid' style='left:10000px'><table class='ui-jqgrid-btable ui-common-table' style='width:5px;'><tr class='jqgrow'><td style='width:5px;display:block;'><\/td><\/tr><\/table><\/div>"),i=t.appendTo("body").find("td").width();return t.remove(),Math.abs(i-5)>.1},isLocalStorage:function(){try{return"localStorage"in window&&window.localStorage!==null}catch(n){return!1}},getRegional:function(t,i,r){var u;return r!==undefined?r:(t.p&&t.p.regional&&n.jgrid.regional&&(u=n.jgrid.getAccessor(n.jgrid.regional[t.p.regional]||{},i)),u===undefined&&(u=n.jgrid.getAccessor(n.jgrid,i)),u)},isMobile:function(){try{return/Android|webOS|iPhone|iPad|iPod|pocket|psp|kindle|avantgo|blazer|midori|Tablet|Palm|maemo|plucker|phone|BlackBerry|symbian|IEMobile|mobile|ZuneWP7|Windows Phone|Opera Mini/i.test(navigator.userAgent)?!0:!1}catch(n){return!1}},cell_width:!0,ajaxOptions:{},from:function(t){var i=this,r=function(t,r){typeof t=="string"&&(t=n.data(t));var u=this,f=t,c=!0,s=!1,e=r,y=/[\$,%]/g,l=null,p=null,w=0,o=!1,v="",h=[],a=!0;if(typeof t=="object"&&t.push)t.length>0&&(a=typeof t[0]!="object"?!1:!0);else throw"data provides is not an array";return this._hasData=function(){return f===null?!1:f.length===0?!1:!0},this._getStr=function(n){var t=[];return s&&t.push("jQuery.trim("),t.push("String("+n+")"),s&&t.push(")"),c||t.push(".toLowerCase()"),t.join("")},this._strComp=function(n){return typeof n=="string"?".toString()":""},this._group=function(n,t){return{field:n.toString(),unique:t,items:[]}},this._toStr=function(t){return s&&(t=n.trim(t)),t=t.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"'),c?t:t.toLowerCase()},this._funcLoop=function(t){var i=[];return n.each(f,function(n,r){i.push(t(r))}),i},this._append=function(n){var t;for(e===null?e="":e+=v===""?" && ":v,t=0;t<w;t++)e+="(";o&&(e+="!");e+="("+n+")";o=!1;v="";w=0},this._setCommand=function(n,t){l=n;p=t},this._resetNegate=function(){o=!1},this._repeatCommand=function(n,t){return l===null?u:n!==null&&t!==null?l(n,t):p===null?l(n):a?l(p,n):l(n)},this._equals=function(n,t){return u._compare(n,t,1)===0},this._compare=function(n,t,i){var r=Object.prototype.toString;return(i===undefined&&(i=1),n===undefined&&(n=null),t===undefined&&(t=null),n===null&&t===null)?0:n===null&&t!==null?1:n!==null&&t===null?-1:r.call(n)==="[object Date]"&&r.call(t)==="[object Date]"?n<t?-i:n>t?i:0:(c||typeof n=="number"||typeof t=="number"||(n=String(n),t=String(t)),n<t)?-i:n>t?i:0},this._performSort=function(){h.length!==0&&(f=u._doSort(f,0))},this._doSort=function(n,t){var s=h[t].by,c=h[t].dir,l=h[t].type,a=h[t].datefmt,v=h[t].sfunc,f,e,i,r,o;if(t===h.length-1)return u._getOrder(n,s,c,l,a,v);for(t++,f=u._getGroup(n,s,c,l,a),e=[],i=0;i<f.length;i++)for(o=u._doSort(f[i].items,t),r=0;r<o.length;r++)e.push(o[r]);return e},this._getOrder=function(t,r,f,e,o,s){var v=[],l=[],p=f==="a"?1:-1,w,h,a,b,k;for(e===undefined&&(e="text"),b=e==="float"||e==="number"||e==="currency"||e==="numeric"?function(n){var t=parseFloat(String(n).replace(y,""));return isNaN(t)?Number.NEGATIVE_INFINITY:t}:e==="int"||e==="integer"?function(n){return n?parseFloat(String(n).replace(y,"")):Number.NEGATIVE_INFINITY}:e==="date"||e==="datetime"?function(t){return n.jgrid.parseDate.call(i,o,t).getTime()}:n.isFunction(e)?e:function(t){return t=t?n.trim(String(t)):"",c?t:t.toLowerCase()},n.each(t,function(t,i){h=r!==""?n.jgrid.getAccessor(i,r):i;h===undefined&&(h="");h=b(h,i);l.push({vSort:h,index:t})}),n.isFunction(s)?l.sort(function(n,t){return s.call(this,n.vSort,t.vSort,p,n,t)}):l.sort(function(n,t){return u._compare(n.vSort,t.vSort,p)}),a=0,k=t.length;a<k;)w=l[a].index,v.push(t[w]),a++;return v},this._getGroup=function(t,i,r,f,e){var h=[],o=null,c=null,s;return n.each(u._getOrder(t,i,r,f,e),function(t,r){s=n.jgrid.getAccessor(r,i);s==null&&(s="");u._equals(c,s)||(c=s,o!==null&&h.push(o),o=u._group(i,s));o.items.push(r)}),o!==null&&h.push(o),h},this.ignoreCase=function(){return c=!1,u},this.useCase=function(){return c=!0,u},this.trim=function(){return s=!0,u},this.noTrim=function(){return s=!1,u},this.execute=function(){var t=e,i=[];return t===null?u:(n.each(f,function(){eval(t)&&i.push(this)}),f=i,u)},this.data=function(){return f},this.select=function(t){if(u._performSort(),!u._hasData())return[];if(u.execute(),n.isFunction(t)){var i=[];return n.each(f,function(n,r){i.push(t(r))}),i}return f},this.hasMatch=function(){return u._hasData()?(u.execute(),f.length>0):!1},this.andNot=function(n,t,i){return o=!o,u.and(n,t,i)},this.orNot=function(n,t,i){return o=!o,u.or(n,t,i)},this.not=function(n,t,i){return u.andNot(n,t,i)},this.and=function(n,t,i){return(v=" && ",n===undefined)?u:u._repeatCommand(n,t,i)},this.or=function(n,t,i){return(v=" || ",n===undefined)?u:u._repeatCommand(n,t,i)},this.orBegin=function(){return w++,u},this.orEnd=function(){return e!==null&&(e+=")"),u},this.isNot=function(n){return o=!o,u.is(n)},this.is=function(n){return u._append("this."+n),u._resetNegate(),u},this._compareValues=function(t,r,f,e,o){var h,s,c;if(h=a?"jQuery.jgrid.getAccessor(this,'"+r+"')":"this",f===undefined&&(f=null),s=f,c=o.stype===undefined?"text":o.stype,f!==null)switch(c){case"int":case"integer":s=isNaN(Number(s))||s===""?"0":s;h="parseInt("+h+",10)";s="parseInt("+s+",10)";break;case"float":case"number":case"numeric":s=String(s).replace(y,"");s=isNaN(Number(s))||s===""?"0":s;h="parseFloat("+h+")";s="parseFloat("+s+")";break;case"date":case"datetime":s=String(n.jgrid.parseDate.call(i,o.srcfmt||"Y-m-d",s).getTime());h='jQuery.jgrid.parseDate.call(jQuery("#'+n.jgrid.jqID(i.p.id)+'")[0],"'+o.srcfmt+'",'+h+").getTime()";break;default:h=u._getStr(h);s=u._getStr('"'+u._toStr(s)+'"')}return u._append(h+" "+e+" "+s),u._setCommand(t,r),u._resetNegate(),u},this.equals=function(n,t,i){return u._compareValues(u.equals,n,t,"==",i)},this.notEquals=function(n,t,i){return u._compareValues(u.equals,n,t,"!==",i)},this.isNull=function(n,t,i){return u._compareValues(u.equals,n,null,"===",i)},this.greater=function(n,t,i){return u._compareValues(u.greater,n,t,">",i)},this.less=function(n,t,i){return u._compareValues(u.less,n,t,"<",i)},this.greaterOrEquals=function(n,t,i){return u._compareValues(u.greaterOrEquals,n,t,">=",i)},this.lessOrEquals=function(n,t,i){return u._compareValues(u.lessOrEquals,n,t,"<=",i)},this.startsWith=function(t,i){var f=i==null?t:i,r=s?n.trim(f.toString()).length:f.toString().length;return a?u._append(u._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".substr(0,"+r+") == "+u._getStr('"'+u._toStr(i)+'"')):(i!=null&&(r=s?n.trim(i.toString()).length:i.toString().length),u._append(u._getStr("this")+".substr(0,"+r+") == "+u._getStr('"'+u._toStr(t)+'"'))),u._setCommand(u.startsWith,t),u._resetNegate(),u},this.endsWith=function(t,i){var r=i==null?t:i,f=s?n.trim(r.toString()).length:r.toString().length;return a?u._append(u._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".substr("+u._getStr("jQuery.jgrid.getAccessor(this,'"+t+"')")+".length-"+f+","+f+') == "'+u._toStr(i)+'"'):u._append(u._getStr("this")+".substr("+u._getStr("this")+'.length-"'+u._toStr(t)+'".length,"'+u._toStr(t)+'".length) == "'+u._toStr(t)+'"'),u._setCommand(u.endsWith,t),u._resetNegate(),u},this.contains=function(n,t){return a?u._append(u._getStr("jQuery.jgrid.getAccessor(this,'"+n+"')")+'.indexOf("'+u._toStr(t)+'",0) > -1'):u._append(u._getStr("this")+'.indexOf("'+u._toStr(n)+'",0) > -1'),u._setCommand(u.contains,n),u._resetNegate(),u},this.groupBy=function(n,t,i,r){return u._hasData()?u._getGroup(f,n,t,i,r):null},this.orderBy=function(t,i,r,f,e){return i=i==null?"a":n.trim(i.toString().toLowerCase()),r==null&&(r="text"),f==null&&(f="Y-m-d"),e==null&&(e=!1),(i==="desc"||i==="descending")&&(i="d"),(i==="asc"||i==="ascending")&&(i="a"),h.push({by:t,dir:i,type:r,datefmt:f,sfunc:e}),u},u};return new r(t,null)},getMethod:function(t){return this.getAccessor(n.fn.jqGrid,t)},extend:function(t){n.extend(n.fn.jqGrid,t);this.no_legacy_api||n.fn.extend(t)},clearBeforeUnload:function(t){var r=n("#"+n.jgrid.jqID(t))[0],u,i,e,f;if(r&&r.grid){for(u=r.grid,n.isFunction(u.emptyRows)&&u.emptyRows.call(r,!0,!0),n(document).off("mouseup.jqGrid"+r.p.id),n(u.hDiv).off("mousemove"),n(r).off(),e=u.headers.length,f=["formatCol","sortData","updatepager","refreshIndex","setHeadCheckBox","constructTr","formatter","addXmlData","addJSONData","grid","p","addLocalData"],i=0;i<e;i++)u.headers[i].el=null;for(i in u)u.hasOwnProperty(i)&&(u[i]=null);for(i in r.p)r.p.hasOwnProperty(i)&&(r.p[i]=n.isArray(r.p[i])?[]:null);for(e=f.length,i=0;i<e;i++)r.hasOwnProperty(f[i])&&(r[f[i]]=null,delete r[f[i]])}},gridUnload:function(t){var i,f,u,r;t&&(t=n.trim(t),t.indexOf("#")===0&&(t=t.substring(1)),i=n("#"+n.jgrid.jqID(t))[0],i&&i.grid)&&(f={id:n(i).attr("id"),cl:n(i).attr("class")},i.p.pager&&n(i.p.pager).off().empty().removeClass("ui-state-default ui-jqgrid-pager ui-corner-bottom"),u=document.createElement("table"),u.className=f.cl,r=n.jgrid.jqID(i.id),n(u).removeClass("ui-jqgrid-btable ui-common-table").insertBefore("#gbox_"+r),n(i.p.pager).parents("#gbox_"+r).length===1&&n(i.p.pager).insertBefore("#gbox_"+r),n.jgrid.clearBeforeUnload(t),n("#gbox_"+r).remove(),n(u).attr({id:f.id}),n("#alertmod_"+n.jgrid.jqID(t)).remove())},gridDestroy:function(t){if(t){t=n.trim(t);t.indexOf("#")===0&&(t=t.substring(1));var i=n("#"+n.jgrid.jqID(t))[0];if(i&&i.grid){i.p.pager&&n(i.p.pager).remove();try{n.jgrid.clearBeforeUnload(t);n("#gbox_"+n.jgrid.jqID(t)).remove()}catch(r){}}}},styleUI:{jQueryUI:{common:{disabled:"ui-state-disabled",highlight:"ui-state-highlight",hover:"ui-state-hover",cornerall:"ui-corner-all",cornertop:"ui-corner-top",cornerbottom:"ui-corner-bottom",hidden:"ui-helper-hidden",icon_base:"ui-icon",overlay:"ui-widget-overlay",active:"ui-state-active",error:"ui-state-error",button:"ui-state-default ui-corner-all",content:"ui-widget-content"},base:{entrieBox:"ui-widget ui-widget-content ui-corner-all",viewBox:"",headerTable:"",headerBox:"ui-state-default",rowTable:"",rowBox:"ui-widget-content",footerTable:"",footerBox:"ui-widget-content",headerDiv:"ui-state-default",gridtitleBox:"ui-widget-header ui-corner-top ui-helper-clearfix",customtoolbarBox:"ui-state-default",loadingBox:"ui-state-default ui-state-active",rownumBox:"ui-state-default",scrollBox:"ui-widget-content",multiBox:"",pagerBox:"ui-state-default ui-corner-bottom",pagerTable:"",toppagerBox:"ui-state-default",pgInput:"ui-corner-all",pgSelectBox:"ui-widget-content ui-corner-all",pgButtonBox:"ui-corner-all",icon_first:"ui-icon-seek-first",icon_prev:"ui-icon-seek-prev",icon_next:"ui-icon-seek-next",icon_end:"ui-icon-seek-end",icon_asc:"ui-icon-triangle-1-n",icon_desc:"ui-icon-triangle-1-s",icon_caption_open:"ui-icon-circle-triangle-n",icon_caption_close:"ui-icon-circle-triangle-s"},modal:{modal:"ui-widget ui-widget-content ui-corner-all ui-dialog",header:"ui-widget-header ui-corner-all ui-helper-clearfix",content:"ui-widget-content",resizable:"ui-resizable-handle ui-resizable-se",icon_close:"ui-icon-closethick",icon_resizable:"ui-icon-gripsmall-diagonal-se"},celledit:{inputClass:"ui-widget-content ui-corner-all"},inlinedit:{inputClass:"ui-widget-content ui-corner-all",icon_edit_nav:"ui-icon-pencil",icon_add_nav:"ui-icon-plus",icon_save_nav:"ui-icon-disk",icon_cancel_nav:"ui-icon-cancel"},formedit:{inputClass:"ui-widget-content ui-corner-all",icon_prev:"ui-icon-triangle-1-w",icon_next:"ui-icon-triangle-1-e",icon_save:"ui-icon-disk",icon_close:"ui-icon-close",icon_del:"ui-icon-scissors",icon_cancel:"ui-icon-cancel"},navigator:{icon_edit_nav:"ui-icon-pencil",icon_add_nav:"ui-icon-plus",icon_del_nav:"ui-icon-trash",icon_search_nav:"ui-icon-search",icon_refresh_nav:"ui-icon-refresh",icon_view_nav:"ui-icon-document",icon_newbutton_nav:"ui-icon-newwin"},grouping:{icon_plus:"fa fa-plus",icon_minus:"fa fa-minus"},filter:{table_widget:"ui-widget ui-widget-content",srSelect:"ui-widget-content ui-corner-all",srInput:"ui-widget-content ui-corner-all",menu_widget:"ui-widget ui-widget-content ui-corner-all",icon_search:"ui-icon-search",icon_reset:"ui-icon-arrowreturnthick-1-w",icon_query:"ui-icon-comment"},subgrid:{icon_plus:"ui-icon-plus",icon_minus:"ui-icon-minus",icon_open:"ui-icon-carat-1-sw"},treegrid:{icon_plus:"ui-icon-triangle-1-",icon_minus:"ui-icon-triangle-1-s",icon_leaf:"ui-icon-radio-off"},fmatter:{icon_edit:"ui-icon-pencil",icon_add:"ui-icon-plus",icon_save:"ui-icon-disk",icon_cancel:"ui-icon-cancel",icon_del:"ui-icon-trash"},colmenu:{menu_widget:"ui-widget ui-widget-content ui-corner-all",input_checkbox:"ui-widget ui-widget-content",filter_select:"ui-widget-content ui-corner-all",filter_input:"ui-widget-content ui-corner-all",icon_menu:"ui-icon-comment",icon_sort_asc:"ui-icon-arrow-1-n",icon_sort_desc:"ui-icon-arrow-1-s",icon_columns:"ui-icon-extlink",icon_filter:"ui-icon-calculator",icon_group:"ui-icon-grip-solid-horizontal",icon_freeze:"ui-icon-grip-solid-vertical",icon_move:"ui-icon-arrow-4"}},Bootstrap:{common:{disabled:"ui-disabled",highlight:"success",hover:"active",cornerall:"",cornertop:"",cornerbottom:"",hidden:"",icon_base:"glyphicon",overlay:"ui-overlay",active:"active",error:"bg-danger",button:"btn btn-default",content:""},base:{entrieBox:"",viewBox:"table-responsive",headerTable:"table table-bordered",headerBox:"",rowTable:"table table-bordered",rowBox:"",footerTable:"table table-bordered",footerBox:"",headerDiv:"",gridtitleBox:"",customtoolbarBox:"",loadingBox:"row",rownumBox:"active",scrollBox:"",multiBox:"checkbox",pagerBox:"",pagerTable:"table",toppagerBox:"",pgInput:"form-control",pgSelectBox:"form-control",pgButtonBox:"",icon_first:"glyphicon-step-backward",icon_prev:"glyphicon-backward",icon_next:"glyphicon-forward",icon_end:"glyphicon-step-forward",icon_asc:"glyphicon-triangle-top",icon_desc:"glyphicon-triangle-bottom",icon_caption_open:"glyphicon-circle-arrow-up",icon_caption_close:"glyphicon-circle-arrow-down"},modal:{modal:"modal-content",header:"modal-header",title:"modal-title",content:"modal-body",resizable:"ui-resizable-handle ui-resizable-se",icon_close:"glyphicon-remove-circle",icon_resizable:"glyphicon-import"},celledit:{inputClass:"form-control"},inlinedit:{inputClass:"form-control",icon_edit_nav:"glyphicon-edit",icon_add_nav:"glyphicon-plus",icon_save_nav:"glyphicon-save",icon_cancel_nav:"glyphicon-remove-circle"},formedit:{inputClass:"form-control",icon_prev:"glyphicon-step-backward",icon_next:"glyphicon-step-forward",icon_save:"glyphicon-save",icon_close:"glyphicon-remove-circle",icon_del:"glyphicon-trash",icon_cancel:"glyphicon-remove-circle"},navigator:{icon_edit_nav:"glyphicon-edit",icon_add_nav:"glyphicon-plus",icon_del_nav:"glyphicon-trash",icon_search_nav:"glyphicon-search",icon_refresh_nav:"glyphicon-refresh",icon_view_nav:"glyphicon-info-sign",icon_newbutton_nav:"glyphicon-new-window"},grouping:{icon_plus:"glyphicon-triangle-right",icon_minus:"glyphicon-triangle-bottom"},filter:{table_widget:"table table-condensed",srSelect:"form-control",srInput:"form-control",menu_widget:"",icon_search:"glyphicon-search",icon_reset:"glyphicon-refresh",icon_query:"glyphicon-comment"},subgrid:{icon_plus:"glyphicon-triangle-right",icon_minus:"glyphicon-triangle-bottom",icon_open:"glyphicon-indent-left"},treegrid:{icon_plus:"glyphicon-triangle-right",icon_minus:"glyphicon-triangle-bottom",icon_leaf:"glyphicon-unchecked"},fmatter:{icon_edit:"glyphicon-edit",icon_add:"glyphicon-plus",icon_save:"glyphicon-save",icon_cancel:"glyphicon-remove-circle",icon_del:"glyphicon-trash"},colmenu:{menu_widget:"",input_checkbox:"",filter_select:"form-control",filter_input:"form-control",icon_menu:"glyphicon-menu-hamburger",icon_sort_asc:"glyphicon-sort-by-alphabet",icon_sort_desc:"glyphicon-sort-by-alphabet-alt",icon_columns:"glyphicon-list-alt",icon_filter:"glyphicon-filter",icon_group:"glyphicon-align-left",icon_freeze:"glyphicon-object-align-horizontal",icon_move:"glyphicon-move"}}}});n.fn.jqGrid=function(t){var i,r;if(typeof t=="string"){if(i=n.jgrid.getMethod(t),!i)throw"jqGrid - No such method: "+t;return r=n.makeArray(arguments).slice(1),i.apply(this,r)}return this.each(function(){var gt,u,i,r,o,si,hi,v,et,yr,bt,ct,ki,kt,di,dt,p,g,gi,fi,nr,ei,oi,wr,br,kr;if(!this.grid){if(t!=null&&t.data!==undefined&&(gt=t.data,t.data=[]),u=n.extend(!0,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:!0,pginput:!0,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:!1,selarrrow:[],savedRow:[],shrinkToFit:!0,xmlReader:{},jsonReader:{},subGrid:!1,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,onInitGrid:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,beforeProcessing:null,onHeaderClick:null,viewrecords:!1,loadonce:!1,multiselect:!1,multikey:!1,editurl:null,search:!1,caption:"",hidegrid:!0,hiddengrid:!1,postData:{},userData:{},treeGrid:!1,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:!1,gridstate:"visible",cellEdit:!1,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[!1,""],scroll:!1,multiboxonly:!1,deselectAfterSort:!0,scrollrows:!1,autowidth:!1,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:30,gridview:!0,rownumWidth:35,rownumbers:!1,pagerpos:"center",recordpos:"right",footerrow:!1,userDataOnFooter:!1,hoverrows:!0,altclass:"ui-priority-secondary",viewsortcols:[!1,"vertical",!0],resizeclass:"",autoencode:!1,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:!1,headertitles:!1,scrollTimeout:40,data:[],_index:{},grouping:!1,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:!1,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"",minusicon:"",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:!1},ignoreCase:!0,cmTemplate:{},idPrefix:"",multiSort:!1,minColWidth:33,scrollPopUp:!1,scrollTopOffset:0,scrollLeftOffset:"100%",storeNavOptions:!1,regional:"en",styleUI:"jQueryUI",responsive:!1,restoreCellonFail:!0,colFilters:{},colMenu:!1},n.jgrid.defaults,t),gt!==undefined&&(u.data=gt,t.data=gt),i=this,r={headers:[],cols:[],footers:[],dragStart:function(t,r,f){var e=n(this.bDiv).offset().left;this.resizing={idx:t,startX:r.pageX,sOL:r.pageX-e};this.hDiv.style.cursor="col-resize";this.curGbox=n("#rs_m"+n.jgrid.jqID(u.id),"#gbox_"+n.jgrid.jqID(u.id));this.curGbox.css({display:"block",left:r.pageX-e,top:f[1],height:f[2]});n(i).triggerHandler("jqGridResizeStart",[r,t]);n.isFunction(u.resizeStart)&&u.resizeStart.call(i,r,t);document.onselectstart=function(){return!1}},dragMove:function(n){if(this.resizing){var t=n.pageX-this.resizing.startX,i=this.headers[this.resizing.idx],f=u.direction==="ltr"?i.width+t:i.width-t,r,e;f>33&&(this.curGbox.css({left:this.resizing.sOL+t}),u.forceFit===!0?(r=this.headers[this.resizing.idx+u.nv],e=u.direction==="ltr"?r.width-t:r.width+t,e>u.minColWidth&&(i.newWidth=f,r.newWidth=e)):(this.newWidth=u.direction==="ltr"?u.tblwidth+t:u.tblwidth-t,i.newWidth=f))}},dragEnd:function(t){if(this.hDiv.style.cursor="default",this.resizing){var r=this.resizing.idx,f=this.headers[r].newWidth||this.headers[r].width;f=parseInt(f,10);this.resizing=!1;n("#rs_m"+n.jgrid.jqID(u.id)).css("display","none");u.colModel[r].width=f;this.headers[r].width=f;this.headers[r].el.style.width=f+"px";this.cols[r].style.width=f+"px";this.footers.length>0&&(this.footers[r].style.width=f+"px");u.forceFit===!0?(f=this.headers[r+u.nv].newWidth||this.headers[r+u.nv].width,this.headers[r+u.nv].width=f,this.headers[r+u.nv].el.style.width=f+"px",this.cols[r+u.nv].style.width=f+"px",this.footers.length>0&&(this.footers[r+u.nv].style.width=f+"px"),u.colModel[r+u.nv].width=f):(u.tblwidth=this.newWidth||u.tblwidth,n("table:first",this.bDiv).css("width",u.tblwidth+"px"),n("table:first",this.hDiv).css("width",u.tblwidth+"px"),this.hDiv.scrollLeft=this.bDiv.scrollLeft,u.footerrow&&(n("table:first",this.sDiv).css("width",u.tblwidth+"px"),this.sDiv.scrollLeft=this.bDiv.scrollLeft));t&&(n(i).triggerHandler("jqGridResizeStop",[f,r]),n.isFunction(u.resizeStop)&&u.resizeStop.call(i,f,r))}this.curGbox=null;document.onselectstart=function(){return!0}},populateVisible:function(){var h,t,v,o;if(r.timer&&clearTimeout(r.timer),r.timer=null,h=n(r.bDiv).height(),h){if(t=n("table:first",r.bDiv),t[0].rows.length)try{v=t[0].rows[1];o=v?n(v).outerHeight()||r.prevRowHeight:r.prevRowHeight}catch(w){o=r.prevRowHeight}if(o){r.prevRowHeight=o;var p=u.rowNum,s=r.scrollTop=r.bDiv.scrollTop,c=Math.round(t.position().top)-s,l=c+t.height(),f=o*p,e,a,y;if(l<h&&c<=0&&(u.lastpage===undefined||(parseInt((l+s+f-1)/f,10)||0)<=u.lastpage)&&(a=parseInt((h-l+f-1)/f,10)||1,l>=0||a<2||u.scroll===!0?(e=(Math.round((l+s)/f)||0)+1,c=-1):c=1),c>0&&(e=(parseInt(s/f,10)||0)+1,a=(parseInt((s+h)/f,10)||0)+2-e,y=!0),a){if(u.lastpage&&(e>u.lastpage||u.lastpage===1||e===u.page&&e===u.lastpage))return;r.hDiv.loading?r.timer=setTimeout(r.populateVisible,u.scrollTimeout):(u.page=e,y&&(r.selectionPreserver(t[0]),r.emptyRows.call(t[0],!1,!1)),r.populate(a));u.scrollPopUp&&u.lastpage!=null&&(n("#scroll_g"+u.id).show().html(n.jgrid.template(n.jgrid.getRegional(i,"defaults.pgtext",u.pgtext),u.page,u.lastpage)).css({top:u.scrollTopOffset+s*((parseInt(u.height,10)-45)/(parseInt(o,10)*parseInt(u.records,10)))+"px",left:u.scrollLeftOffset}),n(this).mouseout(function(){n("#scroll_g"+u.id).hide()}))}}}},scrollGrid:function(t){if(u.scroll){var i=r.bDiv.scrollTop;r.scrollTop===undefined&&(r.scrollTop=0);i!==r.scrollTop&&(r.scrollTop=i,r.timer&&clearTimeout(r.timer),r.timer=setTimeout(r.populateVisible,u.scrollTimeout))}r.hDiv.scrollLeft=r.bDiv.scrollLeft;u.footerrow&&(r.sDiv.scrollLeft=r.bDiv.scrollLeft);u.frozenColumns&&n(r.fbDiv).scrollTop(r.bDiv.scrollTop);t&&t.stopPropagation()},selectionPreserver:function(t){var i=t.p,u=i.selrow,r=i.selarrrow?n.makeArray(i.selarrrow):null,e=t.grid.bDiv.scrollLeft,f=function(){var o;if(i.selrow=null,i.selarrrow=[],i.multiselect&&r&&r.length>0)for(o=0;o<r.length;o++)r[o]!==u&&n(t).jqGrid("setSelection",r[o],!1,null);u&&n(t).jqGrid("setSelection",u,!1,null);t.grid.bDiv.scrollLeft=e;n(t).off(".selectionPreserver",f)};n(t).on("jqGridGridComplete.selectionPreserver",f)}},this.tagName.toUpperCase()!=="TABLE"||this.id==null){alert("Element is not a table or has no id!");return}if(document.documentMode!==undefined&&document.documentMode<=5){alert("Grid can not be used in this ('quirks') mode!");return}o=0;for(hi in n.jgrid.regional)n.jgrid.regional.hasOwnProperty(hi)&&(o===0&&(si=hi),o++);if(o===1&&si!==u.regional&&(u.regional=si),n(this).empty().attr("tabindex","0"),this.p=u,this.p.useProp=!!n.fn.prop,this.p.colNames.length===0)for(o=0;o<this.p.colModel.length;o++)this.p.colNames[o]=this.p.colModel[o].label||this.p.colModel[o].name;if(this.p.colNames.length!==this.p.colModel.length){alert(n.jgrid.getRegional(this,"errors.model"));return}var f=n.jgrid.getMethod("getStyleUI"),e=i.p.styleUI+".common",h=f(e,"disabled",!0),ut=f(e,"highlight",!0),a=f(e,"hover",!0),dr=f(e,"cornerall",!0),nt=f(e,"icon_base",!0),d=n.jgrid.styleUI[i.p.styleUI||"jQueryUI"].colmenu,tr=n.jgrid.msie(),tt,w=[],it=[],ft=[];e=i.p.styleUI+".base";tt=n("<div "+f(e,"viewBox",!1,"ui-jqgrid-view")+" role='grid'><\/div>");i.p.direction=n.trim(i.p.direction.toLowerCase());i.p._ald=!1;n.inArray(i.p.direction,["ltr","rtl"])===-1&&(i.p.direction="ltr");v=i.p.direction;n(tt).insertBefore(this);n(this).appendTo(tt);et=n("<div "+f(e,"entrieBox",!1,"ui-jqgrid")+"><\/div>");n(et).attr({id:"gbox_"+this.id,dir:v}).insertBefore(tt);n(tt).attr("id","gview_"+this.id).appendTo(et);n("<div "+f(i.p.styleUI+".common","overlay",!1,"jqgrid-overlay")+" id='lui_"+this.id+"'><\/div>").insertBefore(tt);n("<div "+f(e,"loadingBox",!1,"loading")+" id='load_"+this.id+"'>"+n.jgrid.getRegional(i,"defaults.loadtext",this.p.loadtext)+"<\/div>").insertBefore(tt);n(this).attr({role:"presentation","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var y=function(n,t){return(n=parseInt(n,10),isNaN(n))?t||0:n},at=function(t,u,f,e,o,s){var h=i.p.colModel[t],y,p=h.align,l='style="',v=h.classes,w=h.name,a,c=[];return p&&(l+="text-align:"+p+";"),h.hidden===!0&&(l+="display:none;"),u===0?l+="width: "+r.headers[t].width+"px;":(n.isFunction(h.cellattr)||typeof h.cellattr=="string"&&n.jgrid.cellattr!=null&&n.isFunction(n.jgrid.cellattr[h.cellattr]))&&(y=n.isFunction(h.cellattr)?h.cellattr:n.jgrid.cellattr[h.cellattr],a=y.call(i,o,f,e,h,s),a&&typeof a=="string"&&(a=a.replace(/style/i,"style").replace(/title/i,"title"),a.indexOf("title")>-1&&(h.title=!1),a.indexOf("class")>-1&&(v=undefined),c=a.replace(/\-style/g,"-sti").split(/style/),c.length===2?(c[1]=n.trim(c[1].replace(/\-sti/g,"-style").replace("=","")),(c[1].indexOf("'")===0||c[1].indexOf('"')===0)&&(c[1]=c[1].substring(1)),l+=c[1].replace(/'/gi,'"')):l+='"')),c.length||(c[0]="",l+='"'),l+=(v!==undefined?' class="'+v+'"':"")+(h.title&&f?' title="'+n.jgrid.stripHtml(f)+'"':""),l+=' aria-describedby="'+i.p.id+"_"+w+'"',l+c[0]},ir=function(t){return t==null||t===""?"&#160;":i.p.autoencode?n.jgrid.htmlEncode(t):String(t)},rr=function(t,r,u,f,e){var o=i.p.colModel[u],s,h;return o.formatter!==undefined?(t=String(i.p.idPrefix)!==""?n.jgrid.stripPref(i.p.idPrefix,t):t,h={rowId:t,colModel:o,gid:i.p.id,pos:u,styleUI:i.p.styleUI},s=n.isFunction(o.formatter)?o.formatter.call(i,r,h,f,e):n.fmatter?n.fn.fmatter.call(i,o.formatter,r,h,f,e):ir(r)):s=ir(r),s},ci=function(n,t,i,r,u,f){var e,o;return e=rr(n,t,i,u,"add"),o=at(i,r,e,u,n,f),'<td role="gridcell" '+o+">"+e+"<\/td>"},ur=function(n,t,r,u,f){var e='<input role="checkbox" type="checkbox" id="jqg_'+i.p.id+"_"+n+'" '+f+' name="jqg_'+i.p.id+"_"+n+'"'+(u?'checked="checked"':"")+"/>",o=at(t,r,"",null,n,!0);return'<td role="gridcell" '+o+">"+e+"<\/td>"},fr=function(n,t,i,r,u){var f=(parseInt(i,10)-1)*parseInt(r,10)+1+t,e=at(n,t,f,null,t,!0);return'<td role="gridcell" '+u+" "+e+">"+f+"<\/td>"},li=function(n){for(var t,u=[],f=0,r=0;r<i.p.colModel.length;r++)t=i.p.colModel[r],t.name!=="cb"&&t.name!=="subgrid"&&t.name!=="rn"&&(u[f]=n==="local"?t.name:n==="xml"||n==="xmlstring"?t.xmlmap||t.name:t.jsonmap||t.name,i.p.keyName!==!1&&t.key===!0&&(i.p.keyName=u[f]),f++);return u},ni=function(t){var r=i.p.remapColumns;return r&&r.length||(r=n.map(i.p.colModel,function(n,t){return t})),t&&(r=n.map(r,function(n){return n<t?null:n-t})),r},vt=function(t,i){var r;this.p.deepempty?n(this.rows).slice(1).remove():(r=this.rows.length>0?this.rows[0]:null,n(this.firstChild).empty().append(r));t&&this.p.scroll&&(n(this.grid.bDiv.firstChild).css({height:"auto"}),n(this.grid.bDiv.firstChild.firstChild).css({height:"0px",display:"none"}),this.grid.bDiv.scrollTop!==0&&(this.grid.bDiv.scrollTop=0));i===!0&&this.p.treeGrid&&!this.p.loadonce&&(this.p.data=[],this.p._index={})},er=function(){var t=i.p,c=t.data,d=c.length,e,s,r,f,u,h,w,l,o=t.localReader,y=t.colModel,a=o.cell,v=(t.multiselect===!0?1:0)+(t.subGrid===!0?1:0)+(t.rownumbers===!0?1:0),g=t.scroll?n.jgrid.randId():1,b,k,p;if(t.datatype==="local"&&o.repeatitems===!0)for(b=ni(v),k=li("local"),f=t.keyIndex===!1?n.isFunction(o.id)?o.id.call(i,c):o.id:t.keyIndex,e=0;e<d;e++){for(r=c[e],u=n.jgrid.getAccessor(r,f),u===undefined&&(typeof f=="number"&&y[f+v]!=null&&(u=n.jgrid.getAccessor(r,y[f+v].name)),u===undefined&&(u=g+e,a&&(h=n.jgrid.getAccessor(r,a)||r,u=h!=null&&h[f]!==undefined?h[f]:u,h=null))),l={},l[o.id]=u,a&&(r=n.jgrid.getAccessor(r,a)||r),p=n.isArray(r)?b:k,s=0;s<p.length;s++)w=n.jgrid.getAccessor(r,p[s]),l[y[s+v].name]=w;n.extend(!0,c[e],l)}},ai=function(){var f=i.p.data.length,u,t,r;for(u=i.p.keyName===!1||i.p.loadonce===!0?i.p.localReader.id:i.p.keyName,i.p._index=[],t=0;t<f;t++)r=n.jgrid.getAccessor(i.p.data[t],u),r===undefined&&(r=String(t+1)),i.p._index[r]=t},vi=function(t,r,u,f,e){var c="-1",l="",s,h=r?"display:none;":"",o=n(i).triggerHandler("jqGridRowAttr",[f,e,t]);if(typeof o!="object"&&(o=n.isFunction(i.p.rowattr)?i.p.rowattr.call(i,f,e,t):typeof i.p.rowattr=="string"&&n.jgrid.rowattr!=null&&n.isFunction(n.jgrid.rowattr[i.p.rowattr])?n.jgrid.rowattr[i.p.rowattr].call(i,f,e,t):{}),!n.isEmptyObject(o)){o.hasOwnProperty("id")&&(t=o.id,delete o.id);o.hasOwnProperty("tabindex")&&(c=o.tabindex,delete o.tabindex);o.hasOwnProperty("style")&&(h+=o.style,delete o.style);o.hasOwnProperty("class")&&(u+=" "+o["class"],delete o["class"]);try{delete o.role}catch(a){}for(s in o)o.hasOwnProperty(s)&&(l+=" "+s+"="+o[s])}return'<tr role="row" id="'+t+'" tabindex="'+c+'" class="'+u+'"'+(h===""?"":' style="'+h+'"')+l+">"},yi=function(t,r,u,o){var ri=new Date,ft=i.p.datatype!=="local"&&i.p.loadonce||i.p.datatype==="xmlstring",et="_id_",c=i.p.xmlReader,ui=i.p.datatype==="local"?"local":"xml",tt,gt,ti,ii;if(ft&&(i.p.data=[],i.p._index={},i.p.localReader.id=et),i.p.reccount=0,n.isXMLDoc(t))i.p.treeANode!==-1||i.p.scroll?r=r>1?r:1:(vt.call(i,!1,!0),r=1);else return;var nt=n(i),w,ot,k=0,d,p=i.p.multiselect===!0?1:0,g=0,yt,a=i.p.rownumbers===!0?1:0,st,lt,rt=[],ut,s={},v,l,h=[],fi=i.p.altRows===!0?i.p.altclass:"",ei=f(e,"rowBox",!0,"jqgrow ui-row-"+i.p.direction),pt;i.p.subGrid===!0&&(g=1,yt=n.jgrid.getMethod("addSubGridCell"));c.repeatitems||(rt=li(ui));st=i.p.keyName===!1?n.isFunction(c.id)?c.id.call(i,t):c.id:i.p.keyName;lt=String(st).indexOf("[")===-1?rt.length?function(t,i){return n(st,t).text()||i}:function(t,i){return n(c.cell,t).eq(st).text()||i}:function(n,t){return n.getAttribute(st.replace(/[\[\]]/g,""))||t};i.p.userData={};i.p.page=y(n.jgrid.getXmlData(t,c.page),i.p.page);i.p.lastpage=y(n.jgrid.getXmlData(t,c.total),1);i.p.records=y(n.jgrid.getXmlData(t,c.records));n.isFunction(c.userdata)?i.p.userData=c.userdata.call(i,t)||{}:n.jgrid.getXmlData(t,c.userdata,!0).each(function(){i.p.userData[this.getAttribute("name")]=n(this).text()});tt=n.jgrid.getXmlData(t,c.root,!0);tt=n.jgrid.getXmlData(tt,c.row,!0);tt||(tt=[]);var it=tt.length,b=0,ht=[],ct=parseInt(i.p.rowNum,10),wt=i.p.scroll?n.jgrid.randId():1,bt,kt=n("#"+n.jgrid.jqID(i.p.id)+" tbody:first");if(it>0&&i.p.page<=0&&(i.p.page=1),tt&&it){o&&(ct*=o+1);var oi=n.isFunction(i.p.afterInsertRow),dt=!1,at,si=a?f(e,"rownumBox",!1,"jqgrid-rownum"):"",hi=p?f(e,"multiBox",!1,"cbox"):"";for(i.p.grouping&&(dt=i.p.groupingView.groupCollapse===!0,at=n.jgrid.getMethod("groupingPrepare"));b<it;){if(v=tt[b],l=lt(v,wt+b),l=i.p.idPrefix+l,bt=r===0?0:r+1,pt=ei+((bt+b)%2==1?" "+fi:""),gt=h.length,h.push(""),a&&h.push(fr(0,b,i.p.page,i.p.rowNum,si)),p&&h.push(ur(l,a,b,!1,hi)),g&&h.push(yt.call(nt,p+a,b+r)),c.repeatitems)ut||(ut=ni(p+g+a)),ti=n.jgrid.getXmlData(v,c.cell,!0),n.each(ut,function(n){var t=ti[this];if(!t)return!1;d=t.textContent||t.text;s[i.p.colModel[n+p+g+a].name]=d;h.push(ci(l,d,n+p+g+a,b+r,v,s))});else for(w=0;w<rt.length;w++)d=n.jgrid.getXmlData(v,rt[w]),s[i.p.colModel[w+p+g+a].name]=d,h.push(ci(l,d,w+p+g+a,b+r,v,s));if(h[gt]=vi(l,dt,pt,s,v),h.push("<\/tr>"),i.p.grouping&&(ht.push(h),i.p.groupingView._locgr||at.call(nt,s,b),h=[]),(ft||i.p.treeGrid===!0&&!i.p._ald)&&(s[et]=n.jgrid.stripPref(i.p.idPrefix,l),i.p.data.push(s),i.p._index[s[et]]=i.p.data.length-1),i.p.gridview===!1&&(kt.append(h.join("")),nt.triggerHandler("jqGridAfterInsertRow",[l,s,v]),oi&&i.p.afterInsertRow.call(i,l,s,v),h=[]),s={},k++,b++,k===ct)break}}if(i.p.gridview===!0&&(ot=i.p.treeANode>-1?i.p.treeANode:0,i.p.grouping?ft||(nt.jqGrid("groupingRender",ht,i.p.colModel.length,i.p.page,ct,h),ht=null):i.p.treeGrid===!0&&ot>0?n(i.rows[ot]).after(h.join("")):(kt.append(h.join("")),i.grid.cols=i.rows[0].cells)),i.p.totaltime=new Date-ri,h=null,i.p.subGrid===!0)try{nt.jqGrid("addSubGrid",p+a)}catch(ai){}if(k>0&&i.p.records===0&&(i.p.records=it),i.p.treeGrid===!0)try{nt.jqGrid("setTreeNode",ot+1,k+ot+1)}catch(yi){}if(i.p.reccount=k,i.p.treeANode=-1,i.p.userDataOnFooter&&nt.jqGrid("footerData","set",i.p.userData,!0),ft&&(i.p.records=it,i.p.lastpage=Math.ceil(it/ct)),u||i.updatepager(!1,!0),ft){while(k<it){if(v=tt[k],l=lt(v,k+wt),l=i.p.idPrefix+l,c.repeatitems)ut||(ut=ni(p+g+a)),ii=n.jgrid.getXmlData(v,c.cell,!0),n.each(ut,function(n){var t=ii[this];if(!t)return!1;d=t.textContent||t.text;s[i.p.colModel[n+p+g+a].name]=d});else for(w=0;w<rt.length;w++)d=n.jgrid.getXmlData(v,rt[w]),s[i.p.colModel[w+p+g+a].name]=d;s[et]=n.jgrid.stripPref(i.p.idPrefix,l);i.p.grouping&&at.call(nt,s,k);i.p.data.push(s);i.p._index[s[et]]=i.p.data.length-1;s={};k++}i.p.grouping&&(i.p.groupingView._locgr=!0,nt.jqGrid("groupingRender",ht,i.p.colModel.length,i.p.page,ct,h),ht=null)}},ti=function(t,r,u,o){var si=new Date,c,ft,at,et,ct,oi,lt;if(t)i.p.treeANode!==-1||i.p.scroll?r=r>1?r:1:(vt.call(i,!1,!0),r=1);else return;ft="_id_";et=i.p.datatype!=="local"&&i.p.loadonce||i.p.datatype==="jsonstring";et&&(i.p.data=[],i.p._index={},i.p.localReader.id=ft);i.p.reccount=0;i.p.datatype==="local"?(c=i.p.localReader,at="local"):(c=i.p.jsonReader,at="json");var nt=n(i),b=0,yt,k,d,kt=[],h,w=i.p.multiselect?1:0,g=i.p.subGrid===!0?1:0,dt,v=i.p.rownumbers===!0?1:0,gt=ni(w+g+v),ti=li(at),it,rt,tt,p,l={},ot,s,a=[],hi=i.p.altRows===!0?i.p.altclass:"",ai=f(e,"rowBox",!0,"jqgrow ui-row-"+i.p.direction),pt;i.p.page=y(n.jgrid.getAccessor(t,c.page),i.p.page);i.p.lastpage=y(n.jgrid.getAccessor(t,c.total),1);i.p.records=y(n.jgrid.getAccessor(t,c.records));i.p.userData=n.jgrid.getAccessor(t,c.userdata)||{};g&&(dt=n.jgrid.getMethod("addSubGridCell"));p=i.p.keyName===!1?n.isFunction(c.id)?c.id.call(i,t):c.id:i.p.keyName;tt=n.jgrid.getAccessor(t,c.root);tt==null&&n.isArray(t)&&(tt=t);tt||(tt=[]);rt=tt.length;k=0;rt>0&&i.p.page<=0&&(i.p.page=1);var st=parseInt(i.p.rowNum,10),ii=i.p.scroll?n.jgrid.randId():1,ri,ui=!1,wt;o&&(st*=o+1);i.p.datatype!=="local"||i.p.deselectAfterSort||(ui=!0);var yi=n.isFunction(i.p.afterInsertRow),ht=[],fi=!1,bt,ei=n("#"+n.jgrid.jqID(i.p.id)+" tbody:first"),pi=v?f(e,"rownumBox",!1,"jqgrid-rownum"):"",wi=w?f(e,"multiBox",!1,"cbox"):"";for(i.p.grouping&&(fi=i.p.groupingView.groupCollapse===!0,bt=n.jgrid.getMethod("groupingPrepare"));k<rt;){for(h=tt[k],s=n.jgrid.getAccessor(h,p),s===undefined&&(typeof p=="number"&&i.p.colModel[p+w+g+v]!=null&&(s=n.jgrid.getAccessor(h,i.p.colModel[p+w+g+v].name)),s===undefined&&(s=ii+k,kt.length===0&&c.cell&&(ct=n.jgrid.getAccessor(h,c.cell)||h,s=ct!=null&&ct[p]!==undefined?ct[p]:s,ct=null))),s=i.p.idPrefix+s,ri=r===1?0:r,pt=ai+((ri+k)%2==1?" "+hi:""),ui&&(wt=i.p.multiselect?n.inArray(s,i.p.selarrrow)!==-1:s===i.p.selrow),oi=a.length,a.push(""),v&&a.push(fr(0,k,i.p.page,i.p.rowNum,pi)),w&&a.push(ur(s,v,k,wt,wi)),g&&a.push(dt.call(nt,w+v,k+r)),it=ti,c.repeatitems&&(c.cell&&(h=n.jgrid.getAccessor(h,c.cell)||h),n.isArray(h)&&(it=gt)),d=0;d<it.length;d++)yt=n.jgrid.getAccessor(h,it[d]),l[i.p.colModel[d+w+g+v].name]=yt,a.push(ci(s,yt,d+w+g+v,k+r,h,l));if(pt+=wt?" "+ut:"",a[oi]=vi(s,fi,pt,l,h),a.push("<\/tr>"),i.p.grouping&&(ht.push(a),i.p.groupingView._locgr||bt.call(nt,l,k),a=[]),(et||i.p.treeGrid===!0&&!i.p._ald)&&(l[ft]=n.jgrid.stripPref(i.p.idPrefix,s),i.p.data.push(l),i.p._index[l[ft]]=i.p.data.length-1),i.p.gridview===!1&&(ei.append(a.join("")),nt.triggerHandler("jqGridAfterInsertRow",[s,l,h]),yi&&i.p.afterInsertRow.call(i,s,l,h),a=[]),l={},b++,k++,b===st)break}if(i.p.gridview===!0&&(ot=i.p.treeANode>-1?i.p.treeANode:0,i.p.grouping?et||(nt.jqGrid("groupingRender",ht,i.p.colModel.length,i.p.page,st,t),ht=null):i.p.treeGrid===!0&&ot>0?n(i.rows[ot]).after(a.join("")):(ei.append(a.join("")),i.grid.cols=i.rows[0].cells)),i.p.totaltime=new Date-si,a=null,i.p.subGrid===!0)try{nt.jqGrid("addSubGrid",w+v)}catch(bi){}if(b>0&&i.p.records===0&&(i.p.records=rt),i.p.treeGrid===!0)try{nt.jqGrid("setTreeNode",ot+1,b+ot+1)}catch(ki){}if(i.p.reccount=b,i.p.treeANode=-1,i.p.userDataOnFooter&&nt.jqGrid("footerData","set",i.p.userData,!0),et&&(i.p.records=rt,i.p.lastpage=Math.ceil(rt/st)),u||i.updatepager(!1,!0),et){while(b<rt&&tt[b]){if(h=tt[b],s=n.jgrid.getAccessor(h,p),s===undefined&&(typeof p=="number"&&i.p.colModel[p+w+g+v]!=null&&(s=n.jgrid.getAccessor(h,i.p.colModel[p+w+g+v].name)),s===undefined&&(s=ii+b,kt.length===0&&c.cell&&(lt=n.jgrid.getAccessor(h,c.cell)||h,s=lt!=null&&lt[p]!==undefined?lt[p]:s,lt=null))),h){for(s=i.p.idPrefix+s,it=ti,c.repeatitems&&(c.cell&&(h=n.jgrid.getAccessor(h,c.cell)||h),n.isArray(h)&&(it=gt)),d=0;d<it.length;d++)l[i.p.colModel[d+w+g+v].name]=n.jgrid.getAccessor(h,it[d]);l[ft]=n.jgrid.stripPref(i.p.idPrefix,s);i.p.grouping&&bt.call(nt,l,b);i.p.data.push(l);i.p._index[l[ft]]=i.p.data.length-1;l={}}b++}i.p.grouping&&(i.p.groupingView._locgr=!0,nt.jqGrid("groupingRender",ht,i.p.colModel.length,i.p.page,st,t),ht=null)}},or=function(t){function st(t){var s=0,e,h,l,c,f,o;if(t.groups!=null){for(h=t.groups.length&&t.groupOp.toString().toUpperCase()==="OR",h&&r.orBegin(),e=0;e<t.groups.length;e++){s>0&&h&&r.or();try{st(t.groups[e])}catch(a){alert(a)}s++}h&&r.orEnd()}if(t.rules!=null)try{for(l=t.rules.length&&t.groupOp.toString().toUpperCase()==="OR",l&&r.orBegin(),e=0;e<t.rules.length;e++)f=t.rules[e],c=t.groupOp.toString().toUpperCase(),g[f.op]&&f.field&&(s>0&&c&&c==="OR"&&(r=r.or()),o=u[f.field],o.stype==="date"&&o.srcfmt&&o.newfmt&&o.srcfmt!==o.newfmt&&(f.data=n.jgrid.parseDate.call(i,o.newfmt,f.data,o.srcfmt)),r=g[f.op](r,c)(f.field,f.data,u[f.field])),s++;l&&r.orEnd()}catch(v){alert(v)}}var f=i.p.multiSort?[]:"",et=[],tt=!1,u={},rt=[],ot=[],p,y,b,s,k,d,e,h,g,r,l,v,ht,c,ct;if(n.isArray(i.p.data)){if(k=i.p.grouping?i.p.groupingView:!1,n.each(i.p.colModel,function(){if(y=this.sorttype||"text",h=this.index||this.name,y==="date"||y==="datetime"?(this.formatter&&typeof this.formatter=="string"&&this.formatter==="date"?(p=this.formatoptions&&this.formatoptions.srcformat?this.formatoptions.srcformat:n.jgrid.getRegional(i,"formatter.date.srcformat"),b=this.formatoptions&&this.formatoptions.newformat?this.formatoptions.newformat:n.jgrid.getRegional(i,"formatter.date.newformat")):p=b=this.datefmt||"Y-m-d",u[h]={stype:y,srcfmt:p,newfmt:b,sfunc:this.sortfunc||null}):u[h]={stype:y,srcfmt:"",newfmt:"",sfunc:this.sortfunc||null},i.p.grouping)for(e=0,d=k.groupField.length;e<d;e++)this.name===k.groupField[e]&&(rt[e]=u[h],ot[e]=h);i.p.multiSort||tt||h!==i.p.sortname||(f=h,tt=!0)}),i.p.multiSort&&(f=w,et=it),i.p.treeGrid&&i.p._sort){n(i).jqGrid("SortTree",f,i.p.sortorder,u[f].stype||"text",u[f].srcfmt||"");return}if(g={eq:function(n){return n.equals},ne:function(n){return n.notEquals},lt:function(n){return n.less},le:function(n){return n.lessOrEquals},gt:function(n){return n.greater},ge:function(n){return n.greaterOrEquals},cn:function(n){return n.contains},nc:function(n,t){return t==="OR"?n.orNot().contains:n.andNot().contains},bw:function(n){return n.startsWith},bn:function(n,t){return t==="OR"?n.orNot().startsWith:n.andNot().startsWith},en:function(n,t){return t==="OR"?n.orNot().endsWith:n.andNot().endsWith},ew:function(n){return n.endsWith},ni:function(n,t){return t==="OR"?n.orNot().equals:n.andNot().equals},"in":function(n){return n.equals},nu:function(n){return n.isNull},nn:function(n,t){return t==="OR"?n.orNot().isNull:n.andNot().isNull}},r=n.jgrid.from.call(i,i.p.data),i.p.ignoreCase&&(r=r.ignoreCase()),i.p.search===!0)if(l=i.p.postData.filters,l)typeof l=="string"&&(l=n.jgrid.parse(l)),st(l);else try{s=u[i.p.postData.searchField];s.stype==="date"&&s.srcfmt&&s.newfmt&&s.srcfmt!==s.newfmt&&(i.p.postData.searchString=n.jgrid.parseDate.call(i,s.newfmt,i.p.postData.searchString,s.srcfmt));r=g[i.p.postData.searchOper](r)(i.p.postData.searchField,i.p.postData.searchString,u[i.p.postData.searchField])}catch(at){}else i.p.treeGrid&&i.p.treeGridModel==="nested"&&r.orderBy(i.p.treeReader.left_field,"asc","integer","",null);if(i.p.treeGrid&&i.p.treeGridModel==="adjacency"&&(d=0,f=null),i.p.grouping)for(e=0;e<d;e++)r.orderBy(ot[e],k.groupOrder[e],rt[e].stype,rt[e].srcfmt);i.p.multiSort?n.each(f,function(n){r.orderBy(this,et[n],u[this].stype,u[this].srcfmt,u[this].sfunc)}):f&&i.p.sortorder&&tt&&(i.p.sortorder.toUpperCase()==="DESC"?r.orderBy(i.p.sortname,"d",u[f].stype,u[f].srcfmt,u[f].sfunc):r.orderBy(i.p.sortname,"a",u[f].stype,u[f].srcfmt,u[f].sfunc));var o=r.select(),nt=parseInt(i.p.rowNum,10),ut=o.length,ft=parseInt(i.p.page,10),lt=Math.ceil(ut/nt),a={};if((i.p.search||i.p.resetsearch)&&i.p.grouping&&i.p.groupingView._locgr){if(i.p.groupingView.groups=[],ht=n.jgrid.getMethod("groupingPrepare"),i.p.footerrow&&i.p.userDataOnFooter){for(c in i.p.userData)i.p.userData.hasOwnProperty(c)&&(i.p.userData[c]=0);ct=!0}for(v=0;v<ut;v++){if(ct)for(c in i.p.userData)i.p.userData.hasOwnProperty(c)&&(i.p.userData[c]+=parseFloat(o[v][c]||0));ht.call(n(i),o[v],v,nt)}}return t?o:(o=i.p.treeGrid&&i.p.search?n(i).jqGrid("searchTree",o):o.slice((ft-1)*nt,ft*nt),r=null,u=null,a[i.p.localReader.total]=lt,a[i.p.localReader.page]=ft,a[i.p.localReader.records]=ut,a[i.p.localReader.root]=o,a[i.p.localReader.userdata]=i.p.userData,o=null,a)}},gr=function(t,r){var l,nt,o,b,v,k,p,c="",it,d=i.p.pager?n.jgrid.jqID(i.p.pager.substr(1)):"",u=d?"_"+d:"",s=i.p.toppager?"_"+i.p.toppager.substr(1):"",g,w,tt,rt,ut;o=parseInt(i.p.page,10)-1;o<0&&(o=0);o=o*parseInt(i.p.rowNum,10);v=o+i.p.reccount;i.p.scroll&&(g=n("tbody:first > tr:gt(0)",i.grid.bDiv),v>i.p.records&&(v=i.p.records),o=v-g.length,i.p.reccount=g.length,w=g.outerHeight()||i.grid.prevRowHeight,w&&(tt=o*w,rt=parseInt(i.p.records,10)*w,n(">div:first",i.grid.bDiv).css({height:rt}).children("div:first").css({height:tt,display:tt?"":"none"}),i.grid.bDiv.scrollTop===0&&i.p.page>1&&(i.grid.bDiv.scrollTop=i.p.rowNum*(i.p.page-1)*w)),i.grid.bDiv.scrollLeft=i.grid.hDiv.scrollLeft);c=i.p.pager||"";c+=i.p.toppager?c?","+i.p.toppager:i.p.toppager:"";c&&(p=n.jgrid.getRegional(i,"formatter.integer"),l=y(i.p.page),nt=y(i.p.lastpage),n(".selbox",c)[this.p.useProp?"prop":"attr"]("disabled",!1),i.p.pginput===!0&&(n("#input"+u).html(n.jgrid.template(n.jgrid.getRegional(i,"defaults.pgtext",i.p.pgtext)||"","<input "+f(e,"pgInput",!1,"ui-pg-input")+" type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+n.jgrid.jqID(d)+"'><\/span>")),i.p.toppager&&n("#input_t"+s).html(n.jgrid.template(n.jgrid.getRegional(i,"defaults.pgtext",i.p.pgtext)||"","<input "+f(e,"pgInput",!1,"ui-pg-input")+" type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+n.jgrid.jqID(d)+"_toppager'><\/span>")),n(".ui-pg-input",c).val(i.p.page),it=i.p.toppager?"#sp_1"+u+",#sp_1"+u+"_toppager":"#sp_1"+u,n(it).html(n.fmatter?n.fmatter.util.NumberFormat(i.p.lastpage,p):i.p.lastpage)),i.p.viewrecords&&(i.p.reccount===0?n(".ui-paging-info",c).html(n.jgrid.getRegional(i,"defaults.emptyrecords",i.p.emptyrecords)):(b=o+1,k=i.p.records,n.fmatter&&(b=n.fmatter.util.NumberFormat(b,p),v=n.fmatter.util.NumberFormat(v,p),k=n.fmatter.util.NumberFormat(k,p)),ut=n.jgrid.getRegional(i,"defaults.recordtext",i.p.recordtext),n(".ui-paging-info",c).html(n.jgrid.template(ut,b,v,k)))),i.p.pgbuttons===!0&&(l<=0&&(l=nt=0),l===1||l===0?(n("#first"+u+", #prev"+u).addClass(h).removeClass(a),i.p.toppager&&n("#first_t"+s+", #prev_t"+s).addClass(h).removeClass(a)):(n("#first"+u+", #prev"+u).removeClass(h),i.p.toppager&&n("#first_t"+s+", #prev_t"+s).removeClass(h)),l===nt||l===0?(n("#next"+u+", #last"+u).addClass(h).removeClass(a),i.p.toppager&&n("#next_t"+s+", #last_t"+s).addClass(h).removeClass(a)):(n("#next"+u+", #last"+u).removeClass(h),i.p.toppager&&n("#next_t"+s+", #last_t"+s).removeClass(h))));t===!0&&i.p.rownumbers===!0&&n(">td.jqgrid-rownum",i.rows).each(function(t){n(this).html(o+1+t)});r&&i.p.jqgdnd&&n(i).jqGrid("gridDnD","updateDnD");n(i).triggerHandler("jqGridGridComplete");n.isFunction(i.p.gridComplete)&&i.p.gridComplete.call(i);n(i).triggerHandler("jqGridAfterGridComplete")},yt=function(){(i.grid.hDiv.loading=!0,i.p.hiddengrid)||n(i).jqGrid("progressBar",{method:"show",loadtype:i.p.loadui,htmlcontent:n.jgrid.getRegional(i,"defaults.loadtext",i.p.loadtext)})},ot=function(){i.grid.hDiv.loading=!1;n(i).jqGrid("progressBar",{method:"hide",loadtype:i.p.loadui})},rt=function(t){var y,h,w,p,c,e,l;if(!i.grid.hDiv.loading){var b=i.p.scroll&&t===!1,u={},a,f,r=i.p.prmNames;i.p.page<=0&&(i.p.page=Math.min(1,i.p.lastpage));r.search!==null&&(u[r.search]=i.p.search);r.nd!==null&&(u[r.nd]=(new Date).getTime());r.rows!==null&&(u[r.rows]=i.p.rowNum);r.page!==null&&(u[r.page]=i.p.page);r.sort!==null&&(u[r.sort]=i.p.sortname);r.order!==null&&(u[r.order]=i.p.sortorder);i.p.rowTotal!==null&&r.totalrows!==null&&(u[r.totalrows]=i.p.rowTotal);var v=n.isFunction(i.p.loadComplete),o=v?i.p.loadComplete:null,s=0;if(t=t||1,t>1?r.npage!==null?(u[r.npage]=t,s=t-1,t=1):o=function(n){i.p.page++;i.grid.hDiv.loading=!1;v&&i.p.loadComplete.call(i,n);rt(t-1)}:r.npage!==null&&delete i.p.postData[r.npage],i.p.grouping){for(n(i).jqGrid("groupingSetup"),y=i.p.groupingView,w="",h=0;h<y.groupField.length;h++)p=y.groupField[h],n.each(i.p.colModel,function(n,t){t.name===p&&t.index&&(p=t.index)}),w+=p+" "+y.groupOrder[h]+", ";u[r.sort]=w+u[r.sort]}if(n.extend(i.p.postData,u),c=i.p.scroll?i.rows.length-1:1,e=n(i).triggerHandler("jqGridBeforeRequest"),e===!1||e==="stop")return;if(n.isFunction(i.p.datatype)){i.p.datatype.call(i,i.p.postData,"load_"+i.p.id,c,t,s);return}if(n.isFunction(i.p.beforeRequest)&&(e=i.p.beforeRequest.call(i),e===undefined&&(e=!0),e===!1))return;a=i.p.datatype.toLowerCase();switch(a){case"json":case"jsonp":case"xml":case"script":n.ajax(n.extend({url:i.p.url,type:i.p.mtype,dataType:a,data:n.isFunction(i.p.serializeGridData)?i.p.serializeGridData.call(i,i.p.postData):i.p.postData,success:function(r,u,f){if(n.isFunction(i.p.beforeProcessing)&&i.p.beforeProcessing.call(i,r,u,f)===!1){ot();return}a==="xml"?yi(r,c,t>1,s):ti(r,c,t>1,s);n(i).triggerHandler("jqGridLoadComplete",[r]);o&&o.call(i,r);n(i).triggerHandler("jqGridAfterLoadComplete",[r]);b&&i.grid.populateVisible();(i.p.loadonce||i.p.treeGrid)&&(i.p.datatype="local");r=null;t===1&&ot()},error:function(r,u,f){n.isFunction(i.p.loadError)&&i.p.loadError.call(i,r,u,f);t===1&&ot();r=null},beforeSend:function(t,r){var u=!0;if(n.isFunction(i.p.loadBeforeSend)&&(u=i.p.loadBeforeSend.call(i,t,r)),u===undefined&&(u=!0),u===!1)return!1;yt()}},n.jgrid.ajaxOptions,i.p.ajaxGridOptions));break;case"xmlstring":yt();f=typeof i.p.datastr!="string"?i.p.datastr:n.parseXML(i.p.datastr);yi(f);n(i).triggerHandler("jqGridLoadComplete",[f]);v&&i.p.loadComplete.call(i,f);n(i).triggerHandler("jqGridAfterLoadComplete",[f]);i.p.datatype="local";i.p.datastr=null;ot();break;case"jsonstring":yt();f=typeof i.p.datastr=="string"?n.jgrid.parse(i.p.datastr):i.p.datastr;ti(f);n(i).triggerHandler("jqGridLoadComplete",[f]);v&&i.p.loadComplete.call(i,f);n(i).triggerHandler("jqGridAfterLoadComplete",[f]);i.p.datatype="local";i.p.datastr=null;ot();break;case"local":case"clientside":yt();i.p.datatype="local";i.p._ald=!0;l=or(!1);ti(l,c,t>1,s);n(i).triggerHandler("jqGridLoadComplete",[l]);o&&o.call(i,l);n(i).triggerHandler("jqGridAfterLoadComplete",[l]);b&&i.grid.populateVisible();ot();i.p._ald=!1}i.p._sort=!1}},ii=function(t){n("#cb_"+n.jgrid.jqID(i.p.id),i.grid.hDiv)[i.p.useProp?"prop":"attr"]("checked",t);var r=i.p.frozenColumns?i.p.id+"_frozen":"";r&&n("#cb_"+n.jgrid.jqID(i.p.id),i.grid.fhDiv)[i.p.useProp?"prop":"attr"]("checked",t)},sr=function(t,r){var tt="<td class='ui-pg-button "+h+"'><span class='ui-separator'><\/span><\/td>",c="",u="<table class='ui-pg-table ui-common-table ui-paging-pager'><tbody><tr>",l="",o,it,ut,ft,p,et,k,g=function(t,r){var u;return(n.isFunction(i.p.onPaging)&&(u=i.p.onPaging.call(i,t,r)),u==="stop")?!1:(i.p.selrow=null,i.p.multiselect&&(i.p.selarrrow=[],ii(!1)),i.p.savedRow=[],!0)},s;if(t=t.substr(1),r+="_"+t,o="pg_"+t,it=t+"_left",ut=t+"_center",ft=t+"_right",n("#"+n.jgrid.jqID(t)).append("<div id='"+o+"' class='ui-pager-control' role='group'><table "+f(e,"pagerTable",!1,"ui-pg-table ui-common-table ui-pager-table")+"><tbody><tr><td id='"+it+"' align='left'><\/td><td id='"+ut+"' align='center' style='white-space:pre;'><\/td><td id='"+ft+"' align='right'><\/td><\/tr><\/tbody><\/table><\/div>").attr("dir","ltr"),i.p.rowList.length>0){for(l='<td dir="'+v+'">',l+="<select "+f(e,"pgSelectBox",!1,"ui-pg-selbox")+' role="listbox" title="'+(n.jgrid.getRegional(i,"defaults.pgrecs",i.p.pgrecs)||"")+'">',k=0;k<i.p.rowList.length;k++)s=i.p.rowList[k].toString().split(":"),s.length===1&&(s[1]=s[0]),l+='<option role="option" value="'+s[0]+'"'+(y(i.p.rowNum,0)===y(s[0],0)?' selected="selected"':"")+">"+s[1]+"<\/option>";l+="<\/select><\/td>"}if(v==="rtl"&&(u+=l),i.p.pginput===!0&&(c="<td id='input"+r+"' dir='"+v+"'>"+n.jgrid.template(n.jgrid.getRegional(i,"defaults.pgtext",i.p.pgtext)||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+n.jgrid.jqID(t)+"'><\/span>")+"<\/td>"),i.p.pgbuttons===!0){var w=["first"+r,"prev"+r,"next"+r,"last"+r],d=f(e,"pgButtonBox",!0,"ui-pg-button"),b=[n.jgrid.getRegional(i,"defaults.pgfirst",i.p.pgfirst)||"",n.jgrid.getRegional(i,"defaults.pgprev",i.p.pgprev)||"",n.jgrid.getRegional(i,"defaults.pgnext",i.p.pgnext)||"",n.jgrid.getRegional(i,"defaults.pglast",i.p.pglast)||""];v==="rtl"&&(w.reverse(),b.reverse());u+="<td id='"+w[0]+"' class='"+d+"' title='"+b[0]+"'><span "+f(e,"icon_first",!1,nt)+"><\/span><\/td>";u+="<td id='"+w[1]+"' class='"+d+"'  title='"+b[1]+"'><span "+f(e,"icon_prev",!1,nt)+"><\/span><\/td>";u+=c!==""?tt+c+tt:"";u+="<td id='"+w[2]+"' class='"+d+"' title='"+b[2]+"'><span "+f(e,"icon_next",!1,nt)+"><\/span><\/td>";u+="<td id='"+w[3]+"' class='"+d+"' title='"+b[3]+"'><span "+f(e,"icon_end",!1,nt)+"><\/span><\/td>"}else c!==""&&(u+=c);v==="ltr"&&(u+=l);u+="<\/tr><\/tbody><\/table>";i.p.viewrecords===!0&&n("td#"+t+"_"+i.p.recordpos,"#"+o).append("<div dir='"+v+"' style='text-align:"+i.p.recordpos+"' class='ui-paging-info'><\/div>");n("td#"+t+"_"+i.p.pagerpos,"#"+o).append(u);et=n("#gbox_"+n.jgrid.jqID(i.p.id)).css("font-size")||"11px";n("#gbox_"+n.jgrid.jqID(i.p.id)).append("<div id='testpg' "+f(e,"entrieBox",!1,"ui-jqgrid")+" style='font-size:"+et+";visibility:hidden;' ><\/div>");p=n(u).clone().appendTo("#testpg").width();n("#testpg").remove();p>0&&(c!==""&&(p+=50),n("td#"+t+"_"+i.p.pagerpos,"#"+o).width(p));i.p._nvtd=[];i.p._nvtd[0]=p?Math.floor((i.p.width-p)/2):Math.floor(i.p.width/3);i.p._nvtd[1]=0;u=null;n(".ui-pg-selbox","#"+o).on("change",function(){return g("records",this)?(i.p.page=Math.round(i.p.rowNum*(i.p.page-1)/this.value-.5)+1,i.p.rowNum=this.value,i.p.pager&&n(".ui-pg-selbox",i.p.pager).val(this.value),i.p.toppager&&n(".ui-pg-selbox",i.p.toppager).val(this.value),rt(),!1):!1});if(i.p.pgbuttons===!0&&(n(".ui-pg-button","#"+o).hover(function(){n(this).hasClass(h)?this.style.cursor="default":(n(this).addClass(a),this.style.cursor="pointer")},function(){n(this).hasClass(h)||(n(this).removeClass(a),this.style.cursor="default")}),n("#first"+n.jgrid.jqID(r)+", #prev"+n.jgrid.jqID(r)+", #next"+n.jgrid.jqID(r)+", #last"+n.jgrid.jqID(r)).click(function(){if(n(this).hasClass(h))return!1;var t=y(i.p.page,1),u=y(i.p.lastpage,1),f=!1,s=!0,c=!0,e=!0,o=!0;return(u===0||u===1?(s=!1,c=!1,e=!1,o=!1):u>1&&t>=1?t===1?(s=!1,c=!1):t===u&&(e=!1,o=!1):u>1&&t===0&&(e=!1,o=!1,t=u-1),!g(this.id.split("_")[0],this))?!1:(this.id==="first"+r&&s&&(i.p.page=1,f=!0),this.id==="prev"+r&&c&&(i.p.page=t-1,f=!0),this.id==="next"+r&&e&&(i.p.page=t+1,f=!0),this.id==="last"+r&&o&&(i.p.page=u,f=!0),f&&rt(),!1)})),i.p.pginput===!0)n("#"+o).on("keypress","input.ui-pg-input",function(t){var r=t.charCode||t.keyCode||0;return r===13?g("user",this)?(n(this).val(y(n(this).val(),1)),i.p.page=n(this).val()>0?n(this).val():i.p.page,rt(),!1):!1:this})},nu=function(t,r,u){var f=i.p.colModel,s=i.p.frozenColumns?r:i.grid.headers[t].el,e="",a,c,o,l;for(n("span.ui-grid-ico-sort",s).addClass(h),n(s).attr("aria-selected","false"),a=f[t].index||f[t].name,typeof u=="undefined"?f[t].lso?f[t].lso==="asc"?(f[t].lso+="-desc",e="desc"):f[t].lso==="desc"?(f[t].lso+="-asc",e="asc"):(f[t].lso==="asc-desc"||f[t].lso==="desc-asc")&&(f[t].lso=""):f[t].lso=e=f[t].firstsortorder||"asc":f[t].lso=e=u,e?(n("span.s-ico",s).show(),n("span.ui-icon-"+e,s).removeClass(h),n(s).attr("aria-selected","true")):i.p.viewsortcols[0]||n("span.s-ico",s).hide(),c=w.indexOf(a),c===-1?(w.push(a),it.push(e)):e?it[c]=e:(it.splice(c,1),w.splice(c,1)),i.p.sortorder="",i.p.sortname="",o=0,l=w.length;o<l;o++)o>0&&(i.p.sortname+=", "),i.p.sortname+=w[o],o!==l-1&&(i.p.sortname+=" "+it[o]);i.p.sortorder=it[l-1]},ri=function(t,r,u,f,e){var a;if(i.p.colModel[r].sortable&&!(i.p.savedRow.length>0)){if(u||(i.p.lastsort===r&&i.p.sortname!==""?i.p.sortorder==="asc"?i.p.sortorder="desc":i.p.sortorder==="desc"&&(i.p.sortorder="asc"):i.p.sortorder=i.p.colModel[r].firstsortorder||"asc",i.p.page=1),i.p.multiSort)nu(r,e,f);else{if(f){if(i.p.lastsort===r&&i.p.sortorder===f&&!u)return;i.p.sortorder=f}var c=i.grid.headers[i.p.lastsort]?i.grid.headers[i.p.lastsort].el:null,s=i.p.frozenColumns?e:i.grid.headers[r].el,l=i.p.viewsortcols[1]==="single"?!0:!1,o;o=n(c).find("span.ui-grid-ico-sort");o.addClass(h);l&&n(o).css("display","none");n(c).attr("aria-selected","false");i.p.frozenColumns&&(o=i.grid.fhDiv.find("span.ui-grid-ico-sort"),o.addClass(h),l&&o.css("display","none"),i.grid.fhDiv.find("th").attr("aria-selected","false"));o=n(s).find("span.ui-icon-"+i.p.sortorder);o.removeClass(h);l&&o.css("display","");n(s).attr("aria-selected","true");i.p.viewsortcols[0]||(i.p.lastsort!==r?(i.p.frozenColumns&&i.grid.fhDiv.find("span.s-ico").hide(),n("span.s-ico",c).hide(),n("span.s-ico",s).show()):i.p.sortname===""&&n("span.s-ico",s).show());t=t.substring(5+i.p.id.length+1);i.p.sortname=i.p.colModel[r].index||t}if(n(i).triggerHandler("jqGridSortCol",[i.p.sortname,r,i.p.sortorder])==="stop"){i.p.lastsort=r;return}if(n.isFunction(i.p.onSortCol)&&i.p.onSortCol.call(i,i.p.sortname,r,i.p.sortorder)==="stop"){i.p.lastsort=r;return}i.p.datatype==="local"?i.p.deselectAfterSort&&n(i).jqGrid("resetSelection"):(i.p.selrow=null,i.p.multiselect&&ii(!1),i.p.selarrrow=[],i.p.savedRow=[]);i.p.scroll&&(a=i.grid.bDiv.scrollLeft,vt.call(i,!0,!1),i.grid.hDiv.scrollLeft=a);i.p.subGrid&&i.p.datatype==="local"&&n("td.sgexpanded","#"+n.jgrid.jqID(i.p.id)).each(function(){n(this).trigger("click")});i.p._sort=!0;rt();i.p.lastsort=r;i.p.sortname!==t&&r&&(i.p.lastsort=r)}},tu=function(){var t=0,u=n.jgrid.cell_width?0:y(i.p.cellLayout,0),f=0,c,h=y(i.p.scrollOffset,0),o,l=!1,a,e=0,s;n.each(i.p.colModel,function(){if(this.hidden===undefined&&(this.hidden=!1),i.p.grouping&&i.p.autowidth){var r=n.inArray(this.name,i.p.groupingView.groupField);r>=0&&i.p.groupingView.groupColumnShow.length>r&&(this.hidden=!i.p.groupingView.groupColumnShow[r])}this.widthOrg=o=y(this.width,0);this.hidden===!1&&(t+=o+u,this.fixed?e+=o+u:f++)});isNaN(i.p.width)&&(i.p.width=t+(i.p.shrinkToFit===!1&&!isNaN(i.p.height)?h:0));r.width=parseInt(i.p.width,10);i.p.tblwidth=t;i.p.shrinkToFit===!1&&i.p.forceFit===!0&&(i.p.forceFit=!1);i.p.shrinkToFit===!0&&f>0&&(a=r.width-u*f-e,isNaN(i.p.height)||(a-=h,l=!0),t=0,n.each(i.p.colModel,function(n){this.hidden!==!1||this.fixed||(o=Math.round(a*this.width/(i.p.tblwidth-u*f-e)),this.width=o,t+=o,c=n)}),s=0,l?r.width-e-(t+u*f)!==h&&(s=r.width-e-(t+u*f)-h):l||Math.abs(r.width-e-(t+u*f))===1||(s=r.width-e-(t+u*f)),i.p.colModel[c].width+=s,i.p.tblwidth=t+s+u*f+e,i.p.tblwidth>i.p.width&&(i.p.colModel[c].width-=i.p.tblwidth-parseInt(i.p.width,10),i.p.tblwidth=i.p.width))},iu=function(n){for(var u=n,r=n,t=n+1;t<i.p.colModel.length;t++)if(i.p.colModel[t].hidden!==!0){r=t;break}return r-u},ru=function(t){var u=n(i.grid.headers[t].el),r=[u.position().left+u.outerWidth()];return i.p.direction==="rtl"&&(r[0]=i.p.width-r[0]),r[0]-=i.grid.bDiv.scrollLeft,r.push(n(i.grid.hDiv).position().top),r.push(n(i.grid.bDiv).offset().top-n(i.grid.hDiv).offset().top+n(i.grid.bDiv).height()),r},hr=function(t){for(var u=i.grid.headers,f=n.jgrid.getCellIndex(t),r=0;r<u.length;r++)if(t===u[r].el){f=r;break}return f},uu=function(t,r,u){for(var o=i.p.colModel,c=o.length,e=[],l,v=n.jgrid.getRegional(i,"colmenu"),r=r-20,h='<ul id="col_menu" class="ui-search-menu  ui-col-menu modal-content" role="menu" tabindex="0" style="left:'+r+"px;top:"+t+'px;width:180px">',f=0;f<c;f++){var y=o[f].hidden?"":"checked",s=o[f].name,p=i.p.colNames[f];l=s==="cb"||s==="subgrid"||s==="rn"||o[f].hidedlg?"style='display:none'":"";h+="<li "+l+' class="ui-menu-item" role="presentation" draggable="true"><a class="g-menu-item" tabindex="0" role="menuitem" ><table class="ui-common-table" ><tr><td class="menu_icon" title="'+v.reorder+'"><span class="glyphicon glyphicon-move notclick"><\/span><\/td><td class="menu_icon"><input class="'+d.input_checkbox+'" type="checkbox" name="'+s+'" '+y+'><\/td><td class="menu_text">'+p+"<\/td><\/tr><\/table><\/a><\/li>";e.push(f)}if(h+="<\/ul>",n(u).append(h),n("#col_menu").addClass("ui-menu "+d.menu_widget),n.fn.html5sortable())n("#col_menu").html5sortable({handle:"span",forcePlaceholderSize:!0}).on("sortupdate",function(t,r){for(e.splice(r.startindex,1),e.splice(r.endindex,0,r.startindex),n(i).jqGrid("destroyFrozenColumns"),n(i).jqGrid("remapColumns",e,!0),n(i).jqGrid("setFrozenColumns"),f=0;f<c;f++)e[f]=f});n("#col_menu > li > a").on("click",function(t){var r;n(t.target).hasClass("notclick")||(n(t.target).is(":input")?r=n(t.target).is(":checked"):(r=!n("input",this).is(":checked"),n("input",this).prop("checked",r)),r?(n(i).jqGrid("showCol",n("input",this).attr("name")),n(this).parent().attr("draggable","true")):(n(i).jqGrid("hideCol",n("input",this).attr("name")),n(this).parent().attr("draggable","false")))}).hover(function(){n(this).addClass(a)},function(){n(this).removeClass(a)})},fu=function(t,r,u,f){var e=i.p.colModel[t],h,nt="",b="",tt="",it="",k="",g,rt,y="",c,s,p=n.jgrid.getRegional(i,"search"),ut=n.jgrid.styleUI[i.p.styleUI||"jQueryUI"].common,o,l,w,v;e&&(h=i.p.colFilters&&i.p.colFilters[e.name]?i.p.colFilters[e.name]:!1,h&&!n.isEmptyObject(h)&&(nt=h.oper1,b=h.value1,tt=h.rule,it=h.oper2,k=h.value2),e.searchoptions||(e.searchoptions={}),g=e.searchoptions.sopt?e.searchoptions.sopt:e.sorttype==="text"?["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"]:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],rt=e.searchoptions.operands?e.searchoptions.operands:p.groupOps,s=n("<form><\/form>"),o="<div>"+n.jgrid.getRegional(i,"colmenu.searchTitle")+"<\/div>",o+='<div><select id="oper1" class="'+d.filter_select+'">',n.each(p.odata,function(t,i){c=i.oper===nt?'selected="selected"':"";n.inArray(i.oper,g)!==-1&&(y+='<option value="'+i.oper+'" '+c+">"+i.text+"<\/option>")}),o+=y,o+="<\/select><\/div>",s.append(o),l="",e.searchoptions.defaultValue&&(l=n.isFunction(e.searchoptions.defaultValue)?e.searchoptions.defaultValue.call(i):e.searchoptions.defaultValue),b&&(l=b),w=n.extend(e.searchoptions,{name:e.index||e.name,id:"sval1_"+i.p.idPrefix+e.name,oper:"search"}),v=n.jgrid.createEl.call(i,e.stype,w,l,!1,n.extend({},n.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{})),n(v).addClass(d.filter_input),o=n("<div><\/div>").append(v),s.append(o),o='<div><select id="operand" class="'+d.filter_select+'">',n.each(rt,function(n,t){c=t.op===tt?'selected="selected"':"";o+="<option value='"+t.op+"' "+c+">"+t.text+"<\/option>"}),o+="<\/select><\/div>",s.append(o),y="",n.each(p.odata,function(t,i){c=i.oper===it?'selected="selected"':"";n.inArray(i.oper,g)!==-1&&(y+='<option value="'+i.oper+'" '+c+">"+i.text+"<\/option>")}),o='<div><select id="oper2" class="'+d.filter_select+'">'+y+"<\/select><\/div>",s.append(o),l=k?k:"",w=n.extend(e.searchoptions,{name:e.index||e.name,id:"sval2_"+i.p.idPrefix+e.name,oper:"search"}),v=n.jgrid.createEl.call(i,e.stype,w,l,!1,n.extend({},n.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{})),n(v).addClass(d.filter_input),o=n("<div><\/div>").append(v),s.append(o),o="<div>",o+="<div class='search_buttons'><a tabindex='0' id='bs_reset' class='fm-button "+ut.button+" ui-reset btn btn-white btn-inverse btn-sm'>"+p.Reset+"<\/a><\/div>",o+="<div class='search_buttons'><a tabindex='0' id='bs_search' class='fm-button "+ut.button+" ui-search btn btn-white btn-primary  btn-sm'>"+p.Find+"<\/a><\/div>",o+="<\/div>",s.append(o),s=n('<li class="ui-menu-item" role="presentation"><\/li>').append(s),u=u-20,s=n('<ul id="search_menu" class="ui-search-menu modal-content" role="menu" tabindex="0" style="left:'+u+"px;top:"+r+'px;width:190px"><\/ul>').append(s),n(f).append(s),n("#search_menu").addClass("ui-menu "+d.menu_widget),n("#bs_reset, #bs_search","#search_menu").hover(function(){n(this).addClass(a)},function(){n(this).removeClass(a)}),n(s).find("#bs_reset").click(function(){return i.p.colFilters[e.name]={},i.p.postData.filters=cr(),i.p.search=!0,n(i).trigger("reloadGrid"),n("#column_menu").remove(),!1}),n(s).find("#bs_search").click(function(){return i.p.colFilters[e.name]={oper1:n("#oper1","#search_menu").val(),value1:n("#sval1_"+i.p.idPrefix+e.name,"#search_menu").val(),rule:n("#operand","#search_menu").val(),oper2:n("#oper2","#search_menu").val(),value2:n("#sval2_"+i.p.idPrefix+e.name,"#search_menu").val()},i.p.postData.filters=cr(),i.p.search=!0,n(i).trigger("reloadGrid"),n("#column_menu").remove(),!1}))},cr=function(){var t='{"groupOp":"AND","rules":[], "groups" : [',f=0,u,r;for(u in i.p.colFilters)i.p.colFilters.hasOwnProperty(u)&&(r=i.p.colFilters[u],n.isEmptyObject(r)||(f>0&&(t+=","),t+='{"groupOp": "'+r.rule+'", "rules" : [',t+='{"field":"'+u+'",',t+='"op":"'+r.oper1+'",',r.value1+="",t+='"data":"'+r.value1.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',r.value2&&(t+=',{"field":"'+u+'",',t+='"op":"'+r.oper2+'",',r.value2+="",t+='"data":"'+r.value2.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}'),t+="]}",f++));return t+"]}"},eu=function(t,r){var f=i.p.colModel[t],u=i.p.groupingView;r!==-1?u.groupField.splice(r,1):u.groupField.push(f.name);n(i).jqGrid("groupingGroupBy",u.groupField);i.p.frozenColumns&&(n(i).jqGrid("destroyFrozenColumns"),n(i).jqGrid("setFrozenColumns"))},ou=function(t,r){for(var f=[],s=i.p.colModel.length,e=-1,o=i.p.colModel,u=0;u<s;u++)o[u].frozen&&(e=u),f.push(u);f.splice(t,1);f.splice(e+(r?1:0),0,t);o[t].frozen=r;n(i).jqGrid("destroyFrozenColumns");n(i).jqGrid("remapColumns",f,!0);n(i).jqGrid("setFrozenColumns")},su=function(t,r,u){var l;r=parseInt(r,10)+20;u=parseInt(u,10)+35;var v=n(".ui-jqgrid-view").css("font-size")||"11px",f='<ul id="column_menu" class="ui-search-menu modal-content column-menu dropdown-menu dropdown-menu-right dropdown-light-blue dropdown-caret dropdown-closer" role="menu" tabindex="0" style="font-size:'+v+";left:"+r+"px;top:"+u+'px;">',e=i.p.colModel[t],s=n.extend({sorting:!0,columns:!0,filtering:!0,seraching:!0,grouping:!0,freeze:!0},e.coloptions),o=n.jgrid.getRegional(i,"colmenu"),h,c;s.sorting&&(f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="sortasc"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-arrow-up"><\/i><\/td><td class="menu_text">'+o.sortasc+"<\/td><\/tr><\/table><\/a><\/li>",f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="sortdesc"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-arrow-down"><\/i><\/td><td class="menu_text">'+o.sortdesc+"<\/td><\/tr><\/table><\/a><\/li>");s.columns&&(f+='<li class="ui-menu-item divider" role="separator"><\/li>',f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="columns"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-list-alt"><\/i><\/td><td class="menu_text">'+o.columns+"<\/td><\/tr><\/table><\/a><\/li>");s.filtering&&(f+='<li class="ui-menu-item divider" role="separator"><\/li>',f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="filtering"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-filter"><\/i><\/td><td class="menu_text">'+o.filter+" "+(e.label||e.name)+"<\/td><\/tr><\/table><\/a><\/li>");s.grouping&&(h=n.inArray(e.name,i.p.groupingView.groupField),f+='<li class="ui-menu-item divider" role="separator"><\/li>',f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="grouping"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-align-left"><\/i><\/td><td class="menu_text">'+(h!==-1?o.ungrouping:o.grouping+" "+(e.label||e.name))+"<\/td><\/tr><\/table><\/a><\/li>");s.freeze&&(c=e.frozen&&i.p.frozenColumns?!1:!0,f+='<li class="ui-menu-item divider" role="separator"><\/li>',f+='<li class="ui-menu-item" role="presentation"><a class="g-menu-item" tabindex="0" role="menuitem" value="freeze"><table class="ui-common-table"><tr><td class="menu_icon"><i class="ace-icon fa fa-text-height"><\/i><\/td><td class="menu_text">'+(c?o.freeze+" "+(e.label||e.name):o.unfreeze)+"<\/td><\/tr><\/table><\/a><\/li>");f+="<\/ul>";n("body").append(f);n("#column_menu").addClass("ui-menu "+d.menu_widget);i.p.direction==="ltr"&&(l=n("#column_menu").width()+26,n("#column_menu").css("left",r-l));n("#column_menu > li > a").hover(function(){n("#col_menu").remove();n("#search_menu").remove();var i,r;n(this).attr("value")==="columns"&&(i=n(this).parent().width()+18,r=n(this).parent().position().top-5,uu(r,i,n(this).parent()));n(this).attr("value")==="filtering"&&(i=n(this).parent().width()+18,r=n(this).parent().position().top-5,fu(t,r,i,n(this).parent()));n(this).addClass(a)},function(){n(this).removeClass(a)}).click(function(){var r=n(this).attr("value"),u=i.grid.headers[t].el;r==="sortasc"?ri("jqgh_"+i.p.id+"_"+e.name,t,!0,"asc",u):r==="sortdesc"?ri("jqgh_"+i.p.id+"_"+e.name,t,!0,"desc",u):r==="grouping"?eu(t,h):r==="freeze"&&ou(t,c);(r.indexOf("sort")!==-1||r==="grouping"||r==="freeze")&&n(this).remove()})},lr;if(i.p.colMenu)n("body").on("click",function(t){n(t.target).closest(".column-menu").length||n("#column_menu").remove()});for(this.p.id=this.id,n.inArray(i.p.multikey,["shiftKey","altKey","ctrlKey"])===-1&&(i.p.multikey=!1),i.p.keyName=!1,o=0;o<i.p.colModel.length;o++)lr=typeof i.p.colModel[o].template=="string"?n.jgrid.cmTemplate!=null&&typeof n.jgrid.cmTemplate[i.p.colModel[o].template]=="object"?n.jgrid.cmTemplate[i.p.colModel[o].template]:{}:i.p.colModel[o].template,i.p.colModel[o]=n.extend(!0,{},i.p.cmTemplate,lr||{},i.p.colModel[o]),i.p.keyName===!1&&i.p.colModel[o].key===!0&&(i.p.keyName=i.p.colModel[o].name);if(i.p.sortorder=i.p.sortorder.toLowerCase(),n.jgrid.cell_width=n.jgrid.cellWidth(),i.p.grouping===!0&&(i.p.scroll=!1,i.p.rownumbers=!1,i.p.treeGrid=!1,i.p.gridview=!0),this.p.treeGrid===!0){try{n(this).jqGrid("setTreeGrid")}catch(hu){}i.p.datatype!=="local"&&(i.p.localReader={id:"_id_"})}if(this.p.subGrid)try{n(i).jqGrid("setSubGrid")}catch(cu){}this.p.multiselect&&(this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>"),this.p.colModel.unshift({name:"cb",width:n.jgrid.cell_width?i.p.multiselectWidth+i.p.cellLayout:i.p.multiselectWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0,frozen:!0}));this.p.rownumbers&&(this.p.colNames.unshift(""),this.p.colModel.unshift({name:"rn",width:i.p.rownumWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,align:"center",fixed:!0,frozen:!0}));i.p.xmlReader=n.extend(!0,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:!0,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:!0,cell:"cell"}},i.p.xmlReader);i.p.jsonReader=n.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!0,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},i.p.jsonReader);i.p.localReader=n.extend(!0,{root:"rows",page:"page",total:"total",records:"records",repeatitems:!1,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:!0,cell:"cell"}},i.p.localReader);i.p.scroll&&(i.p.pgbuttons=!1,i.p.pginput=!1,i.p.rowList=[]);i.p.data.length&&(er(),ai());var b="<thead><tr class='ui-jqgrid-labels' role='row'>",ar,pi,ui,pt,st="",l,c,vr,wt,wi="",bi="",s;if(i.p.shrinkToFit===!0&&i.p.forceFit===!0)for(o=i.p.colModel.length-1;o>=0;o--)if(!i.p.colModel[o].hidden){i.p.colModel[o].resizable=!1;break}if(i.p.viewsortcols[1]==="horizontal"?(wi=" ui-i-asc",bi=" ui-i-desc"):i.p.viewsortcols[1]==="single"&&(wi=" ui-single-sort-asc",bi=" ui-single-sort-desc",st=" style='display:none'",i.p.viewsortcols[0]=!1),ar=tr?"class='ui-th-div-ie'":"",wt="<span class='s-ico' style='display:none'>",wt+="<span sort='asc'  class='ui-grid-ico-sort ui-icon-asc"+wi+" ui-sort-"+v+" "+h+" "+nt+" "+f(e,"icon_asc",!0)+"'"+st+"><\/span>",wt+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+bi+" ui-sort-"+v+" "+h+" "+nt+" "+f(e,"icon_desc",!0)+"'"+st+"><\/span><\/span>",i.p.multiSort&&i.p.sortname)for(w=i.p.sortname.split(","),o=0;o<w.length;o++)ft=n.trim(w[o]).split(" "),w[o]=n.trim(ft[0]),it[o]=ft[1]?n.trim(ft[1]):i.p.sortorder||"asc";for(o=0;o<this.p.colNames.length;o++)yr=i.p.headertitles?' title="'+n.jgrid.stripHtml(i.p.colNames[o])+'"':"",s=i.p.colModel[o],s.hasOwnProperty("colmenu")||(s.colmenu=s.name==="rn"||s.name==="cb"||s.name==="subgrid"?!1:!0),b+="<th id='"+i.p.id+"_"+s.name+"' role='columnheader' "+f(e,"headerBox",!1,"ui-th-column ui-th-"+v)+" "+yr+">",pi=s.index||s.name,b+="<div class='ui-th-div' id='jqgh_"+i.p.id+"_"+s.name+"' "+ar+">"+i.p.colNames[o],s.width=s.width?parseInt(s.width,10):150,typeof s.title!="boolean"&&(s.title=!0),s.lso="",pi===i.p.sortname&&(i.p.lastsort=o),i.p.multiSort&&(ft=n.inArray(pi,w),ft!==-1&&(s.lso=it[ft])),b+=wt,i.p.colMenu&&s.colmenu&&(b+="<a class='colmenu' href='javascript:void(0)'><span class='colmenuspan "+nt+" "+d.icon_menu+"'><\/span><\/a>"),b+="<\/div><\/th>";if(b+="<\/tr><\/thead>",wt=null,s=null,n(this).append(b),n("thead tr:first th",this).hover(function(){n(this).addClass(a)},function(){n(this).removeClass(a)}),this.p.multiselect){bt=[];n("#cb_"+n.jgrid.jqID(i.p.id),this).on("click",function(){i.p.selarrrow=[];var t=i.p.frozenColumns===!0?i.p.id+"_frozen":"";this.checked?(n(i.rows).each(function(r){r>0&&(n(this).hasClass("ui-subgrid")||n(this).hasClass("jqgroup")||n(this).hasClass(h)||n(this).hasClass("jqfoot")||(n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(this.id))[i.p.useProp?"prop":"attr"]("checked",!0),n(this).addClass(ut).attr("aria-selected","true"),i.p.selarrrow.push(this.id),i.p.selrow=this.id,t&&(n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(this.id),i.grid.fbDiv)[i.p.useProp?"prop":"attr"]("checked",!0),n("#"+n.jgrid.jqID(this.id),i.grid.fbDiv).addClass(ut))))}),ct=!0,bt=[]):(n(i.rows).each(function(r){r>0&&(n(this).hasClass("ui-subgrid")||n(this).hasClass("jqgroup")||n(this).hasClass(h)||n(this).hasClass("jqfoot")||(n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(this.id))[i.p.useProp?"prop":"attr"]("checked",!1),n(this).removeClass(ut).attr("aria-selected","false"),bt.push(this.id),t&&(n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(this.id),i.grid.fbDiv)[i.p.useProp?"prop":"attr"]("checked",!1),n("#"+n.jgrid.jqID(this.id),i.grid.fbDiv).removeClass(ut))))}),i.p.selrow=null,ct=!1);n(i).triggerHandler("jqGridSelectAll",[ct?i.p.selarrrow:bt,ct]);n.isFunction(i.p.onSelectAll)&&i.p.onSelectAll.call(i,ct?i.p.selarrrow:bt,ct)})}if(i.p.autowidth===!0&&(ki=n(et).innerWidth(),i.p.width=ki>0?ki:"nw"),tu(),n(et).css("width",r.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+i.p.id+"'>&#160;<\/div>"),i.p.scrollPopUp&&n(et).append("<div "+f(e,"scrollBox",!1,"loading ui-scroll-popup")+" id='scroll_g"+i.p.id+"'><\/div>"),n(tt).css("width",r.width+"px"),b=n("thead:first",i).get(0),kt="",i.p.footerrow&&(kt+="<table role='presentation' style='width:"+i.p.tblwidth+"px' "+f(e,"footerTable",!1,"ui-jqgrid-ftable ui-common-table")+"><tbody><tr role='row' "+f(e,"footerBox",!1,"footrow footrow-"+v)+">"),di=n("tr:first",b),dt="<tr class='jqgfirstrow' role='row'>",i.p.disableClick=!1,n("th",di).each(function(t){var f,u;s=i.p.colModel[t];ui=s.width;s.resizable===undefined&&(s.resizable=!0);s.resizable?(pt=document.createElement("span"),n(pt).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+v).css("cursor","col-resize"),n(this).addClass(i.p.resizeclass)):pt="";n(this).css("width",ui+"px").prepend(pt);pt=null;f="";s.hidden&&(n(this).css("display","none"),f="display:none;");dt+="<td role='gridcell' style='height:0px;width:"+ui+"px;"+f+"'><\/td>";r.headers[t]={width:ui,el:this};st=s.sortable;typeof st!="boolean"&&(s.sortable=!0,st=!0);u=s.name;u==="cb"||u==="subgrid"||u==="rn"||i.p.viewsortcols[2]&&n(">div",this).addClass("ui-jqgrid-sortable");st&&(i.p.multiSort?i.p.viewsortcols[0]?(n("div span.s-ico",this).show(),i.p.colModel[t].lso&&n("div span.ui-icon-"+s.lso,this).removeClass(h).css("display","")):i.p.colModel[t].lso&&(n("div span.s-ico",this).show(),n("div span.ui-icon-"+s.lso,this).removeClass(h).css("display","")):i.p.viewsortcols[0]?(n("div span.s-ico",this).show(),t===i.p.lastsort&&n("div span.ui-icon-"+i.p.sortorder,this).removeClass(h).css("display","")):t===i.p.lastsort&&i.p.sortname!==""&&(n("div span.s-ico",this).show(),n("div span.ui-icon-"+i.p.sortorder,this).removeClass(h).css("display","")));i.p.footerrow&&(kt+="<td role='gridcell' "+at(t,0,"",null,"",!1)+">&#160;<\/td>")}).mousedown(function(t){if(n(t.target).closest("th>span.ui-jqgrid-resize").length===1){var u=hr(this);return i.p.forceFit===!0&&(i.p.nv=iu(u)),r.dragStart(u,t,ru(u)),!1}}).click(function(t){var f,o,s,r,u,h,e;if(i.p.disableClick)return i.p.disableClick=!1,!1;if(f="th>div.ui-jqgrid-sortable",i.p.viewsortcols[2]||(f="th>div>span>span.ui-grid-ico-sort"),r=n(t.target).closest(f),r.length===1){if(i.p.frozenColumns?(h=n(this)[0].id.substring(i.p.id.length+1),n(i.p.colModel).each(function(n){if(this.name===h)return u=n,!1})):u=hr(this),n(t.target).hasClass("colmenuspan")){if(n("#column_menu")[0]!=null&&n("#column_menu").remove(),e=n.jgrid.getCellIndex(t.target),e===-1)return;var c=n(this).offset(),l=c.left,a=c.top;i.p.direction==="ltr"&&(l+=n(this).outerWidth());su(e,l,a,r);t.stopPropagation();return}return i.p.viewsortcols[2]||(o=!0,s=r.attr("sort")),u!=null&&ri(n("div",this)[0].id,u,o,s,this),!1}}),s=null,i.p.sortable&&n.fn.sortable)try{n(i).jqGrid("sortableColumns",di)}catch(lu){}i.p.footerrow&&(kt+="<\/tr><\/tbody><\/table>");dt+="<\/tr>";vr=document.createElement("tbody");this.appendChild(vr);n(this).addClass(f(e,"rowTable",!0,"ui-jqgrid-btable ui-common-table")).append(dt);dt=null;var pr=n("<table "+f(e,"headerTable",!1,"ui-jqgrid-htable ui-common-table")+" style='width:"+i.p.tblwidth+"px' role='presentation' aria-labelledby='gbox_"+this.id+"'><\/table>").append(b),k=i.p.caption&&i.p.hiddengrid===!0?!0:!1,lt=n("<div class='ui-jqgrid-hbox"+(v==="rtl"?"-rtl":"")+"'><\/div>"),ht=i.p.styleUI==="Bootstrap"&&!isNaN(i.p.height)?2:0;if(b=null,r.hDiv=document.createElement("div"),r.hDiv.style.width=r.width-ht+"px",r.hDiv.className=f(e,"headerDiv",!0,"ui-jqgrid-hdiv"),n(r.hDiv).append(lt),n(lt).append(pr),pr=null,k&&n(r.hDiv).hide(),i.p.pager&&(typeof i.p.pager=="string"?i.p.pager.substr(0,1)!=="#"&&(i.p.pager="#"+i.p.pager):i.p.pager="#"+n(i.p.pager).attr("id"),n(i.p.pager).css({width:r.width+"px"}).addClass(f(e,"pagerBox",!0,"ui-jqgrid-pager")).appendTo(et),k&&n(i.p.pager).hide(),sr(i.p.pager,"")),i.p.cellEdit===!1&&i.p.hoverrows===!0)n(i).on({mouseover:function(t){c=n(t.target).closest("tr.jqgrow");n(c).attr("class")!=="ui-subgrid"&&n(c).addClass(a)},mouseout:function(t){c=n(t.target).closest("tr.jqgrow");n(c).removeClass(a)}});n(i).before(r.hDiv).on({click:function(t){var r,u,e,f;if(l=t.target,c=n(l,i.rows).closest("tr.jqgrow"),n(c).length===0||c[0].className.indexOf(h)>-1||(n(l,i).closest("table.ui-jqgrid-btable").attr("id")||"").replace("_frozen","")!==i.id)return this;if(r=n(l).filter(":enabled").hasClass("cbox"),u=n(i).triggerHandler("jqGridBeforeSelectRow",[c[0].id,t]),u=u===!1||u==="stop"?!1:!0,n.isFunction(i.p.beforeSelectRow)&&(e=i.p.beforeSelectRow.call(i,c[0].id,t),(e===!1||e==="stop")&&(u=!1)),l.tagName!=="A"&&(l.tagName!=="INPUT"&&l.tagName!=="TEXTAREA"&&l.tagName!=="OPTION"&&l.tagName!=="SELECT"||r)){if(p=c[0].id,l=n(l).closest("tr.jqgrow>td"),l.length>0&&(g=n.jgrid.getCellIndex(l),gi=n(l).closest("td,th").html(),n(i).triggerHandler("jqGridCellSelect",[p,g,gi,t]),n.isFunction(i.p.onCellSelect)&&i.p.onCellSelect.call(i,p,g,gi,t)),i.p.cellEdit===!0){if(i.p.multiselect&&r&&u)n(i).jqGrid("setSelection",p,!0,t);else if(l.length>0)try{n(i).jqGrid("editCell",c[0].rowIndex,g,!0)}catch(o){}return}u&&(i.p.multikey?t[i.p.multikey]?n(i).jqGrid("setSelection",p,!0,t):i.p.multiselect&&r&&(r=n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+p).is(":checked"),n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+p)[i.p.useProp?"prop":"attr"]("checked",!r)):i.p.multiselect&&i.p.multiboxonly?r?n(i).jqGrid("setSelection",p,!0,t):(f=i.p.frozenColumns?i.p.id+"_frozen":"",n(i.p.selarrrow).each(function(t,r){var u=n(i).jqGrid("getGridRowById",r);u&&n(u).removeClass(ut);n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(r))[i.p.useProp?"prop":"attr"]("checked",!1);f&&(n("#"+n.jgrid.jqID(r),"#"+n.jgrid.jqID(f)).removeClass(ut),n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(r),"#"+n.jgrid.jqID(f))[i.p.useProp?"prop":"attr"]("checked",!1))}),i.p.selarrrow=[],n(i).jqGrid("setSelection",p,!0,t)):n(i).jqGrid("setSelection",p,!0,t))}},reloadGrid:function(t,r){if(i.p.treeGrid===!0&&(i.p.datatype=i.p.treedatatype),r=r||{},r.current&&i.grid.selectionPreserver(i),i.p.datatype==="local"?(n(i).jqGrid("resetSelection"),i.p.data.length&&(er(),ai())):i.p.treeGrid||(i.p.selrow=null,i.p.multiselect&&(i.p.selarrrow=[],ii(!1)),i.p.savedRow=[]),i.p.scroll&&vt.call(i,!0,!1),r.page){var u=r.page;u>i.p.lastpage&&(u=i.p.lastpage);u<1&&(u=1);i.p.page=u;i.grid.bDiv.scrollTop=i.grid.prevRowHeight?(u-1)*i.grid.prevRowHeight*i.p.rowNum:0}return i.grid.prevRowHeight&&i.p.scroll&&r.page===undefined?(delete i.p.lastpage,i.grid.populateVisible()):i.grid.populate(),i.p.inlineNav===!0&&n(i).jqGrid("showAddEditButtons"),!1},dblclick:function(t){if(l=t.target,c=n(l,i.rows).closest("tr.jqgrow"),n(c).length!==0){p=c[0].rowIndex;g=n.jgrid.getCellIndex(l);var r=n(i).triggerHandler("jqGridDblClickRow",[n(c).attr("id"),p,g,t]);return r!=null?r:n.isFunction(i.p.ondblClickRow)&&(r=i.p.ondblClickRow.call(i,n(c).attr("id"),p,g,t),r!=null)?r:void 0}},contextmenu:function(t){if(l=t.target,c=n(l,i.rows).closest("tr.jqgrow"),n(c).length!==0){i.p.multiselect||n(i).jqGrid("setSelection",c[0].id,!0,t);p=c[0].rowIndex;g=n.jgrid.getCellIndex(l);var r=n(i).triggerHandler("jqGridRightClickRow",[n(c).attr("id"),p,g,t]);return r!=null?r:n.isFunction(i.p.onRightClickRow)&&(r=i.p.onRightClickRow.call(i,n(c).attr("id"),p,g,t),r!=null)?r:void 0}}});if(r.bDiv=document.createElement("div"),tr&&String(i.p.height).toLowerCase()==="auto"&&(i.p.height="100%"),n(r.bDiv).append(n('<div style="position:relative;"><\/div>').append("<div><\/div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:i.p.height+(isNaN(i.p.height)?"":"px"),width:r.width-ht+"px"}).scroll(r.scrollGrid),n("table:first",r.bDiv).css({width:i.p.tblwidth+"px"}),n.support.tbody||n("tbody",this).length===2&&n("tbody:gt(0)",this).remove(),i.p.multikey)if(n.jgrid.msie())n(r.bDiv).on("selectstart",function(){return!1});else n(r.bDiv).on("mousedown",function(){return!1});k&&n(r.bDiv).hide();fi=nt+" "+f(e,"icon_caption_open",!0);nr=nt+" "+f(e,"icon_caption_close",!0);r.cDiv=document.createElement("div");ei=i.p.hidegrid===!0?n("<a role='link' class='ui-jqgrid-titlebar-close HeaderButton "+dr+"' title='"+(n.jgrid.getRegional(i,"defaults.showhide",i.p.showhide)||"")+"' />").hover(function(){ei.addClass(a)},function(){ei.removeClass(a)}).append("<span class='ui-jqgrid-headlink "+fi+"'><\/span>").css(v==="rtl"?"left":"right","0px"):"";n(r.cDiv).append(ei).append("<span class='ui-jqgrid-title'>"+i.p.caption+"<\/span>").addClass("ui-jqgrid-titlebar ui-jqgrid-caption"+(v==="rtl"?"-rtl":"")+" "+f(e,"gridtitleBox",!0));n(r.cDiv).insertBefore(r.hDiv);i.p.toolbar[0]&&(oi=f(e,"customtoolbarBox",!0,"ui-userdata"),r.uDiv=document.createElement("div"),i.p.toolbar[1]==="top"?n(r.uDiv).insertBefore(r.hDiv):i.p.toolbar[1]==="bottom"&&n(r.uDiv).insertAfter(r.hDiv),i.p.toolbar[1]==="both"?(r.ubDiv=document.createElement("div"),n(r.uDiv).addClass(oi+" ui-userdata-top").attr("id","t_"+this.id).insertBefore(r.hDiv).width(r.width-ht),n(r.ubDiv).addClass(oi+" ui-userdata-bottom").attr("id","tb_"+this.id).insertAfter(r.hDiv).width(r.width-ht),k&&n(r.ubDiv).hide()):n(r.uDiv).width(r.width-ht).addClass(oi+" ui-userdata-top").attr("id","t_"+this.id),k&&n(r.uDiv).hide());i.p.toppager&&(i.p.toppager=n.jgrid.jqID(i.p.id)+"_toppager",r.topDiv=n("<div id='"+i.p.toppager+"'><\/div>")[0],i.p.toppager="#"+i.p.toppager,n(r.topDiv).addClass(f(e,"toppagerBox",!0,"ui-jqgrid-toppager")).width(r.width-ht).insertBefore(r.hDiv),sr(i.p.toppager,"_t"));i.p.footerrow&&(r.sDiv=n("<div class='ui-jqgrid-sdiv'><\/div>")[0],lt=n("<div class='ui-jqgrid-hbox"+(v==="rtl"?"-rtl":"")+"'><\/div>"),n(r.sDiv).append(lt).width(r.width-ht).insertAfter(r.hDiv),n(lt).append(kt),r.footers=n(".ui-jqgrid-ftable",r.sDiv)[0].rows[0].cells,i.p.rownumbers&&(r.footers[0].className=f(e,"rownumBox",!0,"jqgrid-rownum")),k&&n(r.sDiv).hide());lt=null;i.p.caption?(wr=i.p.datatype,i.p.hidegrid===!0&&(n(".ui-jqgrid-titlebar-close",r.cDiv).click(function(t){var e=n.isFunction(i.p.onHeaderClick),u=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-toppager, .ui-jqgrid-pager, .ui-jqgrid-sdiv",f,o=this;return i.p.toolbar[0]===!0&&(i.p.toolbar[1]==="both"&&(u+=", #"+n(r.ubDiv).attr("id")),u+=", #"+n(r.uDiv).attr("id")),f=n(u,"#gview_"+n.jgrid.jqID(i.p.id)).length,i.p.gridstate==="visible"?n(u,"#gbox_"+n.jgrid.jqID(i.p.id)).slideUp("fast",function(){f--;f===0&&(n("span",o).removeClass(fi).addClass(nr),i.p.gridstate="hidden",n("#gbox_"+n.jgrid.jqID(i.p.id)).hasClass("ui-resizable")&&n(".ui-resizable-handle","#gbox_"+n.jgrid.jqID(i.p.id)).hide(),n(i).triggerHandler("jqGridHeaderClick",[i.p.gridstate,t]),e&&(k||i.p.onHeaderClick.call(i,i.p.gridstate,t)))}):i.p.gridstate==="hidden"&&n(u,"#gbox_"+n.jgrid.jqID(i.p.id)).slideDown("fast",function(){f--;f===0&&(n("span",o).removeClass(nr).addClass(fi),k&&(i.p.datatype=wr,rt(),k=!1),i.p.gridstate="visible",n("#gbox_"+n.jgrid.jqID(i.p.id)).hasClass("ui-resizable")&&n(".ui-resizable-handle","#gbox_"+n.jgrid.jqID(i.p.id)).show(),n(i).triggerHandler("jqGridHeaderClick",[i.p.gridstate,t]),e&&(k||i.p.onHeaderClick.call(i,i.p.gridstate,t)))}),!1}),k&&(i.p.datatype="local",n(".ui-jqgrid-titlebar-close",r.cDiv).trigger("click")))):(n(r.cDiv).hide(),i.p.toppager||n(r.hDiv).addClass(f(i.p.styleUI+".common","cornertop",!0)));n(r.hDiv).after(r.bDiv).mousemove(function(n){if(r.resizing)return r.dragMove(n),!1});n(".ui-jqgrid-labels",r.hDiv).on("selectstart",function(){return!1});n(document).on("mouseup.jqGrid"+i.p.id,function(){return r.resizing?(r.dragEnd(!0),!1):!0});if(i.p.direction==="rtl")n(i).on("jqGridAfterGridComplete.setRTLPadding",function(){var t=r.bDiv.offsetWidth-r.bDiv.clientWidth;i.p.scrollOffset=t;n("div:first",r.hDiv).css({paddingLeft:t+"px"});r.hDiv.scrollLeft=r.bDiv.scrollLeft});if(i.formatCol=at,i.sortData=ri,i.updatepager=gr,i.refreshIndex=ai,i.setHeadCheckBox=ii,i.constructTr=vi,i.formatter=function(n,t,i,r,u){return rr(n,t,i,r,u)},n.extend(r,{populate:rt,emptyRows:vt,beginReq:yt,endReq:ot}),this.grid=r,i.addXmlData=function(n){yi(n)},i.addJSONData=function(n){ti(n)},i.addLocalData=function(n){return or(n)},this.grid.cols=this.rows[0].cells,n(i).triggerHandler("jqGridInitGrid"),n.isFunction(i.p.onInitGrid)&&i.p.onInitGrid.call(i),rt(),i.p.hiddengrid=!1,i.p.responsive){br="onorientationchange"in window;kr=br?"orientationchange":"resize";n(window).on(kr,function(){n(i).jqGrid("resizeGrid")})}}})};n.jgrid.extend({getGridParam:function(t,i){var u=this[0],r;if(u&&u.grid){if(i===undefined&&typeof i!="string"&&(i="jqGrid"),r=u.p,i!=="jqGrid")try{r=n(u).data(i)}catch(f){r=u.p}return t?r[t]!==undefined?r[t]:null:r}},setGridParam:function(t,i){return this.each(function(){if(i==null&&(i=!1),this.grid&&typeof t=="object")if(i===!0){var r=n.extend({},this.p,t);this.p=r}else n.extend(!0,this.p,t)})},getGridRowById:function(t){var i;return this.each(function(){try{for(var r=this.rows.length;r--;)if(t.toString()===this.rows[r].id){i=this.rows[r];break}}catch(u){i=n(this.grid.bDiv).find("#"+n.jgrid.jqID(t))}}),i},getDataIDs:function(){var r=[],t=0,i,u=0;return this.each(function(){if(i=this.rows.length,i&&i>0)while(t<i)n(this.rows[t]).hasClass("jqgrow")&&(r[u]=this.rows[t].id,u++),t++}),r},setSelection:function(t,i,r){return this.each(function(){function p(t){var f=n(u.grid.bDiv)[0].clientHeight,i=n(u.grid.bDiv)[0].scrollTop,r=n(u.rows[t]).position().top,e=u.rows[t].clientHeight;r+e>=f+i?n(u.grid.bDiv)[0].scrollTop=r-(f+i)+e+i:r<f+i&&r<i&&(n(u.grid.bDiv)[0].scrollTop=r)}var u=this,e,f,c,h,l,o,a,v=n.jgrid.getMethod("getStyleUI"),s=v(u.p.styleUI+".common","highlight",!0),y=v(u.p.styleUI+".common","disabled",!0);t!==undefined&&((i=i===!1?!1:!0,f=n(u).jqGrid("getGridRowById",t),!f||!f.className||f.className.indexOf(y)>-1)||(u.p.scrollrows===!0&&(c=n(u).jqGrid("getGridRowById",t).rowIndex,c>=0&&p(c)),u.p.frozenColumns===!0&&(o=u.p.id+"_frozen"),u.p.multiselect?(u.setHeadCheckBox(!1),u.p.selrow=f.id,h=n.inArray(u.p.selrow,u.p.selarrrow),h===-1?(f.className!=="ui-subgrid"&&n(f).addClass(s).attr("aria-selected","true"),e=!0,u.p.selarrrow.push(u.p.selrow)):(f.className!=="ui-subgrid"&&n(f).removeClass(s).attr("aria-selected","false"),e=!1,u.p.selarrrow.splice(h,1),l=u.p.selarrrow[0],u.p.selrow=l===undefined?null:l),n("#jqg_"+n.jgrid.jqID(u.p.id)+"_"+n.jgrid.jqID(f.id))[u.p.useProp?"prop":"attr"]("checked",e),o&&(h===-1?n("#"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(o)).addClass(s):n("#"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(o)).removeClass(s),n("#jqg_"+n.jgrid.jqID(u.p.id)+"_"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(o))[u.p.useProp?"prop":"attr"]("checked",e)),i&&(n(u).triggerHandler("jqGridSelectRow",[f.id,e,r]),u.p.onSelectRow&&u.p.onSelectRow.call(u,f.id,e,r))):f.className!=="ui-subgrid"&&(u.p.selrow!==f.id?(a=n(u).jqGrid("getGridRowById",u.p.selrow),a&&n(a).removeClass(s).attr({"aria-selected":"false",tabindex:"-1"}),n(f).addClass(s).attr({"aria-selected":"true",tabindex:"0"}),o&&(n("#"+n.jgrid.jqID(u.p.selrow),"#"+n.jgrid.jqID(o)).removeClass(s),n("#"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(o)).addClass(s)),e=!0):e=!1,u.p.selrow=f.id,i&&(n(u).triggerHandler("jqGridSelectRow",[f.id,e,r]),u.p.onSelectRow&&u.p.onSelectRow.call(u,f.id,e,r)))))})},resetSelection:function(t){return this.each(function(){var i=this,u,r,o=n.jgrid.getMethod("getStyleUI"),f=o(i.p.styleUI+".common","highlight",!0),s=o(i.p.styleUI+".common","hover",!0),e;i.p.frozenColumns===!0&&(r=i.p.id+"_frozen");t!==undefined?(u=t===i.p.selrow?i.p.selrow:t,n("#"+n.jgrid.jqID(i.p.id)+" tbody:first tr#"+n.jgrid.jqID(u)).removeClass(f).attr("aria-selected","false"),r&&n("#"+n.jgrid.jqID(u),"#"+n.jgrid.jqID(r)).removeClass(f),i.p.multiselect&&(n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(u),"#"+n.jgrid.jqID(i.p.id))[i.p.useProp?"prop":"attr"]("checked",!1),r&&n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(u),"#"+n.jgrid.jqID(r))[i.p.useProp?"prop":"attr"]("checked",!1),i.setHeadCheckBox(!1),e=n.inArray(n.jgrid.jqID(u),i.p.selarrrow),e!==-1&&i.p.selarrrow.splice(e,1)),i.p.onUnSelectRow&&i.p.onUnSelectRow.call(i,u),u=null):i.p.multiselect?(n(i.p.selarrrow).each(function(t,u){n(n(i).jqGrid("getGridRowById",u)).removeClass(f).attr("aria-selected","false");n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(u))[i.p.useProp?"prop":"attr"]("checked",!1);r&&(n("#"+n.jgrid.jqID(u),"#"+n.jgrid.jqID(r)).removeClass(f),n("#jqg_"+n.jgrid.jqID(i.p.id)+"_"+n.jgrid.jqID(u),"#"+n.jgrid.jqID(r))[i.p.useProp?"prop":"attr"]("checked",!1));i.p.onUnSelectRow&&i.p.onUnSelectRow.call(i,u)}),i.setHeadCheckBox(!1),i.p.selarrrow=[],i.p.selrow=null):i.p.selrow&&(n("#"+n.jgrid.jqID(i.p.id)+" tbody:first tr#"+n.jgrid.jqID(i.p.selrow)).removeClass(f).attr("aria-selected","false"),r&&n("#"+n.jgrid.jqID(i.p.selrow),"#"+n.jgrid.jqID(r)).removeClass(f),i.p.onUnSelectRow&&i.p.onUnSelectRow.call(i,i.p.selrow),i.p.selrow=null);i.p.cellEdit===!0&&parseInt(i.p.iCol,10)>=0&&parseInt(i.p.iRow,10)>=0&&(n("td:eq("+i.p.iCol+")",i.rows[i.p.iRow]).removeClass("edit-cell "+f),n(i.rows[i.p.iRow]).removeClass("selected-row "+s));i.p.savedRow=[]})},getRowData:function(t,i){var r={},u,f=!1,e,o=0,s=!0;return(this.each(function(){var h=this,l,c,a,v;if(t===null||t===undefined)f=!0,u=[],e=h.rows.length-1;else{if(c=n(h).jqGrid("getGridRowById",t),!c)return r;e=1}for(i&&i===!0&&h.p.data.length>0||(i=!1);o<e;){if(f&&(c=h.rows[o+1]),n(c).hasClass("jqgrow")){if(i)r=h.p.data[h.p._index[c.id]];else{if(a=n(c).attr("editable")||"0",a==="1"&&h.p.editurl==="clientArray"&&(v=n(h).jqGrid("saveRow",c.id),!v))return s=!1,!1;n('td[role="gridcell"]',c).each(function(t){if(l=h.p.colModel[t].name,l!=="cb"&&l!=="subgrid"&&l!=="rn")if(h.p.treeGrid===!0&&l===h.p.ExpandColumn)r[l]=n.jgrid.htmlDecode(n("span:first",this).html());else try{r[l]=n.unformat.call(h,this,{rowId:c.id,colModel:h.p.colModel[t]},t)}catch(i){r[l]=n.jgrid.htmlDecode(n(this).html())}})}f&&(u.push(r),r={})}o++}}),!s)?s:u||r},delRowData:function(t){var r=!1,i,u,f;return this.each(function(){var e=this,h,o,s;if(i=n(e).jqGrid("getGridRowById",t),!i)return!1;e.p.subGrid&&(f=n(i).next(),f.hasClass("ui-subgrid")&&f.remove());n(i).remove();e.p.records--;e.p.reccount--;e.updatepager(!0,!1);r=!0;e.p.multiselect&&(u=n.inArray(t,e.p.selarrrow),u!==-1&&e.p.selarrrow.splice(u,1));e.p.multiselect&&e.p.selarrrow.length>0?e.p.selrow=e.p.selarrrow[e.p.selarrrow.length-1]:e.p.selrow===t&&(e.p.selrow=null);e.p.datatype==="local"&&(h=n.jgrid.stripPref(e.p.idPrefix,t),o=e.p._index[h],o!==undefined&&(e.p.data.splice(o,1),e.refreshIndex()));e.p.altRows===!0&&r&&(s=e.p.altclass,n(e.rows).each(function(t){t%2==1?n(this).addClass(s):n(this).removeClass(s)}))}),r},setRowData:function(t,i,r){var u,f=!0,e;return this.each(function(){var y,l,a;if(!this.grid)return!1;var o=this,c,s,v=typeof r,h={};if(s=n(this).jqGrid("getGridRowById",t),!s)return!1;if(i)try{if(i.Id!==undefined&&t!==i.Id&&(this.p.selrow=i.Id,s.id=i.Id),n(this.p.colModel).each(function(r){u=this.name;var f=n.jgrid.getAccessor(i,u);f!==undefined&&(h[u]=this.formatter&&typeof this.formatter=="string"&&this.formatter==="date"?n.unformat.date.call(o,f,this):f,c=o.formatter(t,h[u],r,i,"edit"),e=this.title?{title:n.jgrid.stripHtml(c)}:{},o.p.treeGrid===!0&&u===o.p.ExpandColumn?n("td[role='gridcell']:eq("+r+") > span:first",s).html(c).attr(e):n("td[role='gridcell']:eq("+r+")",s).html(c).attr(e))}),o.p.datatype==="local"){if(y=n.jgrid.stripPref(o.p.idPrefix,t),l=o.p._index[y],o.p.treeGrid)for(a in o.p.treeReader)o.p.treeReader.hasOwnProperty(a)&&delete h[o.p.treeReader[a]];l!==undefined&&(o.p.data[l]=n.extend(!0,o.p.data[l],h));h=null}}catch(p){f=!1}f&&(v==="string"?n(s).addClass(r):r!==null&&v==="object"&&n(s).css(r),n(o).triggerHandler("jqGridAfterGridComplete"))}),f},addRowData:function(t,i,r,u){n.inArray(r,["first","last","before","after"])===-1&&(r="last");var d=!1,w,f,g="",nt="",h,b,s,e,c,a,l="",v,y,p,o,tt,k;return i&&(n.isArray(i)?(v=!0,y=t):(i=[i],v=!1),this.each(function(){var it=this,et=i.length;s=it.p.rownumbers===!0?1:0;h=it.p.multiselect===!0?1:0;b=it.p.subGrid===!0?1:0;v||(t!==undefined?t=String(t):(t=n.jgrid.randId(),it.p.keyName!==!1&&(y=it.p.keyName,i[0][y]!==undefined&&(t=i[0][y]))));p=it.p.altclass;var ut=0,ot=n(it).jqGrid("getStyleUI",it.p.styleUI+".base","rowBox",!0,"jqgrow ui-row-"+it.p.direction),rt={},ft,st=n.isFunction(it.p.afterInsertRow)?!0:!1;for(s&&(g=n(it).jqGrid("getStyleUI",it.p.styleUI+".base","rownumBox",!1,"jqgrid-rownum")),h&&(nt=n(it).jqGrid("getStyleUI",it.p.styleUI+".base","multiBox",!1,"cbox"));ut<et;){if(o=i[ut],f=[],ft=ot,v){try{t=o[y];t===undefined&&(t=n.jgrid.randId())}catch(ht){t=n.jgrid.randId()}ft+=it.p.altRows===!0?(it.rows.length-1)%2==0?" "+p:"":""}for(k=t,t=it.p.idPrefix+t,s&&(l=it.formatCol(0,1,"",null,t,!0),f[f.length]='<td role="gridcell" '+g+" "+l+">0<\/td>"),h&&(a='<input role="checkbox" type="checkbox" id="jqg_'+it.p.id+"_"+t+'" '+nt+"/>",l=it.formatCol(s,1,"",null,t,!0),f[f.length]='<td role="gridcell" '+l+">"+a+"<\/td>"),b&&(f[f.length]=n(it).jqGrid("addSubGridCell",h+s,1)),c=h+b+s;c<it.p.colModel.length;c++)tt=it.p.colModel[c],w=tt.name,rt[w]=o[w],a=it.formatter(t,n.jgrid.getAccessor(o,w),c,o),l=it.formatCol(c,1,a,o,t,rt),f[f.length]='<td role="gridcell" '+l+">"+a+"<\/td>";if(f.unshift(it.constructTr(t,!1,ft,rt,o)),f[f.length]="<\/tr>",it.rows.length===0)n("table:first",it.grid.bDiv).append(f.join(""));else switch(r){case"last":n(it.rows[it.rows.length-1]).after(f.join(""));e=it.rows.length-1;break;case"first":n(it.rows[0]).after(f.join(""));e=1;break;case"after":e=n(it).jqGrid("getGridRowById",u);e&&(n(it.rows[e.rowIndex+1]).hasClass("ui-subgrid")?n(it.rows[e.rowIndex+1]).after(f):n(e).after(f.join("")),e=e.rowIndex+1);break;case"before":e=n(it).jqGrid("getGridRowById",u);e&&(n(e).before(f.join("")),e=e.rowIndex-1)}it.p.subGrid===!0&&n(it).jqGrid("addSubGrid",h+s,e);it.p.records++;it.p.reccount++;n(it).triggerHandler("jqGridAfterInsertRow",[t,o,o]);st&&it.p.afterInsertRow.call(it,t,o,o);ut++;it.p.datatype==="local"&&(rt[it.p.localReader.id]=k,it.p._index[k]=it.p.data.length,it.p.data.push(rt),rt={})}it.p.altRows!==!0||v||(r==="last"?(it.rows.length-1)%2==0&&n(it.rows[it.rows.length-1]).addClass(p):n(it.rows).each(function(t){t%2==0?n(this).addClass(p):n(this).removeClass(p)}));it.updatepager(!0,!0);d=!0})),d},footerData:function(t,i,r){function s(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}var u,f=!1,e={},o;return t===undefined&&(t="get"),typeof r!="boolean"&&(r=!0),t=t.toLowerCase(),this.each(function(){var h=this,c;if(!h.grid||!h.p.footerrow||t==="set"&&s(i))return!1;f=!0;n(this.p.colModel).each(function(s){u=this.name;t==="set"?i[u]!==undefined&&(c=r?h.formatter("",i[u],s,i,"edit"):i[u],o=this.title?{title:n.jgrid.stripHtml(c)}:{},n("tr.footrow td:eq("+s+")",h.grid.sDiv).html(c).attr(o),f=!0):t==="get"&&(e[u]=n("tr.footrow td:eq("+s+")",h.grid.sDiv).html())})}),t==="get"?e:f},showHideCol:function(t,i){return this.each(function(){var r=this,h=!1,c=n.jgrid.cell_width?0:r.p.cellLayout,e,u,o,s,f;if(r.grid&&(typeof t=="string"&&(t=[t]),i=i!=="none"?"":"none",u=i===""?!0:!1,o=r.p.groupHeader&&(n.isArray(r.p.groupHeader)||n.isFunction(r.p.groupHeader)),o&&n(r).jqGrid("destroyGroupHeader",!1),n(this.p.colModel).each(function(f){if(n.inArray(this.name,t)!==-1&&this.hidden===u){if(r.p.frozenColumns===!0&&this.frozen===!0)return!0;n("tr[role=row]",r.grid.hDiv).each(function(){n(this.cells[f]).css("display",i)});n(r.rows).each(function(){n(this).hasClass("jqgroup")||n(this.cells[f]).css("display",i)});r.p.footerrow&&n("tr.footrow td:eq("+f+")",r.grid.sDiv).css("display",i);e=parseInt(this.width,10);i==="none"?r.p.tblwidth-=e+c:r.p.tblwidth+=e+c;this.hidden=!u;h=!0;n(r).triggerHandler("jqGridShowHideCol",[u,this.name,f])}}),h===!0&&(r.p.shrinkToFit!==!0||isNaN(r.p.height)||(r.p.tblwidth+=parseInt(r.p.scrollOffset,10)),n(r).jqGrid("setGridWidth",r.p.shrinkToFit===!0?r.p.tblwidth:r.p.width)),o))for(s=n.extend([],r.p.groupHeader),r.p.groupHeader=null,f=0;f<s.length;f++)n(r).jqGrid("setGroupHeaders",s[f])})},hideCol:function(t){return this.each(function(){n(this).jqGrid("showHideCol",t,"none")})},showCol:function(t){return this.each(function(){n(this).jqGrid("showHideCol",t,"")})},remapColumns:function(t,i,r){function f(i){var r;r=i.length?n.makeArray(i):n.extend({},i);n.each(t,function(n){i[n]=r[this]})}function e(i,r){n(">tr"+(r||""),i).each(function(){var i=this,r=n.makeArray(i.cells);n.each(t,function(){var n=r[this];n&&i.appendChild(n)})})}var u=this.get(0);f(u.p.colModel);f(u.p.colNames);f(u.grid.headers);e(n("thead:first",u.grid.hDiv),r&&":not(.ui-jqgrid-labels)");i&&e(n("#"+n.jgrid.jqID(u.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot");u.p.footerrow&&e(n("tbody:first",u.grid.sDiv));u.p.remapColumns&&(u.p.remapColumns.length?f(u.p.remapColumns):u.p.remapColumns=n.makeArray(t));u.p.lastsort=n.inArray(u.p.lastsort,t);u.p.treeGrid&&(u.p.expColInd=n.inArray(u.p.expColInd,t));n(u).triggerHandler("jqGridRemapColumns",[t,i,r])},setGridWidth:function(t,i){return this.each(function(){var y,w;if(this.grid){var r=this,u,e=0,o=n.jgrid.cell_width?0:r.p.cellLayout,f,s=0,p=!1,a=r.p.scrollOffset,v,h=0,l,c=r.p.styleUI==="Bootstrap"?2:0;if(typeof i!="boolean"&&(i=r.p.shrinkToFit),!isNaN(t)){if(t=parseInt(t,10),r.grid.width=r.p.width=t,n("#gbox_"+n.jgrid.jqID(r.p.id)).css("width",t+"px"),n("#gview_"+n.jgrid.jqID(r.p.id)).css("width",t+"px"),n(r.grid.bDiv).css("width",t-c+"px"),n(r.grid.hDiv).css("width",t-c+"px"),r.p.pager&&n(r.p.pager).css("width",t+"px"),r.p.toppager&&n(r.p.toppager).css("width",t-c+"px"),r.p.toolbar[0]===!0&&(n(r.grid.uDiv).css("width",t-c+"px"),r.p.toolbar[1]==="both"&&n(r.grid.ubDiv).css("width",t-c+"px")),r.p.footerrow&&n(r.grid.sDiv).css("width",t-c+"px"),i===!1&&r.p.forceFit===!0&&(r.p.forceFit=!1),i===!0){if(n.each(r.p.colModel,function(){this.hidden===!1&&(u=this.widthOrg,e+=u+o,this.fixed?h+=u+o:s++)}),s===0)return;if(r.p.tblwidth=e,v=t-o*s-h,isNaN(r.p.height)||(n(r.grid.bDiv)[0].clientHeight<n(r.grid.bDiv)[0].scrollHeight||r.rows.length===1)&&(p=!0,v-=a),e=0,y=r.grid.cols.length>0,n.each(r.p.colModel,function(n){if(this.hidden===!1&&!this.fixed){if(u=this.widthOrg,u=Math.round(v*u/(r.p.tblwidth-o*s-h)),u<0)return;this.width=u;e+=u;r.grid.headers[n].width=u;r.grid.headers[n].el.style.width=u+"px";r.p.footerrow&&(r.grid.footers[n].style.width=u+"px");y&&(r.grid.cols[n].style.width=u+"px");f=n}}),!f)return;l=0;p?t-h-(e+o*s)!==a&&(l=t-h-(e+o*s)-a):Math.abs(t-h-(e+o*s))!==1&&(l=t-h-(e+o*s));r.p.colModel[f].width+=l;r.p.tblwidth=e+l+o*s+h;r.p.tblwidth>t?(w=r.p.tblwidth-parseInt(t,10),r.p.tblwidth=t,u=r.p.colModel[f].width=r.p.colModel[f].width-w):u=r.p.colModel[f].width;r.grid.headers[f].width=u;r.grid.headers[f].el.style.width=u+"px";y&&(r.grid.cols[f].style.width=u+"px");r.p.footerrow&&(r.grid.footers[f].style.width=u+"px")}r.p.tblwidth&&(n("table:first",r.grid.bDiv).css("width",r.p.tblwidth+"px"),n("table:first",r.grid.hDiv).css("width",r.p.tblwidth+"px"),r.grid.hDiv.scrollLeft=r.grid.bDiv.scrollLeft,r.p.footerrow&&n("table:first",r.grid.sDiv).css("width",r.p.tblwidth+"px"))}}})},setGridHeight:function(t){return this.each(function(){var i=this,r;i.grid&&(r=n(i.grid.bDiv),r.css({height:t+(isNaN(t)?"":"px")}),i.p.frozenColumns===!0&&n("#"+n.jgrid.jqID(i.p.id)+"_frozen").parent().height(r.height()-16),i.p.height=t,i.p.scroll&&i.grid.populateVisible())})},setCaption:function(t){return this.each(function(){var i=n(this).jqGrid("getStyleUI",this.p.styleUI+".common","cornertop",!0);this.p.caption=t;n(".ui-jqgrid-title, .ui-jqgrid-title-rtl",this.grid.cDiv).html(t);n(this.grid.cDiv).show();n(this.grid.hDiv).removeClass(i)})},setLabel:function(t,i,r,u){return this.each(function(){var o=this,e=-1,f,s;if(o.grid){if(t!=null)isNaN(t)?n(o.p.colModel).each(function(n){if(this.name===t)return e=n,!1}):e=parseInt(t,10);else return;e>=0&&(f=n("tr.ui-jqgrid-labels th:eq("+e+")",o.grid.hDiv),i&&(s=n(".s-ico",f),n("[id^=jqgh_]",f).empty().html(i).append(s),o.p.colNames[e]=i),r&&(typeof r=="string"?n(f).addClass(r):n(f).css(r)),typeof u=="object"&&n(f).attr(u))}})},setSortIcon:function(t,i){return this.each(function(){var u=this,r=-1,f;if(u.grid){if(t!=null)isNaN(t)?n(u.p.colModel).each(function(n){if(this.name===t)return r=n,!1}):r=parseInt(t,10);else return;r>=0&&(f=n("tr.ui-jqgrid-labels th:eq("+r+")",u.grid.hDiv),i==="left"?f.find(".s-ico").css("float","left"):f.find(".s-ico").css("float","none"))}})},setCell:function(t,i,r,u,f,e){return this.each(function(){var o=this,s=-1,a,v,h,l,p;if(o.grid&&(isNaN(i)?n(o.p.colModel).each(function(n){if(this.name===i)return s=n,!1}):s=parseInt(i,10),s>=0&&(h=n(o).jqGrid("getGridRowById",t),h))){var c=n("td:eq("+s+")",h),y=0,w=[];if(r!==""||e===!0){if(h.cells!==undefined)while(y<h.cells.length)w.push(h.cells[y].innerHTML),y++;a=o.formatter(t,r,s,w,"edit");v=o.p.colModel[s].title?{title:n.jgrid.stripHtml(a)}:{};o.p.treeGrid&&n(".tree-wrap",n(c)).length>0?n("span",n(c)).html(a).attr(v):n(c).html(a).attr(v);o.p.datatype==="local"&&(l=o.p.colModel[s],r=l.formatter&&typeof l.formatter=="string"&&l.formatter==="date"?n.unformat.date.call(o,r,l):r,p=o.p._index[n.jgrid.stripPref(o.p.idPrefix,t)],p!==undefined&&(o.p.data[p][l.name]=r))}typeof u=="string"?n(c).addClass(u):u&&n(c).css(u);typeof f=="object"&&n(c).attr(f)}})},getCell:function(t,i){var r=!1;return this.each(function(){var u=this,f=-1,o,e;if(u.grid&&(o=i,isNaN(i)?n(u.p.colModel).each(function(n){if(this.name===i)return o=this.name,f=n,!1}):f=parseInt(i,10),f>=0)){if(e=n(u).jqGrid("getGridRowById",t),e)try{r=n.unformat.call(u,n("td:eq("+f+")",e),{rowId:e.id,colModel:u.p.colModel[f]},f)}catch(s){r=n.jgrid.htmlDecode(n("td:eq("+f+")",e).html())}u.p.treeGrid&&r&&u.p.ExpandColumn===o&&(r=n("<div>"+r+"<\/div>").find("span:first").html())}}),r},getCol:function(t,i,r){var u=[],e,h=0,s,o,f;return i=typeof i!="boolean"?!1:i,r===undefined&&(r=!1),this.each(function(){var c=this,l=-1;if(c.grid&&(isNaN(t)?n(c.p.colModel).each(function(n){if(this.name===t)return l=n,!1}):l=parseInt(t,10),l>=0)){var v=c.rows.length,a=0,y=0;if(v&&v>0){while(a<v){if(n(c.rows[a]).hasClass("jqgrow")){try{e=n.unformat.call(c,n(c.rows[a].cells[l]),{rowId:c.rows[a].id,colModel:c.p.colModel[l]},l)}catch(p){e=n.jgrid.htmlDecode(c.rows[a].cells[l].innerHTML)}r?(f=parseFloat(e),isNaN(f)||(h+=f,o===undefined&&(o=s=f),s=Math.min(s,f),o=Math.max(o,f),y++)):i?u.push({id:c.rows[a].id,value:e}):u.push(e)}a++}if(r)switch(r.toLowerCase()){case"sum":u=h;break;case"avg":u=h/y;break;case"count":u=v-1;break;case"min":u=s;break;case"max":u=o}}}}),u},clearGridData:function(t){return this.each(function(){var i=this,r;i.grid&&(typeof t!="boolean"&&(t=!1),i.p.deepempty?n("#"+n.jgrid.jqID(i.p.id)+" tbody:first tr:gt(0)").remove():(r=n("#"+n.jgrid.jqID(i.p.id)+" tbody:first tr:first")[0],n("#"+n.jgrid.jqID(i.p.id)+" tbody:first").empty().append(r)),i.p.footerrow&&t&&n(".ui-jqgrid-ftable td",i.grid.sDiv).html("&#160;"),i.p.selrow=null,i.p.selarrrow=[],i.p.savedRow=[],i.p.records=0,i.p.page=1,i.p.lastpage=0,i.p.reccount=0,i.p.data=[],i.p._index={},i.updatepager(!0,!1))})},getInd:function(t,i){var u=!1,r;return this.each(function(){r=n(this).jqGrid("getGridRowById",t);r&&(u=i===!0?r:r.rowIndex)}),u},bindKeys:function(t){var i=n.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:!0},t||{});return this.each(function(){var t=this;n("body").is("[role]")||n("body").attr("role","application");t.p.scrollrows=i.scrollingRows;n(t).keydown(function(r){var e=n(t).find("tr[tabindex=0]")[0],f,u,o,s=t.p.treeReader.expanded_field;if(e)if(o=t.p._index[n.jgrid.stripPref(t.p.idPrefix,e.id)],r.keyCode===37||r.keyCode===38||r.keyCode===39||r.keyCode===40){if(r.keyCode===38){if(u=e.previousSibling,f="",u)if(n(u).is(":hidden")){while(u)if(u=u.previousSibling,!n(u).is(":hidden")&&n(u).hasClass("jqgrow")){f=u.id;break}}else f=u.id;n(t).jqGrid("setSelection",f,!0,r);r.preventDefault()}if(r.keyCode===40){if(u=e.nextSibling,f="",u)if(n(u).is(":hidden")){while(u)if(u=u.nextSibling,!n(u).is(":hidden")&&n(u).hasClass("jqgrow")){f=u.id;break}}else f=u.id;n(t).jqGrid("setSelection",f,!0,r);r.preventDefault()}r.keyCode===37&&(t.p.treeGrid&&t.p.data[o][s]&&n(e).find("div.treeclick").trigger("click"),n(t).triggerHandler("jqGridKeyLeft",[t.p.selrow]),n.isFunction(i.onLeftKey)&&i.onLeftKey.call(t,t.p.selrow));r.keyCode===39&&(t.p.treeGrid&&!t.p.data[o][s]&&n(e).find("div.treeclick").trigger("click"),n(t).triggerHandler("jqGridKeyRight",[t.p.selrow]),n.isFunction(i.onRightKey)&&i.onRightKey.call(t,t.p.selrow))}else r.keyCode===13?(n(t).triggerHandler("jqGridKeyEnter",[t.p.selrow]),n.isFunction(i.onEnter)&&i.onEnter.call(t,t.p.selrow)):r.keyCode===32&&(n(t).triggerHandler("jqGridKeySpace",[t.p.selrow]),n.isFunction(i.onSpace)&&i.onSpace.call(t,t.p.selrow))})})},unbindKeys:function(){return this.each(function(){n(this).off("keydown")})},getLocalRow:function(t){var r=!1,i;return this.each(function(){t!==undefined&&(i=this.p._index[n.jgrid.stripPref(this.p.idPrefix,t)],i>=0&&(r=this.p.data[i]))}),r},progressBar:function(t){return t=n.extend({htmlcontent:"",method:"hide",loadtype:"disable"},t||{}),this.each(function(){var r=t.method==="show"?!0:!1,i=n("#load_"+n.jgrid.jqID(this.p.id)),u,f,e=n(window).scrollTop();t.htmlcontent!==""&&i.html(t.htmlcontent);switch(t.loadtype){case"enable":i.toggle(r);break;case"block":n("#lui_"+n.jgrid.jqID(this.p.id)).toggle(r);i.toggle(r)}i.is(":visible")&&(u=i.offsetParent(),i.css("top",""),i.offset().top<e&&(f=Math.min(10+e-u.offset().top,u.height()-i.height()),i.css("top",f+"px")))})},getColProp:function(n){var r={},u=this[0],i,t;if(!u.grid)return!1;for(i=u.p.colModel,t=0;t<i.length;t++)if(i[t].name===n){r=i[t];break}return r},setColProp:function(t,i){return this.each(function(){if(this.grid&&i)for(var u=this.p.colModel,r=0;r<u.length;r++)if(u[r].name===t){n.extend(!0,this.p.colModel[r],i);break}})},sortGrid:function(n,t,i){return this.each(function(){var r=this,f=-1,u,e=!1,o;if(r.grid){for(n||(n=r.p.sortname),u=0;u<r.p.colModel.length;u++)if(r.p.colModel[u].index===n||r.p.colModel[u].name===n){f=u;r.p.frozenColumns===!0&&r.p.colModel[u].frozen===!0&&(e=r.grid.fhDiv.find("#"+r.p.id+"_"+n));break}f!==-1&&(o=r.p.colModel[f].sortable,e||(e=r.grid.headers[f].el),typeof o!="boolean"&&(o=!0),typeof t!="boolean"&&(t=!1),o&&r.sortData("jqgh_"+r.p.id+"_"+n,f,t,i,e))}})},setGridState:function(t){return this.each(function(){if(this.grid){var i=this,r=n(this).jqGrid("getStyleUI",this.p.styleUI+".base","icon_caption_open",!0),u=n(this).jqGrid("getStyleUI",this.p.styleUI+".base","icon_caption_close",!0);t==="hidden"?(n(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+n.jgrid.jqID(i.p.id)).slideUp("fast"),i.p.pager&&n(i.p.pager).slideUp("fast"),i.p.toppager&&n(i.p.toppager).slideUp("fast"),i.p.toolbar[0]===!0&&(i.p.toolbar[1]==="both"&&n(i.grid.ubDiv).slideUp("fast"),n(i.grid.uDiv).slideUp("fast")),i.p.footerrow&&n(".ui-jqgrid-sdiv","#gbox_"+n.jgrid.jqID(i.p.id)).slideUp("fast"),n(".ui-jqgrid-headlink",i.grid.cDiv).removeClass(r).addClass(u),i.p.gridstate="hidden"):t==="visible"&&(n(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+n.jgrid.jqID(i.p.id)).slideDown("fast"),i.p.pager&&n(i.p.pager).slideDown("fast"),i.p.toppager&&n(i.p.toppager).slideDown("fast"),i.p.toolbar[0]===!0&&(i.p.toolbar[1]==="both"&&n(i.grid.ubDiv).slideDown("fast"),n(i.grid.uDiv).slideDown("fast")),i.p.footerrow&&n(".ui-jqgrid-sdiv","#gbox_"+n.jgrid.jqID(i.p.id)).slideDown("fast"),n(".ui-jqgrid-headlink",i.grid.cDiv).removeClass(u).addClass(r),i.p.gridstate="visible")}})},setFrozenColumns:function(){return this.each(function(){var u,h,f,o,s,l,y,p,c;if(this.grid){var t=this,a=t.p.colModel,e=0,w=a.length,i=-1,v=!1,b=n(t).jqGrid("getStyleUI",t.p.styleUI+".base","headerDiv",!0,"ui-jqgrid-hdiv"),r=n(t).jqGrid("getStyleUI",t.p.styleUI+".common","hover",!0);if(t.p.subGrid!==!0&&t.p.treeGrid!==!0&&t.p.cellEdit!==!0&&!t.p.sortable&&!t.p.scroll){for(t.p.rownumbers&&e++,t.p.multiselect&&e++;e<w;){if(a[e].frozen===!0)v=!0,i=e;else break;e++}if(i>=0&&v){u=t.p.caption?n(t.grid.cDiv).outerHeight():0;h=n(".ui-jqgrid-htable","#gview_"+n.jgrid.jqID(t.p.id)).height();t.p.toppager&&(u=u+n(t.grid.topDiv).outerHeight());t.p.toolbar[0]===!0&&t.p.toolbar[1]!=="bottom"&&(u=u+n(t.grid.uDiv).outerHeight());t.grid.fhDiv=n('<div style="position:absolute;'+(t.p.direction==="rtl"?"right:0;":"left:0;")+"top:"+u+"px;height:"+h+'px;" class="frozen-div '+b+'"><\/div>');t.grid.fbDiv=n('<div style="position:absolute;'+(t.p.direction==="rtl"?"right:0;":"left:0;")+"top:"+(parseInt(u,10)+parseInt(h,10)+1)+'px;overflow-y:hidden" class="frozen-bdiv ui-jqgrid-bdiv"><\/div>');n("#gview_"+n.jgrid.jqID(t.p.id)).append(t.grid.fhDiv);f=n(".ui-jqgrid-htable","#gview_"+n.jgrid.jqID(t.p.id)).clone(!0);t.p.groupHeader?(n("tr.jqg-first-row-header, tr.jqg-third-row-header",f).each(function(){n("th:gt("+i+")",this).remove()}),o=-1,s=-1,n("tr.jqg-second-row-header th",f).each(function(){return l=parseInt(n(this).attr("colspan"),10),y=parseInt(n(this).attr("rowspan"),10),y&&(o++,s++),l&&(o=o+l,s++),o===i?(s=i,!1):void 0}),o!==i&&(s=i),n("tr.jqg-second-row-header",f).each(function(){n("th:gt("+s+")",this).remove()})):n("tr",f).each(function(){n("th:gt("+i+")",this).remove()});n(f).width(1);n.jgrid.msie()||n(f).css("height","100%");n(t.grid.fhDiv).append(f).mousemove(function(n){if(t.grid.resizing)return t.grid.dragMove(n),!1});t.p.footerrow&&(p=n(".ui-jqgrid-bdiv","#gview_"+n.jgrid.jqID(t.p.id)).height(),t.grid.fsDiv=n('<div style="position:absolute;left:0px;top:'+(parseInt(u,10)+parseInt(h,10)+parseInt(p,10)+1)+'px;" class="frozen-sdiv ui-jqgrid-sdiv"><\/div>'),n("#gview_"+n.jgrid.jqID(t.p.id)).append(t.grid.fsDiv),c=n(".ui-jqgrid-ftable","#gview_"+n.jgrid.jqID(t.p.id)).clone(!0),n("tr",c).each(function(){n("td:gt("+i+")",this).remove()}),n(c).width(1),n(t.grid.fsDiv).append(c));n(t).on("jqGridResizeStop.setFrozenColumns",function(i,r,u){var o=n(".ui-jqgrid-htable",t.grid.fhDiv),f,e;n("th:eq("+u+")",o).width(r);f=n(".ui-jqgrid-btable",t.grid.fbDiv);n("tr:first td:eq("+u+")",f).width(r);t.p.footerrow&&(e=n(".ui-jqgrid-ftable",t.grid.fsDiv),n("tr:first td:eq("+u+")",e).width(r))});n("#gview_"+n.jgrid.jqID(t.p.id)).append(t.grid.fbDiv);n(t.grid.fbDiv).on("mousewheel DOMMouseScroll",function(i){var r=n(t.grid.bDiv).scrollTop();i.originalEvent.wheelDelta>0||i.originalEvent.detail<0?n(t.grid.bDiv).scrollTop(r-25):n(t.grid.bDiv).scrollTop(r+25);i.preventDefault()});t.p.hoverrows===!0&&n("#"+n.jgrid.jqID(t.p.id)).off("mouseover mouseout");n(t).on("jqGridAfterGridComplete.setFrozenColumns",function(){var f,u;n("#"+n.jgrid.jqID(t.p.id)+"_frozen").remove();n(t.grid.fbDiv).height(n(t.grid.bDiv).height()-14);f=[];n("#"+n.jgrid.jqID(t.p.id)+" tr[role=row].jqgrow").each(function(){f.push(n("td:visible:first",this).height())});u=n("#"+n.jgrid.jqID(t.p.id)).clone(!0);n("tr[role=row]",u).each(function(){n("td[role=gridcell]:gt("+i+")",this).remove()});n(u).width(1).attr("id",t.p.id+"_frozen");n(t.grid.fbDiv).append(u);n("tr[role=row].jqgrow",u).each(function(t){n("td:not(.jqgrid-rownum):visible:first",this).height(f[t])});t.p.hoverrows===!0&&(n("tr.jqgrow",u).hover(function(){n(this).addClass(r);n("#"+n.jgrid.jqID(this.id),"#"+n.jgrid.jqID(t.p.id)).addClass(r)},function(){n(this).removeClass(r);n("#"+n.jgrid.jqID(this.id),"#"+n.jgrid.jqID(t.p.id)).removeClass(r)}),n("tr.jqgrow","#"+n.jgrid.jqID(t.p.id)).hover(function(){n(this).addClass(r);n("#"+n.jgrid.jqID(this.id),"#"+n.jgrid.jqID(t.p.id)+"_frozen").addClass(r)},function(){n(this).removeClass(r);n("#"+n.jgrid.jqID(this.id),"#"+n.jgrid.jqID(t.p.id)+"_frozen").removeClass(r)}));u=null});t.grid.hDiv.loading||n(t).triggerHandler("jqGridAfterGridComplete");t.p.frozenColumns=!0}}}})},destroyFrozenColumns:function(){return this.each(function(){var t,r,i;if(this.grid&&this.p.frozenColumns===!0){if(t=this,r=n(t).jqGrid("getStyleUI",t.p.styleUI+".common","hover",!0),n(t.grid.fhDiv).remove(),n(t.grid.fbDiv).remove(),t.grid.fhDiv=null,t.grid.fbDiv=null,t.p.footerrow&&(n(t.grid.fsDiv).remove(),t.grid.fsDiv=null),n(this).off(".setFrozenColumns"),t.p.hoverrows===!0)n("#"+n.jgrid.jqID(t.p.id)).on({mouseover:function(t){i=n(t.target).closest("tr.jqgrow");n(i).attr("class")!=="ui-subgrid"&&n(i).addClass(r)},mouseout:function(t){i=n(t.target).closest("tr.jqgrow");n(i).removeClass(r)}});this.p.frozenColumns=!1}})},resizeColumn:function(n,t){return this.each(function(){var u=this.grid,i=this.p,f=i.colModel,r,o=f.length,e,s;if(typeof n=="string"){for(r=0;r<o;r++)if(f[r].name===n){n=r;break}}else n=parseInt(n,10);if((t=parseInt(t,10),typeof n=="number"&&!(n<0)&&!(n>f.length-1)&&typeof t=="number")&&!(t<i.minColWidth)){if(i.forceFit)for(i.nv=0,r=n+1;r<o;r++)if(f[r].hidden!==!0){i.nv=r-n;break}if(u.resizing={idx:n},e=t-u.headers[n].width,i.forceFit){if(s=u.headers[n+i.nv].width-e,s<i.minColWidth)return;u.headers[n+i.nv].newWidth=u.headers[n+i.nv].width-e}u.newWidth=i.tblwidth+e;u.headers[n].newWidth=t;u.dragEnd(!1)}})},getStyleUI:function(t,i,r,u){var f="",e="",o;try{o=t.split(".");r||(f="class=",e='"');u==null&&(u="");switch(o.length){case 1:f+=e+n.trim(u+" "+n.jgrid.styleUI[o[0]][i]+e);break;case 2:f+=e+n.trim(u+" "+n.jgrid.styleUI[o[0]][o[1]][i]+e)}}catch(s){f=""}return f},resizeGrid:function(t){return this.each(function(){var i=this;t===undefined&&(t=500);setTimeout(function(){try{var t=n(window).width(),r=n("#gbox_"+n.jgrid.jqID(i.p.id)).parent().width(),u=i.p.width;u=t-r>3?r:t;n("#"+n.jgrid.jqID(i.p.id)).jqGrid("setGridWidth",u)}catch(f){}},t)})}});n.jgrid.extend({editCell:function(t,i,r){return this.each(function(){var u=this,e,f,o,s,c=n(this).jqGrid("getStyleUI",u.p.styleUI+".common","highlight",!0),l=n(this).jqGrid("getStyleUI",u.p.styleUI+".common","hover",!0),y=n(this).jqGrid("getStyleUI",u.p.styleUI+".celledit","inputClass",!0),a,v,h;if(u.grid&&u.p.cellEdit===!0){if(i=parseInt(i,10),u.p.selrow=u.rows[t].id,u.p.knv||n(u).jqGrid("GridNav"),u.p.savedRow.length>0){if(r===!0&&t==u.p.iRow&&i==u.p.iCol)return;n(u).jqGrid("saveCell",u.p.savedRow[0].id,u.p.savedRow[0].ic)}else window.setTimeout(function(){n("#"+n.jgrid.jqID(u.p.knv)).attr("tabindex","-1").focus()},1);if(s=u.p.colModel[i],e=s.name,e!=="subgrid"&&e!=="cb"&&e!=="rn"){try{o=n(u.rows[t].cells[i])}catch(p){o=n("td:eq("+i+")",u.rows[t])}if(s.editable!==!0||r!==!0||o.hasClass("not-editable-cell")||n.isFunction(u.p.isCellEditable)&&!u.p.isCellEditable.call(u,e,t,i))parseInt(u.p.iCol,10)>=0&&parseInt(u.p.iRow,10)>=0&&n(u.rows[u.p.iRow]).removeClass("selected-row "+l).find("td:eq("+u.p.iCol+")").removeClass("edit-cell "+c),o.addClass("edit-cell "+c),n(u.rows[t]).addClass("selected-row "+l),f=o.html().replace(/\&#160\;/ig,""),n(u).triggerHandler("jqGridSelectCell",[u.rows[t].id,e,f,t,i]),n.isFunction(u.p.onSelectCell)&&u.p.onSelectCell.call(u,u.rows[t].id,e,f,t,i);else{parseInt(u.p.iCol,10)>=0&&parseInt(u.p.iRow,10)>=0&&n(u.rows[u.p.iRow]).removeClass("selected-row "+l).find("td:eq("+u.p.iCol+")").removeClass("edit-cell "+c);o.addClass("edit-cell "+c);n(u.rows[t]).addClass("selected-row "+l);try{f=n.unformat.call(u,o,{rowId:u.rows[t].id,colModel:s},i)}catch(w){f=s.edittype&&s.edittype==="textarea"?o.text():o.html()}u.p.autoencode&&(f=n.jgrid.htmlDecode(f));s.edittype||(s.edittype="text");u.p.savedRow.push({id:t,ic:i,name:e,v:f});(f==="&nbsp;"||f==="&#160;"||f.length===1&&f.charCodeAt(0)===160)&&(f="");n.isFunction(u.p.formatCell)&&(a=u.p.formatCell.call(u,u.rows[t].id,e,f,t,i),a!==undefined&&(f=a));n(u).triggerHandler("jqGridBeforeEditCell",[u.rows[t].id,e,f,t,i]);n.isFunction(u.p.beforeEditCell)&&u.p.beforeEditCell.call(u,u.rows[t].id,e,f,t,i);v=n.extend({},s.editoptions||{},{id:t+"_"+e,name:e,rowId:u.rows[t].id,oper:"edit"});h=n.jgrid.createEl.call(u,s.edittype,v,f,!0,n.extend({},n.jgrid.ajaxOptions,u.p.ajaxSelectOptions||{}));n.inArray(s.edittype,["text","textarea","password","select"])>-1&&n(h).addClass(y);o.html("").append(h).attr("tabindex","0");n.jgrid.bindEv.call(u,h,v);window.setTimeout(function(){n(h).focus()},1);n("input, select, textarea",o).on("keydown",function(r){if(r.keyCode===27&&(n("input.hasDatepicker",o).length>0?n(".ui-datepicker").is(":hidden")?n(u).jqGrid("restoreCell",t,i):n("input.hasDatepicker",o).datepicker("hide"):n(u).jqGrid("restoreCell",t,i)),r.keyCode===13&&!r.shiftKey)return n(u).jqGrid("saveCell",t,i),!1;if(r.keyCode===9){if(u.grid.hDiv.loading)return!1;r.shiftKey?n(u).jqGrid("prevCell",t,i):n(u).jqGrid("nextCell",t,i)}r.stopPropagation()});n(u).triggerHandler("jqGridAfterEditCell",[u.rows[t].id,e,f,t,i]);n.isFunction(u.p.afterEditCell)&&u.p.afterEditCell.call(u,u.rows[t].id,e,f,t,i)}u.p.iCol=i;u.p.iRow=t}}})},saveCell:function(t,i){return this.each(function(){var r=this,g,l=n.jgrid.getRegional(this,"errors"),h=n.jgrid.getRegional(this,"edit"),nt,tt,w,b,k,y,rt,p,s,ut,ft,d;if(r.grid&&r.p.cellEdit===!0){if(g=r.p.savedRow.length>=1?0:null,g!==null){var a=n("td:eq("+i+")",r.rows[t]),u,e,o=r.p.colModel[i],f=o.name,c=n.jgrid.jqID(f),v=n(a).offset();switch(o.edittype){case"select":o.editoptions.multiple?(nt=n("#"+t+"_"+c,r.rows[t]),tt=[],u=n(nt).val(),u?u.join(","):u="",n("option:selected",nt).each(function(t,i){tt[t]=n(i).text()}),e=tt.join(",")):(u=n("#"+t+"_"+c+" option:selected",r.rows[t]).val(),e=n("#"+t+"_"+c+" option:selected",r.rows[t]).text());o.formatter&&(e=u);break;case"checkbox":w=["Yes","No"];o.editoptions&&(w=o.editoptions.value.split(":"));u=n("#"+t+"_"+c,r.rows[t]).is(":checked")?w[0]:w[1];e=u;break;case"password":case"text":case"textarea":case"button":u=n("#"+t+"_"+c,r.rows[t]).val();e=u;break;case"custom":try{if(o.editoptions&&n.isFunction(o.editoptions.custom_value))if(u=o.editoptions.custom_value.call(r,n(".customelement",a),"get"),u===undefined)throw"e2";else e=u;else throw"e1";}catch(it){it==="e1"?n.jgrid.info_dialog(l.errcap,"function 'custom_value' "+h.msg.nodefined,h.bClose,{styleUI:r.p.styleUI}):it==="e2"?n.jgrid.info_dialog(l.errcap,"function 'custom_value' "+h.msg.novalue,h.bClose,{styleUI:r.p.styleUI}):n.jgrid.info_dialog(l.errcap,it.message,h.bClose,{styleUI:r.p.styleUI})}}if(e!==r.p.savedRow[g].v)if(b=n(r).triggerHandler("jqGridBeforeSaveCell",[r.rows[t].id,f,u,t,i]),b&&(u=b,e=b),n.isFunction(r.p.beforeSaveCell)&&(k=r.p.beforeSaveCell.call(r,r.rows[t].id,f,u,t,i),k&&(u=k,e=k)),y=n.jgrid.checkValues.call(r,u,i),rt=!1,y[0]===!0){if(p=n(r).triggerHandler("jqGridBeforeSubmitCell",[r.rows[t].id,f,u,t,i])||{},n.isFunction(r.p.beforeSubmitCell)&&(p=r.p.beforeSubmitCell.call(r,r.rows[t].id,f,u,t,i),p||(p={})),n("input.hasDatepicker",a).length>0&&n("input.hasDatepicker",a).datepicker("hide"),r.p.cellsubmit==="remote")if(r.p.cellurl)s={},r.p.autoencode&&(u=n.jgrid.htmlEncode(u)),o.editoptions&&o.editoptions.NullIfEmpty&&u===""&&(u="null",rt=!0),s[f]=u,d=r.p.prmNames,ut=d.id,ft=d.oper,s[ut]=n.jgrid.stripPref(r.p.idPrefix,r.rows[t].id),s[ft]=d.editoper,s=n.extend(p,s),n(r).jqGrid("progressBar",{method:"show",loadtype:r.p.loadui,htmlcontent:n.jgrid.getRegional(r,"defaults.savetext")}),r.grid.hDiv.loading=!0,n.ajax(n.extend({url:r.p.cellurl,data:n.isFunction(r.p.serializeCellData)?r.p.serializeCellData.call(r,s,f):s,type:"POST",complete:function(o,y){if(n(r).jqGrid("progressBar",{method:"hide",loadtype:r.p.loadui}),r.grid.hDiv.loading=!1,y==="success"){var p=n(r).triggerHandler("jqGridAfterSubmitCell",[r,o,s.id,f,u,t,i])||[!0,""];p[0]===!0&&n.isFunction(r.p.afterSubmitCell)&&(p=r.p.afterSubmitCell.call(r,o,s.id,f,u,t,i));p[0]===!0?(rt&&(u=""),n(a).empty(),n(r).jqGrid("setCell",r.rows[t].id,i,e,!1,!1,!0),n(a).addClass("dirty-cell"),n(r.rows[t]).addClass("edited"),n(r).triggerHandler("jqGridAfterSaveCell",[r.rows[t].id,f,u,t,i]),n.isFunction(r.p.afterSaveCell)&&r.p.afterSaveCell.call(r,r.rows[t].id,f,u,t,i),r.p.savedRow.splice(0,1)):(n.isFunction(r.p.errorCell)?r.p.errorCell.call(r,o,y):n.jgrid.info_dialog(l.errcap,p[1],h.bClose,{styleUI:r.p.styleUI,top:v.top+30,left:v.left,onClose:function(){r.p.restoreCellonFail||n("#"+t+"_"+c,r.rows[t]).focus()}}),r.p.restoreCellonFail&&n(r).jqGrid("restoreCell",t,i))}},error:function(u,f,e){n("#lui_"+n.jgrid.jqID(r.p.id)).hide();r.grid.hDiv.loading=!1;n(r).triggerHandler("jqGridErrorCell",[u,f,e]);n.isFunction(r.p.errorCell)?r.p.errorCell.call(r,u,f,e):n.jgrid.info_dialog(l.errcap,u.status+" : "+u.statusText+"<br/>"+f,h.bClose,{styleUI:r.p.styleUI,top:v.top+30,left:v.left,onClose:function(){r.p.restoreCellonFail||n("#"+t+"_"+c,r.rows[t]).focus()}});r.p.restoreCellonFail&&n(r).jqGrid("restoreCell",t,i)}},n.jgrid.ajaxOptions,r.p.ajaxCellOptions||{}));else try{n.jgrid.info_dialog(l.errcap,l.nourl,h.bClose,{styleUI:r.p.styleUI});r.p.restoreCellonFail&&n(r).jqGrid("restoreCell",t,i)}catch(it){}r.p.cellsubmit==="clientArray"&&(n(a).empty(),n(r).jqGrid("setCell",r.rows[t].id,i,e,!1,!1,!0),n(a).addClass("dirty-cell"),n(r.rows[t]).addClass("edited"),n(r).triggerHandler("jqGridAfterSaveCell",[r.rows[t].id,f,u,t,i]),n.isFunction(r.p.afterSaveCell)&&r.p.afterSaveCell.call(r,r.rows[t].id,f,u,t,i),r.p.savedRow.splice(0,1))}else try{n.isFunction(r.p.validationCell)?r.p.validationCell.call(r,n("#"+t+"_"+c,r.rows[t]),y[1],t,i):(window.setTimeout(function(){n.jgrid.info_dialog(l.errcap,u+" "+y[1],h.bClose,{styleUI:r.p.styleUI,top:v.top+30,left:v.left,onClose:function(){r.p.restoreCellonFail||n("#"+t+"_"+c,r.rows[t]).focus()}})},50),r.p.restoreCellonFail&&n(r).jqGrid("restoreCell",t,i))}catch(it){alert(y[1])}else n(r).jqGrid("restoreCell",t,i)}window.setTimeout(function(){n("#"+n.jgrid.jqID(r.p.knv)).attr("tabindex","-1").focus()},0)}})},restoreCell:function(t,i){return this.each(function(){var r=this,u,f;if(r.grid&&r.p.cellEdit===!0){if(u=r.p.savedRow.length>=1?0:null,u!==null){if(f=n("td:eq("+i+")",r.rows[t]),n.isFunction(n.fn.datepicker))try{n("input.hasDatepicker",f).datepicker("hide")}catch(e){}n(f).empty().attr("tabindex","-1");n(r).jqGrid("setCell",r.rows[t].id,i,r.p.savedRow[u].v,!1,!1,!0);n(r).triggerHandler("jqGridAfterRestoreCell",[r.rows[t].id,r.p.savedRow[u].v,t,i]);n.isFunction(r.p.afterRestoreCell)&&r.p.afterRestoreCell.call(r,r.rows[t].id,r.p.savedRow[u].v,t,i);r.p.savedRow.splice(0,1)}window.setTimeout(function(){n("#"+r.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(t,i){return this.each(function(){var r=this,f=!1,u;if(r.grid&&r.p.cellEdit===!0){for(u=i+1;u<r.p.colModel.length;u++)if(r.p.colModel[u].editable===!0&&(!n.isFunction(r.p.isCellEditable)||r.p.isCellEditable.call(r,r.p.colModel[u].name,t,u))){f=u;break}f!==!1?n(r).jqGrid("editCell",t,f,!0):r.p.savedRow.length>0&&n(r).jqGrid("saveCell",t,i)}})},prevCell:function(t,i){return this.each(function(){var r=this,f=!1,u;if(r.grid&&r.p.cellEdit===!0){for(u=i-1;u>=0;u--)if(r.p.colModel[u].editable===!0&&(!n.isFunction(r.p.isCellEditable)||r.p.isCellEditable.call(r,r.p.colModel[u].name,t,u))){f=u;break}f!==!1?n(r).jqGrid("editCell",t,f,!0):r.p.savedRow.length>0&&n(r).jqGrid("saveCell",t,i)}})},GridNav:function(){return this.each(function(){function u(i,r,u){if(u.substr(0,1)==="v"){var e=n(t.grid.bDiv)[0].clientHeight,o=n(t.grid.bDiv)[0].scrollTop,s=t.rows[i].offsetTop+t.rows[i].clientHeight,h=t.rows[i].offsetTop;u==="vd"&&s>=e&&(n(t.grid.bDiv)[0].scrollTop=n(t.grid.bDiv)[0].scrollTop+t.rows[i].clientHeight);u==="vu"&&h<o&&(n(t.grid.bDiv)[0].scrollTop=n(t.grid.bDiv)[0].scrollTop-t.rows[i].clientHeight)}if(u==="h"){var c=n(t.grid.bDiv)[0].clientWidth,f=n(t.grid.bDiv)[0].scrollLeft,l=t.rows[i].cells[r].offsetLeft+t.rows[i].cells[r].clientWidth,a=t.rows[i].cells[r].offsetLeft;l>=c+parseInt(f,10)?n(t.grid.bDiv)[0].scrollLeft=n(t.grid.bDiv)[0].scrollLeft+t.rows[i].cells[r].clientWidth:a<f&&(n(t.grid.bDiv)[0].scrollLeft=n(t.grid.bDiv)[0].scrollLeft-t.rows[i].cells[r].clientWidth)}}function e(n,i){var u,r;if(i==="lft")for(u=n+1,r=n;r>=0;r--)if(t.p.colModel[r].hidden!==!0){u=r;break}if(i==="rgt")for(u=n-1,r=n;r<t.p.colModel.length;r++)if(t.p.colModel[r].hidden!==!0){u=r;break}return u}var t=this,f,i,r;t.grid&&t.p.cellEdit===!0&&(t.p.knv=t.p.id+"_kn",f=n("<div style='position:fixed;top:0px;width:1px;height:1px;' tabindex='0'><div tabindex='-1' style='width:1px;height:1px;' id='"+t.p.knv+"'><\/div><\/div>"),n(f).insertBefore(t.grid.cDiv),n("#"+t.p.knv).focus().keydown(function(f){r=f.keyCode;t.p.direction==="rtl"&&(r===37?r=39:r===39&&(r=37));switch(r){case 38:t.p.iRow-1>0&&(u(t.p.iRow-1,t.p.iCol,"vu"),n(t).jqGrid("editCell",t.p.iRow-1,t.p.iCol,!1));break;case 40:t.p.iRow+1<=t.rows.length-1&&(u(t.p.iRow+1,t.p.iCol,"vd"),n(t).jqGrid("editCell",t.p.iRow+1,t.p.iCol,!1));break;case 37:t.p.iCol-1>=0&&(i=e(t.p.iCol-1,"lft"),u(t.p.iRow,i,"h"),n(t).jqGrid("editCell",t.p.iRow,i,!1));break;case 39:t.p.iCol+1<=t.p.colModel.length-1&&(i=e(t.p.iCol+1,"rgt"),u(t.p.iRow,i,"h"),n(t).jqGrid("editCell",t.p.iRow,i,!1));break;case 13:parseInt(t.p.iCol,10)>=0&&parseInt(t.p.iRow,10)>=0&&n(t).jqGrid("editCell",t.p.iRow,t.p.iCol,!0);break;default:return!0}return!1}))})},getChangedCells:function(t){var i=[];return t||(t="all"),this.each(function(){var r=this,u;r.grid&&r.p.cellEdit===!0&&n(r.rows).each(function(f){var e={};n(this).hasClass("edited")&&(n("td",this).each(function(i){if(u=r.p.colModel[i].name,u!=="cb"&&u!=="subgrid")if(t==="dirty"){if(n(this).hasClass("dirty-cell"))try{e[u]=n.unformat.call(r,this,{rowId:r.rows[f].id,colModel:r.p.colModel[i]},i)}catch(o){e[u]=n.jgrid.htmlDecode(n(this).html())}}else try{e[u]=n.unformat.call(r,this,{rowId:r.rows[f].id,colModel:r.p.colModel[i]},i)}catch(o){e[u]=n.jgrid.htmlDecode(n(this).html())}}),e.id=this.id,i.push(e))})}),i}});n.extend(n.jgrid,{showModal:function(n){n.w.show()},closeModal:function(n){n.w.hide().attr("aria-hidden","true");n.o&&n.o.remove()},hideModal:function(t,i){var r,o,u,f,e,s;if(i=n.extend({jqm:!0,gb:"",removemodal:!1,formprop:!1,form:""},i||{}),r=i.gb&&typeof i.gb=="string"&&i.gb.substr(0,6)==="#gbox_"?n("#"+i.gb.substr(6))[0]:!1,!i.onClose||(o=r?i.onClose.call(r,t):i.onClose(t),typeof o!="boolean"||o)){if(i.formprop&&r&&i.form&&(u=n(t)[0].style.height,f=n(t)[0].style.width,u.indexOf("px")>-1&&(u=parseFloat(u)),f.indexOf("px")>-1&&(f=parseFloat(f)),i.form==="edit"?(e="#"+n.jgrid.jqID("FrmGrid_"+i.gb.substr(6)),s="formProp"):i.form==="view"&&(e="#"+n.jgrid.jqID("ViewGrid_"+i.gb.substr(6)),s="viewProp"),n(r).data(s,{top:parseFloat(n(t).css("top")),left:parseFloat(n(t).css("left")),width:f,height:u,dataheight:n(e).height(),datawidth:n(e).width()})),n.fn.jqm&&i.jqm===!0)n(t).attr("aria-hidden","true").jqmHide();else{if(i.gb!=="")try{n(".jqgrid-overlay:first",i.gb).hide()}catch(h){}n(t).hide().attr("aria-hidden","true")}i.removemodal&&n(t).remove()}},findPos:function(t){var i=n(t).offset();return[i.left,i.top]},createModal:function(t,i,r,u,f,e,o){var h,v,y,c,p,w,b;r=n.extend(!0,{},n.jgrid.jqModal||{},r);var k=this,d=n(r.gbox).attr("dir")==="rtl"?!0:!1,l=n.jgrid.styleUI[r.styleUI||"jQueryUI"].modal,a=n.jgrid.styleUI[r.styleUI||"jQueryUI"].common,s=document.createElement("div");if(o=n.extend({},o||{}),s.className="ui-jqdialog "+l.modal,s.id=t.themodal,h=document.createElement("div"),h.className="ui-jqdialog-titlebar "+l.header,h.id=t.modalhead,n(h).append("<span class='ui-jqdialog-title'>"+r.caption+"<\/span>"),v=n("<a class='ui-jqdialog-titlebar-close "+a.cornerall+"'><\/a>").hover(function(){v.addClass(a.hover)},function(){v.removeClass(a.hover)}).append("<span class='"+a.icon_base+" "+l.icon_close+"'><\/span>"),n(h).append(v),d?(s.dir="rtl",n(".ui-jqdialog-title",h).css("float","right"),n(".ui-jqdialog-titlebar-close",h).css("left",.3+"em")):(s.dir="ltr",n(".ui-jqdialog-title",h).css("float","left"),n(".ui-jqdialog-titlebar-close",h).css("right",.3+"em")),y=document.createElement("div"),n(y).addClass("ui-jqdialog-content "+l.content).attr("id",t.modalcontent),n(y).append(i),s.appendChild(y),n(s).prepend(h),e===!0?n("body").append(s):typeof e=="string"?n(e).append(s):n(s).insertBefore(u),n(s).css(o),r.jqModal===undefined&&(r.jqModal=!0),c={},n.fn.jqm&&r.jqModal===!0?(r.left===0&&r.top===0&&r.overlay&&(p=[],p=n.jgrid.findPos(f),r.left=p[0]+4,r.top=p[1]+4),c.top=r.top+"px",c.left=r.left):(r.left!==0||r.top!==0)&&(c.left=r.left,c.top=r.top+"px"),n("a.ui-jqdialog-titlebar-close",h).click(function(){var i=n("#"+n.jgrid.jqID(t.themodal)).data("onClose")||r.onClose,u=n("#"+n.jgrid.jqID(t.themodal)).data("gbox")||r.gbox;return k.hideModal("#"+n.jgrid.jqID(t.themodal),{gb:u,jqm:r.jqModal,onClose:i,removemodal:r.removemodal||!1,formprop:!r.recreateForm||!1,form:r.form||""}),!1}),r.width!==0&&r.width||(r.width=300),r.height!==0&&r.height||(r.height=200),r.zIndex||(w=n(u).parents("*[role=dialog]").filter(":first").css("z-index"),r.zIndex=w?parseInt(w,10)+2:950),b=0,d&&c.left&&!e&&(b=n(r.gbox).width()-(isNaN(r.width)?0:parseInt(r.width,10))-8,c.left=parseInt(c.left,10)+parseInt(b,10)),c.left&&(c.left+="px"),n(s).css(n.extend({width:isNaN(r.width)?"auto":r.width+"px",height:isNaN(r.height)?"auto":r.height+"px",zIndex:r.zIndex,overflow:"hidden"},c)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":t.modalhead,"aria-hidden":"true"}),r.drag===undefined&&(r.drag=!0),r.resize===undefined&&(r.resize=!0),r.drag)if(n(h).css("cursor","move"),n.fn.tinyDraggable)n(s).tinyDraggable({handle:"#"+n.jgrid.jqID(h.id)});else try{n(s).draggable({handle:n("#"+n.jgrid.jqID(h.id))})}catch(g){}if(r.resize)if(n.fn.jqResize)n(s).append("<div class='jqResize "+l.resizable+" "+a.icon_base+" "+l.icon_resizable+"'><\/div>"),n("#"+n.jgrid.jqID(t.themodal)).jqResize(".jqResize",t.scrollelm?"#"+n.jgrid.jqID(t.scrollelm):!1);else try{n(s).resizable({handles:"se, sw",alsoResize:t.scrollelm?"#"+n.jgrid.jqID(t.scrollelm):!1})}catch(nt){}r.closeOnEscape===!0&&n(s).keydown(function(i){if(i.which===27){var u=n("#"+n.jgrid.jqID(t.themodal)).data("onClose")||r.onClose;k.hideModal("#"+n.jgrid.jqID(t.themodal),{gb:r.gbox,jqm:r.jqModal,onClose:u,removemodal:r.removemodal||!1,formprop:!r.recreateForm||!1,form:r.form||""})}})},viewModal:function(t,i){if(i=n.extend({toTop:!0,overlay:10,modal:!1,overlayClass:"ui-widget-overlay",onShow:n.jgrid.showModal,onHide:n.jgrid.closeModal,gbox:"",jqm:!0,jqM:!0},i||{}),i.focusField===undefined&&(i.focusField=0),i.focusField=typeof i.focusField=="number"&&i.focusField>=0?parseInt(i.focusField,10):typeof i.focusField!="boolean"||i.focusField?0:!1,n.fn.jqm&&i.jqm===!0)i.jqM?n(t).attr("aria-hidden","false").jqm(i).jqmShow():n(t).attr("aria-hidden","false").jqmShow();else if(i.gbox!==""&&(n(".jqgrid-overlay:first",i.gbox).show(),n(t).data("gbox",i.gbox)),n(t).show().attr("aria-hidden","false"),i.focusField>=0)try{n(":input:visible",t)[parseInt(i.focusField,10)].focus()}catch(r){}},info_dialog:function(t,i,r,u){var f={width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1060,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]},o,e;n.extend(!0,f,n.jgrid.jqModal||{},{caption:"<b>"+t+"<\/b>"},u||{});var s=f.jqModal,a=this,l=n.jgrid.styleUI[f.styleUI||"jQueryUI"].modal,h=n.jgrid.styleUI[f.styleUI||"jQueryUI"].common;if(n.fn.jqm&&!s&&(s=!1),o="",f.buttons.length>0)for(e=0;e<f.buttons.length;e++)f.buttons[e].id===undefined&&(f.buttons[e].id="info_button_"+e),o+="<a id='"+f.buttons[e].id+"' class='fm-button "+h.button+"'>"+f.buttons[e].text+"<\/a>";var v=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px",y="text-align:"+f.align+";",c="<div id='info_id'>";c+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+v+";"+y+"'>"+i+"<\/div>";c+=r?"<div class='"+l.content+"' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a id='closedialog' class='fm-button "+h.button+"'>"+r+"<\/a>"+o+"<\/div>":o!==""?"<div class='"+l.content+"' style='text-align:"+f.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+o+"<\/div>":"";c+="<\/div>";try{n("#info_dialog").attr("aria-hidden")==="false"&&n.jgrid.hideModal("#info_dialog",{jqm:s});n("#info_dialog").remove()}catch(p){}n.jgrid.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},c,f,"","",!0);o&&n.each(f.buttons,function(t){n("#"+n.jgrid.jqID(this.id),"#info_id").on("click",function(){return f.buttons[t].onClick.call(n("#info_dialog")),!1})});n("#closedialog","#info_id").on("click",function(){return a.hideModal("#info_dialog",{jqm:s,onClose:n("#info_dialog").data("onClose")||f.onClose,gb:n("#info_dialog").data("gbox")||f.gbox}),!1});n(".fm-button","#info_dialog").hover(function(){n(this).addClass(h.hover)},function(){n(this).removeClass(h.hover)});n.isFunction(f.beforeOpen)&&f.beforeOpen();n.jgrid.viewModal("#info_dialog",{onHide:function(n){n.w.hide().remove();n.o&&n.o.remove()},modal:f.modal,jqm:s});n.isFunction(f.afterOpen)&&f.afterOpen();try{n("#info_dialog").focus()}catch(w){}},bindEv:function(t,i){var r=this;n.isFunction(i.dataInit)&&i.dataInit.call(r,t,i);i.dataEvents&&n.each(i.dataEvents,function(){if(this.data!==undefined)n(t).on(this.type,this.data,this.fn);else n(t).on(this.type,this.fn)})},createEl:function(t,i,r,u,f){function p(t,i,r){var u=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr","custom_element","custom_value","oper"];r!==undefined&&n.isArray(r)&&n.merge(u,r);n.each(i,function(i,r){n.inArray(i,u)===-1&&n(t).attr(i,r)});i.hasOwnProperty("id")||n(t).attr("id",n.jgrid.randId())}var e="",s=this,rt,nt,l,a,w,k,v,ut,y,o,c,h,tt,ft,et,ot,g,it,b,st;t===undefined&&(t="text");switch(t){case"textarea":e=document.createElement("textarea");u?i.cols||n(e).css({width:"98%"}):i.cols||(i.cols=20);i.rows||(i.rows=2);(r==="&nbsp;"||r==="&#160;"||r.length===1&&r.charCodeAt(0)===160)&&(r="");e.value=r;p(e,i);n(e).attr({role:"textbox",multiline:"true"});break;case"checkbox":e=document.createElement("input");e.type="checkbox";i.value?(nt=i.value.split(":"),r===nt[0]&&(e.checked=!0,e.defaultChecked=!0),e.value=nt[0],n(e).attr("offval",nt[1])):(rt=(r+"").toLowerCase(),rt.search(/(false|f|0|no|n|off|undefined)/i)<0&&rt!==""?(e.checked=!0,e.defaultChecked=!0,e.value=r):e.value="on",n(e).attr("offval","off"));p(e,i,["value"]);n(e).attr("role","checkbox");break;case"select":if(e=document.createElement("select"),e.setAttribute("role","select"),a=[],i.multiple===!0?(l=!0,e.multiple="multiple",n(e).attr("aria-multiselectable","true")):l=!1,i.dataUrl!=null){w=null;k=i.postData||f.postData;try{w=i.rowId}catch(d){}s.p&&s.p.idPrefix&&(w=n.jgrid.stripPref(s.p.idPrefix,w));n.ajax(n.extend({url:n.isFunction(i.dataUrl)?i.dataUrl.call(s,w,r,String(i.name)):i.dataUrl,type:"GET",dataType:"html",data:n.isFunction(k)?k.call(s,w,r,String(i.name)):k,context:{elem:e,options:i,vl:r},success:function(t){var r=[],u=this.elem,f=this.vl,i=n.extend({},this.options),c=i.multiple===!0,l=i.cacheUrlData===!0,o="",h,e=n.isFunction(i.buildSelect)?i.buildSelect.call(s,t):t,a,v;typeof e=="string"&&(e=n(n.trim(e)).html());e&&(n(u).append(e),p(u,i,k?["postData"]:undefined),i.size===undefined&&(i.size=c?3:1),c?(r=f.split(","),r=n.map(r,function(t){return n.trim(t)})):r[0]=n.trim(f),n("option",u).each(function(t){h=n(this).text();f=n(this).val();l&&(o+=(t!==0?";":"")+f+":"+h);t===0&&u.multiple&&(this.selected=!1);n(this).attr("role","option");(n.inArray(n.trim(h),r)>-1||n.inArray(n.trim(f),r)>-1)&&(this.selected="selected")}),l&&(i.oper==="edit"?n(s).jqGrid("setColProp",i.name,{editoptions:{buildSelect:null,dataUrl:null,value:o}}):i.oper==="search"?n(s).jqGrid("setColProp",i.name,{searchoptions:{dataUrl:null,value:o}}):i.oper==="filter"&&n("#fbox_"+s.p.id)[0].p&&(a=n("#fbox_"+s.p.id)[0].p.columns,n.each(a,function(){return v=this.index||this.name,i.name===v?(this.searchoptions.dataUrl=null,this.searchoptions.value=o,!1):void 0}))),n(s).triggerHandler("jqGridAddEditAfterSelectUrlComplete",[u]))}},f||{}))}else if(i.value){if(i.size===undefined&&(i.size=l?3:1),l&&(a=r.split(","),a=n.map(a,function(t){return n.trim(t)})),typeof i.value=="function"&&(i.value=i.value()),ft=i.separator===undefined?":":i.separator,et=i.delimiter===undefined?";":i.delimiter,typeof i.value=="string")for(ut=i.value.split(et),v=0;v<ut.length;v++)y=ut[v].split(ft),y.length>2&&(y[1]=n.map(y,function(n,t){if(t>0)return n}).join(ft)),o=document.createElement("option"),o.setAttribute("role","option"),o.value=y[0],o.innerHTML=y[1],e.appendChild(o),l||n.trim(y[0])!==n.trim(r)&&n.trim(y[1])!==n.trim(r)||(o.selected="selected"),l&&(n.inArray(n.trim(y[1]),a)>-1||n.inArray(n.trim(y[0]),a)>-1)&&(o.selected="selected");else if(Object.prototype.toString.call(i.value)==="[object Array]")for(c=i.value,v=0;v<c.length;v++)c[v].length===2&&(h=c[v][0],tt=c[v][1],o=document.createElement("option"),o.setAttribute("role","option"),o.value=h,o.innerHTML=tt,e.appendChild(o),l||n.trim(h)!==n.trim(r)&&n.trim(tt)!==n.trim(r)||(o.selected="selected"),l&&(n.inArray(n.trim(tt),a)>-1||n.inArray(n.trim(h),a)>-1)&&(o.selected="selected"));else if(typeof i.value=="object"){c=i.value;for(h in c)c.hasOwnProperty(h)&&(o=document.createElement("option"),o.setAttribute("role","option"),o.value=h,o.innerHTML=c[h],e.appendChild(o),l||n.trim(h)!==n.trim(r)&&n.trim(c[h])!==n.trim(r)||(o.selected="selected"),l&&(n.inArray(n.trim(c[h]),a)>-1||n.inArray(n.trim(h),a)>-1)&&(o.selected="selected"))}p(e,i,["value"])}break;case"image":case"file":e=document.createElement("input");e.type=t;p(e,i);break;case"custom":e=document.createElement("span");try{if(n.isFunction(i.custom_element))if(ot=n(this).jqGrid("getRowData",i.rowId),g=i.custom_element.call(s,r,i,ot),g)g=n(g).addClass("customelement").attr({id:i.id,name:i.name}),n(e).empty().append(g);else throw"e2";else throw"e1";}catch(d){it=n.jgrid.getRegional(s,"errors");b=n.jgrid.getRegional(s,"edit");d==="e1"?n.jgrid.info_dialog(it.errcap,"function 'custom_element' "+b.msg.nodefined,b.bClose,{styleUI:s.p.styleUI}):d==="e2"?n.jgrid.info_dialog(it.errcap,"function 'custom_element' "+b.msg.novalue,b.bClose,{styleUI:s.p.styleUI}):n.jgrid.info_dialog(it.errcap,typeof d=="string"?d:d.message,b.bClose,{styleUI:s.p.styleUI})}break;default:st=t==="button"?"button":"textbox";e=document.createElement("input");e.type=t;e.value=r;p(e,i);t!=="button"&&(u?i.size||n(e).css({width:"96%"}):i.size||(i.size=20));n(e).attr("role",st)}return e},checkDate:function(n,t){var a=function(n){return n%4==0&&(n%100!=0||n%400==0)?29:28},i={},h,c,l,s;if(n=n.toLowerCase(),h=n.indexOf("/")!==-1?"/":n.indexOf("-")!==-1?"-":n.indexOf(".")!==-1?".":"/",n=n.split(h),t=t.split(h),t.length!==3)return!1;for(var u=-1,f,e=-1,o=-1,r=0;r<n.length;r++)c=isNaN(t[r])?0:parseInt(t[r],10),i[n[r]]=c,f=n[r],f.indexOf("y")!==-1&&(u=r),f.indexOf("m")!==-1&&(o=r),f.indexOf("d")!==-1&&(e=r);return(f=n[u]==="y"||n[u]==="yyyy"?4:n[u]==="yy"?2:-1,l=[0,31,29,31,30,31,30,31,31,30,31,30,31],u===-1)?!1:(s=i[n[u]].toString(),f===2&&s.length===1&&(f=1),s.length!==f||i[n[u]]===0&&t[u]!=="00")?!1:o===-1?!1:(s=i[n[o]].toString(),s.length<1||i[n[o]]<1||i[n[o]]>12)?!1:e===-1?!1:(s=i[n[e]].toString(),s.length<1||i[n[e]]<1||i[n[e]]>31||i[n[o]]===2&&i[n[e]]>a(i[n[u]])||i[n[e]]>l[i[n[o]]])?!1:!0},isEmpty:function(n){return n===undefined||n.match(/^\s+$/)||n===""?!0:!1},checkTime:function(t){var i;if(!n.jgrid.isEmpty(t))if(i=t.match(/^(\d{1,2}):(\d{2})([apAP][Mm])?$/),i){if(i[3]){if(i[1]<1||i[1]>12)return!1}else if(i[1]>23)return!1;if(i[2]>59)return!1}else return!1;return!0},checkValues:function(t,i,r,u){var f,h,e,l,w,a=this,s=a.p.colModel,o=n.jgrid.getRegional(this,"edit.msg"),v,c,y,p;if(r===undefined)if(typeof i=="string"){for(h=0,w=s.length;h<w;h++)if(s[h].name===i){f=s[h].editrules;i=h;s[h].formoptions!=null&&(e=s[h].formoptions.label);break}}else i>=0&&(f=s[i].editrules);else f=r,e=u===undefined?"_":u;if(f){if(e||(e=a.p.colNames!=null?a.p.colNames[i]:s[i].label),f.required===!0&&n.jgrid.isEmpty(t))return[!1,e+": "+o.required,""];if(c=f.required===!1?!1:!0,f.number===!0&&!(c===!1&&n.jgrid.isEmpty(t))&&isNaN(t))return[!1,e+": "+o.number,""];if(f.minValue!==undefined&&!isNaN(f.minValue)&&parseFloat(t)<parseFloat(f.minValue))return[!1,e+": "+o.minValue+" "+f.minValue,""];if(f.maxValue!==undefined&&!isNaN(f.maxValue)&&parseFloat(t)>parseFloat(f.maxValue))return[!1,e+": "+o.maxValue+" "+f.maxValue,""];if(f.email===!0&&!(c===!1&&n.jgrid.isEmpty(t))&&(y=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,!y.test(t)))return[!1,e+": "+o.email,""];if(f.integer===!0&&!(c===!1&&n.jgrid.isEmpty(t))){if(isNaN(t))return[!1,e+": "+o.integer,""];if(t%1!=0||t.indexOf(".")!==-1)return[!1,e+": "+o.integer,""]}if(f.date===!0&&!(c===!1&&n.jgrid.isEmpty(t))&&(s[i].formatoptions&&s[i].formatoptions.newformat?(l=s[i].formatoptions.newformat,v=n.jgrid.getRegional(a,"formatter.date.masks"),v&&v.hasOwnProperty(l)&&(l=v[l])):l=s[i].datefmt||"Y-m-d",!n.jgrid.checkDate(l,t)))return[!1,e+": "+o.date+" - "+l,""];if(f.time===!0&&!(c===!1&&n.jgrid.isEmpty(t))&&!n.jgrid.checkTime(t))return[!1,e+": "+o.date+" - hh:mm (am/pm)",""];if(f.url===!0&&!(c===!1&&n.jgrid.isEmpty(t))&&(y=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i,!y.test(t)))return[!1,e+": "+o.url,""];if(f.custom===!0&&!(c===!1&&n.jgrid.isEmpty(t)))return n.isFunction(f.custom_func)?(p=f.custom_func.call(a,t,e,i),n.isArray(p)?p:[!1,o.customarray,""]):[!1,o.customfcheck,""]}return[!0,"",""]}});n.fn.jqFilter=function(t){var r,u,i;if(typeof t=="string"){if(r=n.fn.jqFilter[t],!r)throw"jqFilter - No such method: "+t;return u=n.makeArray(arguments).slice(1),r.apply(this,u)}return i=n.extend(!0,{filter:null,columns:[],sortStrategy:null,onChange:null,afterRedraw:null,checkValues:null,error:!1,errmsg:"",errorcheck:!0,showQuery:!0,sopt:null,ops:[],operands:null,numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],strarr:["text","string","blob"],groupOps:[{op:"AND",text:"AND"},{op:"OR",text:"OR"}],groupButton:!0,ruleButtons:!0,uniqueSearchFields:!1,direction:"ltr",addsubgrup:"Add subgroup",addrule:"Add rule",delgroup:"Delete group",delrule:"Delete rule"},n.jgrid.filter,t||{}),this.each(function(){var f,e,t,o,h;if(!this.filter&&(this.p=i,(this.p.filter===null||this.p.filter===undefined)&&(this.p.filter={groupOp:this.p.groupOps[0].op,rules:[],groups:[]}),this.p.sortStrategy!=null&&n.isFunction(this.p.sortStrategy)&&this.p.columns.sort(this.p.sortStrategy),e=this.p.columns.length,o=/msie/i.test(navigator.userAgent)&&!window.opera,this.p.initFilter=n.extend(!0,{},this.p.filter),e)){for(f=0;f<e;f++)t=this.p.columns[f],t.stype?t.inputtype=t.stype:t.inputtype||(t.inputtype="text"),t.sorttype?t.searchtype=t.sorttype:t.searchtype||(t.searchtype="string"),t.hidden===undefined&&(t.hidden=!1),t.label||(t.label=t.name),t.index&&(t.name=t.index),t.hasOwnProperty("searchoptions")||(t.searchoptions={}),t.hasOwnProperty("searchrules")||(t.searchrules={}),t.inlist=t.search===undefined?!0:t.search;var s=function(){return n("#"+n.jgrid.jqID(i.id))[0]||null},c=s(),r=n.jgrid.styleUI[c.p.styleUI||"jQueryUI"].filter,u=n.jgrid.styleUI[c.p.styleUI||"jQueryUI"].common;this.p.showQuery&&n(this).append("<table class='queryresult "+r.table_widget+"' style='display:block;max-width:440px;border:0px none;' dir='"+this.p.direction+"'><tbody><tr><td class='query'><\/td><\/tr><\/tbody><\/table>");h=function(t,r){var u=[!0,""],f=s();if(n.isFunction(r.searchrules))u=r.searchrules.call(f,t,r);else if(n.jgrid&&n.jgrid.checkValues)try{u=n.jgrid.checkValues.call(f,t,-1,r.searchrules,r.label)}catch(e){}u&&u.length&&u[0]===!1&&(i.error=!u[0],i.errmsg=u[1])};this.onchange=function(){return this.p.error=!1,this.p.errmsg="",n.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):!1};this.reDraw=function(){n("table.group:first",this).remove();var t=this.createTableForGroup(i.filter,null);n(this).append(t);n.isFunction(this.p.afterRedraw)&&this.p.afterRedraw.call(this,this.p)};this.createTableForGroup=function(t,f){var e=this,o,h=n("<table class='group "+r.table_widget+" ui-search-table' style='border:0px none;'><tbody><\/tbody><\/table>"),p="left",w,c,a,b,tt,v,k,l,d,y,it,g,nt,rt,s;if(this.p.direction==="rtl"&&(p="right",h.attr("dir","rtl")),f===null&&h.append("<tr class='error' style='display:none;'><th colspan='5' class='"+u.error+"' align='"+p+"'><\/th><\/tr>"),w=n("<tr><\/tr>"),h.append(w),c=n("<th colspan='5' align='"+p+"'><\/th>"),w.append(c),this.p.ruleButtons===!0){for(a=n("<select class='opsel "+r.srSelect+"'><\/select>"),c.append(a),b="",o=0;o<i.groupOps.length;o++)tt=t.groupOp===e.p.groupOps[o].op?" selected='selected'":"",b+="<option value='"+e.p.groupOps[o].op+"'"+tt+">"+e.p.groupOps[o].text+"<\/option>";a.append(b).on("change",function(){t.groupOp=n(a).val();e.onchange()})}if(v="<span><\/span>",this.p.groupButton){v=n("<input type='button' value='+ {}' title='"+e.p.subgroup+"' class='add-group "+u.button+"'/>");v.on("click",function(){return t.groups===undefined&&(t.groups=[]),t.groups.push({groupOp:i.groupOps[0].op,rules:[],groups:[]}),e.reDraw(),e.onchange(),!1})}if(c.append(v),this.p.ruleButtons===!0){k=n("<input type='button' value='+' title='"+e.p.addrule+"' class='add-rule ui-add "+u.button+"'/>");k.on("click",function(){var r;for(t.rules===undefined&&(t.rules=[]),o=0;o<e.p.columns.length;o++){var i=e.p.columns[o].search===undefined?!0:e.p.columns[o].search,u=e.p.columns[o].hidden===!0,f=e.p.columns[o].searchoptions.searchhidden===!0;if(f&&i||i&&!u){l=e.p.columns[o];break}}return l?(r=l.searchoptions.sopt?l.searchoptions.sopt:e.p.sopt?e.p.sopt:n.inArray(l.searchtype,e.p.strarr)!==-1?e.p.stropts:e.p.numopts,t.rules.push({field:l.name,op:r[0],data:""}),e.reDraw(),!1):!1});c.append(k)}if(f!==null){d=n("<input type='button' value='-' title='"+e.p.delgroup+"' class='delete-group "+u.button+"'/>");c.append(d);d.on("click",function(){for(o=0;o<f.groups.length;o++)if(f.groups[o]===t){f.groups.splice(o,1);break}return e.reDraw(),e.onchange(),!1})}if(t.groups!==undefined)for(o=0;o<t.groups.length;o++)y=n("<tr><\/tr>"),h.append(y),it=n("<td class='first'><\/td>"),y.append(it),g=n("<td colspan='4'><\/td>"),g.append(this.createTableForGroup(t.groups[o],t)),y.append(g);if(t.groupOp===undefined&&(t.groupOp=e.p.groupOps[0].op),nt=e.p.ruleButtons&&e.p.uniqueSearchFields,nt)for(s=0;s<e.p.columns.length;s++)e.p.columns[s].inlist&&(e.p.columns[s].search=!0);if(t.rules!==undefined)for(o=0;o<t.rules.length;o++)if(h.append(this.createTableRowForRule(t.rules[o],t)),nt)for(rt=t.rules[o].field,s=0;s<e.p.columns.length;s++)if(rt===e.p.columns[s].name){e.p.columns[s].search=!1;break}return h};this.createTableRowForRule=function(t,f){var e=this,y=s(),p=n("<tr><\/tr>"),c,v,l,h,d="",g,it,w,a,b,tt,rt,k,nt,ut,ft,et;p.append("<td class='first'><\/td>");it=n("<td class='columns'><\/td>");p.append(it);w=n("<select class='"+r.srSelect+"'><\/select>");b=[];it.append(w);w.on("change",function(){var u,f,i,s,p,k;for(e.p.ruleButtons&&e.p.uniqueSearchFields&&(u=parseInt(n(this).data("curr"),10),f=this.selectedIndex,u>=0&&(e.p.columns[u].search=!0,n(this).data("curr",f),e.p.columns[f].search=!1)),t.field=n(w).val(),l=n(this).parents("tr:first"),n(".data",l).empty(),c=0;c<e.p.columns.length;c++)if(e.p.columns[c].name===t.field){h=e.p.columns[c];break}if(h){for(h.searchoptions.id=n.jgrid.randId(),h.searchoptions.name=t.field,h.searchoptions.oper="filter",o&&h.inputtype==="text"&&(h.searchoptions.size||(h.searchoptions.size=10)),i=n.jgrid.createEl.call(y,h.inputtype,h.searchoptions,"",!0,e.p.ajaxSelectOptions||{},!0),n(i).addClass("input-elm "+r.srInput),v=h.searchoptions.sopt?h.searchoptions.sopt:e.p.sopt?e.p.sopt:n.inArray(h.searchtype,e.p.strarr)!==-1?e.p.stropts:e.p.numopts,s="",p=0,b=[],n.each(e.p.ops,function(){b.push(this.oper)}),c=0;c<v.length;c++)a=n.inArray(v[c],b),a!==-1&&(p===0&&(t.op=e.p.ops[a].oper),s+="<option value='"+e.p.ops[a].oper+"'>"+e.p.ops[a].text+"<\/option>",p++);n(".selectopts",l).empty().append(s);n(".selectopts",l)[0].selectedIndex=0;n.jgrid.msie()&&n.jgrid.msiever()<9&&(k=parseInt(n("select.selectopts",l)[0].offsetWidth,10)+1,n(".selectopts",l).width(k),n(".selectopts",l).css("width","auto"));n(".data",l).append(i);n.jgrid.bindEv.call(y,i,h.searchoptions);n(".input-elm",l).on("change",function(i){var r=i.target;t.data=r.nodeName.toUpperCase()==="SPAN"&&h.searchoptions&&n.isFunction(h.searchoptions.custom_value)?h.searchoptions.custom_value.call(y,n(r).children(".customelement:first"),"get"):r.value;e.onchange()});setTimeout(function(){t.data=n(i).val();e.onchange()},0)}});for(tt=0,c=0;c<e.p.columns.length;c++){var ot=e.p.columns[c].search===undefined?!0:e.p.columns[c].search,st=e.p.columns[c].hidden===!0,ht=e.p.columns[c].searchoptions.searchhidden===!0;(ht&&ot||ot&&!st)&&(g="",t.field===e.p.columns[c].name&&(g=" selected='selected'",tt=c),d+="<option value='"+e.p.columns[c].name+"'"+g+">"+e.p.columns[c].label+"<\/option>")}w.append(d);w.data("curr",tt);rt=n("<td class='operators'><\/td>");p.append(rt);h=i.columns[tt];h.searchoptions.id=n.jgrid.randId();o&&h.inputtype==="text"&&(h.searchoptions.size||(h.searchoptions.size=10));h.searchoptions.name=t.field;h.searchoptions.oper="filter";k=n.jgrid.createEl.call(y,h.inputtype,h.searchoptions,t.data,!0,e.p.ajaxSelectOptions||{},!0);(t.op==="nu"||t.op==="nn")&&(n(k).attr("readonly","true"),n(k).attr("disabled","true"));nt=n("<select class='selectopts "+r.srSelect+"'><\/select>");rt.append(nt);nt.on("change",function(){t.op=n(nt).val();l=n(this).parents("tr:first");var i=n(".input-elm",l)[0];t.op==="nu"||t.op==="nn"?(t.data="",i.tagName.toUpperCase()!=="SELECT"&&(i.value=""),i.setAttribute("readonly","true"),i.setAttribute("disabled","true")):(i.tagName.toUpperCase()==="SELECT"&&(t.data=i.value),i.removeAttribute("readonly"),i.removeAttribute("disabled"));e.onchange()});for(v=h.searchoptions.sopt?h.searchoptions.sopt:e.p.sopt?e.p.sopt:n.inArray(h.searchtype,e.p.strarr)!==-1?e.p.stropts:e.p.numopts,d="",n.each(e.p.ops,function(){b.push(this.oper)}),c=0;c<v.length;c++)a=n.inArray(v[c],b),a!==-1&&(g=t.op===e.p.ops[a].oper?" selected='selected'":"",d+="<option value='"+e.p.ops[a].oper+"'"+g+">"+e.p.ops[a].text+"<\/option>");nt.append(d);ut=n("<td class='data'><\/td>");p.append(ut);ut.append(k);n.jgrid.bindEv.call(y,k,h.searchoptions);n(k).addClass("input-elm "+r.srInput).on("change",function(){t.data=h.inputtype==="custom"?h.searchoptions.custom_value.call(y,n(this).children(".customelement:first"),"get"):n(this).val();e.onchange()});if(ft=n("<td><\/td>"),p.append(ft),this.p.ruleButtons===!0){et=n("<input type='button' value='-' title='"+e.p.delrule+"' class='delete-rule ui-del "+u.button+"'/>");ft.append(et);et.on("click",function(){for(c=0;c<f.rules.length;c++)if(f.rules[c]===t){f.rules.splice(c,1);break}return e.reDraw(),e.onchange(),!1})}return p};this.getStringForGroup=function(n){var t="(",i;if(n.groups!==undefined)for(i=0;i<n.groups.length;i++){t.length>1&&(t+=" "+n.groupOp+" ");try{t+=this.getStringForGroup(n.groups[i])}catch(r){alert(r)}}if(n.rules!==undefined)try{for(i=0;i<n.rules.length;i++)t.length>1&&(t+=" "+n.groupOp+" "),t+=this.getStringForRule(n.rules[i])}catch(u){alert(u)}return(t+=")",t==="()")?"":t};this.getStringForRule=function(t){for(var o="",r="",e,u,f=0;f<this.p.ops.length;f++)if(this.p.ops[f].oper===t.op){o=this.p.operands.hasOwnProperty(t.op)?this.p.operands[t.op]:"";r=this.p.ops[f].oper;break}for(f=0;f<this.p.columns.length;f++)if(this.p.columns[f].name===t.field){e=this.p.columns[f];break}return e===undefined?"":(u=t.data,(r==="bw"||r==="bn")&&(u=u+"%"),(r==="ew"||r==="en")&&(u="%"+u),(r==="cn"||r==="nc")&&(u="%"+u+"%"),(r==="in"||r==="ni")&&(u=" ("+u+")"),i.errorcheck&&h(t.data,e),n.inArray(e.searchtype,["int","integer","float","number","currency"])!==-1||r==="nn"||r==="nu"?t.field+" "+o+" "+u:t.field+" "+o+' "'+u+'"')};this.resetFilter=function(){this.p.filter=n.extend(!0,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){n("th."+u.error,this).html("");n("tr.error",this).hide()};this.showError=function(){n("th."+u.error,this).html(this.p.errmsg);n("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(i.filter)};this.toString=function(){function i(t){if(n.p.errorcheck){for(var r,i=0;i<n.p.columns.length;i++)if(n.p.columns[i].name===t.field){r=n.p.columns[i];break}r&&h(t.data,r)}return t.op+"(item."+t.field+",'"+t.data+"')"}function t(n){var r="(",u;if(n.groups!==undefined)for(u=0;u<n.groups.length;u++)r.length>1&&(r+=n.groupOp==="OR"?" || ":" && "),r+=t(n.groups[u]);if(n.rules!==undefined)for(u=0;u<n.rules.length;u++)r.length>1&&(r+=n.groupOp==="OR"?" || ":" && "),r+=i(n.rules[u]);return(r+=")",r==="()")?"":r}var n=this;return t(this.p.filter)};this.reDraw();this.p.showQuery&&this.onchange();this.filter=!0}})};n.extend(n.fn.jqFilter,{toSQLString:function(){var n="";return this.each(function(){n=this.toUserFriendlyString()}),n},filterData:function(){var n;return this.each(function(){n=this.p.filter}),n},getParameter:function(n){return n!==undefined&&this.p.hasOwnProperty(n)?this.p[n]:this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(t){typeof t=="string"&&(t=n.jgrid.parse(t));this.each(function(){this.p.filter=t;this.reDraw();this.onchange()})}});n.jgrid.extend({filterToolbar:function(t){var i=n.jgrid.getRegional(this[0],"search");return t=n.extend({autosearch:!0,autosearchDelay:500,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,onClearSearchValue:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw",searchOperators:!1,resetIcon:"x",splitSelect:",",groupOpSelect:"OR",operands:{eq:"==",ne:"!",lt:"<",le:"<=",gt:">",ge:">=",bw:"^",bn:"!^","in":"=",ni:"!=",ew:"|",en:"!@",cn:"~",nc:"!~",nu:"#",nn:"!#",bt:"..."}},i,t||{}),this.each(function(){var r=this;if(!r.p.filterToolbar){n(r).data("filterToolbar")||n(r).data("filterToolbar",t);r.p.force_regional&&(t=n.extend(t,i));var c=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].filter,o=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].common,l=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].base,f=function(){var w={},nt=0,o,v,tt={},l,b=!1,it=[],k=!1,c,rt,f,d,i,h,u,y,s,e,a,g,p;if(n.each(r.p.colModel,function(){var i=n("#gs_"+r.p.idPrefix+n.jgrid.jqID(this.name),this.frozen===!0&&r.p.frozenColumns===!0?r.grid.fhDiv:r.grid.hDiv);if(v=this.index||this.name,c=this.searchoptions||{},l=t.searchOperators&&c.searchOperMenu?i.parent().prev().children("a").attr("soper")||t.defaultSearch:c.sopt?c.sopt[0]:this.stype==="select"?"eq":t.defaultSearch,o=this.stype==="custom"&&n.isFunction(c.custom_value)&&i.length>0&&i[0].nodeName.toUpperCase()==="SPAN"?c.custom_value.call(r,i.children(".customelement:first"),"get"):i.val(),this.stype==="select"&&c.multiple&&n.isArray(o)&&o.length&&(b=!0,it.push(v),o=o.length===1?o[0]:o),l==="bt"&&(k=!0),o||l==="nu"||l==="nn")w[v]=o,tt[v]=l,nt++;else try{delete r.p.postData[v]}catch(u){}}),rt=nt>0?!0:!1,t.stringResult===!0||r.p.datatype==="local"||t.searchOperators===!0){if(f='{"groupOp":"'+t.groupOp+'","rules":[',d=0,n.each(w,function(n,t){d>0&&(f+=",");f+='{"field":"'+n+'",';f+='"op":"'+tt[n]+'",';t+="";f+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';d++}),f+="]}",b&&(i=n.jgrid.parse(f),i.rules&&i.rules.length))for(h=i.rules,u=0;u<h.length;u++)s=h[u],n.inArray(s.filed,it)&&(e=s.data.split(t.splitSelect),e.length>1&&(i.groups===undefined&&(i.groups=[]),a={groupOp:t.groupOpSelect,groups:[],rules:[]},i.groups.push(a),n.each(e,function(n){y=e[n];y&&a.rules.push({data:e[n],op:s.op,field:s.field})}),h.splice(u,1),u--));if(k&&(n.isPlainObject(i)||(i=n.jgrid.parse(f)),i.rules&&i.rules.length))for(h=i.rules,u=0;u<h.length;u++)s=h[u],s.op==="bt"&&(e=s.data.split("..."),e.length>1&&(i.groups===undefined&&(i.groups=[]),a={groupOp:"AND",groups:[],rules:[]},i.groups.push(a),n.each(e,function(n){var t=n===0?"ge":"le";y=e[n];y&&a.rules.push({data:e[n],op:t,field:s.field})}),h.splice(u,1),u--));(k||b)&&(f=JSON.stringify(i));n.extend(r.p.postData,{filters:f});n.each(["searchField","searchString","searchOper"],function(n,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})}else n.extend(r.p.postData,w);r.p.searchurl&&(g=r.p.url,n(r).jqGrid("setGridParam",{url:r.p.searchurl}));p=n(r).triggerHandler("jqGridToolbarBeforeSearch")==="stop"?!0:!1;!p&&n.isFunction(t.beforeSearch)&&(p=t.beforeSearch.call(r));p||n(r).jqGrid("setGridParam",{search:rt}).trigger("reloadGrid",[{page:1}]);g&&n(r).jqGrid("setGridParam",{url:g});n(r).triggerHandler("jqGridToolbarAfterSearch");n.isFunction(t.afterSearch)&&t.afterSearch.call(r)},a=function(i){var e={},s=0,f,l,u,h,c,o;i=typeof i!="boolean"?!0:i;n.each(r.p.colModel,function(){var t,i=n("#gs_"+r.p.idPrefix+n.jgrid.jqID(this.name),this.frozen===!0&&r.p.frozenColumns===!0?r.grid.fhDiv:r.grid.hDiv);this.searchoptions&&this.searchoptions.defaultValue!==undefined&&(t=this.searchoptions.defaultValue);f=this.index||this.name;switch(this.stype){case"select":if(i.find("option").each(function(i){return i===0&&(this.selected=!0),n(this).val()===t?(this.selected=!0,!1):void 0}),t!==undefined)e[f]=t,s++;else try{delete r.p.postData[f]}catch(u){}break;case"text":if(i.val(t||""),t!==undefined)e[f]=t,s++;else try{delete r.p.postData[f]}catch(o){}break;case"custom":n.isFunction(this.searchoptions.custom_value)&&i.length>0&&i[0].nodeName.toUpperCase()==="SPAN"&&this.searchoptions.custom_value.call(r,i.children(".customelement:first"),"set",t||"")}});l=s>0?!0:!1;r.p.resetsearch=!0;t.stringResult===!0||r.p.datatype==="local"?(u='{"groupOp":"'+t.groupOp+'","rules":[',h=0,n.each(e,function(n,t){h>0&&(u+=",");u+='{"field":"'+n+'",';u+='"op":"eq",';t+="";u+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';h++}),u+="]}",n.extend(r.p.postData,{filters:u}),n.each(["searchField","searchString","searchOper"],function(n,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]})):n.extend(r.p.postData,e);r.p.searchurl&&(c=r.p.url,n(r).jqGrid("setGridParam",{url:r.p.searchurl}));o=n(r).triggerHandler("jqGridToolbarBeforeClear")==="stop"?!0:!1;!o&&n.isFunction(t.beforeClear)&&(o=t.beforeClear.call(r));o||i&&n(r).jqGrid("setGridParam",{search:l}).trigger("reloadGrid",[{page:1}]);c&&n(r).jqGrid("setGridParam",{url:c});n(r).triggerHandler("jqGridToolbarAfterClear");n.isFunction(t.afterClear)&&t.afterClear()},v=function(){var i=n("tr.ui-search-toolbar",r.grid.hDiv),t=r.p.frozenColumns===!0?n("tr.ui-search-toolbar",r.grid.fhDiv):!1;i.css("display")==="none"?(i.show(),t&&t.show()):(i.hide(),t&&t.hide())},y=function(i,u,e){var v,l;n("#sopt_menu").remove();u=parseInt(u,10);e=parseInt(e,10)+18;for(var w=n(".ui-jqgrid-view").css("font-size")||"11px",a='<ul id="sopt_menu" class="ui-search-menu modal-content" role="menu" tabindex="0" style="font-size:'+w+";left:"+u+"px;top:"+e+'px;width:">',b=n(i).attr("soper"),y,p=[],h,s=0,k=n(i).attr("colname"),d=r.p.colModel.length;s<d;){if(r.p.colModel[s].name===k)break;s++}for(v=r.p.colModel[s],l=n.extend({},v.searchoptions),l.sopt||(l.sopt=[],l.sopt[0]=v.stype==="select"?"eq":t.defaultSearch),n.each(t.odata,function(){p.push(this.oper)}),s=0;s<l.sopt.length;s++)h=n.inArray(l.sopt[s],p),h!==-1&&(y=b===t.odata[h].oper?o.highlight:"",a+='<li class="ui-menu-item '+y+'" role="presentation"><a class="'+o.cornerall+' g-menu-item" tabindex="0" role="menuitem" value="'+t.odata[h].oper+'" oper="'+t.operands[t.odata[h].oper]+'"><table class="ui-common-table"><tr><td width="25px">'+t.operands[t.odata[h].oper]+"<\/td><td>"+t.odata[h].text+"<\/td><\/tr><\/table><\/a><\/li>");a+="<\/ul>";n("body").append(a);n("#sopt_menu").addClass("ui-menu "+c.menu_widget);n("#sopt_menu > li > a").hover(function(){n(this).addClass(o.hover)},function(){n(this).removeClass(o.hover)}).click(function(){var u=n(this).attr("value"),e=n(this).attr("oper"),o;n(r).triggerHandler("jqGridToolbarSelectOper",[u,e,i]);n("#sopt_menu").hide();n(i).text(e).attr("soper",u);t.autosearch===!0&&(o=n(i).parent().next().children()[0],(n(o).val()||u==="nu"||u==="nn")&&f())})},s=n("<tr class='ui-search-toolbar' role='row'><\/tr>"),h,e,u;if(t.restoreFromFilters&&(u=r.p.postData.filters,u&&(typeof u=="string"&&(u=n.jgrid.parse(u)),e=u.rules.length?u.rules:!1)),n.each(r.p.colModel,function(i){var o=this,u,d="",nt="=",p,w,tt,it,b,k,a,g=n("<th role='columnheader' class='"+l.headerBox+" ui-th-"+r.p.direction+"' id='gsh_"+r.p.id+"_"+o.name+"' ><\/th>"),rt=n("<div><\/div>"),v=n("<table class='ui-search-table' cellspacing='0'><tr><td class='ui-search-oper' headers=''><\/td><td class='ui-search-input' headers=''><\/td><td class='ui-search-clear' headers=''><\/td><\/tr><\/table>"),y,ut;if(this.hidden===!0&&n(g).css("display","none"),this.search=this.search===!1?!1:!0,this.stype===undefined&&(this.stype="text"),this.searchoptions=this.searchoptions||{},this.searchoptions.searchOperMenu===undefined&&(this.searchoptions.searchOperMenu=!0),u=n.extend({},this.searchoptions,{name:o.index||o.name,id:"gs_"+r.p.idPrefix+o.name,oper:"search"}),this.search){if(t.restoreFromFilters&&e)for(a=!1,y=0;y<e.length;y++)if(e[y].field&&(ut=o.index||o.name,ut===e[y].field)){a=e[y];break}if(t.searchOperators){for(p=u.sopt?u.sopt[0]:o.stype==="select"?"eq":t.defaultSearch,t.restoreFromFilters&&a&&(p=a.op),w=0;w<t.odata.length;w++)if(t.odata[w].oper===p){nt=t.operands[p]||"";break}tt=u.searchtitle!=null?u.searchtitle:t.operandTitle;d=this.searchoptions.searchOperMenu?"<a title='"+tt+"' style='padding-right: 0.5em;' soper='"+p+"' class='soptclass' colname='"+this.name+"'>"+nt+"<\/a>":""}n("td:eq(0)",v).attr("colindex",i).append(d);u.clearSearch===undefined&&(u.clearSearch=!0);u.clearSearch?(it=t.resetTitle||"Clear Search Value",n("td:eq(2)",v).append("<a title='"+it+"' style='padding-right: 0.3em;padding-left: 0.3em;' class='clearsearchclass'>"+t.resetIcon+"<\/a>")):n("td:eq(2)",v).hide();this.surl&&(u.dataUrl=this.surl);b="";u.defaultValue&&(b=n.isFunction(u.defaultValue)?u.defaultValue.call(r):u.defaultValue);t.restoreFromFilters&&a&&(b=a.data);k=n.jgrid.createEl.call(r,this.stype,u,b,!1,n.extend({},n.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));n(k).addClass(c.srInput);n("td:eq(1)",v).append(k);n(rt).append(v);u.dataEvents==null&&(u.dataEvents=[]);switch(this.stype){case"select":t.autosearch===!0&&u.dataEvents.push({type:"change",fn:function(){return f(),!1}});break;case"text":t.autosearch===!0&&(t.searchOnEnter?u.dataEvents.push({type:"keypress",fn:function(n){var t=n.charCode||n.keyCode||0;return t===13?(f(),!1):this}}):u.dataEvents.push({type:"keydown",fn:function(n){var i=n.which;switch(i){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:h&&clearTimeout(h);h=setTimeout(function(){f()},t.autosearchDelay)}}}))}n.jgrid.bindEv.call(r,k,u)}n(g).append(rt);n(s).append(g);t.searchOperators&&d!==""||n("td:eq(0)",v).hide()}),n("table thead",r.grid.hDiv).append(s),t.searchOperators){n(".soptclass",s).click(function(t){var i=n(this).offset(),r=i.left,u=i.top;y(this,r,u);t.stopPropagation()});n("body").on("click",function(t){t.target.className!=="soptclass"&&n("#sopt_menu").remove()})}n(".clearsearchclass",s).click(function(){var s=n(this).parents("tr:first"),e=parseInt(n("td.ui-search-oper",s).attr("colindex"),10),o=n.extend({},r.p.colModel[e].searchoptions||{}),u=o.defaultValue?o.defaultValue:"",i;r.p.colModel[e].stype==="select"?(i=n("td.ui-search-input select",s),u?i.val(u):i[0].selectedIndex=0):(i=n("td.ui-search-input input",s),i.val(u));n(r).triggerHandler("jqGridToolbarClearVal",[i[0],e,o,u]);n.isFunction(t.onClearSearchValue)&&t.onClearSearchValue.call(r,i[0],e,o,u);t.autosearch===!0&&f()});this.p.filterToolbar=!0;this.triggerToolbar=f;this.clearToolbar=a;this.toggleToolbar=v}})},destroyFilterToolbar:function(){return this.each(function(){this.p.filterToolbar&&(this.triggerToolbar=null,this.clearToolbar=null,this.toggleToolbar=null,this.p.filterToolbar=!1,n(this.grid.hDiv).find("table thead tr.ui-search-toolbar").remove())})},refreshFilterToolbar:function(t){return t=n.extend(!0,{filters:"",onClearVal:null,onSetVal:null},t||{}),this.each(function(){function a(h){if(h&&h.rules){for(c=h.rules,s=c.length,i=0;i<s;i++)o=c[i],e=n.inArray(o.field,l),e!==-1&&(u=n("#gs_"+f.p.idPrefix+n.jgrid.jqID(r[e].name)),u.length>0&&(r[e].stype==="select"?u.find("option[value='"+n.jgrid.jqID(o.data)+"']").prop("selected",!0):r[e].stype==="text"&&u.val(o.data),n.isFunction(t.onSetVal)&&t.onSetVal.call(f,u,r[e].name)));if(h.groups)for(var v=0;v<h.groups.length;v++)a(h.groups[v])}}var f=this,r=f.p.colModel,i,s=f.p.colModel.length,u,h,c,o,l=[],e;if(f.p.filterToolbar){for(i=0;i<s;i++){l.push(r[i].name);u=n("#gs_"+f.p.idPrefix+n.jgrid.jqID(r[i].name));switch(r[i].stype){case"select":case"text":u.val("")}n.isFunction(t.onClearVal)&&t.onClearVal.call(f,u,r[i].name)}typeof t.filters=="string"&&t.filters.length&&(h=n.jgrid.parse(t.filters));n.isPlainObject(h)&&a(h)}})},searchGrid:function(t){var i=n.jgrid.getRegional(this[0],"search");return t=n.extend(!0,{recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,sortStrategy:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"ISNOT NULL"}},i,t||{}),this.each(function(){function d(u){l=n(i).triggerHandler("jqGridFilterBeforeShow",[u]);l===undefined&&(l=!0);l&&n.isFunction(t.beforeShowSearch)&&(l=t.beforeShowSearch.call(i,u));l&&(n.jgrid.viewModal("#"+n.jgrid.jqID(e.themodal),{gbox:"#gbox_"+n.jgrid.jqID(r),jqm:t.jqModal,modal:t.modal,overlay:t.overlay,toTop:t.toTop}),n(i).triggerHandler("jqGridFilterAfterShow",[u]),n.isFunction(t.afterShowSearch)&&t.afterShowSearch.call(i,u))}var i=this,b;if(i.grid){var r="fbox_"+i.p.id,l=!0,u=!0,e={themodal:"searchmod"+r,modalhead:"searchhd"+r,modalcontent:"searchcnt"+r,scrollelm:r},h=i.p.postData[t.sFilter],c,p=n.jgrid.styleUI[i.p.styleUI||"jQueryUI"].filter,f=n.jgrid.styleUI[i.p.styleUI||"jQueryUI"].common;if(t.styleUI=i.p.styleUI,typeof h=="string"&&(h=n.jgrid.parse(h)),t.recreateFilter===!0&&n("#"+n.jgrid.jqID(e.themodal)).remove(),n("#"+n.jgrid.jqID(e.themodal))[0]!==undefined)d(n("#fbox_"+n.jgrid.jqID(i.p.id)));else{t.layer!==null&&n("#"+r).get(0)!==undefined&&n("#"+r).remove();var o=n("<div><div id='"+r+"' class='searchFilter' style='overflow:auto'><\/div><\/div>").insertBefore("#gview_"+n.jgrid.jqID(i.p.id)),g="left",nt="";i.p.direction==="rtl"&&(g="right",nt=" style='text-align:left'",o.attr("dir","rtl"));var s=n.extend([],i.p.colModel),it="<a id='"+r+"_search' class='fm-button "+f.button+" fm-button-icon-right ui-search'><span class='"+f.icon_base+" "+p.icon_search+"'><\/span>"+t.Find+"<\/a>",rt="<a id='"+r+"_reset' class='fm-button "+f.button+" fm-button-icon-left ui-reset'><span class='"+f.icon_base+" "+p.icon_reset+"'><\/span>"+t.Reset+"<\/a>",k="",a="",w,v=!1,tt,y=-1;if(t.showQuery&&(k="<a id='"+r+"_query' class='fm-button "+f.button+" fm-button-icon-left'><span class='"+f.icon_base+" "+p.icon_query+"'><\/span>Query<\/a>"),t.columns.length?(s=t.columns,y=0,w=s[0].index||s[0].name):n.each(s,function(n,t){if(t.label||(t.label=i.p.colNames[n]),!v){var r=t.search===undefined?!0:t.search,u=t.hidden===!0,f=t.searchoptions&&t.searchoptions.searchhidden===!0;(f&&r||r&&!u)&&(v=!0,w=t.index||t.name,y=n)}}),(!h&&w||t.multipleSearch===!1)&&(b="eq",y>=0&&s[y].searchoptions&&s[y].searchoptions.sopt?b=s[y].searchoptions.sopt[0]:t.sopt&&t.sopt.length&&(b=t.sopt[0]),h={groupOp:"AND",rules:[{field:w,op:b,data:""}]}),v=!1,t.tmplNames&&t.tmplNames.length&&(v=!0,a="<tr><td class='ui-search-label'>"+t.tmplLabel+"<\/td>",a+="<td><select class='ui-template "+p.srSelect+"'>",a+="<option value='default'>Default<\/option>",n.each(t.tmplNames,function(n,t){a+="<option value='"+n+"'>"+t+"<\/option>"}),a+="<\/select><\/td><\/tr>"),tt="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+r+"_2'><tbody><tr><td colspan='2'><hr class='"+f.content+"' style='margin:1px'/><\/td><\/tr>"+a+"<tr><td class='EditButton' style='text-align:"+g+"'>"+rt+"<\/td><td class='EditButton' "+nt+">"+k+it+"<\/td><\/tr><\/tbody><\/table>",r=n.jgrid.jqID(r),n("#"+r).jqFilter({columns:s,sortStrategy:t.sortStrategy,filter:t.loadDefaults?h:null,showQuery:t.showQuery,errorcheck:t.errorcheck,sopt:t.sopt,groupButton:t.multipleGroup,ruleButtons:t.multipleSearch,uniqueSearchFields:t.uniqueSearchFields,afterRedraw:t.afterRedraw,ops:t.odata,operands:t.operands,ajaxSelectOptions:i.p.ajaxSelectOptions,groupOps:t.groupOps,addsubgrup:t.addsubgrup,addrule:t.addrule,delgroup:t.delgroup,delrule:t.delrule,onChange:function(){this.p.showQuery&&n(".query",this).html(this.toUserFriendlyString());n.isFunction(t.afterChange)&&t.afterChange.call(i,n("#"+r),t)},direction:i.p.direction,id:i.p.id}),o.append(tt),v&&t.tmplFilters&&t.tmplFilters.length)n(".ui-template",o).on("change",function(){var i=n(this).val();return i==="default"?n("#"+r).jqFilter("addFilter",h):n("#"+r).jqFilter("addFilter",t.tmplFilters[parseInt(i,10)]),!1});if(t.multipleGroup===!0&&(t.multipleSearch=!0),n(i).triggerHandler("jqGridFilterInitialize",[n("#"+r)]),n.isFunction(t.onInitializeSearch)&&t.onInitializeSearch.call(i,n("#"+r)),t.gbox="#gbox_"+r,t.layer?n("#"+n.jgrid.jqID(t.layer)).html(o):n.jgrid.createModal(e,o,t,"#gview_"+n.jgrid.jqID(i.p.id),n("#gbox_"+n.jgrid.jqID(i.p.id))[0]),(t.searchOnEnter||t.closeOnEscape)&&n("#"+n.jgrid.jqID(e.themodal)).keydown(function(i){var u=n(i.target);return t.searchOnEnter&&i.which===13&&!u.hasClass("add-group")&&!u.hasClass("add-rule")&&!u.hasClass("delete-group")&&!u.hasClass("delete-rule")&&(!u.hasClass("fm-button")||!u.is("[id$=_query]"))?(n("#"+r+"_search").click(),!1):t.closeOnEscape&&i.which===27?(n("#"+n.jgrid.jqID(e.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0}),k)n("#"+r+"_query").on("click",function(){return n(".queryresult",o).toggle(),!1});t.stringResult===undefined&&(t.stringResult=t.multipleSearch);n("#"+r+"_search").on("click",function(){var f={},s,o;if(c=n("#"+r),c.find(".input-elm:focus").change(),o=c.jqFilter("filterData"),t.errorcheck&&(c[0].hideError(),t.showQuery||c.jqFilter("toSQLString"),c[0].p.error))return c[0].showError(),!1;if(t.stringResult){try{s=JSON.stringify(o)}catch(h){}typeof s=="string"&&(f[t.sFilter]=s,n.each([t.sField,t.sValue,t.sOper],function(){f[this]=""}))}else t.multipleSearch?(f[t.sFilter]=o,n.each([t.sField,t.sValue,t.sOper],function(){f[this]=""})):(f[t.sField]=o.rules[0].field,f[t.sValue]=o.rules[0].data,f[t.sOper]=o.rules[0].op,f[t.sFilter]="");return i.p.search=!0,n.extend(i.p.postData,f),u=n(i).triggerHandler("jqGridFilterSearch"),u===undefined&&(u=!0),u&&n.isFunction(t.onSearch)&&(u=t.onSearch.call(i,i.p.filters)),u!==!1&&n(i).trigger("reloadGrid",[{page:1}]),t.closeAfterSearch&&n.jgrid.hideModal("#"+n.jgrid.jqID(e.themodal),{gb:"#gbox_"+n.jgrid.jqID(i.p.id),jqm:t.jqModal,onClose:t.onClose}),!1});n("#"+r+"_reset").on("click",function(){var f={},s=n("#"+r);return i.p.search=!1,i.p.resetsearch=!0,t.multipleSearch===!1?f[t.sField]=f[t.sValue]=f[t.sOper]="":f[t.sFilter]="",s[0].resetFilter(),v&&n(".ui-template",o).val("default"),n.extend(i.p.postData,f),u=n(i).triggerHandler("jqGridFilterReset"),u===undefined&&(u=!0),u&&n.isFunction(t.onReset)&&(u=t.onReset.call(i)),u!==!1&&n(i).trigger("reloadGrid",[{page:1}]),t.closeAfterReset&&n.jgrid.hideModal("#"+n.jgrid.jqID(e.themodal),{gb:"#gbox_"+n.jgrid.jqID(i.p.id),jqm:t.jqModal,onClose:t.onClose}),!1});d(n("#"+r));n(".fm-button:not(."+f.disabled+")",o).hover(function(){n(this).addClass(f.hover)},function(){n(this).removeClass(f.hover)})}}})},filterInput:function(t,i){return i=n.extend(!0,{defaultSearch:"cn",groupOp:"OR",searchAll:!1,beforeSearch:null,afterSearch:null},i||{}),this.each(function(){var r=this,s,e,u,o,h,f;r.grid&&(u='{"groupOp":"'+i.groupOp+'","rules":[',o=0,t+="",!0)&&(n.each(r.p.colModel,function(){s=this.index||this.name;e=this.searchoptions||{};h=i.defaultSearch?i.defaultSearch:e.sopt?e.sopt[0]:i.defaultSearch;this.search=this.search===!1?!1:!0;(this.search||i.searchAll)&&(o>0&&(u+=","),u+='{"field":"'+s+'",',u+='"op":"'+h+'",',u+='"data":"'+t.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}',o++)}),u+="]}",n.extend(r.p.postData,{filters:u}),n.each(["searchField","searchString","searchOper"],function(n,t){r.p.postData.hasOwnProperty(t)&&delete r.p.postData[t]}),f=n(r).triggerHandler("jqGridFilterInputBeforeSearch")==="stop"?!0:!1,!f&&n.isFunction(i.beforeSearch)&&(f=i.beforeSearch.call(r)),f||n(r).jqGrid("setGridParam",{search:!0}).trigger("reloadGrid",[{page:1}]),n(r).triggerHandler("jqGridFilterInputAfterSearch"),n.isFunction(i.afterSearch)&&i.afterSearch.call(r))})}});t={};n.jgrid.extend({editGridRow:function(i,r){var o=n.jgrid.getRegional(this[0],"edit"),e=this[0].p.styleUI,f=n.jgrid.styleUI[e].formedit,u=n.jgrid.styleUI[e].common;return r=n.extend(!0,{top:0,left:0,width:"500",datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:u.overlay,removemodal:!0,form:"edit",template:null,focusField:!0,editselected:!1},o,r||{}),t[n(this)[0].p.id]=r,this.each(function(){function gt(){var r={},i,u;n(y).find(".FormElement").each(function(){var u=n(".customelement",this),f,i,s;if(u.length)f=u[0],i=n(f).attr("name"),n.each(e.p.colModel,function(){if(this.name===i&&this.editoptions&&n.isFunction(this.editoptions.custom_value)){try{if(o[i]=this.editoptions.custom_value.call(e,n("#"+n.jgrid.jqID(i),y),"get"),o[i]===undefined)throw"e1";}catch(r){r==="e1"?n.jgrid.info_dialog(k.errcap,"function 'custom_value' "+t[n(this)[0]].p.msg.novalue,t[n(this)[0]].p.bClose,{styleUI:t[n(this)[0]].p.styleUI}):n.jgrid.info_dialog(k.errcap,r.message,t[n(this)[0]].p.bClose,{styleUI:t[n(this)[0]].p.styleUI})}return!0}});else{switch(n(this).get(0).type){case"checkbox":n(this).is(":checked")?o[this.name]=n(this).val():(s=n(this).attr("offval"),o[this.name]=s);break;case"select-one":o[this.name]=n(this).val();break;case"select-multiple":o[this.name]=n(this).val();o[this.name]=o[this.name]?o[this.name].join(","):"";break;case"password":case"text":case"textarea":case"button":o[this.name]=n(this).val();break;case"radio":if(r.hasOwnProperty(this.name))return!0;r[this.name]=n(this).attr("offval")===undefined?"off":n(this).attr("offval")}e.p.autoencode&&(o[this.name]=n.jgrid.htmlEncode(o[this.name]))}});for(i in r)r.hasOwnProperty(i)&&(u=n('input[name="'+i+'"]:checked',y).val(),o[i]=u!==undefined?u:r[i],e.p.autoencode&&(o[i]=n.jgrid.htmlEncode(o[i])));return!0}function ti(i,r,u,o){for(var c,b,a,p=0,h,g,l,nt=[],y=!1,it="",d,w,k=1;k<=o;k++)it+="<td class='CaptionTD'>&#160;<\/td><td class='DataTD'>&#160;<\/td>";return i!=="_empty"&&(y=n(r).jqGrid("getInd",i)),n(r.p.colModel).each(function(w){var ft,et;if(c=this.name,b=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,g=b?"style='display:none'":"",c!=="cb"&&c!=="subgrid"&&this.editable===!0&&c!=="rn"){if(y===!1)h="";else if(c===r.p.ExpandColumn&&r.p.treeGrid===!0)h=n("td[role='gridcell']:eq("+w+")",r.rows[y]).text();else{try{h=n.unformat.call(r,n("td[role='gridcell']:eq("+w+")",r.rows[y]),{rowId:i,colModel:this},w)}catch(st){h=this.edittype&&this.edittype==="textarea"?n("td[role='gridcell']:eq("+w+")",r.rows[y]).text():n("td[role='gridcell']:eq("+w+")",r.rows[y]).html()}h&&h!=="&nbsp;"&&h!=="&#160;"&&(h.length!==1||h.charCodeAt(0)!==160)||(h="")}var k=n.extend({},this.editoptions||{},{id:c,name:c,rowId:i,oper:"edit"}),rt=n.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),ut=parseInt(rt.rowpos,10)||p+1,ot=parseInt((parseInt(rt.colpos,10)||1)*2,10);i==="_empty"&&k.defaultValue&&(h=n.isFunction(k.defaultValue)?k.defaultValue.call(e):k.defaultValue);this.edittype||(this.edittype="text");e.p.autoencode&&(h=n.jgrid.htmlDecode(h));l=n.jgrid.createEl.call(e,this.edittype,k,h,!1,n.extend({},n.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));this.edittype==="select"&&(h=n(l).val(),n(l).get(0).type==="select-multiple"&&h&&(h=h.join(",")));this.edittype==="checkbox"&&(h=n(l).is(":checked")?n(l).val():n(l).attr("offval"));n(l).addClass("FormElement");n.inArray(this.edittype,["text","textarea","password","select"])>-1&&n(l).addClass(f.inputClass);d=!0;tt?(ft=n(v).find("#"+c),ft.length?ft.replaceWith(l):d=!1):(a=n(u).find("tr[rowpos="+ut+"]"),rt.rowabove&&(et=n("<tr><td class='contentinfo' colspan='"+o*2+"'>"+rt.rowcontent+"<\/td><\/tr>"),n(u).append(et),et[0].rp=ut),a.length===0&&(a=n("<tr "+g+" rowpos='"+ut+"'><\/tr>").addClass("FormData").attr("id","tr_"+c),n(a).append(it),n(u).append(a),a[0].rp=ut),n("td:eq("+(ot-2)+")",a[0]).html("<label for='"+c+"'>"+(rt.label===undefined?r.p.colNames[w]:rt.label)+"<\/label>"),n("td:eq("+(ot-1)+")",a[0]).append(rt.elmprefix).append(l).append(rt.elmsuffix));(t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate)&&d&&(e.p.savedData[c]=h);this.edittype==="custom"&&n.isFunction(k.custom_value)&&k.custom_value.call(e,n("#"+c,s),"set",h);n.jgrid.bindEv.call(e,l,k);nt[p]=w;p++}}),p>0&&(tt?(w="<div class='FormData' style='display:none'><input class='FormElement' id='id_g' type='text' name='"+r.p.id+"_id' value='"+i+"'/>",n(v).append(w)):(w=n("<tr class='FormData' style='display:none'><td class='CaptionTD'><\/td><td colspan='"+(o*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+r.p.id+"_id' value='"+i+"'/><\/td><\/tr>"),w[0].rp=p+999,n(u).append(w)),(t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate)&&(e.p.savedData[r.p.id+"_id"]=i)),nt}function at(i,r,u){var o,p=0,f,s,l,c,a,h,v;if((t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate)&&(e.p.savedData={},e.p.savedData[r.p.id+"_id"]=i),h=r.p.colModel,i==="_empty"){n(h).each(function(){o=this.name;l=n.extend({},this.editoptions||{});s=n("#"+n.jgrid.jqID(o),u);s&&s.length&&s[0]!==null&&(c="",this.edittype==="custom"&&n.isFunction(l.custom_value)?l.custom_value.call(e,n("#"+o,u),"set",c):l.defaultValue?(c=n.isFunction(l.defaultValue)?l.defaultValue.call(e):l.defaultValue,s[0].type==="checkbox"?(a=c.toLowerCase(),a.search(/(false|f|0|no|n|off|undefined)/i)<0&&a!==""?(s[0].checked=!0,s[0].defaultChecked=!0,s[0].value=c):(s[0].checked=!1,s[0].defaultChecked=!1)):s.val(c)):s[0].type==="checkbox"?(s[0].checked=!1,s[0].defaultChecked=!1,c=n(s).attr("offval")):s[0].type&&s[0].type.substr(0,6)==="select"?s[0].selectedIndex=0:s.val(c),(t[e.p.id].checkOnSubmit===!0||t[e.p.id].checkOnUpdate)&&(e.p.savedData[o]=c))});n("#id_g",u).val(i);return}(v=n(r).jqGrid("getInd",i,!0),v)&&(n('td[role="gridcell"]',v).each(function(s){var c,l;if(o=h[s].name,o!=="cb"&&o!=="subgrid"&&o!=="rn"&&h[s].editable===!0){if(o===r.p.ExpandColumn&&r.p.treeGrid===!0)f=n(this).text();else try{f=n.unformat.call(r,n(this),{rowId:i,colModel:h[s]},s)}catch(v){f=h[s].edittype==="textarea"?n(this).text():n(this).html()}e.p.autoencode&&(f=n.jgrid.htmlDecode(f));(t[e.p.id].checkOnSubmit===!0||t[e.p.id].checkOnUpdate)&&(e.p.savedData[o]=f);o=n.jgrid.jqID(o);switch(h[s].edittype){case"password":case"text":case"button":case"image":case"textarea":(f==="&nbsp;"||f==="&#160;"||f.length===1&&f.charCodeAt(0)===160)&&(f="");n("#"+o,u).val(f);break;case"select":c=f.split(",");c=n.map(c,function(t){return n.trim(t)});n("#"+o+" option",u).each(function(){this.selected=h[s].editoptions.multiple||n.trim(f)!==n.trim(n(this).text())&&c[0]!==n.trim(n(this).text())&&c[0]!==n.trim(n(this).val())?h[s].editoptions.multiple?n.inArray(n.trim(n(this).text()),c)>-1||n.inArray(n.trim(n(this).val()),c)>-1?!0:!1:!1:!0});(t[e.p.id].checkOnSubmit===!0||t[e.p.id].checkOnUpdate)&&(f=n("#"+o,u).val(),h[s].editoptions.multiple&&(f=f.join(",")),e.p.savedData[o]=f);break;case"checkbox":f=String(f);h[s].editoptions&&h[s].editoptions.value?(l=h[s].editoptions.value.split(":"),l[0]===f?n("#"+o,u)[e.p.useProp?"prop":"attr"]({checked:!0,defaultChecked:!0}):n("#"+o,u)[e.p.useProp?"prop":"attr"]({checked:!1,defaultChecked:!1})):(f=f.toLowerCase(),f.search(/(false|f|0|no|n|off|undefined)/i)<0&&f!==""?(n("#"+o,u)[e.p.useProp?"prop":"attr"]("checked",!0),n("#"+o,u)[e.p.useProp?"prop":"attr"]("defaultChecked",!0)):(n("#"+o,u)[e.p.useProp?"prop":"attr"]("checked",!1),n("#"+o,u)[e.p.useProp?"prop":"attr"]("defaultChecked",!1)));(t[e.p.id].checkOnSubmit===!0||t[e.p.id].checkOnUpdate)&&(f=n("#"+o,u).is(":checked")?n("#"+o,u).val():n("#"+o,u).attr("offval"),e.p.savedData[o]=f);break;case"custom":try{if(h[s].editoptions&&n.isFunction(h[s].editoptions.custom_value))h[s].editoptions.custom_value.call(e,n("#"+o,u),"set",f);else throw"e1";}catch(a){a==="e1"?n.jgrid.info_dialog(k.errcap,"function 'custom_value' "+t[n(this)[0]].p.msg.nodefined,n.rp_ge[n(this)[0]].p.bClose,{styleUI:t[n(this)[0]].p.styleUI}):n.jgrid.info_dialog(k.errcap,a.message,n.rp_ge[n(this)[0]].p.bClose,{styleUI:t[n(this)[0]].p.styleUI})}}p++}}),p>0&&(n("#id_g",y).val(i),(t[e.p.id].checkOnSubmit===!0||t[e.p.id].checkOnUpdate)&&(e.p.savedData[r.p.id+"_id"]=i)))}function ii(){n.each(e.p.colModel,function(n,t){t.editoptions&&t.editoptions.NullIfEmpty===!0&&o.hasOwnProperty(t.name)&&o[t.name]===""&&(o[t.name]="null")})}function it(){var d,i=[!0,"",""],g={},l=e.p.prmNames,f,w,nt,it,tt,rt,p=n(e).triggerHandler("jqGridAddEditBeforeCheckValues",[n(s),c]),ft,ut,v,b;p&&typeof p=="object"&&(o=p);n.isFunction(t[e.p.id].beforeCheckValues)&&(p=t[e.p.id].beforeCheckValues.call(e,o,n(s),c),p&&typeof p=="object"&&(o=p));for(nt in o)if(o.hasOwnProperty(nt)&&(i=n.jgrid.checkValues.call(e,o[nt],nt),i[0]===!1))break;if(ii(),i[0]&&(g=n(e).triggerHandler("jqGridAddEditClickSubmit",[t[e.p.id],o,c]),g===undefined&&n.isFunction(t[e.p.id].onclickSubmit)&&(g=t[e.p.id].onclickSubmit.call(e,t[e.p.id],o,c)||{}),i=n(e).triggerHandler("jqGridAddEditBeforeSubmit",[o,n(s),c]),i===undefined&&(i=[!0,"",""]),i[0]&&n.isFunction(t[e.p.id].beforeSubmit)&&(i=t[e.p.id].beforeSubmit.call(e,o,n(s),c))),i[0]&&!t[e.p.id].processing){if(t[e.p.id].processing=!0,n("#sData",y+"_2").addClass(u.active),rt=t[e.p.id].url||n(e).jqGrid("getGridParam","editurl"),w=l.oper,f=rt==="clientArray"?e.p.keyName:l.id,o[w]=n.trim(o[e.p.id+"_id"])==="_empty"?l.addoper:l.editoper,o[w]!==l.addoper?o[f]=o[e.p.id+"_id"]:o[f]===undefined&&(o[f]=o[e.p.id+"_id"]),delete o[e.p.id+"_id"],o=n.extend(o,t[e.p.id].editData,g),e.p.treeGrid===!0){o[w]===l.addoper&&(it=n(e).jqGrid("getGridParam","selrow"),ft=e.p.treeGridModel==="adjacency"?e.p.treeReader.parent_id_field:"parent_id",o[ft]=it);for(tt in e.p.treeReader)if(e.p.treeReader.hasOwnProperty(tt)&&(ut=e.p.treeReader[tt],o.hasOwnProperty(ut))){if(o[w]===l.addoper&&tt==="parent_id_field")continue;delete o[ut]}}o[f]=n.jgrid.stripPref(e.p.idPrefix,o[f]);v=n.extend({url:rt,type:t[e.p.id].mtype,data:n.isFunction(t[e.p.id].serializeEditData)?t[e.p.id].serializeEditData.call(e,o):o,complete:function(v,p){var b;if(n("#sData",y+"_2").removeClass(u.active),o[f]=e.p.idPrefix+o[f],v.status>=300&&v.status!==304?(i[0]=!1,i[1]=n(e).triggerHandler("jqGridAddEditErrorTextFormat",[v,c]),i[1]=n.isFunction(t[e.p.id].errorTextFormat)?t[e.p.id].errorTextFormat.call(e,v,c):p+" Status: '"+v.statusText+"'. Error code: "+v.status):(i=n(e).triggerHandler("jqGridAddEditAfterSubmit",[v,o,c]),i===undefined&&(i=[!0,"",""]),i[0]&&n.isFunction(t[e.p.id].afterSubmit)&&(i=t[e.p.id].afterSubmit.call(e,v,o,c))),i[0]===!1)n(".FormError",s).html(i[1]),n(".FormError",s).show();else if(e.p.autoencode&&n.each(o,function(t,i){o[t]=n.jgrid.htmlDecode(i)}),o[w]===l.addoper?(i[2]||(i[2]=n.jgrid.randId()),o[f]==null||o[f]==="_empty"||o[f]==""?o[f]=i[2]:i[2]=o[f],t[e.p.id].reloadAfterSubmit?n(e).trigger("reloadGrid"):e.p.treeGrid===!0?n(e).jqGrid("addChildNode",i[2],it,o):n(e).jqGrid("addRowData",i[2],o,r.addedrow),t[e.p.id].closeAfterAdd?(e.p.treeGrid!==!0&&n(e).jqGrid("setSelection",i[2]),n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form})):t[e.p.id].clearAfterAdd&&at("_empty",e,s)):(t[e.p.id].reloadAfterSubmit?(n(e).trigger("reloadGrid"),t[e.p.id].closeAfterEdit||setTimeout(function(){n(e).jqGrid("setSelection",o[f])},1e3)):e.p.treeGrid===!0?n(e).jqGrid("setTreeRow",o[f],o):n(e).jqGrid("setRowData",o[f],o),t[e.p.id].closeAfterEdit&&n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form})),n.isFunction(t[e.p.id].afterComplete)&&(d=v,setTimeout(function(){n(e).triggerHandler("jqGridAddEditAfterComplete",[d,o,n(s),c]);t[e.p.id].afterComplete.call(e,d,o,n(s),c);d=null},500)),(t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate)&&(n(s).data("disabled",!1),e.p.savedData[e.p.id+"_id"]!=="_empty"))for(b in e.p.savedData)e.p.savedData.hasOwnProperty(b)&&o[b]&&(e.p.savedData[b]=o[b]);t[e.p.id].processing=!1;try{n(":input:visible",s)[0].focus()}catch(k){}}},n.jgrid.ajaxOptions,t[e.p.id].ajaxEditOptions);v.url||t[e.p.id].useDataProxy||(n.isFunction(e.p.dataProxy)?t[e.p.id].useDataProxy=!0:(i[0]=!1,i[1]+=" "+k.nourl));i[0]&&(t[e.p.id].useDataProxy?(b=e.p.dataProxy.call(e,v,"set_"+e.p.id),b===undefined&&(b=[!0,""]),b[0]===!1?(i[0]=!1,i[1]=b[1]||"Error deleting the selected row!"):(v.data.oper===l.addoper&&t[e.p.id].closeAfterAdd&&n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),v.data.oper===l.editoper&&t[e.p.id].closeAfterEdit&&n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}))):v.url==="clientArray"?(t[e.p.id].reloadAfterSubmit=!1,o=v.data,v.complete({status:200,statusText:""},"")):n.ajax(v))}i[0]===!1&&(n(".FormError",s).html(i[1]),n(".FormError",s).show())}function ni(t,i){var r=!1,u;if(r=!(n.isPlainObject(t)&&n.isPlainObject(i)&&Object.getOwnPropertyNames(t).length===Object.getOwnPropertyNames(i).length),!r)for(u in i)if(i.hasOwnProperty(u))if(t.hasOwnProperty(u)){if(t[u]!==i[u]){r=!0;break}}else{r=!0;break}return r}function w(){var i=!0;return n(".FormError",s).hide(),t[e.p.id].checkOnUpdate&&(o={},gt(),nt=ni(o,e.p.savedData),nt&&(n(s).data("disabled",!0),n(".confirm","#"+h.themodal).show(),i=!1)),i}function ri(){var t;if(i!=="_empty"&&e.p.savedRow!==undefined&&e.p.savedRow.length>0&&n.isFunction(n.fn.jqGrid.restoreRow))for(t=0;t<e.p.savedRow.length;t++)if(e.p.savedRow[t].id===i){n(e).jqGrid("restoreRow",i);break}}function vt(t,i){var r=i[1].length-1;t===0?n("#pData",l).addClass(u.disabled):i[1][t-1]!==undefined&&n("#"+n.jgrid.jqID(i[1][t-1])).hasClass(u.disabled)?n("#pData",l).addClass(u.disabled):n("#pData",l).removeClass(u.disabled);t===r?n("#nData",l).addClass(u.disabled):i[1][t+1]!==undefined&&n("#"+n.jgrid.jqID(i[1][t+1])).hasClass(u.disabled)?n("#nData",l).addClass(u.disabled):n("#nData",l).removeClass(u.disabled)}function yt(){var i=n(e).jqGrid("getDataIDs"),o=n("#id_g",y).val(),u,f,r,s;if(e.p.multiselect&&t[e.p.id].editselected){for(f=[],r=0,s=i.length;r<s;r++)n.inArray(i[r],e.p.selarrrow)!==-1&&f.push(i[r]);return u=n.inArray(o,f),[u,f]}return u=n.inArray(o,i),[u,i]}function ui(n){var t="";return typeof n=="string"&&(t=n.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(n,t){return'<span id="'+t+'" ><\/span>'})),t}function pt(){var u,i,r,f;if(t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate){u=[];i={};u=n.map(e.p.savedData,function(n,t){return t});n(".FormElement",v).each(function(){if(u.indexOf(this.name)===-1){var t=n(this).val(),r=n(this).get(0).type;if(r==="checkbox")n(this).is(":checked")||(t=n(this).attr("offval"));else if(r==="select-multiple")t=t.join(",");else if(r==="radio"){if(i.hasOwnProperty(this.name))return!0;i[this.name]=n(this).attr("offval")===undefined?"off":n(this).attr("offval")}e.p.savedData[this.name]=t}});for(r in i)i.hasOwnProperty(r)&&(f=n('input[name="'+r+'"]:checked',v).val(),e.p.savedData[r]=f!==undefined?f:i[r])}}var e=this,lt,et,kt,ot,st,dt;if(e.grid&&i){e.p.savedData={};var a=e.p.id,s="FrmGrid_"+a,g="TblGrid_"+a,y="#"+n.jgrid.jqID(g),l,h={themodal:"editmod"+a,modalhead:"edithd"+a,modalcontent:"editcnt"+a,scrollelm:s},p=!0,ht=1,ct=0,o,nt,c,tt=typeof t[e.p.id].template=="string"&&t[e.p.id].template.length>0,k=n.jgrid.getRegional(this,"errors");t[e.p.id].styleUI=e.p.styleUI||"jQueryUI";n.jgrid.isMobile()&&(t[e.p.id].resize=!1);i==="new"?(i="_empty",c="add",r.caption=t[e.p.id].addCaption):(r.caption=t[e.p.id].editCaption,c="edit");r.recreateForm||n(e).data("formProp")&&n.extend(t[n(this)[0].p.id],n(e).data("formProp"));lt=!0;r.checkOnUpdate&&r.jqModal&&!r.modal&&(lt=!1);var fi=isNaN(t[n(this)[0].p.id].dataheight)?t[n(this)[0].p.id].dataheight:t[n(this)[0].p.id].dataheight+"px",ei=isNaN(t[n(this)[0].p.id].datawidth)?t[n(this)[0].p.id].datawidth:t[n(this)[0].p.id].datawidth+"px",v=n("<form name='FormPost' id='"+s+"' class='FormGrid' onSubmit='return false;' style='width:"+ei+";height:"+fi+";'><\/form>").data("disabled",!1),b;if(tt?(b=ui(t[n(this)[0].p.id].template),l=y):(b=n("<table id='"+g+"' class='EditTable ui-common-table'><tbody><\/tbody><\/table>"),l=y+"_2"),s="#"+n.jgrid.jqID(s),n(v).append("<div class='FormError "+u.error+"' style='display:none;'><\/div>"),n(v).append("<div class='tinfo topinfo'>"+t[e.p.id].topinfo+"<\/div>"),n(e.p.colModel).each(function(){var n=this.formoptions;ht=Math.max(ht,n?n.colpos||0:0);ct=Math.max(ct,n?n.rowpos||0:0)}),n(v).append(b),p=n(e).triggerHandler("jqGridAddEditBeforeInitData",[v,c]),p===undefined&&(p=!0),p&&n.isFunction(t[e.p.id].beforeInitData)&&(p=t[e.p.id].beforeInitData.call(e,v,c)),p!==!1){ri();ti(i,e,b,ht);var rt=e.p.direction==="rtl"?!0:!1,oi=rt?"nData":"pData",si=rt?"pData":"nData",wt="<a id='"+oi+"' class='fm-button "+u.button+"'><span class='"+u.icon_base+" "+f.icon_prev+"'><\/span><\/a>",d="<a id='"+si+"' class='fm-button "+u.button+"'><span class='"+u.icon_base+" "+f.icon_next+"'><\/span><\/a>",ut="<a id='sData' class='fm-button "+u.button+"'>"+r.bSubmit+"<\/a>",ft="<a id='cData' class='fm-button "+u.button+"'>"+r.bCancel+"<\/a>",bt="<table style='height:auto' class='EditTable ui-common-table' id='"+g+"_2'><tbody><tr><td colspan='2'><hr class='"+u.content+"' style='margin:1px'/><\/td><\/tr><tr id='Act_Buttons'><td class='navButton'>"+(rt?d+wt:wt+d)+"<\/td><td class='EditButton'>"+ut+ft+"<\/td><\/tr>";bt+="<\/tbody><\/table>";ct>0&&(et=[],n.each(n(b)[0].rows,function(n,t){et[n]=t}),et.sort(function(n,t){return n.rp>t.rp?1:n.rp<t.rp?-1:0}),n.each(et,function(t,i){n("tbody",b).append(i)}));r.gbox="#gbox_"+n.jgrid.jqID(a);kt=!1;r.closeOnEscape===!0&&(r.closeOnEscape=!1,kt=!0);tt?(n(v).find("#pData").replaceWith(wt),n(v).find("#nData").replaceWith(d),n(v).find("#sData").replaceWith(ut),n(v).find("#cData").replaceWith(ft),ot=n("<div id="+g+"><\/div>").append(v)):ot=n("<div><\/div>").append(v).append(bt);n(v).append("<div class='binfo topinfo bottominfo'>"+t[e.p.id].bottominfo+"<\/div>");n.jgrid.createModal(h,ot,t[n(this)[0].p.id],"#gview_"+n.jgrid.jqID(e.p.id),n("#gbox_"+n.jgrid.jqID(e.p.id))[0]);rt&&(n("#pData, #nData",y+"_2").css("float","right"),n(".EditButton",y+"_2").css("text-align","left"));t[e.p.id].topinfo&&n(".tinfo",s).show();t[e.p.id].bottominfo&&n(".binfo",s).show();ot=null;bt=null;n("#"+n.jgrid.jqID(h.themodal)).keydown(function(i){var u=i.target;if(n(s).data("disabled")===!0)return!1;if(t[e.p.id].savekey[0]===!0&&i.which===t[e.p.id].savekey[1]&&u.tagName!=="TEXTAREA")return n("#sData",y+"_2").trigger("click"),!1;if(i.which===27)return w()?(kt&&n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:r.gbox,jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1):!1;if(t[e.p.id].navkeys[0]===!0){if(n("#id_g",y).val()==="_empty")return!0;if(i.which===t[e.p.id].navkeys[1])return n("#pData",l).trigger("click"),!1;if(i.which===t[e.p.id].navkeys[2])return n("#nData",l).trigger("click"),!1}});r.checkOnUpdate&&(n("a.ui-jqdialog-titlebar-close span","#"+n.jgrid.jqID(h.themodal)).removeClass("jqmClose"),n("a.ui-jqdialog-titlebar-close","#"+n.jgrid.jqID(h.themodal)).off("click").click(function(){return w()?(n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1):!1}));r.saveicon=n.extend([!0,"left",f.icon_save],r.saveicon);r.closeicon=n.extend([!0,"left",f.icon_close],r.closeicon);r.saveicon[0]===!0&&n("#sData",l).addClass(r.saveicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+u.icon_base+" "+r.saveicon[2]+"'><\/span>");r.closeicon[0]===!0&&n("#cData",l).addClass(r.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+u.icon_base+" "+r.closeicon[2]+"'><\/span>");(t[e.p.id].checkOnSubmit||t[e.p.id].checkOnUpdate)&&(ut="<a id='sNew' class='fm-button "+u.button+"' style='z-index:1002'>"+r.bYes+"<\/a>",d="<a id='nNew' class='fm-button "+u.button+"' style='z-index:1002;margin-left:5px'>"+r.bNo+"<\/a>",ft="<a id='cNew' class='fm-button "+u.button+"' style='z-index:1002;margin-left:5px;'>"+r.bExit+"<\/a>",st=r.zIndex||999,st++,n("<div class='"+r.overlayClass+" jqgrid-overlay confirm' style='z-index:"+st+";display:none;'>&#160;<\/div><div class='confirm ui-jqconfirm "+u.content+"' style='z-index:"+(st+1)+"'>"+r.saveData+"<br/><br/>"+ut+d+ft+"<\/div>").insertAfter(s),n("#sNew","#"+n.jgrid.jqID(h.themodal)).click(function(){return it(),n(s).data("disabled",!1),n(".confirm","#"+n.jgrid.jqID(h.themodal)).hide(),!1}),n("#nNew","#"+n.jgrid.jqID(h.themodal)).click(function(){return n(".confirm","#"+n.jgrid.jqID(h.themodal)).hide(),n(s).data("disabled",!1),setTimeout(function(){n(":input:visible",s)[0].focus()},0),!1}),n("#cNew","#"+n.jgrid.jqID(h.themodal)).click(function(){return n(".confirm","#"+n.jgrid.jqID(h.themodal)).hide(),n(s).data("disabled",!1),n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1}));n(e).triggerHandler("jqGridAddEditInitializeForm",[n(s),c]);n.isFunction(t[e.p.id].onInitializeForm)&&t[e.p.id].onInitializeForm.call(e,n(s),c);i!=="_empty"&&t[e.p.id].viewPagerButtons?n("#pData,#nData",l).show():n("#pData,#nData",l).hide();n(e).triggerHandler("jqGridAddEditBeforeShowForm",[n(s),c]);n.isFunction(t[e.p.id].beforeShowForm)&&t[e.p.id].beforeShowForm.call(e,n(s),c);pt();n("#"+n.jgrid.jqID(h.themodal)).data("onClose",t[e.p.id].onClose);n.jgrid.viewModal("#"+n.jgrid.jqID(h.themodal),{gbox:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,overlay:r.overlay,modal:r.modal,overlayClass:r.overlayClass,focusField:r.focusField,onHide:function(t){var i=n("#editmod"+a)[0].style.height,r=n("#editmod"+a)[0].style.width;i.indexOf("px")>-1&&(i=parseFloat(i));r.indexOf("px")>-1&&(r=parseFloat(r));n(e).data("formProp",{top:parseFloat(n(t.w).css("top")),left:parseFloat(n(t.w).css("left")),width:r,height:i,dataheight:n(s).height(),datawidth:n(s).width()});t.w.remove();t.o&&t.o.remove()}});lt||n("."+n.jgrid.jqID(r.overlayClass)).click(function(){return w()?(n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1):!1});n(".fm-button","#"+n.jgrid.jqID(h.themodal)).hover(function(){n(this).addClass(u.hover)},function(){n(this).removeClass(u.hover)});n("#sData",l).click(function(){return o={},n(".FormError",s).hide(),gt(),o[e.p.id+"_id"]==="_empty"?it():r.checkOnSubmit===!0?(nt=ni(o,e.p.savedData),nt?(n(s).data("disabled",!0),n(".confirm","#"+n.jgrid.jqID(h.themodal)).show()):it()):it(),!1});n("#cData",l).click(function(){return w()?(n.jgrid.hideModal("#"+n.jgrid.jqID(h.themodal),{gb:"#gbox_"+n.jgrid.jqID(a),jqm:r.jqModal,onClose:t[e.p.id].onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1):!1});n("#nData",l).click(function(){var i,f;if(!w())return!1;if(n(".FormError",s).hide(),i=yt(),i[0]=parseInt(i[0],10),i[0]!==-1&&i[1][i[0]+1]){if((n(e).triggerHandler("jqGridAddEditClickPgButtons",["next",n(s),i[1][i[0]]]),n.isFunction(r.onclickPgButtons)&&(f=r.onclickPgButtons.call(e,"next",n(s),i[1][i[0]]),f!==undefined&&f===!1))||n("#"+n.jgrid.jqID(i[1][i[0]+1])).hasClass(u.disabled))return!1;at(i[1][i[0]+1],e,s);e.p.multiselect&&t[e.p.id].editselected||n(e).jqGrid("setSelection",i[1][i[0]+1]);n(e).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",n(s),i[1][i[0]]]);n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons.call(e,"next",n(s),i[1][i[0]+1]);pt();vt(i[0]+1,i)}return!1});n("#pData",l).click(function(){var i,f;if(!w())return!1;if(n(".FormError",s).hide(),i=yt(),i[0]!==-1&&i[1][i[0]-1]){if((n(e).triggerHandler("jqGridAddEditClickPgButtons",["prev",n(s),i[1][i[0]]]),n.isFunction(r.onclickPgButtons)&&(f=r.onclickPgButtons.call(e,"prev",n(s),i[1][i[0]]),f!==undefined&&f===!1))||n("#"+n.jgrid.jqID(i[1][i[0]-1])).hasClass(u.disabled))return!1;at(i[1][i[0]-1],e,s);e.p.multiselect&&t[e.p.id].editselected||n(e).jqGrid("setSelection",i[1][i[0]-1]);n(e).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",n(s),i[1][i[0]]]);n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons.call(e,"prev",n(s),i[1][i[0]-1]);pt();vt(i[0]-1,i)}return!1});n(e).triggerHandler("jqGridAddEditAfterShowForm",[n(s),c]);n.isFunction(t[e.p.id].afterShowForm)&&t[e.p.id].afterShowForm.call(e,n(s),c);dt=yt();vt(dt[0],dt)}}})},viewGridRow:function(i,r){var o=n.jgrid.getRegional(this[0],"view"),e=this[0].p.styleUI,f=n.jgrid.styleUI[e].formedit,u=n.jgrid.styleUI[e].common;return r=n.extend(!0,{top:0,left:0,width:500,datawidth:"auto",height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,recreateForm:!1,removemodal:!0,form:"view"},o,r||{}),t[n(this)[0].p.id]=r,this.each(function(){function b(){(t[e.p.id].closeOnEscape===!0||t[e.p.id].navkeys[0]===!0)&&setTimeout(function(){n(".ui-jqdialog-titlebar-close","#"+n.jgrid.jqID(c.modalhead)).attr("tabindex","-1").focus()},0)}function st(t,i,f,e){for(var s,h,o,c=0,l,d,g=[],a=!1,it="<td class='CaptionTD form-view-label "+u.content+"' width='"+r.labelswidth+"'>&#160;<\/td><td class='DataTD form-view-data ui-helper-reset "+u.content+"'>&#160;<\/td>",nt="",rt="<td class='CaptionTD form-view-label "+u.content+"'>&#160;<\/td><td class='DataTD form-view-data "+u.content+"'>&#160;<\/td>",ut=["integer","number","currency"],y=0,p=0,w,b,tt,k,v=1;v<=e;v++)nt+=v===1?it:rt;return n(i.p.colModel).each(function(){h=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1;h||this.align!=="right"||(this.formatter&&n.inArray(this.formatter,ut)!==-1?y=Math.max(y,parseInt(this.width,10)):p=Math.max(p,parseInt(this.width,10)))}),w=y!==0?y:p!==0?p:0,a=n(i).jqGrid("getInd",t),n(i.p.colModel).each(function(t){var y;if(s=this.name,b=!1,h=this.editrules&&this.editrules.edithidden===!0?!1:this.hidden===!0?!0:!1,d=h?"style='display:none'":"",tt=typeof this.viewable!="boolean"?!0:this.viewable,s!=="cb"&&s!=="subgrid"&&s!=="rn"&&tt){l=a===!1?"":s===i.p.ExpandColumn&&i.p.treeGrid===!0?n("td:eq("+t+")",i.rows[a]).text():n("td:eq("+t+")",i.rows[a]).html();b=this.align==="right"&&w!==0?!0:!1;var r=n.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),u=parseInt(r.rowpos,10)||c+1,v=parseInt((parseInt(r.colpos,10)||1)*2,10);r.rowabove&&(y=n("<tr><td class='contentinfo' colspan='"+e*2+"'>"+r.rowcontent+"<\/td><\/tr>"),n(f).append(y),y[0].rp=u);o=n(f).find("tr[rowpos="+u+"]");o.length===0&&(o=n("<tr "+d+" rowpos='"+u+"'><\/tr>").addClass("FormData").attr("id","trv_"+s),n(o).append(nt),n(f).append(o),o[0].rp=u);n("td:eq("+(v-2)+")",o[0]).html("<b>"+(r.label===undefined?i.p.colNames[t]:r.label)+"<\/b>");n("td:eq("+(v-1)+")",o[0]).append("<span>"+l+"<\/span>").attr("id","v_"+s);b&&n("td:eq("+(v-1)+") span",o[0]).css({"text-align":"right",width:w+"px"});g[c]=t;c++}}),c>0&&(k=n("<tr class='FormData' style='display:none'><td class='CaptionTD'><\/td><td colspan='"+(e*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/><\/td><\/tr>"),k[0].rp=c+99,n(f).append(k)),g}function rt(t,i){var r,u,s=0,f,e;(e=n(i).jqGrid("getInd",t,!0),e)&&(n("td",e).each(function(t){r=i.p.colModel[t].name;u=i.p.colModel[t].editrules&&i.p.colModel[t].editrules.edithidden===!0?!1:i.p.colModel[t].hidden===!0?!0:!1;r!=="cb"&&r!=="subgrid"&&r!=="rn"&&(f=r===i.p.ExpandColumn&&i.p.treeGrid===!0?n(this).text():n(this).html(),r=n.jgrid.jqID("v_"+r),n("#"+r+" span","#"+o).html(f),u&&n("#"+r,"#"+o).parents("tr:first").hide(),s++)}),s>0&&n("#id_g","#"+o).val(t))}function k(t,i){var r=i[1].length-1;t===0?n("#pData","#"+o+"_2").addClass(u.disabled):i[1][t-1]!==undefined&&n("#"+n.jgrid.jqID(i[1][t-1])).hasClass(u.disabled)?n("#pData",o+"_2").addClass(u.disabled):n("#pData","#"+o+"_2").removeClass(u.disabled);t===r?n("#nData","#"+o+"_2").addClass(u.disabled):i[1][t+1]!==undefined&&n("#"+n.jgrid.jqID(i[1][t+1])).hasClass(u.disabled)?n("#nData",o+"_2").addClass(u.disabled):n("#nData","#"+o+"_2").removeClass(u.disabled)}function d(){var t=n(e).jqGrid("getDataIDs"),i=n("#id_g","#"+o).val(),r=n.inArray(i,t);return[r,t]}var e=this,y,nt,tt;if(e.grid&&i){var s=e.p.id,h="ViewGrid_"+n.jgrid.jqID(s),o="ViewTbl_"+n.jgrid.jqID(s),et="ViewGrid_"+s,ot="ViewTbl_"+s,c={themodal:"viewmod"+s,modalhead:"viewhd"+s,modalcontent:"viewcnt"+s,scrollelm:h},it=n.isFunction(t[e.p.id].beforeInitData)?t[e.p.id].beforeInitData:!1,l=!0,p=1,w=0;t[e.p.id].styleUI=e.p.styleUI||"jQueryUI";r.recreateForm||n(e).data("viewProp")&&n.extend(t[n(this)[0].p.id],n(e).data("viewProp"));var ht=isNaN(t[n(this)[0].p.id].dataheight)?t[n(this)[0].p.id].dataheight:t[n(this)[0].p.id].dataheight+"px",ct=isNaN(t[n(this)[0].p.id].datawidth)?t[n(this)[0].p.id].datawidth:t[n(this)[0].p.id].datawidth+"px",g=n("<form name='FormPost' id='"+et+"' class='FormGrid' style='width:"+ct+";height:"+ht+";'><\/form>"),a=n("<table id='"+ot+"' class='EditTable ViewTable'><tbody><\/tbody><\/table>");if(n(e.p.colModel).each(function(){var n=this.formoptions;p=Math.max(p,n?n.colpos||0:0);w=Math.max(w,n?n.rowpos||0:0)}),n(g).append(a),it&&(l=it.call(e,g),l===undefined&&(l=!0)),l!==!1){st(i,e,a,p);var v=e.p.direction==="rtl"?!0:!1,lt=v?"nData":"pData",at=v?"pData":"nData",ut="<a id='"+lt+"' class='fm-button "+u.button+"'><span class='"+u.icon_base+" "+f.icon_prev+"'><\/span><\/a>",ft="<a id='"+at+"' class='fm-button "+u.button+"'><span class='"+u.icon_base+" "+f.icon_next+"'><\/span><\/a>",vt="<a id='cData' class='fm-button "+u.button+"'>"+r.bClose+"<\/a>";w>0&&(y=[],n.each(n(a)[0].rows,function(n,t){y[n]=t}),y.sort(function(n,t){return n.rp>t.rp?1:n.rp<t.rp?-1:0}),n.each(y,function(t,i){n("tbody",a).append(i)}));r.gbox="#gbox_"+n.jgrid.jqID(s);nt=n("<div><\/div>").append(g).append("<table border='0' class='EditTable' id='"+o+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+r.labelswidth+"'>"+(v?ft+ut:ut+ft)+"<\/td><td class='EditButton'>"+vt+"<\/td><\/tr><\/tbody><\/table>");n.jgrid.createModal(c,nt,t[n(this)[0].p.id],"#gview_"+n.jgrid.jqID(e.p.id),n("#gview_"+n.jgrid.jqID(e.p.id))[0]);v&&(n("#pData, #nData","#"+o+"_2").css("float","right"),n(".EditButton","#"+o+"_2").css("text-align","left"));r.viewPagerButtons||n("#pData, #nData","#"+o+"_2").hide();nt=null;n("#"+c.themodal).keydown(function(i){if(i.which===27)return t[e.p.id].closeOnEscape&&n.jgrid.hideModal("#"+n.jgrid.jqID(c.themodal),{gb:r.gbox,jqm:r.jqModal,onClose:r.onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1;if(r.navkeys[0]===!0){if(i.which===r.navkeys[1])return n("#pData","#"+o+"_2").trigger("click"),!1;if(i.which===r.navkeys[2])return n("#nData","#"+o+"_2").trigger("click"),!1}});r.closeicon=n.extend([!0,"left",f.icon_close],r.closeicon);r.closeicon[0]===!0&&n("#cData","#"+o+"_2").addClass(r.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+u.icon_base+" "+r.closeicon[2]+"'><\/span>");n.isFunction(r.beforeShowForm)&&r.beforeShowForm.call(e,n("#"+h));n.jgrid.viewModal("#"+n.jgrid.jqID(c.themodal),{gbox:"#gbox_"+n.jgrid.jqID(s),jqm:r.jqModal,overlay:r.overlay,modal:r.modal,onHide:function(t){n(e).data("viewProp",{top:parseFloat(n(t.w).css("top")),left:parseFloat(n(t.w).css("left")),width:n(t.w).width(),height:n(t.w).height(),dataheight:n("#"+h).height(),datawidth:n("#"+h).width()});t.w.remove();t.o&&t.o.remove()}});n(".fm-button:not(."+u.disabled+")","#"+o+"_2").hover(function(){n(this).addClass(u.hover)},function(){n(this).removeClass(u.hover)});b();n("#cData","#"+o+"_2").click(function(){return n.jgrid.hideModal("#"+n.jgrid.jqID(c.themodal),{gb:"#gbox_"+n.jgrid.jqID(s),jqm:r.jqModal,onClose:r.onClose,removemodal:t[e.p.id].removemodal,formprop:!t[e.p.id].recreateForm,form:t[e.p.id].form}),!1});n("#nData","#"+o+"_2").click(function(){n("#FormError","#"+o).hide();var t=d();return t[0]=parseInt(t[0],10),t[0]!==-1&&t[1][t[0]+1]&&(n.isFunction(r.onclickPgButtons)&&r.onclickPgButtons.call(e,"next",n("#"+h),t[1][t[0]]),rt(t[1][t[0]+1],e),n(e).jqGrid("setSelection",t[1][t[0]+1]),n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons.call(e,"next",n("#"+h),t[1][t[0]+1]),k(t[0]+1,t)),b(),!1});n("#pData","#"+o+"_2").click(function(){n("#FormError","#"+o).hide();var t=d();return t[0]!==-1&&t[1][t[0]-1]&&(n.isFunction(r.onclickPgButtons)&&r.onclickPgButtons.call(e,"prev",n("#"+h),t[1][t[0]]),rt(t[1][t[0]-1],e),n(e).jqGrid("setSelection",t[1][t[0]-1]),n.isFunction(r.afterclickPgButtons)&&r.afterclickPgButtons.call(e,"prev",n("#"+h),t[1][t[0]-1]),k(t[0]-1,t)),b(),!1});tt=d();k(tt[0],tt)}}})},delGridRow:function(i,r){var o=n.jgrid.getRegional(this[0],"del"),f=this[0].p.styleUI,e=n.jgrid.styleUI[f].formedit,u=n.jgrid.styleUI[f].common;return r=n.extend(!0,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:30,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},o,r||{}),t[n(this)[0].p.id]=r,this.each(function(){var f=this,g,nt;if(f.grid&&i){var w=n.isFunction(t[f.p.id].beforeShowForm),b=n.isFunction(t[f.p.id].afterShowForm),v=n.isFunction(t[f.p.id].beforeInitData)?t[f.p.id].beforeInitData:!1,s=f.p.id,p={},h=!0,o="DelTbl_"+n.jgrid.jqID(s),a,k,y,d,tt="DelTbl_"+s,c={themodal:"delmod"+s,modalhead:"delhd"+s,modalcontent:"delcnt"+s,scrollelm:o};if(t[f.p.id].styleUI=f.p.styleUI||"jQueryUI",n.isArray(i)&&(i=i.join()),n("#"+n.jgrid.jqID(c.themodal))[0]!==undefined){if(v&&(h=v.call(f,n("#"+o)),h===undefined&&(h=!0)),h===!1)return;n("#DelData>td","#"+o).text(i);n("#DelError","#"+o).hide();t[f.p.id].processing===!0&&(t[f.p.id].processing=!1,n("#dData","#"+o).removeClass(u.active));w&&t[f.p.id].beforeShowForm.call(f,n("#"+o));n.jgrid.viewModal("#"+n.jgrid.jqID(c.themodal),{gbox:"#gbox_"+n.jgrid.jqID(s),jqm:t[f.p.id].jqModal,jqM:!1,overlay:t[f.p.id].overlay,modal:t[f.p.id].modal});b&&t[f.p.id].afterShowForm.call(f,n("#"+o))}else{var it=isNaN(t[f.p.id].dataheight)?t[f.p.id].dataheight:t[f.p.id].dataheight+"px",rt=isNaN(r.datawidth)?r.datawidth:r.datawidth+"px",l="<div id='"+tt+"' class='formdata' style='width:"+rt+";overflow:auto;position:relative;height:"+it+";'>";if(l+="<table class='DelTable'><tbody>",l+="<tr id='DelError' style='display:none'><td class='"+u.error+"'><\/td><\/tr>",l+="<tr id='DelData' style='display:none'><td >"+i+"<\/td><\/tr>",l+='<tr><td class="delmsg" style="white-space:pre;">'+t[f.p.id].msg+"<\/td><\/tr><tr><td >&#160;<\/td><\/tr>",l+="<\/tbody><\/table><\/div>",g="<a id='dData' class='fm-button "+u.button+"'>"+r.bSubmit+"<\/a>",nt="<a id='eData' class='fm-button "+u.button+"'>"+r.bCancel+"<\/a>",l+="<table class='EditTable ui-common-table' id='"+o+"_2'><tbody><tr><td><hr class='"+u.content+"' style='margin:1px'/><\/td><\/tr><tr><td class='DelButton EditButton'>"+g+"&#160;"+nt+"<\/td><\/tr><\/tbody><\/table>",r.gbox="#gbox_"+n.jgrid.jqID(s),n.jgrid.createModal(c,l,t[f.p.id],"#gview_"+n.jgrid.jqID(f.p.id),n("#gview_"+n.jgrid.jqID(f.p.id))[0]),v&&(h=v.call(f,n(l)),h===undefined&&(h=!0)),h===!1)return;n(".fm-button","#"+o+"_2").hover(function(){n(this).addClass(u.hover)},function(){n(this).removeClass(u.hover)});r.delicon=n.extend([!0,"left",e.icon_del],t[f.p.id].delicon);r.cancelicon=n.extend([!0,"left",e.icon_cancel],t[f.p.id].cancelicon);r.delicon[0]===!0&&n("#dData","#"+o+"_2").addClass(r.delicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+u.icon_base+" "+r.delicon[2]+"'><\/span>");r.cancelicon[0]===!0&&n("#eData","#"+o+"_2").addClass(r.cancelicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+u.icon_base+" "+r.cancelicon[2]+"'><\/span>");n("#dData","#"+o+"_2").click(function(){var i=[!0,""],v,e=n("#DelData>td","#"+o).text(),h,l;if(p={},n.isFunction(t[f.p.id].onclickSubmit)&&(p=t[f.p.id].onclickSubmit.call(f,t[f.p.id],e)||{}),n.isFunction(t[f.p.id].beforeSubmit)&&(i=t[f.p.id].beforeSubmit.call(f,e)),i[0]&&!t[f.p.id].processing){if(t[f.p.id].processing=!0,y=f.p.prmNames,a=n.extend({},t[f.p.id].delData,p),d=y.oper,a[d]=y.deloper,k=y.id,e=String(e).split(","),!e.length)return!1;for(v in e)e.hasOwnProperty(v)&&(e[v]=n.jgrid.stripPref(f.p.idPrefix,e[v]));a[k]=e.join();n(this).addClass(u.active);h=n.extend({url:t[f.p.id].url||n(f).jqGrid("getGridParam","editurl"),type:t[f.p.id].mtype,data:n.isFunction(t[f.p.id].serializeDelData)?t[f.p.id].serializeDelData.call(f,a):a,complete:function(h,l){var v;if(n("#dData","#"+o+"_2").removeClass(u.active),h.status>=300&&h.status!==304?(i[0]=!1,i[1]=n.isFunction(t[f.p.id].errorTextFormat)?t[f.p.id].errorTextFormat.call(f,h):l+" Status: '"+h.statusText+"'. Error code: "+h.status):n.isFunction(t[f.p.id].afterSubmit)&&(i=t[f.p.id].afterSubmit.call(f,h,a)),i[0]===!1)n("#DelError>td","#"+o).html(i[1]),n("#DelError","#"+o).show();else{if(t[f.p.id].reloadAfterSubmit&&f.p.datatype!=="local")n(f).trigger("reloadGrid");else{if(f.p.treeGrid===!0)try{n(f).jqGrid("delTreeNode",f.p.idPrefix+e[0])}catch(y){}else for(v=0;v<e.length;v++)n(f).jqGrid("delRowData",f.p.idPrefix+e[v]);f.p.selrow=null;f.p.selarrrow=[]}n.isFunction(t[f.p.id].afterComplete)&&setTimeout(function(){t[f.p.id].afterComplete.call(f,h,e)},500)}t[f.p.id].processing=!1;i[0]&&n.jgrid.hideModal("#"+n.jgrid.jqID(c.themodal),{gb:"#gbox_"+n.jgrid.jqID(s),jqm:r.jqModal,onClose:t[f.p.id].onClose})}},n.jgrid.ajaxOptions,t[f.p.id].ajaxDelOptions);h.url||t[f.p.id].useDataProxy||(n.isFunction(f.p.dataProxy)?t[f.p.id].useDataProxy=!0:(i[0]=!1,i[1]+=" "+n.jgrid.getRegional(f,"errors.nourl")));i[0]&&(t[f.p.id].useDataProxy?(l=f.p.dataProxy.call(f,h,"del_"+f.p.id),l===undefined&&(l=[!0,""]),l[0]===!1?(i[0]=!1,i[1]=l[1]||"Error deleting the selected row!"):n.jgrid.hideModal("#"+n.jgrid.jqID(c.themodal),{gb:"#gbox_"+n.jgrid.jqID(s),jqm:r.jqModal,onClose:t[f.p.id].onClose})):h.url==="clientArray"?(a=h.data,h.complete({status:200,statusText:""},"")):n.ajax(h))}return i[0]===!1&&(n("#DelError>td","#"+o).html(i[1]),n("#DelError","#"+o).show()),!1});n("#eData","#"+o+"_2").click(function(){return n.jgrid.hideModal("#"+n.jgrid.jqID(c.themodal),{gb:"#gbox_"+n.jgrid.jqID(s),jqm:t[f.p.id].jqModal,onClose:t[f.p.id].onClose}),!1});w&&t[f.p.id].beforeShowForm.call(f,n("#"+o));n.jgrid.viewModal("#"+n.jgrid.jqID(c.themodal),{gbox:"#gbox_"+n.jgrid.jqID(s),jqm:t[f.p.id].jqModal,overlay:t[f.p.id].overlay,modal:t[f.p.id].modal});b&&t[f.p.id].afterShowForm.call(f,n("#"+o))}t[f.p.id].closeOnEscape===!0&&setTimeout(function(){n(".ui-jqdialog-titlebar-close","#"+n.jgrid.jqID(c.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(t,i,r,u,f,e,o){var l=n.jgrid.getRegional(this[0],"nav"),c=this[0].p.styleUI,h=n.jgrid.styleUI[c].navigator,s=n.jgrid.styleUI[c].common;return i=n.extend({edit:!0,editicon:h.icon_edit_nav,add:!0,addicon:h.icon_add_nav,del:!0,delicon:h.icon_del_nav,search:!0,searchicon:h.icon_search_nav,refresh:!0,refreshicon:h.icon_refresh_nav,refreshstate:"firstpage",view:!1,viewicon:h.icon_view_nav,position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null,dropmenu:!1,navButtonText:""},l,i||{}),this.each(function(){var d,a,g,it,h,v,y,rt,w,p;if(!this.p.navGrid&&(d={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},a=this,a.grid&&typeof t=="string")){n(a).data("navGrid")||n(a).data("navGrid",i);h=n(a).data("navGrid");a.p.force_regional&&(h=n.extend(h,l));n("#"+d.themodal)[0]===undefined&&(h.alerttop||h.alertleft||(window.innerWidth!==undefined?(h.alertleft=window.innerWidth,h.alerttop=window.innerHeight):document.documentElement!==undefined&&document.documentElement.clientWidth!==undefined&&document.documentElement.clientWidth!==0?(h.alertleft=document.documentElement.clientWidth,h.alerttop=document.documentElement.clientHeight):(h.alertleft=1024,h.alerttop=768),h.alertleft=h.alertleft/2-parseInt(h.alertwidth,10)/2,h.alerttop=h.alerttop/2-25));var tt=1,nt,b=function(){n(this).hasClass(s.disabled)||n(this).addClass(s.hover)},k=function(){n(this).removeClass(s.hover)};for(h.cloneToTop&&a.p.toppager&&(tt=2),nt=0;nt<tt;nt++)y=n("<table class='ui-pg-table navtable ui-common-table'><tbody><tr><\/tr><\/tbody><\/table>"),rt="<td class='ui-pg-button "+s.disabled+"' style='width:4px;'><span class='ui-separator'><\/span><\/td>",nt===0?(w=t,p=a.p.id,w===a.p.toppager&&(p+="_top",tt=1)):(w=a.p.toppager,p=a.p.id+"_top"),a.p.direction==="rtl"&&n(y).attr("dir","rtl").css("float","right"),u=u||{},h.add&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.addicon+"'><\/span>"+h.addtext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.addtitle||"",id:u.id||"add_"+p}).click(function(){return n(this).hasClass(s.disabled)||(n.isFunction(h.addfunc)?h.addfunc.call(a):n(a).jqGrid("editGridRow","new",u)),!1}).hover(b,k),v=null),r=r||{},h.edit&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.editicon+"'><\/span>"+h.edittext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.edittitle||"",id:r.id||"edit_"+p}).click(function(){if(!n(this).hasClass(s.disabled)){var t=a.p.selrow;t?n.isFunction(h.editfunc)?h.editfunc.call(a,t):n(a).jqGrid("editGridRow",t,r):(n.jgrid.viewModal("#"+d.themodal,{gbox:"#gbox_"+n.jgrid.jqID(a.p.id),jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(b,k),v=null),o=o||{},h.view&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.viewicon+"'><\/span>"+h.viewtext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.viewtitle||"",id:o.id||"view_"+p}).click(function(){if(!n(this).hasClass(s.disabled)){var t=a.p.selrow;t?n.isFunction(h.viewfunc)?h.viewfunc.call(a,t):n(a).jqGrid("viewGridRow",t,o):(n.jgrid.viewModal("#"+d.themodal,{gbox:"#gbox_"+n.jgrid.jqID(a.p.id),jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(b,k),v=null),f=f||{},h.del&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.delicon+"'><\/span>"+h.deltext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.deltitle||"",id:f.id||"del_"+p}).click(function(){if(!n(this).hasClass(s.disabled)){var t;a.p.multiselect?(t=a.p.selarrrow,t.length===0&&(t=null)):t=a.p.selrow;t?n.isFunction(h.delfunc)?h.delfunc.call(a,t):n(a).jqGrid("delGridRow",t,f):(n.jgrid.viewModal("#"+d.themodal,{gbox:"#gbox_"+n.jgrid.jqID(a.p.id),jqm:!0}),n("#jqg_alrt").focus())}return!1}).hover(b,k),v=null),(h.add||h.edit||h.del||h.view)&&n("tr",y).append(rt),e=e||{},h.search&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.searchicon+"'><\/span>"+h.searchtext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.searchtitle||"",id:e.id||"search_"+p}).click(function(){return n(this).hasClass(s.disabled)||(n.isFunction(h.searchfunc)?h.searchfunc.call(a,e):n(a).jqGrid("searchGrid",e)),!1}).hover(b,k),e.showOnLoad&&e.showOnLoad===!0&&n(v,y).click(),v=null),h.refresh&&(v=n("<td class='ui-pg-button "+s.cornerall+"'><\/td>"),n(v).append("<div class='ui-pg-div'><span class='"+s.icon_base+" "+h.refreshicon+"'><\/span>"+h.refreshtext+"<\/div>"),n("tr",y).append(v),n(v,y).attr({title:h.refreshtitle||"",id:"refresh_"+p}).click(function(){if(!n(this).hasClass(s.disabled)){n.isFunction(h.beforeRefresh)&&h.beforeRefresh.call(a);a.p.search=!1;a.p.resetsearch=!0;try{if(h.refreshstate!=="currentfilter"){var t=a.p.id;a.p.postData.filters="";try{n("#fbox_"+n.jgrid.jqID(t)).jqFilter("resetFilter")}catch(i){}n.isFunction(a.clearToolbar)&&a.clearToolbar.call(a,!1)}}catch(r){}switch(h.refreshstate){case"firstpage":n(a).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":n(a).trigger("reloadGrid",[{current:!0}])}n.isFunction(h.afterRefresh)&&h.afterRefresh.call(a)}return!1}).hover(b,k),v=null),it=n(".ui-jqgrid").css("font-size")||"11px",n("body").append("<div id='testpg2' class='ui-jqgrid "+n.jgrid.styleUI[c].base.entrieBox+"' style='font-size:"+it+";visibility:hidden;' ><\/div>"),g=n(y).clone().appendTo("#testpg2").width(),n("#testpg2").remove(),a.p._nvtd&&(h.dropmenu?(y=null,n(a).jqGrid("_buildNavMenu",w,p,i,r,u,f,e,o)):g>a.p._nvtd[0]?(a.p.responsive?(y=null,n(a).jqGrid("_buildNavMenu",w,p,i,r,u,f,e,o)):n(w+"_"+h.position,w).append(y).width(g),a.p._nvtd[0]=g):n(w+"_"+h.position,w).append(y),a.p._nvtd[1]=g),a.p.navGrid=!0;a.p.storeNavOptions&&(a.p.navOptions=h,a.p.editOptions=r,a.p.addOptions=u,a.p.delOptions=f,a.p.searchOptions=e,a.p.viewOptions=o,a.p.navButtons=[])}})},navButtonAdd:function(t,i){var r=this[0].p.styleUI,u=n.jgrid.styleUI[r].navigator;return i=n.extend({caption:"newButton",title:"",buttonicon:u.icon_newbutton_nav,onClickButton:null,position:"last",cursor:"pointer",internal:!1},i||{}),this.each(function(){var f;if(this.grid){typeof t=="string"&&t.indexOf("#")!==0&&(t="#"+n.jgrid.jqID(t));var u=n(".navtable",t)[0],e=this,o=n.jgrid.styleUI[r].common.disabled,s=n.jgrid.styleUI[r].common.hover,c=n.jgrid.styleUI[r].common.cornerall,a=n.jgrid.styleUI[r].common.icon_base;if(e.p.storeNavOptions&&!i.internal&&e.p.navButtons.push([t,i]),u){if(i.id&&n("#"+n.jgrid.jqID(i.id),u)[0]!==undefined)return;f=n("<td><\/td>");i.buttonicon.toString().toUpperCase()==="NONE"?n(f).addClass("ui-pg-button "+c).append("<div class='ui-pg-div'>"+i.caption+"<\/div>"):n(f).addClass("ui-pg-button "+c).append("<div class='ui-pg-div'><span class='"+a+" "+i.buttonicon+"'><\/span>"+i.caption+"<\/div>");i.id&&n(f).attr("id",i.id);i.position==="first"?u.rows[0].cells.length===0?n("tr",u).append(f):n("tr td:eq(0)",u).before(f):n("tr",u).append(f);n(f,u).attr("title",i.title||"").click(function(t){return n(this).hasClass(o)||n.isFunction(i.onClickButton)&&i.onClickButton.call(e,t),!1}).hover(function(){n(this).hasClass(o)||n(this).addClass(s)},function(){n(this).removeClass(s)})}else if(u=n(".dropdownmenu",t)[0],u){var h=n(u).val(),v=i.id||n.jgrid.randId(),l=n('<li class="ui-menu-item" role="presentation"><a class="'+c+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(i.caption||i.title)+"<\/a><\/li>");h&&(i.position==="first"?n("#"+h).prepend(l):n("#"+h).append(l),n(l).on("click",function(t){return n(this).hasClass(o)||(n("#"+h).hide(),n.isFunction(i.onClickButton)&&i.onClickButton.call(e,t)),!1}).find("a").hover(function(){n(this).hasClass(o)||n(this).addClass(s)},function(){n(this).removeClass(s)}))}}})},navSeparatorAdd:function(t,i){var u=this[0].p.styleUI,r=n.jgrid.styleUI[u].common;return i=n.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},i||{}),this.each(function(){if(this.grid){typeof t=="string"&&t.indexOf("#")!==0&&(t="#"+n.jgrid.jqID(t));var u=n(".navtable",t)[0],f,e;this.p.storeNavOptions&&this.p.navButtons.push([t,i]);u?(f="<td class='ui-pg-button "+r.disabled+"' style='width:4px;'><span class='"+i.sepclass+"'><\/span>"+i.sepcontent+"<\/td>",i.position==="first"?u.rows[0].cells.length===0?n("tr",u).append(f):n("tr td:eq(0)",u).before(f):n("tr",u).append(f)):(u=n(".dropdownmenu",t)[0],f="<li class='ui-menu-item "+r.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'><\/li>",u&&(e=n(u).val(),e&&(i.position==="first"?n("#"+e).prepend(f):n("#"+e).append(f))))}})},_buildNavMenu:function(t,i,r,u,f,e,o,s){return this.each(function(){var h=this,p=n.jgrid.getRegional(h,"nav"),v=h.p.styleUI,d=n.jgrid.styleUI[v].navigator,w=n.jgrid.styleUI[v].filter,c=n.jgrid.styleUI[v].common,l="form_menu_"+n.jgrid.randId(),b=r.navButtonText?r.navButtonText:p.selectcaption||"Actions",k="<button class='dropdownmenu "+c.button+"' value='"+l+"'>"+b+"<\/button>",a,y;n(t+"_"+r.position,t).append(k);a={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id};y=function(){var p=n(".ui-jqgrid-view").css("font-size")||"11px",y,v,t=n('<ul id="'+l+'" class="ui-nav-menu modal-content" role="menu" tabindex="0" style="display:none;font-size:'+p+'"><\/ul>');r.add&&(f=f||{},y=f.id||"add_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.addtext||r.addtitle)+"<\/a><\/li>").click(function(){return n(this).hasClass(c.disabled)||(n.isFunction(r.addfunc)?r.addfunc.call(h):n(h).jqGrid("editGridRow","new",f),n(t).hide()),!1}),n(t).append(v));r.edit&&(u=u||{},y=u.id||"edit_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.edittext||r.edittitle)+"<\/a><\/li>").click(function(){if(!n(this).hasClass(c.disabled)){var i=h.p.selrow;i?n.isFunction(r.editfunc)?r.editfunc.call(h,i):n(h).jqGrid("editGridRow",i,u):(n.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+n.jgrid.jqID(h.p.id),jqm:!0}),n("#jqg_alrt").focus());n(t).hide()}return!1}),n(t).append(v));r.view&&(s=s||{},y=s.id||"view_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.viewtext||r.viewtitle)+"<\/a><\/li>").click(function(){if(!n(this).hasClass(c.disabled)){var i=h.p.selrow;i?n.isFunction(r.editfunc)?r.viewfunc.call(h,i):n(h).jqGrid("viewGridRow",i,s):(n.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+n.jgrid.jqID(h.p.id),jqm:!0}),n("#jqg_alrt").focus());n(t).hide()}return!1}),n(t).append(v));r.del&&(e=e||{},y=e.id||"del_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.deltext||r.deltitle)+"<\/a><\/li>").click(function(){if(!n(this).hasClass(c.disabled)){var i;h.p.multiselect?(i=h.p.selarrrow,i.length===0&&(i=null)):i=h.p.selrow;i?n.isFunction(r.delfunc)?r.delfunc.call(h,i):n(h).jqGrid("delGridRow",i,e):(n.jgrid.viewModal("#"+a.themodal,{gbox:"#gbox_"+n.jgrid.jqID(h.p.id),jqm:!0}),n("#jqg_alrt").focus());n(t).hide()}return!1}),n(t).append(v));(r.add||r.edit||r.del||r.view)&&n(t).append("<li class='ui-menu-item "+c.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'><\/li>");r.search&&(o=o||{},y=o.id||"search_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.searchtext||r.searchtitle)+"<\/a><\/li>").click(function(){return n(this).hasClass(c.disabled)||(n.isFunction(r.searchfunc)?r.searchfunc.call(h,o):n(h).jqGrid("searchGrid",o),n(t).hide()),!1}),n(t).append(v),o.showOnLoad&&o.showOnLoad===!0&&n(v).click());r.refresh&&(y=o.id||"search_"+i,v=n('<li class="ui-menu-item" role="presentation"><a class="'+c.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+y+'">'+(r.refreshtext||r.refreshtitle)+"<\/a><\/li>").click(function(){if(!n(this).hasClass(c.disabled)){n.isFunction(r.beforeRefresh)&&r.beforeRefresh.call(h);h.p.search=!1;h.p.resetsearch=!0;try{if(r.refreshstate!=="currentfilter"){var i=h.p.id;h.p.postData.filters="";try{n("#fbox_"+n.jgrid.jqID(i)).jqFilter("resetFilter")}catch(u){}n.isFunction(h.clearToolbar)&&h.clearToolbar.call(h,!1)}}catch(f){}switch(r.refreshstate){case"firstpage":n(h).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":n(h).trigger("reloadGrid",[{current:!0}])}n.isFunction(r.afterRefresh)&&r.afterRefresh.call(h);n(t).hide()}return!1}),n(t).append(v));n(t).hide();n("body").append(t);n("#"+l).addClass("ui-menu "+w.menu_widget);n("#"+l+" > li > a").hover(function(){n(this).addClass(c.hover)},function(){n(this).removeClass(c.hover)})};y();n(".dropdownmenu",t+"_"+r.position).on("click",function(t){var i=n(this).offset(),u=i.left,f=parseInt(i.top),r=n(this).val();n("#"+r).show().css({top:f-(n("#"+r).height()+10)+"px",left:u+"px"});t.stopPropagation()});n("body").on("click",function(t){n(t.target).hasClass("dropdownmenu")||n("#"+l).hide()})})},GridToForm:function(t,i){return this.each(function(){var f=this,r,u;if(f.grid&&(u=n(f).jqGrid("getRowData",t),u))for(r in u)u.hasOwnProperty(r)&&(n("[name="+n.jgrid.jqID(r)+"]",i).is("input:radio")||n("[name="+n.jgrid.jqID(r)+"]",i).is("input:checkbox")?n("[name="+n.jgrid.jqID(r)+"]",i).each(function(){n(this).val()==u[r]?n(this)[f.p.useProp?"prop":"attr"]("checked",!0):n(this)[f.p.useProp?"prop":"attr"]("checked",!1)}):n("[name="+n.jgrid.jqID(r)+"]",i).val(u[r]))})},FormToGrid:function(t,i,r,u){return this.each(function(){var e=this,o,f;e.grid&&(r||(r="set"),u||(u="first"),o=n(i).serializeArray(),f={},n.each(o,function(n,t){f[t.name]=t.value}),r==="add"?n(e).jqGrid("addRowData",t,f,u):r==="set"&&n(e).jqGrid("setRowData",t,f))})}});n.jgrid.extend({groupingSetup:function(){return this.each(function(){var f=this,i,r,e,u=f.p.colModel,t=f.p.groupingView,o=n.jgrid.styleUI[f.p.styleUI||"jQueryUI"].grouping;if(t!==null&&(typeof t=="object"||n.isFunction(t)))if(t.plusicon||(t.plusicon=o.icon_plus),t.minusicon||(t.minusicon=o.icon_minus),t.groupField.length){for(t.visibiltyOnNextGrouping===undefined&&(t.visibiltyOnNextGrouping=[]),t.lastvalues=[],t._locgr||(t.groups=[]),t.counters=[],i=0;i<t.groupField.length;i++)t.groupOrder[i]||(t.groupOrder[i]="asc"),t.groupText[i]||(t.groupText[i]="{0}"),typeof t.groupColumnShow[i]!="boolean"&&(t.groupColumnShow[i]=!0),typeof t.groupSummary[i]!="boolean"&&(t.groupSummary[i]=!1),t.groupSummaryPos[i]||(t.groupSummaryPos[i]="footer"),t.groupColumnShow[i]===!0?(t.visibiltyOnNextGrouping[i]=!0,n(f).jqGrid("showCol",t.groupField[i])):(t.visibiltyOnNextGrouping[i]=n("#"+n.jgrid.jqID(f.p.id+"_"+t.groupField[i])).is(":visible"),n(f).jqGrid("hideCol",t.groupField[i]));for(t.summary=[],t.hideFirstGroupCol&&n.isArray(t.formatDisplayField)&&!n.isFunction(t.formatDisplayField[0])&&(t.formatDisplayField[0]=function(n){return n}),r=0,e=u.length;r<e;r++)t.hideFirstGroupCol&&(u[r].hidden||t.groupField[0]!==u[r].name||(u[r].formatter=function(){return""})),u[r].summaryType&&(u[r].summaryDivider?t.summary.push({nm:u[r].name,st:u[r].summaryType,v:"",sd:u[r].summaryDivider,vd:"",sr:u[r].summaryRound,srt:u[r].summaryRoundType||"round"}):t.summary.push({nm:u[r].name,st:u[r].summaryType,v:"",sr:u[r].summaryRound,srt:u[r].summaryRoundType||"round"}))}else f.p.grouping=!1;else f.p.grouping=!1})},groupingPrepare:function(t,i){return this.each(function(){for(var r=this.p.groupingView,s=this,h=function(){n.isFunction(this.st)?this.v=this.st.call(s,this.v,this.nm,t):(this.v=n(s).jqGrid("groupingCalculations.handler",this.st,this.v,this.nm,this.sr,this.srt,t),this.st.toLowerCase()==="avg"&&this.sd&&(this.vd=n(s).jqGrid("groupingCalculations.handler",this.st,this.vd,this.sd,this.sr,this.srt,t)))},a=r.groupField.length,o,f,c,e,l=0,u=0;u<a;u++)o=r.groupField[u],c=r.displayField[u],f=t[o],e=c==null?null:t[c],e==null&&(e=f),f!==undefined&&(i===0?(r.groups.push({idx:u,dataIndex:o,value:f,displayValue:e,startRow:i,cnt:1,summary:[]}),r.lastvalues[u]=f,r.counters[u]={cnt:1,pos:r.groups.length-1,summary:n.extend(!0,[],r.summary)},n.each(r.counters[u].summary,h),r.groups[r.counters[u].pos].summary=r.counters[u].summary):typeof f=="object"||(n.isArray(r.isInTheSameGroup)&&n.isFunction(r.isInTheSameGroup[u])?r.isInTheSameGroup[u].call(s,r.lastvalues[u],f,u,r):r.lastvalues[u]===f)?l===1?(r.groups.push({idx:u,dataIndex:o,value:f,displayValue:e,startRow:i,cnt:1,summary:[]}),r.lastvalues[u]=f,r.counters[u]={cnt:1,pos:r.groups.length-1,summary:n.extend(!0,[],r.summary)},n.each(r.counters[u].summary,h),r.groups[r.counters[u].pos].summary=r.counters[u].summary):(r.counters[u].cnt+=1,r.groups[r.counters[u].pos].cnt=r.counters[u].cnt,n.each(r.counters[u].summary,h),r.groups[r.counters[u].pos].summary=r.counters[u].summary):(r.groups.push({idx:u,dataIndex:o,value:f,displayValue:e,startRow:i,cnt:1,summary:[]}),r.lastvalues[u]=f,l=1,r.counters[u]={cnt:1,pos:r.groups.length-1,summary:n.extend(!0,[],r.summary)},n.each(r.counters[u].summary,h),r.groups[r.counters[u].pos].summary=r.counters[u].summary))}),this},groupingToggle:function(t){return this.each(function(){var r=this,b=r.p.groupingView,o=t.split("_"),l=parseInt(o[o.length-2],10);o.splice(o.length-2,2);var a=o.join("_"),s=b.minusicon,h=b.plusicon,k=n("#"+n.jgrid.jqID(t)),i=k.length?k[0].nextSibling:null,v=n("#"+n.jgrid.jqID(t)+" span.tree-wrap-"+r.p.direction),d=function(t){var i=n.map(t.split(" "),function(n){if(n.substring(0,a.length+1)===a+"_")return parseInt(n.substring(a.length+1),10)});return i.length>0?i[0]:undefined},u,c,y=!1,p=!1,e=r.p.frozenColumns?r.p.id+"_frozen":!1,w=e?n("#"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(e)):!1,f=w&&w.length?w[0].nextSibling:null;if(v.hasClass(s)){if(i)while(i){if(u=d(i.className),u!==undefined&&u<=l)break;n(i).hide();i=i.nextSibling;e&&(n(f).hide(),f=f.nextSibling)}v.removeClass(s).addClass(h);y=!0}else{if(i)for(c=undefined;i;){if(u=d(i.className),c===undefined&&(c=u===undefined),p=n(i).hasClass("ui-subgrid")&&n(i).hasClass("ui-sg-collapsed"),u!==undefined){if(u<=l)break;u===l+1&&(p||(n(i).show().find(">td>span.tree-wrap-"+r.p.direction).removeClass(s).addClass(h),e&&n(f).show().find(">td>span.tree-wrap-"+r.p.direction).removeClass(s).addClass(h)))}else c&&(p||(n(i).show(),e&&n(f).show()));i=i.nextSibling;e&&(f=f.nextSibling)}v.removeClass(h).addClass(s)}n(r).triggerHandler("jqGridGroupingClickGroup",[t,y]);n.isFunction(r.p.onClickGroup)&&r.p.onClickGroup.call(r,t,y)}),!1},groupingRender:function(t,i,r,u,f){return this.each(function(){function nt(n,t,i){var u=!1,r,f;if(t===0)u=i[n];else if(f=i[n].idx,f===0)u=i[n];else for(r=n;r>=0;r--)if(i[r].idx===f-t){u=i[r];break}return u}function g(t,r,u,f){for(var s=nt(t,r,u),h=o.p.colModel,c,v=s.cnt,y="",l,a,e=f;e<i;e++)l="<td "+o.formatCol(e,1,"")+">&#160;<\/td>",a="{0}",n.each(s.summary,function(){if(this.nm===h[e].name){h[e].summaryTpl&&(a=h[e].summaryTpl);typeof this.st=="string"&&this.st.toLowerCase()==="avg"&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&v>0&&(this.v=this.v/v));try{this.groupCount=s.cnt;this.groupIndex=s.dataIndex;this.groupValue=s.value;c=o.formatter("",this.v,e,this)}catch(t){c=this.v}return l="<td "+o.formatCol(e,1,"")+">"+n.jgrid.template(a,c)+"<\/td>",!1}}),y+=l;return y}var o=this,e=o.p.groupingView,s="",p="",c,a,w=e.groupCollapse?e.plusicon:e.minusicon,h,b=[],d=e.groupField.length,v=n.jgrid.styleUI[o.p.styleUI||"jQueryUI"].common,l,k,y;w=w+" tree-wrap-"+o.p.direction;n.each(o.p.colModel,function(n,t){for(var i=0;i<d;i++)if(e.groupField[i]===t.name){b[i]=n;break}});l=0;k=n.makeArray(e.groupSummary);k.reverse();y=o.p.multiselect?' colspan="2"':"";n.each(e.groups,function(nt,tt){var it,ht,ut,st;if(e._locgr&&!(tt.startRow+tt.cnt>(r-1)*u&&tt.startRow<r*u))return!0;l++;a=o.p.id+"ghead_"+tt.idx;c=a+"_"+nt;p="<span style='cursor:pointer;margin-right:8px;margin-left:5px;' class='"+v.icon_base+" "+w+"' onclick=\"jQuery('#"+n.jgrid.jqID(o.p.id)+"').jqGrid('groupingToggle','"+c+"');return false;\"><\/span>";try{h=n.isArray(e.formatDisplayField)&&n.isFunction(e.formatDisplayField[tt.idx])?e.formatDisplayField[tt.idx].call(o,tt.displayValue,tt.value,o.p.colModel[b[tt.idx]],tt.idx,e):o.formatter(c,tt.displayValue,b[tt.idx],f.rows[tt.startRow])}catch(at){h=tt.displayValue}if(it="",it=n.isFunction(e.groupText[tt.idx])?e.groupText[tt.idx].call(o,h,tt.cnt,tt.summary):n.jgrid.template(e.groupText[tt.idx],h,tt.cnt,tt.summary),typeof it=="string"||typeof it=="number"||(it=h),e.groupSummaryPos[tt.idx]==="header"?(s+='<tr id="'+c+'"'+(e.groupCollapse&&tt.idx>0?' style="display:none;" ':" ")+'role="row" class= "'+v.content+" jqgroup ui-row-"+o.p.direction+" "+a+'"><td style="padding-left:'+tt.idx*12+'px;"'+y+">"+p+it+"<\/td>",s+=g(nt,0,e.groups,e.groupColumnShow[tt.idx]===!1?y===""?2:3:y===""?1:2),s+="<\/tr>"):s+='<tr id="'+c+'"'+(e.groupCollapse&&tt.idx>0?' style="display:none;" ':" ")+'role="row" class= "'+v.content+" jqgroup ui-row-"+o.p.direction+" "+a+'"><td style="padding-left:'+tt.idx*12+'px;" colspan="'+(e.groupColumnShow[tt.idx]===!1?i-1:i)+'">'+p+it+"<\/td><\/tr>",ht=d-1===tt.idx,ht){var ot=e.groups[nt+1],ft,rt,et=0,ct=tt.startRow,lt=ot!==undefined?ot.startRow:e.groups[nt].startRow+e.groups[nt].cnt;for(e._locgr&&(et=(r-1)*u,et>tt.startRow&&(ct=et)),ft=ct;ft<lt;ft++){if(!t[ft-et])break;s+=t[ft-et].join("")}if(e.groupSummaryPos[tt.idx]!=="header"){if(ot!==undefined){for(ut=0;ut<e.groupField.length;ut++)if(ot.dataIndex===e.groupField[ut])break;l=e.groupField.length-ut}for(rt=0;rt<l;rt++)k[rt]&&(st="",e.groupCollapse&&!e.showSummaryOnHide&&(st=' style="display:none;"'),s+="<tr"+st+' jqfootlevel="'+(tt.idx-rt)+'" role="row" class="'+v.content+" jqfoot ui-row-"+o.p.direction+'">',s+=g(nt,rt,e.groups,0),s+="<\/tr>");l=ut}}});n("#"+n.jgrid.jqID(o.p.id)+" tbody:first").append(s);s=null})},groupingGroupBy:function(t,i){return this.each(function(){var f=this,u,r;for(typeof t=="string"&&(t=[t]),u=f.p.groupingView,f.p.grouping=!0,u._locgr=!1,u.visibiltyOnNextGrouping===undefined&&(u.visibiltyOnNextGrouping=[]),r=0;r<u.groupField.length;r++)!u.groupColumnShow[r]&&u.visibiltyOnNextGrouping[r]&&n(f).jqGrid("showCol",u.groupField[r]);for(r=0;r<t.length;r++)u.visibiltyOnNextGrouping[r]=n("#"+n.jgrid.jqID(f.p.id)+"_"+n.jgrid.jqID(t[r])).is(":visible");f.p.groupingView=n.extend(f.p.groupingView,i||{});u.groupField=t;n(f).trigger("reloadGrid")})},groupingRemove:function(t){return this.each(function(){var i=this,r,u;if(t===undefined&&(t=!0),i.p.grouping=!1,t===!0){for(r=i.p.groupingView,u=0;u<r.groupField.length;u++)!r.groupColumnShow[u]&&r.visibiltyOnNextGrouping[u]&&n(i).jqGrid("showCol",r.groupField);n("tr.jqgroup, tr.jqfoot","#"+n.jgrid.jqID(i.p.id)+" tbody:first").remove();n("tr.jqgrow:hidden","#"+n.jgrid.jqID(i.p.id)+" tbody:first").show()}else n(i).trigger("reloadGrid")})},groupingCalculations:{handler:function(n,t,i,r,u,f){var o={sum:function(){return parseFloat(t||0)+parseFloat(f[i]||0)},min:function(){return t===""?parseFloat(f[i]||0):Math.min(parseFloat(t),parseFloat(f[i]||0))},max:function(){return t===""?parseFloat(f[i]||0):Math.max(parseFloat(t),parseFloat(f[i]||0))},count:function(){return(t===""&&(t=0),f.hasOwnProperty(i))?t+1:0},avg:function(){return o.sum()}},e,s;if(!o[n])throw"jqGrid Grouping No such method: "+n;return e=o[n](),r!=null&&(u==="fixed"?e=e.toFixed(r):(s=Math.pow(10,r),e=Math.round(e*s)/s)),e}},setGroupHeaders:function(t){return t=n.extend({useColSpanStyle:!1,groupHeaders:[]},t||{}),this.each(function(){var i=this,r,l,p=0,s,f,e,a,k,u,v,w,d,h,g,b=i.p.colModel,nt=b.length,tt=i.grid.headers,o=n("table.ui-jqgrid-htable",i.grid.hDiv),ft=o.children("thead").children("tr.ui-jqgrid-labels:last").addClass("jqg-second-row-header"),et=o.children("thead"),y,c=o.find(".jqg-first-row-header"),it=n.jgrid.styleUI[i.p.styleUI||"jQueryUI"].base,rt,ut;for(i.p.groupHeader||(i.p.groupHeader=[]),i.p.groupHeader.push(t),c[0]===undefined?c=n("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto"):c.empty(),ut=function(n,t){for(var r=t.length,i=0;i<r;i++)if(t[i].startColumnName===n)return i;return-1},n(i).prepend(et),s=n("<tr>",{role:"row"}).addClass("ui-jqgrid-labels jqg-third-row-header"),r=0;r<nt;r++)if(e=tt[r].el,a=n(e),l=b[r],k={height:"0px",width:tt[r].width+"px",display:l.hidden?"none":""},n("<th>",{role:"gridcell"}).css(k).addClass("ui-first-th-"+i.p.direction).appendTo(c),e.style.width="",u=ut(l.name,t.groupHeaders),u>=0){for(v=t.groupHeaders[u],w=v.numberOfColumns,d=v.titleText,g=v.className||"",h=0,u=0;u<w&&r+u<nt;u++)b[r+u].hidden||h++;f=n("<th>").attr({role:"columnheader"}).addClass(it.headerBox+" ui-th-column-header ui-th-"+i.p.direction+" "+g).html(d);h>0&&f.attr("colspan",String(h));i.p.headertitles&&f.attr("title",f.text());h===0&&f.hide();a.before(f);s.append(e);p=w-1}else p===0?t.useColSpanStyle?a.attr("rowspan","2"):(n("<th>",{role:"columnheader"}).addClass(it.headerBox+" ui-th-column-header ui-th-"+i.p.direction).css({display:l.hidden?"none":""}).insertBefore(a),s.append(e)):(s.append(e),p--);y=n(i).children("thead");y.prepend(c);s.insertAfter(ft);o.append(y);t.useColSpanStyle&&(o.find("span.ui-jqgrid-resize").each(function(){var t=n(this).parent();t.is(":visible")&&(this.style.cssText="height: "+t.height()+"px !important; cursor: col-resize;")}),o.find("div.ui-jqgrid-sortable").each(function(){var t=n(this),i=t.parent();i.is(":visible")&&i.is(":has(span.ui-jqgrid-resize)")&&t.css("top",(i.height()-t.outerHeight())/2-4+"px")}));rt=y.find("tr.jqg-first-row-header");n(i).on("jqGridResizeStop.setGroupHeaders",function(n,t,i){rt.find("th").eq(i)[0].style.width=t+"px"})})},destroyGroupHeader:function(t){return t===undefined&&(t=!0),this.each(function(){var f=this,e,i,h,u,r,o,s=f.grid,c=n("table.ui-jqgrid-htable thead",s.hDiv),a=f.p.colModel,l;if(s){for(n(this).off(".setGroupHeaders"),e=n("<tr>",{role:"row"}).addClass("ui-jqgrid-labels"),u=s.headers,i=0,h=u.length;i<h;i++){l=a[i].hidden?"none":"";r=n(u[i].el).width(u[i].width).css("display",l);try{r.removeAttr("rowSpan")}catch(v){r.attr("rowSpan",1)}e.append(r);o=r.children("span.ui-jqgrid-resize");o.length>0&&(o[0].style.height="");r.children("div")[0].style.top=""}n(c).children("tr.ui-jqgrid-labels").remove();n(c).prepend(e);t===!0&&n(f).jqGrid("setGridParam",{groupHeader:null})}})}});n.jgrid=n.jgrid||{};n.extend(n.jgrid,{saveState:function(t,i){var l,e,c,h,a;if(i=n.extend({useStorage:!0,storageType:"localStorage",beforeSetItem:null,compression:!1,compressionModule:"LZString",compressionMethod:"compressToUTF16",debug:!1},i||{}),t){var u="",f="",o,r=n("#"+t)[0],s;if(r.grid){if(s=n(r).data("inlineNav"),s&&r.p.inlineNav&&n(r).jqGrid("setGridParam",{_iN:s}),s=n(r).data("filterToolbar"),s&&r.p.filterToolbar&&n(r).jqGrid("setGridParam",{_fT:s}),u=n(r).jqGrid("jqGridExport",{exptype:"jsonstring",ident:"",root:""}),f=n(r.grid.bDiv).find(".ui-jqgrid-btable tbody:first").html(),l=f.indexOf("<\/tr>"),f=f.slice(l+5),n.isFunction(i.beforeSetItem)&&(o=i.beforeSetItem.call(r,u),o!=null&&(u=o)),i.debug){n("#gbox_tree").prepend('<a id="link_save" target="_blank" download="jqGrid_dump.txt">Click to save Dump Data<\/a>');e=[];h={};e.push("Grid Options\n");e.push(u);e.push("\n");e.push("GridData\n");e.push(f);h.type="plain/text;charset=utf-8";try{c=new File(e,"jqGrid_dump.txt",h)}catch(v){c=new Blob(e,h)}a=URL.createObjectURL(c);n("#link_save").attr("href",a).on("click",function(){n(this).remove()})}if(i.compression&&i.compressionModule)try{o=window[i.compressionModule][i.compressionMethod](u);o!=null&&(u=o,f=window[i.compressionModule][i.compressionMethod](f))}catch(v){}if(i.useStorage&&n.jgrid.isLocalStorage())try{window[i.storageType].setItem("jqGrid"+r.p.id,u);window[i.storageType].setItem("jqGrid"+r.p.id+"_data",f)}catch(v){v.code===22&&alert("Local storage limit is over!")}return u}}},loadState:function(t,i,r){var u,h,s,c,v,l,o,y,f,e,p,w;if(r=n.extend({useStorage:!0,storageType:"localStorage",clearAfterLoad:!1,beforeSetGrid:null,afterSetGrid:null,decompression:!1,decompressionModule:"LZString",decompressionMethod:"decompressFromUTF16"},r||{}),t){if(s=n("#"+t)[0],r.useStorage)try{i=window[r.storageType].getItem("jqGrid"+s.id);c=window[r.storageType].getItem("jqGrid"+s.id+"_data")}catch(nt){}if(i){if(r.decompression&&r.decompressionModule)try{u=window[r.decompressionModule][r.decompressionMethod](i);u!=null&&(i=u,c=window[r.decompressionModule][r.decompressionMethod](c))}catch(nt){}if(u=jqGridUtils.parse(i),u&&n.type(u)==="object"){if(s.grid&&n.jgrid.gridUnload(t),n.isFunction(r.beforeSetGrid)&&(h=r.beforeSetGrid(u),h&&n.type(h)==="object"&&(u=h)),o=function(n){return n},y={reccount:u.reccount,records:u.records,lastpage:u.lastpage,shrinkToFit:o(u.shrinkToFit),data:o(u.data),datatype:o(u.datatype),grouping:o(u.grouping)},u.shrinkToFit=!1,u.data=[],u.datatype="local",u.grouping=!1,u.inlineNav&&(v=o(u._iN),u._iN=null,delete u._iN),u.filterToolbar&&(l=o(u._fT),u._fT=null,delete u._fT),f=n("#"+t).jqGrid(u),f.append(c),f.jqGrid("setGridParam",y),u.storeNavOptions&&u.navGrid&&(f[0].p.navGrid=!1,f.jqGrid("navGrid",u.pager,u.navOptions,u.editOptions,u.addOptions,u.delOptions,u.searchOptions,u.viewOptions),u.navButtons&&u.navButtons.length))for(e=0;e<u.navButtons.length;e++)"sepclass"in u.navButtons[e][1]?f.jqGrid("navSeparatorAdd",u.navButtons[e][0],u.navButtons[e][1]):f.jqGrid("navButtonAdd",u.navButtons[e][0],u.navButtons[e][1]);if(f[0].refreshIndex(),u.subGrid&&(p=u.multiselect===1?1:0,w=u.rownumbers===!0?1:0,f.jqGrid("addSubGrid",p+w)),u.treeGrid)for(var a=1,g=f[0].rows.length,b=u.expColInd,k=u.treeReader.leaf_field,d=u.treeReader.expanded_field;a<g;){n(f[0].rows[a].cells[b]).find("div.treeclick").on("click",function(t){var r=t.target||t.srcElement,e=n.jgrid.stripPref(u.idPrefix,n(r,f[0].rows).closest("tr.jqgrow")[0].id),i=f[0].p._index[e];return f[0].p.data[i][k]||(f[0].p.data[i][d]?(f.jqGrid("collapseRow",f[0].p.data[i]),f.jqGrid("collapseNode",f[0].p.data[i])):(f.jqGrid("expandRow",f[0].p.data[i]),f.jqGrid("expandNode",f[0].p.data[i]))),!1});if(u.ExpandColClick===!0)n(f[0].rows[a].cells[b]).find("span.cell-wrapper").css("cursor","pointer").on("click",function(t){var e=t.target||t.srcElement,r=n.jgrid.stripPref(u.idPrefix,n(e,f[0].rows).closest("tr.jqgrow")[0].id),i=f[0].p._index[r];return f[0].p.data[i][k]||(f[0].p.data[i][d]?(f.jqGrid("collapseRow",f[0].p.data[i]),f.jqGrid("collapseNode",f[0].p.data[i])):(f.jqGrid("expandRow",f[0].p.data[i]),f.jqGrid("expandNode",f[0].p.data[i]))),f.jqGrid("setSelection",r),!1});a++}u.multiselect&&n.each(u.selarrrow,function(){n("#jqg_"+t+"_"+this)[u.useProp?"prop":"attr"]("checked","checked")});u.inlineNav&&v&&(f.jqGrid("setGridParam",{inlineNav:!1}),f.jqGrid("inlineNav",u.pager,v));u.filterToolbar&&l&&(f.jqGrid("setGridParam",{filterToolbar:!1}),l.restoreFromFilters=!0,f.jqGrid("filterToolbar",l));u.frozenColumns&&f.jqGrid("setFrozenColumns");f[0].updatepager(!0,!0);n.isFunction(r.afterSetGrid)&&r.afterSetGrid(f);r.clearAfterLoad&&(window[r.storageType].removeItem("jqGrid"+s.id),window[r.storageType].removeItem("jqGrid"+s.id+"_data"))}else alert("can not convert to object")}}},isGridInStorage:function(t,i){var r={storageType:"localStorage"},u,f,e;r=n.extend(r,i||{});try{f=window[r.storageType].getItem("jqGrid"+t);e=window[r.storageType].getItem("jqGrid"+t+"_data");u=f!=null&&e!=null&&typeof f=="string"&&typeof e=="string"}catch(o){u=!1}return u},setRegional:function(t,i){var r={storageType:"sessionStorage"};if(r=n.extend(r,i||{}),r.regional){n.jgrid.saveState(t,r);r.beforeSetGrid=function(n){return n.regional=r.regional,n.force_regional=!0,n};n.jgrid.loadState(t,null,r);var f=n("#"+t)[0],o=n(f).jqGrid("getGridParam","colModel"),e=-1,u=n.jgrid.getRegional(f,"nav");n.each(o,function(n){if(this.formatter&&this.formatter==="actions")return e=n,!1});e!==-1&&u&&n("#"+t+" tbody tr").each(function(){var t=this.cells[e];n(t).find(".ui-inline-edit").attr("title",u.edittitle);n(t).find(".ui-inline-del").attr("title",u.deltitle);n(t).find(".ui-inline-save").attr("title",u.savetitle);n(t).find(".ui-inline-cancel").attr("title",u.canceltitle)});try{window[r.storageType].removeItem("jqGrid"+f.id);window[r.storageType].removeItem("jqGrid"+f.id+"_data")}catch(s){}}},jqGridImport:function(t,i){var u;i=n.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"root>grid",data:"root>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},i||{});var r=(t.indexOf("#")===0?"":"#")+n.jgrid.jqID(t),f=function(t,i){var s=n(i.xmlGrid.config,t)[0],h=n(i.xmlGrid.data,t)[0],u,f,e,o;if(jqGridUtils.xmlToJSON){u=jqGridUtils.xmlToJSON(s);for(e in u)u.hasOwnProperty(e)&&(f=u[e]);h?(o=u.grid.datatype,u.grid.datatype="xmlstring",u.grid.datastr=t,n(r).jqGrid(f).jqGrid("setGridParam",{datatype:o})):setTimeout(function(){n(r).jqGrid(f)},0)}else alert("xml2json or parse are not present")},e=function(t,i){var o;if(t&&typeof t=="string"){var f=jqGridUtils.parse(t),u=f[i.jsonGrid.config],e=f[i.jsonGrid.data];e?(o=u.datatype,u.datatype="jsonstring",u.datastr=e,n(r).jqGrid(u).jqGrid("setGridParam",{datatype:o})):n(r).jqGrid(u)}};switch(i.imptype){case"xml":n.ajax(n.extend({url:i.impurl,type:i.mtype,data:i.impData,dataType:"xml",complete:function(t,u){u==="success"&&(f(t.responseXML,i),n(r).triggerHandler("jqGridImportComplete",[t,i]),n.isFunction(i.importComplete)&&i.importComplete(t));t=null}},i.ajaxOptions));break;case"xmlstring":i.impstring&&typeof i.impstring=="string"&&(u=n.parseXML(i.impstring),u&&(f(u,i),n(r).triggerHandler("jqGridImportComplete",[u,i]),n.isFunction(i.importComplete)&&i.importComplete(u)));break;case"json":n.ajax(n.extend({url:i.impurl,type:i.mtype,data:i.impData,dataType:"json",complete:function(t){try{e(t.responseText,i);n(r).triggerHandler("jqGridImportComplete",[t,i]);n.isFunction(i.importComplete)&&i.importComplete(t)}catch(u){}t=null}},i.ajaxOptions));break;case"jsonstring":i.impstring&&typeof i.impstring=="string"&&(e(i.impstring,i),n(r).triggerHandler("jqGridImportComplete",[i.impstring,i]),n.isFunction(i.importComplete)&&i.importComplete(i.impstring))}}});n.jgrid.extend({jqGridExport:function(t){t=n.extend({exptype:"xmlstring",root:"grid",ident:"\t",addOptions:{}},t||{});var i=null;return this.each(function(){if(this.grid){var r=n.extend(!0,{},n(this).jqGrid("getGridParam"),t.addOptions);r.rownumbers&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.multiselect&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.subGrid&&(r.colNames.splice(0,1),r.colModel.splice(0,1));r.knv=null;switch(t.exptype){case"xmlstring":i="<"+t.root+">"+jqGridUtils.jsonToXML(r,{xmlDecl:""})+"<\/"+t.root+">";break;case"jsonstring":i=jqGridUtils.stringify(r);t.root&&(i="{"+t.root+":"+i+"}")}}}),i},excelExport:function(t){return t=n.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",beforeExport:null,exporthidden:!1,exportgrouping:!1,exportOptions:{}},t||{}),this.each(function(){var h,i,f,e,o,s;if(this.grid&&t.exptype==="remote"){if(i=n.extend({},this.p.postData),i[t.oper]=t.tag,n.isFunction(t.beforeExport)&&(e=t.beforeExport.call(this,i),n.isPlainObject(e)&&(i=e)),t.exporthidden){for(var u=this.p.colModel,l=u.length,c=[],r=0;r<l;r++)u[r].hidden===undefined&&(u[r].hidden=!1),c.push({name:u[r].name,hidden:u[r].hidden});o=JSON.stringify(c);typeof o=="string"&&(i.colModel=o)}t.exportgrouping&&(f=JSON.stringify(this.p.groupingView),typeof f=="string"&&(i.groupingView=f));s=jQuery.param(i);h=t.url.indexOf("?")!==-1?t.url+"&"+s:t.url+"?"+s;window.location=h}})}});n.jgrid.inlineEdit=n.jgrid.inlineEdit||{};n.jgrid.extend({editRow:function(t,i,r,u,f,e,o,s,h){var c={},l=n.makeArray(arguments).slice(1);return n.type(l[0])==="object"?c=l[0]:(i!==undefined&&(c.keys=i),n.isFunction(r)&&(c.oneditfunc=r),n.isFunction(u)&&(c.successfunc=u),f!==undefined&&(c.url=f),e!==undefined&&(c.extraparam=e),n.isFunction(o)&&(c.aftersavefunc=o),n.isFunction(s)&&(c.errorfunc=s),n.isFunction(h)&&(c.afterrestorefunc=h)),c=n.extend(!0,{keys:!1,keyevent:"keydown",oneditfunc:null,successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST",focusField:!0},n.jgrid.inlineEdit,c),this.each(function(){var i=this,f,u,l,a=0,o=null,h={},e,r,s,v=n(this).jqGrid("getStyleUI",i.p.styleUI+".inlinedit","inputClass",!0);if(i.grid&&(e=n(i).jqGrid("getInd",t,!0),e!==!1)){if(i.p.beforeAction=!0,s=n.isFunction(c.beforeEditRow)?c.beforeEditRow.call(i,c,t):undefined,s===undefined&&(s=!0),!s){i.p.beforeAction=!1;return}if(l=n(e).attr("editable")||"0",l==="0"&&!n(e).hasClass("not-editable-row")&&(r=i.p.colModel,n('td[role="gridcell"]',e).each(function(e){var c,l,s;if(f=r[e].name,c=i.p.treeGrid===!0&&f===i.p.ExpandColumn,c)u=n("span:first",this).html();else try{u=n.unformat.call(i,this,{rowId:t,colModel:r[e]},e)}catch(y){u=r[e].edittype&&r[e].edittype==="textarea"?n(this).text():n(this).html()}f!=="cb"&&f!=="subgrid"&&f!=="rn"&&(i.p.autoencode&&(u=n.jgrid.htmlDecode(u)),h[f]=u,r[e].editable===!0&&(o===null&&(o=e),c?n("span:first",this).html(""):n(this).html(""),l=n.extend({},r[e].editoptions||{},{id:t+"_"+f,name:f,rowId:t,oper:"edit"}),r[e].edittype||(r[e].edittype="text"),(u==="&nbsp;"||u==="&#160;"||u.length===1&&u.charCodeAt(0)===160)&&(u=""),s=n.jgrid.createEl.call(i,r[e].edittype,l,u,!0,n.extend({},n.jgrid.ajaxOptions,i.p.ajaxSelectOptions||{})),n(s).addClass("editable inline-edit-cell"),n.inArray(r[e].edittype,["text","textarea","password","select"])>-1&&n(s).addClass(v),c?n("span:first",this).append(s):n(this).append(s),n.jgrid.bindEv.call(i,s,l),r[e].edittype==="select"&&r[e].editoptions!==undefined&&r[e].editoptions.multiple===!0&&r[e].editoptions.dataUrl===undefined&&n.jgrid.msie()&&n(s).width(n(s).width()),a++))}),a>0)){if(h.id=t,i.p.savedRow.push(h),n(e).attr("editable","1"),c.focusField&&(typeof c.focusField=="number"&&parseInt(c.focusField,10)<=r.length&&(o=c.focusField),setTimeout(function(){var t=n("td:eq("+o+") :input:visible",e).not(":disabled");t.length>0&&t.focus()},0)),c.keys===!0)n(e).on(c.keyevent,function(r){if(r.keyCode===27){if(n(i).jqGrid("restoreRow",t,c.afterrestorefunc),i.p.inlineNav)try{n(i).jqGrid("showAddEditButtons")}catch(f){}return!1}if(r.keyCode===13){var u=r.target;if(u.tagName==="TEXTAREA")return!0;if(n(i).jqGrid("saveRow",t,c)&&i.p.inlineNav)try{n(i).jqGrid("showAddEditButtons")}catch(e){}return!1}});n(i).triggerHandler("jqGridInlineEditRow",[t,c]);n.isFunction(c.oneditfunc)&&c.oneditfunc.call(i,t)}}})},saveRow:function(t,i,r,u,f,e,o){var vt=n.makeArray(arguments).slice(1),h={},s=this[0],a,rt,nt,st,ht,y,ut,ft,et,ct,lt,tt,at;n.type(vt[0])==="object"?h=vt[0]:(n.isFunction(i)&&(h.successfunc=i),r!==undefined&&(h.url=r),u!==undefined&&(h.extraparam=u),n.isFunction(f)&&(h.aftersavefunc=f),n.isFunction(e)&&(h.errorfunc=e),n.isFunction(o)&&(h.afterrestorefunc=o));h=n.extend(!0,{successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:!0,mtype:"POST",saveui:"enable",savetext:n.jgrid.getRegional(s,"defaults.savetext")},n.jgrid.inlineEdit,h);var k=!1,l,c={},d={},p={},yt,w,b,v,pt=!1,wt=n.trim(n(s).jqGrid("getStyleUI",s.p.styleUI+".common","error",!0));if(!s.grid||(v=n(s).jqGrid("getInd",t,!0),v===!1))return k;var it=n.jgrid.getRegional(s,"errors"),g=n.jgrid.getRegional(s,"edit"),ot=n.isFunction(h.beforeSaveRow)?h.beforeSaveRow.call(s,h,t):undefined;if(ot===undefined&&(ot=!0),ot){if(yt=n(v).attr("editable"),h.url=h.url||s.p.editurl,yt==="1"){if(n('td[role="gridcell"]',v).each(function(t){var i,u,r;if(a=s.p.colModel[t],l=a.name,nt="",l!=="cb"&&l!=="subgrid"&&a.editable===!0&&l!=="rn"&&!n(this).hasClass("not-editable-cell")){switch(a.edittype){case"checkbox":i=["Yes","No"];a.editoptions&&(i=a.editoptions.value.split(":"));c[l]=n("input",this).is(":checked")?i[0]:i[1];nt=n("input",this);break;case"text":case"password":case"textarea":case"button":c[l]=n("input, textarea",this).val();nt=n("input, textarea",this);break;case"select":a.editoptions.multiple?(u=n("select",this),r=[],c[l]=n(u).val(),c[l]=c[l]?c[l].join(","):"",n("select option:selected",this).each(function(t,i){r[t]=n(i).text()}),d[l]=r.join(",")):(c[l]=n("select option:selected",this).val(),d[l]=n("select option:selected",this).text());a.formatter&&a.formatter==="select"&&(d={});nt=n("select",this);break;case"custom":try{if(a.editoptions&&n.isFunction(a.editoptions.custom_value)){if(c[l]=a.editoptions.custom_value.call(s,n(".customelement",this),"get"),c[l]===undefined)throw"e2";}else throw"e1";}catch(f){f==="e1"?n.jgrid.info_dialog(it.errcap,"function 'custom_value' "+g.msg.nodefined,g.bClose,{styleUI:s.p.styleUI}):n.jgrid.info_dialog(it.errcap,f.message,g.bClose,{styleUI:s.p.styleUI})}}if(b=n.jgrid.checkValues.call(s,c[l],t),b[0]===!1)return rt=t,!1;s.p.autoencode&&(c[l]=n.jgrid.htmlEncode(c[l]));h.url!=="clientArray"&&a.editoptions&&a.editoptions.NullIfEmpty===!0&&c[l]===""&&(p[l]="null",pt=!0)}}),b[0]===!1){try{n.isFunction(s.p.validationCell)?s.p.validationCell.call(s,nt,b[1],v.rowIndex,rt):(st=n(s).jqGrid("getGridRowById",t),ht=n.jgrid.findPos(st),n.jgrid.info_dialog(it.errcap,b[1],g.bClose,{left:ht[0],top:ht[1]+n(st).outerHeight(),styleUI:s.p.styleUI,onClose:function(){rt>=0&&n("#"+t+"_"+s.p.colModel[rt].name).focus()}}))}catch(bt){alert(b[1])}return k}if(ut=s.p.prmNames,ft=t,y=s.p.keyName===!1?ut.id:s.p.keyName,c&&(c[ut.oper]=ut.editoper,c[y]===undefined||c[y]===""?c[y]=t:v.id!==s.p.idPrefix+c[y]&&(et=n.jgrid.stripPref(s.p.idPrefix,t),s.p._index[et]!==undefined&&(s.p._index[c[y]]=s.p._index[et],delete s.p._index[et]),t=s.p.idPrefix+c[y],n(v).attr("id",t),s.p.selrow===ft&&(s.p.selrow=t),n.isArray(s.p.selarrrow)&&(ct=n.inArray(ft,s.p.selarrrow),ct>=0&&(s.p.selarrrow[ct]=t)),s.p.multiselect&&(lt="jqg_"+s.p.id+"_"+t,n("input.cbox",v).attr("id",lt).attr("name",lt))),s.p.inlineData===undefined&&(s.p.inlineData={}),c=n.extend({},c,s.p.inlineData,h.extraparam)),h.url==="clientArray"){for(c=n.extend({},c,d),s.p.autoencode&&n.each(c,function(t,i){c[t]=n.jgrid.htmlDecode(i)}),at=n(s).jqGrid("setRowData",t,c),n(v).attr("editable","0"),tt=0;tt<s.p.savedRow.length;tt++)if(String(s.p.savedRow[tt].id)===String(ft)){w=tt;break}w>=0&&s.p.savedRow.splice(w,1);n(s).triggerHandler("jqGridInlineAfterSaveRow",[t,at,c,h]);n.isFunction(h.aftersavefunc)&&h.aftersavefunc.call(s,t,at,c,h);k=!0;n(v).removeClass("jqgrid-new-row").off("keydown")}else n(s).jqGrid("progressBar",{method:"show",loadtype:h.saveui,htmlcontent:h.savetext}),p=n.extend({},c,p),p[y]=n.jgrid.stripPref(s.p.idPrefix,p[y]),n.ajax(n.extend({url:h.url,data:n.isFunction(s.p.serializeRowData)?s.p.serializeRowData.call(s,p):p,type:h.mtype,async:!1,complete:function(i,r){if(n(s).jqGrid("progressBar",{method:"hide",loadtype:h.saveui,htmlcontent:h.savetext}),r==="success"){var e=!0,u,f;if(u=n(s).triggerHandler("jqGridInlineSuccessSaveRow",[i,t,h]),n.isArray(u)||(u=[!0,i.responseJSON.data]),u[0]&&n.isFunction(h.successfunc)&&(u=h.successfunc.call(s,i)),n.isArray(u)?(e=u[0],c=u[1]||c):e=u,e===!0){for(s.p.autoencode&&n.each(c,function(t,i){c[t]=n.jgrid.htmlDecode(i)}),pt&&n.each(c,function(n){c[n]==="null"&&(c[n]="")}),c=n.extend({},c,d),n(s).jqGrid("setRowData",t,c),n(v).attr("editable","0"),f=0;f<s.p.savedRow.length;f++)if(String(s.p.savedRow[f].id)===String(t)){w=f;break}w>=0&&s.p.savedRow.splice(w,1);n(s).triggerHandler("jqGridInlineAfterSaveRow",[t,i,c,h]);n.isFunction(h.aftersavefunc)&&h.aftersavefunc.call(s,t,i,c,h);k=!0;n(v).removeClass("jqgrid-new-row").off("keydown")}else n(s).triggerHandler("jqGridInlineErrorSaveRow",[t,i,r,null,h]),n.isFunction(h.errorfunc)&&h.errorfunc.call(s,t,i,r,null),h.restoreAfterError===!0&&n(s).jqGrid("restoreRow",t,h.afterrestorefunc)}},error:function(i,r,u){if(n("#lui_"+n.jgrid.jqID(s.p.id)).hide(),n(s).triggerHandler("jqGridInlineErrorSaveRow",[t,i,r,u,h]),n.isFunction(h.errorfunc))h.errorfunc.call(s,t,i,r,u);else{var f=i.responseText||i.statusText;try{n.jgrid.info_dialog(it.errcap,'<div class="'+wt+'">'+f+"<\/div>",g.bClose,{buttonalign:"right",styleUI:s.p.styleUI})}catch(e){alert(f)}}h.restoreAfterError===!0&&n(s).jqGrid("restoreRow",t,h.afterrestorefunc)}},n.jgrid.ajaxOptions,s.p.ajaxRowOptions||{}))}return k}},restoreRow:function(t,i){var u=n.makeArray(arguments).slice(1),r={};return n.type(u[0])==="object"?r=u[0]:n.isFunction(i)&&(r.afterrestorefunc=i),r=n.extend(!0,{},n.jgrid.inlineEdit,r),this.each(function(){var i=this,u=-1,e,s={},f,o;if(i.grid&&(e=n(i).jqGrid("getInd",t,!0),e!==!1)&&(o=n.isFunction(r.beforeCancelRow)?r.beforeCancelRow.call(i,r,t):undefined,o===undefined&&(o=!0),o)){for(f=0;f<i.p.savedRow.length;f++)if(String(i.p.savedRow[f].id)===String(t)){u=f;break}if(u>=0){if(n.isFunction(n.fn.datepicker))try{n("input.hasDatepicker","#"+n.jgrid.jqID(e.id)).datepicker("hide")}catch(h){}n.each(i.p.colModel,function(){this.editable===!0&&i.p.savedRow[u].hasOwnProperty(this.name)&&(s[this.name]=i.p.savedRow[u][this.name])});n(i).jqGrid("setRowData",t,s);n(e).attr("editable","0").off("keydown");i.p.savedRow.splice(u,1);n("#"+n.jgrid.jqID(t),"#"+n.jgrid.jqID(i.p.id)).hasClass("jqgrid-new-row")&&setTimeout(function(){n(i).jqGrid("delRowData",t);n(i).jqGrid("showAddEditButtons")},0)}n(i).triggerHandler("jqGridInlineAfterRestoreRow",[t]);n.isFunction(r.afterrestorefunc)&&r.afterrestorefunc.call(i,t)}})},addRow:function(t){return t=n.extend(!0,{rowID:null,initdata:{},position:"first",useDefValues:!0,useFormatter:!1,addRowParams:{extraparam:{}}},t||{}),this.each(function(){var i,r,u,f;if(this.grid){if(i=this,i.p.beforeAction=!0,r=n.isFunction(t.beforeAddRow)?t.beforeAddRow.call(i,t.addRowParams):undefined,r===undefined&&(r=!0),!r){i.p.beforeAction=!1;return}t.rowID=n.isFunction(t.rowID)?t.rowID.call(i,t):t.rowID!=null?t.rowID:n.jgrid.randId();t.useDefValues===!0&&n(i.p.colModel).each(function(){if(this.editoptions&&this.editoptions.defaultValue){var r=this.editoptions.defaultValue,u=n.isFunction(r)?r.call(i):r;t.initdata[this.name]=u}});n(i).jqGrid("addRowData",t.rowID,t.initdata,t.position);t.rowID=i.p.idPrefix+t.rowID;n("#"+n.jgrid.jqID(t.rowID),"#"+n.jgrid.jqID(i.p.id)).addClass("jqgrid-new-row");t.useFormatter?n("#"+n.jgrid.jqID(t.rowID)+" .ui-inline-edit","#"+n.jgrid.jqID(i.p.id)).click():(u=i.p.prmNames,f=u.oper,t.addRowParams.extraparam[f]=u.addoper,n(i).jqGrid("editRow",t.rowID,t.addRowParams),n(i).jqGrid("setSelection",t.rowID))}})},inlineNav:function(t,i){var r=this[0],f=n.jgrid.getRegional(r,"nav"),u=n.jgrid.styleUI[r.p.styleUI].inlinedit;return i=n.extend(!0,{del:!0,delicon:u.icon_del_nav,edit:!0,editicon:u.icon_edit_nav,add:!0,addicon:u.icon_add_nav,save:!0,saveicon:u.icon_save_nav,cancel:!0,cancelicon:u.icon_cancel_nav,addParams:{addRowParams:{extraparam:{}}},editParams:{},restoreAfterSelect:!0,saveAfterSelect:!1},f,i||{}),this.each(function(){var u,e,h,s,c,o;if(this.grid&&!this.p.inlineNav){if(u=n.jgrid.jqID(r.p.id),e=n.trim(n(r).jqGrid("getStyleUI",r.p.styleUI+".common","disabled",!0)),r.p.navGrid||n(r).jqGrid("navGrid",t,{refresh:!1,edit:!1,add:!1,del:!1,search:!1,view:!1}),n(r).data("inlineNav")||n(r).data("inlineNav",i),r.p.force_regional&&(i=n.extend(i,f)),r.p.inlineNav=!0,i.addParams.useFormatter===!0)for(h=r.p.colModel,s=0;s<h.length;s++)if(h[s].formatter&&h[s].formatter==="actions"){h[s].formatoptions&&(c={keys:!1,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null},o=n.extend(c,h[s].formatoptions),i.addParams.addRowParams={keys:o.keys,oneditfunc:o.onEdit,successfunc:o.onSuccess,url:o.url,extraparam:o.extraparam,aftersavefunc:o.afterSave,errorfunc:o.onError,afterrestorefunc:o.afterRestore});break}if(i.add&&n(r).jqGrid("navButtonAdd",t,{caption:i.addtext,title:i.addtitle,buttonicon:i.addicon,id:r.p.id+"_iladd",internal:!0,onClickButton:function(){r.p.beforeAction===undefined&&(r.p.beforeAction=!0);n(r).jqGrid("addRow",i.addParams);!i.addParams.useFormatter&&r.p.beforeAction&&(n("#"+u+"_ilsave").removeClass(e),n("#"+u+"_ilcancel").removeClass(e),r.p.editurl!=="clientArray"&&(n("#"+u+"_iladd").addClass(e),n("#"+u+"_iledit").addClass(e)))}}),i.edit&&n(r).jqGrid("navButtonAdd",t,{caption:i.edittext,title:i.edittitle,buttonicon:i.editicon,id:r.p.id+"_iledit",internal:!0,onClickButton:function(){var t=n(r).jqGrid("getGridParam","selrow");t?(r.p.beforeAction===undefined&&(r.p.beforeAction=!0),n(r).jqGrid("editRow",t,i.editParams),r.p.beforeAction&&(n("#"+u+"_ilsave").removeClass(e),n("#"+u+"_ilcancel").removeClass(e),n("#"+u+"_iladd").addClass(e),n("#"+u+"_iledit").addClass(e))):(n.jgrid.viewModal("#alertmod_"+u,{gbox:"#gbox_"+u,jqm:!0}),n("#jqg_alrt").focus())}}),i.del&&n(r).jqGrid("navButtonAdd",t,{caption:i.deltext,title:i.deltitle,buttonicon:i.delicon,id:r.p.id+"_ildel",internal:!0,onClickButton:function(){var t=n(r).jqGrid("getGridParam","selrow");if(t)if(r.p.beforeAction===undefined&&(r.p.beforeAction=!0),r.p.editurl==="clientArray")n(r).jqGrid("delRowData",t);else{if(t.indexOf("jqg")>-1)return;bootbox.confirm(i.deltitle+"?",function(i){i&&n.post(r.p.editurl,{oper:"del",logicdelete:!1,Id:t},function(i){i.success&&n(r).jqGrid("delRowData",t);i.msg&&bootbox.alert(i.msg)})})}else n.jgrid.viewModal("#alertmod_"+u,{gbox:"#gbox_"+u,jqm:!0}),n("#jqg_alrt").focus()}}),i.save&&(n(r).jqGrid("navButtonAdd",t,{caption:i.savetext||"",title:i.savetitle||"Save row",buttonicon:i.saveicon,id:r.p.id+"_ilsave",internal:!0,onClickButton:function(){var t=r.p.savedRow[0].id;if(t){var f=r.p.prmNames,e=f.oper,o=i.editParams;n("#"+n.jgrid.jqID(t),"#"+u).hasClass("jqgrid-new-row")?(i.addParams.addRowParams.extraparam[e]=f.addoper,o=i.addParams.addRowParams):(i.editParams.extraparam||(i.editParams.extraparam={}),i.editParams.extraparam[e]=f.editoper);n(r).jqGrid("saveRow",t,o)&&n(r).jqGrid("showAddEditButtons")}else n.jgrid.viewModal("#alertmod_"+u,{gbox:"#gbox_"+u,jqm:!0}),n("#jqg_alrt").focus()}}),n("#"+u+"_ilsave").addClass(e)),i.cancel&&(n(r).jqGrid("navButtonAdd",t,{caption:i.canceltext||"",title:i.canceltitle||"Cancel row editing",buttonicon:i.cancelicon,id:r.p.id+"_ilcancel",internal:!0,onClickButton:function(){var t=r.p.savedRow[0].id,f=i.editParams;t?(n("#"+n.jgrid.jqID(t),"#"+u).hasClass("jqgrid-new-row")&&(f=i.addParams.addRowParams),n(r).jqGrid("restoreRow",t,f),n(r).jqGrid("showAddEditButtons")):(n.jgrid.viewModal("#alertmod",{gbox:"#gbox_"+u,jqm:!0}),n("#jqg_alrt").focus())}}),n("#"+u+"_ilcancel").addClass(e)),i.restoreAfterSelect===!0||i.saveAfterSelect===!0)n(r).on("jqGridBeforeSelectRow.inlineNav",function(t,u){r.p.savedRow.length>0&&r.p.inlineNav===!0&&u!==r.p.selrow&&r.p.selrow!==null&&(r.p.selrow===i.addParams.rowID?n(r).jqGrid("delRowData",r.p.selrow):i.restoreAfterSelect===!0?n(r).jqGrid("restoreRow",r.p.selrow,i.editParams):n(r).jqGrid("saveRow",r.p.selrow,i.editParams),n(r).jqGrid("showAddEditButtons"));n(r).jqGrid("setSelection",u,!1)})}})},showAddEditButtons:function(){return this.each(function(){if(this.grid){var t=n.jgrid.jqID(this.p.id),i=n.trim(n(this).jqGrid("getStyleUI",this.p.styleUI+".common","disabled",!0));n("#"+t+"_ilsave").addClass(i);n("#"+t+"_ilcancel").addClass(i);n("#"+t+"_iladd").removeClass(i);n("#"+t+"_iledit").removeClass(i)}})}});n.jgrid.msie()&&n.jgrid.msiever()===8&&(n.expr[":"].hidden=function(n){return n.offsetWidth===0||n.offsetHeight===0||n.style.display==="none"});n.jgrid._multiselect=!1;n.ui&&n.ui.multiselect&&(n.ui.multiselect.prototype._setSelected&&(w=n.ui.multiselect.prototype._setSelected,n.ui.multiselect.prototype._setSelected=function(t,i){var u=w.call(this,t,i),r;return i&&this.selectedList&&(r=this.element,this.selectedList.find("li").each(function(){n(this).data("optionLink")&&n(this).data("optionLink").remove().appendTo(r)})),u}),n.ui.multiselect.prototype.destroy&&(n.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();n.Widget===undefined?n.widget.prototype.destroy.apply(this,arguments):n.Widget.prototype.destroy.apply(this,arguments)}),n.jgrid._multiselect=!0);n.jgrid.extend({sortableColumns:function(t){return this.each(function(){function o(){i.p.disableClick=!0}var i=this,u=n.jgrid.jqID(i.p.id),r={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+u+"_cb,#jqgh_"+u+"_rn,#jqgh_"+u+"_subgrid),:hidden)",placeholder:{element:function(t){return n(document.createElement(t[0].nodeName)).addClass(t[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(n,t){t.height(n.currentItem.innerHeight()-parseInt(n.currentItem.css("paddingTop")||0,10)-parseInt(n.currentItem.css("paddingBottom")||0,10));t.width(n.currentItem.innerWidth()-parseInt(n.currentItem.css("paddingLeft")||0,10)-parseInt(n.currentItem.css("paddingRight")||0,10))}},update:function(t,r){var e=n(r.item).parent(),o=n(">th",e),s=i.p.colModel,f={},h=i.p.id+"_",u;n.each(s,function(n){f[this.name]=n});u=[];o.each(function(){var t=n(">div",this).get(0).id.replace(/^jqgh_/,"").replace(h,"");f.hasOwnProperty(t)&&u.push(f[t])});n(i).jqGrid("remapColumns",u,!0,!0);n.isFunction(i.p.sortable.update)&&i.p.sortable.update(u);setTimeout(function(){i.p.disableClick=!1},50)}},s,f,e;i.p.sortable.options?n.extend(r,i.p.sortable.options):n.isFunction(i.p.sortable)&&(i.p.sortable={update:i.p.sortable});r.start?(s=r.start,r.start=function(n,t){o();s.call(this,n,t)}):r.start=o;i.p.sortable.exclude&&(r.items+=":not("+i.p.sortable.exclude+")");f=t.sortable(r);e=f.data("sortable")||f.data("uiSortable");e!=null&&(e.data("sortable").floating=!0)})},columnChooser:function(t){function b(n,t,i){var r,u;return t>=0?(r=n.slice(),u=r.splice(t,Math.max(n.length-t,t)),t>n.length&&(t=n.length),r[t]=i,r.concat(u)):n}function s(t,i){t&&(typeof t=="string"?n.fn[t]&&n.fn[t].apply(i,n.makeArray(arguments).slice(2)):n.isFunction(t)&&t.apply(i,n.makeArray(arguments).slice(2)))}var i=this,f,r,h={},y=[],l,a,c,u,e,o=i.jqGrid("getGridParam","colModel"),p=i.jqGrid("getGridParam","colNames"),v=function(t){return n.ui.multiselect.prototype&&t.data(n.ui.multiselect.prototype.widgetFullName||n.ui.multiselect.prototype.widgetName)||t.data("ui-multiselect")||t.data("multiselect")},w=n.jgrid.getRegional(this[0],"col");if(!n("#colchooser_"+n.jgrid.jqID(i[0].p.id)).length){if(f=n('<div id="colchooser_'+i[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"><\/select><\/div><\/div>'),r=n("select",f),t=n.extend({width:400,height:240,classname:null,done:function(n){n&&i.jqGrid("remapColumns",n,!0)},msel:"multiselect",dlog:"dialog",dialog_opts:{minWidth:470,dialogClass:"ui-jqdialog"},dlog_opts:function(t){var i={};return i[t.bSubmit]=function(){t.apply_perm();t.cleanup(!1)},i[t.bCancel]=function(){t.cleanup(!0)},n.extend(!0,{buttons:i,close:function(){t.cleanup(!0)},modal:t.modal||!1,resizable:t.resizable||!0,width:t.width+70,resize:function(){var n=v(r),t=n.container.closest(".ui-dialog-content");t.length>0&&typeof t[0].style=="object"?t[0].style.width="":t.css("width","");n.selectedList.height(Math.max(n.selectedContainer.height()-n.selectedActions.outerHeight()-1,1));n.availableList.height(Math.max(n.availableContainer.height()-n.availableActions.outerHeight()-1,1))}},t.dialog_opts||{})},apply_perm:function(){var u=[];n("option",r).each(function(){n(this).is(":selected")?i.jqGrid("showCol",o[this.value].name):i.jqGrid("hideCol",o[this.value].name)});n("option[selected]",r).each(function(){u.push(parseInt(this.value,10))});n.each(u,function(){delete h[o[parseInt(this,10)].name]});n.each(h,function(){var n=parseInt(this,10);u=b(u,n,n)});t.done&&t.done.call(i,u);i.jqGrid("setGridWidth",i[0].p.width,i[0].p.shrinkToFit)},cleanup:function(n){s(t.dlog,f,"destroy");s(t.msel,r,"destroy");f.remove();n&&t.done&&t.done.call(i)},msel_opts:{}},w,t||{}),n.ui&&n.ui.multiselect&&n.ui.multiselect.defaults){if(!n.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}t.msel_opts=n.extend(n.ui.multiselect.defaults,t.msel_opts)}t.caption&&f.attr("title",t.caption);t.classname&&(f.addClass(t.classname),r.addClass(t.classname));t.width&&(n(">div",f).css({width:t.width,margin:"0 auto"}),r.css("width",t.width));t.height&&(n(">div",f).css("height",t.height),r.css("height",t.height-10));r.empty();n.each(o,function(t){if(h[this.name]=t,this.hidedlg){this.hidden||y.push(t);return}r.append("<option value='"+t+"' "+(this.hidden?"":"selected='selected'")+">"+n.jgrid.stripHtml(p[t])+"<\/option>")});l=n.isFunction(t.dlog_opts)?t.dlog_opts.call(i,t):t.dlog_opts;s(t.dlog,f,l);a=n.isFunction(t.msel_opts)?t.msel_opts.call(i,t):t.msel_opts;s(t.msel,r,a);c=n("#colchooser_"+n.jgrid.jqID(i[0].p.id));c.css({margin:"auto"});c.find(">div").css({width:"100%",height:"100%",margin:"auto"});u=v(r);u.container.css({width:"100%",height:"100%",margin:"auto"});u.selectedContainer.css({width:u.options.dividerLocation*100+"%",height:"100%",margin:"auto",boxSizing:"border-box"});u.availableContainer.css({width:100-u.options.dividerLocation*100+"%",height:"100%",margin:"auto",boxSizing:"border-box"});u.selectedList.css("height","auto");u.availableList.css("height","auto");e=Math.max(u.selectedList.height(),u.availableList.height());e=Math.min(e,n(window).height());u.selectedList.css("height",e);u.availableList.css("height",e)}},sortableRows:function(t){return this.each(function(){var i=this;i.grid&&(i.p.treeGrid||n.fn.sortable&&(t=n.extend({cursor:"move",axis:"y",items:" > .jqgrow"},t||{}),t.start&&n.isFunction(t.start)?(t._start_=t.start,delete t.start):t._start_=!1,t.update&&n.isFunction(t.update)?(t._update_=t.update,delete t.update):t._update_=!1,t.start=function(r,u){if(n(u.item).css("border-width","0"),n("td",u.item).each(function(n){this.style.width=i.grid.cols[n].style.width}),i.p.subGrid){var f=n(u.item).attr("id");try{n(i).jqGrid("collapseSubGridRow",f)}catch(e){}}t._start_&&t._start_.apply(this,[r,u])},t.update=function(r,u){n(u.item).css("border-width","");i.p.rownumbers===!0&&n("td.jqgrid-rownum",i.rows).each(function(t){n(this).html(t+1+(parseInt(i.p.page,10)-1)*parseInt(i.p.rowNum,10))});t._update_&&t._update_.apply(this,[r,u])},n("tbody:first",i).sortable(t),n("tbody:first > .jqgrow",i).disableSelection()))})},gridDnD:function(t){return this.each(function(){function e(){var t=n.data(i,"dnd");n("tr.jqgrow:not(.ui-draggable)",i).draggable(n.isFunction(t.drag)?t.drag.call(n(i),t):t.drag)}var i=this,u,f,o,r;if(i.grid&&!i.p.treeGrid&&n.fn.draggable&&n.fn.droppable){if(o="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'><\/table>",n("#jqgrid_dnd")[0]===undefined&&n("body").append(o),typeof t=="string"&&t==="updateDnD"&&i.p.jqgdnd===!0){e();return}if(t=n.extend({drag:function(t){return n.extend({start:function(r,u){var f,e;if(i.p.subGrid){e=n(u.helper).attr("id");try{n(i).jqGrid("collapseSubGridRow",e)}catch(o){}}for(f=0;f<n.data(i,"dnd").connectWith.length;f++)n(n.data(i,"dnd").connectWith[f]).jqGrid("getGridParam","reccount")===0&&n(n.data(i,"dnd").connectWith[f]).jqGrid("addRowData","jqg_empty_row",{});u.helper.addClass("ui-state-highlight");n("td",u.helper).each(function(n){this.style.width=i.grid.headers[n].width+"px"});t.onstart&&n.isFunction(t.onstart)&&t.onstart.call(n(i),r,u)},stop:function(r,u){var f,e;for(u.helper.dropped&&!t.dragcopy&&(e=n(u.helper).attr("id"),e===undefined&&(e=n(this).attr("id")),n(i).jqGrid("delRowData",e)),f=0;f<n.data(i,"dnd").connectWith.length;f++)n(n.data(i,"dnd").connectWith[f]).jqGrid("delRowData","jqg_empty_row");t.onstop&&n.isFunction(t.onstop)&&t.onstop.call(n(i),r,u)}},t.drag_opts||{})},drop:function(t){return n.extend({accept:function(t){if(!n(t).hasClass("jqgrow"))return t;if(r=n(t).closest("table.ui-jqgrid-btable"),r.length>0&&n.data(r[0],"dnd")!==undefined){var i=n.data(r[0],"dnd").connectWith;return n.inArray("#"+n.jgrid.jqID(this.id),i)!==-1?!0:!1}return!1},drop:function(i,u){var l,f,o,s;if(n(u.draggable).hasClass("jqgrow")){if(l=n(u.draggable).attr("id"),f=u.draggable.parent().parent().jqGrid("getRowData",l),!t.dropbyname){var c=0,a={},e,h,v=n("#"+n.jgrid.jqID(this.id)).jqGrid("getGridParam","colModel");try{for(h in f)f.hasOwnProperty(h)&&(e=v[c].name,e==="cb"||e==="rn"||e==="subgrid"||f.hasOwnProperty(h)&&v[c]&&(a[e]=f[h]),c++);f=a}catch(y){}}u.helper.dropped=!0;n.data(r[0],"dnd").beforedrop&&n.isFunction(n.data(r[0],"dnd").beforedrop)&&(o=n.data(r[0],"dnd").beforedrop.call(this,i,u,f,n(r[0]),n(this)),o!==undefined&&o!==null&&typeof o=="object"&&(f=o));u.helper.dropped&&(t.autoid&&(n.isFunction(t.autoid)?s=t.autoid.call(this,f):(s=Math.ceil(Math.random()*1e3),s=t.autoidprefix+s)),n("#"+n.jgrid.jqID(this.id)).jqGrid("addRowData",s,f,t.droppos));t.ondrop&&n.isFunction(t.ondrop)&&t.ondrop.call(this,i,u,f)}}},t.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5e3},dragcopy:!1,dropbyname:!1,droppos:"first",autoid:!0,autoidprefix:"dnd_"},t||{}),t.connectWith)for(t.connectWith=t.connectWith.split(","),t.connectWith=n.map(t.connectWith,function(t){return n.trim(t)}),n.data(i,"dnd",t),i.p.reccount===0||i.p.jqgdnd||e(),i.p.jqgdnd=!0,u=0;u<t.connectWith.length;u++)f=t.connectWith[u],n(f).droppable(n.isFunction(t.drop)?t.drop.call(n(i),t):t.drop)}})},gridResize:function(t){return this.each(function(){var i=this,r=n.jgrid.jqID(i.p.id),u,f;i.grid&&n.fn.resizable&&(t=n.extend({},t||{}),t.alsoResize?(t._alsoResize_=t.alsoResize,delete t.alsoResize):t._alsoResize_=!1,t.stop&&n.isFunction(t.stop)?(t._stop_=t.stop,delete t.stop):t._stop_=!1,t.stop=function(f,e){n(i).jqGrid("setGridParam",{height:n("#gview_"+r+" .ui-jqgrid-bdiv").height()});n(i).jqGrid("setGridWidth",e.size.width,t.shrinkToFit);t._stop_&&t._stop_.call(i,f,e);i.p.caption&&n("#gbox_"+r).css({height:"auto"});i.p.frozenColumns&&(u&&clearTimeout(u),u=setTimeout(function(){u&&clearTimeout(u);n("#"+r).jqGrid("destroyFrozenColumns");n("#"+r).jqGrid("setFrozenColumns")}))},t._alsoResize_?(f="{'#gview_"+r+" .ui-jqgrid-bdiv':true,'"+t._alsoResize_+"':true}",t.alsoResize=eval("("+f+")")):t.alsoResize=n(".ui-jqgrid-bdiv","#gview_"+r),delete t._alsoResize_,n("#gbox_"+r).resizable(t))})}});n.assocArraySize=function(n){var t=0;for(var i in n)n.hasOwnProperty(i)&&t++;return t};n.jgrid.extend({pivotSetup:function(t,i){var u=[],e=[],h=[],s=[],c=[],o={grouping:!0,groupingView:{groupField:[],groupSummary:[],groupSummaryPos:[]}},f=[],r=n.extend({rowTotals:!1,rowTotalsText:"Total",colTotals:!1,groupSummary:!0,groupSummaryPos:"header",frozenStaticCols:!1},i||{});return this.each(function(){function kt(n,t,i){var r;return r=nt.call(n,t,i),r.length>0?r[0]:null}function dt(n,t){var i=0,r=!0;for(var u in n)if(n.hasOwnProperty(u)){if(n[u]!=this[i]){r=!1;break}if(i++,i>=this.length)break}return r&&(g=t),r}function gt(t,i,r,u,f){var e;if(n.isFunction(t))e=t.call(this,i,r,u);else switch(t){case"sum":e=parseFloat(i||0)+parseFloat(u[r]||0);break;case"count":(i===""||i==null)&&(i=0);e=u.hasOwnProperty(r)?i+1:0;break;case"min":e=i===""||i==null?parseFloat(u[r]||0):Math.min(parseFloat(i),parseFloat(u[r]||0));break;case"max":e=i===""||i==null?parseFloat(u[r]||0):Math.max(parseFloat(i),parseFloat(u[r]||0));break;case"avg":e=(parseFloat(i||0)*(f-1)+parseFloat(u[r]||0))/f}return e}function ot(t,i,r,u){var k=i.length,o,f,h,p,w="",l=[],v,d=1,a,b,y;for(n.isArray(r)?(p=r.length,l=r):(p=1,l[0]=r),s=[],c=[],s.root=0,h=0;h<p;h++){for(b=[],o=0;o<k;o++){if(v=typeof i[o].aggregator=="string"?i[o].aggregator:"cust",r==null)f=n.trim(i[o].member)+"_"+v,y=f,l[0]=i[o].label||v+" "+n.trim(i[o].member);else{y=r[h].replace(/\s+/g,"");try{f=k===1?w+y:w+y+"_"+v+"_"+String(o)}catch(nt){}l[h]=r[h]}f=isNaN(parseInt(f,10))?f:f+" ";i[o].aggregator==="avg"&&(a=g===-1?e.length+"_"+f:g+"_"+f,ut[a]?ut[a]++:ut[a]=1,d=ut[a]);u[f]=b[f]=gt(i[o].aggregator,u[f],i[o].member,t,d)}w+=r&&r[h]!=null?r[h].replace(/\s+/g,""):"";s[f]=b;c[f]=l[h]}return u}function wt(n){var e,o,t,h,i,s,c,l,v,y;for(t in n)if(n.hasOwnProperty(t)){if(typeof n[t]!="object"){if(t==="level"){if(ft[n.level]===undefined&&(ft[n.level]="",n.level>0&&n.text.indexOf("_r_Totals")===-1&&(f[n.level-1]={useColSpanStyle:!1,groupHeaders:[]})),ft[n.level]!==n.text&&n.children.length&&n.text.indexOf("_r_Totals")===-1&&n.level>0){if(f[n.level-1].groupHeaders.push({titleText:n.label,numberOfColumns:0}),s=f[n.level-1].groupHeaders.length-1,c=s===0?ni:yt,n.level-1==(r.rowTotals?1:0)&&s>0){for(l=0,v=0;v<s;v++)l+=f[n.level-1].groupHeaders[v].numberOfColumns;l&&(c=l+w)}u[c]&&(f[n.level-1].groupHeaders[s].startColumnName=u[c].name,f[n.level-1].groupHeaders[s].numberOfColumns=u.length-c);yt=u.length}ft[n.level]=n.text}if(n.level===a&&t==="level"&&a>0)if(et>1){y=1;for(e in n.fields)n.fields.hasOwnProperty(e)&&(y===1&&f[a-1].groupHeaders.push({startColumnName:e,numberOfColumns:1,titleText:n.label||n.text}),y++);f[a-1].groupHeaders[f[a-1].groupHeaders.length-1].numberOfColumns=y-1}else f.splice(a-1,1)}if(n[t]!=null&&typeof n[t]=="object"&&wt(n[t]),t==="level"&&n.level>0&&(n.level===(a===0?n.level:a)||ft[n.level].indexOf("_r_Totals")!==-1)){o=0;for(e in n.fields)if(n.fields.hasOwnProperty(e)){i={};for(h in r.aggregates[o])if(r.aggregates[o].hasOwnProperty(h))switch(h){case"member":case"label":case"aggregator":break;default:i[h]=r.aggregates[o][h]}et>1?(i.name=e,i.label=r.aggregates[o].label||n.label):(i.name=n.text,i.label=n.text==="_r_Totals"?r.rowTotalsText:n.label);u.push(i);o++}}}}var p,g,i,bt=t.length,w,a,et,b,k,lt=0,pt,st,tt,v,l,it,ct;if(r.rowTotals&&r.yDimension.length>0&&(pt=r.yDimension[0].dataName,r.yDimension.splice(0,0,{dataName:pt}),r.yDimension[0].converter=function(){return"_r_Totals"}),w=n.isArray(r.xDimension)?r.xDimension.length:0,a=r.yDimension.length,et=n.isArray(r.aggregates)?r.aggregates.length:0,w===0||et===0)throw"xDimension or aggregates optiona are not set!";for(i=0;i<w;i++)st={name:r.xDimension[i].dataName,frozen:r.frozenStaticCols},r.xDimension[i].isGroupField==null&&(r.xDimension[i].isGroupField=!0),st=n.extend(!0,st,r.xDimension[i]),u.push(st);for(var at=w-1,rt={},ut=[];lt<bt;){p=t[lt];tt=[];v=[];b={};i=0;do tt[i]=n.trim(p[r.xDimension[i].dataName]),b[r.xDimension[i].dataName]=tt[i],i++;while(i<w);if(l=0,g=-1,k=kt(e,dt,tt),k){if(g>=0){if(l=0,a>=1){for(l=0;l<a;l++)v[l]=n.trim(p[r.yDimension[l].dataName]),r.yDimension[l].converter&&n.isFunction(r.yDimension[l].converter)&&(v[l]=r.yDimension[l].converter.call(this,v[l],tt,v));k=ot(p,r.aggregates,v,k)}else a===0&&(k=ot(p,r.aggregates,null,k));e[g]=k}}else{if(l=0,a>=1){for(l=0;l<a;l++)v[l]=n.trim(p[r.yDimension[l].dataName]),r.yDimension[l].converter&&n.isFunction(r.yDimension[l].converter)&&(v[l]=r.yDimension[l].converter.call(this,v[l],tt,v));b=ot(p,r.aggregates,v,b)}else a===0&&(b=ot(p,r.aggregates,null,b));e.push(b)}var vt=0,y=null,ht=null;for(var d in s)if(s.hasOwnProperty(d)){if(vt===0)rt.children&&rt.children!==undefined||(rt={text:d,level:0,children:[],label:d}),y=rt.children;else{for(ht=null,i=0;i<y.length;i++)if(y[i].text===d){ht=y[i];break}ht?y=ht.children:(y.push({children:[],text:d,level:vt,fields:s[d],label:c[d]}),y=y[y.length-1].children)}vt++}lt++}ut=null;var ft=[],yt=u.length,ni=yt;if(a>0&&(f[a-1]={useColSpanStyle:!1,groupHeaders:[]}),wt(rt),r.colTotals)for(ct=e.length;ct--;)for(i=w;i<u.length;i++)it=u[i].name,h[it]?h[it]+=parseFloat(e[ct][it]||0):h[it]=parseFloat(e[ct][it]||0);if(at>0)for(i=0;i<at;i++)u[i].isGroupField&&(o.groupingView.groupField.push(u[i].name),o.groupingView.groupSummary.push(r.groupSummary),o.groupingView.groupSummaryPos.push(r.groupSummaryPos));else o.grouping=!1;o.sortname=u[at].name;o.groupingView.hideFirstGroupCol=!0}),{colModel:u,rows:e,groupOptions:o,groupHeaders:f,summary:h}},jqPivot:function(t,i,r,u){return this.each(function(){function e(t){var l;if(!n.isArray(t))throw"data provides is not an array";var e=jQuery(f).jqGrid("pivotSetup",t,i),a=n.assocArraySize(e.summary)>0?!0:!1,h=n.jgrid.from.call(f,e.rows),u,c,o,s;for(i.ignoreCase&&(h=h.ignoreCase()),u=0;u<e.groupOptions.groupingView.groupField.length;u++)c=i.xDimension[u].sortorder?i.xDimension[u].sortorder:"asc",o=i.xDimension[u].sorttype?i.xDimension[u].sorttype:"text",h.orderBy(e.groupOptions.groupingView.groupField[u],c,o,"",o);if(s=i.xDimension.length,r.sortname){for(c=r.sortorder?r.sortorder:"asc",o="text",u=0;u<s;u++)if(i.xDimension[u].dataName===r.sortname){o=i.xDimension[u].sorttype?i.xDimension[u].sorttype:"text";break}h.orderBy(r.sortname,c,o,"",o)}else e.groupOptions.sortname&&s&&(c=i.xDimension[s-1].sortorder?i.xDimension[s-1].sortorder:"asc",o=i.xDimension[s-1].sorttype?i.xDimension[s-1].sorttype:"text",h.orderBy(e.groupOptions.sortname,c,o,"",o));if(jQuery(f).jqGrid(n.extend(!0,{datastr:n.extend(h.select(),a?{userdata:e.summary}:{}),datatype:"jsonstring",footerrow:a,userDataOnFooter:a,colModel:e.colModel,viewrecords:!0,sortname:i.xDimension[0].dataName},e.groupOptions,r||{})),l=e.groupHeaders,l.length)for(u=0;u<l.length;u++)l[u]&&l[u].groupHeaders.length&&jQuery(f).jqGrid("setGroupHeaders",l[u]);i.frozenStaticCols&&jQuery(f).jqGrid("setFrozenColumns")}var f=this;typeof t=="string"?n.ajax(n.extend({url:t,dataType:"json",success:function(t){e(n.jgrid.getAccessor(t,u&&u.reader?u.reader:"rows"))}},u||{})):e(t)})}});n.jgrid.extend({setSubGrid:function(){return this.each(function(){var t=this,i,r,u=n.jgrid.styleUI[t.p.styleUI||"jQueryUI"].subgrid,f={plusicon:u.icon_plus,minusicon:u.icon_minus,openicon:u.icon_open,expandOnLoad:!1,delayOnLoad:50,selectOnExpand:!1,selectOnCollapse:!1,reloadOnExpand:!0};if(t.p.subGridOptions=n.extend(f,t.p.subGridOptions||{}),t.p.colNames.unshift(""),t.p.colModel.unshift({name:"subgrid",width:n.jgrid.cell_width?t.p.subGridWidth+t.p.cellLayout:t.p.subGridWidth,sortable:!1,resizable:!1,hidedlg:!0,search:!1,fixed:!0}),i=t.p.subGridModel,i[0])for(i[0].align=n.extend([],i[0].align||[]),r=0;r<i[0].name.length;r++)i[0].align[r]=i[0].align[r]||"left"})},addSubGridCell:function(t,i){var r="",u,f,e;return this.each(function(){r=this.formatCol(t,i);f=this.p.id;u=this.p.subGridOptions.plusicon;e=n.jgrid.styleUI[this.p.styleUI||"jQueryUI"].common}),'<td role="gridcell" aria-describedby="'+f+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+r+"><a style='cursor:pointer;' class='ui-sghref'><span class='"+e.icon_base+" "+u+"'><\/span><\/a><\/td>"},addSubGrid:function(t,i){return this.each(function(){var r=this,a;if(r.grid){var c=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].base,s=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].common,l=function(t,i,u){var f=n("<td align='"+r.p.subGridModel[0].align[u]+"'><\/td>").html(i);n(t).append(f)},v=function(t,i){for(var o,e,h=n("<table class='"+c.rowTable+" ui-common-table'><tbody><\/tbody><\/table>"),f=n("<tr><\/tr>"),a,u=0;u<r.p.subGridModel[0].name.length;u++)o=n("<th class='"+c.headerBox+" ui-th-subgrid ui-th-column ui-th-"+r.p.direction+"'><\/th>"),n(o).html(r.p.subGridModel[0].name[u]),n(o).width(r.p.subGridModel[0].width[u]),n(f).append(o);return n(h).append(f),t&&(e=r.p.xmlReader.subgrid,n(e.root+" "+e.row,t).each(function(){if(f=n("<tr class='"+s.content+" ui-subtblcell'><\/tr>"),e.repeatitems===!0)n(e.cell,this).each(function(t){l(f,n(this).text()||"&#160;",t)});else{var t=r.p.subGridModel[0].mapping||r.p.subGridModel[0].name;if(t)for(u=0;u<t.length;u++)l(f,n(t[u],this).text()||"&#160;",u)}n(h).append(f)})),a=n("table:first",r.grid.bDiv).attr("id")+"_",n("#"+n.jgrid.jqID(a+i)).append(h),r.grid.hDiv.loading=!1,n("#load_"+n.jgrid.jqID(r.p.id)).hide(),!1},y=function(t,i){for(var a,v,e,h,u,p=n("<table class='"+c.rowTable+" ui-common-table'><tbody><\/tbody><\/table>"),o=n("<tr><\/tr>"),y,w,f=0;f<r.p.subGridModel[0].name.length;f++)a=n("<th class='"+c.headerBox+" ui-th-subgrid ui-th-column ui-th-"+r.p.direction+"'><\/th>"),n(a).html(r.p.subGridModel[0].name[f]),n(a).width(r.p.subGridModel[0].width[f]),n(o).append(a);if(n(p).append(o),t&&(h=r.p.jsonReader.subgrid,v=n.jgrid.getAccessor(t,h.root),v!==undefined))for(f=0;f<v.length;f++){if(e=v[f],o=n("<tr class='"+s.content+" ui-subtblcell'><\/tr>"),h.repeatitems===!0)for(h.cell&&(e=e[h.cell]),u=0;u<e.length;u++)l(o,e[u]||"&#160;",u);else if(y=r.p.subGridModel[0].mapping||r.p.subGridModel[0].name,y.length)for(u=0;u<y.length;u++)l(o,e[y[u]]||"&#160;",u);n(p).append(o)}return w=n("table:first",r.grid.bDiv).attr("id")+"_",n("#"+n.jgrid.jqID(w+i)).append(p),r.grid.hDiv.loading=!1,n("#load_"+n.jgrid.jqID(r.p.id)).hide(),!1},k=function(t){var f,i,u,e;if(f=n(t).attr("id"),i={nd_:(new Date).getTime()},i[r.p.prmNames.subgridid]=f,!r.p.subGridModel[0])return!1;if(r.p.subGridModel[0].params)for(e=0;e<r.p.subGridModel[0].params.length;e++)for(u=0;u<r.p.colModel.length;u++)r.p.colModel[u].name===r.p.subGridModel[0].params[e]&&(i[r.p.colModel[u].name]=n("td:eq("+u+")",t).text().replace(/\&#160\;/ig,""));if(!r.grid.hDiv.loading){r.grid.hDiv.loading=!0;n("#load_"+n.jgrid.jqID(r.p.id)).show();r.p.subgridtype||(r.p.subgridtype=r.p.datatype);n.isFunction(r.p.subgridtype)?r.p.subgridtype.call(r,i):r.p.subgridtype=r.p.subgridtype.toLowerCase();switch(r.p.subgridtype){case"xml":case"json":n.ajax(n.extend({type:r.p.mtype,url:n.isFunction(r.p.subGridUrl)?r.p.subGridUrl.call(r,i):r.p.subGridUrl,dataType:r.p.subgridtype,data:n.isFunction(r.p.serializeSubGridData)?r.p.serializeSubGridData.call(r,i):i,complete:function(t){r.p.subgridtype==="xml"?v(t.responseXML,f):y(n.jgrid.parse(t.responseText),f);t=null}},n.jgrid.ajaxOptions,r.p.ajaxSubgridOptions||{}))}}return!1},u,e,p,w=0,f,h;n.each(r.p.colModel,function(){(this.hidden===!0||this.name==="rn"||this.name==="cb")&&w++});var b=r.rows.length,o=1,a,d=n.isFunction(r.p.isHasSubGrid);for(i!==undefined&&i>0&&(o=i,b=i+1);o<b;){if(n(r.rows[o]).hasClass("jqgrow"))if(r.p.scroll&&n(r.rows[o].cells[t]).off("click"),a=null,d&&(a=r.p.isHasSubGrid.call(r,r.rows[o].id)),a===!1)r.rows[o].cells[t].innerHTML="";else n(r.rows[o].cells[t]).on("click",function(){var i=n(this).parent("tr")[0];if(e=r.p.id,u=i.id,h=n("#"+e+"_"+u+"_expandedContent"),n(this).hasClass("sgcollapsed")){if(f=n(r).triggerHandler("jqGridSubGridBeforeExpand",[e+"_"+u,u]),f=f===!1||f==="stop"?!1:!0,f&&n.isFunction(r.p.subGridBeforeExpand)&&(f=r.p.subGridBeforeExpand.call(r,e+"_"+u,u)),f===!1)return!1;r.p.subGridOptions.reloadOnExpand!==!0&&(r.p.subGridOptions.reloadOnExpand!==!1||h.hasClass("ui-subgrid"))?h.show().removeClass("ui-sg-collapsed").addClass("ui-sg-expanded"):(p=t>=1?"<td colspan='"+t+"'>&#160;<\/td>":"",n(i).after("<tr role='row' id='"+e+"_"+u+"_expandedContent' class='ui-subgrid ui-sg-expanded'>"+p+"<td class='"+s.content+" subgrid-cell'><span class='"+s.icon_base+" "+r.p.subGridOptions.openicon+"'><\/span><\/td><td colspan='"+parseInt(r.p.colNames.length-1-w,10)+"' class='"+s.content+" subgrid-data'><div id="+e+"_"+u+" class='tablediv'><\/div><\/td><\/tr>"),n(r).triggerHandler("jqGridSubGridRowExpanded",[e+"_"+u,u]),n.isFunction(r.p.subGridRowExpanded)?r.p.subGridRowExpanded.call(r,e+"_"+u,u):k(i));n(this).html("<a style='cursor:pointer;' class='ui-sghref'><span class='"+s.icon_base+" "+r.p.subGridOptions.minusicon+"'><\/span><\/a>").removeClass("sgcollapsed").addClass("sgexpanded");r.p.subGridOptions.selectOnExpand&&n(r).jqGrid("setSelection",u)}else if(n(this).hasClass("sgexpanded")){if(f=n(r).triggerHandler("jqGridSubGridRowColapsed",[e+"_"+u,u]),f=f===!1||f==="stop"?!1:!0,f&&n.isFunction(r.p.subGridRowColapsed)&&(f=r.p.subGridRowColapsed.call(r,e+"_"+u,u)),f===!1)return!1;r.p.subGridOptions.reloadOnExpand===!0?h.remove(".ui-subgrid"):h.hasClass("ui-subgrid")&&h.hide().addClass("ui-sg-collapsed").removeClass("ui-sg-expanded");n(this).html("<a style='cursor:pointer;' class='ui-sghref'><span class='"+s.icon_base+" "+r.p.subGridOptions.plusicon+"'><\/span><\/a>").removeClass("sgexpanded").addClass("sgcollapsed");r.p.subGridOptions.selectOnCollapse&&n(r).jqGrid("setSelection",u)}return!1});o++}r.p.subGridOptions.expandOnLoad===!0&&n(r.rows).filter(".jqgrow").each(function(t,i){n(i.cells[0]).click()});r.subGridXml=function(n,t){v(n,t)};r.subGridJson=function(n,t){y(n,t)}}})},expandSubGridRow:function(t){return this.each(function(){var u=this,i,r;(u.grid||t)&&u.p.subGrid===!0&&(i=n(this).jqGrid("getInd",t,!0),i&&(r=n("td.sgcollapsed",i)[0],r&&n(r).trigger("click")))})},collapseSubGridRow:function(t){return this.each(function(){var u=this,i,r;(u.grid||t)&&u.p.subGrid===!0&&(i=n(this).jqGrid("getInd",t,!0),i&&(r=n("td.sgexpanded",i)[0],r&&n(r).trigger("click")))})},toggleSubGridRow:function(t){return this.each(function(){var u=this,r,i;(u.grid||t)&&u.p.subGrid===!0&&(r=n(this).jqGrid("getInd",t,!0),r&&(i=n("td.sgcollapsed",r)[0],i?n(i).trigger("click"):(i=n("td.sgexpanded",r)[0],i&&n(i).trigger("click"))))})}});n.jgrid.extend({setTreeNode:function(t,i){return this.each(function(){var r=this,k,d,g;if(r.grid&&r.p.treeGrid){var l=r.p.expColInd,e=r.p.treeReader.expanded_field,f=r.p.treeReader.leaf_field,nt=r.p.treeReader.level_field,a=r.p.treeReader.icon_field,o=r.p.treeReader.loaded,w,b,s,v,y,h,u,p,tt=n.jgrid.styleUI[r.p.styleUI||"jQueryUI"].common,c=t;for(n(r).triggerHandler("jqGridBeforeSetTreeNode",[c,i]),n.isFunction(r.p.beforeSetTreeNode)&&r.p.beforeSetTreeNode.call(r,c,i);t<i;){k=n.jgrid.stripPref(r.p.idPrefix,r.rows[t].id);d=r.p._index[k];u=r.p.data[d];r.p.treeGridModel==="nested"&&(u[f]||(w=parseInt(u[r.p.treeReader.left_field],10),b=parseInt(u[r.p.treeReader.right_field],10),u[f]=b===w+1?"true":"false",r.rows[t].cells[r.p._treeleafpos].innerHTML=u[f]));s=parseInt(u[nt],10);r.p.tree_root_level===0?(v=s+1,y=s):(v=s,y=s-1);h="<div class='tree-wrap tree-wrap-"+r.p.direction+"' style='width:"+v*18+"px;'>";h+="<div style='"+(r.p.direction==="rtl"?"right:":"left:")+y*18+"px;' class='"+tt.icon_base+" ";u[o]!==undefined&&(u[o]=u[o]==="true"||u[o]===!0?!0:!1);u[f]==="true"||u[f]===!0?(h+=(u[a]!==undefined&&u[a]!==""?u[a]:r.p.treeIcons.leaf)+" tree-leaf treeclick",u[f]=!0,p="leaf"):(u[f]=!1,p="");u[e]=(u[e]==="true"||u[e]===!0?!0:!1)&&(u[o]||u[o]===undefined);h+=u[e]===!1?u[f]===!0?"'":r.p.treeIcons.plus+" tree-plus treeclick'":u[f]===!0?"'":r.p.treeIcons.minus+" tree-minus treeclick'";h+="><\/div><\/div>";n(r.rows[t].cells[l]).wrapInner("<span class='cell-wrapper"+p+"'><\/span>").prepend(h);s!==parseInt(r.p.tree_root_level,10)&&(g=n(r).jqGrid("isVisibleNode",u),g||n(r.rows[t]).css("display","none"));n(r.rows[t].cells[l]).find("div.treeclick").on("click",function(t){var u=t.target||t.srcElement,o=n.jgrid.stripPref(r.p.idPrefix,n(u,r.rows).closest("tr.jqgrow")[0].id),i=r.p._index[o];return r.p.data[i][f]||(r.p.data[i][e]?(n(r).jqGrid("collapseRow",r.p.data[i]),n(r).jqGrid("collapseNode",r.p.data[i])):(n(r).jqGrid("expandRow",r.p.data[i]),n(r).jqGrid("expandNode",r.p.data[i]))),!1});if(r.p.ExpandColClick===!0)n(r.rows[t].cells[l]).find("span.cell-wrapper").css("cursor","pointer").on("click",function(t){var o=t.target||t.srcElement,u=n.jgrid.stripPref(r.p.idPrefix,n(o,r.rows).closest("tr.jqgrow")[0].id),i=r.p._index[u];return r.p.data[i][f]||(r.p.data[i][e]?(n(r).jqGrid("collapseRow",r.p.data[i]),n(r).jqGrid("collapseNode",r.p.data[i])):(n(r).jqGrid("expandRow",r.p.data[i]),n(r).jqGrid("expandNode",r.p.data[i]))),n(r).jqGrid("setSelection",u),!1});t++}n(r).triggerHandler("jqGridAfterSetTreeNode",[c,i]);n.isFunction(r.p.afterSetTreeNode)&&r.p.afterSetTreeNode.call(r,c,i)}})},setTreeGrid:function(){return this.each(function(){var t=this,i=0,u,s=!1,r,f,e,h=[],o=n.jgrid.styleUI[t.p.styleUI||"jQueryUI"].treegrid;if(t.p.treeGrid){t.p.treedatatype||n.extend(t.p,{treedatatype:t.p.datatype});t.p.loadonce&&(t.p.treedatatype="local");t.p.subGrid=!1;t.p.altRows=!1;t.p.pgbuttons=!1;t.p.pginput=!1;t.p.gridview=!0;t.p.rowTotal===null&&(t.p.rowNum=1e4);t.p.multiselect=!1;t.p.rowList=[];t.p.expColInd=0;u=o.icon_plus;t.p.styleUI==="jQueryUI"&&(u+=t.p.direction==="rtl"?"w":"e");t.p.treeIcons=n.extend({plus:u,minus:o.icon_minus,leaf:o.icon_leaf},t.p.treeIcons||{});t.p.treeGridModel==="nested"?t.p.treeReader=n.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},t.p.treeReader):t.p.treeGridModel==="adjacency"&&(t.p.treeReader=n.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},t.p.treeReader));for(f in t.p.colModel)if(t.p.colModel.hasOwnProperty(f)){r=t.p.colModel[f].name;r!==t.p.ExpandColumn||s||(s=!0,t.p.expColInd=i);i++;for(e in t.p.treeReader)t.p.treeReader.hasOwnProperty(e)&&t.p.treeReader[e]===r&&h.push(r)}n.each(t.p.treeReader,function(r,u){u&&n.inArray(u,h)===-1&&(r==="leaf_field"&&(t.p._treeleafpos=i),i++,t.p.colNames.push(u),t.p.colModel.push({name:u,width:1,hidden:!0,sortable:!1,resizable:!1,hidedlg:!0,editable:!0,search:!1}))})}})},expandRow:function(t){this.each(function(){var i=this;if(i.grid&&i.p.treeGrid){var r=n(i).jqGrid("getNodeChildren",t),f=i.p.treeReader.expanded_field,u=t[i.p.localReader.id],e=n.isFunction(i.p.beforeExpandTreeGridRow)?i.p.beforeExpandTreeGridRow.call(i,u,t,r):!0;e!==!1&&(n(r).each(function(){var t=i.p.idPrefix+n.jgrid.getAccessor(this,i.p.localReader.id);n(n(i).jqGrid("getGridRowById",t)).css("display","");this[f]&&n(i).jqGrid("expandRow",this)}),n.isFunction(i.p.afterExpandTreeGridRow)&&i.p.afterExpandTreeGridRow.call(i,u,t,r))}})},collapseRow:function(t){this.each(function(){var i=this;if(i.grid&&i.p.treeGrid){var r=n(i).jqGrid("getNodeChildren",t),f=i.p.treeReader.expanded_field,u=t[i.p.localReader.id],e=n.isFunction(i.p.beforeCollapseTreeGridRow)?i.p.beforeCollapseTreeGridRow.call(i,u,t,r):!0;e!==!1&&(n(r).each(function(){var t=i.p.idPrefix+n.jgrid.getAccessor(this,i.p.localReader.id);n(n(i).jqGrid("getGridRowById",t)).css("display","none");this[f]&&n(i).jqGrid("collapseRow",this)}),n.isFunction(i.p.afterCollapseTreeGridRow)&&i.p.afterCollapseTreeGridRow.call(i,u,t,r))}})},getRootNodes:function(t){var i=[];return this.each(function(){var r=this,e,u,f;if(r.grid&&r.p.treeGrid){typeof t!="boolean"&&(t=!1);f=t?n(r).jqGrid("getRowData",null,!0):r.p.data;switch(r.p.treeGridModel){case"nested":e=r.p.treeReader.level_field;n(f).each(function(){parseInt(this[e],10)===parseInt(r.p.tree_root_level,10)&&(t?i.push(r.p.data[r.p._index[this[r.p.keyName]]]):i.push(this))});break;case"adjacency":u=r.p.treeReader.parent_id_field;n(f).each(function(){(this[u]===null||String(this[u]).toLowerCase()==="null")&&(t?i.push(r.p.data[r.p._index[this[r.p.keyName]]]):i.push(this))})}}}),i},getNodeDepth:function(t){var i=null;return this.each(function(){var r,u;if(this.grid&&this.p.treeGrid){r=this;switch(r.p.treeGridModel){case"nested":u=r.p.treeReader.level_field;i=parseInt(t[u],10)-parseInt(r.p.tree_root_level,10);break;case"adjacency":i=n(r).jqGrid("getNodeAncestors",t).length}}}),i},getNodeParent:function(t){var i=null;return this.each(function(){var r=this;if(r.grid&&r.p.treeGrid)switch(r.p.treeGridModel){case"nested":var f=r.p.treeReader.left_field,e=r.p.treeReader.right_field,o=r.p.treeReader.level_field,h=parseInt(t[f],10),c=parseInt(t[e],10),l=parseInt(t[o],10);n(this.p.data).each(function(){if(parseInt(this[o],10)===l-1&&parseInt(this[f],10)<h&&parseInt(this[e],10)>c)return i=this,!1});break;case"adjacency":for(var a=r.p.treeReader.parent_id_field,s=r.p.localReader.id,v=t[s],u=r.p._index[v];u--;)if(r.p.data[u][s]===n.jgrid.stripPref(r.p.idPrefix,t[a])){i=r.p.data[u];break}}}),i},getNodeChildren:function(t,i){var r=[];return this.each(function(){var u=this,f,o,e,l,a;if(u.grid&&u.p.treeGrid){o=i?this.rows.length:this.p.data.length;switch(u.p.treeGridModel){case"nested":var s=u.p.treeReader.left_field,h=u.p.treeReader.right_field,c=u.p.treeReader.level_field,v=parseInt(t[s],10),y=parseInt(t[h],10),p=parseInt(t[c],10);for(f=0;f<o;f++)e=i?u.p.data[u.p._index[this.rows[f].id]]:u.p.data[f],e&&parseInt(e[c],10)===p+1&&parseInt(e[s],10)>v&&parseInt(e[h],10)<y&&r.push(e);break;case"adjacency":for(l=u.p.treeReader.parent_id_field,a=u.p.localReader.id,f=0;f<o;f++)e=i?u.p.data[u.p._index[this.rows[f].id]]:u.p.data[f],e&&String(e[l])===n.jgrid.stripPref(u.p.idPrefix,t[a])&&r.push(e)}}}),r},getFullTreeNode:function(t,i){var r=[];return this.each(function(){var u=this,e,o=u.p.treeReader.expanded_field,h,c;if(u.grid&&u.p.treeGrid){(i==null||typeof i!="boolean")&&(i=!1);switch(u.p.treeGridModel){case"nested":var f=u.p.treeReader.left_field,l=u.p.treeReader.right_field,s=u.p.treeReader.level_field,a=parseInt(t[f],10),v=parseInt(t[l],10),y=parseInt(t[s],10);n(this.p.data).each(function(){parseInt(this[s],10)>=y&&parseInt(this[f],10)>=a&&parseInt(this[f],10)<=v&&(i&&(this[o]=!0),r.push(this))});break;case"adjacency":t&&(r.push(t),h=u.p.treeReader.parent_id_field,c=u.p.localReader.id,n(this.p.data).each(function(t){for(e=r.length,t=0;t<e;t++)if(n.jgrid.stripPref(u.p.idPrefix,r[t][c])===this[h]){i&&(this[o]=!0);r.push(this);break}}))}}}),r},getNodeAncestors:function(t,i,r){var u=[];return i===undefined&&(i=!1),this.each(function(){if(this.grid&&this.p.treeGrid){r=r===undefined?!1:this.p.treeReader.expanded_field;for(var f=n(this).jqGrid("getNodeParent",t);f;){if(r)try{f[r]=!0}catch(e){}i?u.unshift(f):u.push(f);f=n(this).jqGrid("getNodeParent",f)}}}),u},isVisibleNode:function(t){var i=!0;return this.each(function(){var r=this,u,f;r.grid&&r.p.treeGrid&&(u=n(r).jqGrid("getNodeAncestors",t),f=r.p.treeReader.expanded_field,n(u).each(function(){return i=i&&this[f],i?void 0:!1}))}),i},isNodeLoaded:function(t){var i;return this.each(function(){var r=this,f,u;r.grid&&r.p.treeGrid&&(f=r.p.treeReader.leaf_field,u=r.p.treeReader.loaded,i=t!==undefined?t[u]!==undefined?t[u]:t[f]||n(r).jqGrid("getNodeChildren",t).length>0?!0:!1:!1)}),i},setLeaf:function(t,i,r){return this.each(function(){var e=n.jgrid.getAccessor(t,this.p.localReader.id),o=n("#"+e,this.grid.bDiv)[0],s=this.p.treeReader.leaf_field,u,f;try{u=this.p._index[e];u!=null&&(this.p.data[u][s]=i)}catch(h){}i===!0?n("div.treeclick",o).removeClass(this.p.treeIcons.minus+" tree-minus "+this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.leaf+" tree-leaf"):i===!1&&(f=this.p.treeIcons.minus+" tree-minus",r&&(f=this.p.treeIcons.plus+" tree-plus"),n("div.treeclick",o).removeClass(this.p.treeIcons.leaf+" tree-leaf").addClass(f))})},reloadNode:function(t,i){return this.each(function(){var e,f;if(this.grid&&this.p.treeGrid){if(e=this.p.localReader.id,f=this.p.selrow,n(this).jqGrid("delChildren",t[e]),i===undefined&&(i=!1),!i&&!jQuery._data(this,"events").jqGridAfterSetTreeNode)n(this).on("jqGridAfterSetTreeNode.reloadNode",function(){var r=this.p.treeReader.leaf_field,t,i;this.p.reloadnode&&(t=this.p.reloadnode,i=n(this).jqGrid("getNodeChildren",t),t[r]&&i.length?n(this).jqGrid("setLeaf",t,!1):t[r]||i.length!==0||n(this).jqGrid("setLeaf",t,!0));this.p.reloadnode=!1});var s=this.p.treeReader.expanded_field,h=this.p.treeReader.parent_id_field,c=this.p.treeReader.loaded,o=this.p.treeReader.level_field,l=this.p.treeReader.leaf_field,a=this.p.treeReader.left_field,v=this.p.treeReader.right_field,r=n.jgrid.getAccessor(t,this.p.localReader.id),u=n("#"+r,this.grid.bDiv)[0];t[s]=!0;t[l]||n("div.treeclick",u).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");this.p.treeANode=u.rowIndex;this.p.datatype=this.p.treedatatype;this.p.reloadnode=t;i&&(this.p.treeANode=u.rowIndex>0?u.rowIndex-1:1,n(this).jqGrid("delRowData",r));this.p.treeGridModel==="nested"?n(this).jqGrid("setGridParam",{postData:{nodeid:r,n_left:t[a],n_right:t[v],n_level:t[o]}}):n(this).jqGrid("setGridParam",{postData:{nodeid:r,parentid:t[h],n_level:t[o]}});n(this).trigger("reloadGrid");t[c]=!0;this.p.treeGridModel==="nested"?n(this).jqGrid("setGridParam",{selrow:f,postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):n(this).jqGrid("setGridParam",{selrow:f,postData:{nodeid:"",parentid:"",n_level:""}})}})},expandNode:function(t){return this.each(function(){if(this.grid&&this.p.treeGrid){var r=this.p.treeReader.expanded_field,e=this.p.treeReader.parent_id_field,o=this.p.treeReader.loaded,f=this.p.treeReader.level_field,s=this.p.treeReader.left_field,h=this.p.treeReader.right_field;if(!t[r]){var i=n.jgrid.getAccessor(t,this.p.localReader.id),u=n("#"+this.p.idPrefix+n.jgrid.jqID(i),this.grid.bDiv)[0],c=this.p._index[i],l=n.isFunction(this.p.beforeExpandTreeGridNode)?this.p.beforeExpandTreeGridNode.call(this,i,t):!0;if(l===!1)return;n(this).jqGrid("isNodeLoaded",this.p.data[c])?(t[r]=!0,n("div.treeclick",u).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(t[r]=!0,n("div.treeclick",u).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus"),this.p.treeANode=u.rowIndex,this.p.datatype=this.p.treedatatype,this.p.treeGridModel==="nested"?n(this).jqGrid("setGridParam",{postData:{nodeid:i,n_left:t[s],n_right:t[h],n_level:t[f]}}):n(this).jqGrid("setGridParam",{postData:{nodeid:i,parentid:t[e],n_level:t[f]}}),n(this).trigger("reloadGrid"),t[o]=!0,this.p.treeGridModel==="nested"?n(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):n(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}}));n.isFunction(this.p.afterExpandTreeGridNode)&&this.p.afterExpandTreeGridNode.call(this,i,t)}}})},collapseNode:function(t){return this.each(function(){var i;if(this.grid&&this.p.treeGrid&&(i=this.p.treeReader.expanded_field,t[i])){var r=n.jgrid.getAccessor(t,this.p.localReader.id),u=n.isFunction(this.p.beforeCollapseTreeGridNode)?this.p.beforeCollapseTreeGridNode.call(this,r,t):!0,f=n("#"+this.p.idPrefix+n.jgrid.jqID(r),this.grid.bDiv)[0];if(t[i]=!1,u===!1)return;n("div.treeclick",f).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus");n.isFunction(this.p.afterCollapseTreeGridNode)&&this.p.afterCollapseTreeGridNode.call(this,r,t)}})},SortTree:function(t,i,r,u){return this.each(function(){if(this.grid&&this.p.treeGrid){var f,l,c,e=[],o=this,s,h,a=n(this).jqGrid("getRootNodes",o.p.search);for(s=n.jgrid.from.call(this,a),s.orderBy(t,i,r,u),h=s.select(),f=0,l=h.length;f<l;f++)c=h[f],e.push(c),n(this).jqGrid("collectChildrenSortTree",e,c,t,i,r,u);n.each(e,function(t){var i=n.jgrid.getAccessor(this,o.p.localReader.id);n("#"+n.jgrid.jqID(o.p.id)+" tbody tr:eq("+t+")").after(n("tr#"+n.jgrid.jqID(i),o.grid.bDiv))});s=null;h=null;e=null}})},searchTree:function(t){var f=t.length||0,i=[],e,h=[],r=[],s,c,l,u,o;return this.each(function(){if(this.grid&&this.p.treeGrid&&f)for(e=this.p.localReader.id;f--;){if(i=n(this).jqGrid("getNodeAncestors",t[f],!0,!0),i.push(t[f]),s=i[0][e],n.inArray(s,h)!==-1){for(u=0,c=i.length;u<c;u++){var a=!1;for(o=0,l=r.length;o<l;o++)if(i[u][e]===r[o][e]){a=!0;break}a||r.push(i[u])}continue}else h.push(s);r=r.concat(i)}}),r},collectChildrenSortTree:function(t,i,r,u,f,e){return this.each(function(){if(this.grid&&this.p.treeGrid){var o,l,s,a,h,c;for(a=n(this).jqGrid("getNodeChildren",i,this.p.search),h=n.jgrid.from.call(this,a),h.orderBy(r,u,f,e),c=h.select(),o=0,l=c.length;o<l;o++)s=c[o],t.push(s),n(this).jqGrid("collectChildrenSortTree",t,s,r,u,f,e)}})},setTreeRow:function(t,i){var r=!1;return this.each(function(){var u=this;u.grid&&u.p.treeGrid&&(r=n(u).jqGrid("setRowData",t,i))}),r},delTreeNode:function(t){return this.each(function(){var i=this,a=i.p.localReader.id,e,o=i.p.treeReader.left_field,s=i.p.treeReader.right_field,h,l,r,u,f,c;if(i.grid&&i.p.treeGrid&&(f=i.p._index[t],f!==undefined)){if(h=parseInt(i.p.data[f][s],10),l=h-parseInt(i.p.data[f][o],10)+1,c=n(i).jqGrid("getFullTreeNode",i.p.data[f]),c.length>0)for(e=0;e<c.length;e++)n(i).jqGrid("delRowData",c[e][a]);if(i.p.treeGridModel==="nested"){if(r=n.jgrid.from.call(i,i.p.data).greater(o,h,{stype:"integer"}).select(),r.length)for(u in r)r.hasOwnProperty(u)&&(r[u][o]=parseInt(r[u][o],10)-l);if(r=n.jgrid.from.call(i,i.p.data).greater(s,h,{stype:"integer"}).select(),r.length)for(u in r)r.hasOwnProperty(u)&&(r[u][s]=parseInt(r[u][s],10)-l)}}})},delChildren:function(t){return this.each(function(){var i=this,a=i.p.localReader.id,s=i.p.treeReader.left_field,h=i.p.treeReader.right_field,c,l,r,u,f,e,o;if(i.grid&&i.p.treeGrid&&(f=i.p._index[t],f!==undefined)){if(c=parseInt(i.p.data[f][h],10),l=c-parseInt(i.p.data[f][s],10)+1,e=n(i).jqGrid("getFullTreeNode",i.p.data[f]),e.length>0)for(o=0;o<e.length;o++)e[o][a]!==t&&n(i).jqGrid("delRowData",e[o][a]);if(i.p.treeGridModel==="nested"){if(r=n.jgrid.from(i.p.data).greater(s,c,{stype:"integer"}).select(),r.length)for(u in r)r.hasOwnProperty(u)&&(r[u][s]=parseInt(r[u][s],10)-l);if(r=n.jgrid.from(i.p.data).greater(h,c,{stype:"integer"}).select(),r.length)for(u in r)r.hasOwnProperty(u)&&(r[u][h]=parseInt(r[u][h],10)-l)}}})},addChildNode:function(t,i,r,u){var f=this[0],rt,w,b,e,o;if(r){var v=f.p.treeReader.expanded_field,y=f.p.treeReader.leaf_field,ut=f.p.treeReader.level_field,et=f.p.treeReader.parent_id_field,a=f.p.treeReader.left_field,s=f.p.treeReader.right_field,k=f.p.treeReader.loaded,d,g,c,nt,h,ft,tt=0,p=i,it,l;if(u===undefined&&(u=!1),t==null){if(h=f.p.data.length-1,h>=0)while(h>=0)tt=Math.max(tt,parseInt(f.p.data[h][f.p.localReader.id],10)),h--;t=tt+1}if(rt=n(f).jqGrid("getInd",i),it=!1,i===undefined||i===null||i===""?(i=null,p=null,d="last",nt=f.p.tree_root_level,h=f.p.data.length+1):(d="after",g=f.p._index[i],c=f.p.data[g],i=c[f.p.localReader.id],nt=parseInt(c[ut],10)+1,w=n(f).jqGrid("getFullTreeNode",c),w.length?(h=w[w.length-1][f.p.localReader.id],p=h,h=n(f).jqGrid("getInd",p)+1):h=n(f).jqGrid("getInd",i)+1,c[y]&&(it=!0,c[v]=!0,n(f.rows[rt]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(f.p.treeIcons.leaf+" tree-leaf").addClass(f.p.treeIcons.minus+" tree-minus"),f.p.data[g][y]=!1,c[k]=!0)),ft=h+1,r[v]===undefined&&(r[v]=!1),r[k]===undefined&&(r[k]=!1),r[ut]=nt,r[y]===undefined&&(r[y]=!0),f.p.treeGridModel==="adjacency"&&(r[et]=i),f.p.treeGridModel==="nested")if(i!==null){if(l=parseInt(c[s],10),b=n.jgrid.from.call(f,f.p.data),b=b.greaterOrEquals(s,l,{stype:"integer"}),e=b.select(),e.length)for(o in e)e.hasOwnProperty(o)&&(e[o][a]=e[o][a]>l?parseInt(e[o][a],10)+2:e[o][a],e[o][s]=e[o][s]>=l?parseInt(e[o][s],10)+2:e[o][s]);r[a]=l;r[s]=l+1}else{if(l=parseInt(n(f).jqGrid("getCol",s,!1,"max"),10),e=n.jgrid.from.call(f,f.p.data).greater(a,l,{stype:"integer"}).select(),e.length)for(o in e)e.hasOwnProperty(o)&&(e[o][a]=parseInt(e[o][a],10)+2);if(e=n.jgrid.from.call(f,f.p.data).greater(s,l,{stype:"integer"}).select(),e.length)for(o in e)e.hasOwnProperty(o)&&(e[o][s]=parseInt(e[o][s],10)+2);r[a]=l+1;r[s]=l+2}(i===null||n(f).jqGrid("isNodeLoaded",c)||it)&&(n(f).jqGrid("addRowData",t,r,d,p),n(f).jqGrid("setTreeNode",h,ft));c&&!c[v]&&u&&n(f.rows[rt]).find("div.treeclick").click()}}});n.fn.jqDrag=function(n){return b(this,n,"d")};n.fn.jqResize=function(n,t){return b(this,n,"r",t)};n.jqDnR={dnr:{},e:0,drag:function(n){return u.k=="d"?f.css({left:u.X+n.pageX-u.pX,top:u.Y+n.pageY-u.pY}):(f.css({width:Math.max(n.pageX-u.pX+u.W,0),height:Math.max(n.pageY-u.pY+u.H,0)}),s&&c.css({width:Math.max(n.pageX-s.pX+s.W,0),height:Math.max(n.pageY-s.pY+s.H,0)})),!1},stop:function(){n(document).off("mousemove",v.drag).off("mouseup",v.stop)}};var v=n.jqDnR,u=v.dnr,f=v.e,c,s,b=function(t,i,r,e){return t.each(function(){i=i?n(i,t):t;i.on("mousedown",{e:t,k:r},function(t){var r=t.data,i={};if(f=r.e,c=e?n(e):!1,f.css("position")!="relative")try{f.position(i)}catch(o){}if(u={X:i.left||l("left")||0,Y:i.top||l("top")||0,W:l("width")||f[0].scrollWidth||0,H:l("height")||f[0].scrollHeight||0,pX:t.pageX,pY:t.pageY,k:r.k},s=c&&r.k!="d"?{X:i.left||y("left")||0,Y:i.top||y("top")||0,W:c[0].offsetWidth||y("width")||0,H:c[0].offsetHeight||y("height")||0,pX:t.pageX,pY:t.pageY,k:r.k}:!1,n("input.hasDatepicker",f[0])[0])try{n("input.hasDatepicker",f[0]).datepicker("hide")}catch(h){}return n(document).mousemove(n.jqDnR.drag).mouseup(n.jqDnR.stop),!1})})},l=function(n){return parseInt(f.css(n),10)||!1},y=function(n){return parseInt(c.css(n),10)||!1};n.fn.tinyDraggable=function(t){var i=n.extend({handle:0,exclude:0},t);return this.each(function(){var r,u,t=n(this),f=i.handle?n(i.handle,t):t;f.on({mousedown:function(f){if(!i.exclude||!~n.inArray(f.target,n(i.exclude,t))){f.preventDefault();var e=t.offset();r=f.pageX-e.left;u=f.pageY-e.top;n(document).on("mousemove.drag",function(n){t.offset({top:n.pageY-u,left:n.pageX-r})})}},mouseup:function(){n(document).off("mousemove.drag")}})})};n.fn.jqm=function(t){var r={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:i,ajaxText:"",target:i,modal:i,toTop:i,onShow:i,onHide:i,onLoad:i};return this.each(function(){if(this._jqm)return e[this._jqm].c=n.extend({},e[this._jqm].c,t);a++;this._jqm=a;e[a]={c:n.extend(r,n.jqm.params,t),a:i,w:n(this).addClass("jqmID"+a),s:a};r.trigger&&n(this).jqmAddTrigger(r.trigger)})};n.fn.jqmAddClose=function(n){return g(this,n,"jqmHide")};n.fn.jqmAddTrigger=function(n){return g(this,n,"jqmShow")};n.fn.jqmShow=function(t){return this.each(function(){n.jqm.open(this._jqm,t)})};n.fn.jqmHide=function(t){return this.each(function(){n.jqm.close(this._jqm,t)})};n.jqm={hash:{},open:function(t,r){var u=e[t],f=u.c,a="."+f.closeClass,c=parseInt(u.w.css("z-index")),l,o,s;return(c=c>0?c:3e3,l=n("<div><\/div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":c-1,opacity:f.overlay/100}),u.a)?i:(u.t=r,u.a=!0,u.w.css("z-index",c),f.modal?(h[0]||setTimeout(function(){new d("bind")},1),h.push(t)):f.overlay>0?f.closeoverlay&&u.w.jqmAddClose(l):l=i,u.o=l?l.addClass(f.overlayClass).prependTo("body"):i,f.ajax?(o=f.target||u.w,s=f.ajax,o=typeof o=="string"?n(o,u.w):n(o),s=s.substr(0,1)==="@"?n(r).attr(s.substring(1)):s,o.html(f.ajaxText).load(s,function(){f.onLoad&&f.onLoad.call(this,u);a&&u.w.jqmAddClose(n(a,u.w));k(u)})):a&&u.w.jqmAddClose(n(a,u.w)),f.toTop&&u.o&&u.w.before('<span id="jqmP'+u.w[0]._jqm+'"><\/span>').insertAfter(u.o),f.onShow?f.onShow(u):u.w.show(),k(u),i)},close:function(t){var r=e[t];if(!r.a)return i;if(r.a=i,h[0]&&(h.pop(),h[0]||new d("unbind")),r.c.toTop&&r.o&&n("#jqmP"+r.w[0]._jqm).after(r.w).remove(),r.c.onHide)r.c.onHide(r);else r.w.hide(),r.o&&r.o.remove();return i},params:{}};var a=0,e=n.jqm.hash,h=[],i=!1,k=function(n){n.c.focusField===undefined&&(n.c.focusField=0);n.c.focusField>=0&&l(n)},l=function(t){try{n(":input:visible",t.w)[parseInt(t.c.focusField,10)].focus()}catch(i){}},d=function(t){n(document)[t]("keypress",p)[t]("keydown",p)[t]("mousedown",p)},p=function(t){var i=e[h[h.length-1]],r=!n(t.target).parents(".jqmID"+i.s)[0];return r&&(n(".jqmID"+i.s).each(function(){var u=n(this),i=u.offset();if(i.top<=t.pageY&&t.pageY<=i.top+u.height()&&i.left<=t.pageX&&t.pageX<=i.left+u.width())return r=!1,!1}),l(i)),!r},g=function(t,r,u){return t.each(function(){var t=this._jqm;n(r).each(function(){this[u]||(this[u]=[],n(this).click(function(){var n,t;for(n in{jqmShow:1,jqmHide:1})for(t in this[n])e[this[n][t]]&&e[this[n][t]].w[n](this);return i}));this[u].push(t)})})};n.fmatter={};n.extend(n.fmatter,{isBoolean:function(n){return typeof n=="boolean"},isObject:function(t){return t&&(typeof t=="object"||n.isFunction(t))||!1},isString:function(n){return typeof n=="string"},isNumber:function(n){return typeof n=="number"&&isFinite(n)},isValue:function(n){return this.isObject(n)||this.isString(n)||this.isNumber(n)||this.isBoolean(n)},isEmpty:function(t){return!this.isString(t)&&this.isValue(t)?!1:this.isValue(t)?(t=n.trim(t).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,""),t===""):!0}});n.fn.fmatter=function(t,i,r,u,f){var e=i;r=n.extend({},n.jgrid.getRegional(this,"formatter"),r);try{e=n.fn.fmatter[t].call(this,i,r,u,f)}catch(o){}return e};n.fmatter.util={NumberFormat:function(t,i){var s,h,l,f,c,e;if(n.fmatter.isNumber(t)||(t*=1),n.fmatter.isNumber(t)){var a=t<0,r=String(t),o=i.decimalSeparator||".",u;if(n.fmatter.isNumber(i.decimalPlaces)&&(s=i.decimalPlaces,h=Math.pow(10,s),r=String(Math.round(t*h)/h),u=r.lastIndexOf("."),s>0))for(u<0?(r+=o,u=r.length-1):o!=="."&&(r=r.replace(".",o));r.length-1-u<s;)r+="0";if(i.thousandsSeparator){for(l=i.thousandsSeparator,u=r.lastIndexOf(o),u=u>-1?u:r.length,f=r.substring(u),c=-1,e=u;e>0;e--)c++,c%3==0&&e!==u&&(!a||e>1)&&(f=l+f),f=r.charAt(e-1)+f;r=f}return r=i.prefix?i.prefix+r:r,i.suffix?r+i.suffix:r}return t}};n.fn.fmatter.defaultFormat=function(t,i){return n.fmatter.isValue(t)&&t!==""?t:i.defaultValue||"&#160;"};n.fn.fmatter.email=function(t,i){return n.fmatter.isEmpty(t)?n.fn.fmatter.defaultFormat(t,i):'<a href="mailto:'+t+'">'+t+"<\/a>"};n.fn.fmatter.checkbox=function(t,i){var r=n.extend({},i.checkbox),u,f;return i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),u=r.disabled===!0?'disabled="disabled"':"",(n.fmatter.isEmpty(t)||t===undefined)&&(t=n.fn.fmatter.defaultFormat(t,r)),t=String(t),t=(t+"").toLowerCase(),f=t.search(/(false|f|0|no|n|off|undefined)/i)<0?" checked='checked' ":"",'<input type="checkbox" '+f+' value="'+t+'" offval="no" '+u+"/>"};n.fn.fmatter.link=function(t,i){var r={target:i.target},u="";return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),r.target&&(u="target="+r.target),!n.fmatter.isEmpty(t))?"<a "+u+' href="'+t+'">'+t+"<\/a>":n.fn.fmatter.defaultFormat(t,i)};n.fn.fmatter.showlink=function(t,i){var r={baseLinkUrl:i.baseLinkUrl,showAction:i.showAction,addParam:i.addParam||"",target:i.target,idName:i.idName},u="",f;return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),r.target&&(u="target="+r.target),f=r.baseLinkUrl+r.showAction+"?"+r.idName+"="+i.rowId+r.addParam,n.fmatter.isString(t)||n.fmatter.isNumber(t))?"<a "+u+' href="'+f+'">'+t+"<\/a>":n.fn.fmatter.defaultFormat(t,i)};n.fn.fmatter.integer=function(t,i){var r=n.extend({},i.integer);return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),n.fmatter.isEmpty(t))?r.defaultValue:n.fmatter.util.NumberFormat(t,r)};n.fn.fmatter.number=function(t,i){var r=n.extend({},i.number);return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),n.fmatter.isEmpty(t))?r.defaultValue:n.fmatter.util.NumberFormat(t,r)};n.fn.fmatter.percent=function(t){return n.fmatter.isEmpty(t)?op.defaultValue:(t*100).toFixed(2)+"%"};n.fn.fmatter.currency=function(t,i){var r=n.extend({},i.currency);return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(r=n.extend({},r,i.colModel.formatoptions)),n.fmatter.isEmpty(t))?r.defaultValue:n.fmatter.util.NumberFormat(t,r)};n.fn.fmatter.date=function(t,i,r,u){var f=n.extend({},i.date);return(i.colModel!==undefined&&i.colModel.formatoptions!==undefined&&(f=n.extend({},f,i.colModel.formatoptions)),!f.reformatAfterEdit&&u==="edit")?n.fn.fmatter.defaultFormat(t,i):n.fmatter.isEmpty(t)?n.fn.fmatter.defaultFormat(t,i):n.jgrid.parseDate.call(this,f.srcformat,t,f.newformat,f)};n.fn.fmatter.select=function(t,i){var r,f,o,c,s,e,u,l,a,h;if(t=String(t),r=!1,f=[],i.colModel.formatoptions!==undefined?(r=i.colModel.formatoptions.value,o=i.colModel.formatoptions.separator===undefined?":":i.colModel.formatoptions.separator,c=i.colModel.formatoptions.delimiter===undefined?";":i.colModel.formatoptions.delimiter):i.colModel.editoptions!==undefined&&(r=i.colModel.editoptions.value,o=i.colModel.editoptions.separator===undefined?":":i.colModel.editoptions.separator,c=i.colModel.editoptions.delimiter===undefined?";":i.colModel.editoptions.delimiter),r)if(s=(i.colModel.editoptions!=null&&i.colModel.editoptions.multiple===!0)==!0?!0:!1,e=[],s&&(e=t.split(","),e=n.map(e,function(t){return n.trim(t)})),n.fmatter.isString(r)){for(l=r.split(c),a=0,h=0;h<l.length;h++)if(u=l[h].split(o),u.length>2&&(u[1]=n.map(u,function(n,t){if(t>0)return n}).join(o)),s)n.inArray(u[0],e)>-1&&(f[a]=u[1],a++);else if(n.trim(u[0])===n.trim(t)){f[0]=u[1];break}}else n.fmatter.isObject(r)&&(s?f=n.map(e,function(n){return r[n]}):f[0]=r[t]||"");return t=f.join(", "),t===""?n.fn.fmatter.defaultFormat(t,i):t};n.fn.fmatter.rowactions=function(t){var c=n(this).closest("tr.jqgrow"),f=c.attr("id"),a=n(this).closest("table.ui-jqgrid-btable").attr("id").replace(/_frozen([^_]*)$/,"$1"),r=n("#"+a),o=r[0],e=o.p,s=e.colModel[n.jgrid.getCellIndex(this)],u=s.frozen?n("tr#"+f+" td:eq("+n.jgrid.getCellIndex(this)+") > div",r):n(this).parent(),i={extraparam:{}},v=function(t,r){n.isFunction(i.afterSave)&&i.afterSave.call(o,t,r);u.find("div.ui-inline-edit,div.ui-inline-del").show();u.find("div.ui-inline-save,div.ui-inline-cancel").hide()},l=function(t){n.isFunction(i.afterRestore)&&i.afterRestore.call(o,t);u.find("div.ui-inline-edit,div.ui-inline-del").show();u.find("div.ui-inline-save,div.ui-inline-cancel").hide()},h;s.formatoptions!==undefined&&(i=n.extend(i,s.formatoptions));e.editOptions!==undefined&&(i.editOptions=e.editOptions);e.delOptions!==undefined&&(i.delOptions=e.delOptions);c.hasClass("jqgrid-new-row")&&(i.extraparam[e.prmNames.oper]=e.prmNames.addoper);h={keys:i.keys,oneditfunc:i.onEdit,successfunc:i.onSuccess,url:i.url,extraparam:i.extraparam,aftersavefunc:v,errorfunc:i.onError,afterrestorefunc:l,restoreAfterError:i.restoreAfterError,mtype:i.mtype};switch(t){case"edit":r.jqGrid("editRow",f,h);u.find("div.ui-inline-edit,div.ui-inline-del").hide();u.find("div.ui-inline-save,div.ui-inline-cancel").show();r.triggerHandler("jqGridAfterGridComplete");break;case"save":r.jqGrid("saveRow",f,h)&&(u.find("div.ui-inline-edit,div.ui-inline-del").show(),u.find("div.ui-inline-save,div.ui-inline-cancel").hide(),r.triggerHandler("jqGridAfterGridComplete"));break;case"cancel":r.jqGrid("restoreRow",f,l);u.find("div.ui-inline-edit,div.ui-inline-del").show();u.find("div.ui-inline-save,div.ui-inline-cancel").hide();r.triggerHandler("jqGridAfterGridComplete");break;case"del":r.jqGrid("delGridRow",f,i.delOptions);break;case"formedit":r.jqGrid("setSelection",f);r.jqGrid("editGridRow",f,i.editOptions)}};n.fn.fmatter.actions=function(t,i){var s={keys:!1,editbutton:!0,delbutton:!0,editformbutton:!1},u=i.rowId,e="",r,h=n.jgrid.getRegional(this,"nav"),c=n.jgrid.styleUI[i.styleUI||"jQueryUI"].fmatter,f=n.jgrid.styleUI[i.styleUI||"jQueryUI"].common,o;return(i.colModel.formatoptions!==undefined&&(s=n.extend(s,i.colModel.formatoptions)),u===undefined||n.fmatter.isEmpty(u))?"":(o="onmouseover=jQuery(this).addClass('"+f.hover+"'); onmouseout=jQuery(this).removeClass('"+f.hover+"');  ",s.editformbutton?(r="id='jEditButton_"+u+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'formedit'); "+o,e+="<div title='"+h.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+r+"><span class='"+f.icon_base+" "+c.icon_edit+"'><\/span><\/div>"):s.editbutton&&(r="id='jEditButton_"+u+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'edit'); "+o,e+="<div title='"+h.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+r+"><span class='"+f.icon_base+" "+c.icon_edit+"'><\/span><\/div>"),s.delbutton&&(r="id='jDeleteButton_"+u+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'del'); "+o,e+="<div title='"+h.deltitle+"' style='float:left;' class='ui-pg-div ui-inline-del' "+r+"><span class='"+f.icon_base+" "+c.icon_del+"'><\/span><\/div>"),r="id='jSaveButton_"+u+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'save'); "+o,e+="<div title='"+h.savetitle+"' style='float:left;display:none' class='ui-pg-div ui-inline-save' "+r+"><span class='"+f.icon_base+" "+c.icon_save+"'><\/span><\/div>",r="id='jCancelButton_"+u+"' onclick=jQuery.fn.fmatter.rowactions.call(this,'cancel'); "+o,e+="<div title='"+h.canceltitle+"' style='float:left;display:none;' class='ui-pg-div ui-inline-cancel' "+r+"><span class='"+f.icon_base+" "+c.icon_cancel+"'><\/span><\/div>","<div style='margin-left:8px;'>"+e+"<\/div>")};n.unformat=function(t,i,r,u){var f,h=i.colModel.formatter,e=i.colModel.formatoptions||{},o,l=/([\.\*\_\'\(\)\{\}\+\?\\])/g,a=i.colModel.unformat||n.fn.fmatter[h]&&n.fn.fmatter[h].unformat,c,s,v;if(a!==undefined&&n.isFunction(a))f=a.call(this,n(t).text(),i,t);else if(h!==undefined&&n.fmatter.isString(h)){c=n.jgrid.getRegional(this,"formatter")||{};switch(h){case"integer":e=n.extend({},c.integer,e);o=e.thousandsSeparator.replace(l,"\\$1");s=new RegExp(o,"g");f=n(t).text().replace(s,"");break;case"number":e=n.extend({},c.number,e);o=e.thousandsSeparator.replace(l,"\\$1");s=new RegExp(o,"g");f=n(t).text().replace(s,"").replace(e.decimalSeparator,".");break;case"percent":f=n(t).text().replace("%","");break;case"currency":e=n.extend({},c.currency,e);o=e.thousandsSeparator.replace(l,"\\$1");s=new RegExp(o,"g");f=n(t).text();e.prefix&&e.prefix.length&&(f=f.substr(e.prefix.length));e.suffix&&e.suffix.length&&(f=f.substr(0,f.length-e.suffix.length));f=f.replace(s,"").replace(e.decimalSeparator,".");break;case"checkbox":v=i.colModel.editoptions?i.colModel.editoptions.value.split(":"):["Yes","No"];f=n("input",t).is(":checked")?v[0]:v[1];break;case"select":f=n.unformat.select(t,i,r,u);break;case"actions":return"";default:f=n(t).text()}}return f!==undefined?f:u===!0?n(t).text():n.jgrid.htmlDecode(n(t).html())};n.unformat.select=function(t,i,r,u){var c=[],s=n(t).text(),v,y,l;if(u===!0)return s;var e=n.extend({},i.colModel.formatoptions!==undefined?i.colModel.formatoptions:i.colModel.editoptions),p=e.separator===undefined?":":e.separator,w=e.delimiter===undefined?";":e.delimiter;if(e.value){var h=e.value,a=e.multiple===!0?!0:!1,o=[],f;if(a&&(o=s.split(","),o=n.map(o,function(t){return n.trim(t)})),n.fmatter.isString(h)){for(v=h.split(w),y=0,l=0;l<v.length;l++)if(f=v[l].split(p),f.length>2&&(f[1]=n.map(f,function(n,t){if(t>0)return n}).join(p)),a)n.inArray(n.trim(f[1]),o)>-1&&(c[y]=f[0],y++);else if(n.trim(f[1])===n.trim(s)){c[0]=f[0];break}}else(n.fmatter.isObject(h)||n.isArray(h))&&(a||(o[0]=s),c=n.map(o,function(t){var i;return n.each(h,function(n,r){if(r===t)return i=n,!1}),i!==undefined?i:void 0}));return c.join(", ")}return s||""};n.unformat.date=function(t,i){var r=n.jgrid.getRegional(this,"formatter.date")||{};return(i.formatoptions!==undefined&&(r=n.extend({},r,i.formatoptions)),!n.fmatter.isEmpty(t))?n.jgrid.parseDate.call(this,r.newformat,t,r.srcformat,r):n.fn.fmatter.defaultFormat(t,i)};o=n();n.fn.html5sortable=function(t){var i=String(t);return t=n.extend({connectWith:!1},t),this.each(function(){var e,s,f,u;if(/^enable|disable|destroy$/.test(i)){f=n(this).children(n(this).data("items")).attr("draggable",i==="enable");i==="destroy"&&f.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s");return}f=n(this).children(t.items);u=n("<"+(/^ul|ol$/i.test(this.tagName)?"li":/^tbody$/i.test(this.tagName)?"tr":"div")+' class="sortable-placeholder '+t.placeholderClass+'">').html("&nbsp;");f.find(t.handle).mousedown(function(){e=!0}).mouseup(function(){e=!1});n(this).data("items",t.items);o=o.add(u);t.connectWith&&n(t.connectWith).add(this).data("connectWith",t.connectWith);f.attr("draggable","true").on("dragstart.h5s",function(i){if(t.handle&&!e)return!1;e=!1;var u=i.originalEvent.dataTransfer;u.effectAllowed="move";u.setData("Text","dummy");s=(r=n(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){r&&(r.removeClass("sortable-dragging").show(),o.detach(),s!==r.index()&&r.parent().trigger("sortupdate",{item:r,startindex:s,endindex:r.index()}),r=null)}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,u]).on("dragover.h5s dragenter.h5s drop.h5s",function(i){return!f.is(r)&&t.connectWith!==n(r).parent().data("connectWith")?!0:i.type==="drop"?(i.stopPropagation(),o.filter(":visible").after(r),r.trigger("dragend.h5s"),!1):(i.preventDefault(),i.originalEvent.dataTransfer.dropEffect="move",f.is(this)?(t.forcePlaceholderSize&&u.height(r.outerHeight()),r.hide(),n(this)[u.index()<n(this).index()?"after":"before"](u),o.not(u).detach()):o.is(this)||n(this).children(t.items).length||(o.detach(),n(this).append(u)),!1)})})};window.jqGridUtils={stringify:function(n){return JSON.stringify(n,function(n,t){return typeof t=="function"?t.toString():t})},parse:function(n){return JSON.parse(n,function(n,t){if(typeof t=="string"&&t.indexOf("function")!==-1){var i=t.split(" ");return i[0].trim()==="function"&&t.trim().slice(-1)==="}"?eval("("+t+")"):t}return t})},encode:function(n){return String(n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},jsonToXML:function(t,i){var r=n.extend({xmlDecl:'<?xml version="1.0" encoding="UTF-8" ?>\n',attr_prefix:"-",encode:!0},i||{}),u=this,e=function(n,t){return n==="#text"?r.encode?u.encode(t):t:typeof t=="function"?"<"+n+"><![CDATA["+t+"]\]><\/"+n+">\n":t===""?"<"+n+">__EMPTY_STRING_<\/"+n+">\n":"<"+n+">"+(r.encode?u.encode(t):t)+"<\/"+n+">\n"},o=function(n,t){for(var i,r=[],u=0;u<t.length;u++)i=t[u],r[r.length]=typeof i=="undefined"||i==null?"<"+n+" />":typeof i=="object"&&i.constructor==Array?o(n,i):typeof i=="object"?f(n,i):e(n,i);return r.length||(r[0]="<"+n+">__EMPTY_ARRAY_<\/"+n+">\n"),r.join("")},f=function(n,t){var c=[],a=[],s,i,l,h;for(s in t)t.hasOwnProperty(s)&&(i=t[s],s.charAt(0)!==r.attr_prefix?c[c.length]=i==null?"<"+s+" />":typeof i=="object"&&i.constructor===Array?o(s,i):typeof i=="object"?f(s,i):e(s,i):a[a.length]=" "+s.substring(1)+'="'+(r.encode?u.encode(i):i)+'"');return l=a.join(""),h=c.join(""),n==null||(h=c.length>0?h.match(/\n/)?"<"+n+l+">\n"+h+"<\/"+n+">\n":"<"+n+l+">"+h+"<\/"+n+">\n":"<"+n+l+" />\n"),h},s=f(null,t);return r.xmlDecl+s},xmlToJSON:function(t,i){var u=n.extend({force_array:[],attr_prefix:"-"},i||{}),f,e,o;if(t){if(f={},u.force_array)for(e=0;e<u.force_array.length;e++)f[u.force_array[e]]=1;typeof t=="string"&&(t=n.parseXML(t));t.documentElement&&(t=t.documentElement);var s=function(n,t,i,r){if(typeof r=="string")if(r.indexOf("function")!==-1)r=eval("("+r+")");else switch(r){case"__EMPTY_ARRAY_":r=[];break;case"__EMPTY_STRING_":r="";break;case"false":r=!1;break;case"true":r=!0}f[t]?(i===1&&(n[t]=[]),n[t][n[t].length]=r):i===1?n[t]=r:i===2?n[t]=[n[t],r]:n[t][n[t].length]=r},h=function(n){var l,r,f,t,i,e,o,c;if(n.nodeType!==7){if(n.nodeType===3||n.nodeType===4)return(l=n.nodeValue.match(/[^\x00-\x20]/),l==null)?void 0:n.nodeValue;if(f={},n.attributes&&n.attributes.length)for(r={},t=0;t<n.attributes.length;t++)(i=n.attributes[t].nodeName,typeof i=="string")&&(e=n.attributes[t].nodeValue,e)&&(i=u.attr_prefix+i,typeof f[i]=="undefined"&&(f[i]=0),f[i]++,s(r,i,f[i],e));if(n.childNodes&&n.childNodes.length){for(o=!0,r&&(o=!1),t=0;t<n.childNodes.length&&o;t++)(c=n.childNodes[t].nodeType,c!==3&&c!==4)&&(o=!1);if(o)for(r||(r=""),t=0;t<n.childNodes.length;t++)r+=n.childNodes[t].nodeValue;else for(r||(r={}),t=0;t<n.childNodes.length;t++)(i=n.childNodes[t].nodeName,typeof i=="string")&&(e=h(n.childNodes[t]),e)&&(typeof f[i]=="undefined"&&(f[i]=0),f[i]++,s(r,i,f[i],e))}return r}},r=h(t);return f[t.nodeName]&&(r=[r]),t.nodeType!==11&&(o={},o[t.nodeName]=r,r=o),r}},saveAs:function(t,i,r){var e,o,f,u;r=n.extend(!0,{type:"plain/text;charset=utf-8"},r||{});f=[];i=i==null||i===""?"jqGridFile.txt":i;n.isArray(t)?f=t:f[0]=t;try{e=new File(f,i,r)}catch(s){e=new Blob(f,r)}o=URL.createObjectURL(e);u=document.createElement("a");u.href=o;u.download=i;document.body.appendChild(u);u.click();setTimeout(function(){document.body.removeChild(u);window.URL.revokeObjectURL(o)},0)}};n.jgrid=n.jgrid||{};n.extend(n.jgrid,{formatCell:function(t,i,r,u,f){var e,o;return u.formatter!==undefined?(o={rowId:"",colModel:u,gid:f.p.id,pos:i,styleUI:""},e=n.isFunction(u.formatter)?u.formatter.call(f,t,o,r):n.fmatter?n.fn.fmatter.call(f,u.formatter,t,o,r):t):e=t,e},formatCellCsv:function(n,t){n=n==null?"":String(n);try{n=n.replace(t._regexsep,t.separatorReplace).replace(/\r\n/g,t.replaceNewLine).replace(/\n/g,t.replaceNewLine)}catch(i){n=""}return t.escquote&&(n=n.replace(t._regexquot,t.escquote+t.quote)),(n.indexOf(t.separator)===-1||n.indexOf(t.qoute)===-1)&&(n=t.quote+n+t.quote),n},excelCellPos:function(n){for(var i="A".charCodeAt(0),u="Z".charCodeAt(0),r=u-i+1,t="";n>=0;)t=String.fromCharCode(n%r+i)+t,n=Math.floor(n/r)-1;return t},makeNode:function(t,i,r){var u=t.createElement(i);return r&&(r.attr&&n(u).attr(r.attr),r.children&&n.each(r.children,function(n,t){u.appendChild(t)}),r.text&&u.appendChild(t.createTextNode(r.text))),u},xmlToZip:function(t,i){var a=this,s=new XMLSerializer,h=s.serializeToString(n.parseXML(n.jgrid.excelStrings["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")===-1,c,f,r,l,o,e=[],u;n.each(i,function(i,v){if(n.isPlainObject(v))c=t.folder(i),a.xmlToZip(c,v);else{if(h){for(f=v.childNodes[0],r=f.attributes.length-1;r>=0;r--){var y=f.attributes[r].nodeName,p=f.attributes[r].nodeValue;y.indexOf(":")!==-1&&(e.push({name:y,value:p}),f.removeAttribute(y))}for(r=0,l=e.length;r<l;r++)o=v.createAttribute(e[r].name.replace(":","_dt_b_namespace_token_")),o.value=e[r].value,f.setAttributeNode(o)}u=s.serializeToString(v);h&&(u.indexOf("<?xml")===-1&&(u='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+u),u=u.replace(/_dt_b_namespace_token_/g,":"));u=u.replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>").replace(/<mergeCells xmlns="" /g,"<mergeCells ");t.file(i,u)}})},excelStrings:{"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><\/Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><\/Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /><\/Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/><\/bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/><\/sheets><\/workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/><\/worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /><\/font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /><\/font><font><sz val="11" /><name val="Calibri" /><b /><\/font><font><sz val="11" /><name val="Calibri" /><i /><\/font><font><sz val="11" /><name val="Calibri" /><u /><\/font><\/fonts><fills count="6"><fill><patternFill patternType="none" /><\/fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /><\/patternFill><\/fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /><\/patternFill><\/fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /><\/patternFill><\/fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /><\/patternFill><\/fill><\/fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /><\/border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /><\/left><right style="thin"><color auto="1" /><\/right><top style="thin"><color auto="1" /><\/top><bottom style="thin"><color auto="1" /><\/bottom><diagonal /><\/border><\/borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /><\/cellStyleXfs><cellXfs count="2"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><\/cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /><\/cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /><\/styleSheet>'}});n.jgrid.extend({exportToCsv:function(t){t=n.extend(!0,{separator:",",separatorReplace:" ",quote:'"',escquote:'"',newLine:"\r\n",replaceNewLine:" ",includeCaption:!0,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.csv",mimetype:"text/csv;charset=utf-8",returnAsString:!1},t||{});var i="";if(this.each(function(){function ot(t,i){function k(n,t,i){var u=!1,r,f;if(t===0)u=i[n];else if(f=i[n].idx,f===0)u=i[n];else for(r=n;r>=0;r--)if(i[r].idx===f-t){u=i[r];break}return u}function p(t,u,e,o){for(var h=k(t,u,e),c,a=h.cnt,v=new Array(i.collen),y=0,l,s=o;s<b;s++)f[s]._excol&&(l="{0}",n.each(h.summary,function(){if(this.nm===f[s].name){f[s].summaryTpl&&(l=f[s].summaryTpl);typeof this.st=="string"&&this.st.toLowerCase()==="avg"&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&a>0&&(this.v=this.v/a));try{this.groupCount=h.cnt;this.groupIndex=h.dataIndex;this.groupValue=h.value;c=r.formatter("",this.v,s,this)}catch(t){c=this.v}return v[y]=n.jgrid.formatCellCsv(n.jgrid.stripHtml(n.jgrid.template(l,c)),i),!1}}),y++);return v}var h="",u=r.p.groupingView,l=[],y=u.groupField.length,f=r.p.colModel,b=f.length,c=0,a,e,v,w,o;if(n.each(f,function(n,t){for(var i=0;i<y;i++)if(u.groupField[i]===t.name){l[i]=n;break}}),a=n.makeArray(u.groupSummary),a.reverse(),r.p.datatype==="local"&&!r.p.loadonce)for(n(r).jqGrid("groupingSetup"),w=n.jgrid.getMethod("groupingPrepare"),o=0;o<d;o++)w.call(n(r),s[o],o);return n.each(u.groups,function(o,s){var k,b,it,d;c++;try{e=n.isArray(u.formatDisplayField)&&n.isFunction(u.formatDisplayField[s.idx])?u.formatDisplayField[s.idx].call(r,s.displayValue,s.value,r.p.colModel[l[s.idx]],s.idx,u):r.formatter("",s.displayValue,l[s.idx],s.value)}catch(et){e=s.displayValue}if(k="",k=n.isFunction(u.groupText[s.idx])?u.groupText[s.idx].call(r,e,s.cnt,s.summary):n.jgrid.template(u.groupText[s.idx],e,s.cnt,s.summary),typeof k=="string"||typeof k=="number"||(k=e),b=u.groupSummaryPos[s.idx]==="header"?p(o,0,u.groups,0):new Array(i.collen),b[0]=n.jgrid.formatCellCsv(n.jgrid.stripHtml(k),i),h+=b.join(i.separator)+i.newLine,it=y-1===s.idx,it){for(var nt=u.groups[o+1],w,rt=0,ut=s.startRow,tt,ft=nt!==undefined?nt.startRow:u.groups[o].startRow+u.groups[o].cnt,g=ut;g<ft;g++){if(!t[g-rt])break;for(tt=t[g-rt],v=0,w=0;w<f.length;w++)f[w]._expcol&&(b[v]=n.jgrid.formatCellCsv(n.jgrid.formatCell(tt[f[w].name],w,tt,f[w],r,"csv"),i),v++);h+=b.join(i.separator)+i.newLine}if(u.groupSummaryPos[s.idx]!=="header"){if(nt!==undefined){for(d=0;d<u.groupField.length;d++)if(nt.dataIndex===u.groupField[d])break;c=u.groupField.length-d}for(w=0;w<c;w++)a[w]&&(b=p(o,w,u.groups,0),h+=b.join(i.separator)+i.newLine);c=d}}}),h}var c,l,rt,w,a,ut,b,k;t._regexsep=new RegExp(t.separator,"g");t._regexquot=new RegExp(t.quote,"g");var r=this,s=this.addLocalData(!0),d=s.length,h=r.p.colModel,ft=h.length,et=r.p.colNames,u,e=0,v,y="",f,o,g="",nt="",tt="",it="",p=[];if(c=[],n.each(h,function(i,r){r._expcol=!0;r.exportcol===undefined?r.hidden&&(r._expcol=!1):r._expcol=r.exportcol;(r.name==="cb"||r.name==="rn"||r.name==="subgrid")&&(r._expcol=!1);r._expcol&&(p.push(n.jgrid.formatCellCsv(et[i],t)),c.push(r.name))}),t.includeLabels&&(it=p.join(t.separator)+t.newLine),t.collen=p.length,r.p.grouping)rt=r.p.groupingView._locgr?!0:!1,r.p.groupingView._locgr=!1,y+=ot(s,t),r.p.groupingView._locgr=rt;else while(e<d){for(v=s[e],f=[],o=0,u=0;u<ft;u++)h[u]._expcol&&(f[o]=n.jgrid.formatCellCsv(n.jgrid.formatCell(v[h[u].name],u,v,h[u],r,"csv"),t),o++);y+=f.join(t.separator)+t.newLine;e++}if(s=null,f=new Array(t.collen),t.includeCaption&&r.p.caption){for(e=t.collen;--e;)f[e]="";f[0]=n.jgrid.formatCellCsv(r.p.caption,t);g+=f.join(t.separator)+t.newLine}if(t.includeGroupHeader&&r.p.groupHeader&&r.p.groupHeader.length)for(w=r.p.groupHeader,u=0;u<w.length;u++){for(a=w[u].groupHeaders,e=0,f=[],l=0;l<c.length;l++){for(f[e]="",o=0;o<a.length;o++)a[o].startColumnName===c[l]&&(f[e]=n.jgrid.formatCellCsv(a[o].titleText,t));e++}nt+=f.join(t.separator)+t.newLine}if(t.includeFooter&&r.p.footerrow&&(ut=n(".ui-jqgrid-ftable",this.sDiv),ut.length)){for(b=n(r).jqGrid("footerData","get"),u=0,f=[];u<t.collen;)k=c[u],b.hasOwnProperty(k)&&f.push(n.jgrid.formatCellCsv(n.jgrid.stripHtml(b[k]),t)),u++;tt+=f.join(t.separator)+t.newLine}i=g+nt+it+y+tt}),t.returnAsString)return i;n.jgrid.saveAs(i,t.fileName,{type:t.mimetype})},exportToExcel:function(t){t=n.extend(!0,{includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.xlsx",mimetype:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",maxlength:40,onBeforeExport:null,replaceStr:null},t||{});this.each(function(){function vt(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"")}function yt(t){function b(n,t,i){var u=!1,r,f;if(t===0)u=i[n];else if(f=i[n].idx,f===0)u=i[n];else for(r=n;r>=0;r--)if(i[r].idx===f-t){u=i[r];break}return u}function v(t,u,f,o){for(var h=b(t,u,f),c,a=h.cnt,v=y(i.header),l,s=o;s<w;s++)e[s]._expcol&&(l="{0}",n.each(h.summary,function(){if(this.nm===e[s].name){e[s].summaryTpl&&(l=e[s].summaryTpl);typeof this.st=="string"&&this.st.toLowerCase()==="avg"&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&a>0&&(this.v=this.v/a));try{this.groupCount=h.cnt;this.groupIndex=h.dataIndex;this.groupValue=h.value;c=r.formatter("",this.v,s,this)}catch(t){c=this.v}return v[this.nm]=n.jgrid.stripHtml(n.jgrid.template(l,c)),!1}}));return v}function y(n){for(var i={},t=0;t<n.length;t++)i[n[t]]="";return i}var u=r.p.groupingView,c=[],a=u.groupField.length,w=e.length,h=0,l,f,p,o;if(n.each(e,function(n,t){for(var i=0;i<a;i++)if(u.groupField[i]===t.name){c[i]=n;break}}),l=n.makeArray(u.groupSummary),l.reverse(),r.p.datatype==="local"&&!r.p.loadonce)for(n(r).jqGrid("groupingSetup"),p=n.jgrid.getMethod("groupingPrepare"),o=0;o<i.body.length;o++)p.call(n(r),i.body[o],o);n.each(u.groups,function(e,o){var p,w,nt,tt,rt,b;h++;try{f=n.isArray(u.formatDisplayField)&&n.isFunction(u.formatDisplayField[o.idx])?u.formatDisplayField[o.idx].call(r,o.displayValue,o.value,r.p.colModel[c[o.idx]],o.idx,u):r.formatter("",o.displayValue,c[o.idx],o.value)}catch(et){f=o.displayValue}if(p="",p=n.isFunction(u.groupText[o.idx])?u.groupText[o.idx].call(r,f,o.cnt,o.summary):n.jgrid.template(u.groupText[o.idx],f,o.cnt,o.summary),typeof p=="string"||typeof p=="number"||(p=f),w=u.groupSummaryPos[o.idx]==="header"?v(e,0,u.groups,0):y(i.header),nt=Object.keys(w),w[nt[0]]=n.jgrid.stripHtml(new Array(o.idx*5).join(" ")+p),s(w,!0),tt=a-1===o.idx,tt){for(var g=u.groups[e+1],d,it=0,ut=o.startRow,ft=g!==undefined?g.startRow:u.groups[e].startRow+u.groups[e].cnt,k=ut;k<ft;k++){if(!t[k-it])break;rt=t[k-it];s(rt,!1)}if(u.groupSummaryPos[o.idx]!=="header"){if(g!==undefined){for(b=0;b<u.groupField.length;b++)if(g.dataIndex===u.groupField[b])break;h=u.groupField.length-b}for(d=0;d<h;d++)l[d]&&(w=v(e,d,u.groups,0),s(w,!0));h=b}}})}for(var r=this,h=n.jgrid.excelStrings,g=0,f=n.parseXML(h["xl/worksheets/sheet1.xml"]),at=f.getElementsByTagName("sheetData")[0],nt={_rels:{".rels":n.parseXML(h["_rels/.rels"])},xl:{_rels:{"workbook.xml.rels":n.parseXML(h["xl/_rels/workbook.xml.rels"])},"workbook.xml":n.parseXML(h["xl/workbook.xml"]),"styles.xml":n.parseXML(h["xl/styles.xml"]),worksheets:{"sheet1.xml":f}},"[Content_Types].xml":n.parseXML(h["[Content_Types].xml"])},e=r.p.colModel,o=0,i={body:r.addLocalData(!0),header:[],footer:[],width:[],map:[]},et,tt,y,s,l,k,c,st,ht,rt,ct,d,lt,ut,a,ft,u=0,v=e.length;u<v;u++)(e[u]._expcol=!0,e[u].exportcol===undefined?e[u].hidden&&(e[u]._expcol=!1):e[u]._expcol=e[u].exportcol,e[u].name!=="cb"&&e[u].name!=="rn"&&e[u].name!=="subgrid"&&e[u]._expcol)&&(i.header[o]=e[u].name,i.width[o]=5,i.map[o]=u,o++);if(et=n.isFunction(t.replaceStr)?t.replaceStr:vt,s=function(u,o){var w,h,a,c,v,s,p,b,l,k;for(tt=g+1,y=n.jgrid.makeNode(f,"row",{attr:{r:tt}}),w=15,h=0;h<i.header.length;h++){for(a=n.jgrid.excelCellPos(h)+""+tt,s=n.isArray(u)&&o?r.p.colNames[i.map[h]]:u[i.header[h]],s==null&&(s=""),o||(s=n.jgrid.formatCell(s,i.map[h],u,e[i.map[h]],r,"excel")),i.width[h]=Math.max(i.width[h],Math.min(parseInt(s.toString().length,10),t.maxlength)),s.match&&(v=s.match(/^-?([1-9]\d+)(\.(\d+))?$/)),c=null,p=0,b=n.jgrid.excelParsers.length;p<b;p++)if(l=n.jgrid.excelParsers[p],s.match&&!s.match(/^0\d+/)&&s.match(l.match)){s=s.replace(/[^\d\.\-]/g,"");l.fmt&&(s=l.fmt(s));c=l.style===67?n.jgrid.makeNode(f,"c",{attr:{t:"d",r:a,s:l.style},children:[n.jgrid.makeNode(f,"v",{text:s})]}):n.jgrid.makeNode(f,"c",{attr:{r:a,s:l.style},children:[n.jgrid.makeNode(f,"v",{text:s})]});y.appendChild(c);break}c||(typeof s=="number"&&s.toString().length<=w||v&&v[1].length+(v[2]?v[3].length:0)<=w?c=n.jgrid.makeNode(f,"c",{attr:{t:"n",r:a},children:[n.jgrid.makeNode(f,"v",{text:s})]}):(k=s.replace?et(s):s,c=n.jgrid.makeNode(f,"c",{attr:{t:"inlineStr",r:a},children:{row:n.jgrid.makeNode(f,"is",{children:{row:n.jgrid.makeNode(f,"t",{text:k})}})}})),y.appendChild(c))}at.appendChild(y);g++},n("sheets sheet",nt.xl["workbook.xml"]).attr("name",t.sheetName),t.includeGroupHeader&&r.p.groupHeader&&r.p.groupHeader.length){for(var ot=r.p.groupHeader,p=[],it=0,w,b=0;b<ot.length;b++){for(l=ot[b].groupHeaders,k={},it++,u=0,u=0;u<i.header.length;u++)for(w=i.header[u],k[w]="",c=0;c<l.length;c++)l[c].startColumnName===w&&(k[w]=l[c].titleText,st=n.jgrid.excelCellPos(u)+it,ht=n.jgrid.excelCellPos(u+l[c].numberOfColumns-1)+it,p.push({ref:st+":"+ht}));s(k,!0)}for(n("row c",f).attr("s","2"),rt=n.jgrid.makeNode(f,"mergeCells",{attr:{count:p.length}}),n("worksheet",f).append(rt),o=0;o<p.length;o++)rt.appendChild(n.jgrid.makeNode(f,"mergeCell",{attr:p[o]}))}if(t.includeLabels&&(s(i.header,!0),n("row:last c",f).attr("s","2")),r.p.grouping)ct=r.p.groupingView._locgr?!0:!1,r.p.groupingView._locgr=!1,yt(i.body),r.p.groupingView._locgr=ct;else for(d=0,lt=i.body.length;d<lt;d++)s(i.body[d],!1);if(t.includeFooter||r.p.footerrow){i.footer=n(r).jqGrid("footerData","get");for(o in i.footer)i.footer.hasOwnProperty(o)&&(i.footer[o]=n.jgrid.stripHtml(i.footer[o]));s(i.footer,!0);n("row:last c",f).attr("s","2")}for(ut=n.jgrid.makeNode(f,"cols"),n("worksheet",f).prepend(ut),o=0,v=i.width.length;o<v;o++)ut.appendChild(n.jgrid.makeNode(f,"col",{attr:{min:o+1,max:o+1,width:i.width[o],customWidth:1}}));if(n.isFunction(t.onBeforeExport))t.onBeforeExport(nt,g);i=null;try{a=new JSZip;ft={type:"blob",mimeType:t.mimetype};n.jgrid.xmlToZip(a,nt);a.generateAsync?a.generateAsync(ft).then(function(i){n.jgrid.saveAs(i,t.fileName,{type:t.mimetype})}):n.jgrid.saveAs(a.generate(ft),t.fileName,{type:t.mimetype})}catch(pt){throw pt;}})},exportToPdf:function(t){return t=n.extend(!0,{title:null,orientation:"portrait",pageSize:"A4",description:null,onBeforeExport:null,download:"download",includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,fileName:"jqGridExport.pdf",mimetype:"application/pdf"},t||{}),this.each(function(){function ut(t){function p(t,r){for(var h=0,c=[],e=0;e<f.length;e++)s={text:t[f[e]]==null?"":r?n.jgrid.formatCell(t[f[e]]+"",v[h],a[o],u[v[h]],i,"pdf"):t[f[e]],alignment:b[e],style:"tableBody"},c.push(s),h++;return c}function it(n,t,i){var u=!1,r,f;if(t===0)u=i[n];else if(f=i[n].idx,f===0)u=i[n];else for(r=n;r>=0;r--)if(i[r].idx===f-t){u=i[r];break}return u}function d(t,r,e,o){for(var h=it(t,r,e),c,a=h.cnt,v=g(f),l,s=o;s<tt;s++)u[s]._expcol&&(l="{0}",n.each(h.summary,function(){if(this.nm===u[s].name){u[s].summaryTpl&&(l=u[s].summaryTpl);typeof this.st=="string"&&this.st.toLowerCase()==="avg"&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&a>0&&(this.v=this.v/a));try{this.groupCount=h.cnt;this.groupIndex=h.dataIndex;this.groupValue=h.value;c=i.formatter("",this.v,s,this)}catch(t){c=this.v}return v[this.nm]=n.jgrid.stripHtml(n.jgrid.template(l,c)),!1}}));return v}function g(n){for(var i={},t=0;t<n.length;t++)i[n[t]]="";return i}var r=i.p.groupingView,y=[],k=r.groupField.length,u=i.p.colModel,tt=u.length,l=0,w,e,nt,h;if(n.each(u,function(n,t){for(var i=0;i<k;i++)if(r.groupField[i]===t.name){y[i]=n;break}}),w=n.makeArray(r.groupSummary),w.reverse(),i.p.datatype==="local"&&!i.p.loadonce)for(n(i).jqGrid("groupingSetup"),nt=n.jgrid.getMethod("groupingPrepare"),h=0;h<a.length;h++)nt.call(n(i),a[h],h);n.each(r.groups,function(u,o){var s,h,tt,it,ut,a;l++;try{e=n.isArray(r.formatDisplayField)&&n.isFunction(r.formatDisplayField[o.idx])?r.formatDisplayField[o.idx].call(i,o.displayValue,o.value,i.p.colModel[y[o.idx]],o.idx,r):i.formatter("",o.displayValue,y[o.idx],o.value)}catch(ot){e=o.displayValue}if(s="",s=n.isFunction(r.groupText[o.idx])?r.groupText[o.idx].call(i,e,o.cnt,o.summary):n.jgrid.template(r.groupText[o.idx],e,o.cnt,o.summary),typeof s=="string"||typeof s=="number"||(s=e),h=r.groupSummaryPos[o.idx]==="header"?d(u,0,r.groups,0):g(f),tt=Object.keys(h),h[tt[0]]=n.jgrid.stripHtml(new Array(o.idx*5).join(" ")+s),c.push(p(h,!1)),it=k-1===o.idx,it){for(var nt=r.groups[u+1],b,rt=0,ft=o.startRow,et=nt!==undefined?nt.startRow:r.groups[u].startRow+r.groups[u].cnt,v=ft;v<et;v++){if(!t[v-rt])break;ut=t[v-rt];c.push(p(ut,!0))}if(r.groupSummaryPos[o.idx]!=="header"){if(nt!==undefined){for(a=0;a<r.groupField.length;a++)if(nt.dataIndex===r.groupField[a])break;l=r.groupField.length-a}for(b=0;b<l;b++)w[b]&&(h=d(u,b,r.groups,0),c.push(p(h,!1)));l=a}}})}for(var i=this,c=[],u=i.p.colModel,s={},e,a=i.addLocalData(!0),f=[],o=0,v=[],l=[],tt=[],b={},h,k,d,y,it,g,rt,p,nt,r=0,w=u.length;r<w;r++)(u[r]._expcol=!0,u[r].exportcol===undefined?u[r].hidden&&(u[r]._expcol=!1):u[r]._expcol=u[r].exportcol,u[r].name!=="cb"&&u[r].name!=="rn"&&u[r].name!=="subgrid"&&u[r]._expcol)&&(s={text:i.p.colNames[r],style:"tableHeader"},l.push(s),f[o]=u[r].name,v[o]=r,tt.push(u[r].width),b[u[r].name]=u[r].align||"left",o++);if(t.includeGroupHeader&&i.p.groupHeader&&i.p.groupHeader.length)for(k=i.p.groupHeader,o=0;o<k.length;o++){for(d=[],y=k[o].groupHeaders,e=0;e<f.length;e++){for(s={text:"",style:"tableHeader"},h=0;h<y.length;h++)y[h].startColumnName===f[e]&&(s={text:y[h].titleText,colSpan:y[h].numberOfColumns,style:"tableHeader"});d.push(s);r++}c.push(d)}if(t.includeLabels&&c.push(l),i.p.grouping)it=i.p.groupingView._locgr?!0:!1,i.p.groupingView._locgr=!1,ut(a),i.p.groupingView._locgr=it;else for(o=0,w=a.length;o<w;o++){for(h=0,l=[],g=a[o],e=0;e<f.length;e++)s={text:g[f[e]]==null?"":n.jgrid.formatCell(g[f[e]]+"",v[h],a[o],u[v[h]],i,"pdf"),alignment:b[f[e]],style:"tableBody"},l.push(s),h++;c.push(l)}if(t.includeFooter&&i.p.footerrow){for(rt=n(i).jqGrid("footerData","get"),l=[],e=0;e<f.length;e++)s={text:n.jgrid.stripHtml(rt[f[e]]),style:"tableFooter",alignment:b[f[e]]},l.push(s);c.push(l)}p={pageSize:t.pageSize,pageOrientation:t.orientation,content:[{style:"tableExample",widths:tt,table:{headerRows:k!=null?0:1,body:c}}],styles:{tableHeader:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc",alignment:"center"},tableBody:{fontSize:10},tableFooter:{bold:!0,fontSize:11,color:"#2e6e9e",fillColor:"#dfeffc"},title:{alignment:"center",fontSize:15},description:{}},defaultStyle:{fontSize:10}};t.description&&p.content.unshift({text:t.description,style:"description",margin:[0,0,0,12]});t.title&&p.content.unshift({text:t.title,style:"title",margin:[0,0,0,12]});n.isFunction(t.onBeforeExport)&&t.onBeforeExport.call(i,p);try{nt=pdfMake.createPdf(p);t.download==="open"?nt.open():nt.getBuffer(function(i){n.jgrid.saveAs(i,t.fileName,{type:t.mimetype})})}catch(ft){throw ft;}})},exportToHtml:function(t){t=n.extend(!0,{title:"",onBeforeExport:null,includeLabels:!0,includeGroupHeader:!0,includeFooter:!0,tableClass:"jqgridprint",autoPrint:!1,topText:"",bottomText:"",returnAsString:!1},t||{});var i;return this.each(function(){function k(t){function k(n,t,i){var u=!1,r,f;if(t===0)u=i[n];else if(f=i[n].idx,f===0)u=i[n];else for(r=n;r>=0;r--)if(i[r].idx===f-t){u=i[r];break}return u}function y(t,i,e,o){for(var h=k(t,i,e),c,a=h.cnt,v=p(r.header),l,s=o;s<b;s++)u[s]._expcol&&(l="{0}",n.each(h.summary,function(){if(this.nm===u[s].name){u[s].summaryTpl&&(l=u[s].summaryTpl);typeof this.st=="string"&&this.st.toLowerCase()==="avg"&&(this.sd&&this.vd?this.v=this.v/this.vd:this.v&&a>0&&(this.v=this.v/a));try{this.groupCount=h.cnt;this.groupIndex=h.dataIndex;this.groupValue=h.value;c=f.formatter("",this.v,s,this)}catch(t){c=this.v}return v[this.nm]=n.jgrid.stripHtml(n.jgrid.template(l,c)),!1}}));return v}function p(n){for(var i={},t=0;t<n.length;t++)i[n[t]]="";return i}var i=f.p.groupingView,c=[],v=i.groupField.length,b=u.length,o=0,h="",a,e,w,s;if(n.each(u,function(n,t){for(var r=0;r<v;r++)if(i.groupField[r]===t.name){c[r]=n;break}}),a=n.makeArray(i.groupSummary),a.reverse(),f.p.datatype==="local"&&!f.p.loadonce)for(n(f).jqGrid("groupingSetup"),w=n.jgrid.getMethod("groupingPrepare"),s=0;s<r.body.length;s++)w.call(n(f),r.body[s],s);return n.each(i.groups,function(u,s){var b,w,tt,it,rt,ft,k;o++;try{e=n.isArray(i.formatDisplayField)&&n.isFunction(i.formatDisplayField[s.idx])?i.formatDisplayField[s.idx].call(f,s.displayValue,s.value,f.p.colModel[c[s.idx]],s.idx,i):f.formatter("",s.displayValue,c[s.idx],s.value)}catch(st){e=s.displayValue}if(b="",b=n.isFunction(i.groupText[s.idx])?i.groupText[s.idx].call(f,e,s.cnt,s.summary):n.jgrid.template(i.groupText[s.idx],e,s.cnt,s.summary),typeof b=="string"||typeof b=="number"||(b=e),tt=!1,i.groupSummaryPos[s.idx]==="header"?w=y(u,0,i.groups,0):(w=p(r.header),tt=!0),it=Object.keys(w),w[it[0]]=new Array(s.idx*5).join(" ")+b,h+=l(w,"td",!1,o===1,tt),rt=v-1===s.idx,rt){for(var nt=i.groups[u+1],g,ut=0,et=s.startRow,ot=nt!==undefined?nt.startRow:i.groups[u].startRow+i.groups[u].cnt,d=et;d<ot;d++){if(!t[d-ut])break;ft=t[d-ut];h+=l(ft,"td",!1)}if(i.groupSummaryPos[s.idx]!=="header"){if(nt!==undefined){for(k=0;k<i.groupField.length;k++)if(nt.dataIndex===i.groupField[k])break;o=i.groupField.length-k}for(g=0;g<o;g++)a[g]&&(w=y(u,g,i.groups,0),h+=l(w,"td",!1));o=k}}}),h}for(var f=this,u=f.p.colModel,s=0,r={body:f.addLocalData(!0),header:[],footer:[],width:[],map:[],align:[]},h,p,o,v,e=0,a=u.length;e<a;e++)(u[e]._expcol=!0,u[e].exportcol===undefined?u[e].hidden&&(u[e]._expcol=!1):u[e]._expcol=u[e].exportcol,u[e].name!=="cb"&&u[e].name!=="rn"&&u[e].name!=="subgrid"&&u[e]._expcol)&&(r.header[s]=u[e].name,r.width[s]=u[e].width,r.map[s]=e,r.align[s]=u[e].align||"left",s++);var c=document.createElement("a"),w=function(t){var i=n(t).clone()[0];return i.nodeName.toLowerCase()==="link"&&(i.href=y(i.href)),i.outerHTML},y=function(n){c.href=n;var t=c.host;return t.indexOf("/")===-1&&c.pathname.indexOf("/")!==0&&(t+="/"),c.protocol+"//"+t+c.pathname+c.search},b=function(n,t,i){for(var e="<tr>",o,u=0,s=n.length;u<s;u++)o=i===!0?" style=width:"+r.width[u]+"px;":"",e+="<"+t+o+">"+f.p.colNames[r.map[u]]+"<\/"+t+">";return e+"<\/tr>"},l=function(t,i,e,o,s){for(var l="<tr>",c,a,h=0,v=r.header.length;h<v;h++)if(a=s?' colspan= "'+r.header.length+'" style=text-align:left':o===!0?" style=width:"+r.width[h]+"px;text-align:"+r.align[h]+";":" style=text-align:"+r.align[h]+";",c=r.header[h],t.hasOwnProperty(c)&&(l+="<"+i+a+">"+(e?n.jgrid.formatCell(t[c],r.map[h],t,u[r.map[h]],f,"html"):t[c])+"<\/"+i+">"),s)break;return l+"<\/tr>"};if(h='<table class="'+t.tableClass+'">',t.includeLabels&&(h+="<thead>"+b(r.header,"th",!0)+"<\/thead>"),h+="<tbody>",f.p.grouping)p=f.p.groupingView._locgr?!0:!1,f.p.groupingView._locgr=!1,h+=k(r.body),f.p.groupingView._locgr=p;else for(s=0,a=r.body.length;s<a;s++)h+=l(r.body[s],"td",!0,s===0?!0:!1);if(t.includeFooter&&f.p.footerrow&&(r.footer=n(f).jqGrid("footerData","get",null,!1),h+=l(r.footer,"td",!1)),h+="<\/tbody>",h+="<\/table>",t.returnAsString)i=h;else{o=window.open("","");o.document.close();v=t.title?"<title>"+t.title+"<\/title>":"";n("style, link").each(function(){v+=w(this)});try{o.document.head.innerHTML=v}catch(d){n(o.document.head).html(v)}if(o.document.body.innerHTML=(t.title?"<h1>"+t.title+"<\/h1>":"")+"<div>"+(t.topText||"")+"<\/div>"+h+"<div>"+(t.bottomText||"")+"<\/div>",n(o.document.body).addClass("html-view"),n("img",o.document.body).each(function(n,t){t.setAttribute("src",y(t.getAttribute("src")))}),t.onBeforeExport)t.onBeforeExport(o);Boolean(o.chrome)?t.autoPrint&&(o.print(),o.close()):setTimeout(function(){t.autoPrint&&(o.print(),o.close())},1e3)}}),i}})}),function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","../grid.base"],n):n(jQuery)}(function(n){n.jgrid=n.jgrid||{};n.jgrid.hasOwnProperty("regional")||(n.jgrid.regional=[]);n.jgrid.regional.cn={defaults:{recordtext:"第{0}到第{1}条　共 {2} 条",emptyrecords:"没有记录！",loadtext:"读取中...",savetext:"保存中...",pgtext:"第{0}页　共{1}页",pgfirst:"第一页",pglast:"最后一页",pgnext:"下一页",pgprev:"上一页",pgrecs:"每页记录数",showhide:"切换 展开 折叠 表格",pagerCaption:"表格::页面设置",pageText:"Page:",recordPage:"每页记录数",nomorerecs:"没有更多记录...",scrollPullup:"加载更多...",scrollPulldown:"刷新...",scrollRefresh:"滚动刷新..."},search:{caption:"搜索...",Find:"查找",Reset:"重置",odata:[{oper:"eq",text:"等于　　"},{oper:"ne",text:"不等于　"},{oper:"lt",text:"小于　　"},{oper:"le",text:"小于等于"},{oper:"gt",text:"大于　　"},{oper:"ge",text:"大于等于"},{oper:"bw",text:"开头是"},{oper:"bn",text:"开头不是"},{oper:"in",text:"属于　　"},{oper:"ni",text:"不属于"},{oper:"ew",text:"结尾是"},{oper:"en",text:"结尾不是"},{oper:"cn",text:"包含　　"},{oper:"nc",text:"不包含"},{oper:"nu",text:"为空"},{oper:"nn",text:"不为空"},{oper:"bt",text:"区间"}],groupOps:[{op:"AND",text:"满足所有条件"},{op:"OR",text:"满足任一条件"}],operandTitle:"单击进行搜索。",resetTitle:"重置搜索条件",addsubgrup:"添加条件组",addrule:"添加条件",delgroup:"删除条件组",delrule:"删除条件"},edit:{addCaption:"添加记录",editCaption:"编辑记录",bSubmit:"提交",bCancel:"取消",bClose:"关闭",saveData:"数据已修改，是否保存？",bYes:"是",bNo:"否",bExit:"取消",msg:{required:"此字段必需",number:"请输入有效数字",minValue:"输值必须大于等于 ",maxValue:"输值必须小于等于 ",email:"这不是有效的e-mail地址",integer:"请输入有效整数",date:"请输入有效时间",url:"无效网址。前缀必须为 ('http://' 或 'https://')",nodefined:" 未定义！",novalue:" 需要返回值！",customarray:"自定义函数需要返回数组！",customfcheck:"必须有自定义函数!"}},view:{caption:"查看记录",bClose:"关闭"},del:{caption:"删除",msg:"删除所选记录？",bSubmit:"删除",bCancel:"取消"},nav:{edittext:"",edittitle:"编辑所选记录",addtext:"",addtitle:"添加新记录",deltext:"",deltitle:"删除所选记录",searchtext:"",searchtitle:"查找",refreshtext:"",refreshtitle:"刷新表格",alertcap:"注意",alerttext:"请选择记录",viewtext:"",viewtitle:"查看所选记录",savetext:"",savetitle:"保存记录",canceltext:"",canceltitle:"取消编辑记录",selectcaption:"操作..."},col:{caption:"选择列",bSubmit:"确定",bCancel:"取消"},errors:{errcap:"错误",nourl:"没有设置url",norecords:"没有需要处理的记录",model:"colNames 和 colModel 长度不等！"},formatter:{integer:{thousandsSeparator:",",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:",",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["日","一","二","三","四","五","六","星期日","星期一","星期二","星期三","星期四","星期五","星期六",],monthNames:["一","二","三","四","五","六","七","八","九","十","十一","十二","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],AmPm:["am","pm","上午","下午"],S:function(n){return n<11||n>13?["st","nd","rd","th"][Math.min((n-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"Y-m-d",parseRe:/[#%\\\/:_;.,\t\s-]/,masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:!1,userLocalTime:!1},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:!0},idName:"id"},colmenu:{sortasc:"升序排序",sortdesc:"降序排序",columns:"列",filter:"筛选",grouping:"分类",ungrouping:"取消分类",searchTitle:"查找:",freeze:"冻结",unfreeze:"取消冻结",reorder:"重新排序"}}});
/*! X-editable - v1.5.1 
* In-place editing with Twitter Bootstrap, jQuery UI or pure jQuery
* http://github.com/vitalets/x-editable
* Copyright (c) 2013 Vitaliy Potapov; Licensed MIT */
(function(n){"use strict";var t=function(t,i){this.options=n.extend({},n.fn.editableform.defaults,i);this.$div=n(t);this.options.scope||(this.options.scope=this)};t.prototype={constructor:t,initInput:function(){this.input=this.options.input;this.value=this.input.str2value(this.options.value);this.input.prerender()},initTemplate:function(){this.$form=n(n.fn.editableform.template)},initButtons:function(){var t=this.$form.find(".editable-buttons");t.append(n.fn.editableform.buttons);this.options.showbuttons==="bottom"&&t.addClass("editable-buttons-bottom")},render:function(){this.$loading=n(n.fn.editableform.loading);this.$div.empty().append(this.$loading);this.initTemplate();this.options.showbuttons?this.initButtons():this.$form.find(".editable-buttons").remove();this.showLoading();this.isSaving=!1;this.$div.triggerHandler("rendering");this.initInput();this.$form.find("div.editable-input").append(this.input.$tpl);this.$div.append(this.$form);n.when(this.input.render()).then(n.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable-cancel").click(n.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(".editable-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(n){n.preventDefault()});else{this.error(!1);this.input.$input.removeAttr("disabled");this.$form.find(".editable-submit").removeAttr("disabled");var t=this.value===null||this.value===undefined||this.value===""?this.options.defaultValue:this.value;this.input.value2input(t);this.$form.submit(n.proxy(this.submit,this))}this.$div.triggerHandler("rendered");this.showForm();this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var n,t;this.$form?(n=this.$form.outerWidth(),t=this.$form.outerHeight(),n&&this.$loading.width(n),t&&this.$loading.height(t),this.$form.hide()):(n=this.$loading.parent().width(),n&&this.$loading.width(n));this.$loading.show()},showForm:function(n){this.$loading.hide();this.$form.show();n!==!1&&this.input.activate();this.$div.triggerHandler("show")},error:function(t){var u=this.$form.find(".control-group"),f=this.$form.find(".editable-error-block"),i,r;if(t===!1)u.removeClass(n.fn.editableform.errorGroupClass),f.removeClass(n.fn.editableform.errorBlockClass).empty().hide();else{if(t){for(i=(""+t).split("\n"),r=0;r<i.length;r++)i[r]=n("<div>").text(i[r]).html();t=i.join("<br>")}u.addClass(n.fn.editableform.errorGroupClass);f.addClass(n.fn.editableform.errorBlockClass).html(t).show()}},submit:function(t){var i,r,u;if(t.stopPropagation(),t.preventDefault(),i=this.input.input2value(),r=this.validate(i),n.type(r)==="object"&&r.newValue!==undefined){if(i=r.newValue,this.input.value2input(i),typeof r.msg=="string"){this.error(r.msg);this.showForm();return}}else if(r){this.error(r);this.showForm();return}if(!this.options.savenochange&&this.input.value2str(i)==this.input.value2str(this.value)){this.$div.triggerHandler("nochange");return}u=this.input.value2submit(i);this.isSaving=!0;n.when(this.save(u)).done(n.proxy(function(n){this.isSaving=!1;var t=typeof this.options.success=="function"?this.options.success.call(this.options.scope,n,i):null;if(t===!1){this.error(!1);this.showForm(!1);return}if(typeof t=="string"){this.error(t);this.showForm();return}t&&typeof t=="object"&&t.hasOwnProperty("newValue")&&(i=t.newValue);this.error(!1);this.value=i;this.$div.triggerHandler("save",{newValue:i,submitValue:u,response:n})},this)).fail(n.proxy(function(n){this.isSaving=!1;var t;t=typeof this.options.error=="function"?this.options.error.call(this.options.scope,n,i):typeof n=="string"?n:n.responseText||n.statusText||"Unknown error!";this.error(t);this.showForm()},this))},save:function(t){this.options.pk=n.fn.editableutils.tryParseJson(this.options.pk,!0);var r=typeof this.options.pk=="function"?this.options.pk.call(this.options.scope):this.options.pk,u=!!(typeof this.options.url=="function"||this.options.url&&(this.options.send==="always"||this.options.send==="auto"&&r!==null&&r!==undefined)),i;if(u)return this.showLoading(),i={name:this.options.name||"",value:t,pk:r},typeof this.options.params=="function"?i=this.options.params.call(this.options.scope,i):(this.options.params=n.fn.editableutils.tryParseJson(this.options.params,!0),n.extend(i,this.options.params)),typeof this.options.url=="function"?this.options.url.call(this.options.scope,i):n.ajax(n.extend({url:this.options.url,data:i,type:"POST"},this.options.ajaxOptions))},validate:function(n){return n===undefined&&(n=this.value),typeof this.options.validate=="function"?this.options.validate.call(this.options.scope,n):void 0},option:function(n,t){n in this.options&&(this.options[n]=t);n==="value"&&this.setValue(t)},setValue:function(n,t){this.value=t?this.input.str2value(n):n;this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}};n.fn.editableform=function(i){var r=arguments;return this.each(function(){var f=n(this),u=f.data("editableform"),e=typeof i=="object"&&i;u||f.data("editableform",u=new t(this,e));typeof i=="string"&&u[i].apply(u,Array.prototype.slice.call(r,1))})};n.fn.editableform.Constructor=t;n.fn.editableform.defaults={type:"text",url:null,params:null,name:null,title:"",pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1};n.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"><\/div><div class="editable-buttons"><\/div><\/div><div class="editable-error-block"><\/div><\/div><\/form>';n.fn.editableform.loading='<div class="editableform-loading"><\/div>';n.fn.editableform.buttons='<button type="submit" class="editable-submit">ok<\/button><button type="button" class="editable-cancel">cancel<\/button>';n.fn.editableform.errorGroupClass=null;n.fn.editableform.errorBlockClass="editable-error";n.fn.editableform.engine="jquery"})(window.jQuery),function(n){"use strict";n.fn.editableutils={inherit:function(n,t){var i=function(){};i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n;n.superclass=t.prototype},setCursorPosition:function(n,t){if(n.setSelectionRange)n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},tryParseJson:function(n,t){if(typeof n=="string"&&n.length&&n.match(/^[\{\[].*[\}\]]$/))if(t)try{n=new Function("return "+n)()}catch(i){}finally{return n}else n=new Function("return "+n)();return n},sliceObj:function(t,i,r){var u,o,f={},e;if(!n.isArray(i)||!i.length)return f;for(e=0;e<i.length;e++)(u=i[e],t.hasOwnProperty(u)&&(f[u]=t[u]),r!==!0)&&(o=u.toLowerCase(),t.hasOwnProperty(o)&&(f[u]=t[o]));return f},getConfigData:function(t){var i={};return n.each(t.data(),function(n,t){(typeof t!="object"||t&&typeof t=="object"&&(t.constructor===Object||t.constructor===Array))&&(i[n]=t)}),i},objectKeys:function(n){if(Object.keys)return Object.keys(n);if(n!==Object(n))throw new TypeError("Object.keys called on a non-object");var t=[];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.push(i);return t},escape:function(t){return n("<div>").text(t).html()},itemsByValue:function(t,i,r){var f;if(!i||t===null)return[];typeof r!="function"&&(f=r||"value",r=function(n){return n[f]});var e=n.isArray(t),u=[],o=this;return n.each(i,function(i,f){if(f.children)u=u.concat(o.itemsByValue(t,f.children,r));else if(e)n.grep(t,function(n){return n==(f&&typeof f=="object"?r(f):f)}).length&&u.push(f);else{var s=f&&typeof f=="object"?r(f):f;t==s&&u.push(f)}}),u},createInput:function(t){var r,u,i=t.type;return i==="date"&&(t.mode==="inline"?n.fn.editabletypes.datefield?i="datefield":n.fn.editabletypes.dateuifield&&(i="dateuifield"):n.fn.editabletypes.date?i="date":n.fn.editabletypes.dateui&&(i="dateui"),i!=="date"||n.fn.editabletypes.date||(i="combodate")),i==="datetime"&&t.mode==="inline"&&(i="datetimefield"),i!=="wysihtml5"||n.fn.editabletypes[i]||(i="textarea"),typeof n.fn.editabletypes[i]=="function"?(r=n.fn.editabletypes[i],u=this.sliceObj(t,this.objectKeys(r.defaults)),new r(u)):(n.error("Unknown type: "+i),!1)},supportsTransitions:function(){var u=document.body||document.documentElement,i=u.style,n="transition",r=["Moz","Webkit","Khtml","O","ms"],t;if(typeof i[n]=="string")return!0;for(n=n.charAt(0).toUpperCase()+n.substr(1),t=0;t<r.length;t++)if(typeof i[r[t]+n]=="string")return!0;return!1}}}(window.jQuery),function(n){"use strict";var t=function(n,t){this.init(n,t)},i=function(n,t){this.init(n,t)};t.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(i,r){this.$element=n(i);this.options=n.extend({},n.fn.editableContainer.defaults,r);this.splitOptions();this.formOptions.scope=this.$element[0];this.initContainer();this.delayedHide=!1;this.$element.on("destroyed",n.proxy(function(){this.destroy()},this));if(!n(document).data("editable-handlers-attached")){n(document).on("keyup.editable",function(t){t.which===27&&n(".editable-open").editableContainer("hide")});n(document).on("click.editable",function(i){var u=n(i.target),r,f=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!n(".select2-drop-mask").is(":visible")&&n.contains(document.documentElement,i.target)&&!u.is(document)){for(r=0;r<f.length;r++)if(u.is(f[r])||u.parents(f[r]).length)return;t.prototype.closeOthers(i.target)}});n(document).data("editable-handlers-attached",!0)}},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!n.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var t in this.options)t in this.defaults?this.containerOptions[t]=this.options[t]:this.formOptions[t]=this.options[t]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var n;return this.containerDataName&&(n=this.$element.data(this.containerDataName))?n:this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:n.proxy(this.save,this),nochange:n.proxy(function(){this.hide("nochange")},this),cancel:n.proxy(function(){this.hide("cancel")},this),show:n.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:n.proxy(this.setPosition,this),resize:n.proxy(this.setPosition,this),rendered:n.proxy(function(){this.$element.triggerHandler("shown",n(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(t){this.$element.addClass("editable-open");t!==!1&&this.closeOthers(this.$element[0]);this.innerShow();this.tip().addClass(this.containerClass);this.$form;this.$form=n("<div>");this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form);this.renderForm()},hide:function(n){if(this.tip()&&this.tip().is(":visible")&&this.$element.hasClass("editable-open")){if(this.$form.data("editableform").isSaving){this.delayedHide={reason:n};return}this.delayedHide=!1;this.$element.removeClass("editable-open");this.innerHide();this.$element.triggerHandler("hidden",n||"manual")}},innerShow:function(){},innerHide:function(){},toggle:function(n){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(n)},setPosition:function(){},save:function(n,t){this.$element.triggerHandler("save",t);this.hide("save")},option:function(n,t){this.options[n]=t;n in this.containerOptions?(this.containerOptions[n]=t,this.setContainerOption(n,t)):(this.formOptions[n]=t,this.$form&&this.$form.editableform("option",n,t))},setContainerOption:function(n,t){this.call("option",n,t)},destroy:function(){this.hide();this.innerDestroy();this.$element.off("destroyed");this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(t){n(".editable-open").each(function(i,r){if(r!==t&&!n(r).find(t).length){var f=n(r),u=f.data("editableContainer");u&&(u.options.onblur==="cancel"?u.options.type!="reference"&&f.data("editableContainer").hide("onblur"):u.options.onblur==="submit"&&f.data("editableContainer").tip().find("form").submit())}})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editableform").input.activate()}};n.fn.editableContainer=function(r){var u=arguments;return this.each(function(){var e=n(this),o="editableContainer",f=e.data(o),s=typeof r=="object"&&r,h=s.mode==="inline"?i:t;f||e.data(o,f=new h(this,s));typeof r=="string"&&f[r].apply(f,Array.prototype.slice.call(u,1))})};n.fn.editableContainer.Popup=t;n.fn.editableContainer.Inline=i;n.fn.editableContainer.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"};jQuery.event.special.destroyed={remove:function(n){n.handler&&n.handler()}}}(window.jQuery),function(n){"use strict";n.extend(n.fn.editableContainer.Inline.prototype,n.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=n("<span><\/span>");this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={};this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide();this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,n.proxy(function(){this.$element.show();this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(n){"use strict";var t=function(t,i){this.$element=n(t);this.options=n.extend({},n.fn.editable.defaults,i,n.fn.editableutils.getConfigData(this.$element));this.options.selector?this.initLive():this.init();this.options.highlight&&!n.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};t.prototype={constructor:t,init:function(){var i=!1,t;if(this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=n.fn.editableutils.createInput(this.options),this.input){if(this.options.value===undefined||this.options.value===null?(this.value=this.input.html2value(n.trim(this.$element.html())),i=!0):(this.options.value=n.fn.editableutils.tryParseJson(this.options.value,!0),this.value=typeof this.options.value=="string"?this.input.str2value(this.options.value):this.options.value),this.$element.addClass("editable"),this.input.type==="textarea"&&this.$element.addClass("editable-pre-wrapped"),this.options.toggle!=="manual"){this.$element.addClass("editable-click");this.$element.on(this.options.toggle+".editable",n.proxy(function(n){if(this.options.disabled||n.preventDefault(),this.options.toggle==="mouseenter")this.show();else{var t=this.options.toggle!=="click";this.toggle(t)}},this))}else this.$element.attr("tabindex",-1);typeof this.options.display=="function"&&(this.options.autotext="always");switch(this.options.autotext){case"always":t=!0;break;case"auto":t=!n.trim(this.$element.text()).length&&this.value!==null&&this.value!==undefined&&!i;break;default:t=!1}n.when(t?this.render():!0).then(n.proxy(function(){this.options.disabled?this.disable():this.enable();this.$element.triggerHandler("init",this)},this))}},initLive:function(){var t=this.options.selector;this.options.selector=!1;this.options.autotext="never";this.$element.on(this.options.toggle+".editable",t,n.proxy(function(t){var i=n(t.target);i.data("editable")||(i.hasClass(this.options.emptyclass)&&i.empty(),i.editable(this.options).trigger(t))},this))},render:function(n){if(this.options.display!==!1)return this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,n):typeof this.options.display=="function"?this.options.display.call(this.$element[0],this.value,n):this.input.value2html(this.value,this.$element[0])},enable:function(){this.options.disabled=!1;this.$element.removeClass("editable-disabled");this.handleEmpty(this.isEmpty);this.options.toggle!=="manual"&&this.$element.attr("tabindex")==="-1"&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0;this.hide();this.$element.addClass("editable-disabled");this.handleEmpty(this.isEmpty);this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(t,i){if(t&&typeof t=="object"){n.each(t,n.proxy(function(t,i){this.option(n.trim(t),i)},this));return}if(this.options[t]=i,t==="disabled")return i?this.disable():this.enable();t==="value"&&this.setValue(i);this.container&&this.container.option(t,i);this.input.option&&this.input.option(t,i)},handleEmpty:function(t){this.options.display!==!1&&(this.isEmpty=t!==undefined?t:typeof this.input.isEmpty=="function"?this.input.isEmpty(this.$element):n.trim(this.$element.html())==="",this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(t){if(!this.options.disabled){if(this.container){if(this.container.tip().is(":visible"))return}else{var i=n.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(i);this.$element.on("save.internal",n.proxy(this.save,this));this.container=this.$element.data("editableContainer")}this.container.show(t)}},hide:function(){this.container&&this.container.hide()},toggle:function(n){this.container&&this.container.tip().is(":visible")?this.hide():this.show(n)},save:function(n,t){var i,r,u;this.options.unsavedclass&&(i=!1,i=i||typeof this.options.url=="function",i=i||this.options.display===!1,i=i||t.response!==undefined,i=i||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue),i?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass));this.options.highlight&&(r=this.$element,u=r.css("background-color"),r.css("background-color",this.options.highlight),setTimeout(function(){u==="transparent"&&(u="");r.css("background-color",u);r.addClass("editable-bg-transition");setTimeout(function(){r.removeClass("editable-bg-transition")},1700)},10));this.setValue(t.newValue,!1,t.response)},validate:function(){if(typeof this.options.validate=="function")return this.options.validate.call(this,this.value)},setValue:function(t,i,r){this.value=i?this.input.str2value(t):t;this.container&&this.container.option("value",this.value);n.when(this.render(r)).then(n.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable();this.container&&this.container.destroy();this.input.destroy();this.options.toggle!=="manual"&&(this.$element.removeClass("editable-click"),this.$element.off(this.options.toggle+".editable"));this.$element.off("save.internal");this.$element.removeClass("editable editable-open editable-disabled");this.$element.removeData("editable")}};n.fn.editable=function(i){var e={},a=arguments,o="editable",f,r,h,l;switch(i){case"validate":return this.each(function(){var r=n(this),t=r.data(o),i;t&&(i=t.validate())&&(e[t.options.name]=i)}),e;case"getValue":return arguments.length===2&&arguments[1]===!0?e=this.eq(0).data(o).value:this.each(function(){var i=n(this),t=i.data(o);t&&t.value!==undefined&&t.value!==null&&(e[t.options.name]=t.input.value2submit(t.value))}),e;case"submit":var u=arguments[1]||{},s=this,c=this.editable("validate");return n.isEmptyObject(c)?(f={},s.length===1?(r=s.data("editable"),h={name:r.options.name||"",value:r.input.value2submit(r.value),pk:typeof r.options.pk=="function"?r.options.pk.call(r.options.scope):r.options.pk},typeof r.options.params=="function"?h=r.options.params.call(r.options.scope,h):(r.options.params=n.fn.editableutils.tryParseJson(r.options.params,!0),n.extend(h,r.options.params)),f={url:r.options.url,data:h,type:"POST"},u.success=u.success||r.options.success,u.error=u.error||r.options.error):(l=this.editable("getValue"),f={url:u.url,data:l,type:"POST"}),f.success=typeof u.success=="function"?function(n){u.success.call(s,n,u)}:n.noop,f.error=typeof u.error=="function"?function(){u.error.apply(s,arguments)}:n.noop,u.ajaxOptions&&n.extend(f,u.ajaxOptions),u.data&&n.extend(f.data,u.data),n.ajax(f)):typeof u.error=="function"&&u.error.call(s,c),this}return this.each(function(){var f=n(this),r=f.data(o),u=typeof i=="object"&&i;if(u&&u.selector){r=new t(this,u);return}r||f.data(o,r=new t(this,u));typeof i=="string"&&r[i].apply(r,Array.prototype.slice.call(a,1))})};n.fn.editable.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(n){"use strict";n.fn.editabletypes={};var t=function(){};t.prototype={init:function(t,i,r){this.type=t;this.options=n.extend({},r,i)},prerender:function(){this.$tpl=n(this.options.tpl);this.$input=this.$tpl;this.$clear=null;this.error=null},render:function(){},value2html:function(t,i){n(i)[this.options.escape?"text":"html"](n.trim(t))},html2value:function(t){return n("<div>").html(t).text()},value2str:function(n){return n},str2value:function(n){return n},value2submit:function(n){return n},value2input:function(n){this.$input.val(n)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(t){return n("<div>").text(t).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(n){this.options[n]!==undefined&&this.options[n]!==null&&this.$input.attr(n,this.options[n])},option:function(n,t){this.options[n]=t}};t.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0};n.extend(n.fn.editabletypes,{abstractinput:t})}(window.jQuery),function(n){"use strict";var t=function(){};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){var t=n.Deferred();this.error=null;this.onSourceReady(function(){this.renderList();t.resolve()},function(){this.error=this.options.sourceError;t.resolve()});return t.promise()},html2value:function(){return null},value2html:function(t,i,r,u){var f=n.Deferred(),e=function(){typeof r=="function"?r.call(i,t,this.sourceData,u):this.value2htmlFinal(t,i);f.resolve()};if(t===null)e.call(this);else this.onSourceReady(e,function(){f.resolve()});return f.promise()},onSourceReady:function(t,i){var u,f,r,e;if(n.isFunction(this.options.source)?(u=this.options.source.call(this.options.scope),this.sourceData=null):u=this.options.source,this.options.sourceCache&&n.isArray(this.sourceData)){t.call(this);return}try{u=n.fn.editableutils.tryParseJson(u,!1)}catch(o){i.call(this);return}if(typeof u=="string"){if(this.options.sourceCache){if(f=u,n(document).data(f)||n(document).data(f,{}),r=n(document).data(f),r.loading===!1&&r.sourceData){this.sourceData=r.sourceData;this.doPrepend();t.call(this);return}if(r.loading===!0){r.callbacks.push(n.proxy(function(){this.sourceData=r.sourceData;this.doPrepend();t.call(this)},this));r.err_callbacks.push(n.proxy(i,this));return}r.loading=!0;r.callbacks=[];r.err_callbacks=[]}e=n.extend({url:u,type:"get",cache:!1,dataType:"json",success:n.proxy(function(u){r&&(r.loading=!1);this.sourceData=this.makeArray(u);n.isArray(this.sourceData)?(r&&(r.sourceData=this.sourceData,n.each(r.callbacks,function(){this.call()})),this.doPrepend(),t.call(this)):(i.call(this),r&&n.each(r.err_callbacks,function(){this.call()}))},this),error:n.proxy(function(){i.call(this);r&&(r.loading=!1,n.each(r.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);n.ajax(e)}else this.sourceData=this.makeArray(u),n.isArray(this.sourceData)?(this.doPrepend(),t.call(this)):i.call(this)},doPrepend:function(){this.options.prepend!==null&&this.options.prepend!==undefined&&(n.isArray(this.prependData)||(n.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=n.fn.editableutils.tryParseJson(this.options.prepend,!0),typeof this.options.prepend=="string"&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),n.isArray(this.prependData)&&n.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(){},makeArray:function(t){var u,e,r=[],i,o,f;if(!t||typeof t=="string")return null;if(n.isArray(t))for(o=function(n,t){return e={value:n,text:t},u++>=2?!1:void 0},f=0;f<t.length;f++)i=t[f],typeof i=="object"?(u=0,n.each(i,o),u===1?r.push(e):u>1&&(i.children&&(i.children=this.makeArray(i.children)),r.push(i))):r.push({value:i,text:i});else n.each(t,function(n,t){r.push({value:n,text:t})});return r},option:function(n,t){this.options[n]=t;n==="source"&&(this.sourceData=null);n==="prepend"&&(this.prependData=null)}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null});n.fn.editabletypes.list=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("text",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.renderClear();this.setClass();this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),n.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=n('<span class="editable-clear-x"><\/span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(n.proxy(function(t){if(!~n.inArray(t.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var i=this;this.t=setTimeout(function(){i.toggleClear(t)},100)}},this)).parent().css("position","relative"),this.$clear.click(n.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(){if(this.$clear){var n=this.$input.val().length,t=this.$clear.is(":visible");n&&!t&&this.$clear.show();!n&&t&&this.$clear.hide()}},clear:function(){this.$clear.hide();this.$input.val("").focus()}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0});n.fn.editabletypes.text=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("textarea",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.setClass();this.setAttr("placeholder");this.setAttr("rows");this.$input.keydown(function(t){t.ctrlKey&&t.which===13&&n(this).closest("form").submit()})},activate:function(){n.fn.editabletypes.text.prototype.activate.call(this)}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea><\/textarea>",inputclass:"input-large",placeholder:null,rows:7});n.fn.editabletypes.textarea=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("select",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.list);n.extend(t.prototype,{renderList:function(){this.$input.empty();var t=function(i,r){var f,u;if(n.isArray(r))for(u=0;u<r.length;u++)f={},r[u].children?(f.label=r[u].text,i.append(t(n("<optgroup>",f),r[u].children))):(f.value=r[u].value,r[u].disabled&&(f.disabled=!0),i.append(n("<option>",f).text(r[u].text)));return i};t(this.$input,this.sourceData);this.setClass();this.$input.on("keydown.editable",function(t){t.which===13&&n(this).closest("form").submit()})},value2htmlFinal:function(t,i){var r="",u=n.fn.editableutils.itemsByValue(t,this.sourceData);u.length&&(r=u[0].text);n.fn.editabletypes.abstractinput.prototype.value2html.call(this,r,i)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.list.defaults,{tpl:"<select><\/select>"});n.fn.editabletypes.select=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("checklist",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.list);n.extend(t.prototype,{renderList:function(){var i,t;if(this.$tpl.empty(),n.isArray(this.sourceData)){for(t=0;t<this.sourceData.length;t++)i=n("<label>").append(n("<input>",{type:"checkbox",value:this.sourceData[t].value})).append(n("<span>").text(" "+this.sourceData[t].text)),n("<div>").append(i).appendTo(this.$tpl);this.$input=this.$tpl.find('input[type="checkbox"]');this.setClass()}},value2str:function(t){return n.isArray(t)?t.sort().join(n.trim(this.options.separator)):""},str2value:function(t){var r,i=null;return typeof t=="string"&&t.length?(r=new RegExp("\\s*"+n.trim(this.options.separator)+"\\s*"),i=t.split(r)):i=n.isArray(t)?t:[t],i},value2input:function(t){this.$input.prop("checked",!1);n.isArray(t)&&t.length&&this.$input.each(function(i,r){var u=n(r);n.each(t,function(n,t){u.val()==t&&u.prop("checked",!0)})})},input2value:function(){var t=[];return this.$input.filter(":checked").each(function(i,r){t.push(n(r).val())}),t},value2htmlFinal:function(t,i){var r=[],u=n.fn.editableutils.itemsByValue(t,this.sourceData),f=this.options.escape;u.length?(n.each(u,function(t,i){var u=f?n.fn.editableutils.escape(i.text):i.text;r.push(u)}),n(i).html(r.join("<br>"))):n(i).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"><\/div>',inputclass:null,separator:","});n.fn.editabletypes.checklist=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("password",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.text);n.extend(t.prototype,{value2html:function(t,i){t?n(i).text("[hidden]"):n(i).empty()},html2value:function(){return null}});t.defaults=n.extend({},n.fn.editabletypes.text.defaults,{tpl:'<input type="password">'});n.fn.editabletypes.password=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("email",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.text);t.defaults=n.extend({},n.fn.editabletypes.text.defaults,{tpl:'<input type="email">'});n.fn.editabletypes.email=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("url",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.text);t.defaults=n.extend({},n.fn.editabletypes.text.defaults,{tpl:'<input type="url">'});n.fn.editabletypes.url=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("tel",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.text);t.defaults=n.extend({},n.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'});n.fn.editabletypes.tel=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("number",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.text);n.extend(t.prototype,{render:function(){t.superclass.render.call(this);this.setAttr("min");this.setAttr("max");this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}});t.defaults=n.extend({},n.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null});n.fn.editabletypes.number=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("range",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.number);n.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input");this.setClass();this.setAttr("min");this.setAttr("max");this.setAttr("step");this.$input.on("input",function(){n(this).siblings("output").text(n(this).val())})},activate:function(){this.$input.focus()}});t.defaults=n.extend({},n.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"><\/output>',inputclass:"input-medium"});n.fn.editabletypes.range=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("time",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.setClass()}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'});n.fn.editabletypes.time=t}(window.jQuery),function(n){"use strict";var t=function(i){var r,u;this.init("select2",i,t.defaults);i.select2=i.select2||{};this.sourceData=null;i.placeholder&&(i.select2.placeholder=i.placeholder);!i.select2.tags&&i.source&&(r=i.source,n.isFunction(i.source)&&(r=i.source.call(i.scope)),typeof r=="string"?(i.select2.ajax=i.select2.ajax||{},i.select2.ajax.data||(i.select2.ajax.data=function(n){return{query:n}}),i.select2.ajax.results||(i.select2.ajax.results=function(n){return{results:n}}),i.select2.ajax.url=r):(this.sourceData=this.convertSource(r),i.select2.data=this.sourceData));this.options.select2=n.extend({},t.defaults.select2,i.select2);this.isMultiple=this.options.select2.tags||this.options.select2.multiple;this.isRemote="ajax"in this.options.select2;this.idFunc=this.options.select2.id;typeof this.idFunc!="function"&&(u=this.idFunc||"id",this.idFunc=function(n){return n[u]});this.formatSelection=this.options.select2.formatSelection;typeof this.formatSelection!="function"&&(this.formatSelection=function(n){return n.text})};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){if(this.setClass(),this.isRemote)this.$input.on("select2-loaded",n.proxy(function(n){this.sourceData=n.items.results},this));if(this.isMultiple)this.$input.on("change",function(){n(this).closest("form").parent().triggerHandler("resize")})},value2html:function(i,r){var u="",f,e=this;this.options.select2.tags?f=i:this.sourceData&&(f=n.fn.editableutils.itemsByValue(i,this.sourceData,this.idFunc));n.isArray(f)?(u=[],n.each(f,function(n,t){u.push(t&&typeof t=="object"?e.formatSelection(t):t)})):f&&(u=e.formatSelection(f));u=n.isArray(u)?u.join(this.options.viewseparator):u;t.superclass.value2html.call(this,u,r)},html2value:function(n){return this.options.select2.tags?this.str2value(n,this.options.viewseparator):null},value2input:function(t){var r,u,i,f;n.isArray(t)&&(t=t.join(this.getSeparator()));this.$input.data("select2")?this.$input.val(t).trigger("change",!0):(this.$input.val(t),this.$input.select2(this.options.select2));!this.isRemote||this.isMultiple||this.options.select2.initSelection||(r=this.options.select2.id,u=this.options.select2.formatSelection,r||u||(i=n(this.options.scope),i.data("editable").isEmpty||(f={id:t,text:i.text()},this.$input.select2("data",f))))},input2value:function(){return this.$input.select2("val")},str2value:function(t,i){if(typeof t!="string"||!this.isMultiple)return t;i=i||this.getSeparator();var u,r,f;if(t===null||t.length<1)return null;for(u=t.split(i),r=0,f=u.length;r<f;r=r+1)u[r]=n.trim(u[r]);return u},autosubmit:function(){this.$input.on("change",function(t,i){i||n(this).closest("form").submit()})},getSeparator:function(){return this.options.select2.separator||n.fn.select2.defaults.separator},convertSource:function(t){if(n.isArray(t)&&t.length&&t[0].value!==undefined)for(var i=0;i<t.length;i++)t[i].value!==undefined&&(t[i].id=t[i].value,delete t[i].value);return t},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "});n.fn.editabletypes.select2=t}(window.jQuery),function(n){var t=function(t,i){if(this.$element=n(t),!this.$element.is("input")){n.error("Combodate should be applied to INPUT element");return}this.options=n.extend({},n.fn.combodate.defaults,i,this.$element.data());this.init()};t.prototype={constructor:t,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]};this.$widget=n('<span class="combodate"><\/span>').html(this.getTemplate());this.initCombos();this.$widget.on("change","select",n.proxy(function(t){this.$element.val(this.getValue()).change();this.options.smartDays&&(n(t.target).is(".month")||n(t.target).is(".year"))&&this.fillCombo("day")},this));this.$widget.find("select").css("width","auto");this.$element.hide().after(this.$widget);this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var t=this.options.template;return n.each(this.map,function(n,i){i=i[0];var r=new RegExp(i+"+"),u=i.length>1?i.substring(1,2):i;t=t.replace(r,"{"+u+"}")}),t=t.replace(/ /g,"&nbsp;"),n.each(this.map,function(n,i){i=i[0];var r=i.length>1?i.substring(1,2):i;t=t.replace("{"+r+"}",'<select class="'+n+'"><\/select>')}),t},initCombos:function(){var n,t;for(n in this.map)t=this.$widget.find("."+n),this["$"+n]=t.length?t:null,this.fillCombo(n)},fillCombo:function(n){var t=this["$"+n],i;if(t){var u="fill"+n.charAt(0).toUpperCase()+n.slice(1),r=this[u](),f=t.val();for(t.empty(),i=0;i<r.length;i++)t.append('<option value="'+r[i][0]+'">'+r[i][1]+"<\/option>");t.val(f)}},fillCommon:function(n){var r=[],t,i;return this.options.firstItem==="name"?(t=moment.relativeTime||moment.langData()._relativeTime,i=typeof t[n]=="function"?t[n](1,!0,n,!1):t[n],i=i.split(" ").reverse()[0],r.push(["",i])):this.options.firstItem==="empty"&&r.push(["",""]),r},fillDay:function(){var r=this.fillCommon("d"),u,n,e=this.options.template.indexOf("DD")!==-1,f=31,t,i;for(this.options.smartDays&&this.$month&&this.$year&&(t=parseInt(this.$month.val(),10),i=parseInt(this.$year.val(),10),isNaN(t)||isNaN(i)||(f=moment([i,t]).daysInMonth())),n=1;n<=f;n++)u=e?this.leadZero(n):n,r.push([n,u]);return r},fillMonth:function(){for(var t=this.fillCommon("M"),i,r=this.options.template.indexOf("MMMM")!==-1,u=this.options.template.indexOf("MMM")!==-1,f=this.options.template.indexOf("MM")!==-1,n=0;n<=11;n++)i=r?moment().date(1).month(n).format("MMMM"):u?moment().date(1).month(n).format("MMM"):f?this.leadZero(n+1):n+1,t.push([n,i]);return t},fillYear:function(){for(var t=[],i,r=this.options.template.indexOf("YYYY")!==-1,n=this.options.maxYear;n>=this.options.minYear;n--)i=r?n:(n+"").substring(2),t[this.options.yearDescending?"push":"unshift"]([n,i]);return this.fillCommon("y").concat(t)},fillHour:function(){for(var t=this.fillCommon("h"),i,r=this.options.template.indexOf("h")!==-1,o=this.options.template.indexOf("H")!==-1,u=this.options.template.toLowerCase().indexOf("hh")!==-1,f=r?1:0,e=r?12:23,n=f;n<=e;n++)i=u?this.leadZero(n):n,t.push([n,i]);return t},fillMinute:function(){for(var t=this.fillCommon("m"),i,r=this.options.template.indexOf("mm")!==-1,n=0;n<=59;n+=this.options.minuteStep)i=r?this.leadZero(n):n,t.push([n,i]);return t},fillSecond:function(){for(var t=this.fillCommon("s"),i,r=this.options.template.indexOf("ss")!==-1,n=0;n<=59;n+=this.options.secondStep)i=r?this.leadZero(n):n,t.push([n,i]);return t},fillAmpm:function(){var n=this.options.template.indexOf("a")!==-1,t=this.options.template.indexOf("A")!==-1;return[["am",n?"am":"AM"],["pm",n?"pm":"PM"]]},getValue:function(t){var r,i={},u=this,f=!1;return(n.each(this.map,function(n){if(n!=="ampm"){var t=n==="day"?1:0;return i[n]=u["$"+n]?parseInt(u["$"+n].val(),10):t,isNaN(i[n])?(f=!0,!1):void 0}}),f)?"":(this.$ampm&&(i.hour=i.hour===12?this.$ampm.val()==="am"?0:12:this.$ampm.val()==="am"?i.hour:i.hour+12),r=moment([i.year,i.month,i.day,i.hour,i.minute,i.second]),this.highlight(r),t=t===undefined?this.options.format:t,t===null?r.isValid()?r:null:r.isValid()?r.format(t):"")},setValue:function(t){function f(t,i){var r={};return t.children("option").each(function(t,u){var f=n(u).attr("value"),e;f!==""&&(e=Math.abs(f-i),(typeof r.distance=="undefined"||e<r.distance)&&(r={value:f,distance:e}))}),r.value}if(t){var u=typeof t=="string"?moment(t,this.options.format):moment(t),r=this,i={};u.isValid()&&(n.each(this.map,function(n,t){n!=="ampm"&&(i[n]=u[t[1]]())}),this.$ampm&&(i.hour>=12?(i.ampm="pm",i.hour>12&&(i.hour-=12)):(i.ampm="am",i.hour===0&&(i.hour=12))),n.each(i,function(n,t){r["$"+n]&&(n==="minute"&&r.options.minuteStep>1&&r.options.roundTime&&(t=f(r["$"+n],t)),n==="second"&&r.options.secondStep>1&&r.options.roundTime&&(t=f(r["$"+n],t)),r["$"+n].val(t))}),this.options.smartDays&&this.fillCombo("day"),this.$element.val(u.format(this.options.format)).change())}},highlight:function(n){n.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(n){return n<=9?"0"+n:n},destroy:function(){this.$widget.remove();this.$element.removeData("combodate").show()}};n.fn.combodate=function(i){var r,u=Array.apply(null,arguments);return(u.shift(),i==="getValue"&&this.length&&(r=this.eq(0).data("combodate")))?r.getValue.apply(r,u):this.each(function(){var f=n(this),r=f.data("combodate"),e=typeof i=="object"&&i;r||f.data("combodate",r=new t(this,e));typeof i=="string"&&typeof r[i]=="function"&&r[i].apply(r,u)})};n.fn.combodate.defaults={format:"YYYY-MM-DD HH:mm",template:"YYYY-MM-DD   H : mm",value:null,minYear:1970,maxYear:2030,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0,smartDays:!1}}(window.jQuery),function(n){"use strict";var t=function(i){this.init("combodate",i,t.defaults);this.options.viewformat||(this.options.viewformat=this.options.format);i.combodate=n.fn.editableutils.tryParseJson(i.combodate,!0);this.options.combodate=n.extend({},t.defaults.combodate,i.combodate,{format:this.options.format,template:this.options.template})};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.$input.combodate(this.options.combodate);n.fn.editableform.engine==="bs3"&&this.$input.siblings().find("select").addClass("form-control");this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(n,i){var r=n?n.format(this.options.viewformat):"";t.superclass.value2html.call(this,r,i)},html2value:function(n){return n?moment(n,this.options.viewformat):null},value2str:function(n){return n?n.format(this.options.format):""},str2value:function(n){return n?moment(n,this.options.format):null},value2submit:function(n){return this.value2str(n)},value2input:function(n){this.$input.combodate("setValue",n)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null});n.fn.editabletypes.combodate=t}(window.jQuery),function(n){"use strict";var t=n.fn.editableform.Constructor.prototype.initInput;n.extend(n.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=n(n.fn.editableform.template);this.$form.find(".control-group").addClass("form-group");this.$form.find(".editable-error-block").addClass("help-block")},initInput:function(){var e,u,i;t.apply(this);var f=this.input.options.inputclass===null||this.input.options.inputclass===!1,r="input-sm",o="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");for(~n.inArray(this.input.type,o)&&(this.input.$input.addClass("form-control"),f&&(this.input.options.inputclass=r,this.input.$input.addClass(r))),e=this.$form.find(".editable-buttons"),u=f?[r]:this.input.options.inputclass.split(" "),i=0;i<u.length;i++)u[i].toLowerCase()==="input-lg"&&e.find("button").removeClass("btn-sm").addClass("btn-lg")}});n.fn.editableform.buttons='<button type="submit" class="btn btn-primary btn-sm editable-submit"><i class="glyphicon glyphicon-ok"><\/i><\/button><button type="button" class="btn btn-default btn-sm editable-cancel"><i class="glyphicon glyphicon-remove"><\/i><\/button>';n.fn.editableform.errorGroupClass="has-error";n.fn.editableform.errorBlockClass=null;n.fn.editableform.engine="bs3"}(window.jQuery),function(n){"use strict";n.extend(n.fn.editableContainer.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:n.fn.popover.Constructor.DEFAULTS,initContainer:function(){n.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template});var t;this.$element.data("template")&&(t=this.$element.data("template"),this.$element.removeData("template"));this.call(this.containerOptions);t&&this.$element.data("template",t)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(n,t){this.container().options[n]=t},setPosition:function(){(function(){var i=this.tip(),n=typeof this.options.placement=="function"?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,o=e.test(n),h;o&&(n=n.replace(e,"")||"top");var t=this.getPosition(),r=i[0].offsetWidth,u=i[0].offsetHeight;if(o){var f=this.$element.parent(),c=n,s=document.documentElement.scrollTop||document.body.scrollTop,l=this.options.container=="body"?window.innerWidth:f.outerWidth(),a=this.options.container=="body"?window.innerHeight:f.outerHeight(),v=this.options.container=="body"?0:f.offset().left;n=n=="bottom"&&t.top+t.height+u-s>a?"top":n=="top"&&t.top-s-u<0?"bottom":n=="right"&&t.right+r>l?"left":n=="left"&&t.left-r<v?"right":n;i.removeClass(c).addClass(n)}h=this.getCalculatedOffset(n,t,r,u);this.applyPlacement(h,n)}).call(this.container())}})}(window.jQuery),function(n){"use strict";var t=function(n){this.init("datetime",n,t.defaults);this.initPicker(n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{initPicker:function(t,i){this.options.viewformat||(this.options.viewformat=this.options.format);t.datetimepicker=n.fn.editableutils.tryParseJson(t.datetimepicker,!0);this.options.datetimepicker=n.extend({},i.datetimepicker,t.datetimepicker,{format:this.options.viewformat});this.options.datetimepicker.language=this.options.datetimepicker.language||"en";this.dpg=n.fn.datetimepicker.DPGlobal;this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType);this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker);this.$input.on("changeMode",function(){var t=n(this).closest("form").parent();setTimeout(function(){t.triggerHandler("resize")},0)});this.options.clear&&(this.$clear=n('<a href="#"><\/a>').html(this.options.clear).click(n.proxy(function(n){n.preventDefault();n.stopPropagation();this.clear()},this)),this.$tpl.parent().append(n('<div class="editable-clear">').append(this.$clear)))},value2html:function(n,i){var r=n?this.dpg.formatDate(this.toUTC(n),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";if(i)t.superclass.value2html.call(this,r,i);else return r},html2value:function(n){var t=this.parseDate(n,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(n){return n?this.dpg.formatDate(this.toUTC(n),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(n){var t=this.parseDate(n,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(n){return this.value2str(n)},value2input:function(n){n&&this.$input.data("datetimepicker").setDate(n)},input2value:function(){var n=this.$input.data("datetimepicker");return n.date?n.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null;this.$input.find(".active").removeClass("active");this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(){var t=n(this).closest("form");setTimeout(function(){t.submit()},200)})},toUTC:function(n){return n?new Date(n.valueOf()-n.getTimezoneOffset()*6e4):n},fromUTC:function(n){return n?new Date(n.valueOf()+n.getTimezoneOffset()*6e4):n},parseDate:function(n,t){var i=null,r;return n&&(i=this.dpg.parseDate(n,t,this.options.datetimepicker.language,this.options.formatType),typeof n=="string"&&(r=this.dpg.formatDate(i,t,this.options.datetimepicker.language,this.options.formatType),n!==r&&(i=null))),i}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"><\/div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"});n.fn.editabletypes.datetime=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("datetimefield",n,t.defaults);this.initPicker(n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.datetime);n.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input");this.setClass();this.setAttr("placeholder");this.$tpl.datetimepicker(this.options.datetimepicker);this.$input.off("focus keydown");this.$input.keyup(n.proxy(function(){this.$tpl.removeData("date");this.$tpl.datetimepicker("update")},this))},value2input:function(n){this.$input.val(this.value2html(n));this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){n.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}});t.defaults=n.extend({},n.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-group date"><input type="text"/><span class="input-group-addon"><i class="fa fa-th"><\/i><\/span><\/div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}});n.fn.editabletypes.datetimefield=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("image",n,t.defaults);"on_error"in n.image&&(this.on_error=n.image.on_error,delete n.image.on_error);"on_success"in n.image&&(this.on_success=n.image.on_success,delete n.image.on_success);"max_size"in n.image&&(this.max_size=n.image.max_size,delete n.image.max_size);this.initImage(n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{initImage:function(t,i){this.options.image=n.extend({},i.image,t.image);this.name=this.options.image.name||"editable-image-input"},render:function(){var n=this;this.$input=this.$tpl.find("input[type=hidden]:eq(0)");this.$file=this.$tpl.find("input[type=file]:eq(0)");this.$file.attr({name:this.name});this.$input.attr({name:this.name+"-hidden"});this.options.image.allowExt=this.options.image.allowExt||["jpg","jpeg","png","gif"];this.options.image.allowMime=this.options.image.allowMime||["image/jpg","image/jpeg","image/png","image/gif"];this.options.image.maxSize=n.max_size||this.options.image.maxSize||!1;this.options.image.before_remove=this.options.image.before_remove||function(){return n.$input.val(null),!0};this.$file.ace_file_input(this.options.image).on("change",function(){var t=n.$file.val()||n.$file.data("ace_input_files")?Math.random()+""+(new Date).getTime():null;n.$input.val(t)}).closest(".ace-file-input").css({width:"150px"}).closest(".editable-input").addClass("editable-image");this.$file.off("file.error.ace").on("file.error.ace",function(t,i){if(n.on_error)if(i.error_count.ext>0||i.error_count.mime>0)n.on_error(1);else if(i.error_count.size>0)n.on_error(2)})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<span><input type="hidden" /><\/span><span><input type="file" /><\/span>',inputclass:"",image:{style:"well",btn_choose:"Change Image",btn_change:null,no_icon:"fa fa-picture-o",thumbnail:"large"}});n.fn.editabletypes.image=t}(window.jQuery),function(n){"use strict";var t=function(i){this.init("wysiwyg",i,t.defaults);this.options.wysiwyg=n.extend({},t.defaults.wysiwyg,i.wysiwyg)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.$editor=this.$input.nextAll(".wysiwyg-editor:eq(0)");this.$tpl.parent().find(".wysiwyg-editor").show().ace_wysiwyg({toolbar:["bold","italic","strikethrough","underline",null,"foreColor",null,"insertImage"]}).prev().addClass("wysiwyg-style2").closest(".editable-input").addClass("editable-wysiwyg").closest(".editable-container").css({display:"block"});this.options.wysiwyg&&this.options.wysiwyg.css&&this.$tpl.closest(".editable-wysiwyg").css(this.options.wysiwyg.css)},value2html:function(t,i){return n(i).html(t),!1},html2value:function(n){return n},value2input:function(n){this.$editor.html(n)},input2value:function(){return this.$editor.html()},activate:function(){}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden" /><div class="wysiwyg-editor"><\/div>',inputclass:"editable-wysiwyg",wysiwyg:{}});n.fn.editabletypes.wysiwyg=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("spinner",n,t.defaults);this.initSpinner(n,t.defaults);this.nativeUI=!1;try{var i=document.createElement("INPUT");i.type="number";this.nativeUI=i.type==="number"&&this.options.spinner.nativeUI===!0}catch(r){}};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{initSpinner:function(t,i){this.options.spinner=n.extend({},i.spinner,t.spinner)},render:function(){},activate:function(){var r,t,i;if(this.$input.is(":visible"))if(this.$input.focus(),n.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.nativeUI)for(this.$input.get(0).type="number",t=["min","max","step"],i=0;i<t.length;i++)t[i]in this.options.spinner&&this.$input.attr(t[i],this.options.spinner[t[i]]);else r=parseInt(this.$input.val()),t=n.extend({value:r},this.options.spinner),this.$input.TouchSpin(t)},autosubmit:function(){this.$input.keydown(function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text" />',inputclass:"",spinner:{min:0,max:1e9,step:1,decimals:0,boostat:5,maxboostedstep:10}});n.fn.editabletypes.spinner=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("slider",n,t.defaults);this.initSlider(n,t.defaults);this.nativeUI=!1;try{var i=document.createElement("INPUT");i.type="range";this.nativeUI=i.type==="range"&&this.options.slider.nativeUI===!0}catch(r){}};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{initSlider:function(t,i){this.options.slider=n.extend({},i.slider,t.slider)},render:function(){},activate:function(){var t,i,r;if(this.$input.is(":visible"))if(this.$input.focus(),n.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.nativeUI){for(this.$input.get(0).type="range",t=["min","max","step"],i=0;i<t.length;i++)t[i]in this.options.slider&&(this.$input[0][t[i]]=this.options.slider[t[i]]);r=this.options.slider.width||200;this.$input.parent().addClass("editable-slider").css("width",r+"px")}else{var u=this,f=parseInt(this.$input.val()),r=this.options.slider.width||200,t=n.extend(this.options.slider,{value:f,slide:function(t,i){var r=parseInt(i.value);u.$input.val(r);i.handle.firstChild==null&&n(i.handle).prepend("<div class='tooltip top in' style='display:none; top:-38px; left:-5px;'><div class='tooltip-arrow'><\/div><div class='tooltip-inner'><\/div><\/div>");n(i.handle.firstChild).show().children().eq(1).text(r)}});this.$input.parent().addClass("editable-slider").css("width",r+"px").slider(t)}},value2html:function(){},autosubmit:function(){this.$input.keydown(function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text" /><span class="inline ui-slider-green"><span class="slider-display"><\/span><\/span>',inputclass:"",slider:{min:1,max:100,step:1,range:"min"}});n.fn.editabletypes.slider=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("adate",n,t.defaults);this.initDate(n,t.defaults);this.nativeUI=!1;try{var i=document.createElement("INPUT");i.type="date";this.nativeUI=i.type==="date"&&this.options.date.nativeUI===!0}catch(r){}};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{initDate:function(t,i){this.options.date=n.extend({},i.date,t.date)},render:function(){this.$input=this.$tpl.find("input.date")},activate:function(){var t,n;if(this.$input.is(":visible")&&this.$input.focus(),this.nativeUI)this.$input.get(0).type="date";else if(t=this.$input,this.$input.datepicker(this.options.date),n=t.data("datepicker"),n)t.on("click",function(){n.show()}).siblings(".input-group-addon").on("click",function(){n.show()})},autosubmit:function(){this.$input.keydown(function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="input-group input-group-compact"><input type="text" class="input-medium date" /><span class="input-group-addon"><i class="fa fa-calendar"><\/i><\/span><\/div>',date:{weekStart:0,startView:0,minViewMode:0}});n.fn.editabletypes.adate=t}(window.jQuery),function(n){"use strict";var t=function(n){this.init("address",n,t.defaults)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input")},value2html:function(t,i){if(!t){n(i).empty();return}var r=n("<div>").text(t.city).html()+", "+n("<div>").text(t.street).html()+" st., bld. "+n("<div>").text(t.building).html();n(i).html(r)},html2value:function(){return null},value2str:function(n){var t="",i;if(n)for(i in n)t=t+i+":"+n[i]+";";return t},str2value:function(n){return n},value2input:function(n){n&&(this.$input.filter('[name="city"]').val(n.city),this.$input.filter('[name="street"]').val(n.street),this.$input.filter('[name="building"]').val(n.building))},input2value:function(){return{city:this.$input.filter('[name="city"]').val(),street:this.$input.filter('[name="street"]').val(),building:this.$input.filter('[name="building"]').val()}},activate:function(){this.$input.filter('[name="city"]').focus()},autosubmit:function(){this.$input.keydown(function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-address"><label><span>City: <\/span><input type="text" name="city" class="input-small"><\/label><\/div><div class="editable-address"><label><span>Street: <\/span><input type="text" name="street" class="input-small"><\/label><\/div><div class="editable-address"><label><span>Building: <\/span><input type="text" name="building" class="input-mini"><\/label><\/div>',inputclass:""});n.fn.editabletypes.address=t}(window.jQuery),function(n){"use strict";var t=function(i){this.init("reference",i,t.defaults);i.reference=i.reference||{};this.options.title=i.title||"";this.options.reference=n.extend({},t.defaults.reference,i.reference)};n.fn.editableutils.inherit(t,n.fn.editabletypes.abstractinput);n.extend(t.prototype,{render:function(){this.setClass();this.$input=this.$tpl.find("input");n.widget("ui.dialog",n.extend({},n.ui.dialog.prototype,{_title:function(n){var t=this.options.title||"&nbsp;";"title_html"in this.options&&this.options.title_html==!0?n.html(t):n.text(t)}}));this.$input.next().on(ace.click_event,n.proxy(function(){var t=this.options.reference.tablename,i=this.options.reference.colname,f=this.options.reference.reftype,s=this.options.reference.multi,h=this.options.reference.refid,e=this.options.reference.component,o=this.$input,u=n("#x-editable-dialogreference-"+t+i),r,c;u.length==0&&(r='<div id="x-editable-dialogreference-'+t+i+'" class="hide">',r+='   <div class="row">  <div id="refContent-'+t+i+'" class="col-lg-12">',r+="   <\/div><\/div>",r+="<\/div>",this.$input.after(n(r)),u=n("#x-editable-dialogreference-"+t+i));c=u.removeClass("hide").dialog({modal:!0,height:"auto",width:600,maxHeight:n(window).innerHeight()-100,minHeight:300,title:"<div class='widget-header widget-header-small'><h4 class='smaller'><i class='ace-icon fa fa-search'><\/i> "+this.options.title+"<\/h4><\/div>",title_html:!0,open:function(){n("#refContent-"+t+i).html("<h3 class=' smaller lighter grey'><i class='ace-icon fa fa-spinner fa-spin orange bigger-125'><\/i>正在加载，请稍后...<\/h3>");var r=basePath+"/Component/"+f+"/"+h;e!=""&&(r=basePath+"/Component/"+f+"/?fid="+e,r=s==!0?r+"&multi=1":r+"&multi=0");n("#refContent-"+t+i).load(r)},buttons:[{text:"确认","class":"btn btn-primary btn-xs",click:function(){var i=GetRefResult("frm-"+t);if(i)o.val(i.name),o.data("code",i.code);else{bootbox.alert("请选择一条数据！");return}n(this).dialog("close")}},{text:"取消","class":"btn btn-xs",click:function(){n(this).dialog("close")}}]})},this))},value2html:function(t,i){if(!t){n(i).empty();return}var r=n("<div>").text(t.name).html();n(i).html(r)},html2value:function(){return null},value2str:function(n){var t="";return n&&(t=t+n.name+":"+n.code+";"),t},str2value:function(n){return n},value2input:function(n){n&&(this.$input.val(n.name),this.$input.data("code",n.code))},input2value:function(){return{code:this.$input.data("code"),name:this.$input.val()}},activate:function(){this.$input.focus()},autosubmit:function(){this.$input.keydown(function(t){t.which===13&&n(this).closest("form").submit()})}});t.defaults=n.extend({},n.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="input-group"><input class="form-control" type="text" /><span class="input-group-addon"><i class="ace-icon fa fa-search"><\/i><\/span><\/div>',reference:{tablename:"",colname:"",multi:!1,reftype:"",refid:0,component:""},inputclass:"",title:""});n.fn.editabletypes.reference=t}(window.jQuery);extendToolBar=function(n,t,i,r,u){jQuery("#"+n).jqGrid("navButtonAdd","#"+t,{caption:i,title:i,position:"first",buttonicon:r,onClickButton:function(){u()}})};var loadFormMessageBox=function(n,t,i,r,u,f,e,o){function h(){var n=$.randomUrl(basePath+"/Component/Dataform/"+u+"?tn="+r+"&qrycols="+f);$.get(n,function(n){s.find(".bootbox-body").html(n);$.isFunction(e)&&e()})}var s=bootbox.dialog({title:'<i class="ace-icon '+i+'"><\/i> '+n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',size:"large",footer:!1,buttons:{success:{label:MultiLangHelper.getResName("global_oper_save","保存"),className:"btn-primary",callback:function(){var i="frm-"+r,n=Persistence(i,"");if(n===!1)return!1;if(n.success===!0)$.isFunction(o)&&o(),$("#"+t).length&&$("#"+t).length>0&&$("#"+t).jqGrid("setGridParam",{}).trigger("reloadGrid");else return!1}},SaveAndAdd:{label:"保存并新增",className:"btn-primary",callback:function(){var i="frm-"+r,n=Persistence(i,"");return n===!1?!1:n.success===!0?($.isFunction(o)&&o(),$("#"+t).length&&$("#"+t).length>0&&$("#"+t).jqGrid("setGridParam",{}).trigger("reloadGrid"),h(),!1):!1}}}});s.init(function(){h()})},viewFormMessageBox=function(n,t){var i=bootbox.dialog({title:"查看",message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',size:"large",footer:!1});i.init(function(){i.find(".bootbox-body").load(basePath+"/Component/DataFormView/"+n,{tn:t})})},deleteGridRow=function(n,t,i,r,u){var c=$("#"+n).jqGrid("getGridParam","multiselect"),f,o,e,s,h;if(c)if(f=$("#"+n).jqGrid("getGridParam","selarrrow"),f.length===0)f=null;else{for(o=[],e=0;e<f.length;e++)s=$("#"+n).jqGrid("getRowData",f[e]),o.push(s.Fid);f=o.join(",")}else f=jQuery("#"+n).jqGrid("getGridParam","selrow"),h=$("#"+n).jqGrid("getRowData",f),f=h.Fid;f?bootbox.confirm("确定要删除选中的吗?",function(e){e&&$.post(basePath+"/Api/Core/Persistence/",{oper:"del",Table_Name:t,formtoken:r,logicdelete:i,Fid:f},function(t){t.success&&($.isFunction(u)&&u(),$("#"+n).length&&$("#"+n).length>0&&$("#"+n).jqGrid("setGridParam",{}).trigger("reloadGrid"));t.msg&&bootbox.alert(t.msg)})}):bootbox.alert("请选择一条数据")},openRefrenceWindow=function(n,t,i,r,u){var f=bootbox.dialog({title:n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{success:{label:MultiLangHelper.getResName("global_oper_enter","确定"),className:"btn-primary",callback:function(){var n=GetRefResult();if(n)r&&r(n.code,n.name);else{$.msg("请选择一条数据！");return}}},danger:{label:"清空!",className:"btn-sm btn-danger",callback:function(){u&&u()}},cancel:{label:MultiLangHelper.getResName("global_oper_cancel","取消"),className:"btn-default"}}});f.on("shown.bs.modal",function(){i.indexOf("GridReference")>-1&&$(window).triggerHandler("resize.jqGrid")});f.init(function(){var n=basePath+"/Component/"+i+"/"+t;$.get(n,function(n){f.find(".bootbox-body").html(n)})})},loadBatchUpdateMessageBox=function(n,t,i,r){var o=getSelectedRows(t),u,e,f;if(o!==null){u=$("#modal-wizard-"+t);u.length===0&&(e=['<div id="modal-wizard-'+t+'" class="modal">','    <div class="modal-dialog">','        <div class="modal-content">','            <div id="modal-wizard-container">','                <div class="modal-header">','                    <ul class="steps">','                        <li data-step="1" class="active">','                            <span class="step">1<\/span>','                            <span class="title">选择编辑属性<\/span>',"                        <\/li>",'                        <li data-step="2">','                            <span class="step">2<\/span>','                            <span class="title">设置属性值<\/span>',"                        <\/li>                       ","                    <\/ul>","                <\/div>",'                <div class="modal-body step-content">','                    <div class="step-pane active" data-step="1">','                        <div class="center">',"                        <\/div>","                    <\/div>",'                    <div class="step-pane" data-step="2">','                        <div class="center">',"                        <\/div>","                    <\/div>                   ","                <\/div>","            <\/div>",'            <div class="modal-footer wizard-actions">','                <button class="btn btn-sm btn-prev">','                    <i class="ace-icon fa fa-arrow-left"><\/i>',"                   上一步","                <\/button>",'                <button class="btn btn-success btn-sm btn-next" data-last="完成">',"                   下一步",'                    <i class="ace-icon fa fa-arrow-right icon-on-right"><\/i>',"                <\/button>",'                <button class="btn btn-danger btn-sm pull-left btnCancel">','                    <i class="ace-icon fa fa-times"><\/i>',"                    取消","                <\/button>","            <\/div>","        <\/div>","    <\/div>","<\/div>"].join(""),$("body").append($(e)),u=$(e));u.find(".modal-footer .btnCancel").on(ace.click_event,function(){u.modal("hide");u.remove()});f=$("<select multiple='multiple' size='10' id='dualfieldlistbox_"+r+"' name='dualfieldlistbox_"+r+"'><\/select>");u.find("#modal-wizard-container").ace_wizard().on("actionclicked.fu.wizard",function(n,t){var i,e;if(t.step===1){if(i=f.val(),i===null){$.msg("请选择要批量更新的属性！");n.preventDefault();return}u.find(".step-content [data-step=2]").html('<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>');e=$.randomUrl(basePath+"/Component/Dataform/?tn="+r+"&frm=batchupdate&qrycols="+i.join());$.get(e,function(n){u.find(".step-content [data-step=2]").html(n)})}else t.step===2}).on("finished.fu.wizard",function(n){if(!$("#frm-batchupdate").valid())return n.preventDefault(),!1;var r=$.map(o,function(n){return n.Fid}),i=GetFapFormData("frm-batchupdate");i.Fids=r;$.post(basePath+"/Api/Core/BatchUpdate",i,function(n){n.success?(u.modal("hide"),u.remove(),$.msg("批量更新成功！"),refreshBaseJqGrid(t)):bootbox.alert(n.msg)})}).on("stepclick.fu.wizard",function(){});u.modal("show");u.find(".modal-body [data-step=1]").html("");u.find(".modal-body [data-step=1]").append(f);$.get(basePath+"/Api/Core/fieldlist/"+r,function(n){f.empty();$.each(n,function(n,t){if(t.isDefaultCol===1||t.showAble===0)return!0;f.append("<option value='"+t.colName+"'>"+t.colComment+"<\/option>")});f.bootstrapDualListbox({preserveSelectionOnMove:"moved",moveOnSelect:!1})})}},loadExportMessageBox=function(n,t,i,r){var u=$("<select multiple='multiple' size='10' id='duallistbox_"+r+"' name='duallistbox_"+r+"'><\/select>"),f=bootbox.dialog({title:n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{success:{label:MultiLangHelper.getResName("global_oper_enter","确定"),className:"btn-primary",callback:function(){var i=u.val(),n;if(i===null){$.msg("请选择导出字段！");return}n=$("#"+t).jqGrid("getGridParam","postData");n.QuerySet.ExportCols=i.join();$.post(basePath+"/Api/Core/export",n,function(n){n.rv?window.location.href=basePath+"/UploadFiles/"+n.fn:$.msg("生成文件异常！")})}},cancel:{label:MultiLangHelper.getResName("global_oper_cancel","取消"),className:"btn-default"}}});f.init(function(){f.find(".bootbox-body").html("");f.find(".bootbox-body").append(u);$.get(basePath+"/Api/Core/fieldlist/"+r,function(n){u.empty();$.each(n,function(n,t){if(t.isDefaultCol===1&&t.colName!=="Fid")return!0;u.append("<option value='"+t.colName+"'>"+t.colComment+"<\/option>")});u.bootstrapDualListbox({nonSelectedListLabel:'<span class="text-primary h5">所有项<\/span> ',selectedListLabel:'<span class="text-primary h5">选中项<\/span> ',preserveSelectionOnMove:"moved",moveOnSelect:!1})})})},loadExportTmplMessageBox=function(n,t){$.get(basePath+"/Api/Core/exporttmpl/"+t,function(n){n.rv?window.location.href=basePath+"/UploadFiles/"+n.fn:$.msg("模板生成失败！")})},loadExportDataMessageBox=function(n,t){var i={TableName:t};$.post(basePath+"/Api/Core/exportdata",i,function(n){n.rv?window.location.href=basePath+"/UploadFiles/"+n.fn:bootbox.alert("生成文件异常！")})},loadImportDataMessageBox=function(n,t,i,r){var u=bootbox.dialog({title:n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{success:{label:MultiLangHelper.getResName("global_oper_enter","确定"),className:"btn-primary",callback:function(){$("#"+t).jqGrid("setGridParam",{}).trigger("reloadGrid")}},cancel:{label:MultiLangHelper.getResName("global_oper_cancel","取消"),className:"btn-default"}}});u.init(function(){var f=$('<h3 class=" smaller lighter blue">1.下载模板<\/h3>'),n=$('<button class="btn btn-success"><i class="ace-icon fa fa-download"><\/i>下载模板<\/button>'),t=$('<button class="btn btn-success"><i class="ace-icon fa fa-download"><\/i>下载数据<\/button>'),i=$('<input id="file-import" type="file"  class="file-loading">');u.find(".bootbox-body").empty().append(f).append(n).append(t).append('<h3 class=" smaller lighter blue">2.导入数据<\/h3>').append(i);n.on(ace.click_event,function(){loadExportTmplMessageBox("",r)});t.on(ace.click_event,function(){loadExportDataMessageBox("",r)});i.fileinput({language:"zh",uploadUrl:basePath+"/Api/Core/impdata/"+r,showCaption:!1,allowedFileExtensions:["xls","xlsx"],showClose:!0})})},registAttachmentFuntion=function(n){$("#"+n+" .btn-attachment").on(ace.click_event,function(t){t.preventDefault();var i=$(this).data("value");showAttachmentWin(i,n)})},showAttachmentWin=function(n){var t=bootbox.dialog({title:"附件查看",message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{cancel:{label:"关闭",className:"btn-default"}}});t.init(function(){var i;i=basePath+"/Component/AttachmentInfo/"+n;$.get(i,function(n){t.find(".bootbox-body").html(n)})})},attachmentInfo=function(n){var t='<button class="btn  btn-link btn-attachment" data-value="'+n+'">';return t+'         <i class="ace-icon fa  fa-paperclip bigger-120 blue"><\/i>附件<\/button>'},unattachmentInfo=function(){return $(cellObject.innerHTML).data("value")},formatImage=function(n){return"<img src='/Home/UserPhoto/"+n+"'  style='width:60px' originalValue='"+n+"' />"},unformatImage=function(n,t,i){return $(i.innerHTML).attr("originalValue")},formatReference=function(n,t,i){if(n==="undefined")return"<label data-value=''><\/label>";var r=t.colModel.name+"MC",u=i[r]===null?"":i[r];return"<label data-value='"+n+"'>"+u+"<\/label>"},unformatReference=function(n,t,i){return $(i.innerHTML).data("value")};(function(n){n.fn.serializeJson=function(){var t={},i=this.serializeArray(),r=this.serialize();return n(i).each(function(){t[this.name]?n.isArray(t[this.name])?t[this.name].push(this.value):t[this.name]=[t[this.name],this.value]:t[this.name]=this.value}),t}})(jQuery);jQuery.GetChkListValue=function(n){var i=[],r,u,t,f;if(!n)return i;if(r=n.split(";"),u=r.length,u<1)return[];for(t=0;t<u;t++)f=r[t].split(":"),f.length>0&&i.push(f[0]);return i};var GetFapFormData=function(n){var i=[],t;return $("#"+n+" :disabled").each(function(){$(this).attr("disabled",!1);i.push($(this))}),t={},$("#"+n+" .form-control").each(function(){if($(this).attr("id")!==undefined){if($(this).is("input")&&$(this).attr("type")==="checkbox"){t[$(this).attr("id")]=$(this).is(":checked")?$(this).val():0;return}if($(this).hasClass("wysiwyg-editor")){t[$(this).attr("id")]=$(this).html();return}t[$(this).attr("id")]=$(this).val()}}),$("#"+n+" .control-group.checkboxlist").each(function(){var n=$(this).data("ctrlname"),i=[];$("input[name='"+n+"']:checked").each(function(){var n=$(this).val()+":"+$(this).data("text");i.push(n)});t[n]=i.join(";")}),i&&$.each(i,function(n,t){t.attr("disabled",!0)}),t},GetFapChildGridData=function(n){var t=$("#"+n).find("#lblchildgrid");if(t.length===1){var i=[],r=!0,u=t[0].innerText.trim();return($.each(u.split(","),function(n,t){var u=$("#grid-"+t).jqGrid("getRowData",null,!0);if(u===!1)return r=!1,!1;i.push({tn:t,data:u})}),!r)?!1:i}return null},Persistence=function(n,t,i,r){var o,f,c,h,u,s,e;return $("#"+n).valid()?(o=$("#"+n).find(".wysiwyg-editor"),o!==""&&o.first().data("nullable")===0&&o.first().html()==="")?($.msg("富文本内容不能为空！"),!1):(f=$("#"+n).find(".form-control.attachment"),f!==""&&f.first().data("nullable")===0&&f.first().data("editable")===1&&(c=f.first().val(),h=!1,$.ajax({type:"get",url:basePath+"/Api/Core/filecount/"+c,async:!1,dataType:"text",success:function(n){n<1&&(h=!0)}}),h))?($.msg("必须要上传附件！"),!1):(u=GetFapFormData(n),s=GetFapChildGridData(n),s===!1)?!1:(s!==null&&(u.childsData=JSON.stringify(s)),i!==undefined&&$.isFunction(i)&&i(u),u.oper=u.Id!==""?"edit":"add",e={success:!1},$.ajax({type:"post",url:basePath+"/Api/Core/Persistence?from=form",data:u,async:!1,dataType:"json",headers:{RequestVerificationToken:$("input[name='__RequestVerificationToken']").val()},success:function(t){if(e=t,t.success===!0&&(r!=="1"&&$.msg("保存成功"),e.data)){var i=e.data;$("#"+n+" .form-control#Id").val(i.Id);$("#"+n+" .form-control#Ts").val(i.Ts)}t.msg&&bootbox.alert(t.msg)}}),e):($.msg("表单校验失败，请完善表单"+$(".error").html()),!1)};$(function(){$.widget("ui.dialog",$.extend({},$.ui.dialog.prototype,{_title:function(n){var t=this.options.title||"&nbsp;";"title_html"in this.options&&this.options.title_html===!0?n.html(t):n.text(t)}}));$(document).off(ace.click_event,".formctrl.deletefile");$(document).on(ace.click_event,".formctrl.deletefile",function(n){n.preventDefault();var t=$(this).data("filefid"),i=$(this);bootbox.confirm("确定删除此附件?",function(n){n&&$.post(basePath+"/Api/Core/deletefile/",{key:t},function(n){n==="1"&&i.parent().parent().remove()})})});$(document).off(ace.click_event,".formctrl.attached-file");$(document).on(ace.click_event,".formctrl.attached-file",function(n){n.preventDefault();var t=$(this).data("filefid");$.get(basePath+"/Api/Core/viewfile/"+t,function(n){n.success?n.id==="img"?openNewWindow(basePath+"/UploadFiles/View/"+n.msg):n.id=="0"?$.msg("无法预览"):openNewWindow(basePath+"/Content/Pdf/web/viewer.html?file=/UploadFiles/View/"+n.msg):$.msg(n.msg)})})});var loadRefMessageBox=function(n,t,i,r,u,f){var e=bootbox.dialog({title:n,message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{success:{label:MultiLangHelper.getResName("global_oper_enter","确定"),className:"btn-primary",callback:function(){var n=GetRefResult(),u,f,i;if(n){if($("#frm-"+t+" #"+t+r+"MC").val(n.name).change(),$("#frm-"+t+" #"+r).val(n.code).change(),n.frmcols!=undefined&&n.frmcols!="")for(u=n.frmcols.split(","),f=n.ext.split("^-^"),i=0;i<u.length;i++)$("#frm-"+t+" #"+u[i]).val(f[i]).change()}else{$.msg("请选择一条数据！");return}}},danger:{label:"清空!",className:"btn-sm btn-danger",callback:function(){$("#frm-"+t+" #"+t+r+"MC").val("").change();$("#frm-"+t+" #"+r).val("").change()}},cancel:{label:MultiLangHelper.getResName("global_oper_cancel","取消"),className:"btn-default"}}});e.on("shown.bs.modal",function(){u.indexOf("GridReference")>-1&&$(window).triggerHandler("resize.jqGrid")});e.init(function(){var n=basePath+"/Component/"+u+"/"+i+"?frmid="+t+"&ctrlid="+r,o;f!=""&&(o=f.join("&"),n+="&"+o);$.get(n,function(n){e.find(".bootbox-body").html(n)})})},loadFileMessageBox=function(n,t,i){var r=bootbox.dialog({title:"附件",message:'<p><i class="fa fa-spin fa-spinner"><\/i> Loading...<\/p>',buttons:{cancel:{label:"关闭",className:"btn-default"}}});r.init(function(){r.find(".bootbox-body").html('<div class="row">  <div  class="col-lg-12"> <input type="file" class="file-loading"  id="'+t+n+'-FILE" name="'+t+n+'-FILE" multiple   /><\/div><\/div>');i()})},loadFileList=function(n,t,i,r){var u={groupOp:"AND"},f=[];f.push({field:"Bid",op:"eq",data:i});u.rules=f;$.post(basePath+"/Api/Core/querydata",{EntityName:"FapAttachment",QueryCols:"Id,Fid,FileName,FileType",filters:JSON.stringify(u)},function(i){if(i.success){$("#frm-"+n+" #file"+n+t).parent().parent().parent().find(".filelist").remove();var f=i.data,u=" <div class='filelist'>";u+=r?'<div class="col-xs-12">':"<div class='col-sm-2'><\/div> <div class=\"col-xs-10 col-sm-10\">";u+='        <ul class="attachment-list pull-left list-inline list-unstyled">';$.each(f,function(n,t){u+=["        <li>",'            <a href="#" class="formctrl attached-file" data-filefid="'+t.Fid+'" data-rel="tooltip" title="'+t.FileName+'">','                <i class="ace-icon fa fa-paperclip bigger-110 "><\/i>','                <span class="attached-name">'+t.FileName+"<\/span> <\/a>",'            <span class="action-buttons">','                <a href="'+basePath+"/Component/DownloadFile/"+t.Fid+'">','                    <i class="ace-icon fa fa-download bigger-125 blue"><\/i>',"                <\/a>",'                <a href="#" data-filefid="'+t.Fid+'" class="formctrl deletefile">','                    <i class="ace-icon fa fa-trash-o bigger-125 red"><\/i>',"                <\/a>","            <\/span>","        <\/li>"].join("")});u+="    <\/ul>    <\/div><\/div>";r?$("#frm-"+n+" #file"+n+t).parent().append(u):$("#frm-"+n+" #file"+n+t).parent().parent().parent().append(u)}})},loadImageControl=function(n){try{$.fn.editable.defaults.mode="inline";try{document.createElement("IMG").appendChild(document.createElement("B"))}catch(i){Image.prototype.appendChild=function(){}}var t;$("#"+n).editable({type:"image",name:"avatar",value:null,image:{btn_choose:MultiLangHelper.getResName("ess_userprofile_page_changphoto","更换照片"),droppable:!0,maxSize:11e6,name:"avatar",on_error:function(n){t&&$.gritter.remove(t);n===1?t=$.gritter.add({title:MultiLangHelper.getResName("ess_userprofile_page_filenotphoto","文件不是图片")+"!",text:MultiLangHelper.getResName("global_oper_select","请选择")+"jpg|gif|png image!",class_name:"gritter-error gritter-center"}):n==2&&(t=$.gritter.add({title:MultiLangHelper.getResName("global_file_filetoolarge","文件太大")+"!",text:MultiLangHelper.getResName("global_file_sizenotexceed","文件大小不要超过")+"10M!",class_name:"gritter-error gritter-center"}))},on_success:function(){$.gritter.removeAll()}},url:function(){var o=basePath+"/Api/Core/uploadfile/",i=null,s="#"+n,l=$(s).next().find("input[type=hidden]:eq(0)").val(),u,f,e,c;if(!l||l.length===0)return i=new $.Deferred,i.resolve(),i.promise();var r=$(s).next().find(".editableform:eq(0)"),a=r.find("input[type=file]:eq(0)"),h=$(s).attr("data-pk");return o+=h,u=null,"FormData"in window?(f=new FormData,$.each(r.serializeArray(),function(n,t){f.append(t.name,t.value)}),r.find("input[type=file]").each(function(){var t=$(this).attr("name"),n=$(this).data("ace_input_files");n&&n.length>0&&f.append(t,n[0])}),f.append("pk",h),i=$.ajax({url:o,type:"POST",processData:!1,contentType:!1,dataType:"json",data:f})):(i=new $.Deferred,e="temporary-iframe-"+(new Date).getTime()+"-"+parseInt(Math.random()*1e3),c=$('<iframe id="'+e+'" name="'+e+'" \t\t\t\t\t\t\t\t\tframeborder="0" width="0" height="0" src="about:blank"\t\t\t\t\t\t\t\t\tstyle="position:absolute; z-index:-1; visibility: hidden;"><\/iframe>').insertAfter(r),r.append('<input type="hidden" name="temporary-iframe-id" value="'+e+'" />'),$('<input type="hidden" name="pk" />').val(h).appendTo(r),c.data("deferrer",i),r.attr({action:o,method:"POST",enctype:"multipart/form-data",target:e}),r.get(0).submit(),u=setTimeout(function(){u=null;c.attr("src","about:blank").remove();i.reject({status:"fail",message:"Timeout!"})},3e4)),i.done(function(i){if(i.success){var r="#"+n,u=$(r).attr("data-pk");$(r).get(0).src=$.randomUrl(basePath+"/Home/UserPhoto/"+u);t&&$.gritter.remove(t);t=$.gritter.add({title:MultiLangHelper.getResName("global_file_photo_updated","照片已更新")+"!",text:"",class_name:"gritter-info gritter-center"})}}).fail(function(){alert(MultiLangHelper.getResName("global_file_photo_updateerror","更新图片遇到错误"))}).always(function(){u&&clearTimeout(u);u=null}),i.promise()},success:function(){}})}catch(i){}};(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof module!="undefined"&&module.exports?module.exports=n(require("jquery")):n(jQuery)})(function(n,t){"use strict";
/*!
 * jsTree 3.2.1
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * if using jslint please allow for the jQuery global and use following options:
 * jslint: browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
var c,l,o,v;if(!n.jstree){var p=0,f=!1,u=!1,e=!1,y=[],a=n("script:last").attr("src"),i=window.document,h=i.createElement("LI"),r,s;if(h.setAttribute("role","treeitem"),r=i.createElement("I"),r.className="jstree-icon jstree-ocl",r.setAttribute("role","presentation"),h.appendChild(r),r=i.createElement("A"),r.className="jstree-anchor",r.setAttribute("href","#"),r.setAttribute("tabindex","-1"),s=i.createElement("I"),s.className="jstree-icon jstree-themeicon",s.setAttribute("role","presentation"),r.appendChild(s),h.appendChild(r),r=s=null,n.jstree={version:"3.2.1",defaults:{plugins:[]},plugins:{},path:a&&a.indexOf("/")!==-1?a.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},n.jstree.create=function(t,i){var r=new n.jstree.core(++p),u=i;return i=n.extend(!0,{},n.jstree.defaults,i),u&&u.plugins&&(i.plugins=u.plugins),n.each(i.plugins,function(n,t){n!=="core"&&(r=r.plugin(t,i[t]))}),n(t).data("jstree",r),r.init(t,i),r},n.jstree.destroy=function(){n(".jstree:jstree").jstree("destroy");n(i).off(".jstree")},n.jstree.core=function(n){this._id=n;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},n.jstree.reference=function(t){var r=null,i=null;if(t&&t.id&&(!t.tagName||!t.nodeType)&&(t=t.id),!i||!i.length)try{i=n(t)}catch(u){}if(!i||!i.length)try{i=n("#"+t.replace(n.jstree.idregex,"\\$&"))}catch(u){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:n(".jstree").each(function(){var i=n(this).data("jstree");if(i&&i._model.data[t])return r=i,!1}),r},n.fn.jstree=function(i){var u=typeof i=="string",f=Array.prototype.slice.call(arguments,1),r=null;return i===!0&&!this.length?!1:(this.each(function(){var e=n.jstree.reference(this),o=u&&e?e[i]:null;return r=u&&o?o.apply(e,f):null,e||u||i!==t&&!n.isPlainObject(i)||n.jstree.create(this,i),(e&&!u||i===!0)&&(r=e||!1),r!==null&&r!==t?!1:void 0}),r!==null&&r!==t?r:this)},n.expr[":"].jstree=n.expr.createPseudo(function(){return function(i){return n(i).hasClass("jstree")&&n(i).data("jstree")!==t}}),n.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:n.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},n.jstree.core.prototype={plugin:function(t,i){var r=n.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}};this._model.data[n.jstree.root]={id:n.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this.element=n(t).addClass("jstree jstree-"+this._id);this.settings=i;this._data.core.ready=!1;this._data.core.loaded=!1;this._data.core.rtl=this.element.css("direction")==="rtl";this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0);this.element.attr("tabindex")||this.element.attr("tabindex","0");this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().height()||24;this.trigger("loading");this.load_node(n.jstree.root)},destroy:function(n){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(t){}n||this.element.empty();this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){var t="",r=null,u=0;this.element.on("dblclick.jstree",function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;if(i.selection&&i.selection.empty)i.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges();t.collapse()}catch(r){}}}).on("mousedown.jstree",n.proxy(function(n){n.target===this.element[0]&&(n.preventDefault(),u=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(n){n.preventDefault()}).on("click.jstree",".jstree-ocl",n.proxy(function(n){this.toggle_node(n.target)},this)).on("dblclick.jstree",".jstree-anchor",n.proxy(function(n){if(n.target.tagName&&n.target.tagName.toLowerCase()==="input")return!0;this.settings.core.dblclick_toggle&&this.toggle_node(n.target)},this)).on("click.jstree",".jstree-anchor",n.proxy(function(t){t.preventDefault();t.currentTarget!==i.activeElement&&n(t.currentTarget).focus();this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",n.proxy(function(t){if(t.target.tagName&&t.target.tagName.toLowerCase()==="input"||t.which!==32&&t.which!==13&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var i=null;this._data.core.rtl&&(t.which===37?t.which=39:t.which===39&&(t.which=37));switch(t.which){case 32:t.ctrlKey&&(t.type="click",n(t.currentTarget).trigger(t));break;case 13:t.type="click";n(t.currentTarget).trigger(t);break;case 37:t.preventDefault();this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(i=this.get_parent(t.currentTarget),i&&i.id!==n.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault();i=this.get_prev_dom(t.currentTarget);i&&i.length&&i.children(".jstree-anchor").focus();break;case 39:t.preventDefault();this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(n){this.get_node(n,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],i&&n(this._firstChild(i)).children(".jstree-anchor").focus());break;case 40:t.preventDefault();i=this.get_next_dom(t.currentTarget);i&&i.length&&i.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault();i=this._firstChild(this.get_container_ul()[0]);i&&n(i).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().focus()}},this)).on("load_node.jstree",n.proxy(function(t,i){i.status&&(i.node.id!==n.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(n.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var i=[],t=0,r=this._data.core.selected.length;t<r;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(i=n.vakata.array_unique(i),t=0,r=i.length;t<r;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",n.proxy(function(u){if(u.target.tagName&&u.target.tagName.toLowerCase()==="input")return!0;r&&clearTimeout(r);r=setTimeout(function(){t=""},500);var o=String.fromCharCode(u.which).toLowerCase(),e=this.element.find(".jstree-anchor").filter(":visible"),s=e.index(i.activeElement)||0,f=!1;if(t+=o,t.length>1){if(e.slice(s).each(n.proxy(function(i,r){if(n(r).text().toLowerCase().indexOf(t)===0)return n(r).focus(),f=!0,!1},this)),f)return;if(e.slice(0,s).each(n.proxy(function(i,r){if(n(r).text().toLowerCase().indexOf(t)===0)return n(r).focus(),f=!0,!1},this)),f)return}if(new RegExp("^"+o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(e.slice(s+1).each(n.proxy(function(t,i){if(n(i).text().toLowerCase().charAt(0)===o)return n(i).focus(),f=!0,!1},this)),f)return;if(e.slice(0,s+1).each(n.proxy(function(t,i){if(n(i).text().toLowerCase().charAt(0)===o)return n(i).focus(),f=!0,!1},this)),f)return}},this)).on("init.jstree",n.proxy(function(){var n=this.settings.core.themes;this._data.core.themes.dots=n.dots;this._data.core.themes.stripes=n.stripes;this._data.core.themes.icons=n.icons;this.set_theme(n.name||"default",n.url);this.set_theme_variant(n.variant)},this)).on("loading.jstree",n.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",n.proxy(function(t){this._data.core.focused=null;n(t.currentTarget).filter(".jstree-hovered").mouseleave();this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",n.proxy(function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id);this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave();n(t.currentTarget).mouseenter();this.element.attr("tabindex","-1")},this)).on("focus.jstree",n.proxy(function(){if(+new Date-u>500&&!this._data.core.focused){u=0;var n=this.get_node(this.element.attr("aria-activedescendant"),!0);n&&n.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",n.proxy(function(n){this.hover_node(n.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",n.proxy(function(n){this.dehover_node(n.currentTarget)},this))},unbind:function(){this.element.off(".jstree");n(i).off(".jstree-"+this._id)},trigger:function(n,t){t||(t={});t.instance=this;this.element.triggerHandler(n.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return n.isFunction(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(n){for(n=n?n.firstChild:null;n!==null&&n.nodeType!==1;)n=n.nextSibling;return n},_nextSibling:function(n){for(n=n?n.nextSibling:null;n!==null&&n.nodeType!==1;)n=n.nextSibling;return n},_previousSibling:function(n){for(n=n?n.previousSibling:null;n!==null&&n.nodeType!==1;)n=n.previousSibling;return n},get_node:function(t,i){t&&t.id&&(t=t.id);var r;try{if(this._model.data[t])t=this._model.data[t];else if(typeof t=="string"&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if(typeof t=="string"&&(r=n("#"+t.replace(n.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=n(t,this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=n(t,this.element)).length&&r.hasClass("jstree"))t=this._model.data[n.jstree.root];else return!1;return i&&(t=t.id===n.jstree.root?this.element:n("#"+t.id.replace(n.jstree.idregex,"\\$&"),this.element)),t}catch(u){return!1}},get_path:function(t,i,r){if(t=t.parents?t:this.get_node(t),!t||t.id===n.jstree.root||!t.parents)return!1;var f,e,u=[];for(u.push(r?t.id:t.text),f=0,e=t.parents.length;f<e;f++)u.push(r?t.parents[f]:this.get_text(t.parents[f]));return u=u.reverse().slice(1),i?u.join(i):u},get_next_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&r.offsetHeight===0;)r=this._nextSibling(r);return r?n(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._nextSibling(r);while(r&&r.offsetHeight===0);return r?n(r):!1}if(t.hasClass("jstree-open")){for(r=this._firstChild(t.children(".jstree-children")[0]);r&&r.offsetHeight===0;)r=this._nextSibling(r);if(r!==null)return n(r)}r=t[0];do r=this._nextSibling(r);while(r&&r.offsetHeight===0);return r!==null?n(r):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&r.offsetHeight===0;)r=this._previousSibling(r);return r?n(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._previousSibling(r);while(r&&r.offsetHeight===0);return r?n(r):!1}r=t[0];do r=this._previousSibling(r);while(r&&r.offsetHeight===0);if(r!==null){for(t=n(r);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return r=t[0].parentNode.parentNode,r&&r.className&&r.className.indexOf("jstree-node")!==-1?n(r):!1},get_parent:function(t){return(t=this.get_node(t),!t||t.id===n.jstree.root)?!1:t.parent},get_children_dom:function(n){return(n=this.get_node(n,!0),n[0]===this.element[0])?this.get_container_ul().children(".jstree-node"):!n||!n.length?!1:n.children(".jstree-children").children(".jstree-node")},is_parent:function(n){return n=this.get_node(n),n&&(n.state.loaded===!1||n.children.length>0)},is_loaded:function(n){return n=this.get_node(n),n&&n.state.loaded},is_loading:function(n){return n=this.get_node(n),n&&n.state&&n.state.loading},is_open:function(n){return n=this.get_node(n),n&&n.state.opened},is_closed:function(n){return n=this.get_node(n),n&&this.is_parent(n)&&!n.state.opened},is_leaf:function(n){return!this.is_parent(n)},load_node:function(t,i){var r,f,u,e,o;if(n.isArray(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,r=0,f=t.children_d.length;r<f;r++){for(u=0,e=t.parents.length;u<e;u++)this._model.data[t.parents[u]].children_d=n.vakata.array_remove_item(this._model.data[t.parents[u]].children_d,t.children_d[r]);this._model.data[t.children_d[r]].state.selected&&(o=!0,this._data.core.selected=n.vakata.array_remove_item(this._data.core.selected,t.children_d[r]));delete this._model.data[t.children_d[r]]}t.children=[];t.children_d=[];o&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,n.proxy(function(n){t=this._model.data[t.id];t.state.loading=!1;t.state.loaded=n;t.state.failed=!t.state.loaded;for(var r=this.get_node(t,!0),u=0,f=0,e=this._model.data,o=!1,u=0,f=t.children.length;u<f;u++)if(e[t.children[u]]&&!e[t.children[u]].state.hidden){o=!0;break}t.state.loaded&&!o&&r&&r.length&&!r.hasClass("jstree-leaf")&&r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf");r.removeClass("jstree-loading").attr("aria-busy",!1);this.trigger("load_node",{node:t,status:n});i&&i.call(this,t,n)},this)),!0},_load_nodes:function(n,t,i){for(var e=!0,s=function(){this._load_nodes(n,t,!0)},u=this._model.data,o=[],r=0,f=n.length;r<f;r++)!u[n[r]]||(u[n[r]].state.loaded||u[n[r]].state.failed)&&i||(this.is_loading(n[r])||this.load_node(n[r],s),e=!1);if(e){for(r=0,f=n.length;r<f;r++)u[n[r]]&&u[n[r]].state.loaded&&o.push(n[r]);t&&!t.done&&(t.call(this,o),t.done=!0)}},load_all:function(t,i){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var f=[],e=this._model.data,u=e[t.id].children_d,r,o;for(t.state&&!t.state.loaded&&f.push(t.id),r=0,o=u.length;r<o;r++)e[u[r]]&&e[u[r]].state&&!e[u[r]].state.loaded&&f.push(u[r]);f.length?this._load_nodes(f,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var r=this.settings.core.data,u;return r?n.isFunction(r)?r.call(this,t,n.proxy(function(r){r===!1&&i.call(this,!1);this[typeof r=="string"?"_append_html_data":"_append_json_data"](t,typeof r=="string"?n(n.parseHTML(r)).filter(function(){return this.nodeType!==3}):r,function(n){i.call(this,n)})},this)):typeof r=="object"?r.url?(r=n.extend(!0,{},r),n.isFunction(r.url)&&(r.url=r.url.call(this,t)),n.isFunction(r.data)&&(r.data=r.data.call(this,t)),n.ajax(r).done(n.proxy(function(r,u,f){var e=f.getResponseHeader("Content-Type");return e&&e.indexOf("json")!==-1||typeof r=="object"?this._append_json_data(t,r,function(n){i.call(this,n)}):e&&e.indexOf("html")!==-1||typeof r=="string"?this._append_html_data(t,n(n.parseHTML(r)).filter(function(){return this.nodeType!==3}),function(n){i.call(this,n)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:f})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))},this)).fail(n.proxy(function(n){i.call(this,!1);this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})};this.settings.core.error.call(this,this._data.core.last_error)},this))):(u=n.isArray(r)||n.isPlainObject(r)?JSON.parse(JSON.stringify(r)):r,t.id===n.jstree.root?this._append_json_data(t,u,function(n){i.call(this,n)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):typeof r=="string"?t.id===n.jstree.root?this._append_html_data(t,n(n.parseHTML(r)).filter(function(){return this.nodeType!==3}),function(n){i.call(this,n)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===n.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(n){i.call(this,n)}):i.call(this,!1)},_node_changed:function(n){n=this.get_node(n);n&&this._model.changed.push(n.id)},_append_html_data:function(t,i,r){t=this.get_node(t);t.children=[];t.children_d=[];var a=i.is("ul")?i.children():i,o=t.id,c=[],u=[],s=this._model.data,f=s[o],v=this._data.core.selected.length,e,h,l;for(a.each(n.proxy(function(t,i){e=this._parse_model_from_html(n(i),o,f.parents.concat());e&&(c.push(e),u.push(e),s[e].children_d.length&&(u=u.concat(s[e].children_d)))},this)),f.children=c,f.children_d=u,h=0,l=f.parents.length;h<l;h++)s[f.parents[h]].children_d=s[f.parents[h]].children_d.concat(u);this.trigger("model",{nodes:u,parent:o});o!==n.jstree.root?(this._node_changed(o),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0));this._data.core.selected.length!==v&&this.trigger("changed",{action:"model",selected:this._data.core.selected});r.call(this,!0)},_append_json_data:function(t,i,r,u){if(this.element!==null){t=this.get_node(t);t.children=[];t.children_d=[];i.d&&(i=i.d,typeof i=="string"&&(i=JSON.parse(i)));n.isArray(i)||(i=[i]);var f=null,e={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(n,t){n.data&&(n=n.data);var u=n.dat,c=n.par,y=[],o=[],l=[],h=n.df,k=n.t_id,v=n.t_cnt,r=n.m,f=r[c],p=n.sel,s,i,e,a,w=function(n,i,u){u=u?u.concat():[];i&&u.unshift(i);var c=n.id.toString(),e,a,o,s,f={id:c,text:n.text||"",icon:n.icon!==t?n.icon:!0,parent:i,parents:u,children:n.children||[],children_d:n.children_d||[],data:n.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in h)h.hasOwnProperty(e)&&(f.state[e]=h[e]);if(n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(f.icon=n.data.jstree.icon),(f.icon===t||f.icon===null||f.icon==="")&&(f.icon=!0),n&&n.data&&(f.data=n.data,n.data.jstree))for(e in n.data.jstree)n.data.jstree.hasOwnProperty(e)&&(f.state[e]=n.data.jstree[e]);if(n&&typeof n.state=="object")for(e in n.state)n.state.hasOwnProperty(e)&&(f.state[e]=n.state[e]);if(n&&typeof n.li_attr=="object")for(e in n.li_attr)n.li_attr.hasOwnProperty(e)&&(f.li_attr[e]=n.li_attr[e]);if(f.li_attr.id||(f.li_attr.id=c),n&&typeof n.a_attr=="object")for(e in n.a_attr)n.a_attr.hasOwnProperty(e)&&(f.a_attr[e]=n.a_attr[e]);for(n&&n.children&&n.children===!0&&(f.state.loaded=!1,f.children=[],f.children_d=[]),r[f.id]=f,e=0,a=f.children.length;e<a;e++)o=w(r[f.children[e]],f.id,u),s=r[o],f.children_d.push(o),s.children_d.length&&(f.children_d=f.children_d.concat(s.children_d));return delete n.data,delete n.children,r[f.id].original=n,f.state.selected&&l.push(f.id),f.id},b=function(n,i,u){u=u?u.concat():[];i&&u.unshift(i);var o=!1,e,a,s,c,f;do o="j"+k+"_"+ ++v;while(r[o]);f={id:!1,text:typeof n=="string"?n:"",icon:typeof n=="object"&&n.icon!==t?n.icon:!0,parent:i,parents:u,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in h)h.hasOwnProperty(e)&&(f.state[e]=h[e]);if(n&&n.id&&(f.id=n.id.toString()),n&&n.text&&(f.text=n.text),n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(f.icon=n.data.jstree.icon),(f.icon===t||f.icon===null||f.icon==="")&&(f.icon=!0),n&&n.data&&(f.data=n.data,n.data.jstree))for(e in n.data.jstree)n.data.jstree.hasOwnProperty(e)&&(f.state[e]=n.data.jstree[e]);if(n&&typeof n.state=="object")for(e in n.state)n.state.hasOwnProperty(e)&&(f.state[e]=n.state[e]);if(n&&typeof n.li_attr=="object")for(e in n.li_attr)n.li_attr.hasOwnProperty(e)&&(f.li_attr[e]=n.li_attr[e]);if(f.li_attr.id&&!f.id&&(f.id=f.li_attr.id.toString()),f.id||(f.id=o),f.li_attr.id||(f.li_attr.id=f.id),n&&typeof n.a_attr=="object")for(e in n.a_attr)n.a_attr.hasOwnProperty(e)&&(f.a_attr[e]=n.a_attr[e]);if(n&&n.children&&n.children.length){for(e=0,a=n.children.length;e<a;e++)s=b(n.children[e],f.id,u),c=r[s],f.children.push(s),c.children_d.length&&(f.children_d=f.children_d.concat(c.children_d));f.children_d=f.children_d.concat(f.children)}return n&&n.children&&n.children===!0&&(f.state.loaded=!1,f.children=[],f.children_d=[]),delete n.data,delete n.children,f.original=n,r[f.id]=f,f.state.selected&&l.push(f.id),f.id};if(u.length&&u[0].id!==t&&u[0].parent!==t){for(i=0,e=u.length;i<e;i++)u[i].children||(u[i].children=[]),r[u[i].id.toString()]=u[i];for(i=0,e=u.length;i<e;i++)r[u[i].parent.toString()].children.push(u[i].id.toString()),f.children_d.push(u[i].id.toString());for(i=0,e=f.children.length;i<e;i++)s=w(r[f.children[i]],c,f.parents.concat()),o.push(s),r[s].children_d.length&&(o=o.concat(r[s].children_d));for(i=0,e=f.parents.length;i<e;i++)r[f.parents[i]].children_d=r[f.parents[i]].children_d.concat(o);a={cnt:v,mod:r,sel:p,par:c,dpc:o,add:l}}else{for(i=0,e=u.length;i<e;i++)s=b(u[i],c,f.parents.concat()),s&&(y.push(s),o.push(s),r[s].children_d.length&&(o=o.concat(r[s].children_d)));for(f.children=y,f.children_d=o,i=0,e=f.parents.length;i<e;i++)r[f.parents[i]].children_d=r[f.parents[i]].children_d.concat(o);a={cnt:v,mod:r,sel:p,par:c,dpc:o,add:l}}if(typeof window=="undefined"||typeof window.document=="undefined")postMessage(a);else return a},s=function(t,i){if(this.element!==null){if(this._cnt=t.cnt,this._model.data=t.mod,i){var u,o,h=t.add,f=t.sel,e=this._data.core.selected.slice(),s=this._model.data;if(f.length!==e.length||n.vakata.array_unique(f.concat(e)).length!==f.length){for(u=0,o=f.length;u<o;u++)n.inArray(f[u],h)===-1&&n.inArray(f[u],e)===-1&&(s[f[u]].state.selected=!1);for(u=0,o=e.length;u<o;u++)n.inArray(e[u],f)===-1&&(s[e[u]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add));this.trigger("model",{nodes:t.dpc,parent:t.par});t.par!==n.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0);t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected});r.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{this._wrk===null&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"})));!this._data.core.working||u?(this._data.core.working=!0,f=new window.Worker(this._wrk),f.onmessage=n.proxy(function(n){s.call(this,n.data,!0);try{f.terminate();f=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),e.par?f.postMessage(e):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,r,!0])}catch(h){s.call(this,o(e),!1);this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else s.call(this,o(e),!1)}},_parse_model_from_html:function(i,r,u){u=u?[].concat(u):[];r&&u.unshift(r);var s,h,l=this._model.data,f={id:!1,text:!1,icon:!0,parent:r,parents:u,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},o,e,c;for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(f.state[o]=this._model.default_state[o]);if(e=n.vakata.attributes(i,!0),n.each(e,function(t,i){if(i=n.trim(i),!i.length)return!0;f.li_attr[t]=i;t==="id"&&(f.id=i.toString())}),e=i.children("a").first(),e.length&&(e=n.vakata.attributes(e,!0),n.each(e,function(t,i){i=n.trim(i);i.length&&(f.a_attr[t]=i)})),e=i.children("a").first().length?i.children("a").first().clone():i.clone(),e.children("ins, i, ul").remove(),e=e.html(),e=n("<div />").html(e),f.text=this.settings.core.force_text?e.text():e.html(),e=i.data(),f.data=e?n.extend(!0,{},e):null,f.state.opened=i.hasClass("jstree-open"),f.state.selected=i.children("a").hasClass("jstree-clicked"),f.state.disabled=i.children("a").hasClass("jstree-disabled"),f.data&&f.data.jstree)for(o in f.data.jstree)f.data.jstree.hasOwnProperty(o)&&(f.state[o]=f.data.jstree[o]);e=i.children("a").children(".jstree-themeicon");e.length&&(f.icon=e.hasClass("jstree-themeicon-hidden")?!1:e.attr("rel"));f.state.icon!==t&&(f.icon=f.state.icon);(f.icon===t||f.icon===null||f.icon==="")&&(f.icon=!0);e=i.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);return f.id=f.li_attr.id?f.li_attr.id.toString():c,e.length?(e.each(n.proxy(function(t,i){s=this._parse_model_from_html(n(i),f.id,u);h=this._model.data[s];f.children.push(s);h.children_d.length&&(f.children_d=f.children_d.concat(h.children_d))},this)),f.children_d=f.children_d.concat(f.children)):i.hasClass("jstree-closed")&&(f.state.loaded=!1),f.li_attr["class"]&&(f.li_attr["class"]=f.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),f.a_attr["class"]&&(f.a_attr["class"]=f.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),l[f.id]=f,f.state.selected&&this._data.core.selected.push(f.id),f.id},_parse_model_from_flat_json:function(n,i,r){r=r?r.concat():[];i&&r.unshift(i);var c=n.id.toString(),e=this._model.data,o=this._model.default_state,f,l,s,h,u={id:c,text:n.text||"",icon:n.icon!==t?n.icon:!0,parent:i,parents:r,children:n.children||[],children_d:n.children_d||[],data:n.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in o)o.hasOwnProperty(f)&&(u.state[f]=o[f]);if(n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(u.icon=n.data.jstree.icon),(u.icon===t||u.icon===null||u.icon==="")&&(u.icon=!0),n&&n.data&&(u.data=n.data,n.data.jstree))for(f in n.data.jstree)n.data.jstree.hasOwnProperty(f)&&(u.state[f]=n.data.jstree[f]);if(n&&typeof n.state=="object")for(f in n.state)n.state.hasOwnProperty(f)&&(u.state[f]=n.state[f]);if(n&&typeof n.li_attr=="object")for(f in n.li_attr)n.li_attr.hasOwnProperty(f)&&(u.li_attr[f]=n.li_attr[f]);if(u.li_attr.id||(u.li_attr.id=c),n&&typeof n.a_attr=="object")for(f in n.a_attr)n.a_attr.hasOwnProperty(f)&&(u.a_attr[f]=n.a_attr[f]);for(n&&n.children&&n.children===!0&&(u.state.loaded=!1,u.children=[],u.children_d=[]),e[u.id]=u,f=0,l=u.children.length;f<l;f++)s=this._parse_model_from_flat_json(e[u.children[f]],u.id,r),h=e[s],u.children_d.push(s),h.children_d.length&&(u.children_d=u.children_d.concat(h.children_d));return delete n.data,delete n.children,e[u.id].original=n,u.state.selected&&this._data.core.selected.push(u.id),u.id},_parse_model_from_json:function(n,i,r){r=r?r.concat():[];i&&r.unshift(i);var e=!1,f,l,o,s,h=this._model.data,c=this._model.default_state,u;do e="j"+this._id+"_"+ ++this._cnt;while(h[e]);u={id:!1,text:typeof n=="string"?n:"",icon:typeof n=="object"&&n.icon!==t?n.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in c)c.hasOwnProperty(f)&&(u.state[f]=c[f]);if(n&&n.id&&(u.id=n.id.toString()),n&&n.text&&(u.text=n.text),n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(u.icon=n.data.jstree.icon),(u.icon===t||u.icon===null||u.icon==="")&&(u.icon=!0),n&&n.data&&(u.data=n.data,n.data.jstree))for(f in n.data.jstree)n.data.jstree.hasOwnProperty(f)&&(u.state[f]=n.data.jstree[f]);if(n&&typeof n.state=="object")for(f in n.state)n.state.hasOwnProperty(f)&&(u.state[f]=n.state[f]);if(n&&typeof n.li_attr=="object")for(f in n.li_attr)n.li_attr.hasOwnProperty(f)&&(u.li_attr[f]=n.li_attr[f]);if(u.li_attr.id&&!u.id&&(u.id=u.li_attr.id.toString()),u.id||(u.id=e),u.li_attr.id||(u.li_attr.id=u.id),n&&typeof n.a_attr=="object")for(f in n.a_attr)n.a_attr.hasOwnProperty(f)&&(u.a_attr[f]=n.a_attr[f]);if(n&&n.children&&n.children.length){for(f=0,l=n.children.length;f<l;f++)o=this._parse_model_from_json(n.children[f],u.id,r),s=h[o],u.children.push(o),s.children_d.length&&(u.children_d=u.children_d.concat(s.children_d));u.children_d=u.children_d.concat(u.children)}return n&&n.children&&n.children===!0&&(u.state.loaded=!1,u.children=[],u.children_d=[]),delete n.data,delete n.children,u.original=n,h[u.id]=u,u.state.selected&&this._data.core.selected.push(u.id),u.id},_redraw:function(){for(var f=this._model.force_full_redraw?this._model.data[n.jstree.root].children.concat([]):this._model.changed.concat([]),r=i.createElement("UL"),t,o=this._data.core.focused,u=0,e=f.length;u<e;u++)t=this.redraw_node(f[u],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&r.appendChild(t);this._model.force_full_redraw&&(r.className=this.get_container_ul()[0].className,r.setAttribute("role","group"),this.element.empty().append(r));o!==null&&(t=this.get_node(o,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==i.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null);this._model.force_full_redraw=!1;this._model.changed=[];this.trigger("redraw",{nodes:f})},redraw:function(n){n&&(this._model.force_full_redraw=!0);this._redraw()},draw_children:function(t){var r=this.get_node(t),f=!1,e=!1,u=!1,o=i;if(!r)return!1;if(r.id===n.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for(u=o.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",f=0,e=r.children.length;f<e;f++)u.appendChild(this.redraw_node(r.children[f],!0,!0));t.appendChild(u)}},redraw_node:function(t,r,u,f){var e=this.get_node(t),s=!1,p=!1,b=!1,o=!1,c=!1,y=!1,l="",k=i,a=this._model.data,d=!1,v=null,g=0,nt=0,tt=!1,w=!1;if(!e)return!1;if(e.id===n.jstree.root)return this.redraw(!0);if(r=r||e.children.length===0,t=i.querySelector?this.element[0].querySelector("#"+("0123456789".indexOf(e.id[0])!==-1?"\\3"+e.id[0]+" "+e.id.substr(1).replace(n.jstree.idregex,"\\$&"):e.id.replace(n.jstree.idregex,"\\$&"))):i.getElementById(e.id),t)t=n(t),u||(s=t.parent().parent()[0],s===this.element[0]&&(s=null),p=t.index()),r||!e.children.length||t.children(".jstree-children").length||(r=!0),r||(b=t.children(".jstree-children")[0]),d=t.children(".jstree-anchor")[0]===i.activeElement,t.remove();else if(r=!0,!u){if(s=e.parent!==n.jstree.root?n("#"+e.parent.replace(n.jstree.idregex,"\\$&"),this.element)[0]:null,s!==null&&(!s||!a[e.parent].state.opened))return!1;p=n.inArray(e.id,s===null?a[n.jstree.root].children:a[e.parent].children)}t=h.cloneNode(!0);l="jstree-node ";for(o in e.li_attr)if(e.li_attr.hasOwnProperty(o)){if(o==="id")continue;o!=="class"?t.setAttribute(o,e.li_attr[o]):l+=e.li_attr[o]}for(e.a_attr.id||(e.a_attr.id=e.id+"_anchor"),t.setAttribute("aria-selected",!!e.state.selected),t.setAttribute("aria-level",e.parents.length),t.setAttribute("aria-labelledby",e.a_attr.id),e.state.disabled&&t.setAttribute("aria-disabled",!0),o=0,c=e.children.length;o<c;o++)if(!a[e.children[o]].state.hidden){tt=!0;break}if(e.parent!==null&&a[e.parent]&&!e.state.hidden&&(o=n.inArray(e.id,a[e.parent].children),w=e.id,o!==-1))for(o++,c=a[e.parent].children.length;o<c;o++)if(a[a[e.parent].children[o]].state.hidden||(w=a[e.parent].children[o]),w!==e.id)break;e.state.hidden&&(l+=" jstree-hidden");e.state.loaded&&!tt?l+=" jstree-leaf":(l+=e.state.opened&&e.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",e.state.opened&&e.state.loaded));w===e.id&&(l+=" jstree-last");t.id=e.id;t.className=l;l=(e.state.selected?" jstree-clicked":"")+(e.state.disabled?" jstree-disabled":"");for(c in e.a_attr)if(e.a_attr.hasOwnProperty(c)){if(c==="href"&&e.a_attr[c]==="#")continue;c!=="class"?t.childNodes[1].setAttribute(c,e.a_attr[c]):l+=" "+e.a_attr[c]}if(l.length&&(t.childNodes[1].className="jstree-anchor "+l),(e.icon&&e.icon!==!0||e.icon===!1)&&(e.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":e.icon.indexOf("/")===-1&&e.icon.indexOf(".")===-1?t.childNodes[1].childNodes[0].className+=" "+e.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+e.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(k.createTextNode(e.text)):t.childNodes[1].innerHTML+=e.text,r&&e.children.length&&(e.state.opened||f)&&e.state.loaded){for(y=k.createElement("UL"),y.setAttribute("role","group"),y.className="jstree-children",o=0,c=e.children.length;o<c;o++)y.appendChild(this.redraw_node(e.children[o],r,!0));t.appendChild(y)}if(b&&t.appendChild(b),!u){for(s||(s=this.element[0]),o=0,c=s.childNodes.length;o<c;o++)if(s.childNodes[o]&&s.childNodes[o].className&&s.childNodes[o].className.indexOf("jstree-children")!==-1){v=s.childNodes[o];break}v||(v=k.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",s.appendChild(v));s=v;p<s.childNodes.length?s.insertBefore(t,s.childNodes[p]):s.appendChild(t);d&&(g=this.element[0].scrollTop,nt=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=g,this.element[0].scrollLeft=nt)}return e.state.opened&&!e.state.loaded&&(e.state.opened=!1,setTimeout(n.proxy(function(){this.open_node(e.id,!1,0)},this),0)),t},open_node:function(i,r,u){var e,o,f,s;if(n.isArray(i)){for(i=i.slice(),e=0,o=i.length;e<o;e++)this.open_node(i[e],r,u);return!0}if(i=this.get_node(i),!i||i.id===n.jstree.root)return!1;if(u=u===t?this.settings.core.animation:u,!this.is_closed(i))return r&&r.call(this,i,!1),!1;if(this.is_loaded(i))return f=this.get_node(i,!0),s=this,f.length&&(u&&f.children(".jstree-children").length&&f.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(f.children(".jstree-children")[0])&&this.draw_children(i),u?(this.trigger("before_open",{node:i}),f.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(u,function(){this.style.display="";s.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),f[0].className=f[0].className.replace("jstree-closed","jstree-open"),f[0].setAttribute("aria-expanded",!0))),i.state.opened=!0,r&&r.call(this,i,!0),f.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),u&&f.length||this.trigger("after_open",{node:i}),!0;if(this.is_loading(i))return setTimeout(n.proxy(function(){this.open_node(i,r,u)},this),500);this.load_node(i,function(n,t){return t?this.open_node(n,r,u):r?r.call(this,n,!1):!1})},_open_to:function(t){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;for(var u=t.parents,i=0,r=u.length;i<r;i+=1)i!==n.jstree.root&&this.open_node(u[i],!1,0);return n("#"+t.id.replace(n.jstree.idregex,"\\$&"),this.element)},close_node:function(i,r){var f,e,o,u;if(n.isArray(i)){for(i=i.slice(),f=0,e=i.length;f<e;f++)this.close_node(i[f],r);return!0}if((i=this.get_node(i),!i||i.id===n.jstree.root)||this.is_closed(i))return!1;r=r===t?this.settings.core.animation:r;o=this;u=this.get_node(i,!0);u.length&&(r?u.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="";u.children(".jstree-children").remove();o.trigger("after_close",{node:i})}):(u[0].className=u[0].className.replace("jstree-open","jstree-closed"),u.attr("aria-expanded",!1).children(".jstree-children").remove()));i.state.opened=!1;this.trigger("close_node",{node:i});r&&u.length||this.trigger("after_close",{node:i})},toggle_node:function(t){var i,r;if(n.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,r){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var u=t.id===n.jstree.root?this.get_container_ul():this.get_node(t,!0),f,e,o;if(!u.length){for(f=0,e=t.children_d.length;f<e;f++)this.is_closed(this._model.data[t.children_d[f]])&&(this._model.data[t.children_d[f]].state.opened=!0);return this.trigger("open_all",{node:t})}r=r||u;o=this;u=this.is_closed(t)?u.find(".jstree-closed").addBack():u.find(".jstree-closed");u.each(function(){o.open_node(this,function(n,t){t&&this.is_parent(n)&&this.open_all(n,i,r)},i||0)});r.find(".jstree-closed").length===0&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(t,i){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var r=t.id===n.jstree.root?this.get_container_ul():this.get_node(t,!0),e=this,u,f;for(r.length&&(r=this.is_open(t)?r.find(".jstree-open").addBack():r.find(".jstree-open"),n(r.get().reverse()).each(function(){e.close_node(this,i||0)})),u=0,f=t.children_d.length;u<f;u++)this._model.data[t.children_d[u]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(n){return n=this.get_node(n),n&&n.state&&n.state.disabled},enable_node:function(t){var i,r;if(n.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.enable_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;t.state.disabled=!1;this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1);this.trigger("enable_node",{node:t})},disable_node:function(t){var i,r;if(n.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.disable_node(t[i]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;t.state.disabled=!0;this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0);this.trigger("disable_node",{node:t})},hide_node:function(t,i){var r,u;if(n.isArray(t)){for(t=t.slice(),r=0,u=t.length;r<u;r++)this.hide_node(t[r],!0);return this.redraw(),!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,i){var r,u;if(n.isArray(t)){for(t=t.slice(),r=0,u=t.length;r<u;r++)this.show_node(t[r],!0);return this.redraw(),!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var i,r=this._model.data,u=[];for(i in r)r.hasOwnProperty(i)&&i!==n.jstree.root&&!r[i].state.hidden&&(r[i].state.hidden=!0,u.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:u}),u},show_all:function(t){var i,r=this._model.data,u=[];for(i in r)r.hasOwnProperty(i)&&i!==n.jstree.root&&r[i].state.hidden&&(r[i].state.hidden=!1,u.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:u}),u},activate_node:function(n,i){if(this.is_disabled(n))return!1;if(i&&typeof i=="object"||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(n)&&this.get_parent(n)===this._data.core.last_clicked.parent))if(i.shiftKey){for(var e=this.get_node(n).id,o=this._data.core.last_clicked.id,u=this.get_node(this._data.core.last_clicked.parent).children,f=!1,r=0,s=u.length;r<s;r+=1)u[r]===e&&(f=!f),u[r]===o&&(f=!f),!this.is_disabled(u[r])&&(f||u[r]===e||u[r]===o)?this.select_node(u[r],!0,!1,i):this.deselect_node(u[r],!0,i);this.trigger("changed",{action:"select_node",node:this.get_node(n),selected:this._data.core.selected,event:i})}else this.is_selected(n)?this.deselect_node(n,!1,i):this.select_node(n,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(n)?this.deselect_node(n,!1,i):(this.deselect_all(!0),this.select_node(n,!1,!1,i),this._data.core.last_clicked=this.get_node(n));this.trigger("activate_node",{node:this.get_node(n),event:i})},hover_node:function(n){if(n=this.get_node(n,!0),!n||!n.length||n.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t);n.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(n)});setTimeout(function(){i.attr("aria-activedescendant",n[0].id)},0)},dehover_node:function(n){if(n=this.get_node(n,!0),!n||!n.length||!n.children(".jstree-hovered").length)return!1;n.children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{node:this.get_node(n)})},select_node:function(t,i,r,u){var f,e,o;if(n.isArray(t)){for(t=t.slice(),e=0,o=t.length;e<o;e++)this.select_node(t[e],i,r,u);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;f=this.get_node(t,!0);t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),r||(f=this._open_to(t)),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:u}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:u}))},deselect_node:function(t,i,r){var u,e,f;if(n.isArray(t)){for(t=t.slice(),u=0,e=t.length;u<e;u++)this.deselect_node(t[u],i,r);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;f=this.get_node(t,!0);t.state.selected&&(t.state.selected=!1,this._data.core.selected=n.vakata.array_remove_item(this._data.core.selected,t.id),f.length&&f.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r}))},select_all:function(t){var u=this._data.core.selected.concat([]),i,r;for(this._data.core.selected=this._model.data[n.jstree.root].children_d.concat(),i=0,r=this._data.core.selected.length;i<r;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0);this.trigger("select_all",{selected:this._data.core.selected});t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:u})},deselect_all:function(n){for(var i=this._data.core.selected.concat([]),t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1);this.trigger("deselect_all",{selected:this._data.core.selected,node:i});n||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return(t=this.get_node(t),!t||t.id===n.jstree.root)?!1:t.state.selected},get_selected:function(t){return t?n.map(this._data.core.selected,n.proxy(function(n){return this.get_node(n)},this)):this._data.core.selected.slice()},get_top_selected:function(t){for(var r=this.get_selected(!0),u={},f,o,i=0,e=r.length;i<e;i++)u[r[i].id]=r[i];for(i=0,e=r.length;i<e;i++)for(f=0,o=r[i].children_d.length;f<o;f++)u[r[i].children_d[f]]&&delete u[r[i].children_d[f]];r=[];for(i in u)u.hasOwnProperty(i)&&r.push(i);return t?n.map(r,n.proxy(function(n){return this.get_node(n)},this)):r},get_bottom_selected:function(t){for(var r=this.get_selected(!0),u=[],i=0,f=r.length;i<f;i++)r[i].children.length||u.push(r[i].id);return t?n.map(u,n.proxy(function(n){return this.get_node(n)},this)):u},get_state:function(){var i={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(var t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==n.jstree.root&&(this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,r){if(i){if(i.core){var f,u;if(i.core.open)return n.isArray(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(n){this.open_node(n,!1,0);delete i.core.open;this.set_state(i,r)},!0):(delete i.core.open,this.set_state(i,r)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,r),!1;if(i.core.selected)return f=this,this.deselect_all(),n.each(i.core.selected,function(n,t){f.select_node(t,!1,!0)}),delete i.core.selected,this.set_state(i,r),!1;for(u in i)i.hasOwnProperty(u)&&u!=="core"&&n.inArray(u,this.settings.plugins)===-1&&delete i[u];if(n.isEmptyObject(i.core))return delete i.core,this.set_state(i,r),!1}return n.isEmptyObject(i)?(i=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state();i&&n.isFunction(i)&&(this._data.core.state=i.call(this,this._data.core.state));this._cnt=0;this._model.data={};this._model.data[n.jstree.root]={id:n.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var r=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"));this.load_node(n.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(n.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")}));this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;var i=[],r=[],u=this._data.core.selected.concat([]);r.push(t.id);t.state.opened===!0&&i.push(t.id);this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)});this._load_nodes(r,n.proxy(function(n){this.open_node(i,!1,0);this.select_node(this._data.core.selected);this.trigger("refresh_node",{node:t,nodes:n})},this))},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;var r,f,u=this._model.data;for(i=i.toString(),u[t.parent].children[n.inArray(t.id,u[t.parent].children)]=i,r=0,f=t.parents.length;r<f;r++)u[t.parents[r]].children_d[n.inArray(t.id,u[t.parents[r]].children_d)]=i;for(r=0,f=t.children.length;r<f;r++)u[t.children[r]].parent=i;for(r=0,f=t.children_d.length;r<f;r++)u[t.children_d[r]].parents[n.inArray(t.id,u[t.children_d[r]].parents)]=i;return r=n.inArray(t.id,this._data.core.selected),r!==-1&&(this._data.core.selected[r]=i),r=this.get_node(t.id,!0),r&&(r.attr("id",i).children(".jstree-anchor").attr("id",i+"_anchor").end().attr("aria-labelledby",i+"_anchor"),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete u[t.id],t.id=i,t.li_attr.id=i,u[i]=t,!0},get_text:function(t){return t=this.get_node(t),!t||t.id===n.jstree.root?!1:t.text},set_text:function(t,i){var r,u;if(n.isArray(t)){for(t=t.slice(),r=0,u=t.length;r<u;r++)this.set_text(t[r],i);return!0}return(t=this.get_node(t),!t||t.id===n.jstree.root)?!1:(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0)},get_json:function(t,i,r){if(t=this.get_node(t||n.jstree.root),!t)return!1;i&&i.flat&&!r&&(r=[]);var u={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:n.extend(!0,{},t.li_attr),a_attr:n.extend(!0,{},t.a_attr),state:{},data:i&&i.no_data?!1:n.extend(!0,{},t.data)},f,e;if(i&&i.flat?u.parent=t.parent:u.children=[],!i||!i.no_state)for(f in t.state)t.state.hasOwnProperty(f)&&(u.state[f]=t.state[f]);if(i&&i.no_id&&(delete u.id,u.li_attr&&u.li_attr.id&&delete u.li_attr.id,u.a_attr&&u.a_attr.id&&delete u.a_attr.id),i&&i.flat&&t.id!==n.jstree.root&&r.push(u),!i||!i.no_children)for(f=0,e=t.children.length;f<e;f++)i&&i.flat?this.get_json(t.children[f],i,r):u.children.push(this.get_json(t.children[f],i));return i&&i.flat?r:t.id===n.jstree.root?u.children:u},create_node:function(i,r,u,f,e){if(i===null&&(i=n.jstree.root),i=this.get_node(i),!i)return!1;if(u=u===t?"last":u,!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,r,u,f,!0)});r||(r={text:this.get_string("New node")});typeof r=="string"&&(r={text:r});r.text===t&&(r.text=this.get_string("New node"));var o,h,s,c;i.id===n.jstree.root&&(u==="before"&&(u="first"),u==="after"&&(u="last"));switch(u){case"before":o=this.get_node(i.parent);u=n.inArray(i.id,o.children);i=o;break;case"after":o=this.get_node(i.parent);u=n.inArray(i.id,o.children)+1;i=o;break;case"inside":case"first":u=0;break;case"last":u=i.children.length;break;default:u||(u=0)}if(u>i.children.length&&(u=i.children.length),r.id||(r.id=!0),!this.check("create_node",r,i,u))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,i.id,i.parents.concat()),!r)return!1;for(o=this.get_node(r),h=[],h.push(r),h=h.concat(o.children_d),this.trigger("model",{nodes:h,parent:i.id}),i.children_d=i.children_d.concat(h),s=0,c=i.parents.length;s<c;s++)this._model.data[i.parents[s]].children_d=this._model.data[i.parents[s]].children_d.concat(h);for(r=o,o=[],s=0,c=i.children.length;s<c;s++)o[s>=u?s+1:s]=i.children[s];return o[u]=r.id,i.children=o,this.redraw_node(i,!0),f&&f.call(this,this.get_node(r)),this.trigger("create_node",{node:this.get_node(r),parent:i.id,position:u}),r.id},rename_node:function(t,i){var r,u,f;if(n.isArray(t)){for(t=t.slice(),r=0,u=t.length;r<u;r++)this.rename_node(t[r],i);return!0}return(t=this.get_node(t),!t||t.id===n.jstree.root)?!1:(f=t.text,!this.check("rename_node",t,this.get_parent(t),i))?(this.settings.core.error.call(this,this._data.core.last_error),!1):(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:f}),!0)},delete_node:function(t){var o,c,i,r,f,e,l,u,s,h,a,v;if(n.isArray(t)){for(t=t.slice(),o=0,c=t.length;o<c;o++)this.delete_node(t[o]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;if(i=this.get_node(t.parent),r=n.inArray(t.id,i.children),h=!1,!this.check("delete_node",t,i,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(r!==-1&&(i.children=n.vakata.array_remove(i.children,r)),f=t.children_d.concat([]),f.push(t.id),u=0,s=f.length;u<s;u++){for(e=0,l=t.parents.length;e<l;e++)r=n.inArray(f[u],this._model.data[t.parents[e]].children_d),r!==-1&&(this._model.data[t.parents[e]].children_d=n.vakata.array_remove(this._model.data[t.parents[e]].children_d,r));this._model.data[f[u]].state.selected&&(h=!0,r=n.inArray(f[u],this._data.core.selected),r!==-1&&(this._data.core.selected=n.vakata.array_remove(this._data.core.selected,r)))}for(this.trigger("delete_node",{node:t,parent:i.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:i.id}),u=0,s=f.length;u<s;u++)delete this._model.data[f[u]];return n.inArray(this._data.core.focused,f)!==-1&&(this._data.core.focused=null,a=this.element[0].scrollTop,v=this.element[0].scrollLeft,i.id===n.jstree.root?this.get_node(this._model.data[n.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(i,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=a,this.element[0].scrollLeft=v),this.redraw_node(i,!0),!0},check:function(t,i,r,u,f){i=i&&i.id?i:this.get_node(i);r=r&&r.id?r:this.get_node(r);var e=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;return(t==="move_node"||t==="copy_node")&&(!f||!f.is_multi)&&(i.id===r.id||n.inArray(i.id,r.children)===u||n.inArray(r.id,i.children_d)!==-1)?(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1):(e&&e.data&&(e=e.data),e&&e.functions&&(e.functions[t]===!1||e.functions[t]===!0))?(e.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),e.functions[t]):o===!1||n.isFunction(o)&&o.call(this,t,i,r,u,f)===!1||o&&o[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1):!0},last_error:function(){return this._data.core.last_error},move_node:function(i,r,u,f,e,o,s){var k,d,y,g,l,c,nt,v,a,h,p,b,tt,w;if(r=this.get_node(r),u=u===t?0:u,!r)return!1;if(!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(i,r,u,f,!0,!1,s)});if(n.isArray(i))if(i.length===1)i=i[0];else{for(k=0,d=i.length;k<d;k++)(a=this.move_node(i[k],r,u,f,e,!1,s))&&(r=a,u="after");return this.redraw(),!0}if(i=i&&i.id?i:this.get_node(i),!i||i.id===n.jstree.root)return!1;if(y=(i.parent||n.jstree.root).toString(),l=!u.toString().match(/^(before|after)$/)||r.id===n.jstree.root?r:this.get_node(r.parent),c=s?s:this._model.data[i.id]?this:n.jstree.reference(i.id),nt=!c||!c._id||this._id!==c._id,g=c&&c._id&&y&&c._model.data[y]&&c._model.data[y].children?n.inArray(i.id,c._model.data[y].children):-1,c&&c._id&&(i=c._model.data[i.id]),nt)return(a=this.copy_node(i,r,u,f,e,!1,s))?(c&&c.delete_node(i),a):!1;r.id===n.jstree.root&&(u==="before"&&(u="first"),u==="after"&&(u="last"));switch(u){case"before":u=n.inArray(r.id,l.children);break;case"after":u=n.inArray(r.id,l.children)+1;break;case"inside":case"first":u=0;break;case"last":u=l.children.length;break;default:u||(u=0)}if(u>l.children.length&&(u=l.children.length),!this.check("move_node",i,l,u,{core:!0,origin:s,is_multi:c&&c._id&&c._id!==this._id,is_foreign:!c||!c._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===l.id){for(v=l.children.concat(),a=n.inArray(i.id,v),a!==-1&&(v=n.vakata.array_remove(v,a),u>a&&u--),a=[],h=0,p=v.length;h<p;h++)a[h>=u?h+1:h]=v[h];a[u]=i.id;l.children=a;this._node_changed(l.id);this.redraw(l.id===n.jstree.root)}else{for(a=i.children_d.concat(),a.push(i.id),h=0,p=i.parents.length;h<p;h++){for(v=[],w=c._model.data[i.parents[h]].children_d,b=0,tt=w.length;b<tt;b++)n.inArray(w[b],a)===-1&&v.push(w[b]);c._model.data[i.parents[h]].children_d=v}for(c._model.data[y].children=n.vakata.array_remove_item(c._model.data[y].children,i.id),h=0,p=l.parents.length;h<p;h++)this._model.data[l.parents[h]].children_d=this._model.data[l.parents[h]].children_d.concat(a);for(v=[],h=0,p=l.children.length;h<p;h++)v[h>=u?h+1:h]=l.children[h];for(v[u]=i.id,l.children=v,l.children_d.push(i.id),l.children_d=l.children_d.concat(i.children_d),i.parent=l.id,a=l.parents.concat(),a.unshift(l.id),w=i.parents.length,i.parents=a,a=a.concat(),h=0,p=i.children_d.length;h<p;h++)this._model.data[i.children_d[h]].parents=this._model.data[i.children_d[h]].parents.slice(0,w*-1),Array.prototype.push.apply(this._model.data[i.children_d[h]].parents,a);(y===n.jstree.root||l.id===n.jstree.root)&&(this._model.force_full_redraw=!0);this._model.force_full_redraw||(this._node_changed(y),this._node_changed(l.id));o||this.redraw()}return f&&f.call(this,i,l,u),this.trigger("move_node",{node:i,parent:l.id,position:u,old_parent:y,old_position:g,is_multi:c&&c._id&&c._id!==this._id,is_foreign:!c||!c._id,old_instance:c,new_instance:this}),i.id},copy_node:function(i,r,u,f,e,o,s){var w,k,v,a,l,b,y,p,c,h,d;if(r=this.get_node(r),u=u===t?0:u,!r)return!1;if(!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(i,r,u,f,!0,!1,s)});if(n.isArray(i))if(i.length===1)i=i[0];else{for(w=0,k=i.length;w<k;w++)(a=this.copy_node(i[w],r,u,f,e,!0,s))&&(r=a,u="after");return this.redraw(),!0}if(i=i&&i.id?i:this.get_node(i),!i||i.id===n.jstree.root)return!1;p=(i.parent||n.jstree.root).toString();c=!u.toString().match(/^(before|after)$/)||r.id===n.jstree.root?r:this.get_node(r.parent);h=s?s:this._model.data[i.id]?this:n.jstree.reference(i.id);d=!h||!h._id||this._id!==h._id;h&&h._id&&(i=h._model.data[i.id]);r.id===n.jstree.root&&(u==="before"&&(u="first"),u==="after"&&(u="last"));switch(u){case"before":u=n.inArray(r.id,c.children);break;case"after":u=n.inArray(r.id,c.children)+1;break;case"inside":case"first":u=0;break;case"last":u=c.children.length;break;default:u||(u=0)}if(u>c.children.length&&(u=c.children.length),!this.check("copy_node",i,c,u,{core:!0,origin:s,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if((y=h?h.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!y)||(y.id===!0&&delete y.id,y=this._parse_model_from_json(y,c.id,c.parents.concat()),!y))return!1;for(a=this.get_node(y),i&&i.state&&i.state.loaded===!1&&(a.state.loaded=!1),v=[],v.push(y),v=v.concat(a.children_d),this.trigger("model",{nodes:v,parent:c.id}),l=0,b=c.parents.length;l<b;l++)this._model.data[c.parents[l]].children_d=this._model.data[c.parents[l]].children_d.concat(v);for(v=[],l=0,b=c.children.length;l<b;l++)v[l>=u?l+1:l]=c.children[l];return v[u]=a.id,c.children=v,c.children_d.push(a.id),c.children_d=c.children_d.concat(a.children_d),c.id===n.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(c.id),o||this.redraw(c.id===n.jstree.root),f&&f.call(this,a,c,u),this.trigger("copy_node",{node:a,original:i,parent:c.id,position:u,old_parent:p,old_position:h&&h._id&&p&&h._model.data[p]&&h._model.data[p].children?n.inArray(i.id,h._model.data[p].children):-1,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id,old_instance:h,new_instance:this}),a.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),n.isArray(t)||(t=[t]),!t.length)return!1;for(var o=[],i,r=0,s=t.length;r<s;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==n.jstree.root&&o.push(i);if(!o.length)return!1;f=o;e=this;u="move_node";this.trigger("cut",{node:t})},copy:function(t){if(t||(t=this._data.core.selected.concat()),n.isArray(t)||(t=[t]),!t.length)return!1;for(var o=[],i,r=0,s=t.length;r<s;r++)i=this.get_node(t[r]),i&&i.id&&i.id!==n.jstree.root&&o.push(i);if(!o.length)return!1;f=o;e=this;u="copy_node";this.trigger("copy",{node:t})},get_buffer:function(){return{mode:u,node:f,inst:e}},can_paste:function(){return u!==!1&&f!==!1},paste:function(n,t){if(n=this.get_node(n),!n||!u||!u.match(/^(copy_node|move_node)$/)||!f)return!1;this[u](f,n,t,!1,!1,!1,e)&&this.trigger("paste",{parent:n.id,node:f,mode:u});f=!1;u=!1;e=!1},clear_buffer:function(){f=!1;u=!1;e=!1;this.trigger("clear_buffer")},edit:function(t,i,r){var a,c,u,o,f,s,h,l,e,v=!1;if(t=this.get_node(t),!t)return!1;if(this.settings.core.check_callback===!1)return this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1;e=t;i=typeof i=="string"?i:t.text;this.set_text(t,"");t=this._open_to(t);e.text=i;a=this._data.core.rtl;c=this.element.width();this._data.core.focused=e.id;u=t.children(".jstree-anchor").focus();o=n("<span>");
/*!
			oi = obj.children("i:visible"),
			ai = a.children("i:visible"),
			w1 = oi.width() * oi.length,
			w2 = ai.width() * ai.length,
			*/
f=i;s=n("<div />",{css:{position:"absolute",top:"-200px",left:a?"0px":"-1000px",visibility:"hidden"}}).appendTo("body");h=n("<input />",{value:f,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:n.proxy(function(i){i.stopImmediatePropagation();i.preventDefault();var a=o.children(".jstree-rename-input"),h=a.val(),l=this.settings.core.force_text,c;h===""&&(h=f);s.remove();o.replaceWith(u);o.remove();f=l?f:n("<div><\/div>").append(n.parseHTML(f)).html();this.set_text(t,f);c=!!this.rename_node(t,l?n("<div><\/div>").text(h).text():n("<div><\/div>").append(n.parseHTML(h)).html());c||this.set_text(t,f);this._data.core.focused=e.id;setTimeout(n.proxy(function(){var n=this.get_node(e.id,!0);n.length&&(this._data.core.focused=e.id,n.children(".jstree-anchor").focus())},this),0);r&&r.call(this,e,c,v)},this),keydown:function(n){var t=n.which;t===27&&(v=!0,this.value=f);(t===27||t===13||t===37||t===38||t===39||t===40||t===32)&&n.stopImmediatePropagation();(t===27||t===13)&&(n.preventDefault(),this.blur())},click:function(n){n.stopImmediatePropagation()},mousedown:function(n){n.stopImmediatePropagation()},keyup:function(){h.width(Math.min(s.text("pW"+this.value).width(),c))},keypress:function(n){if(n.which===13)return!1}});l={fontFamily:u.css("fontFamily")||"",fontSize:u.css("fontSize")||"",fontWeight:u.css("fontWeight")||"",fontStyle:u.css("fontStyle")||"",fontStretch:u.css("fontStretch")||"",fontVariant:u.css("fontVariant")||"",letterSpacing:u.css("letterSpacing")||"",wordSpacing:u.css("wordSpacing")||""};o.attr("class",u.attr("class")).append(u.contents().clone()).append(h);u.replaceWith(o);s.css(l);h.css(l).width(Math.min(s.text("pW"+h[0].value).width(),c))[0].select()},set_theme:function(t,i){if(!t)return!1;if(i===!0){var r=this.settings.core.themes.dir;r||(r=n.jstree.path+"/themes");i=r+"/"+t+"/style.css"}i&&n.inArray(i,y)===-1&&(n("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),y.push(i));this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name);this._data.core.themes.name=t;this.element.addClass("jstree-"+t);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive");this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(n){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant);this._data.core.themes.variant=n;n&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(i,r){var e,o,f,u;if(n.isArray(i)){for(i=i.slice(),e=0,o=i.length;e<o;e++)this.set_icon(i[e],r);return!0}return(i=this.get_node(i),!i||i.id===n.jstree.root)?!1:(u=i.icon,i.icon=r===!0||r===null||r===t||r===""?!0:r,f=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),r===!1?this.hide_icon(i):r===!0||r===null||r===t||r===""?(f.removeClass("jstree-themeicon-custom "+u).css("background","").removeAttr("rel"),u===!1&&this.show_icon(i)):r.indexOf("/")===-1&&r.indexOf(".")===-1?(f.removeClass(u).css("background",""),f.addClass(r+" jstree-themeicon-custom").attr("rel",r),u===!1&&this.show_icon(i)):(f.removeClass(u).css("background",""),f.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r),u===!1&&this.show_icon(i)),!0)},get_icon:function(t){return t=this.get_node(t),!t||t.id===n.jstree.root?!1:t.icon},hide_icon:function(t){var i,r;if(n.isArray(t)){for(t=t.slice(),i=0,r=t.length;i<r;i++)this.hide_icon(t[i]);return!0}return(t=this.get_node(t),!t||t===n.jstree.root)?!1:(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var i,u,r;if(n.isArray(t)){for(t=t.slice(),i=0,u=t.length;i<u;i++)this.show_icon(t[i]);return!0}return(t=this.get_node(t),!t||t===n.jstree.root)?!1:(r=this.get_node(t,!0),t.icon=r.length?r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},n.vakata={},n.vakata.attributes=function(t,i){t=n(t)[0];var r=i?{}:[];return t&&t.attributes&&n.each(t.attributes,function(t,u){n.inArray(u.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])===-1&&u.value!==null&&n.trim(u.value)!==""&&(i?r[u.name]=u.value:r.push(u.name))}),r},n.vakata.array_unique=function(n){for(var r=[],f={},i=0,u=n.length;i<u;i++)f[n[i]]===t&&(r.push(n[i]),f[n[i]]=!0);return r},n.vakata.array_remove=function(n,t,i){var r=n.slice((i||t)+1||n.length);return n.length=t<0?n.length+t:t,n.push.apply(n,r),n},n.vakata.array_remove_item=function(t,i){var r=n.inArray(i,t);return r!==-1?n.vakata.array_remove(t,r):t},n.jstree.plugins.changed=function(n,t){var i=[];this.trigger=function(n,r){var u,f,e;if(r||(r={}),n.replace(".jstree","")==="changed"){for(r.changed={selected:[],deselected:[]},e={},u=0,f=i.length;u<f;u++)e[i[u]]=1;for(u=0,f=r.selected.length;u<f;u++)e[r.selected[u]]?e[r.selected[u]]=2:r.changed.selected.push(r.selected[u]);for(u=0,f=i.length;u<f;u++)e[i[u]]===1&&r.changed.deselected.push(i[u]);i=r.selected.slice()}t.trigger.call(this,n,r)};this.refresh=function(){return i=[],t.refresh.apply(this,arguments)}},c=i.createElement("I"),c.className="jstree-icon jstree-checkbox",c.setAttribute("role","presentation"),n.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},n.jstree.plugins.checkbox=function(i,r){this.bind=function(){r.bind.call(this);this._data.checkbox.uto=!1;this._data.checkbox.selected=[];this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined");this.element.on("init.jstree",n.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked");this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",n.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1)this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",n.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto);this._data.checkbox.uto=setTimeout(n.proxy(this._undetermined,this),50)},this));if(!this.settings.checkbox.tie_selection)this.element.on("model.jstree",n.proxy(function(n,t){for(var u=this._model.data,e=u[t.parent],r=t.nodes,i=0,f=r.length;i<f;i++)u[r[i]].state.checked=u[r[i]].state.checked||u[r[i]].original&&u[r[i]].original.state&&u[r[i]].original.state.checked,u[r[i]].state.checked&&this._data.checkbox.selected.push(r[i])},this));if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1)this.element.on("model.jstree",n.proxy(function(t,i){var e=this._model.data,u=e[i.parent],s=i.nodes,c=[],v,r,o,h,l,a,y=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection;if(y.indexOf("down")!==-1)if(u.state[f?"selected":"checked"]){for(r=0,o=s.length;r<o;r++)e[s[r]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(s)}else for(r=0,o=s.length;r<o;r++)if(e[s[r]].state[f?"selected":"checked"]){for(h=0,l=e[s[r]].children_d.length;h<l;h++)e[e[s[r]].children_d[h]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(e[s[r]].children_d)}if(y.indexOf("up")!==-1){for(r=0,o=u.children_d.length;r<o;r++)e[u.children_d[r]].children.length||c.push(e[u.children_d[r]].parent);for(c=n.vakata.array_unique(c),h=0,l=c.length;h<l;h++)for(u=e[c[h]];u&&u.id!==n.jstree.root;){for(v=0,r=0,o=u.children.length;r<o;r++)v+=e[u.children[r]].state[f?"selected":"checked"];if(v===o)u.state[f?"selected":"checked"]=!0,this._data[f?"core":"checkbox"].selected.push(u.id),a=this.get_node(u,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(f?"jstree-clicked":"jstree-checked");else break;u=this.get_node(u.parent)}}this._data[f?"core":"checkbox"].selected=n.vakata.array_unique(this._data[f?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",n.proxy(function(t,i){var o=i.node,l=this._model.data,u=this.get_node(o.parent),a=this.get_node(o,!0),f,s,h,r,c=this.settings.checkbox.cascade,e=this.settings.checkbox.tie_selection;if(c.indexOf("down")!==-1)for(this._data[e?"core":"checkbox"].selected=n.vakata.array_unique(this._data[e?"core":"checkbox"].selected.concat(o.children_d)),f=0,s=o.children_d.length;f<s;f++)r=l[o.children_d[f]],r.state[e?"selected":"checked"]=!0,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1);if(c.indexOf("up")!==-1)while(u&&u.id!==n.jstree.root){for(h=0,f=0,s=u.children.length;f<s;f++)h+=l[u.children[f]].state[e?"selected":"checked"];if(h===s)u.state[e?"selected":"checked"]=!0,this._data[e?"core":"checkbox"].selected.push(u.id),r=this.get_node(u,!0),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass(e?"jstree-clicked":"jstree-checked");else break;u=this.get_node(u.parent)}c.indexOf("down")!==-1&&a.length&&a.find(".jstree-anchor").addClass(e?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",n.proxy(function(){for(var r=this.get_node(n.jstree.root),f=this._model.data,t,i=0,u=r.children_d.length;i<u;i++)t=f[r.children_d[i]],t&&t.original&&t.original.state&&t.original.state.undetermined&&(t.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",n.proxy(function(t,i){var f=i.node,h=this.get_node(f,!0),u,o,r,s=this.settings.checkbox.cascade,e=this.settings.checkbox.tie_selection;if(f&&f.original&&f.original.state&&f.original.state.undetermined&&(f.original.state.undetermined=!1),s.indexOf("down")!==-1)for(u=0,o=f.children_d.length;u<o;u++)r=this._model.data[f.children_d[u]],r.state[e?"selected":"checked"]=!1,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1);if(s.indexOf("up")!==-1)for(u=0,o=f.parents.length;u<o;u++)r=this._model.data[f.parents[u]],r.state[e?"selected":"checked"]=!1,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1),r=this.get_node(f.parents[u],!0),r&&r.length&&r.attr("aria-selected",!1).children(".jstree-anchor").removeClass(e?"jstree-clicked":"jstree-checked");for(r=[],u=0,o=this._data[e?"core":"checkbox"].selected.length;u<o;u++)(s.indexOf("down")===-1||n.inArray(this._data[e?"core":"checkbox"].selected[u],f.children_d)===-1)&&(s.indexOf("up")===-1||n.inArray(this._data[e?"core":"checkbox"].selected[u],f.parents)===-1)&&r.push(this._data[e?"core":"checkbox"].selected[u]);this._data[e?"core":"checkbox"].selected=n.vakata.array_unique(r);s.indexOf("down")!==-1&&h.length&&h.find(".jstree-anchor").removeClass(e?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this));if(this.settings.checkbox.cascade.indexOf("up")!==-1)this.element.on("delete_node.jstree",n.proxy(function(t,i){for(var r=this.get_node(i.parent),h=this._model.data,f,e,s,o,u=this.settings.checkbox.tie_selection;r&&r.id!==n.jstree.root&&!r.state[u?"selected":"checked"];){for(s=0,f=0,e=r.children.length;f<e;f++)s+=h[r.children[f]].state[u?"selected":"checked"];if(e>0&&s===e)r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),o=this.get_node(r,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked");else break;r=this.get_node(r.parent)}},this)).on("move_node.jstree",n.proxy(function(t,i){var c=i.is_multi,l=i.old_parent,a=this.get_node(i.parent),h=this._model.data,r,s,e,o,f,u=this.settings.checkbox.tie_selection;if(!c)for(r=this.get_node(l);r&&r.id!==n.jstree.root&&!r.state[u?"selected":"checked"];){for(s=0,e=0,o=r.children.length;e<o;e++)s+=h[r.children[e]].state[u?"selected":"checked"];if(o>0&&s===o)r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),f=this.get_node(r,!0),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked");else break;r=this.get_node(r.parent)}for(r=a;r&&r.id!==n.jstree.root;){for(s=0,e=0,o=r.children.length;e<o;e++)s+=h[r.children[e]].state[u?"selected":"checked"];if(s===o)r.state[u?"selected":"checked"]||(r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),f=this.get_node(r,!0),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else if(r.state[u?"selected":"checked"])r.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=n.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,r.id),f=this.get_node(r,!0),f&&f.length&&f.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked");else break;r=this.get_node(r.parent)}},this))};this._undetermined=function(){if(this.element!==null){for(var i,h,f={},e=this._model.data,c=this.settings.checkbox.tie_selection,u=this._data[c?"core":"checkbox"].selected,o=[],l=this,r=0,s=u.length;r<s;r++)if(e[u[r]]&&e[u[r]].parents)for(i=0,h=e[u[r]].parents.length;i<h;i++)f[e[u[r]].parents[i]]===t&&e[u[r]].parents[i]!==n.jstree.root&&(f[e[u[r]].parents[i]]=!0,o.push(e[u[r]].parents[i]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var u=l.get_node(this),c;if(u.state.loaded){for(r=0,s=u.children_d.length;r<s;r++)if(c=e[u.children_d[r]],!c.state.loaded&&c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(f[c.id]===t&&c.id!==n.jstree.root&&(f[c.id]=!0,o.push(c.id)),i=0,h=c.parents.length;i<h;i++)f[c.parents[i]]===t&&c.parents[i]!==n.jstree.root&&(f[c.parents[i]]=!0,o.push(c.parents[i]))}else if(u.original&&u.original.state&&u.original.state.undetermined&&u.original.state.undetermined===!0)for(f[u.id]===t&&u.id!==n.jstree.root&&(f[u.id]=!0,o.push(u.id)),i=0,h=u.parents.length;i<h;i++)f[u.parents[i]]===t&&u.parents[i]!==n.jstree.root&&(f[u.parents[i]]=!0,o.push(u.parents[i]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),r=0,s=o.length;r<s;r++)e[o[r]].state[c?"selected":"checked"]||(u=this.get_node(o[r],!0),u&&u.length&&u.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}};this.redraw_node=function(t,i,u){if(t=r.redraw_node.apply(this,arguments),t){for(var e=null,o=null,f=0,s=t.childNodes.length;f<s;f++)if(t.childNodes[f]&&t.childNodes[f].className&&t.childNodes[f].className.indexOf("jstree-anchor")!==-1){e=t.childNodes[f];break}e&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(e.className+=" jstree-checked"),o=c.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(o.className+=" jstree-checkbox-disabled"),e.insertBefore(o,e.childNodes[0]))}return u||this.settings.checkbox.cascade.indexOf("undetermined")===-1||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(n.proxy(this._undetermined,this),50)),t};this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()};this.is_undetermined=function(t){t=this.get_node(t);var r=this.settings.checkbox.cascade,i,u,f=this.settings.checkbox.tie_selection,o=this._data[f?"core":"checkbox"].selected,e=this._model.data;if(!t||t.state[f?"selected":"checked"]===!0||r.indexOf("undetermined")===-1||r.indexOf("down")===-1&&r.indexOf("up")===-1)return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,u=t.children_d.length;i<u;i++)if(n.inArray(t.children_d[i],o)!==-1||!e[t.children_d[i]].state.loaded&&e[t.children_d[i]].original.state.undetermined)return!0;return!1};this.disable_checkbox=function(t){var i,u,r;if(n.isArray(t)){for(t=t.slice(),i=0,u=t.length;i<u;i++)this.disable_checkbox(t[i]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;r=this.get_node(t,!0);t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))};this.enable_checkbox=function(t){var i,u,r;if(n.isArray(t)){for(t=t.slice(),i=0,u=t.length;i<u;i++)this.enable_checkbox(t[i]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;r=this.get_node(t,!0);t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))};this.activate_node=function(t,i){if(n(i.target).hasClass("jstree-checkbox-disabled"))return!1;if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||n(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!n(i.target).hasClass("jstree-checkbox"))return r.activate_node.call(this,t,i);if(this.is_disabled(t))return!1;this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i);this.trigger("activate_node",{node:this.get_node(t)})};this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var r,u,f;if(n.isArray(t)){for(t=t.slice(),u=0,f=t.length;u<f;u++)this.check_node(t[u],i);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;r=this.get_node(t,!0);t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i}))};this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var r,f,u;if(n.isArray(t)){for(t=t.slice(),r=0,f=t.length;r<f;r++)this.uncheck_node(t[r],i);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;u=this.get_node(t,!0);t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=n.vakata.array_remove_item(this._data.checkbox.selected,t.id),u.length&&u.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i}))};this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var r=this._data.checkbox.selected.concat([]),t,i;for(this._data.checkbox.selected=this._model.data[n.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;t<i;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var i=this._data.checkbox.selected.concat([]),n=0,t=this._data.checkbox.selected.length;n<t;n++)this._model.data[this._data.checkbox.selected[n]]&&(this._model.data[this._data.checkbox.selected[n]].state.checked=!1);this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})};this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!t||t.id===n.jstree.root)?!1:t.state.checked};this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?n.map(this._data.checkbox.selected,n.proxy(function(n){return this.get_node(n)},this)):this._data.checkbox.selected};this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);for(var r=this.get_checked(!0),u={},f,o,i=0,e=r.length;i<e;i++)u[r[i].id]=r[i];for(i=0,e=r.length;i<e;i++)for(f=0,o=r[i].children_d.length;f<o;f++)u[r[i].children_d[f]]&&delete u[r[i].children_d[f]];r=[];for(i in u)u.hasOwnProperty(i)&&r.push(i);return t?n.map(r,n.proxy(function(n){return this.get_node(n)},this)):r};this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);for(var r=this.get_checked(!0),u=[],i=0,f=r.length;i<f;i++)r[i].children.length||u.push(r[i].id);return t?n.map(u,n.proxy(function(n){return this.get_node(n)},this)):u};this.load_node=function(t){var u,f,e,i;if(!n.isArray(t)&&!this.settings.checkbox.tie_selection&&(i=this.get_node(t),i&&i.state.loaded))for(u=0,f=i.children_d.length;u<f;u++)this._model.data[i.children_d[u]].state.checked&&(e=!0,this._data.checkbox.selected=n.vakata.array_remove_item(this._data.checkbox.selected,i.children_d[u]));return r.load_node.apply(this,arguments)};this.get_state=function(){var n=r.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?n:(n.checkbox=this._data.checkbox.selected.slice(),n)};this.set_state=function(t,i){var u=r.set_state.apply(this,arguments),f;return u&&t.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),f=this,n.each(t.checkbox,function(n,t){f.check_node(t)})),delete t.checkbox,this.set_state(t,i),!1):u};this.refresh=function(){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),r.refresh.apply(this,arguments)}},n.jstree.defaults.conditionalselect=function(){return!0},n.jstree.plugins.conditionalselect=function(n,t){this.activate_node=function(n,i){this.settings.conditionalselect.call(this,this.get_node(n),i)&&t.activate_node.call(this,n,i)}},n.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(n){setTimeout(function(){i.edit(n)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.delete_node(i.get_selected()):i.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.cut(i.get_top_selected()):i.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.copy(i.get_top_selected()):i.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!n.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}},n.jstree.plugins.contextmenu=function(r,u){this.bind=function(){u.bind.call(this);var r=0,t=null,f,e;this.element.on("contextmenu.jstree",".jstree-anchor",n.proxy(function(n,i){n.preventDefault();r=n.ctrlKey?+new Date:0;(i||t)&&(r=+new Date+1e4);t&&clearTimeout(t);this.is_loading(n.currentTarget)||this.show_contextmenu(n.currentTarget,n.pageX,n.pageY,n)},this)).on("click.jstree",".jstree-anchor",n.proxy(function(){this._data.contextmenu.visible&&(!r||+new Date-r>250)&&n.vakata.context.hide();r=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(f=i.pageX,e=i.pageY,t=setTimeout(function(){n(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(n){t&&n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(Math.abs(f-n.pageX)>50||Math.abs(e-n.pageY)>50)&&clearTimeout(t)}).on("touchend.vakata.jstree",function(){t&&clearTimeout(t)});
/*!
			if(!('oncontextmenu' in document.body) && ('ontouchstart' in document.body)) {
				var el = null, tm = null;
				this.element
					.on("touchstart", ".jstree-anchor", function (e) {
						el = e.currentTarget;
						tm = +new Date();
						$(document).one("touchend", function (e) {
							e.target = document.elementFromPoint(e.originalEvent.targetTouches[0].pageX - window.pageXOffset, e.originalEvent.targetTouches[0].pageY - window.pageYOffset);
							e.currentTarget = e.target;
							tm = ((+(new Date())) - tm);
							if(e.target === el && tm > 600 && tm < 1000) {
								e.preventDefault();
								$(el).trigger('contextmenu', e);
							}
							el = null;
							tm = null;
						});
					});
			}
			*/
n(i).on("context_hide.vakata.jstree",n.proxy(function(){this._data.contextmenu.visible=!1},this))};this.teardown=function(){this._data.contextmenu.visible&&n.vakata.context.hide();u.teardown.call(this)};this.show_contextmenu=function(i,r,u,f){if(i=this.get_node(i),!i||i.id===n.jstree.root)return!1;var s=this.settings.contextmenu,h=this.get_node(i,!0),c=h.children(".jstree-anchor"),o=!1,e=!1;(s.show_at_node||r===t||u===t)&&(o=c.offset(),r=o.left,u=o.top+this._data.core.li_height);this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,f);e=s.items;n.isFunction(e)&&(e=e.call(this,i,n.proxy(function(n){this._show_contextmenu(i,r,u,n)},this)));n.isPlainObject(e)&&this._show_contextmenu(i,r,u,e)};this._show_contextmenu=function(t,r,u,f){var e=this.get_node(t,!0),o=e.children(".jstree-anchor");n(i).one("context_show.vakata.jstree",n.proxy(function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";n(i.element).addClass(r)},this));this._data.contextmenu.visible=!0;n.vakata.context.show(o,{x:r,y:u},f);this.trigger("show_contextmenu",{node:t,x:r,y:u})}},function(n){var r=!1,t={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};n.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(r){n(i).triggerHandler("context_"+r+".vakata",{reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}})},_execute:function(i){return i=t.items[i],i&&(!i._disabled||n.isFunction(i._disabled)&&!i._disabled({item:i,reference:t.reference,element:t.element}))&&i.action?i.action.call(null,{item:i,reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}}):!1},_parse:function(i,r){if(!i)return!1;r||(t.html="",t.items=[]);var u="",f=!1,e;return r&&(u+="<ul>"),n.each(i,function(i,r){if(!r)return!0;t.items.push(r);!f&&r.separator_before&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<\/a><\/li>");f=!1;u+="<li class='"+(r._class||"")+(r._disabled===!0||n.isFunction(r._disabled)&&r._disabled({item:r,reference:t.reference,element:t.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">";u+="<a href='#' rel='"+(t.items.length-1)+"'>";n.vakata.context.settings.icons&&(u+="<i ",r.icon&&(u+=r.icon.indexOf("/")!==-1||r.icon.indexOf(".")!==-1?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),u+="><\/i><span class='vakata-contextmenu-sep'>&#160;<\/span>");u+=(n.isFunction(r.label)?r.label({item:i,reference:t.reference,element:t.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"<\/span>":"")+"<\/a>";r.submenu&&(e=n.vakata.context._parse(r.submenu,!0),e&&(u+=e));u+="<\/li>";r.separator_after&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;<\/a><\/li>",f=!0)}),u=u.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(u+="<\/ul>"),r||(t.html=u,n.vakata.context._trigger("parse")),u.length>10?u:!1},_show_submenu:function(t){if(t=n(t),t.length&&t.children("ul").length){var i=t.children("ul"),u=t.offset().left+t.outerWidth(),e=t.offset().top,f=i.width(),o=i.height(),s=n(window).width()+n(window).scrollLeft(),h=n(window).height()+n(window).scrollTop();r?t[u-(f+10+t.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):t[u+f+10>s?"addClass":"removeClass"]("vakata-context-right");e+o+10>h&&i.css("bottom","-1px");i.show()}},show:function(i,u,f){var h,o,e,s,c,l,a,v;t.element&&t.element.length&&t.element.width("");switch(!0){case!u&&!i:return!1;case!!u&&!!i:t.reference=i;t.position_x=u.x;t.position_y=u.y;break;case!u&&!!i:t.reference=i;h=i.offset();t.position_x=h.left+i.outerHeight();t.position_y=h.top;break;case!!u&&!i:t.position_x=u.x;t.position_y=u.y}!i||f||!n(i).data("vakata_contextmenu")||(f=n(i).data("vakata_contextmenu"));n.vakata.context._parse(f)&&t.element.html(t.html);t.items.length&&(t.element.appendTo("body"),o=t.element,e=t.position_x,s=t.position_y,c=o.width(),l=o.height(),a=n(window).width()+n(window).scrollLeft(),v=n(window).height()+n(window).scrollTop(),r&&(e-=o.outerWidth()-n(i).outerWidth(),e<n(window).scrollLeft()+20&&(e=n(window).scrollLeft()+20)),e+c+20>a&&(e=a-(c+20)),s+l+20>v&&(s=v-(l+20)),t.element.css({left:e,top:s}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),t.is_visible=!0,n.vakata.context._trigger("show"))},hide:function(){t.is_visible&&(t.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),t.is_visible=!1,n.vakata.context._trigger("hide"))}};n(function(){r=n("body").css("direction")==="rtl";var u=!1;t.element=n("<ul class='vakata-context'><\/ul>");t.element.on("mouseenter","li",function(i){(i.stopImmediatePropagation(),n.contains(this,i.relatedTarget))||(u&&clearTimeout(u),t.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),n(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),n.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){n.contains(this,t.relatedTarget)||n(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){n(this).find(".vakata-context-hover").removeClass("vakata-context-hover");n.vakata.context.settings.hide_onmouseleave&&(u=setTimeout(function(){return function(){n.vakata.context.hide()}}(this),n.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault();n(this).blur().parent().hasClass("vakata-context-disabled")||n.vakata.context._execute(n(this).attr("rel"))===!1||n.vakata.context.hide()}).on("keydown","a",function(i){var r=null;switch(i.which){case 13:case 32:i.type="mouseup";i.preventDefault();n(i.currentTarget).trigger(i);break;case 37:t.is_visible&&(t.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 38:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 39:t.is_visible&&(t.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 40:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").focus(),i.stopImmediatePropagation(),i.preventDefault());break;case 27:n.vakata.context.hide();i.preventDefault()}}).on("keydown",function(n){n.preventDefault();var i=t.element.find(".vakata-contextmenu-shortcut-"+n.which).parent();i.parent().not(".vakata-context-disabled")&&i.click()});n(i).on("mousedown.vakata.jstree",function(i){t.is_visible&&!n.contains(t.element[0],i.target)&&n.vakata.context.hide()}).on("context_show.vakata.jstree",function(){t.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");r&&t.element.addClass("vakata-context-rtl").css("direction","rtl");t.element.find("ul").hide().end()})})}(n),n.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1},n.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",n.proxy(function(t){if(this.settings.dnd.large_drag_target&&n(t.target).closest(".jstree-node")[0]!==t.currentTarget||t.type==="touchstart"&&(!this.settings.dnd.touch||this.settings.dnd.touch==="selected"&&!n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),r=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,u=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);return this.settings.core.force_text&&(u=n.vakata.html.escape(u)),i&&i.id&&i.id!==n.jstree.root&&(t.which===1||t.type==="touchstart")&&(this.settings.dnd.is_draggable===!0||n.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[i],t))?(this.element.trigger("mousedown.jstree"),n.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:r>1?this.get_top_selected():[i.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"><\/i>'+u+'<ins class="jstree-copy" style="display:none;">+<\/ins><\/div>')):void 0},this))}},n(function(){var t=!1,f=!1,r=!1,e=!1,u=n('<div id="jstree-marker">&#160;<\/div>').hide();n(i).on("dnd_start.vakata.jstree",function(n,i){(t=!1,r=!1,i&&i.data&&i.data.jstree)&&u.appendTo("body")}).on("dnd_move.vakata.jstree",function(i,o){if((e&&clearTimeout(e),o&&o.data&&o.data.jstree)&&(!o.event.target.id||o.event.target.id!=="jstree-marker")){r=o.event;var s=n.jstree.reference(o.event.target),h=!1,a=!1,k=!1,d,g,v,y,p,nt,l,c,tt,rt,it,ut,w,b;if(s&&s._data&&s._data.dnd)if(u.attr("class","jstree-"+s.get_theme()+(s.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+s.get_theme()+" jstree-"+s.get_theme()+"-"+s.get_theme_variant()+" "+(s.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),(o.event.target===s.element[0]||o.event.target===s.get_container_ul()[0])&&s.get_container_ul().children().length===0){for(l=!0,c=0,tt=o.data.nodes.length;c<tt;c++)if(l=l&&s.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==s?o.data.origin.get_node(o.data.nodes[c]):o.data.nodes[c],n.jstree.root,"last",{dnd:!0,ref:s.get_node(n.jstree.root),pos:"i",origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==s,is_foreign:!o.data.origin}),!l)break;if(l){t={ins:s,par:n.jstree.root,pos:"last"};u.hide();o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");return}}else if(h=s.settings.dnd.large_drop_target?n(o.event.target).closest(".jstree-node").children(".jstree-anchor"):n(o.event.target).closest(".jstree-anchor"),h&&h.length&&h.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(a=h.offset(),k=o.event.pageY-a.top,v=h.outerHeight(),nt=k<v/3?["b","i","a"]:k>v-v/3?["a","i","b"]:k>v/2?["i","a","b"]:["i","b","a"],n.each(nt,function(i,r){switch(r){case"b":d=a.left-6;g=a.top;y=s.get_parent(h);p=h.parent().index();break;case"i":w=s.settings.dnd.inside_pos;b=s.get_node(h.parent());d=a.left-2;g=a.top+v/2+1;y=b.id;p=w==="first"?0:w==="last"?b.children.length:Math.min(w,b.children.length);break;case"a":d=a.left-6;g=a.top+v;y=s.get_parent(h);p=h.parent().index()+1}for(l=!0,c=0,tt=o.data.nodes.length;c<tt;c++)if(rt=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",it=p,rt==="move_node"&&r==="a"&&o.data.origin&&o.data.origin===s&&y===s.get_parent(o.data.nodes[c])&&(ut=s.get_node(y),it>n.inArray(o.data.nodes[c],ut.children)&&(it-=1)),l=l&&(s&&s.settings&&s.settings.dnd&&s.settings.dnd.check_while_dragging===!1||s.check(rt,o.data.origin&&o.data.origin!==s?o.data.origin.get_node(o.data.nodes[c]):o.data.nodes[c],y,it,{dnd:!0,ref:s.get_node(h.parent()),pos:r,origin:o.data.origin,is_multi:o.data.origin&&o.data.origin!==s,is_foreign:!o.data.origin})),!l){s&&s.last_error&&(f=s.last_error());break}return r==="i"&&h.parent().is(".jstree-closed")&&s.settings.dnd.open_timeout&&(e=setTimeout(function(n,t){return function(){n.open_node(t)}}(s,h),s.settings.dnd.open_timeout)),l?(t={ins:s,par:y,pos:r==="i"&&w==="last"&&p===0&&!s.is_loaded(b)?"last":p},u.css({left:d+"px",top:g+"px"}).show(),o.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),f={},nt=!0,!1):void 0}),nt===!0))return;t=!1;o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");u.hide()}}).on("dnd_scroll.vakata.jstree",function(n,i){i&&i.data&&i.data.jstree&&(u.hide(),t=!1,r=!1,i.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(i,o){if(e&&clearTimeout(e),o&&o.data&&o.data.jstree){u.hide().detach();var s,h,c=[];if(t){for(s=0,h=o.data.nodes.length;s<h;s++)c[s]=o.data.origin?o.data.origin.get_node(o.data.nodes[s]):o.data.nodes[s];t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](c,t.par,t.pos,!1,!1,!1,o.data.origin)}else s=n(o.event.target).closest(".jstree"),s.length&&f&&f.error&&f.error==="check"&&(s=s.jstree(!0),s&&s.settings.core.error.call(this,f));r=!1;t=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=n.vakata.dnd._get();i&&i.data&&i.data.jstree&&(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),r&&(r.metaKey=t.metaKey,r.ctrlKey=t.ctrlKey,n.vakata.dnd._trigger("move",r)))})}),function(n){n.vakata.html={div:n("<div />"),escape:function(t){return n.vakata.html.div.text(t).html()},strip:function(t){return n.vakata.html.div.empty().append(n.parseHTML(t)).text()}};var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};n.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,r){var u=n.vakata.dnd._get();u.event=r;n(i).triggerHandler("dnd_"+t+".vakata",u)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove();t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1);t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};n(i).off("mousemove.vakata.jstree touchmove.vakata.jstree",n.vakata.dnd.drag);n(i).off("mouseup.vakata.jstree touchend.vakata.jstree",n.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(n.vakata.dnd._scroll,100),!1;if(i===!0)return!1;var r=t.scroll_e.scrollTop(),u=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(r+t.scroll_t*n.vakata.dnd.settings.scroll_speed);t.scroll_e.scrollLeft(u+t.scroll_l*n.vakata.dnd.settings.scroll_speed);(r!==t.scroll_e.scrollTop()||u!==t.scroll_e.scrollLeft())&&n.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(r,u,f){r.type==="touchstart"&&r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(r.pageX=r.originalEvent.changedTouches[0].pageX,r.pageY=r.originalEvent.changedTouches[0].pageY,r.target=i.elementFromPoint(r.originalEvent.changedTouches[0].pageX-window.pageXOffset,r.originalEvent.changedTouches[0].pageY-window.pageYOffset));t.is_drag&&n.vakata.dnd.stop({});try{r.currentTarget.unselectable="on";r.currentTarget.onselectstart=function(){return!1};r.currentTarget.style&&(r.currentTarget.style.MozUserSelect="none")}catch(e){}t.init_x=r.pageX;t.init_y=r.pageY;t.data=u;t.is_down=!0;t.element=r.currentTarget;t.target=r.target;t.is_touch=r.type==="touchstart";f!==!1&&(t.helper=n("<div id='vakata-dnd'><\/div>").html(f).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"}));n(i).on("mousemove.vakata.jstree touchmove.vakata.jstree",n.vakata.dnd.drag);n(i).on("mouseup.vakata.jstree touchend.vakata.jstree",n.vakata.dnd.stop);return!1},drag:function(r){if(r.type==="touchmove"&&r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(r.pageX=r.originalEvent.changedTouches[0].pageX,r.pageY=r.originalEvent.changedTouches[0].pageY,r.target=i.elementFromPoint(r.originalEvent.changedTouches[0].pageX-window.pageXOffset,r.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag)if(Math.abs(r.pageX-t.init_x)>(t.is_touch?n.vakata.dnd.settings.threshold_touch:n.vakata.dnd.settings.threshold)||Math.abs(r.pageY-t.init_y)>(t.is_touch?n.vakata.dnd.settings.threshold_touch:n.vakata.dnd.settings.threshold))t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,n.vakata.dnd._trigger("start",r);else return;var u=!1,l=!1,f=!1,o=!1,e=!1,s=!1,a=!1,v=!1,h=!1,c=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,n(n(r.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(n(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var u=n(this),i=u.offset();return this.scrollHeight>this.offsetHeight&&(i.top+u.height()-r.pageY<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),r.pageY-i.top<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(i.left+u.width()-r.pageX<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),r.pageX-i.left<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=n(this),!1):void 0}),t.scroll_e||(u=n(i),l=n(window),f=u.height(),o=l.height(),e=u.width(),s=l.width(),a=u.scrollTop(),v=u.scrollLeft(),f>o&&r.pageY-a<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),f>o&&o-(r.pageY-a)<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),e>s&&r.pageX-v<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),e>s&&s-(r.pageX-v)<n.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=u)),t.scroll_e&&n.vakata.dnd._scroll(!0),t.helper&&(h=parseInt(r.pageY+n.vakata.dnd.settings.helper_top,10),c=parseInt(r.pageX+n.vakata.dnd.settings.helper_left,10),f&&h+25>f&&(h=f-50),e&&c+t.helper_w>e&&(c=e-(t.helper_w+2)),t.helper.css({left:c+"px",top:h+"px"})),n.vakata.dnd._trigger("move",r),!1}},stop:function(r){if(r.type==="touchend"&&r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(r.pageX=r.originalEvent.changedTouches[0].pageX,r.pageY=r.originalEvent.changedTouches[0].pageY,r.target=i.elementFromPoint(r.originalEvent.changedTouches[0].pageX-window.pageXOffset,r.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)n.vakata.dnd._trigger("stop",r);else if(r.type==="touchend"&&r.target===t.target){var u=setTimeout(function(){n(r.target).click()},100);n(r.target).one("click",function(){u&&clearTimeout(u)})}return n.vakata.dnd._clean(),!1}}}(n),n.jstree.defaults.massload=null,n.jstree.plugins.massload=function(t,i){this.init=function(n,t){i.init.call(this,n,t);this._data.massload={}};this._load_nodes=function(t,r,u){var f=this.settings.massload;return u&&!n.isEmptyObject(this._data.massload)?i._load_nodes.call(this,t,r,u):n.isFunction(f)?f.call(this,t,n.proxy(function(n){if(n)for(var f in n)n.hasOwnProperty(f)&&(this._data.massload[f]=n[f]);i._load_nodes.call(this,t,r,u)},this)):typeof f=="object"&&f&&f.url?(f=n.extend(!0,{},f),n.isFunction(f.url)&&(f.url=f.url.call(this,t)),n.isFunction(f.data)&&(f.data=f.data.call(this,t)),n.ajax(f).done(n.proxy(function(n){if(n)for(var f in n)n.hasOwnProperty(f)&&(this._data.massload[f]=n[f]);i._load_nodes.call(this,t,r,u)},this)).fail(n.proxy(function(){i._load_nodes.call(this,t,r,u)},this))):i._load_nodes.call(this,t,r,u)};this._load_node=function(t,r){var u=this._data.massload[t.id];return u?this[typeof u=="string"?"_append_html_data":"_append_json_data"](t,typeof u=="string"?n(n.parseHTML(u)).filter(function(){return this.nodeType!==3}):u,function(n){r.call(this,n);delete this._data.massload[t.id]}):i._load_node.call(this,t,r)}},n.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},n.jstree.plugins.search=function(i,r){this.bind=function(){r.bind.call(this);this._data.search.str="";this._data.search.dom=n();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=!1;this._data.search.smc=!1;this._data.search.hdn=[];this.element.on("search.jstree",n.proxy(function(t,i){if(this._data.search.som&&i.res.length){for(var f=this._model.data,u=[],r=0,e=i.res.length;r<e;r++)f[i.res[r]]&&!f[i.res[r]].state.hidden&&(u.push(i.res[r]),u=u.concat(f[i.res[r]].parents),this._data.search.smc&&(u=u.concat(f[i.res[r]].children_d)));u=n.vakata.array_remove_item(n.vakata.array_unique(u),n.jstree.root);this._data.search.hdn=this.hide_all(!0);this.show_node(u)}},this)).on("clear_search.jstree",n.proxy(function(n,t){this._data.search.som&&t.res.length&&this.show_node(this._data.search.hdn)},this))};this.search=function(i,r,u,f,e,o){if(i===!1||n.trim(i.toString())==="")return this.clear_search();f=this.get_node(f);f=f&&f.id?f.id:null;i=i.toString();var h=this.settings.search,s=h.ajax?h.ajax:!1,v=this._model.data,y=null,a=[],c=[],l,p;if(this._data.search.res.length&&!e&&this.clear_search(),u===t&&(u=h.show_only_matches),o===t&&(o=h.show_only_matches_children),!r&&s!==!1)return n.isFunction(s)?s.call(this,i,n.proxy(function(t){t&&t.d&&(t=t.d);this._load_nodes(n.isArray(t)?n.vakata.array_unique(t):[],function(){this.search(i,!0,u,f,e)},!0)},this),f):(s=n.extend({},s),s.data||(s.data={}),s.data.str=i,f&&(s.data.inside=f),n.ajax(s).fail(n.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(s)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done(n.proxy(function(t){t&&t.d&&(t=t.d);this._load_nodes(n.isArray(t)?n.vakata.array_unique(t):[],function(){this.search(i,!0,u,f,e)},!0)},this)));if(e||(this._data.search.str=i,this._data.search.dom=n(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=u,this._data.search.smc=o),y=new n.vakata.search(i,!0,{caseSensitive:h.case_sensitive,fuzzy:h.fuzzy}),n.each(v[f?f:n.jstree.root].children_d,function(n,t){var r=v[t];r.text&&(!h.search_leaves_only||r.state.loaded&&r.children.length===0)&&(h.search_callback&&h.search_callback.call(this,i,r)||!h.search_callback&&y.search(r.text).isMatch)&&(a.push(t),c=c.concat(r.parents))}),a.length){for(c=n.vakata.array_unique(c),l=0,p=c.length;l<p;l++)c[l]!==n.jstree.root&&v[c[l]]&&this.open_node(c[l],null,0)===!0&&this._data.search.opn.push(c[l]);e?(this._data.search.dom=this._data.search.dom.add(n(this.element[0].querySelectorAll("#"+n.map(a,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=n.vakata.array_unique(this._data.search.res.concat(a))):(this._data.search.dom=n(this.element[0].querySelectorAll("#"+n.map(a,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=a);this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:u})};this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0);this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});this._data.search.res.length&&(this._data.search.dom=n(this.element[0].querySelectorAll("#"+n.map(this._data.search.res,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"));this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=n()};this.redraw_node=function(t){if(t=r.redraw_node.apply(this,arguments),t&&n.inArray(t.id,this._data.search.res)!==-1){for(var u=null,i=0,f=t.childNodes.length;i<f;i++)if(t.childNodes[i]&&t.childNodes[i].className&&t.childNodes[i].className.indexOf("jstree-anchor")!==-1){u=t.childNodes[i];break}u&&(u.className+=" jstree-search")}return t}},function(n){n.vakata.search=function(t,i,r){r=r||{};r=n.extend({},n.vakata.search.defaults,r);r.fuzzy!==!1&&(r.fuzzy=!0);t=r.caseSensitive?t:t.toLowerCase();var f=r.location,s=r.distance,l=r.threshold,u=t.length,h,c,e,o;return u>32&&(r.fuzzy=!1),r.fuzzy&&(h=1<<u-1,c=function(){for(var i={},n=0,n=0;n<u;n++)i[t.charAt(n)]=0;for(n=0;n<u;n++)i[t.charAt(n)]|=1<<u-n-1;return i}(),e=function(n,t){var i=n/u,r=Math.abs(f-t);return s?i+r/s:r?1:i}),o=function(n){if(n=r.caseSensitive?n:n.toLowerCase(),t===n||n.indexOf(t)!==-1)return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var a,i,tt=n.length,v=l,o=n.indexOf(t,f),p,s,w=u+tt,b,g,k,y,nt,d=1,it=[];for(o!==-1&&(v=Math.min(e(0,o),v),o=n.lastIndexOf(t,f+u),o!==-1&&(v=Math.min(e(0,o),v))),o=-1,a=0;a<u;a++){for(p=0,s=w;p<s;)e(a,f+s)<=v?p=s:w=s,s=Math.floor((w-p)/2+p);for(w=s,g=Math.max(1,f-s+1),k=Math.min(f+s,tt)+u,y=new Array(k+2),y[k+1]=(1<<a)-1,i=k;i>=g;i--)if(nt=c[n.charAt(i-1)],y[i]=a===0?(y[i+1]<<1|1)&nt:(y[i+1]<<1|1)&nt|(b[i+1]|b[i])<<1|1|b[i+1],y[i]&h&&(d=e(a,i-1),d<=v))if(v=d,o=i-1,it.push(o),o>f)g=Math.max(1,2*f-o);else break;if(e(a+1,f)>v)break;b=y}return{isMatch:o>=0,score:d}},i===!0?{search:o}:o(i)};n.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(n),n.jstree.defaults.sort=function(n,t){return this.get_text(n)>this.get_text(t)?1:-1},n.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("model.jstree",n.proxy(function(n,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",n.proxy(function(n,t){this.sort(t.parent||t.node.parent,!1);this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",n.proxy(function(n,t){this.sort(t.parent,!1);this.redraw_node(t.parent,!0)},this))};this.sort=function(t,i){var r,u;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(n.proxy(this.settings.sort,this)),i))for(r=0,u=t.children_d.length;r<u;r++)this.sort(t.children_d[r],!1)}},l=!1,n.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},n.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=n.proxy(function(){this.element.on(this.settings.state.events,n.proxy(function(){l&&clearTimeout(l);l=setTimeout(n.proxy(function(){this.save_state()},this),100)},this));this.trigger("state_ready")},this);this.element.on("ready.jstree",n.proxy(function(){this.element.one("restore_state.jstree",t);this.restore_state()||t()},this))};this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};n.vakata.storage.set(this.settings.state.key,JSON.stringify(t))};this.restore_state=function(){var t=n.vakata.storage.get(this.settings.state.key);if(!!t)try{t=JSON.parse(t)}catch(i){return!1}if(!!t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)return!1;if(!!t&&t.state&&(t=t.state),!!t&&n.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t){this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{state:n.extend(!0,{},t)})});return this.set_state(t),!0}return!1};this.clear_state=function(){return n.vakata.storage.del(this.settings.state.key)}},function(n){n.vakata.storage={set:function(n,t){return window.localStorage.setItem(n,t)},get:function(n){return window.localStorage.getItem(n)},del:function(n){return window.localStorage.removeItem(n)}}}(n),n.jstree.defaults.types={"default":{}},n.jstree.defaults.types[n.jstree.root]={},n.jstree.plugins.types=function(i,r){this.init=function(i,u){var f,e;if(u&&u.types&&u.types["default"])for(f in u.types)if(f!=="default"&&f!==n.jstree.root&&u.types.hasOwnProperty(f))for(e in u.types["default"])u.types["default"].hasOwnProperty(e)&&u.types[f][e]===t&&(u.types[f][e]=u.types["default"][e]);r.init.call(this,i,u);this._model.data[n.jstree.root].type=n.jstree.root};this.refresh=function(t,i){r.refresh.call(this,t,i);this._model.data[n.jstree.root].type=n.jstree.root};this.bind=function(){this.element.on("model.jstree",n.proxy(function(i,r){for(var f=this._model.data,e=r.nodes,s=this.settings.types,o="default",u=0,h=e.length;u<h;u++)o="default",f[e[u]].original&&f[e[u]].original.type&&s[f[e[u]].original.type]&&(o=f[e[u]].original.type),f[e[u]].data&&f[e[u]].data.jstree&&f[e[u]].data.jstree.type&&s[f[e[u]].data.jstree.type]&&(o=f[e[u]].data.jstree.type),f[e[u]].type=o,f[e[u]].icon===!0&&s[o].icon!==t&&(f[e[u]].icon=s[o].icon);f[n.jstree.root].type=n.jstree.root},this));r.bind.call(this)};this.get_json=function(t,i,u){var e,s,o=this._model.data,h=i?n.extend(!0,{},i,{no_id:!1}):{},f=r.get_json.call(this,t,h,u);if(f===!1)return!1;if(n.isArray(f))for(e=0,s=f.length;e<s;e++)f[e].type=f[e].id&&o[f[e].id]&&o[f[e].id].type?o[f[e].id].type:"default",i&&i.no_id&&(delete f[e].id,f[e].li_attr&&f[e].li_attr.id&&delete f[e].li_attr.id,f[e].a_attr&&f[e].a_attr.id&&delete f[e].a_attr.id);else f.type=f.id&&o[f.id]&&o[f.id].type?o[f.id].type:"default",i&&i.no_id&&(f=this._delete_ids(f));return f};this._delete_ids=function(t){if(n.isArray(t)){for(var i=0,r=t.length;i<r;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&n.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t};this.check=function(i,u,f,e,o){if(r.check.call(this,i,u,f,e,o)===!1)return!1;u=u&&u.id?u:this.get_node(u);f=f&&f.id?f:this.get_node(f);var c=u&&u.id?o&&o.origin?o.origin:n.jstree.reference(u.id):null,s,h,l,a;c=c&&c._model&&c._model.data?c._model.data:null;switch(i){case"create_node":case"move_node":case"copy_node":if(i!=="move_node"||n.inArray(u.id,f.children)===-1){if(s=this.get_rules(f),s.max_children!==t&&s.max_children!==-1&&s.max_children===f.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;if(s.valid_children!==t&&s.valid_children!==-1&&n.inArray(u.type||"default",s.valid_children)===-1)return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;if(c&&u.children_d&&u.parents){for(h=0,l=0,a=u.children_d.length;l<a;l++)h=Math.max(h,c[u.children_d[l]].parents.length);h=h-u.parents.length+1}(h<=0||h===t)&&(h=1);do{if(s.max_depth!==t&&s.max_depth!==-1&&s.max_depth<h)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;f=this.get_node(f.parent);s=this.get_rules(f);h++}while(f)}}return!0};this.get_rules=function(n){if(n=this.get_node(n),!n)return!1;var i=this.get_type(n,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i};this.get_type=function(t,i){return t=this.get_node(t),t?i?n.extend({type:t.type},this.settings.types[t.type]):t.type:!1};this.set_type=function(i,r){var u,f,s,e,o;if(n.isArray(i)){for(i=i.slice(),f=0,s=i.length;f<s;f++)this.set_type(i[f],r);return!0}return(u=this.settings.types,i=this.get_node(i),!u[r]||!i)?!1:(e=i.type,o=this.get_icon(i),i.type=r,(o===!0||u[e]&&u[e].icon!==t&&o===u[e].icon)&&this.set_icon(i,u[r].icon!==t?u[r].icon:!0),!0)}},n.jstree.defaults.unique={case_sensitive:!1,duplicate:function(n,t){return n+" ("+t+")"}},n.jstree.plugins.unique=function(i,r){this.check=function(t,i,u,f,e){if(r.check.call(this,t,i,u,f,e)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),u=u&&u.id?u:this.get_node(u),!u||!u.children)return!0;for(var s=t==="rename_node"?f:i.text,h=[],c=this.settings.unique.case_sensitive,l=this._model.data,o=0,a=u.children.length;o<a;o++)h.push(c?l[u.children[o]].text:l[u.children[o]].text.toLowerCase());c||(s=s.toLowerCase());switch(t){case"delete_node":return!0;case"rename_node":return o=n.inArray(s,h)===-1||i.text&&i.text[c?"toString":"toLowerCase"]()===s,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"create_node":return o=n.inArray(s,h)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"copy_node":return o=n.inArray(s,h)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"move_node":return o=i.parent===u.id&&(!e||!e.is_multi)||n.inArray(s,h)===-1,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o}return!0};this.create_node=function(i,u,f,e,o){if(!u||u.text===t){if((i===null&&(i=n.jstree.root),i=this.get_node(i),!i)||(f=f===t?"last":f,!f.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i)))return r.create_node.call(this,i,u,f,e,o);u||(u={});var l,h,c,s,a,v=this._model.data,y=this.settings.unique.case_sensitive,p=this.settings.unique.duplicate;for(h=l=this.get_string("New node"),c=[],s=0,a=i.children.length;s<a;s++)c.push(y?v[i.children[s]].text:v[i.children[s]].text.toLowerCase());for(s=1;n.inArray(y?h:h.toLowerCase(),c)!==-1;)h=p.call(this,l,++s).toString();u.text=h}return r.create_node.call(this,i,u,f,e,o)}},o=i.createElement("DIV"),o.setAttribute("unselectable","on"),o.setAttribute("role","presentation"),o.className="jstree-wholerow",o.innerHTML="&#160;",n.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("ready.jstree set_state.jstree",n.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",n.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",n.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",n.proxy(function(n,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var i=!1,r=0,u=t.selected.length;r<u;r++)i=this.get_node(t.selected[r],!0),i&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",n.proxy(function(n,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",n.proxy(function(n,t){n.type==="hover_node"&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")[n.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",n.proxy(function(t){t.preventDefault();var i=n.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=n.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",n.proxy(function(t){t.stopImmediatePropagation();var i=n.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",n.proxy(function(n){return n.stopImmediatePropagation(),this.is_disabled(n.currentTarget)||this.hover_node(n.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",n.proxy(function(n){this.dehover_node(n.currentTarget)},this))};this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove();i.teardown.call(this)};this.redraw_node=function(t){if(t=i.redraw_node.apply(this,arguments),t){var r=o.cloneNode(!0);n.inArray(t.id,this._data.core.selected)!==-1&&(r.className+=" jstree-wholerow-clicked");this._data.core.focused&&this._data.core.focused===t.id&&(r.className+=" jstree-wholerow-hovered");t.insertBefore(r,t.childNodes[0])}return t}},i.registerElement&&Object&&Object.create){v=Object.create(HTMLElement.prototype);v.createdCallback=function(){var i={core:{},plugins:[]};for(var t in n.jstree.plugins)n.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in n.jstree.defaults.core)n.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));n(this).jstree(i)};try{i.registerElement("vakata-jstree",{prototype:v})}catch(w){}}}});
/*!
 * Select2 4.0.3
 * https://select2.github.io
 *
 * Released under the MIT license
 * https://github.com/select2/select2/blob/master/LICENSE.md
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)})(function(n){var t=function(){var t;n&&n.fn&&n.fn.select2&&n.fn.select2.amd&&(t=n.fn.select2.amd),function(){if(!t||!t.requirejs){t?i=t:t={};
/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var n,i,r;(function(t){function e(n,t){return k.call(n,t)}function l(n,t){var o,s,r,u,h,y,c,b,i,l,w,e=t&&t.split("/"),a=f.map,v=a&&a["*"]||{};if(n&&n.charAt(0)===".")if(t){for(n=n.split("/"),h=n.length-1,f.nodeIdCompat&&p.test(n[h])&&(n[h]=n[h].replace(p,"")),n=e.slice(0,e.length-1).concat(n),i=0;i<n.length;i+=1)if(w=n[i],w===".")n.splice(i,1),i-=1;else if(w==="..")if(i===1&&(n[2]===".."||n[0]===".."))break;else i>0&&(n.splice(i-1,2),i-=2);n=n.join("/")}else n.indexOf("./")===0&&(n=n.substring(2));if((e||v)&&a){for(o=n.split("/"),i=o.length;i>0;i-=1){if(s=o.slice(0,i).join("/"),e)for(l=e.length;l>0;l-=1)if(r=a[e.slice(0,l).join("/")],r&&(r=r[s],r)){u=r;y=i;break}if(u)break;!c&&v&&v[s]&&(c=v[s],b=i)}!u&&c&&(u=c,y=b);u&&(o.splice(0,y,u),n=o.join("/"))}return n}function w(n,i){return function(){var r=d.call(arguments,0);return typeof r[0]!="string"&&r.length===1&&r.push(null),o.apply(t,r.concat([n,i]))}}function g(n){return function(t){return l(t,n)}}function nt(n){return function(t){u[n]=t}}function a(n){if(e(h,n)){var i=h[n];delete h[n];y[n]=!0;c.apply(t,i)}if(!e(u,n)&&!e(y,n))throw new Error("No "+n);return u[n]}function b(n){var i,t=n?n.indexOf("!"):-1;return t>-1&&(i=n.substring(0,t),n=n.substring(t+1,n.length)),[i,n]}function tt(n){return function(){return f&&f.config&&f.config[n]||{}}}var c,o,v,s,u={},h={},f={},y={},k=Object.prototype.hasOwnProperty,d=[].slice,p=/\.js$/;v=function(n,t){var r,u=b(n),i=u[0];return n=u[1],i&&(i=l(i,t),r=a(i)),i?n=r&&r.normalize?r.normalize(n,g(t)):l(n,t):(n=l(n,t),u=b(n),i=u[0],n=u[1],i&&(r=a(i))),{f:i?i+"!"+n:n,n:n,pr:i,p:r}};s={require:function(n){return w(n)},exports:function(n){var t=u[n];return typeof t!="undefined"?t:u[n]={}},module:function(n){return{id:n,uri:"",exports:u[n],config:tt(n)}}};c=function(n,i,r,f){var p,o,k,b,c,l=[],d=typeof r,g;if(f=f||n,d==="undefined"||d==="function"){for(i=!i.length&&r.length?["require","exports","module"]:i,c=0;c<i.length;c+=1)if(b=v(i[c],f),o=b.f,o==="require")l[c]=s.require(n);else if(o==="exports")l[c]=s.exports(n),g=!0;else if(o==="module")p=l[c]=s.module(n);else if(e(u,o)||e(h,o)||e(y,o))l[c]=a(o);else if(b.p)b.p.load(b.n,w(f,!0),nt(o),{}),l[c]=u[o];else throw new Error(n+" missing "+o);k=r?r.apply(u[n],l):undefined;n&&(p&&p.exports!==t&&p.exports!==u[n]?u[n]=p.exports:k===t&&g||(u[n]=k))}else n&&(u[n]=r)};n=i=o=function(n,i,r,u,e){if(typeof n=="string")return s[n]?s[n](i):a(v(n,i).f);if(!n.splice){if(f=n,f.deps&&o(f.deps,f.callback),!i)return;i.splice?(n=i,i=r,r=null):n=t}return i=i||function(){},typeof r=="function"&&(r=u,u=e),u?c(t,n,i,r):setTimeout(function(){c(t,n,i,r)},4),o};o.config=function(n){return o(n)};n._defined=u;r=function(n,t,i){if(typeof n!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]);e(u,n)||e(h,n)||(h[n]=[n,t,i])};r.amd={jQuery:!0}})();t.requirejs=n;t.require=i;t.define=r}}();t.define("almond",function(){});t.define("jquery",[],function(){var t=n||$;return t==null&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),t});t.define("select2/utils",["jquery"],function(n){function r(n){var i=n.prototype,r=[],t,u;for(t in i)(u=i[t],typeof u=="function")&&t!=="constructor"&&r.push(t);return r}var t={},i;return t.Extend=function(n,t){function r(){this.constructor=n}var u={}.hasOwnProperty;for(var i in t)u.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n},t.Decorate=function(n,t){function i(){var r=Array.prototype.unshift,u=t.prototype.constructor.length,i=n.prototype.constructor;u>0&&(r.call(arguments,n.prototype.constructor),i=t.prototype.constructor);i.apply(this,arguments)}function l(){this.constructor=i}var s=r(t),h=r(n),u,e,c,f,o;for(t.displayName=n.displayName,i.prototype=new l,u=0;u<h.length;u++)e=h[u],i.prototype[e]=n.prototype[e];for(c=function(n){var r=function(){},u;return n in i.prototype&&(r=i.prototype[n]),u=t.prototype[n],function(){var n=Array.prototype.unshift;return n.call(arguments,r),u.apply(this,arguments)}},f=0;f<s.length;f++)o=s[f],i.prototype[o]=c(o);return i},i=function(){this.listeners={}},i.prototype.on=function(n,t){this.listeners=this.listeners||{};n in this.listeners?this.listeners[n].push(t):this.listeners[n]=[t]},i.prototype.trigger=function(n){var i=Array.prototype.slice,t=i.call(arguments,1);this.listeners=this.listeners||{};t==null&&(t=[]);t.length===0&&t.push({});t[0]._type=n;n in this.listeners&&this.invoke(this.listeners[n],i.call(arguments,1));"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},i.prototype.invoke=function(n,t){for(var i=0,r=n.length;i<r;i++)n[i].apply(this,t)},t.Observable=i,t.generateChars=function(n){for(var r,t="",i=0;i<n;i++)r=Math.floor(Math.random()*36),t+=r.toString(36);return t},t.bind=function(n,t){return function(){n.apply(t,arguments)}},t._convertData=function(n){var f,r,i,u,t;for(f in n)if(r=f.split("-"),i=n,r.length!==1){for(u=0;u<r.length;u++)t=r[u],t=t.substring(0,1).toLowerCase()+t.substring(1),t in i||(i[t]={}),u==r.length-1&&(i[t]=n[f]),i=i[t];delete n[f]}return n},t.hasScroll=function(t,i){var u=n(i),f=i.style.overflowX,r=i.style.overflowY;return f===r&&(r==="hidden"||r==="visible")?!1:f==="scroll"||r==="scroll"?!0:u.innerHeight()<i.scrollHeight||u.innerWidth()<i.scrollWidth},t.escapeMarkup=function(n){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return typeof n!="string"?n:String(n).replace(/[&<>"'\/\\]/g,function(n){return t[n]})},t.appendMany=function(t,i){if(n.fn.jquery.substr(0,3)==="1.7"){var r=n();n.map(i,function(n){r=r.add(n)});i=r}t.append(i)},t});t.define("select2/results",["jquery","./utils"],function(n,t){function i(n,t,r){this.$element=n;this.data=r;this.options=t;i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=n('<ul class="select2-results__options" role="tree"><\/ul>');return this.options.get("multiple")&&t.attr("aria-multiselectable","true"),this.$results=t,t},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(t){var u=this.options.get("escapeMarkup"),i,r;this.clear();this.hideLoading();i=n('<li role="treeitem" aria-live="assertive" class="select2-results__option"><\/li>');r=this.options.get("translations").get(t.message);i.append(u(r(t.args)));i[0].className+=" select2-results__message";this.$results.append(i)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(n){var i,t,r,u;if(this.hideLoading(),i=[],n.results==null||n.results.length===0){this.$results.children().length===0&&this.trigger("results:message",{message:"noResults"});return}for(n.results=this.sort(n.results),t=0;t<n.results.length;t++)r=n.results[t],u=this.option(r),i.push(u);this.$results.append(i)},i.prototype.position=function(n,t){var i=t.find(".select2-results");i.append(n)},i.prototype.sort=function(n){var t=this.options.get("sorter");return t(n)},i.prototype.highlightFirstItem=function(){var n=this.$results.find(".select2-results__option[aria-selected]"),t=n.filter("[aria-selected=true]");t.length>0?t.first().trigger("mouseenter"):n.first().trigger("mouseenter");this.ensureHighlightVisible()},i.prototype.setClasses=function(){var t=this;this.data.current(function(i){var r=n.map(i,function(n){return n.id.toString()}),u=t.$results.find(".select2-results__option[aria-selected]");u.each(function(){var i=n(this),t=n.data(this,"data"),u=""+t.id;t.element!=null&&t.element.selected||t.element==null&&n.inArray(u,r)>-1?i.attr("aria-selected","true"):i.attr("aria-selected","false")})})},i.prototype.showLoading=function(n){this.hideLoading();var i=this.options.get("translations").get("searching"),r={disabled:!0,loading:!0,text:i(n)},t=this.option(r);t.className+=" loading-results";this.$results.prepend(t)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(t){var r=document.createElement("li"),i,e,c,o,u,v,s,f,l,a,h;r.className="select2-results__option";i={role:"treeitem","aria-selected":"false"};t.disabled&&(delete i["aria-selected"],i["aria-disabled"]="true");t.id==null&&delete i["aria-selected"];t._resultId!=null&&(r.id=t._resultId);t.title&&(r.title=t.title);t.children&&(i.role="group",i["aria-label"]=t.text,delete i["aria-selected"]);for(e in i)c=i[e],r.setAttribute(e,c);if(t.children){for(o=n(r),u=document.createElement("strong"),u.className="select2-results__group",v=n(u),this.template(t,u),s=[],f=0;f<t.children.length;f++)l=t.children[f],a=this.option(l),s.push(a);h=n("<ul><\/ul>",{"class":"select2-results__options select2-results__options--nested"});h.append(s);o.append(u);o.append(h)}else this.template(t,r);return n.data(r,"data",t),r},i.prototype.bind=function(t){var i=this,r=t.id+"-results";this.$results.attr("id",r);t.on("results:all",function(n){i.clear();i.append(n.data);t.isOpen()&&(i.setClasses(),i.highlightFirstItem())});t.on("results:append",function(n){i.append(n.data);t.isOpen()&&i.setClasses()});t.on("query",function(n){i.hideMessages();i.showLoading(n)});t.on("select",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())});t.on("unselect",function(){t.isOpen()&&(i.setClasses(),i.highlightFirstItem())});t.on("open",function(){i.$results.attr("aria-expanded","true");i.$results.attr("aria-hidden","false");i.setClasses();i.ensureHighlightVisible()});t.on("close",function(){i.$results.attr("aria-expanded","false");i.$results.attr("aria-hidden","true");i.$results.removeAttr("aria-activedescendant")});t.on("results:toggle",function(){var n=i.getHighlightedResults();n.length!==0&&n.trigger("mouseup")});t.on("results:select",function(){var n=i.getHighlightedResults(),t;n.length!==0&&(t=n.data("data"),n.attr("aria-selected")=="true"?i.trigger("close",{}):i.trigger("select",{data:t}))});t.on("results:previous",function(){var r=i.getHighlightedResults(),u=i.$results.find("[aria-selected]"),f=u.index(r),n,t;if(f!==0){n=f-1;r.length===0&&(n=0);t=u.eq(n);t.trigger("mouseenter");var e=i.$results.offset().top,o=t.offset().top,s=i.$results.scrollTop()+(o-e);n===0?i.$results.scrollTop(0):o-e<0&&i.$results.scrollTop(s)}});t.on("results:next",function(){var e=i.getHighlightedResults(),t=i.$results.find("[aria-selected]"),o=t.index(e),r=o+1,n;if(!(r>=t.length)){n=t.eq(r);n.trigger("mouseenter");var u=i.$results.offset().top+i.$results.outerHeight(!1),f=n.offset().top+n.outerHeight(!1),s=i.$results.scrollTop()+f-u;r===0?i.$results.scrollTop(0):f>u&&i.$results.scrollTop(s)}});t.on("results:focus",function(n){n.element.addClass("select2-results__option--highlighted")});t.on("results:message",function(n){i.displayMessage(n)});if(n.fn.mousewheel)this.$results.on("mousewheel",function(n){var t=i.$results.scrollTop(),r=i.$results.get(0).scrollHeight-t+n.deltaY,u=n.deltaY>0&&t-n.deltaY<=0,f=n.deltaY<0&&r<=i.$results.height();u?(i.$results.scrollTop(0),n.preventDefault(),n.stopPropagation()):f&&(i.$results.scrollTop(i.$results.get(0).scrollHeight-i.$results.height()),n.preventDefault(),n.stopPropagation())});this.$results.on("mouseup",".select2-results__option[aria-selected]",function(t){var r=n(this),u=r.data("data");if(r.attr("aria-selected")==="true"){i.options.get("multiple")?i.trigger("unselect",{originalEvent:t,data:u}):i.trigger("close",{});return}i.trigger("select",{originalEvent:t,data:u})});this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(){var t=n(this).data("data");i.getHighlightedResults().removeClass("select2-results__option--highlighted");i.trigger("results:focus",{data:t,element:n(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var n=this.getHighlightedResults();if(n.length!==0){var f=this.$results.find("[aria-selected]"),e=f.index(n),t=this.$results.offset().top,i=n.offset().top,r=this.$results.scrollTop()+(i-t),u=i-t;r-=n.outerHeight(!1)*2;e<=2?this.$results.scrollTop(0):(u>this.$results.outerHeight()||u<0)&&this.$results.scrollTop(r)}},i.prototype.template=function(t,i){var u=this.options.get("templateResult"),f=this.options.get("escapeMarkup"),r=u(t,i);r==null?i.style.display="none":typeof r=="string"?i.innerHTML=f(r):n(i).append(r)},i});t.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}});t.define("select2/selection/base",["jquery","../utils","../keys"],function(n,t,i){function r(n,t){this.$element=n;this.options=t;r.__super__.constructor.call(this)}return t.Extend(r,t.Observable),r.prototype.render=function(){var t=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"><\/span>');return this._tabindex=0,this.$element.data("old-tabindex")!=null?this._tabindex=this.$element.data("old-tabindex"):this.$element.attr("tabindex")!=null&&(this._tabindex=this.$element.attr("tabindex")),t.attr("title",this.$element.attr("title")),t.attr("tabindex",this._tabindex),this.$selection=t,t},r.prototype.bind=function(n){var t=this,u=n.id+"-container",r=n.id+"-results";this.container=n;this.$selection.on("focus",function(n){t.trigger("focus",n)});this.$selection.on("blur",function(n){t._handleBlur(n)});this.$selection.on("keydown",function(n){t.trigger("keypress",n);n.which===i.SPACE&&n.preventDefault()});n.on("results:focus",function(n){t.$selection.attr("aria-activedescendant",n.data._resultId)});n.on("selection:update",function(n){t.update(n.data)});n.on("open",function(){t.$selection.attr("aria-expanded","true");t.$selection.attr("aria-owns",r);t._attachCloseHandler(n)});n.on("close",function(){t.$selection.attr("aria-expanded","false");t.$selection.removeAttr("aria-activedescendant");t.$selection.removeAttr("aria-owns");t.$selection.focus();t._detachCloseHandler(n)});n.on("enable",function(){t.$selection.attr("tabindex",t._tabindex)});n.on("disable",function(){t.$selection.attr("tabindex","-1")})},r.prototype._handleBlur=function(t){var i=this;window.setTimeout(function(){document.activeElement==i.$selection[0]||n.contains(i.$selection[0],document.activeElement)||i.trigger("blur",t)},1)},r.prototype._attachCloseHandler=function(t){var i=this;n(document.body).on("mousedown.select2."+t.id,function(t){var i=n(t.target),r=i.closest(".select2"),u=n(".select2.select2-container--open");u.each(function(){var i=n(this),t;this!=r[0]&&(t=i.data("element"),t.select2("close"))})})},r.prototype._detachCloseHandler=function(t){n(document.body).off("mousedown.select2."+t.id)},r.prototype.position=function(n,t){var i=t.find(".selection");i.append(n)},r.prototype.destroy=function(){this._detachCloseHandler(this.container)},r.prototype.update=function(){throw new Error("The `update` method must be defined in child classes.");},r});t.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(n,t,i){function r(){r.__super__.constructor.apply(this,arguments)}return i.Extend(r,t),r.prototype.render=function(){var n=r.__super__.render.call(this);return n.addClass("select2-selection--single"),n.html('<span class="select2-selection__rendered"><\/span><span class="select2-selection__arrow" role="presentation"><b role="presentation"><\/b><\/span>'),n},r.prototype.bind=function(n){var t=this,i;r.__super__.bind.apply(this,arguments);i=n.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i);this.$selection.attr("aria-labelledby",i);this.$selection.on("mousedown",function(n){n.which===1&&t.trigger("toggle",{originalEvent:n})});this.$selection.on("focus",function(){});this.$selection.on("blur",function(){});n.on("focus",function(){n.isOpen()||t.$selection.focus()});n.on("selection:update",function(n){t.update(n.data)})},r.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},r.prototype.display=function(n,t){var i=this.options.get("templateSelection"),r=this.options.get("escapeMarkup");return r(i(n,t))},r.prototype.selectionContainer=function(){return n("<span><\/span>")},r.prototype.update=function(n){if(n.length===0){this.clear();return}var t=n[0],i=this.$selection.find(".select2-selection__rendered"),r=this.display(t,i);i.empty().append(r);i.prop("title",t.title||t.text)},r});t.define("select2/selection/multiple",["jquery","./base","../utils"],function(n,t,i){function r(){r.__super__.constructor.apply(this,arguments)}return i.Extend(r,t),r.prototype.render=function(){var n=r.__super__.render.call(this);return n.addClass("select2-selection--multiple"),n.html('<ul class="select2-selection__rendered"><\/ul>'),n},r.prototype.bind=function(){var t=this;r.__super__.bind.apply(this,arguments);this.$selection.on("click",function(n){t.trigger("toggle",{originalEvent:n})});this.$selection.on("click",".select2-selection__choice__remove",function(i){if(!t.options.get("disabled")){var r=n(this),u=r.parent(),f=u.data("data");t.trigger("unselect",{originalEvent:i,data:f})}})},r.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},r.prototype.display=function(n,t){var i=this.options.get("templateSelection"),r=this.options.get("escapeMarkup");return r(i(n,t))},r.prototype.selectionContainer=function(){return n('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;<\/span><\/li>')},r.prototype.update=function(n){var f,r,e;if(this.clear(),n.length!==0){for(f=[],r=0;r<n.length;r++){var u=n[r],t=this.selectionContainer(),o=this.display(u,t);t.append(o);t.prop("title",u.title||u.text);t.data("data",u);f.push(t)}e=this.$selection.find(".select2-selection__rendered");i.appendMany(e,f)}},r});t.define("select2/selection/placeholder",["../utils"],function(){function n(n,t,i){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));n.call(this,t,i)}return n.prototype.normalizePlaceholder=function(n,t){return typeof t=="string"&&(t={id:"",text:t}),t},n.prototype.createPlaceholder=function(n,t){var i=this.selectionContainer();return i.html(this.display(t)),i.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),i},n.prototype.update=function(n,t){var r=t.length==1&&t[0].id!=this.placeholder.id,u=t.length>1,i;if(u||r)return n.call(this,t);this.clear();i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},n});t.define("select2/selection/allowClear",["jquery","../keys"],function(n,t){function i(){}return i.prototype.bind=function(n,t,i){var r=this;n.call(this,t,i);this.placeholder==null&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option.");this.$selection.on("mousedown",".select2-selection__clear",function(n){r._handleClear(n)});t.on("keypress",function(n){r._handleKeyboardClear(n,t)})},i.prototype._handleClear=function(n,t){var r,u,i,f;if(!this.options.get("disabled")&&(r=this.$selection.find(".select2-selection__clear"),r.length!==0)){for(t.stopPropagation(),u=r.data("data"),i=0;i<u.length;i++)if(f={data:u[i]},this.trigger("unselect",f),f.prevented)return;this.$element.val(this.placeholder.id).trigger("change");this.trigger("toggle",{})}},i.prototype._handleKeyboardClear=function(n,i,r){r.isOpen()||(i.which==t.DELETE||i.which==t.BACKSPACE)&&this._handleClear(i)},i.prototype.update=function(t,i){if(t.call(this,i),!(this.$selection.find(".select2-selection__placeholder").length>0)&&i.length!==0){var r=n('<span class="select2-selection__clear">&times;<\/span>');r.data("data",i);this.$selection.find(".select2-selection__rendered").prepend(r)}},i});t.define("select2/selection/search",["jquery","../utils","../keys"],function(n,t,i){function r(n,t,i){n.call(this,t,i)}return r.prototype.render=function(t){var i=n('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /><\/li>'),r;return this.$searchContainer=i,this.$search=i.find("input"),r=t.call(this),this._transferTabIndex(),r},r.prototype.bind=function(n,t,r){var u=this,f,e;n.call(this,t,r);t.on("open",function(){u.$search.trigger("focus")});t.on("close",function(){u.$search.val("");u.$search.removeAttr("aria-activedescendant");u.$search.trigger("focus")});t.on("enable",function(){u.$search.prop("disabled",!1);u._transferTabIndex()});t.on("disable",function(){u.$search.prop("disabled",!0)});t.on("focus",function(){u.$search.trigger("focus")});t.on("results:focus",function(n){u.$search.attr("aria-activedescendant",n.id)});this.$selection.on("focusin",".select2-search--inline",function(n){u.trigger("focus",n)});this.$selection.on("focusout",".select2-search--inline",function(n){u._handleBlur(n)});this.$selection.on("keydown",".select2-search--inline",function(n){var r,t,f;n.stopPropagation();u.trigger("keypress",n);u._keyUpPrevented=n.isDefaultPrevented();r=n.which;r===i.BACKSPACE&&u.$search.val()===""&&(t=u.$searchContainer.prev(".select2-selection__choice"),t.length>0&&(f=t.data("data"),u.searchRemoveChoice(f),n.preventDefault()))});f=document.documentMode;e=f&&f<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(){if(e){u.$selection.off("input.search input.searchcheck");return}u.$selection.off("keyup.search")});this.$selection.on("keyup.search input.search",".select2-search--inline",function(n){if(e&&n.type==="input"){u.$selection.off("input.search input.searchcheck");return}var t=n.which;t!=i.SHIFT&&t!=i.CTRL&&t!=i.ALT&&t!=i.TAB&&u.handleSearch(n)})},r.prototype._transferTabIndex=function(){this.$search.attr("tabindex",this.$selection.attr("tabindex"));this.$selection.attr("tabindex","-1")},r.prototype.createPlaceholder=function(n,t){this.$search.attr("placeholder",t.text)},r.prototype.update=function(n,t){var i=this.$search[0]==document.activeElement;this.$search.attr("placeholder","");n.call(this,t);this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);this.resizeSearch();i&&this.$search.focus()},r.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var n=this.$search.val();this.trigger("query",{term:n})}this._keyUpPrevented=!1},r.prototype.searchRemoveChoice=function(n,t){this.trigger("unselect",{data:t});this.$search.val(t.text);this.handleSearch()},r.prototype.resizeSearch=function(){var n,t;this.$search.css("width","25px");n="";this.$search.attr("placeholder")!==""?n=this.$selection.find(".select2-selection__rendered").innerWidth():(t=this.$search.val().length+1,n=t*.75+"em");this.$search.css("width",n)},r});t.define("select2/selection/eventRelay",["jquery"],function(n){function t(){}return t.prototype.bind=function(t,i,r){var u=this,f=["open","opening","close","closing","select","selecting","unselect","unselecting"],e=["opening","closing","selecting","unselecting"];t.call(this,i,r);i.on("*",function(t,i){if(n.inArray(t,f)!==-1){i=i||{};var r=n.Event("select2:"+t,{params:i});(u.$element.trigger(r),n.inArray(t,e)!==-1)&&(i.prevented=r.isDefaultPrevented())}})},t});t.define("select2/translation",["jquery","require"],function(n,t){function i(n){this.dict=n||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(n){return this.dict[n]},i.prototype.extend=function(t){this.dict=n.extend({},t.all(),this.dict)},i._cache={},i.loadPath=function(n){if(!(n in i._cache)){var r=t(n);i._cache[n]=r}return new i(i._cache[n])},i});t.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"}});t.define("select2/data/base",["../utils"],function(n){function t(){t.__super__.constructor.call(this)}return n.Extend(t,n.Observable),t.prototype.current=function(){throw new Error("The `current` method must be defined in child classes.");},t.prototype.query=function(){throw new Error("The `query` method must be defined in child classes.");},t.prototype.bind=function(){},t.prototype.destroy=function(){},t.prototype.generateResultId=function(t,i){var r=t.id+"-result-";return r+=n.generateChars(4),r+(i.id!=null?"-"+i.id.toString():"-"+n.generateChars(4))},t});t.define("select2/data/select",["./base","../utils","jquery"],function(n,t,i){function r(n,t){this.$element=n;this.options=t;r.__super__.constructor.call(this)}return t.Extend(r,n),r.prototype.current=function(n){var t=[],r=this;this.$element.find(":selected").each(function(){var n=i(this),u=r.item(n);t.push(u)});n(t)},r.prototype.select=function(n){var t=this,r;if(n.selected=!0,i(n.element).is("option")){n.element.selected=!0;this.$element.trigger("change");return}this.$element.prop("multiple")?this.current(function(r){var f=[],u,e;for(n=[n],n.push.apply(n,r),u=0;u<n.length;u++)e=n[u].id,i.inArray(e,f)===-1&&f.push(e);t.$element.val(f);t.$element.trigger("change")}):(r=n.id,this.$element.val(r),this.$element.trigger("change"))},r.prototype.unselect=function(n){var t=this;if(this.$element.prop("multiple")){if(n.selected=!1,i(n.element).is("option")){n.element.selected=!1;this.$element.trigger("change");return}this.current(function(r){for(var u,f=[],e=0;e<r.length;e++)u=r[e].id,u!==n.id&&i.inArray(u,f)===-1&&f.push(u);t.$element.val(f);t.$element.trigger("change")})}},r.prototype.bind=function(n){var t=this;this.container=n;n.on("select",function(n){t.select(n.data)});n.on("unselect",function(n){t.unselect(n.data)})},r.prototype.destroy=function(){this.$element.find("*").each(function(){i.removeData(this,"data")})},r.prototype.query=function(n,t){var r=[],u=this,f=this.$element.children();f.each(function(){var t=i(this),e,f;(t.is("option")||t.is("optgroup"))&&(e=u.item(t),f=u.matches(n,e),f!==null&&r.push(f))});t({results:r})},r.prototype.addOptions=function(n){t.appendMany(this.$element,n)},r.prototype.option=function(n){var t,u,r;return n.children?(t=document.createElement("optgroup"),t.label=n.text):(t=document.createElement("option"),t.textContent!==undefined?t.textContent=n.text:t.innerText=n.text),n.id&&(t.value=n.id),n.disabled&&(t.disabled=!0),n.selected&&(t.selected=!0),n.title&&(t.title=n.title),u=i(t),r=this._normalizeItem(n),r.element=t,i.data(t,"data",r),u},r.prototype.item=function(n){var t={},u,f,r,e,o;if(t=i.data(n[0],"data"),t!=null)return t;if(n.is("option"))t={id:n.val(),text:n.text(),disabled:n.prop("disabled"),selected:n.prop("selected"),title:n.prop("title")};else if(n.is("optgroup")){for(t={text:n.prop("label"),children:[],title:n.prop("title")},u=n.children("option"),f=[],r=0;r<u.length;r++)e=i(u[r]),o=this.item(e),f.push(o);t.children=f}return t=this._normalizeItem(t),t.element=n[0],i.data(n[0],"data",t),t},r.prototype._normalizeItem=function(n){i.isPlainObject(n)||(n={id:n,text:n});n=i.extend({},{text:""},n);return n.id!=null&&(n.id=n.id.toString()),n.text!=null&&(n.text=n.text.toString()),n._resultId==null&&n.id&&this.container!=null&&(n._resultId=this.generateResultId(this.container,n)),i.extend({},{selected:!1,disabled:!1},n)},r.prototype.matches=function(n,t){var i=this.options.get("matcher");return i(n,t)},r});t.define("select2/data/array",["./select","../utils","jquery"],function(n,t,i){function r(n,t){var i=t.get("data")||[];r.__super__.constructor.call(this,n,t);this.addOptions(this.convertToOptions(i))}return t.Extend(r,n),r.prototype.select=function(n){var t=this.$element.find("option").filter(function(t,i){return i.value==n.id.toString()});t.length===0&&(t=this.option(n),this.addOptions(t));r.__super__.select.call(this,n)},r.prototype.convertToOptions=function(n){function a(n){return function(){return i(this).val()==n.id}}for(var r,f,h,c=this,e=this.$element.find("option"),l=e.map(function(){return c.item(i(this)).id}).get(),o=[],u=0;u<n.length;u++){if(r=this._normalizeItem(n[u]),i.inArray(r.id,l)>=0){var s=e.filter(a(r)),v=this.item(s),y=i.extend(!0,{},r,v),p=this.option(y);s.replaceWith(p);continue}f=this.option(r);r.children&&(h=this.convertToOptions(r.children),t.appendMany(f,h));o.push(f)}return o},r});t.define("select2/data/ajax",["./array","../utils","jquery"],function(n,t,i){function r(n,t){this.ajaxOptions=this._applyDefaults(t.get("ajax"));this.ajaxOptions.processResults!=null&&(this.processResults=this.ajaxOptions.processResults);r.__super__.constructor.call(this,n,t)}return t.Extend(r,n),r.prototype._applyDefaults=function(n){var t={data:function(n){return i.extend({},n,{q:n.term})},transport:function(n,t,r){var u=i.ajax(n);return u.then(t),u.fail(r),u}};return i.extend({},t,n,!0)},r.prototype.processResults=function(n){return n},r.prototype.query=function(n,t){function f(){var f=r.transport(r,function(r){var f=u.processResults(r,n);u.options.get("debug")&&window.console&&console.error&&(f&&f.results&&i.isArray(f.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response."));t(f)},function(){f.status&&f.status==="0"||u.trigger("results:message",{message:"errorLoading"})});u._request=f}var u=this,r;this._request!=null&&(i.isFunction(this._request.abort)&&this._request.abort(),this._request=null);r=i.extend({type:"GET"},this.ajaxOptions);typeof r.url=="function"&&(r.url=r.url.call(this.$element,n));typeof r.data=="function"&&(r.data=r.data.call(this.$element,n));this.ajaxOptions.delay&&n.term!=null?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(f,this.ajaxOptions.delay)):f()},r});t.define("select2/data/tags",["jquery"],function(n){function t(t,i,r){var f=r.get("tags"),o=r.get("createTag"),e,u;if(o!==undefined&&(this.createTag=o),e=r.get("insertTag"),e!==undefined&&(this.insertTag=e),t.call(this,i,r),n.isArray(f))for(u=0;u<f.length;u++){var s=f[u],h=this._normalizeItem(s),c=this.option(h);this.$element.append(c)}}return t.prototype.query=function(n,t,i){function u(n,f){for(var o,c,e=n.results,s=0;s<e.length;s++){var h=e[s],l=h.children!=null&&!u({results:h.children},!0),a=h.text===t.term;if(a||l){if(f)return!1;n.data=e;i(n);return}}if(f)return!0;o=r.createTag(t);o!=null&&(c=r.option(o),c.attr("data-select2-tag",!0),r.addOptions([c]),r.insertTag(e,o));n.results=e;i(n)}var r=this;if(this._removeOldTags(),t.term==null||t.page!=null){n.call(this,t,i);return}n.call(this,t,u)},t.prototype.createTag=function(t,i){var r=n.trim(i.term);return r===""?null:{id:r,text:r}},t.prototype.insertTag=function(n,t,i){t.unshift(i)},t.prototype._removeOldTags=function(){var i=this._lastTag,t=this.$element.find("option[data-select2-tag]");t.each(function(){this.selected||n(this).remove()})},t});t.define("select2/data/tokenizer",["jquery"],function(n){function t(n,t,i){var r=i.get("tokenizer");r!==undefined&&(this.tokenizer=r);n.call(this,t,i)}return t.prototype.bind=function(n,t,i){n.call(this,t,i);this.$search=t.dropdown.$search||t.selection.$search||i.find(".select2-search__field")},t.prototype.query=function(t,i,r){function e(t){var i=u._normalizeItem(t),f=u.$element.find("option").filter(function(){return n(this).val()===i.id}),r;f.length||(r=u.option(i),r.attr("data-select2-tag",!0),u._removeOldTags(),u.addOptions([r]));o(i)}function o(n){u.trigger("select",{data:n})}var u=this,f;i.term=i.term||"";f=this.tokenizer(i,this.options,e);f.term!==i.term&&(this.$search.length&&(this.$search.val(f.term),this.$search.focus()),i.term=f.term);t.call(this,i,r)},t.prototype.tokenizer=function(t,i,r,u){for(var h=r.get("tokenSeparators")||[],e=i.term,f=0,c=this.createTag||function(n){return{id:n.term,text:n.term}},o;f<e.length;){if(o=e[f],n.inArray(o,h)===-1){f++;continue}var l=e.substr(0,f),a=n.extend({},i,{term:l}),s=c(a);if(s==null){f++;continue}u(s);e=e.substr(f+1)||"";f=0}return{term:e}},t});t.define("select2/data/minimumInputLength",[],function(){function n(n,t,i){this.minimumInputLength=i.get("minimumInputLength");n.call(this,t,i)}return n.prototype.query=function(n,t,i){if(t.term=t.term||"",t.term.length<this.minimumInputLength){this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}});return}n.call(this,t,i)},n});t.define("select2/data/maximumInputLength",[],function(){function n(n,t,i){this.maximumInputLength=i.get("maximumInputLength");n.call(this,t,i)}return n.prototype.query=function(n,t,i){if(t.term=t.term||"",this.maximumInputLength>0&&t.term.length>this.maximumInputLength){this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}});return}n.call(this,t,i)},n});t.define("select2/data/maximumSelectionLength",[],function(){function n(n,t,i){this.maximumSelectionLength=i.get("maximumSelectionLength");n.call(this,t,i)}return n.prototype.query=function(n,t,i){var r=this;this.current(function(u){var f=u!=null?u.length:0;if(r.maximumSelectionLength>0&&f>=r.maximumSelectionLength){r.trigger("results:message",{message:"maximumSelected",args:{maximum:r.maximumSelectionLength}});return}n.call(r,t,i)})},n});t.define("select2/dropdown",["jquery","./utils"],function(n,t){function i(n,t){this.$element=n;this.options=t;i.__super__.constructor.call(this)}return t.Extend(i,t.Observable),i.prototype.render=function(){var t=n('<span class="select2-dropdown"><span class="select2-results"><\/span><\/span>');return t.attr("dir",this.options.get("dir")),this.$dropdown=t,t},i.prototype.bind=function(){},i.prototype.position=function(){},i.prototype.destroy=function(){this.$dropdown.remove()},i});t.define("select2/dropdown/search",["jquery","../utils"],function(n){function t(){}return t.prototype.render=function(t){var r=t.call(this),i=n('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /><\/span>');return this.$searchContainer=i,this.$search=i.find("input"),r.prepend(i),r},t.prototype.bind=function(t,i,r){var u=this;t.call(this,i,r);this.$search.on("keydown",function(n){u.trigger("keypress",n);u._keyUpPrevented=n.isDefaultPrevented()});this.$search.on("input",function(){n(this).off("keyup")});this.$search.on("keyup input",function(n){u.handleSearch(n)});i.on("open",function(){u.$search.attr("tabindex",0);u.$search.focus();window.setTimeout(function(){u.$search.focus()},0)});i.on("close",function(){u.$search.attr("tabindex",-1);u.$search.val("")});i.on("focus",function(){i.isOpen()&&u.$search.focus()});i.on("results:all",function(n){if(n.query.term==null||n.query.term===""){var t=u.showSearch(n);t?u.$searchContainer.removeClass("select2-search--hide"):u.$searchContainer.addClass("select2-search--hide")}})},t.prototype.handleSearch=function(){if(!this._keyUpPrevented){var n=this.$search.val();this.trigger("query",{term:n})}this._keyUpPrevented=!1},t.prototype.showSearch=function(){return!0},t});t.define("select2/dropdown/hidePlaceholder",[],function(){function n(n,t,i,r){this.placeholder=this.normalizePlaceholder(i.get("placeholder"));n.call(this,t,i,r)}return n.prototype.append=function(n,t){t.results=this.removePlaceholder(t.results);n.call(this,t)},n.prototype.normalizePlaceholder=function(n,t){return typeof t=="string"&&(t={id:"",text:t}),t},n.prototype.removePlaceholder=function(n,t){for(var u,r=t.slice(0),i=t.length-1;i>=0;i--)u=t[i],this.placeholder.id===u.id&&r.splice(i,1);return r},n});t.define("select2/dropdown/infiniteScroll",["jquery"],function(n){function t(n,t,i,r){this.lastParams={};n.call(this,t,i,r);this.$loadingMore=this.createLoadingMore();this.loading=!1}return t.prototype.append=function(n,t){this.$loadingMore.remove();this.loading=!1;n.call(this,t);this.showLoadingMore(t)&&this.$results.append(this.$loadingMore)},t.prototype.bind=function(t,i,r){var u=this;t.call(this,i,r);i.on("query",function(n){u.lastParams=n;u.loading=!0});i.on("query:append",function(n){u.lastParams=n;u.loading=!0});this.$results.on("scroll",function(){var r=n.contains(document.documentElement,u.$loadingMore[0]),t,i;!u.loading&&r&&(t=u.$results.offset().top+u.$results.outerHeight(!1),i=u.$loadingMore.offset().top+u.$loadingMore.outerHeight(!1),t+50>=i&&u.loadMore())})},t.prototype.loadMore=function(){this.loading=!0;var t=n.extend({},{page:1},this.lastParams);t.page++;this.trigger("query:append",t)},t.prototype.showLoadingMore=function(n,t){return t.pagination&&t.pagination.more},t.prototype.createLoadingMore=function(){var t=n('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"><\/li>'),i=this.options.get("translations").get("loadingMore");return t.html(i(this.lastParams)),t},t});t.define("select2/dropdown/attachBody",["jquery","../utils"],function(n,t){function i(t,i,r){this.$dropdownParent=r.get("dropdownParent")||n(document.body);t.call(this,i,r)}return i.prototype.bind=function(n,t,i){var r=this,u=!1;n.call(this,t,i);t.on("open",function(){if(r._showDropdown(),r._attachPositioningHandler(t),!u){u=!0;t.on("results:all",function(){r._positionDropdown();r._resizeDropdown()});t.on("results:append",function(){r._positionDropdown();r._resizeDropdown()})}});t.on("close",function(){r._hideDropdown();r._detachPositioningHandler(t)});this.$dropdownContainer.on("mousedown",function(n){n.stopPropagation()})},i.prototype.destroy=function(n){n.call(this);this.$dropdownContainer.remove()},i.prototype.position=function(n,t,i){t.attr("class",i.attr("class"));t.removeClass("select2");t.addClass("select2-container--open");t.css({position:"absolute",top:-999999});this.$container=i},i.prototype.render=function(t){var i=n("<span><\/span>"),r=t.call(this);return i.append(r),this.$dropdownContainer=i,i},i.prototype._hideDropdown=function(){this.$dropdownContainer.detach()},i.prototype._attachPositioningHandler=function(i,r){var u=this,f="scroll.select2."+r.id,o="resize.select2."+r.id,s="orientationchange.select2."+r.id,e=this.$container.parents().filter(t.hasScroll);e.each(function(){n(this).data("select2-scroll-position",{x:n(this).scrollLeft(),y:n(this).scrollTop()})});e.on(f,function(){var t=n(this).data("select2-scroll-position");n(this).scrollTop(t.y)});n(window).on(f+" "+o+" "+s,function(){u._positionDropdown();u._resizeDropdown()})},i.prototype._detachPositioningHandler=function(i,r){var u="scroll.select2."+r.id,f="resize.select2."+r.id,e="orientationchange.select2."+r.id,o=this.$container.parents().filter(t.hasScroll);o.off(u);n(window).off(u+" "+f+" "+e)},i.prototype._positionDropdown=function(){var s=n(window),u=this.$dropdown.hasClass("select2-dropdown--above"),v=this.$dropdown.hasClass("select2-dropdown--below"),t=null,i=this.$container.offset(),r,o;i.bottom=i.top+this.$container.outerHeight(!1);r={height:this.$container.outerHeight(!1)};r.top=i.top;r.bottom=i.top+r.height;var h={height:this.$dropdown.outerHeight(!1)},c={top:s.scrollTop(),bottom:s.scrollTop()+s.height()},l=c.top<i.top-h.height,a=c.bottom>i.bottom+h.height,f={left:i.left,top:r.bottom},e=this.$dropdownParent;e.css("position")==="static"&&(e=e.offsetParent());o=e.offset();f.top-=o.top;f.left-=o.left;u||v||(t="below");a||!l||u?!l&&a&&u&&(t="below"):t="above";(t=="above"||u&&t!=="below")&&(f.top=r.top-o.top-h.height);t!=null&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+t),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+t));this.$dropdownContainer.css(f)},i.prototype._resizeDropdown=function(){var n={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(n.minWidth=n.width,n.position="relative",n.width="auto");this.$dropdown.css(n)},i.prototype._showDropdown=function(){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()},i});t.define("select2/dropdown/minimumResultsForSearch",[],function(){function n(t){for(var u,i=0,r=0;r<t.length;r++)u=t[r],u.children?i+=n(u.children):i++;return i}function t(n,t,i,r){this.minimumResultsForSearch=i.get("minimumResultsForSearch");this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=Infinity);n.call(this,t,i,r)}return t.prototype.showSearch=function(t,i){return n(i.data.results)<this.minimumResultsForSearch?!1:t.call(this,i)},t});t.define("select2/dropdown/selectOnClose",[],function(){function n(){}return n.prototype.bind=function(n,t,i){var r=this;n.call(this,t,i);t.on("close",function(n){r._handleSelectOnClose(n)})},n.prototype._handleSelectOnClose=function(n,t){var r,u,i;t&&t.originalSelect2Event!=null&&(r=t.originalSelect2Event,r._type==="select"||r._type==="unselect")||(u=this.getHighlightedResults(),u.length<1)||(i=u.data("data"),i.element!=null&&i.element.selected||i.element==null&&i.selected)||this.trigger("select",{data:i})},n});t.define("select2/dropdown/closeOnSelect",[],function(){function n(){}return n.prototype.bind=function(n,t,i){var r=this;n.call(this,t,i);t.on("select",function(n){r._selectTriggered(n)});t.on("unselect",function(n){r._selectTriggered(n)})},n.prototype._selectTriggered=function(n,t){var i=t.originalEvent;i&&i.ctrlKey||this.trigger("close",{originalEvent:i,originalSelect2Event:t})},n});t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(n){var t=n.input.length-n.maximum,i="Please delete "+t+" character";return t!=1&&(i+="s"),i},inputTooShort:function(n){var t=n.minimum-n.input.length;return"Please enter "+t+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(n){var t="You can only select "+n.maximum+" item";return n.maximum!=1&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}});t.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){function st(){this.reset()}st.prototype.apply=function(l){var vt,yt,pt,wt,bt,kt,dt,ct,lt,st,ot,ht,gt,at;if(l=n.extend(!0,{},this.defaults,l),l.dataAdapter==null&&(l.dataAdapter=l.ajax!=null?y:l.data!=null?v:a,l.minimumInputLength>0&&(l.dataAdapter=h.Decorate(l.dataAdapter,b)),l.maximumInputLength>0&&(l.dataAdapter=h.Decorate(l.dataAdapter,k)),l.maximumSelectionLength>0&&(l.dataAdapter=h.Decorate(l.dataAdapter,d)),l.tags&&(l.dataAdapter=h.Decorate(l.dataAdapter,p)),(l.tokenSeparators!=null||l.tokenizer!=null)&&(l.dataAdapter=h.Decorate(l.dataAdapter,w)),l.query!=null&&(vt=t(l.amdBase+"compat/query"),l.dataAdapter=h.Decorate(l.dataAdapter,vt)),l.initSelection!=null&&(yt=t(l.amdBase+"compat/initSelection"),l.dataAdapter=h.Decorate(l.dataAdapter,yt))),l.resultsAdapter==null&&(l.resultsAdapter=i,l.ajax!=null&&(l.resultsAdapter=h.Decorate(l.resultsAdapter,it)),l.placeholder!=null&&(l.resultsAdapter=h.Decorate(l.resultsAdapter,tt)),l.selectOnClose&&(l.resultsAdapter=h.Decorate(l.resultsAdapter,ft))),l.dropdownAdapter==null&&(l.multiple?l.dropdownAdapter=g:(pt=h.Decorate(g,nt),l.dropdownAdapter=pt),l.minimumResultsForSearch!==0&&(l.dropdownAdapter=h.Decorate(l.dropdownAdapter,ut)),l.closeOnSelect&&(l.dropdownAdapter=h.Decorate(l.dropdownAdapter,et)),(l.dropdownCssClass!=null||l.dropdownCss!=null||l.adaptDropdownCssClass!=null)&&(wt=t(l.amdBase+"compat/dropdownCss"),l.dropdownAdapter=h.Decorate(l.dropdownAdapter,wt)),l.dropdownAdapter=h.Decorate(l.dropdownAdapter,rt)),l.selectionAdapter==null&&(l.selectionAdapter=l.multiple?u:r,l.placeholder!=null&&(l.selectionAdapter=h.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=h.Decorate(l.selectionAdapter,e)),l.multiple&&(l.selectionAdapter=h.Decorate(l.selectionAdapter,o)),(l.containerCssClass!=null||l.containerCss!=null||l.adaptContainerCssClass!=null)&&(bt=t(l.amdBase+"compat/containerCss"),l.selectionAdapter=h.Decorate(l.selectionAdapter,bt)),l.selectionAdapter=h.Decorate(l.selectionAdapter,s)),typeof l.language=="string"&&(l.language.indexOf("-")>0?(kt=l.language.split("-"),dt=kt[0],l.language=[l.language,dt]):l.language=[l.language]),n.isArray(l.language)){for(ct=new c,l.language.push("en"),lt=l.language,st=0;st<lt.length;st++){ot=lt[st];ht={};try{ht=c.loadPath(ot)}catch(ni){try{ot=this.defaults.amdLanguageBase+ot;ht=c.loadPath(ot)}catch(ti){l.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+ot+'" could not be automatically loaded. A fallback will be used instead.');continue}}ct.extend(ht)}l.translations=ct}else gt=c.loadPath(this.defaults.amdLanguageBase+"en"),at=new c(l.language),at.extend(gt),l.translations=at;return l};st.prototype.reset=function(){function i(n){function t(n){return l[n]||n}return n.replace(/[^\u0000-\u007E]/g,t)}function t(r,u){var f,e,o,s,h,c;if(n.trim(r.term)==="")return u;if(u.children&&u.children.length>0){for(f=n.extend(!0,{},u),e=u.children.length-1;e>=0;e--)o=u.children[e],s=t(r,o),s==null&&f.children.splice(e,1);return f.children.length>0?f:t(r,f)}return(h=i(u.text).toUpperCase(),c=i(r.term).toUpperCase(),h.indexOf(c)>-1)?u:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:h.escapeMarkup,language:ot,matcher:t,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(n){return n},templateResult:function(n){return n.text},templateSelection:function(n){return n.text},theme:"default",width:"resolve"}};st.prototype.set=function(t,i){var f=n.camelCase(t),r={},u;r[f]=i;u=h._convertData(r);n.extend(this.defaults,u)};return new st});t.define("select2/options",["require","jquery","./defaults","./utils"],function(n,t,i,r){function u(t,u){if(this.options=t,u!=null&&this.fromElement(u),this.options=i.apply(this.options),u&&u.is("input")){var f=n(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=r.Decorate(this.options.dataAdapter,f)}}return u.prototype.fromElement=function(n){var e=["select2"],f,u,i;this.options.multiple==null&&(this.options.multiple=n.prop("multiple"));this.options.disabled==null&&(this.options.disabled=n.prop("disabled"));this.options.language==null&&(n.prop("lang")?this.options.language=n.prop("lang").toLowerCase():n.closest("[lang]").prop("lang")&&(this.options.language=n.closest("[lang]").prop("lang")));this.options.dir==null&&(this.options.dir=n.prop("dir")?n.prop("dir"):n.closest("[dir]").prop("dir")?n.closest("[dir]").prop("dir"):"ltr");n.prop("disabled",this.options.disabled);n.prop("multiple",this.options.multiple);n.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),n.data("data",n.data("select2Tags")),n.data("tags",!0));n.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),n.attr("ajax--url",n.data("ajaxUrl")),n.data("ajax--url",n.data("ajaxUrl")));f={};f=t.fn.jquery&&t.fn.jquery.substr(0,2)=="1."&&n[0].dataset?t.extend(!0,{},n[0].dataset,n.data()):n.data();u=t.extend(!0,{},f);u=r._convertData(u);for(i in u)t.inArray(i,e)>-1||(t.isPlainObject(this.options[i])?t.extend(this.options[i],u[i]):this.options[i]=u[i]);return this},u.prototype.get=function(n){return this.options[n]},u.prototype.set=function(n,t){this.options[n]=t},u});t.define("select2/core",["jquery","./options","./utils","./keys"],function(n,t,i,r){var u=function(n,i){var f,e,r,o,s,h,c;n.data("select2")!=null&&n.data("select2").destroy();this.$element=n;this.id=this._generateId(n);i=i||{};this.options=new t(i,n);u.__super__.constructor.call(this);f=n.attr("tabindex")||0;n.data("old-tabindex",f);n.attr("tabindex","-1");e=this.options.get("dataAdapter");this.dataAdapter=new e(n,this.options);r=this.render();this._placeContainer(r);o=this.options.get("selectionAdapter");this.selection=new o(n,this.options);this.$selection=this.selection.render();this.selection.position(this.$selection,r);s=this.options.get("dropdownAdapter");this.dropdown=new s(n,this.options);this.$dropdown=this.dropdown.render();this.dropdown.position(this.$dropdown,r);h=this.options.get("resultsAdapter");this.results=new h(n,this.options,this.dataAdapter);this.$results=this.results.render();this.results.position(this.$results,this.$dropdown);c=this;this._bindAdapters();this._registerDomEvents();this._registerDataEvents();this._registerSelectionEvents();this._registerDropdownEvents();this._registerResultsEvents();this._registerEvents();this.dataAdapter.current(function(n){c.trigger("selection:update",{data:n})});n.addClass("select2-hidden-accessible");n.attr("aria-hidden","true");this._syncAttributes();n.data("select2",this)};return i.Extend(u,i.Observable),u.prototype._generateId=function(n){var t="";return t=n.attr("id")!=null?n.attr("id"):n.attr("name")!=null?n.attr("name")+"-"+i.generateChars(2):i.generateChars(4),t=t.replace(/(:|\.|\[|\]|,)/g,""),"select2-"+t},u.prototype._placeContainer=function(n){n.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));t!=null&&n.css("width",t)},u.prototype._resolveWidth=function(n,t){var u,f,e,o,i,s,h,r;if(t=="resolve")return(u=this._resolveWidth(n,"style"),u!=null)?u:this._resolveWidth(n,"element");if(t=="element")return(f=n.outerWidth(!1),f<=0)?"auto":f+"px";if(t=="style"){if(e=n.attr("style"),typeof e!="string")return null;for(o=e.split(";"),i=0,s=o.length;i<s;i=i+1)if(h=o[i].replace(/\s/g,""),r=h.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),r!==null&&r.length>=1)return r[1];return null}return t},u.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container);this.selection.bind(this,this.$container);this.dropdown.bind(this,this.$container);this.results.bind(this,this.$container)},u.prototype._registerDomEvents=function(){var t=this,r;this.$element.on("change.select2",function(){t.dataAdapter.current(function(n){t.trigger("selection:update",{data:n})})});this.$element.on("focus.select2",function(n){t.trigger("focus",n)});this._syncA=i.bind(this._syncAttributes,this);this._syncS=i.bind(this._syncSubtree,this);this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;r!=null?(this._observer=new r(function(i){n.each(i,t._syncA);n.each(i,t._syncS)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},u.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(t,i){n.trigger(t,i)})},u.prototype._registerSelectionEvents=function(){var t=this,i=["toggle","focus"];this.selection.on("toggle",function(){t.toggleDropdown()});this.selection.on("focus",function(n){t.focus(n)});this.selection.on("*",function(r,u){n.inArray(r,i)===-1&&t.trigger(r,u)})},u.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(t,i){n.trigger(t,i)})},u.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(t,i){n.trigger(t,i)})},u.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container.addClass("select2-container--open")});this.on("close",function(){n.$container.removeClass("select2-container--open")});this.on("enable",function(){n.$container.removeClass("select2-container--disabled")});this.on("disable",function(){n.$container.addClass("select2-container--disabled")});this.on("blur",function(){n.$container.removeClass("select2-container--focus")});this.on("query",function(t){n.isOpen()||n.trigger("open",{});this.dataAdapter.query(t,function(i){n.trigger("results:all",{data:i,query:t})})});this.on("query:append",function(t){this.dataAdapter.query(t,function(i){n.trigger("results:append",{data:i,query:t})})});this.on("keypress",function(t){var i=t.which;n.isOpen()?i===r.ESC||i===r.TAB||i===r.UP&&t.altKey?(n.close(),t.preventDefault()):i===r.ENTER?(n.trigger("results:select",{}),t.preventDefault()):i===r.SPACE&&t.ctrlKey?(n.trigger("results:toggle",{}),t.preventDefault()):i===r.UP?(n.trigger("results:previous",{}),t.preventDefault()):i===r.DOWN&&(n.trigger("results:next",{}),t.preventDefault()):(i===r.ENTER||i===r.SPACE||i===r.DOWN&&t.altKey)&&(n.open(),t.preventDefault())})},u.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled"));this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},u.prototype._syncSubtree=function(n,t){var i=!1,f=this,r,u;if(!n||!n.target||n.target.nodeName==="OPTION"||n.target.nodeName==="OPTGROUP"){if(t)if(t.addedNodes&&t.addedNodes.length>0)for(r=0;r<t.addedNodes.length;r++)u=t.addedNodes[r],u.selected&&(i=!0);else t.removedNodes&&t.removedNodes.length>0&&(i=!0);else i=!0;i&&this.dataAdapter.current(function(n){f.trigger("selection:update",{data:n})})}},u.prototype.trigger=function(n,t){var r=u.__super__.trigger,f={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"},e,i;if(t===undefined&&(t={}),n in f&&(e=f[n],i={prevented:!1,name:n,args:t},r.call(this,e,i),i.prevented)){t.prevented=!0;return}r.call(this,n,t)},u.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},u.prototype.open=function(){this.isOpen()||this.trigger("query",{})},u.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},u.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},u.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},u.prototype.focus=function(){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},u.prototype.enable=function(n){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.');(n==null||n.length===0)&&(n=[!0]);var t=!n[0];this.$element.prop("disabled",t)},u.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var n=[];return this.dataAdapter.current(function(t){n=t}),n},u.prototype.val=function(t){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),t==null||t.length===0)return this.$element.val();var i=t[0];n.isArray(i)&&(i=n.map(i,function(n){return n.toString()}));this.$element.val(i).trigger("change")},u.prototype.destroy=function(){this.$container.remove();this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA);this._observer!=null?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1));this._syncA=null;this._syncS=null;this.$element.off(".select2");this.$element.attr("tabindex",this.$element.data("old-tabindex"));this.$element.removeClass("select2-hidden-accessible");this.$element.attr("aria-hidden","false");this.$element.removeData("select2");this.dataAdapter.destroy();this.selection.destroy();this.dropdown.destroy();this.results.destroy();this.dataAdapter=null;this.selection=null;this.dropdown=null;this.results=null},u.prototype.render=function(){var t=n('<span class="select2 select2-container"><span class="selection"><\/span><span class="dropdown-wrapper" aria-hidden="true"><\/span><\/span>');return t.attr("dir",this.options.get("dir")),this.$container=t,this.$container.addClass("select2-container--"+this.options.get("theme")),t.data("element",this.$element),t},u});t.define("select2/compat/utils",["jquery"],function(n){function t(t,i,r){var u,f=[],e;u=n.trim(t.attr("class"));u&&(u=""+u,n(u.split(/\s+/)).each(function(){this.indexOf("select2-")===0&&f.push(this)}));u=n.trim(i.attr("class"));u&&(u=""+u,n(u.split(/\s+/)).each(function(){this.indexOf("select2-")!==0&&(e=r(this),e!=null&&f.push(e))}));t.attr("class",f.join(" "))}return{syncCssClasses:t}});t.define("select2/compat/containerCss",["jquery","./utils"],function(n,t){function r(){return null}function i(){}return i.prototype.render=function(i){var o=i.call(this),u=this.options.get("containerCssClass")||"",f,s,e;return n.isFunction(u)&&(u=u(this.$element)),f=this.options.get("adaptContainerCssClass"),f=f||r,u.indexOf(":all:")!==-1&&(u=u.replace(":all:",""),s=f,f=function(n){var t=s(n);return t!=null?t+" "+n:n}),e=this.options.get("containerCss")||{},n.isFunction(e)&&(e=e(this.$element)),t.syncCssClasses(o,this.$element,f),o.css(e),o.addClass(u),o},i});t.define("select2/compat/dropdownCss",["jquery","./utils"],function(n,t){function r(){return null}function i(){}return i.prototype.render=function(i){var o=i.call(this),u=this.options.get("dropdownCssClass")||"",f,s,e;return n.isFunction(u)&&(u=u(this.$element)),f=this.options.get("adaptDropdownCssClass"),f=f||r,u.indexOf(":all:")!==-1&&(u=u.replace(":all:",""),s=f,f=function(n){var t=s(n);return t!=null?t+" "+n:n}),e=this.options.get("dropdownCss")||{},n.isFunction(e)&&(e=e(this.$element)),t.syncCssClasses(o,this.$element,f),o.css(e),o.addClass(u),o},i});t.define("select2/compat/initSelection",["jquery"],function(n){function t(n,t,i){i.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2");this.initSelection=i.get("initSelection");this._isInitialized=!1;n.call(this,t,i)}return t.prototype.current=function(t,i){var r=this;if(this._isInitialized){t.call(this,i);return}this.initSelection.call(null,this.$element,function(t){r._isInitialized=!0;n.isArray(t)||(t=[t]);i(t)})},t});t.define("select2/compat/inputData",["jquery"],function(n){function t(n,t,i){this._currentData=[];this._valueSeparator=i.get("valueSeparator")||",";t.prop("type")==="hidden"&&i.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead.");n.call(this,t,i)}return t.prototype.current=function(t,i){function f(t,i){var r=[];return t.selected||n.inArray(t.id,i)!==-1?(t.selected=!0,r.push(t)):t.selected=!1,t.children&&r.push.apply(r,f(t.children,i)),r}for(var e,r=[],u=0;u<this._currentData.length;u++)e=this._currentData[u],r.push.apply(r,f(e,this.$element.val().split(this._valueSeparator)));i(r)},t.prototype.select=function(t,i){if(this.options.get("multiple")){var r=this.$element.val();r+=this._valueSeparator+i.id;this.$element.val(r);this.$element.trigger("change")}else this.current(function(t){n.map(t,function(n){n.selected=!1})}),this.$element.val(i.id),this.$element.trigger("change")},t.prototype.unselect=function(n,t){var i=this;t.selected=!1;this.current(function(n){for(var u,f=[],r=0;r<n.length;r++)(u=n[r],t.id!=u.id)&&f.push(u.id);i.$element.val(f.join(i._valueSeparator));i.$element.trigger("change")})},t.prototype.query=function(n,t,i){for(var e,u,f=[],r=0;r<this._currentData.length;r++)e=this._currentData[r],u=this.matches(t,e),u!==null&&f.push(u);i({results:f})},t.prototype.addOptions=function(t,i){var r=n.map(i,function(t){return n.data(t[0],"data")});this._currentData.push.apply(this._currentData,r)},t});t.define("select2/compat/matcher",["jquery"],function(n){function t(t){function i(i,r){var u=n.extend(!0,{},r),f,e,o;if(i.term==null||n.trim(i.term)==="")return u;if(r.children){for(f=r.children.length-1;f>=0;f--)e=r.children[f],o=t(i.term,e.text,e),o||u.children.splice(f,1);if(u.children.length>0)return u}return t(i.term,r.text,r)?u:null}return i}return t});t.define("select2/compat/query",[],function(){function n(n,t,i){i.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2.");n.call(this,t,i)}return n.prototype.query=function(n,t,i){t.callback=i;var r=this.options.get("query");r.call(null,t)},n});t.define("select2/dropdown/attachContainer",[],function(){function n(n,t,i){n.call(this,t,i)}return n.prototype.position=function(n,t,i){var r=i.find(".dropdown-wrapper");r.append(t);t.addClass("select2-dropdown--below");i.addClass("select2-container--below")},n});t.define("select2/dropdown/stopPropagation",[],function(){function n(){}return n.prototype.bind=function(n,t,i){n.call(this,t,i);this.$dropdown.on("blur change click dblclick focus focusin focusout input keydown keyup keypress mousedown mouseenter mouseleave mousemove mouseover mouseup search touchend touchstart",function(n){n.stopPropagation()})},n});t.define("select2/selection/stopPropagation",[],function(){function n(){}return n.prototype.bind=function(n,t,i){n.call(this,t,i);this.$selection.on("blur change click dblclick focus focusin focusout input keydown keyup keypress mousedown mouseenter mouseleave mousemove mouseover mouseup search touchend touchstart",function(n){n.stopPropagation()})},n});
/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
return function(i){typeof t.define=="function"&&t.define.amd?t.define("jquery-mousewheel",["jquery"],i):typeof exports=="object"?module.exports=i:i(n)}(function(n){function e(r){var f=r||window.event,w=h.call(arguments,1),l=0,o=0,e=0,a=0,b=0,k=0,v,y,p;if(r=n.event.fix(f),r.type="mousewheel","detail"in f&&(e=f.detail*-1),"wheelDelta"in f&&(e=f.wheelDelta),"wheelDeltaY"in f&&(e=f.wheelDeltaY),"wheelDeltaX"in f&&(o=f.wheelDeltaX*-1),"axis"in f&&f.axis===f.HORIZONTAL_AXIS&&(o=e*-1,e=0),l=e===0?o:e,"deltaY"in f&&(e=f.deltaY*-1,l=e),"deltaX"in f&&(o=f.deltaX,e===0&&(l=o*-1)),e!==0||o!==0)return f.deltaMode===1?(v=n.data(this,"mousewheel-line-height"),l*=v,e*=v,o*=v):f.deltaMode===2&&(y=n.data(this,"mousewheel-page-height"),l*=y,e*=y,o*=y),a=Math.max(Math.abs(e),Math.abs(o)),(!t||a<t)&&(t=a,s(f,a)&&(t/=40)),s(f,a)&&(l/=40,o/=40,e/=40),l=Math[l>=1?"floor":"ceil"](l/t),o=Math[o>=1?"floor":"ceil"](o/t),e=Math[e>=1?"floor":"ceil"](e/t),i.settings.normalizeOffset&&this.getBoundingClientRect&&(p=this.getBoundingClientRect(),b=r.clientX-p.left,k=r.clientY-p.top),r.deltaX=o,r.deltaY=e,r.deltaFactor=t,r.offsetX=b,r.offsetY=k,r.deltaMode=0,w.unshift(r,l,o,e),u&&clearTimeout(u),u=setTimeout(c,200),(n.event.dispatch||n.event.handle).apply(this,w)}function c(){t=null}function s(n,t){return i.settings.adjustOldDeltas&&n.type==="mousewheel"&&t%120==0}var o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice,u,t,f,i;if(n.event.fixHooks)for(f=o.length;f;)n.event.fixHooks[o[--f]]=n.event.mouseHooks;i=n.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=r.length;t;)this.addEventListener(r[--t],e,!1);else this.onmousewheel=e;n.data(this,"mousewheel-line-height",i.getLineHeight(this));n.data(this,"mousewheel-page-height",i.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=r.length;t;)this.removeEventListener(r[--t],e,!1);else this.onmousewheel=null;n.removeData(this,"mousewheel-line-height");n.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var r=n(t),i=r["offsetParent"in n.fn?"offsetParent":"parent"]();return i.length||(i=n("body")),parseInt(i.css("fontSize"),10)||parseInt(r.css("fontSize"),10)||16},getPageHeight:function(t){return n(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};n.fn.extend({mousewheel:function(n){return n?this.bind("mousewheel",n):this.trigger("mousewheel")},unmousewheel:function(n){return this.unbind("mousewheel",n)}})}),t.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(n,t,i,r){if(n.fn.select2==null){var u=["open","close","destroy"];n.fn.select2=function(t){if(t=t||{},typeof t=="object")return this.each(function(){var r=n.extend(!0,{},t),u=new i(n(this),r)}),this;if(typeof t=="string"){var r,f=Array.prototype.slice.call(arguments,1);return(this.each(function(){var i=n(this).data("select2");i==null&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2.");r=i[t].apply(i,f)}),n.inArray(t,u)>-1)?this:r}throw new Error("Invalid arguments for Select2: "+t);}}return n.fn.select2.defaults==null&&(n.fn.select2.defaults=r),i}),{define:t.define,require:t.require}}(),i=t.require("jquery.select2");return n.fn.select2.amd=t,i});